{"version":3,"file":"dhtmlxgantt.js","sources":["../sources/core/relations/links_common.js","../sources/utils/helpers.js","../sources/core/relations/graph_helper.js","../sources/core/relations/links_builder.js","../sources/ext/auto_scheduling/constraint_types.ts","../sources/core/ui/utils/dom_helpers.js","../sources/ext/auto_scheduling/task_plan.ts","../sources/ext/auto_scheduling/constraints.ts","../sources/ext/auto_scheduling/date_comparator.ts","../sources/ext/auto_scheduling/alap_strategy.ts","../sources/ext/auto_scheduling/asap_strategy.ts","../sources/ext/auto_scheduling/planner.ts","../sources/ext/auto_scheduling/connected_groups.ts","../sources/ext/auto_scheduling/loops_finder.ts","../sources/core/plugins/auto_scheduling_config.js","../sources/ext/auto_scheduling/ui_handlers.ts","../sources/utils/global.js","../sources/ext/click_drag/eventsManager.ts","../sources/utils/eventable.js","../sources/ext/click_drag/selectedRegion.ts","../sources/ext/drag_timeline/eventsManager.ts","../sources/utils/utils.js","../sources/core/ui/timeline/scales.js","../sources/core/ui/timeline/scales_ignore.js","../sources/ext/keyboard_navigation/modals.js","../sources/ext/quick_info/quickInfo.ts","../sources/core/ui/utils/dom_event_scope.js","../sources/ext/tooltip/tooltip.ts","../sources/ext/tooltip/tooltipManager.ts","../sources/ext/undo/monitor.ts","../sources/ext/undo/undo.ts","../sources/ext/extensions_all.ts","../sources/ext/auto_scheduling.js","../sources/ext/click_drag/index.ts","../sources/ext/critical_path.js","../sources/ext/critical_path/slack.js","../sources/ext/critical_path/critical_path.js","../sources/ext/drag_timeline/index.ts","../sources/ext/fullscreen/index.ts","../sources/ext/keyboard_navigation.js","../sources/ext/keyboard_navigation/common/keyboard_shortcuts.js","../sources/ext/keyboard_navigation/common/eventhandler.js","../sources/ext/keyboard_navigation/common/trap_modal_focus.js","../sources/ext/keyboard_navigation/elements/gantt_node.js","../sources/ext/keyboard_navigation/elements/nav_node.js","../sources/ext/keyboard_navigation/elements/header_cell.js","../sources/ext/keyboard_navigation/elements/task_row.js","../sources/ext/keyboard_navigation/elements/task_cell.js","../sources/ext/keyboard_navigation/core.js","../sources/ext/quick_info/index.ts","../sources/ext/tooltip/index.ts","../sources/ext/undo/index.ts","../sources/ext/grouping.js","../sources/ext/marker.js","../sources/ext/multiselect.js","../sources/ext/overlay.js","../sources/ext/export_api/index.ts","../sources/constants/index.js","../sources/ext/extension_manager.ts","../sources/utils/env.js","../sources/core/common/serialize.ts","../sources/core/common/ajax.js","../sources/core/common/date_parsers/fast_version.ts","../sources/core/common/date_parsers/csp_compliant_version.ts","../sources/core/common/date.js","../node_modules/remote-client/dist/remote.es6.js","../sources/core/remote/remote_events.js","../sources/utils/timeout.js","../sources/core/common/state.js","../sources/utils/promise.js","../sources/core/facades/datastore_tasks.js","../sources/core/datastore/power_array.js","../sources/utils/placeholder_task.js","../sources/core/datastore/datastore.js","../sources/core/common/split_task_helpers.ts","../sources/core/datastore/treedatastore.js","../sources/utils/is_headless.js","../sources/core/datastore/datastore_render.js","../sources/core/facades/datastore.js","../sources/core/datastore/select.js","../sources/core/facades/datastore_links.js","../sources/core/gantt_data_range.js","../sources/utils/task_tree_helpers.js","../sources/core/dataprocessor/data_processor_events.ts","../sources/core/dataprocessor/simple_storage.ts","../sources/core/dataprocessor/data_processor.ts","../sources/core/dataprocessor/extend_gantt.ts","../sources/core/dataprocessor/index.js","../sources/core/plugins/batch_update.js","../sources/core/plugins/wbs.js","../sources/core/plugins/resources.js","../sources/core/plugins/resource_assignments.js","../sources/core/plugins/new_task_placeholder.js","../sources/core/plugins/auto_task_types.js","../sources/core/common/duration_formatter.ts","../sources/core/common/link_formatter_simple.ts","../sources/core/common/link_formatter.ts","../sources/core/plugins/formatters.js","../sources/core/plugins/empty_state_screen.ts","../sources/core/ui/render/baseline_helper.js","../sources/core/plugins/baselines.js","../sources/core/plugins/remote_events/remote_events.ts","../sources/core/plugins/remote_events/handlers.js","../sources/core/plugins/remote_events/index.js","../sources/core/ui/row_position_mixin.js","../sources/core/ui/row_position_fixed_height.js","../sources/core/ui/plugins/column_grid_dnd/scrollable_grid.ts","../sources/core/ui/plugins/column_grid_dnd/column_grid_dnd.ts","../sources/core/ui/mouse_event_container.js","../sources/core/ui/grid/grid.js","../sources/core/loading/parsing.js","../sources/core/worktime/calendar_arguments_helper.js","../sources/core/ui/grid/grid_resize.js","../sources/core/ui/grid/task_grid_row_resize.js","../sources/core/worktime/strategy/work_calendar_merger.js","../sources/core/worktime/strategy/work_unit_cache/workunit_map_cache.ts","../sources/core/worktime/strategy/work_unit_cache/workunit_object_cache.ts","../sources/core/worktime/strategy/work_unit_cache/larger_units_helper.ts","../sources/core/worktime/strategy/work_unit_cache/date_duration_cache.ts","../sources/core/worktime/strategy/calendar_strategy.js","../sources/core/worktime/strategy/work_unit_cache/index.ts","../sources/core/worktime/legacy_resource_config.js","../sources/core/worktime/calendar_manager.js","../sources/core/worktime/dynamic_resource_calendars.js","../sources/core/worktime/strategy/no_work_time.js","../sources/core/worktime/time_calculator.js","../sources/core/facades/worktime_calendars.js","../sources/core/data.js","../sources/core/ui/resize_listener.js","../sources/core/gantt_core.js","../sources/core/common/assert.js","../sources/locale/locale_ar.ts","../sources/locale/locale_be.ts","../sources/locale/locale_ca.ts","../sources/locale/locale_cn.ts","../sources/locale/locale_cs.ts","../sources/locale/locale_da.ts","../sources/locale/locale_de.ts","../sources/locale/locale_el.ts","../sources/locale/locale_en.ts","../sources/locale/locale_es.ts","../sources/locale/locale_fa.ts","../sources/locale/locale_fi.ts","../sources/locale/locale_fr.ts","../sources/locale/locale_he.ts","../sources/locale/locale_hr.ts","../sources/locale/locale_hu.ts","../sources/locale/locale_id.ts","../sources/locale/locale_it.ts","../sources/locale/locale_jp.ts","../sources/locale/locale_kr.ts","../sources/locale/locale_manager.ts","../sources/locale/locale_nb.ts","../sources/locale/locale_nl.ts","../sources/locale/locale_no.ts","../sources/locale/locale_pl.ts","../sources/locale/locale_pt.ts","../sources/locale/locale_ro.ts","../sources/locale/locale_ru.ts","../sources/locale/locale_si.ts","../sources/locale/locale_sk.ts","../sources/locale/locale_sv.ts","../sources/locale/locale_tr.ts","../sources/locale/locale_ua.ts","../sources/factory/make_instance_common.js","../sources/core/common/services.js","../sources/core/common/config.ts","../sources/core/common/dnd.js","../sources/core/common/templates.js","../sources/core/datastore/datastore_hooks.js","../sources/core/plugins/index.js","../sources/core/grid_column_api.js","../sources/core/grid_column_api.gpl.js","../sources/core/tasks.js","../sources/core/worktime/work_time.js","../sources/core/data_task_types.js","../sources/core/cached_functions.js","../sources/core/destructor.js","../sources/locale/index.ts","../sources/core/ui/message.js","../sources/core/ui/configurable.js","../sources/core/ui/ui_factory.js","../sources/core/ui/mouse.js","../sources/core/ui/render/viewport/is_in_viewport.js","../sources/core/ui/render/is_legacy_smart_render.js","../sources/core/ui/render/viewport/get_grid_row_rectangle.js","../sources/core/ui/render/viewport/get_visible_bars_range.js","../sources/core/ui/render/render_factory.js","../sources/core/ui/render/layer_engine.js","../sources/core/ui/render/viewport/get_bar_rectangle.js","../sources/core/ui/render/viewport/factory/get_visible_link_range.js","../sources/core/ui/render/viewport/get_link_rectangle.js","../sources/core/ui/render/viewport/is_link_in_viewport.js","../sources/core/ui/gantt_layers.js","../sources/core/ui/layout/cell.js","../sources/utils/extends.js","../sources/core/ui/layout/layout.js","../sources/core/ui/layout/view_layout.js","../sources/core/ui/layout/view_cell.js","../sources/core/ui/layout/resizer_cell.js","../sources/core/ui/layout/scrollbar_cell.js","../sources/core/ui/timeline/tasks_canvas_render.js","../sources/core/ui/timeline/timeline.js","../sources/core/ui/resource_store_mixin.js","../sources/core/ui/timeline/timeline_layers.js","../sources/core/ui/grid/resource_grid.js","../sources/core/ui/grid/resource_grid_lightbox.js","../sources/core/ui/timeline/resource_timeline.js","../sources/core/ui/timeline/resource_histogram.js","../sources/core/ui/grid/editors/keyboard_mappings/default.js","../sources/core/ui/grid/editors/keyboard_mappings/keyboard_navigation.js","../sources/core/ui/grid/editors/editors/base.js","../sources/core/ui/grid/editors/editors/text.js","../sources/core/ui/grid/editors/editors/number.js","../sources/core/ui/grid/editors/editors/select.js","../sources/core/ui/grid/editors/editors/date.js","../sources/core/ui/grid/editors/editors/predecessor.js","../sources/core/ui/grid/editors/editors/duration.js","../sources/core/ui/grid/editors/linked_properties.js","../sources/core/ui/grid/editors/controller.js","../sources/core/ui/grid/editors/keyboard_mappings.js","../sources/core/ui/render/viewport/is_bar_in_viewport.js","../sources/core/ui/render/task_bar_render.js","../sources/core/ui/render/viewport/is_project_bar_in_viewport.js","../sources/core/ui/render/task_project_render.js","../sources/core/ui/render/viewport/is_split_task_in_viewport.js","../sources/core/ui/render/viewport/get_bg_row_rectangle.js","../sources/core/ui/render/viewport/get_visible_cells_range.js","../sources/core/ui/render/viewport/is_column_visible.js","../sources/core/ui/render/prerender/task_bg_placeholder.js","../sources/core/ui/render/link_render.js","../sources/core/ui/render/viewport/is_grid_row_in_viewport.js","../sources/core/resource_timetable_builder.js","../sources/core/ui/render/resource_histogram_render.js","../sources/core/ui/render/viewport/are_dates_in_viewport.js","../sources/core/ui/render/task_constraints_render.js","../sources/core/ui/render/task_deadline_render.js","../sources/core/ui/render/task_baselines_render.js","../sources/core/ui/grid/tasks_grid_dnd.js","../sources/core/ui/grid/tasks_grid_dnd_marker_helpers/drop_target.js","../sources/core/ui/grid/tasks_grid_dnd_marker_helpers/locked_level.js","../sources/core/ui/grid/tasks_grid_dnd_marker_helpers/highlight.js","../sources/core/ui/grid/tasks_grid_dnd_marker.js","../sources/core/ui/grid/tasks_grid_dnd_marker_helpers/multi_level.js","../sources/core/ui/grid/main_grid_initializer.js","../sources/core/ui/timeline/tasks_dnd.js","../sources/core/ui/timeline/links_dnd.js","../sources/core/ui/timeline/main_timeline_initializer.js","../sources/core/ui/main_layout_initializer.js","../sources/core/ui/index.js","../sources/core/ui/render/task_grid_line_render.js","../sources/core/ui/render/task_bg_render.js","../sources/core/ui/render/task_bar_smart_render.js","../sources/core/ui/render/task_project_smart_render.js","../sources/core/ui/render/task_rollup_render.js","../sources/core/ui/render/task_split_render.js","../sources/core/ui/render/resource_matrix_render.js","../sources/core/ui/render/task_grid_row_resize_render.js","../sources/core/ui/skin.js","../sources/core/ui/plugins/autoscroll.js","../sources/core/ui/plugins/jquery_hooks.js","../sources/core/ui/plugins/dhtmlx_hooks.js","../sources/core/ui/plugins/timeline_zoom.ts","../sources/core/ui/touch.js","../sources/core/ui/lightbox/controls/base_control.js","../sources/core/ui/utils/html_helpers.js","../sources/core/ui/lightbox/controls/select_control.js","../sources/core/common/duration_formatter_numeric.ts","../sources/core/ui/lightbox/controls/parent_control.js","../sources/core/ui/lightbox/controls/resources_control.js","../sources/core/ui/lightbox/controls/resource_selector_control.js","../sources/core/ui/lightbox/index.js","../sources/core/ui/lightbox/controls/template_control.js","../sources/core/ui/lightbox/controls/textarea_control.js","../sources/core/ui/lightbox/controls/time_control.js","../sources/core/ui/lightbox/controls/checkbox_control.js","../sources/core/ui/lightbox/controls/radio_control.js","../sources/core/ui/lightbox/controls/duration_control.js","../sources/core/ui/lightbox/controls/constraint_control.js","../sources/core/ui/lightbox/controls/typeselect_control.js","../sources/core/ui/lightbox/controls/baseline_control.js","../sources/core/ui_core.js","../sources/core/facades/layout.js","../sources/css/skins/skyblue.js","../sources/css/skins/dark.js","../sources/css/skins/meadow.js","../sources/css/skins/terrace.js","../sources/css/skins/broadway.js","../sources/css/skins/material.js","../sources/css/skins/contrast_black.js","../sources/css/skins/contrast_white.js","../sources/core/ui/plugins/index.js","../sources/core/ui/lightbox/lightbox_optional_time.js","../sources/core/ui/wai_aria.js","../sources/core/loading/dynamic_loading.js","../sources/dhtmlxgantt.web.single.ts","../sources/factory/make_instance_web.js","../sources/core/loading/ajax_loading.js","../sources/dhtmlxgantt.individual.ts"],"sourcesContent":["export default function (gantt) {\n\t// helpers for building chain of dependencies, used for critical path calculation and for auto scheduling\n\n\tgantt._get_linked_task = function (link, getTarget) {\n\t\tvar task = null;\n\t\tvar taskId = getTarget ? link.target : link.source;\n\n\t\tif (gantt.isTaskExists(taskId)) {\n\t\t\ttask = gantt.getTask(taskId);\n\t\t}\n\n\t\treturn task;\n\t};\n\tgantt._get_link_target = function (link) {\n\t\treturn gantt._get_linked_task(link, true);\n\t};\n\n\tgantt._get_link_source = function (link) {\n\t\treturn gantt._get_linked_task(link, false);\n\t};\n\n\tvar caching = false;\n\tvar formattedLinksStash = {};\n\tvar inheritedSuccessorsStash = {};\n\tvar inheritedPredecessorsStash = {};\n\tvar getPredecessorsCache = {};\n\n\n\tgantt._isLinksCacheEnabled = function () {\n\t\treturn caching;\n\t};\n\tgantt._startLinksCache = function () {\n\t\tformattedLinksStash = {};\n\t\tinheritedSuccessorsStash = {};\n\t\tinheritedPredecessorsStash = {};\n\t\tgetPredecessorsCache = {};\n\t\tcaching = true;\n\t};\n\tgantt._endLinksCache = function () {\n\t\tformattedLinksStash = {};\n\t\tinheritedSuccessorsStash = {};\n\t\tinheritedPredecessorsStash = {};\n\t\tgetPredecessorsCache = {};\n\t\tcaching = false;\n\t};\n\n\tfunction isManuallyScheduledSummary(task){\n\t\treturn gantt.isSummaryTask(task) && task.auto_scheduling === false;\n\t}\n\n\tgantt._formatLink = function (link, sourceDates, targetDates) {\n\n\n\t\tif (caching && formattedLinksStash[link.id]) {\n\t\t\treturn formattedLinksStash[link.id];\n\t\t}\n\n\t\tvar relations = [];\n\t\tvar target = this._get_link_target(link);\n\t\tvar source = this._get_link_source(link);\n\n\t\tif (!(source && target)) {\n\t\t\treturn relations;\n\t\t}\n\n\t\tif ((gantt.isSummaryTask(target) && gantt.isChildOf(source.id, target.id)) || (gantt.isSummaryTask(source) && gantt.isChildOf(target.id, source.id))) {\n\t\t\treturn relations;\n\t\t}\n\n\t\tconst autoSchedulingConfig = gantt._getAutoSchedulingConfig();\n\n\t\tvar backwardsScheduling = autoSchedulingConfig.schedule_from_end && gantt.config.project_end;\n\t\tvar respectTargetOffset = autoSchedulingConfig.move_projects;\n\t\tif(autoSchedulingConfig.apply_constraints && autoSchedulingConfig.gap_behavior === \"compress\"){\n\t\t\trespectTargetOffset = false;\n\t\t}\n\n\n\n\t\t// there are three kinds of connections at this point\n\t\t// task -> task - regular link\n\t\t// task -> project - transform it into set of regular links (task -> [each subtask]), use offset beetween subtask and project dates as lag, in order not to change mutual positions of subtasks inside a project\n\t\t// project -> task - transform it into ([each subtask] -> task) links\n\t\t// project -> project - transform it into ([each subtask of p1] -> [each subtask of p2]) links\n\t\tsourceDates = sourceDates || (this.isSummaryTask(source) && !isManuallyScheduledSummary(source)) ? this.getSubtaskDates(source.id) : {\n\t\t\tstart_date: source.start_date,\n\t\t\tend_date: source.end_date\n\t\t};\n\n\t\tvar from = this._getImplicitLinks(link, source, function (c) {\n\t\t\tif(!respectTargetOffset || !backwardsScheduling){\n\t\t\t\treturn 0;\n\t\t\t}else{\n\t\t\t\tif (!c.$source.length && !(gantt.getState(\"tasksDnd\").drag_id == c.id)) {\n\t\t\t\t\t// drag_id - virtual lag shouldn't restrict task that is being moved inside project\n\t\t\t\t\treturn gantt.calculateDuration({\n\t\t\t\t\t\tstart_date: c.end_date,\n\t\t\t\t\t\tend_date: sourceDates.end_date,\n\t\t\t\t\t\ttask: source\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}, true);\n\n\t\tif (!targetDates){\n\t\t\ttargetDates = {\n\t\t\t\tstart_date: target.start_date,\n\t\t\t\tend_date: target.end_date\n\t\t\t};\n\t\t\tif (this.isSummaryTask(target) && !isManuallyScheduledSummary(target)){\n\t\t\t\ttargetDates = this.getSubtaskDates(target.id);\n\t\t\t\ttargetDates.start_date = targetDates.end_date;\n\t\t\t\t// GS-2427. When a successor starts earlier its predecessor, we should\n\t\t\t\t// obtain the dates of the predecessor\n\t\t\t\tthis.eachTask(function(child){\n\t\t\t\t\t// exclude projects as their dates are unreliable until the scheduling is done\n\t\t\t\t\tif (child.type === this.config.types.project){\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (!child.$target.length && child.start_date < targetDates.start_date){\n\t\t\t\t\t\ttargetDates.start_date = child.start_date;\n\t\t\t\t\t}\n\t\t\t\t},target.id);\n\t\t\t}\n\t\t}\n\n\t\tvar to = this._getImplicitLinks(link, target, function (actualTarget) {\n\t\t\tif (!respectTargetOffset || backwardsScheduling) {\n\t\t\t\treturn 0;\n\t\t\t} else {\n\t\t\t\tif (!actualTarget.$target.length && !(gantt.getState(\"tasksDnd\").drag_id == actualTarget.id)) {// drag_id - virtual lag shouldn't restrict task that is being moved inside project\n\t\t\t\t\treturn gantt.calculateDuration({\n\t\t\t\t\t\tstart_date: targetDates.start_date,\n\t\t\t\t\t\tend_date: actualTarget.start_date,\n\t\t\t\t\t\ttask: target\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tfor (var i = 0, fromLength = from.length; i < fromLength; i++) {\n\t\t\tvar fromTask = from[i];\n\t\t\tfor (var j = 0, toLength = to.length; j < toLength; j++) {\n\t\t\t\tvar toTask = to[j];\n\n\t\t\t\tvar lag = fromTask.lag * 1 + toTask.lag * 1;\n\n\t\t\t\tvar subtaskLink = {\n\t\t\t\t\tid: link.id,\n\t\t\t\t\ttype: link.type,\n\t\t\t\t\tsource: fromTask.task,\n\t\t\t\t\ttarget: toTask.task,\n\t\t\t\t\tsubtaskLink: fromTask.subtaskLink,\n\t\t\t\t\tlag: (link.lag * 1 || 0) + lag\n\t\t\t\t};\n\n\t\t\t\tgantt._linkedTasks[subtaskLink.target] = gantt._linkedTasks[subtaskLink.target] || {};\n\t\t\t\tgantt._linkedTasks[subtaskLink.target][subtaskLink.source] = true;\n\n\t\t\t\trelations.push(gantt._convertToFinishToStartLink(toTask.task, subtaskLink, source, target, fromTask.taskParent, toTask.taskParent));\n\t\t\t}\n\t\t}\n\n\t\tif (caching)\n\t\t\tformattedLinksStash[link.id] = relations;\n\n\t\treturn relations;\n\t};\n\n\tgantt._isAutoSchedulable = function (task) {\n\t\tconst scheduleTask = task.auto_scheduling !== false && task.unscheduled !== true;\n\t\tif (!scheduleTask){\n\t\t\treturn false;\n\t\t}\n\t\t// GS-2420. Don't auto-schedule project when it has only unscheduled children\n\t\tif (this.isSummaryTask(task)){\n\t\t\tlet unscheduledChildren = true;\n\t\t\tthis.eachTask(function(child){\n\t\t\t\tif (unscheduledChildren){\n\t\t\t\t\tconst scheduleChild = gantt._isAutoSchedulable(child);\n\t\t\t\t\tif (scheduleChild){\n\t\t\t\t\t\tunscheduledChildren = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}, task.id);\n\t\t\tif (unscheduledChildren){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t};\n\n\tgantt._getImplicitLinks = function (link, parent, selectOffset, selectSourceLinks) {\n\t\tvar relations = [];\n\n\t\tif (this.isSummaryTask(parent) && !isManuallyScheduledSummary(parent)) {\n\n\t\t\t// if the summary task contains multiple chains of linked tasks - no need to consider every task of the chain,\n\t\t\t// it will be enough to check the first/last tasks of the chain\n\t\t\t// special conditions if there are unscheduled tasks in the chain, or negative lag values that put the end date of the successor task prior to its predecessors' date\n\t\t\tvar children = {};\n\t\t\tthis.eachTask(function (c) {\n\t\t\t\tif (!this.isSummaryTask(c) || isManuallyScheduledSummary(c)) {\n\t\t\t\t\tchildren[c.id] = c;\n\t\t\t\t}\n\t\t\t}, parent.id);\n\n\t\t\tvar skipChild;\n\n\t\t\tfor (var c in children) {\n\t\t\t\tvar task = children[c];\n\t\t\t\t// don't create subtask links with unscheduled tasks\n\t\t\t\tif (!gantt._isAutoSchedulable(task)){\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tvar linksCollection = selectSourceLinks ? task.$source : task.$target;\n\n\t\t\t\tskipChild = false;\n\n\t\t\t\tfor (var l = 0; l < linksCollection.length; l++) {\n\t\t\t\t\t// GS-2014 and GS-2588. If the link type is SS or SF, we shouldn't change the skipChild variable\n\t\t\t\t\t// because the target task should be moved to an earlier date\n\t\t\t\t\tif (link.type == gantt.config.links.start_to_start || link.type == gantt.config.links.start_to_finish){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tvar siblingLink = gantt.getLink(linksCollection[l]);\n\t\t\t\t\tvar siblingId = selectSourceLinks ? siblingLink.target : siblingLink.source;\n\t\t\t\t\tvar siblingTask = children[siblingId];\n\t\t\t\t\tif (siblingTask && gantt._isAutoSchedulable(task) && gantt._isAutoSchedulable(siblingTask)) {\n\t\t\t\t\t\tlet linkLag = 0;\n\t\t\t\t\t\tif (siblingLink.lag){\n\t\t\t\t\t\t\tlinkLag = Math.abs(siblingLink.lag);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// GS-2014 and GS-2588. If the link type is not FS, the actual lag will be different\n\t\t\t\t\t\tif (siblingLink.type != gantt.config.links.finish_to_start){\n\t\t\t\t\t\t\tlinkLag += gantt._convertToFinishToStartLink(null, {}, task, siblingTask).additionalLag;\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst sameTarget = siblingLink.target == siblingTask.id;\n\t\t\t\t\t\tconst insignificantTargetLag = sameTarget && linkLag && linkLag <= siblingTask.duration;\n\n\t\t\t\t\t\tconst sameSource = siblingLink.target == task.id;\n\t\t\t\t\t\tconst insignificantSourceLag = sameSource && linkLag && linkLag <= task.duration;\n\n\t\t\t\t\t\tif (insignificantTargetLag || insignificantSourceLag) {\n\t\t\t\t\t\t\tskipChild = true;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (!skipChild) {\n\t\t\t\t\t// GS-1689. If a task has links between other tasks within the project,\n\t\t\t\t\t// Gantt shouldn't try to keep the position within the project\n\t\t\t\t\tlet calculateLag = true;\n\t\t\t\t\tfor (const predecessorId in gantt._linkedTasks[task.id]){\n\t\t\t\t\t\tif (gantt.isChildOf(predecessorId, link.target)){\n\t\t\t\t\t\t\tcalculateLag = false;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tlet offsetLag = 0;\n\t\t\t\t\tif (calculateLag) {\n\t\t\t\t\t\toffsetLag = selectOffset(task);\n\t\t\t\t\t}\n\t\t\t\t\trelations.push({ task: task.id, taskParent: task.parent, lag: offsetLag, subtaskLink: true });\n\t\t\t\t}\n\t\t\t}\n\n\t\t} else {\n\t\t\trelations.push({ task: parent.id, taskParent: parent.parent, lag: 0 });\n\t\t}\n\n\t\treturn relations;\n\t};\n\n\tgantt._getDirectDependencies = function (task, selectSuccessors) {\n\t\tgantt._linkedTasks = gantt._linkedTasks || {};\n\n\t\tvar links = [],\n\t\t\tsuccessors = [];\n\n\t\tvar linksIds = selectSuccessors ? task.$source : task.$target;\n\n\t\tfor (var i = 0; i < linksIds.length; i++) {\n\t\t\tvar link = this.getLink(linksIds[i]);\n\t\t\tif (this.isTaskExists(link.source) && this.isTaskExists(link.target)) {\n\t\t\t\tvar target = this.getTask(link.target);\n\t\t\t\tif (!this._isAutoSchedulable(target) || !this._isAutoSchedulable(task)) {\n\t\t\t\t\tcontinue;\n\t\t\t\t} else if(gantt._getAutoSchedulingConfig().use_progress) {\n\t\t\t\t\tif(target.progress == 1){\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tlinks.push(link);\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\tlinks.push(link);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor (var i = 0; i < links.length; i++) {\n\t\t\tsuccessors = successors.concat(this._formatLink(links[i]));\n\t\t}\n\n\t\treturn successors;\n\t};\n\n\tgantt._getInheritedDependencies = function (task, selectSuccessors) {\n\n\t\t//var successors = [];\n\t\tvar stop = false;\n\t\tvar inheritedRelations = [];\n\t\tvar cacheCollection;\n\t\tif (this.isTaskExists(task.id)) {\n\t\t\tthis.eachParent(function (parent) {\n\t\t\t\tif (stop)\n\t\t\t\t\treturn;\n\n\t\t\t\tif (caching) {\n\t\t\t\t\tcacheCollection = selectSuccessors ? inheritedSuccessorsStash : inheritedPredecessorsStash;\n\t\t\t\t\tif (cacheCollection[parent.id]) {\n\t\t\t\t\t\tinheritedRelations = inheritedRelations.concat(cacheCollection[parent.id]);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tvar parentDependencies;\n\t\t\t\tif (this.isSummaryTask(parent)) {\n\t\t\t\t\tif (!this._isAutoSchedulable(parent)) {\n\t\t\t\t\t\tstop = true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tparentDependencies = this._getDirectDependencies(parent, selectSuccessors);\n\t\t\t\t\t\tif (caching) {\n\t\t\t\t\t\t\tcacheCollection[parent.id] = parentDependencies;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tinheritedRelations = inheritedRelations.concat(parentDependencies);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}, task.id, this);\n\t\t}\n\n\t\treturn inheritedRelations;\n\t};\n\n\n\tgantt._getDirectSuccessors = function (task) {\n\t\treturn this._getDirectDependencies(task, true);\n\t};\n\n\tgantt._getInheritedSuccessors = function (task) {\n\t\treturn this._getInheritedDependencies(task, true);\n\t};\n\n\tgantt._getDirectPredecessors = function (task) {\n\t\treturn this._getDirectDependencies(task, false);\n\t};\n\n\tgantt._getInheritedPredecessors = function (task) {\n\t\treturn this._getInheritedDependencies(task, false);\n\t};\n\n\tgantt._getSuccessors = function (task, skipInherited) {\n\t\tvar successors = this._getDirectSuccessors(task);\n\t\tif (skipInherited) {\n\t\t\treturn successors;\n\t\t} else {\n\t\t\treturn successors.concat(this._getInheritedSuccessors(task));\n\t\t}\n\t};\n\n\tgantt._getPredecessors = function (task, skipInherited) {\n\t\tvar key = String(task.id) + \"-\" + String(skipInherited);\n\t\tvar result;\n\n\t\tif (caching && getPredecessorsCache[key]) {\n\t\t\treturn getPredecessorsCache[key];\n\t\t}\n\n\t\tvar predecessors = this._getDirectPredecessors(task);\n\t\tif (skipInherited) {\n\t\t\tresult = predecessors;\n\t\t} else {\n\t\t\tresult = predecessors.concat(this._getInheritedPredecessors(task));\n\t\t}\n\t\tif (caching) {\n\t\t\tgetPredecessorsCache[key] = result;\n\t\t}\n\t\treturn result;\n\t};\n\n\n\tgantt._convertToFinishToStartLink = function (id, link, sourceTask, targetTask, sourceParent, targetParent) {\n\t\t// convert finish-to-finish, start-to-finish and start-to-start to finish-to-start link and provide some additional properties\n\t\tvar res = {\n\t\t\ttarget: id,\n\t\t\tlink: gantt.config.links.finish_to_start,\n\t\t\tid: link.id,\n\t\t\tlag: link.lag || 0,\n\t\t\tsourceLag: 0,\n\t\t\ttargetLag: 0,\n\t\t\ttrueLag: link.lag || 0,\n\t\t\tsource: link.source,\n\t\t\tpreferredStart: null,\n\t\t\tsourceParent: sourceParent,\n\t\t\ttargetParent: targetParent,\n\t\t\thashSum: null,\n\t\t\tsubtaskLink: link.subtaskLink\n\t\t};\n\t\t// GS-148: switch uses strict comparison, so we need to convert the values to the same type\n\t\tvar additionalLag = 0;\n\t\tswitch (String(link.type)) {\n\t\t\tcase String(gantt.config.links.start_to_start):\n\t\t\t\tadditionalLag = -sourceTask.duration;\n\t\t\t\tres.sourceLag = additionalLag;\n\t\t\t\tbreak;\n\t\t\tcase String(gantt.config.links.finish_to_finish):\n\t\t\t\tadditionalLag = -targetTask.duration;\n\t\t\t\tres.targetLag = additionalLag;\n\t\t\t\tbreak;\n\t\t\tcase String(gantt.config.links.start_to_finish):\n\t\t\t\tadditionalLag = -sourceTask.duration - targetTask.duration;\n\t\t\t\tres.sourceLag = -sourceTask.duration;\n\t\t\t\tres.targetLag = -targetTask.duration;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tadditionalLag = 0;\n\t\t}\n\n\t\tres.lag += additionalLag;\n\t\tres.hashSum = res.lag + \"_\" + res.link + \"_\" + res.source + \"_\" + res.target;\n\t\treturn res;\n\t};\n};","var units = {\n\t\"second\": 1,\n\t\"minute\": 60,\n\t\"hour\": 60 * 60,\n\t\"day\": 60 * 60 * 24,\n\t\"week\": 60 * 60 * 24 * 7,\n\t\"month\": 60 * 60 * 24 * 30,\n\t\"quarter\": 60 * 60 * 24 * 30 * 3,\n\t\"year\": 60 * 60 * 24 * 365\n};\nfunction getSecondsInUnit(unit){\n\treturn units[unit] || units.hour;\n}\n\nfunction forEach(arr, callback) {\n\tif (arr.forEach) {\n\t\tarr.forEach(callback);\n\t} else {\n\t\tvar workArray = arr.slice();\n\t\tfor (var i = 0; i < workArray.length; i++) {\n\t\t\tcallback(workArray[i], i);\n\t\t}\n\t}\n}\n\nfunction arrayMap(arr, callback) {\n\tif (arr.map) {\n\t\treturn arr.map(callback);\n\t} else {\n\t\tvar workArray = arr.slice();\n\t\tvar resArray = [];\n\n\t\tfor (var i = 0; i < workArray.length; i++) {\n\t\t\tresArray.push(callback(workArray[i], i));\n\t\t}\n\t\treturn resArray;\n\t}\n}\n\n\nfunction arrayFind(arr, callback) {\n\tif (arr.find) {\n\t\treturn arr.find(callback);\n\t} else {\n\t\tfor (var i = 0; i < arr.length; i++) {\n\t\t\tif (callback(arr[i], i)) {\n\t\t\t\treturn arr[i];\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction arrayIncludes(arr, item) {\n\tif(arr.includes){\n\t\treturn arr.includes(item);\n\t}else{\n\t\tfor (var i = 0; i < arr.length; i++) {\n\t\t\tif (arr[i] === item) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n}\n\n// iframe-safe array type check instead of using instanceof\nfunction isArray(obj){\n\tif(Array.isArray){\n\t\treturn Array.isArray(obj);\n\t}else{\n\t\t// close enough\n\t\treturn (obj && obj.length !== undefined && obj.pop && obj.push);\n\t}\n}\n\n// non-primitive string object, e.g. new String(\"abc\")\nfunction isStringObject(obj){\n\treturn obj && typeof obj === \"object\"\n\t\t&& Function.prototype.toString.call(obj.constructor) === \"function String() { [native code] }\";\n}\n\n// non-primitive number object, e.g. new Number(5)\nfunction isNumberObject(obj){\n\treturn obj && typeof obj === \"object\"\n\t\t&& Function.prototype.toString.call(obj.constructor) === \"function Number() { [native code] }\";\n}\n\n// non-primitive number object, e.g. new Boolean(true)\nfunction isBooleanObject(obj){\n\treturn obj && typeof obj === \"object\"\n\t\t&& Function.prototype.toString.call(obj.constructor) === \"function Boolean() { [native code] }\";\n}\n\nfunction isDate(obj) {\n\tif (obj && typeof obj === \"object\") {\n\t\treturn !!(obj.getFullYear && obj.getMonth && obj.getDate);\n\t} else {\n\t\treturn false;\n\t}\n}\n\nfunction isValidDate(obj){\n\treturn isDate(obj) && !isNaN(obj.getTime());\n}\n\nfunction arrayFilter(arr, callback) {\n\tvar result = [];\n\n\tif (arr.filter) {\n\t\treturn arr.filter(callback);\n\t} else {\n\t\tfor (var i = 0; i < arr.length; i++) {\n\t\t\tif (callback(arr[i], i)) {\n\t\t\t\tresult[result.length] = arr[i];\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n}\n\nfunction hashToArray(hash) {\n\tvar result = [];\n\n\tfor (var key in hash) {\n\t\tif (hash.hasOwnProperty(key)) {\n\t\t\tresult.push(hash[key]);\n\t\t}\n\t}\n\n\treturn result;\n}\n\nfunction arraySome(arr, callback) {\n\tif (arr.length === 0) return false;\n\n\tfor (var i = 0; i < arr.length; i++) {\n\t\tif (callback(arr[i], i, arr)) {\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n}\n\nfunction arrayDifference(arr, callback) {\n\treturn arrayFilter(arr, function(item, i) {\n\t\treturn !callback(item, i);\n\t});\n}\n\nfunction throttle (callback, timeout) {\n\tvar wait = false;\n\n\treturn function () {\n\t\tif (!wait) {\n\t\t\tcallback.apply(null, arguments);\n\t\t\twait = true;\n\t\t\tsetTimeout(function () {\n\t\t\t\twait = false;\n\t\t\t}, timeout);\n\t\t}\n\t};\n}\n\nfunction delay (callback, timeout){\n\tvar timer;\n\n\tvar result = function() {\n\t\tresult.$cancelTimeout();\n\t\tresult.$pending = true;\n\t\tvar args = Array.prototype.slice.call(arguments);\n\t\ttimer = setTimeout(function(){\n\t\t\tcallback.apply(this, args);\n\t\t\tresult.$pending = false;\n\t\t}, timeout);\n\t};\n\n\tresult.$pending = false;\n\tresult.$cancelTimeout = function(){\n\t\tclearTimeout(timer);\n\t\tresult.$pending = false;\n\t};\n\tresult.$execute = function(){\n\t\tvar args = Array.prototype.slice.call(arguments);\n\t\tcallback.apply(this, args);\n\t\tresult.$cancelTimeout();\n\t};\n\n\treturn result;\n}\n\nfunction sortArrayOfHash(arr, field, desc) {\n\tvar compare = function(a, b) {\n\t\treturn a < b;\n\t};\n\n\tarr.sort(function(a, b) {\n\t\tif (a[field] === b[field]) return 0;\n\n\t\treturn desc ? compare(a[field], b[field]) : compare(b[field], a[field]);\n\t});\n}\n\nfunction objectKeys(obj) {\n\tif (Object.keys) {\n\t\treturn Object.keys(obj);\n\t}\n\tvar result = [];\n\tvar key;\n\tfor (key in obj) {\n\t\tif (Object.prototype.hasOwnProperty.call(obj, key)) {\n\t\t\tresult.push(key);\n\t\t}\n\t}\n\treturn result;\n}\n\nfunction isEventable(obj) {\n\treturn obj.attachEvent && obj.detachEvent;\n}\n\n//GS-1090: A task should be able to have the id = 0\nfunction replaceValidZeroId(id, rootId) {\n\tif (checkZeroId(id) && !checkZeroId(rootId)){\n\t\tid = \"0\";\n\t}\n\treturn id;\n}\n\nfunction checkZeroId(id) {\n\tif (id === 0){\n\t\treturn true;\n\t}\n\treturn false;\n}\n\nfunction findBinary(array, target) {\n\t// modified binary search, target value not exactly match array elements, looking for closest one\n\n\tvar low = 0, high = array.length - 1, i, item, prev;\n\twhile (low <= high) {\n\n\t\ti = Math.floor((low + high) / 2);\n\t\titem = +array[i];\n\t\tprev = +array[i - 1];\n\t\tif (item < target) {\n\t\t\tlow = i + 1;\n\t\t\tcontinue;\n\t\t}\n\t\tif (item > target) {\n\t\t\tif (!(!isNaN(prev) && prev < target)) {\n\t\t\t\thigh = i - 1;\n\t\t\t\tcontinue;\n\t\t\t} else {\n\t\t\t\t// if target is between 'i' and 'i-1' return 'i - 1'\n\t\t\t\treturn i - 1;\n\t\t\t}\n\n\t\t}\n\t\twhile (+array[i] == +array[i + 1]) i++;\n\n\t\treturn i;\n\t}\n\treturn array.length - 1;\n}\n\nexport {\n\tgetSecondsInUnit,\n\tforEach,\n\tarrayMap,\n\tarrayIncludes,\n\tarrayFind,\n\tarrayFilter,\n\tarrayDifference,\n\tarraySome,\n\thashToArray,\n\tsortArrayOfHash,\n\tthrottle,\n\tisArray,\n\tisDate,\n\tisValidDate,\n\tisStringObject,\n\tisNumberObject,\n\tisBooleanObject,\n\tdelay,\n\tobjectKeys,\n\tisEventable,\n\treplaceValidZeroId,\n\tcheckZeroId,\n\tfindBinary\n};","import * as helpers from \"../../utils/helpers\";\n\nexport default function(){\n\treturn {\n\t\tgetVertices: function(relations){\n\t\t\tvar ids = {};\n\t\t\tvar rel;\n\t\t\tfor(var i = 0, len = relations.length; i < len; i++){\n\t\t\t\trel = relations[i];\n\t\t\t\tids[rel.target] = rel.target;\n\t\t\t\tids[rel.source] = rel.source;\n\t\t\t}\n\n\t\t\tvar vertices = [];\n\t\t\tvar id;\n\t\t\tfor(var i in ids){\n\t\t\t\tid = ids[i];\n\t\t\t\tvertices.push(id);\n\t\t\t}\n\n\t\t\treturn vertices;\n\t\t},\n\t\ttopologicalSort: function(edges){\n\t\t\tvar vertices = this.getVertices(edges);\n\t\t\tvar hash = {};\n\n\t\t\tfor(var i = 0, len = vertices.length; i < len; i ++){\n\t\t\t\thash[vertices[i]] = {id: vertices[i], $source:[], $target:[], $incoming: 0};\n\t\t\t}\n\n\t\t\tfor(var i = 0, len = edges.length; i < len; i++){\n\t\t\t\tvar successor = hash[edges[i].target];\n\t\t\t\tsuccessor.$target.push(i);\n\t\t\t\tsuccessor.$incoming = successor.$target.length;\n\t\t\t\thash[edges[i].source].$source.push(i);\n\n\t\t\t}\n\n\t\t\t// topological sort, Kahn's algorithm\n\t\t\tvar S = vertices.filter(function(v){ return !hash[v].$incoming; });\n\n\t\t\tvar L = [];\n\n\t\t\twhile(S.length){\n\t\t\t\tvar n = S.pop();\n\n\t\t\t\tL.push(n);\n\n\t\t\t\tvar node = hash[n];\n\n\t\t\t\tfor(var i = 0; i < node.$source.length; i++){\n\t\t\t\t\tvar m = hash[edges[node.$source[i]].target];\n\t\t\t\t\tm.$incoming--;\n\t\t\t\t\tif(!m.$incoming){\n\t\t\t\t\t\tS.push(m.id);\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn L;\n\n\t\t},\n\t\tgroupAdjacentEdges: function(edges){\n\t\t\tvar res = {};\n\t\t\tvar edge;\n\t\t\tfor(var i = 0, len = edges.length; i < len; i++){\n\t\t\t\tedge = edges[i];\n\t\t\t\tif(!res[edge.source]){\n\t\t\t\t\tres[edge.source] = [];\n\t\t\t\t}\n\t\t\t\tres[edge.source].push(edge);\n\t\t\t}\n\t\t\treturn res;\n\t\t},\n\t\ttarjanStronglyConnectedComponents: function(vertices, edges){\n\t\t\t//https://en.wikipedia.org/wiki/Tarjan%27s_strongly_connected_components_algorithm\n\t\t\t// iterative implementation\n\t\t\tvar verticesHash = {};\n\t\t\tvar stack = [];\n\t\t\tvar edgesFromTasks = this.groupAdjacentEdges(edges);\n\t\t\tvar recurse = false;\n\t\t\tvar connectedComponents = [];\n\n\t\t\tfor(var i = 0; i < vertices.length; i++){\n\t\t\t\tvar root = getVertex(vertices[i]);\n\t\t\t\tif(root.visited) continue;\n\t\t\t\tvar workStack = [root];\n\t\t\t\tvar index = 0;\n\t\t\t\twhile(workStack.length){\n\t\t\t\t\tvar v = workStack.pop();\n\n\t\t\t\t\tif(!v.visited){\n\t\t\t\t\t\tv.index = index;\n\t\t\t\t\t\tv.lowLink = index;\n\t\t\t\t\t\tindex++;\n\t\t\t\t\t\tstack.push(v);\n\t\t\t\t\t\tv.onStack = true;\n\t\t\t\t\t\tv.visited = true;\n\t\t\t\t\t}\n\t\t\t\t\trecurse = false;\n\t\t\t\t\tvar edges = edgesFromTasks[v.id] || [];\n\t\t\t\t\tfor(var e = 0; e < edges.length; e++){\n\t\t\t\t\t\tvar w = getVertex(edges[e].target);\n\t\t\t\t\t\tw.edge = edges[e];\n\t\t\t\t\t\tif(w.index === undefined){\n\t\t\t\t\t\t\tworkStack.push(v);\n\t\t\t\t\t\t\tworkStack.push(w);\n\t\t\t\t\t\t\trecurse = true;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}else if(w.onStack){\n\t\t\t\t\t\t\tv.lowLink = Math.min(v.lowLink, w.index);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(recurse)\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\tif (v.index == v.lowLink){\n\t\t\t\t\t\tvar com = {tasks:[], links:[], linkKeys:[]};\n\t\t\t\t\t\twhile(true){\n\t\t\t\t\t\t\tw = stack.pop();\n\t\t\t\t\t\t\tw.onStack = false;\n\t\t\t\t\t\t\tcom.tasks.push(w.id);\n\t\t\t\t\t\t\tif(w.edge){\n\t\t\t\t\t\t\t\tcom.links.push(w.edge.id);\n\t\t\t\t\t\t\t\tcom.linkKeys.push(w.edge.hashSum);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(w == v){\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconnectedComponents.push(com);\n\t\t\t\t\t}\n\t\t\t\t\tif(workStack.length){\n\t\t\t\t\t\tw = v;\n\t\t\t\t\t\tv = workStack[workStack.length - 1];\n\t\t\t\t\t\tv.lowLink = Math.min(v.lowLink, w.lowLink);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn connectedComponents;\n\n\t\t\tfunction getVertex(id){\n\t\t\t\tif(!verticesHash[id]){\n\t\t\t\t\tverticesHash[id] = {id: id, onStack:false, index: undefined, lowLink: undefined, edge: undefined};\n\t\t\t\t}\n\n\t\t\t\treturn verticesHash[id];\n\t\t\t}\n\t\t},\n\n\t\tfindLoops: function(relations){\n\t\t\tvar cycles = [];\n\n\t\t\thelpers.forEach(relations, function(rel){\n\t\t\t\tif(rel.target == rel.source)\n\t\t\t\t\tcycles.push({ tasks: [rel.source], links: [rel.id]});\n\t\t\t});\n\n\t\t\tvar vertices = this.getVertices(relations);\n\n\t\t\tvar connectedComponents = this.tarjanStronglyConnectedComponents(vertices, relations);\n\t\t\thelpers.forEach(connectedComponents, function(component){\n\t\t\t\tif(component.tasks.length > 1){\n\t\t\t\t\tcycles.push(component);//{ tasks: [task ids], links: [links ids]}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn cycles;\n\t\t\t//{task:id, link:link.type, lag: link.lag || 0, source: link.source}\n\t\t}\n\t};\n};","export default function(gantt) {\n\treturn {\n\t\tgetVirtualRoot: function(){\n\t\t\treturn gantt.mixin(\n\t\t\t\tgantt.getSubtaskDates(),\n\t\t\t\t{\n\t\t\t\t\tid: gantt.config.root_id,\n\t\t\t\t\ttype: gantt.config.types.project,\n\t\t\t\t\t$source: [],\n\t\t\t\t\t$target: [],\n\t\t\t\t\t$virtual: true\n\t\t\t\t}\n\t\t\t);\n\t\t},\n\t\n\t\tgetLinkedTasks: function(id, includePredecessors){\n\t\t\tvar startIds = [id];\n\t\n\t\t\t//TODO: format links cache\n\t\t\tvar clearCache = false;\n\t\t\tif(!gantt._isLinksCacheEnabled()) {\n\t\t\t\tgantt._startLinksCache();\n\t\t\t\tclearCache = true;\n\t\t\t}\n\t\t\tvar relations = [];\n\t\t\tvar visited = {};\n\t\t\tvar result = {};\n\t\t\tfor(var i = 0; i < startIds.length; i++){\n\t\t\t\tthis._getLinkedTasks(startIds[i], visited, includePredecessors, result);\n\t\t\t}\n\t\n\t\t\tfor(var i in result){\n\t\t\t\trelations.push(result[i]);\n\t\t\t}\n\t\n\t\t\t//TODO: remove redundant edges before continue https://en.wikipedia.org/wiki/Transitive_reduction\n\t\t\tif(clearCache)\n\t\t\t\tgantt._endLinksCache();\n\t\t\treturn relations;\n\t\t},\n\t\n\t\t_collectRelations: function(rootObj, isChild, includePredecessors, visitedLinks){\n\t\t\tvar successors = gantt._getSuccessors(rootObj, isChild);\n\t\n\t\t\tvar predecessors = [];\n\t\t\tif (includePredecessors) {\n\t\t\t\tpredecessors = gantt._getPredecessors(rootObj, isChild);\n\t\t\t}\n\t\t\t\n\t\t\tvar linkKey;\n\t\t\tvar relations = [];\n\t\t\tfor(var i = 0; i < successors.length; i++){\n\t\t\t\tlinkKey = successors[i].hashSum;\n\t\t\t\tif(visitedLinks[linkKey]) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}else{\n\t\t\t\t\tvisitedLinks[linkKey] = true;\n\t\t\t\t\trelations.push(successors[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(var i = 0; i < predecessors.length; i++){\n\t\t\t\tlinkKey = predecessors[i].hashSum;\n\t\t\t\tif(visitedLinks[linkKey]) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}else{\n\t\t\t\t\tvisitedLinks[linkKey] = true;\n\t\t\t\t\trelations.push(predecessors[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn relations;\n\t\t},\n\t\t_getLinkedTasks: function(rootTask, visitedTasks, includePredecessors, output) {\n\t\t\tvar from = rootTask === undefined ? gantt.config.root_id : rootTask;\n\t\t\tvar visitedTasks = {};\n\t\t\tvar visitedLinks = {};\n\t\t\tvar rootObj;\n\t\n\t\t\tvar tasksStack = [{from: from, includePredecessors: includePredecessors, isChild:false}];\n\t\n\t\t\twhile(tasksStack.length){\n\t\t\t\tvar current = tasksStack.pop();\n\t\t\t\tvar isChild = current.isChild;\n\t\n\t\t\t\tfrom = current.from;\n\t\t\t\tif(visitedTasks[from]){\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\trootObj = gantt.isTaskExists(from) ? gantt.getTask(from) : this.getVirtualRoot();\n\t\t\t\tvisitedTasks[from] = true;\n\t\t\t\t\n\t\t\t\tvar relations = this._collectRelations(rootObj, isChild, includePredecessors, visitedLinks);\n\t\n\t\t\t\tfor(var i=0; i < relations.length; i++){\n\t\t\t\t\tvar rel = relations[i];\n\n\t\t\t\t\tlet includeRelation = true;\n\t\t\t\t\tif(gantt._getAutoSchedulingConfig().use_progress){\n\t\t\t\t\t\tconst target = gantt.getTask(rel.target);\n\t\t\t\t\t\tif(target.progress == 1){\n\t\t\t\t\t\t\tincludeRelation = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// don't process links for unscheduled tasks\n\t\t\t\t\tconst target = gantt.getTask(rel.target);\n\t\t\t\t\tconst source = gantt.getTask(rel.source);\n\t\t\t\t\tif (target.unscheduled || source.unscheduled){\n\t\t\t\t\t\tincludeRelation = false;\n\t\t\t\t\t}\n\n\t\t\t\t\tif(includeRelation){\n\t\t\t\t\t\toutput[rel.hashSum] = rel;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar isSameParent = rel.sourceParent == rel.targetParent;\n\t\t\t\t\tvar targetTask = rel.target;\n\t\t\t\t\tif(!visitedTasks[targetTask])\n\t\t\t\t\t\ttasksStack.push({from: rel.target, includePredecessors: true, isChild: isSameParent});\n\t\t\t\t}\n\t\n\t\t\t\tif(gantt.hasChild(rootObj.id)){\n\t\t\t\t\tvar children = gantt.getChildren(rootObj.id);\n\t\t\t\t\tfor(var i=0; i < children.length; i++){\n\t\t\t\t\t\tif(!visitedTasks[children[i]])\n\t\t\t\t\t\t\ttasksStack.push({from: children[i], includePredecessors: true, isChild: true});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\treturn output;\n\t\t}\n\t};\n};","export enum ConstraintTypes {\n\t// As Soon As Possible (ASAP)\n\tASAP = \"asap\",\n\t// As Late As Possible (ALAP)\n\tALAP = \"alap\",\n\t// Start No Earlier Than (SNET)\n\tSNET = \"snet\",\n\t// Start No Later Than (SNLT)\n\tSNLT = \"snlt\",\n\t// Finish No Earlier Than (FNET)\n\tFNET = \"fnet\",\n\t// Finish No Later Than (FNLT)\n\tFNLT = \"fnlt\",\n\t// Must Start On (MSO)\n\tMSO = \"mso\",\n\t// Must Finish On (MFO)\n\tMFO = \"mfo\"\n}","//returns position of html element on the page\nfunction getNodePosition(elem) {\n\tvar top=0, left=0, right=0, bottom=0;\n\tif (elem.getBoundingClientRect) { //HTML5 method\n\t\tvar box = elem.getBoundingClientRect();\n\t\tvar body = document.body;\n\t\tvar docElem = (document.documentElement ||\n\t\t\tdocument.body.parentNode ||\n\t\t\tdocument.body);\n\n\t\tvar scrollTop = window.pageYOffset || docElem.scrollTop || body.scrollTop;\n\t\tvar scrollLeft = window.pageXOffset || docElem.scrollLeft || body.scrollLeft;\n\t\tvar clientTop = docElem.clientTop || body.clientTop || 0;\n\t\tvar clientLeft = docElem.clientLeft || body.clientLeft || 0;\n\t\ttop  = box.top +  scrollTop - clientTop;\n\t\tleft = box.left + scrollLeft - clientLeft;\n\n\t\tright = document.body.offsetWidth - box.right;\n\t\tbottom = document.body.offsetHeight - box.bottom;\n\t} else { //fallback to naive approach\n\t\twhile(elem) {\n\t\t\ttop = top + parseInt(elem.offsetTop,10);\n\t\t\tleft = left + parseInt(elem.offsetLeft,10);\n\t\t\telem = elem.offsetParent;\n\t\t}\n\n\t\tright = document.body.offsetWidth - elem.offsetWidth - left;\n\t\tbottom = document.body.offsetHeight - elem.offsetHeight - top;\n\t}\n\treturn { y: Math.round(top), x: Math.round(left), width:elem.offsetWidth, height:elem.offsetHeight, right: Math.round(right), bottom: Math.round(bottom) };\n}\n\nfunction isVisible(node){\n\tvar display = false,\n\t\tvisibility = false;\n\tif(window.getComputedStyle){\n\t\tvar style = window.getComputedStyle(node, null);\n\t\tdisplay = style[\"display\"];\n\t\tvisibility = style[\"visibility\"];\n\t}else if(node.currentStyle){\n\t\tdisplay = node.currentStyle[\"display\"];\n\t\tvisibility = node.currentStyle[\"visibility\"];\n\t}\n\treturn (display != \"none\" && visibility != \"hidden\");\n}\n\nfunction hasNonNegativeTabIndex(node){\n\treturn !isNaN(node.getAttribute(\"tabindex\")) && (node.getAttribute(\"tabindex\")*1 >= 0);\n}\n\nfunction hasHref(node){\n\tvar canHaveHref = {\"a\": true, \"area\": true};\n\tif(canHaveHref[node.nodeName.loLowerCase()]){\n\t\treturn !!node.getAttribute(\"href\");\n\t}\n\treturn true;\n}\n\nfunction isEnabled(node){\n\tvar canDisable = {\"input\":true, \"select\":true, \"textarea\":true, \"button\":true, \"object\":true};\n\tif(canDisable[node.nodeName.toLowerCase()]){\n\t\treturn !node.hasAttribute(\"disabled\");\n\t}\n\n\treturn true;\n}\n\nfunction getFocusableNodes(root){\n\tvar nodes = root.querySelectorAll([\n\t\t\"a[href]\",\n\t\t\"area[href]\",\n\t\t\"input\",\n\t\t\"select\",\n\t\t\"textarea\",\n\t\t\"button\",\n\t\t\"iframe\",\n\t\t\"object\",\n\t\t\"embed\",\n\t\t\"[tabindex]\",\n\t\t\"[contenteditable]\"\n\t].join(\", \"));\n\n\tvar nodesArray = Array.prototype.slice.call(nodes, 0);\n\t\n\tfor(var i = 0; i < nodesArray.length; i++){\n\t\tnodesArray[i].$position = i;\n\t\t// we remember original nodes order, \n\t\t// so when we sort them by tabindex we ensure order of nodes with same tabindex is preserved, \n\t\t// since some browsers do unstable sort\n\t}\n\t\n\t// use tabindex to sort focusable nodes\n\tnodesArray.sort(function(a, b) {\n\t\tif(a.tabIndex === 0 && b.tabIndex !== 0){\n\t\t\treturn 1;\n\t\t}\n\t\tif(a.tabIndex !== 0 && b.tabIndex === 0){\n\t\t\treturn -1;\n\t\t}\n\t\t\n\t\tif (a.tabIndex === b.tabIndex){\n\t\t\t// ensure we do stable sort\n\t\t\treturn a.$position - b.$position;\n\t\t}\n\t\tif (a.tabIndex < b.tabIndex) {\n\t\t\treturn -1;\n\t\t}\n\t\treturn 1;\n\t});\n\t\n\tfor(var i = 0; i < nodesArray.length; i++){\n\t\tvar node = nodesArray[i];\n\t\tvar isValid = (hasNonNegativeTabIndex(node)  || isEnabled(node) || hasHref(node)) && isVisible(node);\n\t\tif(!isValid){\n\t\t\tnodesArray.splice(i, 1);\n\t\t\ti--;\n\t\t}\n\t}\n\treturn nodesArray;\n}\n\nfunction getScrollSize(){\n\tvar div = document.createElement(\"div\");\n\tdiv.style.cssText=\"visibility:hidden;position:absolute;left:-1000px;width:100px;padding:0px;margin:0px;height:110px;min-height:100px;overflow-y:scroll;\";\n\n\tdocument.body.appendChild(div);\n\tvar width = div.offsetWidth-div.clientWidth;\n\tdocument.body.removeChild(div);\n\n\treturn Math.max(width, 15);\n}\n\nfunction getClassName(node){\n\tif(!node) return \"\";\n\n\tvar className = node.className || \"\";\n\tif(className.baseVal)//'className' exist but not a string - IE svg element in DOM\n\t\tclassName = className.baseVal;\n\n\tif(!className.indexOf)\n\t\tclassName = \"\";\n\n\treturn _trimString(className);\n}\n\nfunction addClassName(node, className){\n\tif (className && node.className.indexOf(className) === -1) {\n\t\tnode.className += \" \" + className;\n\t}\n}\n\nfunction removeClassName(node, name) {\n\tname = name.split(\" \");\n\tfor (var i = 0; i < name.length; i++) {\n\t\tvar regEx = new RegExp(\"\\\\s?\\\\b\" + name[i] + \"\\\\b(?![-_.])\", \"\");\n\t\tnode.className = node.className.replace(regEx, \"\");\n\t}\n}\n\nfunction hasClass(element, className){\n\tif ('classList' in element) {\n\t\treturn element.classList.contains(className);\n\t} else { \n\t\treturn new RegExp(\"\\\\b\" + className + \"\\\\b\").test(element.className);\n\t}\n}\n\nfunction toNode(node) {\n\tif (typeof node === \"string\") {\n\t\treturn (document.getElementById(node) || document.querySelector(node) || document.body);\n\t}\n\treturn node || document.body;\n}\n\nvar _slave;\nfunction insertNode(node, newone) {\n\tif(!_slave){\n\t\t_slave = document.createElement(\"div\");\n\t}\n\t_slave.innerHTML = newone;\n\tvar child = _slave.firstChild;\n\tnode.appendChild(child);\n\treturn child;\n}\n\nfunction removeNode(node) {\n\tif (node && node.parentNode) {\n\t\tnode.parentNode.removeChild(node);\n\t}\n}\n\nfunction getChildNodes(node, css) {\n\tvar ch = node.childNodes;\n\tvar len = ch.length;\n\tvar out = [];\n\tfor (var i = 0; i < len; i++) {\n\t\tvar obj = ch[i];\n\t\tif (obj.className && obj.className.indexOf(css) !== -1) {\n\t\t\tout.push(obj);\n\t\t}\n\t}\n\treturn out;\n}\n\nfunction getTargetNode(e) {\n\tvar trg;\n\tif (e.tagName)\n\t\ttrg = e;\n\telse {\n\t\te = e || window.event;\n\t\ttrg = e.target || e.srcElement;\n\t\tif (trg.shadowRoot && e.composedPath) {\n\t\t\ttrg = e.composedPath()[0];\n\t\t}\n\t}\n\treturn trg;\n}\n\nfunction locateAttribute(e, attribute) {\n\tif(!attribute) return;\n\n\tvar trg = getTargetNode(e);\n\n\twhile (trg){\n\t\tif (trg.getAttribute){\t//text nodes has not getAttribute\n\t\t\tvar test = trg.getAttribute(attribute);\n\t\t\tif (test) return trg;\n\t\t}\n\t\t// GS-2941. With the `host`, Gantt will continue iteration outside the ShadowDOM\n\t\ttrg = trg.parentNode || trg.host;\n\t}\n\treturn null;\n}\n\nfunction _trimString(str){\n\tvar func = String.prototype.trim || function(){ return this.replace(/^\\s+|\\s+$/g, \"\"); };\n\treturn func.apply(str);\n}\n\nfunction locateClassName(e, classname, strict){\n\tvar trg = getTargetNode(e);\n\tvar css = \"\";\n\n\tif(strict === undefined)\n\t\tstrict = true;\n\n\twhile (trg){\n\t\tcss = getClassName(trg);\n\t\tif(css){\n\t\t\tvar ind = css.indexOf(classname);\n\t\t\tif (ind >= 0){\n\t\t\t\tif (!strict)\n\t\t\t\t\treturn trg;\n\n\t\t\t\t//check that we have exact match\n\t\t\t\tvar left = (ind === 0) || (!_trimString(css.charAt(ind - 1)));\n\t\t\t\tvar right = ((ind + classname.length >= css.length)) || (!_trimString(css.charAt(ind + classname.length)));\n\n\t\t\t\tif (left && right)\n\t\t\t\t\treturn trg;\n\t\t\t}\n\t\t}\n\t\ttrg=trg.parentNode;\n\t}\n\treturn null;\n}\n\n/*\nevent position relatively to DOM element\n */\nfunction getRelativeEventPosition(ev, node){\n\tconst d = document.documentElement;\n\tconst box = getNodePosition(node);\n\t//GS-2809: condition to check event(mouse or touch)\n\tconst { clientX, clientY } = ev.touches?.[0] ?? ev;\n\treturn {\n\t\tx: clientX + d.scrollLeft - d.clientLeft - box.x + node.scrollLeft,\n\t\ty: clientY + d.scrollTop - d.clientTop - box.y + node.scrollTop\n\t};\n}\n\nfunction getRelativeNodePosition(child, parent){\n\tconst childPos = getNodePosition(child);\n\tconst parentPos = getNodePosition(parent);\n\treturn {\n\t\tx: childPos.x - parentPos.x,\n\t\ty: childPos.y - parentPos.y\n\t};\n}\n\nfunction isChildOf(child, parent){\n\tif(!child || !parent){\n\t\treturn false;\n\t}\n\n\twhile(child && child != parent) {\n\t\tchild = child.parentNode;\n\t}\n\n\treturn child === parent;\n}\n\nfunction closest(element, selector){\n\tif(element.closest){\n\t\treturn element.closest(selector);\n\t}else if(element.matches || element.msMatchesSelector || element.webkitMatchesSelector){\n\t\tvar el = element;\n\t\tif (!document.documentElement.contains(el)) return null;\n\t\tdo {\n\t\t\tvar method = el.matches || el.msMatchesSelector || el.webkitMatchesSelector;\n\n\t\t\tif (method.call(el, selector)) return el;\n\t\t\tel = el.parentElement || el.parentNode;\n\t\t} while (el !== null && el.nodeType === 1); \n\t\treturn null;\n\t}else{\n\t\t// eslint-disable-next-line no-console\n\t\tconsole.error(\"Your browser is not supported\");\n\t\treturn null;\n\t}\n}\n\nfunction getClosestSizedElement(element) {\n\twhile (element) {\n\t\tif (element.offsetWidth > 0 && element.offsetHeight > 0) {\n\t\t\treturn element;\n\t\t}\n\t\telement = element.parentElement;\n\t}\n\treturn null;\n}\n\nfunction isShadowDomSupported() {\n\treturn document.head.createShadowRoot || document.head.attachShadow;\n}\n\n/**\n * Returns element that has the browser focus, or null if no element has focus.\n * Works with shadow DOM, so it's prefereed to use this function instead of document.activeElement directly.\n * @returns HTMLElement\n */\nfunction getActiveElement(){\n\tvar activeElement = document.activeElement;\n\tif (activeElement.shadowRoot) {\n\t\tactiveElement = activeElement.shadowRoot.activeElement;\n\t}\n\tif (activeElement === document.body && document.getSelection) {\n\t\tactiveElement = document.getSelection().focusNode || document.body;\n\t}\n\n\treturn activeElement;\n}\n\n/**\n * Returns document.body or the host node of the ShadowRoot, if the element is attached to ShadowDom\n * @param {HTMLElement} element \n * @returns HTMLElement\n */\nfunction getRootNode(element) {\n\tif (!element) {\n\t\treturn document.body;\n\t}\n\tif (!isShadowDomSupported()) {\n\t\treturn document.body;\n\t}\n\twhile (element.parentNode && (element = element.parentNode)) {\n\t\tif (element instanceof ShadowRoot) {\n\t\t\treturn element.host;\n\t\t}\n\t}\n\treturn document.body;\n}\n\nfunction hasShadowParent(element) {\n\treturn !!getRootNode(element);\n}\n\nexport {\n\tgetNodePosition,\n\tgetFocusableNodes,\n\tgetScrollSize,\n\tgetClassName,\n\taddClassName,\n\tremoveClassName,\n\tinsertNode,\n\tremoveNode,\n\tgetChildNodes,\n\ttoNode,\n\tlocateClassName,\n\tlocateAttribute,\n\tgetTargetNode,\n\tgetRelativeEventPosition,\n\tisChildOf,\n\thasClass,\n\tclosest,\n\tgetRootNode,\n\thasShadowParent,\n\tisShadowDomSupported,\n\tgetActiveElement,\n\tgetRelativeNodePosition,\n\tgetClosestSizedElement\n};","export class TaskPlan implements ITaskPlan {\n\tstatic Create(parent?: TaskPlan): TaskPlan {\n\t\tconst plan = new TaskPlan();\n\t\tif (parent) {\n\t\t\tfor (const i in plan) {\n\t\t\t\tif (parent[i] !== undefined) {\n\t\t\t\t\tplan[i] = parent[i];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn plan;\n\t}\n\n\tpublic link: string | number;\n\tpublic task: string | number;\n\t// tslint:disable-next-line variable-name\n\tpublic start_date: Date | null;\n\t// tslint:disable-next-line variable-name\n\tpublic end_date: Date | null;\n\n\tpublic latestStart: Date;\n\tpublic earliestStart: Date;\n\tpublic earliestEnd: Date;\n\tpublic latestEnd: Date;\n\n\tpublic latestSchedulingStart: Date;\n\tpublic earliestSchedulingStart: Date;\n\tpublic latestSchedulingEnd: Date;\n\tpublic earliestSchedulingEnd: Date;\n\n\tpublic kind: string;\n\tpublic conflict: boolean;\n\n\tconstructor() {\n\t\tthis.link = null;\n\t\tthis.task = null;\n\t\tthis.start_date = null;\n\t\tthis.end_date = null;\n\t\tthis.latestStart = null;\n\t\tthis.earliestStart = null;\n\t\tthis.earliestEnd = null;\n\t\tthis.latestEnd = null;\n\t\tthis.latestSchedulingStart = null;\n\t\tthis.earliestSchedulingStart = null;\n\t\tthis.latestSchedulingEnd = null;\n\t\tthis.earliestSchedulingEnd = null;\n\t\tthis.kind = \"asap\";\n\t\tthis.conflict = false;\n\t}\n}","import * as helpers from \"../../utils/helpers\";\nimport { ConstraintTypes } from \"./constraint_types\";\nimport { TaskPlan } from \"./task_plan\";\n\nexport class ConstraintsHelper {\n\tstatic Create(gantt: any): ConstraintsHelper {\n\t\treturn new ConstraintsHelper(gantt);\n\t}\n\n\tprivate _gantt: any;\n\tprivate constructor(gantt: any) {\n\t\tthis._gantt = gantt;\n\t}\n\n\tisAsapTask = (task: ITask): boolean => {\n\t\tconst constraintType = this.getConstraintType(task);\n\t\tconst autoSchedulingConfig = this._gantt._getAutoSchedulingConfig();\n\t\tif (autoSchedulingConfig.schedule_from_end) {\n\t\t\tif (constraintType === ConstraintTypes.ASAP) {\n\t\t\t\treturn true;\n\t\t\t} else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t} else {\n\t\t\tif (constraintType === ConstraintTypes.ALAP) {\n\t\t\t\treturn false;\n\t\t\t} else {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t};\n\n\tisAlapTask = (task: ITask): boolean => {\n\t\treturn !this.isAsapTask(task);\n\t};\n\n\tgetConstraintType = (task: ITask): ConstraintTypes => {\n\t\t// GS-1487. Don't add a constraint if auto-scheduling is cancelled\n\t\tif (!this._gantt._isAutoSchedulable(task)){\n\t\t\treturn;\n\t\t}\n\n\t\tconst constraint = this._getTaskConstraint(task);\n\t\tconst autoSchedulingConfig = this._gantt._getAutoSchedulingConfig();\n\n\t\t// in case of backward scheduling, tasks without explicit constraints are considered ALAP tasks\n\t\tif (constraint.constraint_type) {\n\t\t\treturn constraint.constraint_type;\n\t\t} else if (autoSchedulingConfig.schedule_from_end) {\n\t\t\treturn ConstraintTypes.ALAP;\n\t\t} else {\n\t\t\treturn ConstraintTypes.ASAP;\n\t\t}\n\t};\n\n\t_getTaskConstraint = (task: ITask) => {\n\n\t\tlet constraint = this._getOwnConstraint(task);\n\t\tconst autoSchedulingConfig = this._gantt._getAutoSchedulingConfig();\n\n\t\t// GS-2231. Child task shouldn't inherit constraints in the group mode\n\t\tif(autoSchedulingConfig.project_constraint && !this._gantt.getState().group_mode){\n\n\t\t\tlet defaultConstraintType = ConstraintTypes.ASAP;\n\t\t\tif(autoSchedulingConfig.schedule_from_end){\n\t\t\t\tdefaultConstraintType = ConstraintTypes.ALAP;\n\t\t\t}\n\n\t\t\tif((constraint && constraint.constraint_type) === defaultConstraintType || !constraint){\n\t\t\t\tconstraint = this._getParentConstraint(task);\n\t\t\t}\n\t\t}\n\n\t\treturn constraint;\n\t};\n\n\t_getOwnConstraint = (task: ITask) => {\n\t\treturn {\n\t\t\tconstraint_type: task.constraint_type,\n\t\t\tconstraint_date: task.constraint_date\n\t\t};\n\t};\n\n\t_getParentConstraint = (task: ITask) => {\n\t\tconst autoSchedulingConfig = this._gantt._getAutoSchedulingConfig();\n\t\tlet defaultConstraintType = ConstraintTypes.ASAP;\n\t\tif(autoSchedulingConfig.schedule_from_end){\n\t\t\tdefaultConstraintType = ConstraintTypes.ALAP;\n\t\t}\n\n\t\tlet constraint = {\n\t\t\tconstraint_type: defaultConstraintType,\n\t\t\tconstraint_date: null\n\t\t};\n\n\t\tthis._gantt.eachParent((parent) => {\n\t\t\tif(constraint.constraint_type !== defaultConstraintType){\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif(parent.constraint_type && parent.constraint_type !== defaultConstraintType){\n\t\t\t\tconstraint = {\n\t\t\t\t\tconstraint_type: parent.constraint_type,\n\t\t\t\t\tconstraint_date: parent.constraint_date\n\t\t\t\t};\n\t\t\t}\n\t\t}, task.id);\n\t\treturn constraint;\n\t};\n\n\thasConstraint = (task: ITask): boolean => {\n\t\treturn !!this.getConstraintType(task);\n\t};\n\n\tprocessConstraint = (task: ITask, plan: TaskPlan): TaskPlan => {\n\t\tconst constraint = this._getTaskConstraint(task);\n\n\t\tif (constraint) {\n\t\t\tif (\n\t\t\t\tconstraint.constraint_type === ConstraintTypes.ALAP ||\n\t\t\t\tconstraint.constraint_type === ConstraintTypes.ASAP\n\t\t\t) {\n\t\t\t\t// this kind of constraint is calculated after main scheduling\n\t\t\t} else if(helpers.isValidDate(constraint.constraint_date)) {\n\t\t\t\tconst constraintDate = constraint.constraint_date;\n\n\t\t\t\tconst newPlan = TaskPlan.Create(plan);\n\t\t\t\tnewPlan.task = task.id;\n\n\t\t\t\tswitch (constraint.constraint_type) {\n\t\t\t\t\tcase ConstraintTypes.SNET:\n\t\t\t\t\t\tnewPlan.earliestStart = new Date(constraintDate);\n\t\t\t\t\t\tnewPlan.earliestEnd = this._gantt.calculateEndDate({\n\t\t\t\t\t\t\tstart_date: newPlan.earliestStart,\n\t\t\t\t\t\t\tduration: task.duration,\n\t\t\t\t\t\t\ttask\n\t\t\t\t\t\t});\n\t\t\t\t\t\tnewPlan.link = null;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase ConstraintTypes.SNLT:\n\t\t\t\t\t\tnewPlan.latestStart = new Date(constraintDate);\n\t\t\t\t\t\tnewPlan.latestEnd = this._gantt.calculateEndDate({\n\t\t\t\t\t\t\tstart_date: newPlan.latestStart,\n\t\t\t\t\t\t\tduration: task.duration,\n\t\t\t\t\t\t\ttask\n\t\t\t\t\t\t});\n\t\t\t\t\t\tnewPlan.link = null;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase ConstraintTypes.FNET:\n\t\t\t\t\t\tnewPlan.earliestStart = this._gantt.calculateEndDate({\n\t\t\t\t\t\t\tstart_date: constraintDate,\n\t\t\t\t\t\t\tduration: -task.duration,\n\t\t\t\t\t\t\ttask\n\t\t\t\t\t\t});\n\t\t\t\t\t\tnewPlan.earliestEnd = new Date(constraintDate);\n\t\t\t\t\t\tnewPlan.link = null;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase ConstraintTypes.FNLT:\n\t\t\t\t\t\tnewPlan.latestStart = this._gantt.calculateEndDate({\n\t\t\t\t\t\t\tstart_date: constraintDate,\n\t\t\t\t\t\t\tduration: -task.duration,\n\t\t\t\t\t\t\ttask\n\t\t\t\t\t\t});\n\t\t\t\t\t\tnewPlan.latestEnd = new Date(constraintDate);\n\t\t\t\t\t\tnewPlan.link = null;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase ConstraintTypes.MSO:\n\t\t\t\t\t\tnewPlan.earliestStart = new Date(constraintDate);\n\t\t\t\t\t\tnewPlan.earliestEnd = this._gantt.calculateEndDate({\n\t\t\t\t\t\t\tstart_date: newPlan.earliestStart,\n\t\t\t\t\t\t\tduration: task.duration,\n\t\t\t\t\t\t\ttask\n\t\t\t\t\t\t});\n\t\t\t\t\t\tnewPlan.latestStart = newPlan.earliestStart;\n\t\t\t\t\t\tnewPlan.latestEnd = newPlan.earliestEnd;\n\t\t\t\t\t\tnewPlan.link = null;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase ConstraintTypes.MFO:\n\t\t\t\t\t\tnewPlan.earliestStart = this._gantt.calculateEndDate({\n\t\t\t\t\t\t\tstart_date: constraintDate,\n\t\t\t\t\t\t\tduration: -task.duration,\n\t\t\t\t\t\t\ttask\n\t\t\t\t\t\t});\n\t\t\t\t\t\tnewPlan.earliestEnd = this._gantt.calculateEndDate({\n\t\t\t\t\t\t\tstart_date: newPlan.earliestStart,\n\t\t\t\t\t\t\tduration: task.duration,\n\t\t\t\t\t\t\ttask\n\t\t\t\t\t\t});\n\t\t\t\t\t\tnewPlan.latestStart = newPlan.earliestStart;\n\t\t\t\t\t\tnewPlan.latestEnd = newPlan.earliestEnd;\n\t\t\t\t\t\tnewPlan.link = null;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\treturn newPlan;\n\t\t\t}\n\t\t}\n\n\t\treturn plan;\n\t};\n\n\tgetConstraints = (id: TaskID, relations: IInternalLink[]): ITask[] => {\n\t\tconst result = [];\n\t\tconst tasks = {};\n\n\t\tconst store = (task: any) => {\n\t\t\tif (tasks[task.id]) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.hasConstraint(task) && !this._gantt.isSummaryTask(task)) {\n\t\t\t\ttasks[task.id] = task;\n\t\t\t}\n\t\t};\n\n\t\tif (this._gantt.isTaskExists(id)) {\n\t\t\tconst task = this._gantt.getTask(id);\n\t\t\tstore(task);\n\t\t}\n\n\t\tthis._gantt.eachTask(task => store(task), id);\n\n\t\tlet current;\n\t\tif (relations) {\n\t\t\tfor (let i = 0; i < relations.length; i++) {\n\t\t\t\tconst rel = relations[i];\n\t\t\t\tif (!tasks[rel.target]) {\n\t\t\t\t\tcurrent = this._gantt.getTask(rel.target);\n\t\t\t\t\tstore(current);\n\t\t\t\t}\n\t\t\t\tif (!tasks[rel.source]) {\n\t\t\t\t\tcurrent = this._gantt.getTask(rel.source);\n\t\t\t\t\tstore(current);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor (const taskId in tasks) {\n\t\t\t// GS-745 do not auto-schedule placeholders\n\t\t\tif (tasks[taskId].type !== this._gantt.config.types.placeholder) {\n\t\t\t\tresult.push(tasks[taskId]);\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t};\n}\n","export default class DateComparator  {\n\tprotected _gantt: any;\n\n\tconstructor(gantt) {\n\t\tthis._gantt = gantt;\n\t}\n\n\tpublic isEqual(dateA: Date, dateB: Date, task: ITask): boolean {\n\t\treturn !this._gantt._hasDuration(dateA, dateB, task);\n\t}\n\n\tpublic isFirstSmaller(small: Date, big: Date, task: ITask): boolean {\n\t\tif (small.valueOf() < big.valueOf() && !this.isEqual(small, big, task)) {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tpublic isSmallerOrDefault(smallDate: Date, bigDate: Date, task: ITask): boolean {\n\t\treturn !!(!smallDate || this.isFirstSmaller(smallDate, bigDate, task));\n\t}\n\n\tpublic isGreaterOrDefault(smallDate: Date, bigDate: Date, task: ITask): boolean {\n\t\treturn !!(!smallDate || this.isFirstSmaller(bigDate, smallDate, task));\n\t}\n}","import DateComparator from \"./date_comparator\";\nimport { TaskPlan } from \"./task_plan\";\n\nexport class AlapStrategy implements ISchedulingStrategy {\n\tstatic Create(gantt: any): AlapStrategy {\n\t\tconst instance = new AlapStrategy();\n\t\tinstance._gantt = gantt;\n\t\tinstance._comparator = new DateComparator(gantt);\n\t\treturn instance;\n\t}\n\n\tprotected _gantt: any;\n\tprotected _comparator: DateComparator;\n\n\tresolveRelationDate(taskId: TaskID, adjacentLinks: ITaskRelations, plansHash: IPlansHash): TaskPlan {\n\t\tlet maxEnd = null;\n\t\tlet linkId = null;\n\t\tlet maxStart = null;\n\t\tlet defaultStart = null;\n\t\tconst task = this._gantt.getTask(taskId);\n\t\tconst relations = adjacentLinks.successors;\n\t\tlet maxRelationDate = null;\n\t\tconst masterPlan = plansHash[taskId];\n\t\tfor (let i = 0; i < relations.length; i++) {\n\t\t\tconst relation = relations[i];\n\n\t\t\t// .preferredStart still exists only to emulate pre 6.1 auto scheduling behavior\n\t\t\t// will be removed in future versions\n\t\t\t// TODO: remove .preferredStart in v7.0\n\t\t\tdefaultStart = relation.preferredStart;\n\t\t\tconst constraintDate = this.getLatestEndDate(relation, plansHash, task);\n\t\t\tconst constraintStartDate = this._gantt.calculateEndDate({ start_date: constraintDate, duration: - task.duration, task });\n\n\t\t\tif (this._comparator.isGreaterOrDefault(maxRelationDate, constraintDate, task)) {\n\t\t\t\tmaxRelationDate = constraintDate;\n\t\t\t}\n\t\t\tif (this._comparator.isGreaterOrDefault(defaultStart, constraintStartDate, task) && this._comparator.isGreaterOrDefault(maxEnd, constraintDate, task)) {\n\t\t\t\tmaxEnd = constraintDate;\n\t\t\t\tmaxStart = constraintStartDate;\n\t\t\t\tlinkId = relation.id;\n\t\t\t}\n\t\t}\n\n\t\tif (!relations.length && this._gantt.config.project_end) {\n\t\t\tif (this._comparator.isGreaterOrDefault(this._gantt.config.project_end, task.end_date, task)) {\n\t\t\t\tmaxEnd = this._gantt.config.project_end;\n\t\t\t}\n\t\t\t// GS-1152. don't process tasks with cancelled auto-scheduling\n\t\t\tif (this._gantt.callEvent(\"onBeforeTaskAutoSchedule\", [task, task.end_date]) === false) {\n\t\t\t\tmaxEnd = task.end_date;\n\t\t\t}\n\t\t}\n\n\t\tif (maxEnd) {\n\t\t\t// GS-1556. Tasks with zero duration shouldn't violate the project_end date\n\t\t\tif (task.duration){\n\t\t\t\tmaxEnd = this._gantt.getClosestWorkTime({ date: maxEnd, dir: \"future\", task });\n\t\t\t\tmaxStart = this._gantt.calculateEndDate({ start_date: maxEnd, duration: - task.duration, task });\n\t\t\t} else {\n\t\t\t\tmaxStart = maxEnd = this._gantt.getClosestWorkTime({ date: maxEnd, dir: \"past\", task });\n\t\t\t}\n\t\t}\n\n\t\tconst currentPlan = TaskPlan.Create(masterPlan);\n\n\t\tcurrentPlan.link = linkId;\n\t\tcurrentPlan.task = taskId;\n\t\tcurrentPlan.end_date = maxEnd;\n\t\tcurrentPlan.start_date = maxStart;\n\t\tcurrentPlan.kind = \"alap\";\n\n\t\tif (maxRelationDate) {\n\t\t\tcurrentPlan.latestSchedulingStart = this._gantt.calculateEndDate({ start_date: maxRelationDate, duration: - task.duration, task });\n\t\t\tcurrentPlan.latestSchedulingEnd = maxRelationDate;\n\t\t}\n\n\t\treturn currentPlan;\n\n\t}\n\n\tprotected getSuccessorStartDate(id: TaskID, plansHash: IPlansHash): Date {\n\t\tconst plan = plansHash[id];\n\t\tconst task = this._gantt.getTask(id);\n\t\tlet res;\n\n\t\tif (!(plan && (plan.start_date || plan.end_date))) {\n\t\t\tres = task.start_date;\n\t\t} else if (plan.start_date) {\n\t\t\tres = plan.start_date;\n\t\t} else {\n\t\t\tres = this._gantt.calculateEndDate({ start_date: plan.end_date, duration: - task.duration, task });\n\t\t}\n\n\t\treturn res;\n\t}\n\n\tprotected getLatestEndDate(relation: IInternalLink, plansHash: IPlansHash, task: ITask) {\n\t\tconst successorStart = this.getSuccessorStartDate(relation.target, plansHash);\n\t\tconst predecessor = task;\n\n\t\tlet predecessorEnd = this._gantt.getClosestWorkTime({ date: successorStart, dir: \"past\", task: predecessor });\n\n\t\tif (predecessorEnd && relation.lag && relation.lag * 1 === relation.lag * 1) {\n\t\t\tpredecessorEnd = this._gantt.calculateEndDate({ start_date: predecessorEnd, duration: -relation.lag * 1, task: predecessor });\n\t\t}\n\n\t\treturn predecessorEnd;\n\t}\n}","import DateComparator from \"./date_comparator\";\nimport { TaskPlan } from \"./task_plan\";\n\nexport class AsapStrategy implements ISchedulingStrategy {\n\tstatic Create(gantt: any): AsapStrategy {\n\t\tconst instance = new AsapStrategy();\n\t\tinstance._gantt = gantt;\n\t\tinstance._comparator = new DateComparator(gantt);\n\t\treturn instance;\n\t}\n\n\tprotected _gantt: any;\n\tprotected _comparator: DateComparator;\n\n\tresolveRelationDate(\n\t\ttaskId: TaskID,\n\t\tadjacentLinks: ITaskRelations,\n\t\tplansHash: IPlansHash\n\t): TaskPlan {\n\t\tlet minStart = null;\n\t\tlet linkId = null;\n\n\t\tlet defaultStart = null;\n\t\tconst task = this._gantt.getTask(taskId);\n\t\tconst relations = adjacentLinks.predecessors;\n\n\t\tconst autoSchedulingConfig = this._gantt._getAutoSchedulingConfig();\n\n\t\tconst autoScheduledDates = {};\n\t\tlet minRelationDate = null;\n\t\tfor (let i = 0; i < relations.length; i++) {\n\t\t\tconst relation = relations[i];\n\n\t\t\t// .preferredStart still exists only to emulate pre 6.1 auto scheduling behavior\n\t\t\t// will be removed in future versions\n\t\t\t// TODO: remove .preferredStart in v7.0\n\t\t\tdefaultStart = relation.preferredStart;\n\n\t\t\tconst constraintDate = this.getEarliestStartDate(\n\t\t\t\trelation,\n\t\t\t\tplansHash,\n\t\t\t\ttask\n\t\t\t);\n\n\t\t\tif (this._comparator.isSmallerOrDefault(minRelationDate, constraintDate, task)) {\n\t\t\t\tminRelationDate = constraintDate;\n\t\t\t}\n\t\t\tif (\n\t\t\t\tthis._comparator.isSmallerOrDefault(defaultStart, constraintDate, task) &&\n\t\t\t\tthis._comparator.isSmallerOrDefault(minStart, constraintDate, task)\n\t\t\t) {\n\t\t\t\tminStart = constraintDate;\n\t\t\t\tlinkId = relation.id;\n\t\t\t}\n\t\t\tif (!task.duration){\n\t\t\t\tconst link = this._gantt.getLink(relation.id);\n\t\t\t\tif (autoScheduledDates[link.type] === undefined){\n\t\t\t\t\tautoScheduledDates[link.type] = +constraintDate;\n\t\t\t\t}\n\t\t\t\telse if (autoScheduledDates[link.type] < +constraintDate){\n\t\t\t\t\tautoScheduledDates[link.type] = +constraintDate;\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\tif (!relations.length && this._gantt.config.project_start) {\n\t\t\tif (this._comparator.isSmallerOrDefault(task.start_date, this._gantt.config.project_start, task) ||\n\t\t\t// GS-403 - auto_scheduling_strict = true to schedule independent asap tasks to the earliest date, auto_scheduling_strict=false to keep the old behavior\n\t\t\t(autoSchedulingConfig.gap_behavior === \"compress\" && this._comparator.isGreaterOrDefault(task.start_date, this._gantt.config.project_start, task)\n\t\t\t)\n\t\t\t) {\n\t\t\t\tminStart = this._gantt.config.project_start;\n\t\t\t}\n\t\t\t// GS-1152. don't process tasks with cancelled auto-scheduling\n\t\t\tif (this._gantt.callEvent(\"onBeforeTaskAutoSchedule\", [task, task.start_date]) === false) {\n\t\t\t\tminStart = task.start_date;\n\t\t\t}\n\t\t}\n\n\t\tlet maxEnd = null;\n\t\tif (minStart) {\n\t\t\tif (task.duration) {\n\t\t\t\tminStart = this._gantt.getClosestWorkTime({\n\t\t\t\t\tdate: minStart,\n\t\t\t\t\tdir: \"future\",\n\t\t\t\t\ttask\n\t\t\t\t});\n\t\t\t\tmaxEnd = this._gantt.calculateEndDate({\n\t\t\t\t\tstart_date: minStart,\n\t\t\t\t\tduration: task.duration,\n\t\t\t\t\ttask\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\t// GS-1340 and GS-2508. For FF links, the milestones should start before the weekends\n\t\t\t\t// When there are multiple links, other types have a higher priority over FF links\n\t\t\t\tlet milestoneWorktimeDirection = \"future\";\n\t\t\t\tconst linkProps = this._gantt.config.links;\n\t\t\t\tif (autoScheduledDates[linkProps.finish_to_finish] !== undefined){\n\t\t\t\t\tconst onlyFFLink = relations.length === 1;\n\t\t\t\t\tlet noRelevantLinks = true;\n\t\t\t\t\tfor (const linkType in autoScheduledDates){\n\t\t\t\t\t\tif (linkType != linkProps.finish_to_finish &&\n\t\t\t\t\t\t\tautoScheduledDates[linkProps.finish_to_finish] < autoScheduledDates[linkType]){\n\t\t\t\t\t\t\t\tnoRelevantLinks = false;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (onlyFFLink || noRelevantLinks){\n\t\t\t\t\t\tmilestoneWorktimeDirection = \"past\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tminStart = maxEnd = this._gantt.getClosestWorkTime({ date: minStart, dir: milestoneWorktimeDirection, task });\n\t\t\t}\n\n\t\t}\n\n\t\tconst masterPlan = plansHash[taskId];\n\t\tconst currentPlan = TaskPlan.Create(masterPlan);\n\n\t\tcurrentPlan.link = linkId;\n\t\tcurrentPlan.task = taskId;\n\t\tcurrentPlan.start_date = minStart;\n\t\tcurrentPlan.end_date = maxEnd;\n\t\tcurrentPlan.kind = \"asap\";\n\n\t\tif (minRelationDate) {\n\t\t\tcurrentPlan.earliestSchedulingStart = minRelationDate;\n\t\t\tcurrentPlan.earliestSchedulingEnd = this._gantt.calculateEndDate({\n\t\t\t\tstart_date: minRelationDate,\n\t\t\t\tduration: task.duration,\n\t\t\t\ttask\n\t\t\t});\n\t\t}\n\n\t\treturn currentPlan;\n\t}\n\n\tprotected getPredecessorEndDate(id: TaskID, plansHash: IPlansHash): Date {\n\t\tconst plan = plansHash[id];\n\t\tconst task = this._gantt.getTask(id);\n\t\tlet res;\n\n\t\tif (!(plan && (plan.start_date || plan.end_date))) {\n\t\t\tres = task.end_date;\n\t\t} else if (plan.end_date) {\n\t\t\tres = plan.end_date;\n\t\t} else {\n\t\t\tres = this._gantt.calculateEndDate({\n\t\t\t\tstart_date: plan.start_date,\n\t\t\t\tduration: task.duration,\n\t\t\t\ttask\n\t\t\t});\n\t\t}\n\n\t\treturn res;\n\t}\n\n\tprotected getEarliestStartDate(relation: IInternalLink, plansHash: IPlansHash, task: ITask): Date {\n\t\tconst predecessorEnd = this.getPredecessorEndDate(\n\t\t\trelation.source,\n\t\t\tplansHash\n\t\t);\n\t\tconst successor = task;\n\t\tconst predecessor = this._gantt.getTask(relation.source);\n\t\tconst autoSchedulingConfig = this._gantt._getAutoSchedulingConfig();\n\t\tlet successorStart: Date;\n\n\t\tif (\n\t\t\t(predecessorEnd &&\n\t\t\trelation.lag &&\n\t\t\trelation.lag * 1 === relation.lag * 1)\n\t\t) {\n\t\t\t// GS-2330. If it is a subtask link and we move projects, we should use the project calendar\n\t\t\tlet taskCalendar = successor;\n\t\t\tif (autoSchedulingConfig.move_projects && relation.subtaskLink && this._gantt.isTaskExists(relation.targetParent)){\n\t\t\t\ttaskCalendar = this._gantt.getTask(relation.targetParent);\n\t\t\t}\n\n\t\t\tsuccessorStart = this._gantt.getClosestWorkTime({\n\t\t\t\tdate: predecessorEnd,\n\t\t\t\tdir: \"future\",\n\t\t\t\ttask: predecessor\n\t\t\t});\n\n\t\t\tif(relation.sourceLag){\n\t\t\t\tsuccessorStart = this._gantt.calculateEndDate({\n\t\t\t\t\tstart_date: successorStart,\n\t\t\t\t\tduration: relation.sourceLag * 1,\n\t\t\t\t\ttask: predecessor\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif(relation.targetLag){\n\t\t\t\tsuccessorStart = this._gantt.calculateEndDate({\n\t\t\t\t\tstart_date: successorStart,\n\t\t\t\t\tduration: relation.targetLag * 1,\n\t\t\t\t\ttask: taskCalendar\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tsuccessorStart = this._gantt.calculateEndDate({\n\t\t\t\tstart_date: successorStart,\n\t\t\t\tduration: relation.trueLag * 1,\n\t\t\t\ttask: taskCalendar\n\t\t\t});\n\n\t\t} else {\n\t\t\tconst ffLink = this._gantt.getLink(relation.id).type === this._gantt.config.links.finish_to_finish;\n\n\t\t\tif (!successor.duration && ffLink) {\n\t\t\t\tsuccessorStart = this._gantt.getClosestWorkTime({\n\t\t\t\t\tdate: predecessorEnd,\n\t\t\t\t\tdir: \"past\",\n\t\t\t\t\ttask: successor\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tsuccessorStart = this._gantt.getClosestWorkTime({\n\t\t\t\t\tdate: predecessorEnd,\n\t\t\t\t\tdir: \"future\",\n\t\t\t\t\ttask: successor\n\t\t\t\t});\n\t\t\t}\n\n\t\t}\n\n\t\treturn successorStart;\n\t}\n}\n","import { AlapStrategy } from \"./alap_strategy\";\nimport { AsapStrategy } from \"./asap_strategy\";\nimport { ConstraintTypes } from \"./constraint_types\";\nimport { ConstraintsHelper } from \"./constraints\";\nimport { TaskPlan } from \"./task_plan\";\n\nexport class AutoSchedulingPlanner {\n\tprivate _gantt: any;\n\tprivate _constraintsHelper: ConstraintsHelper;\n\tprivate _graphHelper: any;\n\tprivate _asapStrategy: AsapStrategy;\n\tprivate _alapStrategy: AlapStrategy;\n\tprivate _secondIterationRequired?: boolean;\n\tprivate _secondIteration: boolean = false;\n\n\tconstructor(\n\t\tgantt: any,\n\t\tgraphHelper: any,\n\t\tconstraintsHelper: ConstraintsHelper\n\t) {\n\t\tthis._gantt = gantt;\n\t\tthis._constraintsHelper = constraintsHelper;\n\t\tthis._graphHelper = graphHelper;\n\t\tthis._asapStrategy = AsapStrategy.Create(gantt);\n\t\tthis._alapStrategy = AlapStrategy.Create(gantt);\n\t\tthis._secondIterationRequired = false;\n\t}\n\n\tgeneratePlan(relations: IInternalLink[], constraints: ITask[]): TaskPlan[] {\n\t\tconst graphHelper = this._graphHelper;\n\t\tconst gantt = this._gantt;\n\t\tconst constraintsHelper = this._constraintsHelper;\n\t\tconst alapStrategy = this._alapStrategy;\n\t\tconst asapStrategy = this._asapStrategy;\n\t\tconst autoSchedulingConfig = gantt._getAutoSchedulingConfig();\n\n\t\tconst {\n\t\t\torderedIds,\n\t\t\treversedIds,\n\t\t\trelationsMap,\n\t\t\tplansHash } = this.buildWorkCollections(relations, constraints, graphHelper);\n\n\t\tlet result: TaskPlan[];\n\n\t\tthis.processConstraints(orderedIds, plansHash, gantt, constraintsHelper);\n\n\t\tif (autoSchedulingConfig.schedule_from_end) {\n\t\t\t// when scheduling from end - iterate tasks from end and schedule them as late as possible\n\t\t\t// after that - iterate tasks from start and schedule asap tasks\n\t\t\tresult = this.iterateTasks(reversedIds, orderedIds, constraintsHelper.isAlapTask, alapStrategy, asapStrategy, relationsMap, plansHash);\n\t\t} else {\n\t\t\t// when scheduling from end - iterate tasks from start and schedule them as soon as possible\n\t\t\t// after that - iterate tasks from end and schedule asap alap\n\t\t\tresult = this.iterateTasks(orderedIds, reversedIds, constraintsHelper.isAsapTask, asapStrategy, alapStrategy, relationsMap, plansHash);\n\t\t}\n\t\treturn result;\n\t}\n\n\tapplyProjectPlan(projectPlan: TaskPlan[]): ITask[] {\n\t\tconst gantt = this._gantt;\n\n\t\tlet plan: TaskPlan;\n\t\tlet task: ITask;\n\t\tlet link: ILink;\n\t\tlet reason: ITask;\n\n\t\tconst updateTasks = [];\n\t\tfor (let i = 0; i < projectPlan.length; i++) {\n\t\t\tlink = null;\n\t\t\treason = null;\n\t\t\tplan = projectPlan[i];\n\n\t\t\tif (!gantt.isTaskExists(plan.task)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\ttask = gantt.getTask(plan.task);\n\t\t\tif (plan.link) {\n\t\t\t\tlink = gantt.getLink(plan.link);\n\t\t\t\tif (plan.kind === \"asap\") {\n\t\t\t\t\treason = this._gantt.getTask(link.source);\n\t\t\t\t} else {\n\t\t\t\t\t// alap tasks are scheduled by their successors\n\t\t\t\t\treason = this._gantt.getTask(link.target);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlet newDate = null;\n\t\t\tif (\n\t\t\t\tplan.start_date &&\n\t\t\t\ttask.start_date.valueOf() !== plan.start_date.valueOf()\n\t\t\t) {\n\t\t\t\tnewDate = plan.start_date;\n\t\t\t}\n\n\t\t\tif (!newDate) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\ttask.start_date = newDate;\n\t\t\ttask.end_date = gantt.calculateEndDate(task);\n\n\t\t\tupdateTasks.push(task.id);\n\t\t\tgantt.callEvent(\"onAfterTaskAutoSchedule\", [\n\t\t\t\ttask,\n\t\t\t\tnewDate,\n\t\t\t\tlink,\n\t\t\t\treason\n\t\t\t]);\n\t\t}\n\t\treturn updateTasks;\n\t}\n\n\tprotected iterateTasks(\n\t\tmainSequence: TaskID[],\n\t\tsecondarySequence: TaskID[],\n\t\tisMainSequence: (task: ITask) => boolean,\n\t\tmainSequenceStrategy: ISchedulingStrategy,\n\t\tsecondarySequenceStrategy: ISchedulingStrategy,\n\t\trelationsMap: ITaskLinksMap,\n\t\tplansHash: IPlansHash\n\n\t): TaskPlan[] {\n\t\tconst gantt = this._gantt;\n\t\tconst result: TaskPlan[] = [];\n\n\t\tfor (let i = 0; i < mainSequence.length; i++) {\n\t\t\tconst currentId = mainSequence[i];\n\t\t\tconst task = gantt.getTask(currentId);\n\t\t\tif (!gantt._isAutoSchedulable(task)){\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tconst plan = mainSequenceStrategy.resolveRelationDate(\n\t\t\t\tcurrentId,\n\t\t\t\trelationsMap[currentId],\n\t\t\t\tplansHash\n\t\t\t);\n\t\t\tthis.limitPlanDates(task, plan);\n\t\t\tif (isMainSequence(task)) {\n\t\t\t\tthis.processResolvedDate(task, plan, result, plansHash);\n\t\t\t} else {\n\t\t\t\tplansHash[task.id] = plan;\n\t\t\t}\n\t\t}\n\n\t\tfor (let i = 0; i < secondarySequence.length; i++) {\n\t\t\tconst currentId = secondarySequence[i];\n\t\t\tconst task = gantt.getTask(currentId);\n\t\t\tif (!gantt._isAutoSchedulable(task)){\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (!isMainSequence(task)) {\n\t\t\t\tconst plan = secondarySequenceStrategy.resolveRelationDate(\n\t\t\t\t\tcurrentId,\n\t\t\t\t\trelationsMap[currentId],\n\t\t\t\t\tplansHash\n\t\t\t\t);\n\t\t\t\tthis.limitPlanDates(task, plan);\n\t\t\t\tthis.processResolvedDate(task, plan, result, plansHash);\n\t\t\t}\n\t\t}\n\n\t\tif (this._secondIterationRequired){\n\t\t\tif (this._secondIteration){\n\t\t\t\tthis._secondIteration = false;\n\t\t\t} else {\n\t\t\t\tthis._secondIteration = true;\n\n\t\t\t\t// if the duration of the project tasks changed, the lag value is updated\n\t\t\t\t// so, we need to auto-schedule tasks again with the updated dates\n\t\t\t\tif (this.summaryLagChanged(gantt, relationsMap, plansHash)){\n\t\t\t\t\treturn this.iterateTasks(\n\t\t\t\t\t\tmainSequence,\n\t\t\t\t\t\tsecondarySequence,\n\t\t\t\t\t\tisMainSequence,\n\t\t\t\t\t\tmainSequenceStrategy,\n\t\t\t\t\t\tsecondarySequenceStrategy,\n\t\t\t\t\t\trelationsMap,\n\t\t\t\t\t\tplansHash\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected summaryLagChanged(gantt, relationsMap, plansHash){\n\t\t// update projects and relations from plans\n\t\tconst projectUpdates = {};\n\t\tconst linksToUpdate = {};\n\n\t\t// get minimal and maximal dates for target and source projects\n\t\tfor (const taskId in relationsMap){\n\t\t\trelationsMap[taskId].predecessors.forEach((relation)=>{\n\t\t\t\tif (relation.subtaskLink){\n\t\t\t\t\tconst link = gantt.getLink(relation.id);\n\t\t\t\t\tthis.getProjectUpdates(gantt, plansHash, relation, link, \"source\", projectUpdates, linksToUpdate);\n\t\t\t\t\tthis.getProjectUpdates(gantt, plansHash, relation, link, \"target\", projectUpdates, linksToUpdate);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t// update project tasks\n\t\tlet shouldReschedule = false;\n\n\t\tfor (const projectId in projectUpdates){\n\t\t\tconst updatedProject = projectUpdates[projectId];\n\t\t\tif (!updatedProject.min || !updatedProject.max){\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tconst task = gantt.getTask(projectId);\n\t\t\t// we cannot rely on the `duration` parameter as it can have a different value for project tasks\n\t\t\t// during the initial scheduling\n\t\t\tconst initialDuration = gantt.calculateDuration({start_date: task.start_date, end_date: task.end_date, task});\n\t\t\t// we need to modify the dates and duration of the project tasks as\n\t\t\t// the _formatLink and the functions that follow rely on these parameters\n\t\t\t// it shouldn't impact logic as project tasks ignore the date parameters\n\t\t\tconst newDuration = gantt.calculateDuration({start_date: updatedProject.min, end_date: updatedProject.max, task});\n\t\t\tif (newDuration === initialDuration){\n\t\t\t\t// no need to reschedule\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\ttask.start_date = updatedProject.min;\n\t\t\ttask.end_date = updatedProject.max;\n\t\t\ttask.duration = newDuration;\n\t\t}\n\t\t\n\t\tfor (const linkId in linksToUpdate){\n\t\t\tconst link = linksToUpdate[linkId];\n\t\t\tlet sourceDates, targetDates;\n\n\t\t\tconst updatedSource = projectUpdates[link.source];\n\t\t\tconst updatedTarget = projectUpdates[link.target];\n\t\t\tif (updatedSource){\n\t\t\t\tsourceDates = {\n\t\t\t\t\tstart_date: updatedSource.start_date,\n\t\t\t\t\tend_date: updatedSource.end_date\n\t\t\t\t};\n\t\t\t}\n\t\t\tif (updatedTarget){\n\t\t\t\tsourceDates = {\n\t\t\t\t\tstart_date: updatedTarget.start_date,\n\t\t\t\t\tend_date: updatedTarget.end_date\n\t\t\t\t};\n\t\t\t}\n\n\t\t\t// get updated formatted link with updated dates\n\t\t\tconst updatedRelations = gantt._formatLink(link, sourceDates, targetDates);\n\t\t\t// update relationsMap\n\t\t\tupdatedRelations.forEach(function(updatedRelation){\n\t\t\tfor (const taskId in relationsMap){\n\t\t\t\trelationsMap[taskId].predecessors.forEach(function(relation){\n\t\t\t\t\t\tconst idMatch = relation.id === updatedRelation.id;\n\t\t\t\t\t\tconst targetMatch = relation.target === updatedRelation.target;\n\t\t\t\t\t\tconst sourceMatch = relation.source === updatedRelation.source;\n\t\t\t\t\t\tif (idMatch && targetMatch && sourceMatch){\n\t\t\t\t\t\t\trelation.lag = updatedRelation.lag;\n\t\t\t\t\t\t\trelation.sourceLag = updatedRelation.sourceLag;\n\t\t\t\t\t\t\trelation.targetLag = updatedRelation.targetLag;\n\t\t\t\t\t\t\trelation.hashSum = updatedRelation.hashSum;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t\tshouldReschedule = true;\n\t\t}\n\t\treturn shouldReschedule;\n\t}\n\n\tprotected getProjectUpdates(gantt, plansHash, relation, link, relationProp, projectUpdates, linksToUpdate){\n\t\tconst task = gantt.getTask(link[relationProp]);\n\t\tif (task.type === gantt.config.types.project){\n\t\t\tprojectUpdates[link[relationProp]] = projectUpdates[link[relationProp]] || {id: link[relationProp], link};\n\t\t\tconst projectForUpdate = projectUpdates[link[relationProp]];\n\t\t\tlet childTask = plansHash[relation[relationProp]];\n\t\t\tif (childTask){\n\t\t\t\tif (relationProp == \"source\" && (!childTask.start_date || !childTask.end_date)){\n\t\t\t\t\tchildTask = gantt.getTask(childTask.task);\n\t\t\t\t}\n\n\t\t\t\tprojectForUpdate.min = projectForUpdate.min || childTask.start_date;\n\t\t\t\tif (projectForUpdate.min > childTask.start_date){\n\t\t\t\t\tprojectForUpdate.min = childTask.start_date;\n\t\t\t\t}\n\t\t\t\tprojectForUpdate.max = projectForUpdate.max || childTask.end_date;\n\t\t\t\tif (projectForUpdate.max < childTask.end_date){\n\t\t\t\t\tprojectForUpdate.max = childTask.end_date;\n\t\t\t\t}\n\t\t\t\tlinksToUpdate[link.id] = link;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected processResolvedDate(\n\t\ttask: ITask,\n\t\tplan: TaskPlan,\n\t\tresult: TaskPlan[],\n\t\tplansHash: any\n\t): void {\n\t\tif (plan.start_date && this._gantt.isLinkExists(plan.link)) {\n\t\t\tlet link = null;\n\t\t\tlet reason = null;\n\t\t\tif (plan.link) {\n\t\t\t\tlink = this._gantt.getLink(plan.link);\n\t\t\t\tif (plan.kind === \"asap\") {\n\t\t\t\t\treason = this._gantt.getTask(link.source);\n\t\t\t\t} else {\n\t\t\t\t\t// alap tasks are scheduled by their successors\n\t\t\t\t\treason = this._gantt.getTask(link.target);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\ttask.start_date.valueOf() !== plan.start_date.valueOf() &&\n\t\t\t\tthis._gantt.callEvent(\"onBeforeTaskAutoSchedule\", [\n\t\t\t\t\ttask,\n\t\t\t\t\tplan.start_date,\n\t\t\t\t\tlink,\n\t\t\t\t\treason\n\t\t\t\t]) === false\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tplansHash[task.id] = plan;\n\t\tif (plan.start_date) {\n\t\t\tresult.push(plan);\n\t\t}\n\t}\n\n\tprotected limitPlanDates(task: ITask, plan: TaskPlan): TaskPlan {\n\t\tconst effectiveStart = plan.start_date || task.start_date;\n\n\t\tif (plan.earliestStart) {\n\t\t\tif (effectiveStart < plan.earliestStart) {\n\t\t\t\tplan.start_date = plan.earliestStart;\n\t\t\t\tplan.end_date = plan.earliestEnd;\n\t\t\t}\n\t\t}\n\n\t\tif (plan.latestStart) {\n\t\t\tif (effectiveStart > plan.latestStart) {\n\t\t\t\tplan.start_date = plan.latestStart;\n\t\t\t\tplan.end_date = plan.latestEnd;\n\t\t\t}\n\t\t}\n\n\t\tif (plan.latestSchedulingStart && effectiveStart > plan.latestSchedulingStart) {\n\t\t\tplan.start_date = plan.latestSchedulingStart;\n\t\t\tplan.end_date = plan.latestSchedulingEnd;\n\t\t}\n\n\t\tif (plan.earliestSchedulingStart && effectiveStart < plan.earliestSchedulingStart) {\n\t\t\tplan.start_date = plan.earliestSchedulingStart;\n\t\t\tplan.end_date = plan.earliestSchedulingEnd;\n\t\t}\n\n\t\tif (plan.start_date) { // start/end dates are either both defined or both not\n\t\t\tif (plan.start_date > plan.latestSchedulingStart ||\n\t\t\t\tplan.start_date < plan.earliestSchedulingStart ||\n\t\t\t\tplan.start_date > plan.latestStart ||\n\t\t\t\tplan.start_date < plan.earliestStart ||\n\t\t\t\tplan.end_date > plan.latestSchedulingEnd ||\n\t\t\t\tplan.end_date < plan.earliestSchedulingEnd ||\n\t\t\t\tplan.end_date > plan.latestEnd ||\n\t\t\t\tplan.end_date < plan.earliestEnd) {\n\n\t\t\t\tplan.conflict = true;\n\t\t\t}\n\t\t}\n\t\treturn plan;\n\t}\n\n\tprotected buildWorkCollections(relations: IInternalLink[], constraints: ITask[], graphHelper: any) {\n\t\tconst gantt = this._gantt;\n\t\tconst orderedIds: TaskID[] = graphHelper.topologicalSort(relations);\n\t\tconst reversedIds: TaskID[] = orderedIds.slice().reverse();\n\t\tconst plansHash: IPlansHash = {};\n\n\t\tconst relationsMap: ITaskLinksMap = {};\n\t\tfor (let i = 0, len = orderedIds.length; i < len; i++) {\n\t\t\tconst id = orderedIds[i];\n\t\t\tconst task = gantt.getTask(id);\n\t\t\tif (!gantt._isAutoSchedulable(task)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\trelationsMap[id] = {\n\t\t\t\tsuccessors: [],\n\t\t\t\tpredecessors: []\n\t\t\t};\n\n\t\t\tplansHash[id] = null;\n\t\t}\n\n\t\tfor (let i = 0, len = constraints.length; i < len; i++) {\n\t\t\tconst task = constraints[i];\n\n\t\t\tif (plansHash[task.id] === undefined) {\n\t\t\t\treversedIds.unshift(task.id);\n\t\t\t\torderedIds.unshift(task.id);\n\t\t\t\tplansHash[task.id] = null;\n\t\t\t\trelationsMap[task.id] = {\n\t\t\t\t\tsuccessors: [],\n\t\t\t\t\tpredecessors: []\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\tfor (let i = 0, len = relations.length; i < len; i++) {\n\t\t\tconst rel = relations[i];\n\t\t\tif (relationsMap[rel.source]) {\n\t\t\t\trelationsMap[rel.source].successors.push(rel);\n\t\t\t}\n\n\t\t\tif (relationsMap[rel.target]) {\n\t\t\t\trelationsMap[rel.target].predecessors.push(rel);\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\torderedIds,\n\t\t\treversedIds,\n\t\t\trelationsMap,\n\t\t\tplansHash\n\t\t};\n\t}\n\n\tprotected processConstraints(orderedIds: TaskID[], plansHash: IPlansHash, gantt: any, constraintsHelper: ConstraintsHelper) {\n\t\tfor (let i = 0; i < orderedIds.length; i++) {\n\t\t\tconst currentId = orderedIds[i];\n\t\t\tconst task = gantt.getTask(currentId);\n\n\t\t\tconst constraintType = constraintsHelper.getConstraintType(task);\n\t\t\tif (\n\t\t\t\tconstraintType &&\n\t\t\t\tconstraintType !== ConstraintTypes.ASAP &&\n\t\t\t\tconstraintType !== ConstraintTypes.ALAP\n\t\t\t) {\n\t\t\t\tconst plan = constraintsHelper.processConstraint(\n\t\t\t\t\ttask,\n\t\t\t\t\tTaskPlan.Create()\n\t\t\t\t);\n\t\t\t\tplansHash[task.id] = plan;\n\t\t\t}\n\t\t}\n\t}\n}\n","interface IFlagHash {\n\t[id: string]: boolean;\n}\n\nfunction findGroups(links: IInternalLink[]): IConnectedGroup[] {\n\tconst visited: IFlagHash = {};\n\tconst groups = [];\n\tlet source: TaskID;\n\tlet target: TaskID;\n\tlet root: TaskID;\n\t// main loop - find any unvisited vertex from the input array and\n\t// treat it as the source, then perform a breadth first search from\n\t// it. All vertices visited from this search belong to the same group\n\tfor (let i = 0; i < links.length; i++) {\n\t\tsource = links[i].source;\n\t\ttarget = links[i].target;\n\t\troot = null;\n\t\tif (!visited[source]) {\n\t\t\troot = source;\n\t\t} else if (!visited[target]) {\n\t\t\troot = target;\n\t\t}\n\t\tif (root) {\n\t\t\t// there is an unvisited vertex in this pair.\n\t\t\t// perform a breadth first search, and push the resulting\n\t\t\t// group onto the list of all groups\n\t\t\tconst length = links.length;\n\t\t\tgroups.push(breadthFirstSearch(root, links, visited));\n\t\t\tif (length !== links.length) {\n\t\t\t\ti = -1;\n\t\t\t}\n\t\t}\n\t}\n\treturn groups;\n}\n\n// Breadth First Search function\n// v is the source vertex\n// links is the input array, which contains all gantt relations\n// visited is a dictionary for keeping track of whether a node is visited\nfunction breadthFirstSearch(\n\tv: TaskID,\n\tlinks: IInternalLink[],\n\tvisited: IFlagHash\n): IConnectedGroupsDetailed {\n\tconst queue: TaskID[] = [v];\n\tconst groupTasks: TaskID[] = [];\n\tconst groupLinksInternal: { [hashSum: string]: IInternalLink } = {};\n\tconst groupLinksPublic: { [id: string]: boolean } = {};\n\n\tlet currentVertex: TaskID;\n\twhile (queue.length > 0) {\n\t\tcurrentVertex = queue.shift();\n\t\tif (!visited[currentVertex]) {\n\t\t\tvisited[currentVertex] = true;\n\t\t\tgroupTasks.push(currentVertex);\n\t\t\t// go through the input array to find vertices that are\n\t\t\t// directly adjacent to the current vertex, and put them\n\t\t\t// onto the queue\n\t\t\tfor (let i = 0; i < links.length; i++) {\n\t\t\t\tconst link = links[i];\n\t\t\t\t// tslint:disable-next-line triple-equals\n\t\t\t\tif ((link.source == currentVertex || link.sourceParent == currentVertex)) {\n\t\t\t\t\tif (!visited[link.target]) {\n\t\t\t\t\t\tqueue.push(link.target);\n\t\t\t\t\t\tgroupLinksPublic[link.id] = true;\n\t\t\t\t\t\tlinks.splice(i, 1);\n\t\t\t\t\t\ti--;\n\t\t\t\t\t}\n\t\t\t\t\tgroupLinksInternal[link.hashSum] = link;\n\n\t\t\t\t\t// tslint:disable-next-line triple-equals\n\t\t\t\t} else if ((link.target == currentVertex || link.targetParent == currentVertex)) {\n\t\t\t\t\tif (!visited[link.source]) {\n\t\t\t\t\t\tqueue.push(link.source);\n\t\t\t\t\t\tgroupLinksPublic[link.id] = true;\n\t\t\t\t\t\tlinks.splice(i, 1);\n\t\t\t\t\t\ti--;\n\t\t\t\t\t}\n\t\t\t\t\tgroupLinksInternal[link.hashSum] = link;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tconst linksArray: LinkID[] = [];\n\tlet linksObjects: IInternalLink[] = [];\n\tfor (const i in groupLinksPublic) {\n\t\tlinksArray.push(i);\n\t}\n\tfor (const i in groupLinksInternal) {\n\t\tlinksObjects.push(groupLinksInternal[i]);\n\t}\n\t// GS-1689. If we have several levels of projects, the code above might not add the links\n\t// so, we need to return the original `links` object\n\tif (!linksObjects.length){\n\t\tlinksObjects = links;\n\t}\n\t// return everything in the current \"group\"\n\treturn { tasks: groupTasks, links: linksArray, processedLinks: linksObjects };\n}\n\nexport class ConnectedGroupsHelper {\n\tprivate _linksBuilder: any;\n\tprivate _gantt: any;\n\tconstructor(gantt: any, linksBuilder: any) {\n\t\tthis._linksBuilder = linksBuilder;\n\t\tthis._gantt = gantt;\n\t}\n\n\tgetConnectedGroupRelations = (id: TaskID): IInternalLink[] => {\n\t\tconst links = this._linksBuilder.getLinkedTasks();\n\t\tconst group = breadthFirstSearch(id, links, {});\n\t\treturn group.processedLinks;\n\t};\n\n\tgetConnectedGroup = (id: TaskID): IConnectedGroup | IConnectedGroup[] => {\n\t\tconst links = this._linksBuilder.getLinkedTasks();\n\t\tif (id !== undefined) {\n\t\t\tif (this._gantt.getTask(id).type === this._gantt.config.types.project) {\n\t\t\t\treturn { tasks: [], links: [] };\n\t\t\t}\n\n\t\t\tconst group = breadthFirstSearch(id, links, {});\n\t\t\treturn {\n\t\t\t\ttasks: group.tasks,\n\t\t\t\tlinks: group.links\n\t\t\t};\n\t\t} else {\n\t\t\treturn findGroups(links).map(group => ({ tasks: group.tasks, links: group.links }));\n\t\t}\n\t};\n}\n","export class LoopsFinder {\n\tprivate _linksBuilder: any;\n\tprivate _graphHelper: any;\n\tprivate _gantt: any;\n\tconstructor(gantt: any, graphHelper: any, linksBuilder: any) {\n\t\tthis._linksBuilder = linksBuilder;\n\t\tthis._graphHelper = graphHelper;\n\t\tthis._gantt = gantt;\n\t}\n\tisCircularLink = (link: ILink): boolean => {\n\t\treturn !!this.getLoopContainingLink(link);\n\t};\n\n\tgetLoopContainingLink = (link: ILink): any => {\n\t\tconst graphHelper = this._graphHelper;\n\t\tconst linksBuilder = this._linksBuilder;\n\t\tconst gantt = this._gantt;\n\n\t\tlet allRelations = linksBuilder.getLinkedTasks();\n\t\tif (!gantt.isLinkExists(link.id)) {\n\t\t\tallRelations = allRelations.concat(gantt._formatLink(link));\n\t\t}\n\n\t\tconst cycles = graphHelper.findLoops(allRelations);\n\n\t\tconst found = false;\n\t\tfor (let i = 0; i < cycles.length && !found; i++) {\n\t\t\tconst links = cycles[i].links;\n\t\t\tfor (let j = 0; j < links.length; j++) {\n\t\t\t\t// tslint:disable-next-line triple-equals\n\t\t\t\tif (links[j] == link.id) {\n\t\t\t\t\treturn cycles[i];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t};\n\n\tfindCycles = () => {\n\t\tconst graphHelper = this._graphHelper;\n\t\tconst linksBuilder = this._linksBuilder;\n\n\t\tconst allRelations = linksBuilder.getLinkedTasks();\n\t\treturn graphHelper.findLoops(allRelations);\n\t};\n}\n","export default function(gantt){\n\tfunction getDefaultAutoSchedulingConfig(){\n\t\treturn {\n\t\t\tenabled: false,\n\t\t\tapply_constraints: false,\n\t\t\tgap_behavior: \"preserve\",\n\t\t\tdescendant_links: false,\n\t\t\tschedule_on_parse: true,\n\t\t\tmove_projects: true,\n\t\t\tuse_progress: false,\n\n\t\t\tschedule_from_end: false,\n\t\t\tproject_constraint: false,\n\t\t\tshow_constraints: false\n\t\t};\n\t}\n\n\tfunction getAutoSchedulingConfig() {\n\t\tconst config = gantt.config;\n\n\t\t// if already using new-style object  return as is\n\t\tif (typeof config.auto_scheduling === \"object\") {\n\n\t\t\tconst schedulingConfig = {...getDefaultAutoSchedulingConfig(), ...config.auto_scheduling};\n\n\t\t\t// backward compatibility for {mode, strict, move_asap_tasks} properties\n\t\t\tif(schedulingConfig.mode){\n\t\t\t\tschedulingConfig.apply_constraints = schedulingConfig.mode === \"constraints\";\n\t\t\t\tdelete schedulingConfig.mode;\n\t\t\t}\n\n\t\t\tif(schedulingConfig.strict !== undefined){\n\t\t\t\tschedulingConfig.gap_behavior = schedulingConfig.strict ? \"compress\" : \"preserve\";\n\t\t\t\tdelete schedulingConfig.strict;\n\t\t\t}\n\n\t\t\tif(schedulingConfig.move_asap_tasks !== undefined){\n\t\t\t\tschedulingConfig.gap_behavior = schedulingConfig.move_asap_tasks ? \"compress\" : \"preserve\";\n\t\t\t\tdelete schedulingConfig.move_asap_tasks;\n\t\t\t}\n\t\t\treturn schedulingConfig;\n\t\t}\n\n\t\t// backward compatibility: build config from old flags\n\t\tconst enabled = !!config.auto_scheduling;\n\n\t\treturn {\n\t\t\t...getDefaultAutoSchedulingConfig(),\n\t\t\t...{\n\t\t\t\tenabled,\n\t\t\t\tapply_constraints: config.auto_scheduling_compatibility ?? false,\n\t\t\t\tgap_behavior: config.auto_scheduling_strict !== true ? \"preserve\" : \"compress\",\n\t\t\t\tdescendant_links: config.auto_scheduling_descendant_links ?? false,\n\t\t\t\tschedule_on_parse: config.auto_scheduling_initial ?? true,\n\t\t\t\tmove_projects: config.auto_scheduling_move_projects ?? true,\n\t\t\t\tuse_progress: config.auto_scheduling_use_progress ?? false,\n\n\t\t\t\tschedule_from_end: config.schedule_from_end ?? false,\n\t\t\t\tproject_constraint: config.auto_scheduling_project_constraint ?? false,\n\t\t\t\tshow_constraints: false\n\t\t\t}\n\t\t};\n\t}\n\n\treturn {\n\t\tgetDefaultAutoSchedulingConfig,\n\t\tgetAutoSchedulingConfig\n\t};\n};","import { ConnectedGroupsHelper } from \"./connected_groups\";\n\nexport function attachUIHandlers(\n\tgantt: any,\n\tlinksBuilder: any,\n\tloopsFinder: any,\n\tconnectedGroupsHelper: ConnectedGroupsHelper\n) {\n\tconst _attachAutoSchedulingHandlers = function() {\n\t\tlet _scheduleAfterBatchUpdate = false;\n\t\tgantt.attachEvent(\"onAfterBatchUpdate\", function(){\n\n\t\t\tif(_scheduleAfterBatchUpdate){\n\t\t\t\tgantt.autoSchedule();\n\t\t\t}\n\t\t\t_scheduleAfterBatchUpdate = false;\n\t\t});\n\n\t\tfunction _autoScheduleAfterLinkChange(id: LinkID, link: ILink) {\n\t\t\tif (gantt._getAutoSchedulingConfig().enabled && !gantt._autoscheduling_in_progress) {\n\t\t\t\tif(gantt.getState().batch_update){\n\t\t\t\t\t_scheduleAfterBatchUpdate = true;\n\t\t\t\t}else{\n\t\t\t\t\tgantt.autoSchedule(link.source);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tgantt.attachEvent(\"onAfterLinkUpdate\", _autoScheduleAfterLinkChange);\n\t\tgantt.attachEvent(\"onAfterLinkAdd\", _autoScheduleAfterLinkChange);\n\n\t\tgantt.attachEvent(\"onAfterLinkDelete\", function(id: LinkID, link: ILink) {\n\t\t\tconst autoSchedulingConfig = gantt._getAutoSchedulingConfig();\n\t\t\tif (\n\t\t\t\tautoSchedulingConfig.enabled &&\n\t\t\t\t!gantt._autoscheduling_in_progress &&\n\t\t\t\tgantt.isTaskExists(link.target)\n\t\t\t) {\n\t\t\t\t// after link deleted - auto schedule target for other relations that may be left\n\t\t\t\tconst target = gantt.getTask(link.target);\n\t\t\t\tconst predecessors = gantt._getPredecessors(target);\n\t\t\t\tif (predecessors.length) {\n\t\t\t\t\tif(gantt.getState().batch_update){\n\t\t\t\t\t\t_scheduleAfterBatchUpdate = true;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tgantt.autoSchedule(predecessors[0].source, false);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tgantt.attachEvent(\"onParse\", function() {\n\t\t\tconst autoSchedulingConfig = gantt._getAutoSchedulingConfig();\n\t\t\tif (\n\t\t\t\tautoSchedulingConfig.enabled &&\n\t\t\t\tautoSchedulingConfig.schedule_on_parse\n\t\t\t) {\n\t\t\t\tgantt.autoSchedule();\n\t\t\t}\n\t\t});\n\n\t\tfunction _preventCircularLink(id: LinkID, link: ILink): boolean {\n\t\t\tconst slackConfigValue = gantt._getAutoSchedulingConfig().use_progress;\n\t\t\tconst deprecatedConfig = gantt.config.auto_scheduling_use_progress;\n\n\t\t\tif(deprecatedConfig) {\n\t\t\t\tgantt.config.auto_scheduling_use_progress = false;\n\t\t\t} else if (slackConfigValue){\n\t\t\t\tgantt.config.auto_scheduling.use_progress = false;\n\t\t\t}\n\n\t\t\tif (gantt.isCircularLink(link)) {\n\t\t\t\tgantt.callEvent(\"onCircularLinkError\", [\n\t\t\t\t\tlink,\n\t\t\t\t\tloopsFinder.getLoopContainingLink(link)\n\t\t\t\t]);\n\n\t\t\t\tif(deprecatedConfig) {\n\t\t\t\t\tgantt.config.auto_scheduling_use_progress = slackConfigValue;\n\t\t\t\t} else if (slackConfigValue){\n\t\t\t\t\tgantt.config.auto_scheduling.use_progress = slackConfigValue;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t} else {\n\t\t\t\tif(deprecatedConfig) {\n\t\t\t\t\tgantt.config.auto_scheduling_use_progress = slackConfigValue;\n\t\t\t\t} else if (slackConfigValue){\n\t\t\t\t\tgantt.config.auto_scheduling.use_progress = slackConfigValue;\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\tfunction _preventDescendantLink(id: LinkID, link: ILink): boolean {\n\t\t\tconst source = gantt.getTask(link.source);\n\t\t\tconst target = gantt.getTask(link.target);\n\t\t\tconst autoSchedulingConfig = gantt._getAutoSchedulingConfig();\n\t\t\tif (!autoSchedulingConfig.descendant_links) {\n\t\t\t\tif (\n\t\t\t\t\t(gantt.isChildOf(source.id, target.id) &&\n\t\t\t\t\t\tgantt.isSummaryTask(target)) ||\n\t\t\t\t\t(gantt.isChildOf(target.id, source.id) && gantt.isSummaryTask(source))\n\t\t\t\t) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\n\t\tgantt.attachEvent(\"onBeforeLinkAdd\", _preventCircularLink);\n\t\tgantt.attachEvent(\"onBeforeLinkAdd\", _preventDescendantLink);\n\t\tgantt.attachEvent(\"onBeforeLinkUpdate\", _preventCircularLink);\n\t\tgantt.attachEvent(\"onBeforeLinkUpdate\", _preventDescendantLink);\n\n\t\tfunction _datesNotEqual(\n\t\t\tdateA: Date,\n\t\t\tdateB: Date,\n\t\t\ttaskA: ITask,\n\t\t\ttaskB: ITask\n\t\t): boolean {\n\t\t\tif (!!dateA !== !!dateB) {\n\t\t\t\t// if one of dates is empty or null and the other is not\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (!dateA && !dateB) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (dateA.valueOf() > dateB.valueOf()) {\n\t\t\t\treturn gantt._hasDuration({\n\t\t\t\t\tstart_date: dateB,\n\t\t\t\t\tend_date: dateA,\n\t\t\t\t\ttask: taskB\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\treturn gantt._hasDuration({\n\t\t\t\t\tstart_date: dateA,\n\t\t\t\t\tend_date: dateB,\n\t\t\t\t\ttask: taskA\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\tfunction _notEqualTaskDates(task1: ITask, task2: ITask): boolean {\n\t\t\tif (_datesNotEqual(task1.start_date, task2.start_date, task1, task2)) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (gantt.getConstraintType(task1) !== gantt.getConstraintType(task2)) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\t_datesNotEqual(\n\t\t\t\t\ttask1.constraint_date,\n\t\t\t\t\ttask2.constraint_date,\n\t\t\t\t\ttask1,\n\t\t\t\t\ttask2\n\t\t\t\t)\n\t\t\t) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\t_datesNotEqual(task1.start_date, task2.start_date, task1, task2) ||\n\t\t\t\t((_datesNotEqual(task1.end_date, task2.end_date, task1, task2) ||\n\t\t\t\t\ttask1.duration !== task2.duration) &&\n\t\t\t\t\ttask1.type !== gantt.config.types.milestone)\n\t\t\t) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\tfunction getRelations(id: TaskID) {\n\t\t\t// collect relations before drag and drop  in order to have original positions of subtasks within project since they are used as lag when moving dependent project\n\t\t\tconst autoSchedulingConfig = gantt._getAutoSchedulingConfig();\n\t\t\tif (!autoSchedulingConfig.apply_constraints) {\n\t\t\t\t// collect only downstream dependencies since there is no backward or ALAP scheduling in pre 6.1 auto scheduling\n\t\t\t\treturn linksBuilder.getLinkedTasks(id, true);\n\t\t\t} else {\n\t\t\t\t// get all connected group (both upstream and downstream dependencies)\n\t\t\t\treturn connectedGroupsHelper.getConnectedGroupRelations(id);\n\t\t\t}\n\t\t}\n\n\t\tlet relations;\n\t\tlet movedTask;\n\t\tgantt.attachEvent(\"onBeforeTaskDrag\", function(\n\t\t\tid: TaskID,\n\t\t\tmode: string,\n\t\t\ttask: ITask\n\t\t) {\n\t\t\tconst autoSchedulingConfig = gantt._getAutoSchedulingConfig();\n\t\t\tif (\n\t\t\t\tautoSchedulingConfig.enabled\n\t\t\t\t// We need to get the movedTask so that we can use it later internally\n\t\t\t\t// && autoSchedulingConfig.move_projects\n\t\t\t) {\n\t\t\t\t// collect relations before drag and drop  in order to have original positions of subtasks within project since they are used as lag when moving dependent project\n\t\t\t\tif(gantt.getState().drag_mode !== \"progress\"){\n\t\t\t\t\trelations = getRelations(id);\n\t\t\t\t}\n\n\t\t\t\tmovedTask = id;\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\n\t\tfunction resetToStartLinksLags(taskId, relationsArray) {\n\t\t\t// task duration is used as lag when converting start_to_start and start_to_finish into finish_to_start links\n\t\t\t// recalculate these links if task duration has changed\n\n\t\t\tlet skipped = false;\n\t\t\tfor (let i = 0; i < relations.length; i++) {\n\t\t\t\tconst originalLink = gantt.getLink(relationsArray[i].id);\n\t\t\t\tif (\n\t\t\t\t\toriginalLink &&\n\t\t\t\t\t(originalLink.type === gantt.config.links.start_to_start ||\n\t\t\t\t\t\toriginalLink.type === gantt.config.links.start_to_finish)\n\t\t\t\t) {\n\t\t\t\t\trelationsArray.splice(i, 1);\n\t\t\t\t\ti--;\n\t\t\t\t\tskipped = true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (skipped) {\n\t\t\t\tconst presentLinks = {};\n\t\t\t\tfor (let i = 0; i < relationsArray.length; i++) {\n\t\t\t\t\tpresentLinks[relationsArray[i].id] = true;\n\t\t\t\t}\n\n\t\t\t\tconst updatedLinks = getRelations(taskId);\n\n\t\t\t\tfor (let i = 0; i < updatedLinks.length; i++) {\n\t\t\t\t\tif (!presentLinks[updatedLinks[i].id]) {\n\t\t\t\t\t\trelationsArray.push(updatedLinks[i]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// GS-686. We shouldn't change the constraint after changing only the duration or end_date\n\t\tfunction shouldKeepConstraints(task, oldTask){\n\t\t\tconst autoSchedulingConfig = gantt._getAutoSchedulingConfig();\n\t\t\tif (autoSchedulingConfig.schedule_from_end) {\n\t\t\t\tif (oldTask.end_date && task.end_date && task.end_date.valueOf() === oldTask.end_date.valueOf()){\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (oldTask.start_date && task.start_date && task.start_date.valueOf() === oldTask.start_date.valueOf()){\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfunction updateTaskConstraints(task){\n\t\t\t// GS-1487. Don't add a constraint if auto-scheduling is cancelled\n\t\t\tif (task.auto_scheduling === false){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst autoSchedulingConfig = gantt._getAutoSchedulingConfig();\n\n\t\t\t// GS-2452. We should keep the constraints type if it doesn't affect the task dates\n\t\t\tconst constraintTypes = gantt.config.constraint_types;\n\t\t\tconst backwardConstraints = [\n\t\t\t\tconstraintTypes.SNLT,\n\t\t\t\tconstraintTypes.FNLT,\n\t\t\t\tconstraintTypes.MSO,\n\t\t\t\tconstraintTypes.MFO\n\t\t\t];\n\t\t\tconst forwardConstraints = [\n\t\t\t\tconstraintTypes.SNET,\n\t\t\t\tconstraintTypes.FNET,\n\t\t\t\tconstraintTypes.MSO,\n\t\t\t\tconstraintTypes.MFO\n\t\t\t];\n\n\t\t\tif (autoSchedulingConfig.schedule_from_end) {\n\t\t\t\tif (backwardConstraints.indexOf(task.constraint_type) > -1) {\n\t\t\t\t\t// keep the constraint type\n\t\t\t\t\tif (task.constraint_type == constraintTypes.SNLT ||\n\t\t\t\t\t\ttask.constraint_type == constraintTypes.MSO) {\n\t\t\t\t\t\ttask.constraint_date = new Date(task.start_date);\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttask.constraint_date = new Date(task.end_date);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// set the default constraint\n\t\t\t\t\ttask.constraint_type = constraintTypes.FNLT;\n\t\t\t\t\ttask.constraint_date = new Date(task.end_date);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (forwardConstraints.indexOf(task.constraint_type) > -1) {\n\t\t\t\t\t// keep the constraint type\n\t\t\t\t\tif (task.constraint_type == constraintTypes.SNET ||\n\t\t\t\t\t\ttask.constraint_type == constraintTypes.MSO) {\n\t\t\t\t\t\ttask.constraint_date = new Date(task.start_date);\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttask.constraint_date = new Date(task.end_date);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// set the default constraint\n\t\t\t\t\ttask.constraint_type = constraintTypes.SNET;\n\t\t\t\t\ttask.constraint_date = new Date(task.start_date);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfunction finalizeTaskConstraints(task){\n\t\t\tconst autoSchedulingConfig = gantt._getAutoSchedulingConfig();\n\t\t\tif (!autoSchedulingConfig.apply_constraints) {\n\t\t\t\ttask.constraint_type = null;\n\t\t\t\ttask.constraint_date = null;\n\t\t\t}\n\t\t}\n\n\t\tconst _processConstraints = function(taskId, oldTask) {\n\t\t\tconst newTask = gantt.getTask(taskId);\n\t\t\tif (shouldKeepConstraints(newTask, oldTask)) {\n\t\t\t\t// don't change constraints\n\t\t\t} else {\n\t\t\t\tupdateTaskConstraints(newTask);\n\t\t\t}\n\t\t};\n\n\t\tconst _autoScheduleAfterDND = function(taskId, task) {\n\t\t\tconst autoSchedulingConfig = gantt._getAutoSchedulingConfig();\n\t\t\tif (autoSchedulingConfig.enabled && !gantt._autoscheduling_in_progress) {\n\t\t\t\tconst newTask = gantt.getTask(taskId);\n\n\t\t\t\tconst progressScheduling = (autoSchedulingConfig.use_progress && ((task.progress === 1) !== (newTask.progress === 1)));\n\n\t\t\t\tif (_notEqualTaskDates(task, newTask)) {\n\t\t\t\t\t_processConstraints(taskId, task);\n\n\t\t\t\t\tif (\n\t\t\t\t\t\tautoSchedulingConfig.move_projects &&\n\t\t\t\t\t\t// tslint:disable-next-line triple-equals\n\t\t\t\t\t\tmovedTask == taskId\n\t\t\t\t\t) {\n\t\t\t\t\t\tlet shouldResetSSandSFLinkLags = true;\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tgantt.calculateDuration(task) !== gantt.calculateDuration(newTask)\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t// task duration is used as lag when converting start_to_start and start_to_finish into finish to start links\n\t\t\t\t\t\t\t// recalculate these links if task duration has changed\n\t\t\t\t\t\t\tresetToStartLinksLags(taskId, relations);\n\t\t\t\t\t\t\t// to not call the function above twice\n\t\t\t\t\t\t\tshouldResetSSandSFLinkLags = false;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif(progressScheduling){\n\t\t\t\t\t\t\tgantt.autoSchedule();\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t// GS-2588. The duration of the project tasks can be changed after the child drag,\n\t\t\t\t\t\t\t// so, we need to update that information for the SS and SF links\n\t\t\t\t\t\t\tif (shouldResetSSandSFLinkLags) {\n\t\t\t\t\t\t\t\tresetToStartLinksLags(taskId, relations);\n\t\t\t\t\t\t\t}\t\t\t\t\t\n\t\t\t\t\t\t\tgantt._autoSchedule(taskId, relations);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tgantt.autoSchedule(newTask.id);\n\t\t\t\t\t}\n\n\t\t\t\t\tfinalizeTaskConstraints(newTask);\n\t\t\t\t}\n\t\t\t}\n\t\t\trelations = null;\n\t\t\tmovedTask = null;\n\t\t\treturn true;\n\t\t};\n\n\n\n\n\t\tlet modifiedTaskId = null;\n\t\tif (gantt.ext && gantt.ext.inlineEditors) {\n\t\t\tconst inlineEditors = gantt.ext.inlineEditors;\n\t\t\tconst autoscheduleColumns = {\n\t\t\t\tstart_date: true,\n\t\t\t\tend_date: true,\n\t\t\t\tduration: true,\n\t\t\t\tconstraint_type: true,\n\t\t\t\tconstraint_date: true\n\t\t\t};\n\n\t\t\tinlineEditors.attachEvent(\"onBeforeSave\", function(state) {\n\t\t\t\tif (autoscheduleColumns[state.columnName]) {\n\t\t\t\t\tconst autoSchedulingConfig = gantt._getAutoSchedulingConfig();\n\t\t\t\t\tmodifiedTaskId = state.id;\n\t\t\t\t\t// GS-711. The constraint type set by the user should be saved\n\t\t\t\t\tif (state.columnName === \"constraint_type\"){\n\t\t\t\t\t\tchangedConstraint = true;\n\t\t\t\t\t}\n\t\t\t\t\t// GS-686. We shouldn't change the constraint after changing only the duration or end_date\n\t\t\t\t\tconst durationColumn = state.columnName === \"duration\";\n\t\t\t\t\tconst startDateColumn = autoSchedulingConfig.schedule_from_end && (state.columnName === \"start_date\");\n\t\t\t\t\tconst endDateColumn = !autoSchedulingConfig.schedule_from_end && (state.columnName === \"end_date\");\n\n\t\t\t\t\tconst linkedDateModification = gantt.config.inline_editors_date_processing !== \"keepDuration\";\n\t\t\t\t\tconst linkedColumnEdit = linkedDateModification && (startDateColumn || endDateColumn);\n\n\t\t\t\t\tconst constraintDateColumn = state.columnName === \"constraint_date\";\n\n\t\t\t\t\tconst keepConstraints = durationColumn || linkedColumnEdit || constraintDateColumn;\n\n\t\t\t\t\tif (keepConstraints) {\n\t\t\t\t\t\tconst task = gantt.getTask(state.id);\n\t\t\t\t\t\ttask.$keep_constraints = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t});\n\t\t}\n\n\t\tlet changedConstraint;\n\t\tfunction onBeforeLigthboxSaveHandler(taskId: TaskID, task: ITask): boolean {\n\t\t\tconst autoSchedulingConfig = gantt._getAutoSchedulingConfig();\n\t\t\tif (autoSchedulingConfig.enabled && !gantt._autoscheduling_in_progress) {\n\t\t\t\tchangedConstraint = false;\n\t\t\t\tconst oldTask = gantt.getTask(taskId);\n\t\t\t\tif (_notEqualTaskDates(task, oldTask)) {\n\t\t\t\t\tmodifiedTaskId = taskId;\n\t\t\t\t\tif (shouldKeepConstraints(task, oldTask)){\n\t\t\t\t\t\ttask.$keep_constraints = true;\n\t\t\t\t\t}\n\t\t\t\t\tif(gantt.getConstraintType(task) !== gantt.getConstraintType(oldTask) ||\n\t\t\t\t\t\t+task.constraint_date !== +oldTask.constraint_date\n\t\t\t\t\t){\n\t\t\t\t\t\tchangedConstraint = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t\tfunction onAfterTaskUpdateHandler(taskId: TaskID, task: ITask): boolean {\n\t\t\tconst autoSchedulingConfig = gantt._getAutoSchedulingConfig();\n\t\t\tif (autoSchedulingConfig.enabled && !gantt._autoscheduling_in_progress) {\n\t\t\t\tif (\n\t\t\t\t\tmodifiedTaskId !== null &&\n\t\t\t\t\t// tslint:disable-next-line triple-equals\n\t\t\t\t\tmodifiedTaskId == taskId\n\t\t\t\t) {\n\t\t\t\t\tmodifiedTaskId = null;\n\t\t\t\t\tif (task.$keep_constraints){\n\t\t\t\t\t\tdelete task.$keep_constraints;\n\t\t\t\t\t} else if(!changedConstraint){\n\t\t\t\t\t\tupdateTaskConstraints(task);\n\t\t\t\t\t}\n\t\t\t\t\tgantt.autoSchedule(task.id);\n\n\t\t\t\t\tif(!changedConstraint){\n\t\t\t\t\t\tfinalizeTaskConstraints(task);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\n\t\tconst draggedTask = {};\n\t\tlet timeout;\n\t\tgantt.attachEvent(\"onBeforeTaskChanged\", function(\n\t\t\tid: TaskID,\n\t\t\tmode: string,\n\t\t\ttask: ITask\n\t\t) {\n\t\t\t_processConstraints(id, task);\n\t\t\tdraggedTask[id] = task;\n\t\t\treturn true;\n\t\t});\n\n\t\t// GS-499, GS-264 and GS-836. Autoschedule only after finishing dragging the task\n\t\tgantt.attachEvent(\"onAfterTaskDrag\", function(id, mode, e) {\n\t\t\tif (id === movedTask) {\n\t\t\t\tclearTimeout(timeout);\n\t\t\t\ttimeout = setTimeout(function() {\n\t\t\t\t\t_autoScheduleAfterDND(id, draggedTask[id]);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tif(gantt.ext.inlineEditors){\n\t\t\tgantt.ext.inlineEditors.attachEvent(\"onBeforeSave\", function(state){\n\t\t\t\tconst autoSchedulingConfig = gantt._getAutoSchedulingConfig();\n\t\t\t\tif (autoSchedulingConfig.enabled && !gantt._autoscheduling_in_progress) {\n\t\t\t\t\tconst api = gantt.ext.inlineEditors;\n\t\t\t\t\tconst editorConfig = api.getEditorConfig(state.columnName);\n\t\t\t\t\tif(editorConfig && (editorConfig.map_to === \"start_date\" || editorConfig.map_to === \"end_date\" || editorConfig.map_to === \"duration\")){\n\t\t\t\t\t\tmodifiedTaskId = state.id;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t});\n\t\t}\n\n\t\tgantt.attachEvent(\"onLightboxSave\", onBeforeLigthboxSaveHandler);\n\t\tgantt.attachEvent(\"onAfterTaskUpdate\", onAfterTaskUpdateHandler);\n\t};\n\n\tgantt.attachEvent(\"onGanttReady\", function() {\n\t\t_attachAutoSchedulingHandlers();\n\t\t// attach handlers only when initialized for the first time\n\t}, {once: true});\n}\n","\n/* eslint-disable no-restricted-globals */\nvar globalScope;\nif(typeof window !== \"undefined\"){\n\tglobalScope = window;\n}else{\n\tglobalScope = global;\n}\n/* eslint-enable no-restricted-globals */\n\nexport default globalScope;","import * as domHelpers from \"../../core/ui/utils/dom_helpers\";\nimport global from \"../../utils/global\";\nimport { SelectedRegion } from \"./selectedRegion\";\n\nexport class EventsManager {\n\tprivate _mouseDown: boolean = false;\n\tprivate _touchStarts: boolean = false;\n\tprivate _touchActive: boolean = false;\n\tprivate _longTapTimer: any = false;\n\tprivate _domEvents: any;\n\tprivate _originPosition: string;\n\tprivate _gantt: any;\n\tprivate _restoreOriginPosition: () => void;\n\tconstructor(gantt: any) {\n\t\tthis._gantt = gantt;\n\t\tthis._domEvents = gantt._createDomEventScope();\n\t}\n\n\tattach(selectedRegion: SelectedRegion, useKey?: \"shiftKey\" | \"ctrlKey\" | \"altKey\", ignore?: any): void {\n\t\tconst gantt = this._gantt;\n\t\tconst _target = selectedRegion.getViewPort();\n\t\tthis._originPosition = global.getComputedStyle(_target).display;\n\t\tthis._restoreOriginPosition = () => {\n\t\t\t_target.style.position = this._originPosition;\n\t\t};\n\t\tif (this._originPosition === \"static\") {\n\t\t\t_target.style.position = \"relative\";\n\t\t}\n\t\tconst state = gantt.$services.getService(\"state\");\n\t\tstate.registerProvider(\"clickDrag\", () => {\n\t\t\tconst result = { autoscroll: false };\n\t\t\treturn result;\n\t\t});\n\n\n\t\tlet scheduledDndCoordinates:any = null;\n\t\tconst startDragAndDrop = () => {\n\t\t\tif (!scheduledDndCoordinates) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis._mouseDown = true;\n\t\t\tselectedRegion.setStart(gantt.copy(scheduledDndCoordinates));\n\t\t\tselectedRegion.setPosition(gantt.copy(scheduledDndCoordinates));\n\t\t\tselectedRegion.setEnd(gantt.copy(scheduledDndCoordinates));\n\t\t\tscheduledDndCoordinates = null;\n\t\t};\n\n\t\t// mouse events\n\t\tthis._domEvents.attach(_target, \"mousedown\", (event) => {\n\t\t\tstartDrag(event);\n\t\t});\n\t\tconst eventElement = domHelpers.getRootNode(gantt.$root) || document.body;\n\t\tthis._domEvents.attach(eventElement, \"mouseup\", (event) => {\n\t\t\tstopDrag(event);\n\t\t});\n\t\tthis._domEvents.attach(_target, \"mousemove\", (event) => {\n\t\t\tdragMove(event);\n\t\t});\n\n\t\t// touch events\n\t\tthis._domEvents.attach(_target, \"touchstart\", (event) => {\n\t\t\tthis._touchStarts = true;\n\t\t\tthis._longTapTimer = setTimeout(()=> {\n\t\t\t\tif (this._touchStarts){\n\t\t\t\t\tstartDrag(getTouchEvent (event));\n\t\t\t\t\tthis._touchStarts = false;\n\t\t\t\t\tthis._touchActive = true;\n\t\t\t\t}\n\t\t\t}, this._gantt.config.touch_drag);\n\t\t});\n\n\t\tthis._domEvents.attach(eventElement, \"touchend\", (event) => {\n\t\t\tthis._touchStarts = false;\n\t\t\tthis._touchActive = false;\n\t\t\tclearTimeout(this._longTapTimer);\n\t\t\tstopDrag(getTouchEvent (event));\n\t\t});\n\t\tthis._domEvents.attach(_target, \"touchmove\", (event) => {\n\t\t\tif (this._touchActive){\n\t\t\t\tlet filterTargets = getFilterTargets();\n\t\t\t\tif (filterTargets && gantt.utils.dom.closest(event.target, filterTargets)){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tdragMove(getTouchEvent (event));\n\t\t\t\tevent.preventDefault();\n\t\t\t} else {\n\t\t\t\tthis._touchStarts = false;\n\t\t\t\tclearTimeout(this._longTapTimer);\t\n\t\t\t}\n\t\t});\n\n\t\tfunction getTouchEvent (event){\n\t\t\tconst touchEvent = event.changedTouches && event.changedTouches[0] || event;\n\t\t\treturn touchEvent;\n\t\t}\n\n\t\tconst getFilterTargets = () => {\n\t\t\tlet filterTargets = \".gantt_task_line, .gantt_task_link\";\n\t\t\tif (ignore !== undefined) {\n\t\t\t\tif (ignore instanceof Array) {\n\t\t\t\t\tfilterTargets = ignore.join(\", \");\n\t\t\t\t} else {\n\t\t\t\t\tfilterTargets = ignore;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn filterTargets;\n\t\t};\n\n\t\tconst startDrag: any = (event) => {\n\t\t\tscheduledDndCoordinates = null;\n\t\t\tlet filterTargets = getFilterTargets();\n\t\t\tif (filterTargets) {\n\t\t\t\tif (gantt.utils.dom.closest(event.target, filterTargets)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\tstate.registerProvider(\"clickDrag\", () => {\n\t\t\t\tconst result = { autoscroll: this._mouseDown };\n\t\t\t\treturn result;\n\t\t\t});\n\n\t\t\tif (useKey && event[useKey] !== true) { return; }\n\t\t\tscheduledDndCoordinates = this._getCoordinates(event, selectedRegion);\n\t\t};\n\n\t\tconst stopDrag: any = (event) => {\n\t\t\tscheduledDndCoordinates = null;\n\t\t\tif (useKey && event[useKey] !== true) { return; }\n\t\t\tif (this._mouseDown === true) {\n\t\t\t\tthis._mouseDown = false;\n\t\t\t\tconst coordinates = this._getCoordinates(event, selectedRegion);\n\t\t\t\tselectedRegion.dragEnd(coordinates);\n\t\t\t}\n\t\t};\n\n\t\tconst dragMove: any = (event) => {\n\t\t\tif (useKey && event[useKey] !== true) { return; }\n\t\t\t// GS-854. If we don't have useKey for the click_drag extension,\n\t\t\t// check the drag_timeline to not simultaneously use both extensions\n\t\t\tconst dragTimeline = this._gantt.ext.clickDrag;\n\t\t\tconst dragTimelineUseKey = (this._gantt.config.drag_timeline || {}).useKey;\n\t\t\tif (dragTimeline && dragTimelineUseKey) {\n\t\t\t\tif (!useKey && event[dragTimelineUseKey]) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\tlet coordinates:any = null;\n\t\t\tif(!this._mouseDown && scheduledDndCoordinates){\n\t\t\t\tcoordinates = this._getCoordinates(event, selectedRegion);\n\t\t\t\tif(Math.abs(scheduledDndCoordinates.relative.left - coordinates.relative.left) > 5){\n\t\t\t\t\t// add small threshold not to start dnd on simple click\n\t\t\t\t\tstartDragAndDrop();\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (this._mouseDown === true) {\n\t\t\t\tcoordinates = this._getCoordinates(event, selectedRegion);\n\t\t\t\tselectedRegion.setEnd(coordinates);\n\t\t\t\tselectedRegion.render();\n\t\t\t}\n\t\t};\n\t}\n\n\tdetach(): void {\n\t\tconst gantt = this._gantt;\n\t\tthis._domEvents.detachAll();\n\t\tif(this._restoreOriginPosition){\n\t\t\tthis._restoreOriginPosition();\n\t\t}\n\n\t\tconst state = gantt.$services.getService(\"state\");\n\t\tstate.unregisterProvider(\"clickDrag\");\n\t}\n\n\tdestructor(): void {\n\t\tthis.detach();\n\t}\n\n\tprivate _getCoordinates(event: MouseEvent, selectedRegion: SelectedRegion) {\n\t\tconst viewPort = selectedRegion.getViewPort();\n\t\tconst viewPortBounds = viewPort.getBoundingClientRect();\n\t\tconst { clientX, clientY } = event;\n\t\tconst result = {\n\t\t\tabsolute: {\n\t\t\t\tleft: clientX,\n\t\t\t\ttop: clientY\n\t\t\t},\n\t\t\trelative: {\n\t\t\t\tleft: clientX - viewPortBounds.left + viewPort.scrollLeft,\n\t\t\t\ttop: clientY - viewPortBounds.top + viewPort.scrollTop\n\t\t\t}\n\t\t};\n\t\treturn result;\n\t}\n}","var EventHost = function(){\n\tthis._silent_mode = false;\n\tthis.listeners = {};\n};\n\nEventHost.prototype = {\n\t_silentStart: function() {\n\t\tthis._silent_mode = true;\n\t},\n\t_silentEnd: function() {\n\t\tthis._silent_mode = false;\n\t}\n};\n\nvar\tcreateEventStorage = function(obj) {\n\tvar handlers = {};\n\tvar index = 0;\n\tvar eventStorage = function(){\n\t\tvar combinedResult = true;\n\t\tfor(var i in handlers){\n\t\t\tvar handlerResult = handlers[i].apply(obj, arguments);\n\t\t\tcombinedResult=combinedResult && handlerResult;\n\t\t}\n\t\treturn combinedResult;\n\t};\n\teventStorage.addEvent=function(handler, settings){\n\t\tif (typeof (handler) == \"function\"){\n\t\t\tvar handlerId;\n\t\t\tif(settings && settings.id){\n\t\t\t\thandlerId = settings.id;\n\t\t\t}else{\n\t\t\t\thandlerId = index;\n\t\t\t\tindex++;\n\t\t\t}\n\n\t\t\tif(settings && settings.once){\n\t\t\t\tvar originalHandler = handler;\n\t\t\t\thandler = function(){\n\t\t\t\t\toriginalHandler();\n\t\t\t\t\teventStorage.removeEvent(handlerId);\n\t\t\t\t};\n\t\t\t}\n\n\t\t\thandlers[handlerId] = handler;\n\t\t\treturn handlerId;\n\t\t}\n\t\treturn false;\n\t};\n\teventStorage.removeEvent=function(id){\n\t\tdelete handlers[id];\n\t};\n\n\teventStorage.clear = function(){\n\t\thandlers = {};\n\t};\n\n\treturn eventStorage;\n};\n\nfunction makeEventable(obj){\n\n\tvar eventHost = new EventHost();\n\tobj.attachEvent=function(eventName, handler, settings){\n\t\teventName = 'ev_'+eventName.toLowerCase();\n\t\tif (!eventHost.listeners[eventName]){\n\t\t\teventHost.listeners[eventName] = createEventStorage(this);\n\t\t}\n\n\t\tif(settings && settings.thisObject){\n\t\t\thandler = handler.bind(settings.thisObject);\n\t\t}\n\n\t\tvar innerId = eventHost.listeners[eventName].addEvent(handler, settings);\n\n\t\tvar handlerId = (eventName+':'+innerId); //return ID (ev_eventname:1)\n\t\tif(settings && settings.id){\n\t\t\thandlerId = settings.id;\n\t\t}\n\t\treturn handlerId;\n\t};\n\n\tobj.attachAll = function(callback){\n\t\tthis.attachEvent('listen_all', callback);\n\t};\n\n\tobj.callEvent=function(name, eventArguments){\n\t\tif (eventHost._silent_mode) return true;\n\n\t\tvar handlerName = 'ev_'+name.toLowerCase();\n\n\t\tvar listeners = eventHost.listeners;\n\t\tif (listeners['ev_listen_all']){\n\t\t\tlisteners['ev_listen_all'].apply(this, [name].concat(eventArguments));\n\t\t}\n\n\t\tif (listeners[handlerName])\n\t\t\treturn listeners[handlerName].apply(this, eventArguments);\n\t\treturn true;\n\t};\n\n\tobj.checkEvent=function(name){\n\t\tvar listeners = eventHost.listeners;\n\t\treturn (!!listeners['ev_'+name.toLowerCase()]);\n\t};\n\n\tobj.detachEvent=function(id){\n\t\tif (id){\n\t\t\tvar listeners = eventHost.listeners;\n\t\t\tfor(var i in listeners){\n\t\t\t\tlisteners[i].removeEvent(id); //remove event\n\t\t\t}\n\n\t\t\tvar list = id.split(':');//get EventName and ID\n\t\t\tvar listeners = eventHost.listeners;\n\t\t\tif(list.length === 2){\n\t\t\t\tvar eventName = list[0];\n\t\t\t\tvar eventId = list[1];\n\t\t\t\tif(listeners[eventName]){\n\t\t\t\t\tlisteners[eventName].removeEvent(eventId); //remove event\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\tobj.detachAllEvents = function(){\n\t\tfor (var name in eventHost.listeners) {\n\t\t\teventHost.listeners[name].clear();\n\t\t}\n\t};\n\n}\n\nexport default makeEventable;","import eventable from \"../../utils/eventable\";\nimport { isEventable } from \"../../utils/helpers\";\n\nexport interface ISelectedRegionConfig {\n\tclassName?: string;\n\trender?: (startPoint: IPoint, endPoint: IPoint) => HTMLElement;\n\tviewPort?: HTMLElement;\n\tuseRequestAnimationFrame: boolean;\n\tcallback?: (startPoint: IPoint, endPoint: IPoint, startDate: Date, endDate: Date, tasksByDate: any[], tasksByIndex: any[]) => void;\n\tsingleRow: boolean;\n}\n\ninterface ICoordinates {\n\tleft: number;\n\ttop: number;\n}\n\nexport interface IPoint {\n\tabsolute: ICoordinates;\n\trelative: ICoordinates;\n}\n\nexport class SelectedRegion {\n\trender: () => void;\n\tprivate _viewPort: HTMLElement & eventable;\n\tprivate _el: HTMLElement = document.createElement(\"div\");\n\tprivate _callback: (startPoint: IPoint, endPoint: IPoint, startDate: Date, endDate: Date, tasksByDate: any[], tasksByIndex: any[]) => void;\n\tprivate _startPoint: IPoint;\n\tprivate _endPoint: IPoint;\n\tprivate _positionPoint: IPoint;\n\tprivate _useRequestAnimationFrame: boolean;\n\tprivate _startDate: Date;\n\tprivate _endDate: Date;\n\tprivate _singleRow: boolean;\n\tprivate _gantt: any;\n\tprivate _view: any;\n\n\tconstructor(config: ISelectedRegionConfig, gantt: any, view: any) {\n\t\tthis._gantt = gantt;\n\t\tthis._view = view;\n\t\tthis._viewPort = config.viewPort;\n\t\tthis._el.classList.add(config.className);\n\t\tif (typeof config.callback === \"function\") {\n\t\t\tthis._callback = config.callback;\n\t\t}\n\n\t\tthis.render = () => {\n\t\t\tlet node;\n\t\t\tif(config.render){\n\t\t\t\tnode = config.render(this._startPoint, this._endPoint);\n\t\t\t}else{\n\t\t\t\tnode = this.defaultRender(this._startPoint, this._endPoint);\n\t\t\t}\n\n\t\t\tif(node !== this._el){\n\t\t\t\tif(this._el && this._el.parentNode){\n\t\t\t\t\tthis._el.parentNode.removeChild(this._el);\n\t\t\t\t}\n\t\t\t\tthis._el = node;\n\t\t\t}\n\n\t\t\tif (config.className !== \"\") {\n\t\t\t\tthis._el.classList.add(config.className);\n\t\t\t}\n\t\t\tthis.draw();\n\t\t};\n\n\t\tif (!isEventable(this._viewPort)) {\n\t\t\teventable(this._viewPort);\n\t\t}\n\t\tthis._singleRow = config.singleRow;\n\t\tthis._useRequestAnimationFrame = config.useRequestAnimationFrame;\n\t}\n\n\tdefaultRender = (start: IPoint, end: IPoint) => {\n\t\tif(!this._el){\n\t\t\tthis._el = document.createElement(\"div\");\n\t\t}\n\t\tconst node = this._el;\n\t\t// const gantt = this._gantt;\n\n\t\tconst top = Math.min(start.relative.top, end.relative.top);\n\t\tconst bottom = Math.max(start.relative.top, end.relative.top);\n\t\tconst left = Math.min(start.relative.left, end.relative.left);\n\t\tconst right = Math.max(start.relative.left, end.relative.left);\n\n\t\tif (this._singleRow) {\n\t\t\tconst pos = this._getTaskPositionByTop(this._startPoint.relative.top);\n\t\t\tnode.style.height = pos.height + \"px\";\n\t\t\tnode.style.top = pos.top + \"px\";\n\t\t} else {\n\t\t\tnode.style.height = Math.abs(bottom - top) + \"px\";\n\t\t\tnode.style.top = top + \"px\";\n\t\t}\n\t\tnode.style.width = Math.abs(right - left) + \"px\";\n\t\tnode.style.left = left + \"px\";\n\t\treturn node;\n\t};\n\n\tdraw() {\n\t\tif (this._useRequestAnimationFrame) {\n\t\t\treturn requestAnimationFrame(() => {\n\t\t\t\tthis._viewPort.appendChild(this.getElement());\n\t\t\t});\n\t\t} else {\n\t\t\tthis._viewPort.appendChild(this.getElement());\n\t\t}\n\t}\n\n\tclear() {\n\t\tif (this._useRequestAnimationFrame) {\n\t\t\treturn requestAnimationFrame(() => {\n\t\t\t\tif (!this._el.parentNode) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis._viewPort.removeChild(this._el);\n\t\t\t});\n\t\t} else {\n\t\t\tif (!this._el.parentNode) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis._viewPort.removeChild(this._el);\n\t\t}\n\t}\n\n\tgetElement() {\n\t\treturn this._el;\n\t}\n\n\tgetViewPort() {\n\t\treturn this._viewPort;\n\t}\n\n\tsetStart(startPoint: IPoint) {\n\t\tconst gantt = this._gantt;\n\t\tthis._startPoint = startPoint;\n\t\tthis._startDate = gantt.dateFromPos(this._startPoint.relative.left);\n\t\tthis._viewPort.callEvent(\"onBeforeDrag\", [this._startPoint]);\n\t}\n\n\tsetEnd(endPoint: IPoint) {\n\t\tconst gantt = this._gantt;\n\t\tthis._endPoint = endPoint;\n\t\tif (this._singleRow) {\n\t\t\tconst pos = this._getTaskPositionByTop(this._startPoint.relative.top);\n\t\t\tthis._endPoint.relative.top = pos.top;\n\t\t}\n\t\tthis._endDate = gantt.dateFromPos(this._endPoint.relative.left);\n\t\tif (this._startPoint.relative.left > this._endPoint.relative.left) {\n\t\t\tthis._positionPoint = {\n\t\t\t\trelative: { left: this._endPoint.relative.left, top: this._positionPoint.relative.top },\n\t\t\t\tabsolute: { left: this._endPoint.absolute.left, top: this._positionPoint.absolute.top }\n\t\t\t};\n\t\t}\n\t\tif (this._startPoint.relative.top > this._endPoint.relative.top) {\n\t\t\tthis._positionPoint = {\n\t\t\t\trelative: { left: this._positionPoint.relative.left, top: this._endPoint.relative.top },\n\t\t\t\tabsolute: { left: this._positionPoint.absolute.left, top: this._endPoint.absolute.top }\n\t\t\t};\n\t\t}\n\n\n\t\tthis._viewPort.callEvent(\"onDrag\", [this._startPoint, this._endPoint]);\n\t}\n\n\tsetPosition(positionPoint: IPoint) {\n\t\tthis._positionPoint = positionPoint;\n\t}\n\n\tdragEnd(endPoint: IPoint) {\n\t\tconst gantt = this._gantt;\n\t\tif(endPoint.relative.left < 0){\n\t\t\tendPoint.relative.left = 0;\n\t\t}\n\t\tthis._viewPort.callEvent(\"onBeforeDragEnd\", [this._startPoint, endPoint]);\n\t\tthis.setEnd(endPoint);\n\t\t// GS-1422. The endDate can be null if we drag the mouse outside the Gantt container\n\t\tthis._endDate = this._endDate || gantt.getState().max_date;\n\n\t\tif (this._startDate.valueOf() > this._endDate.valueOf()) {\n\t\t\t[ this._startDate, this._endDate ] = [ this._endDate, this._startDate ];\n\t\t}\n\t\tthis.clear();\n\t\tconst tasksByTime = gantt.getTaskByTime(this._startDate, this._endDate);\n\t\tconst tasksByIndex = this._getTasksByTop(this._startPoint.relative.top, this._endPoint.relative.top);\n\n\t\tthis._viewPort.callEvent(\"onDragEnd\", [this._startPoint, this._endPoint]);\n\t\tif (this._callback) {\n\t\t\tthis._callback(this._startPoint, this._endPoint, this._startDate, this._endDate, tasksByTime, tasksByIndex);\n\t\t}\n\t}\n\n\tgetInBounds() {\n\t\treturn this._singleRow;\n\t}\n\n\tprivate _getTasksByTop(start: number, end:number) {\n\t\tconst gantt = this._gantt;\n\t\tlet startValue = start;\n\t\tlet endValue = end;\n\t\tif (start > end) {\n\t\t\tstartValue = end;\n\t\t\tendValue = start;\n\t\t}\n\t\tconst startIndex = this._getTaskPositionByTop(startValue).index;\n\t\tconst endIndex = this._getTaskPositionByTop(endValue).index;\n\t\tconst result = [];\n\t\tfor (let i = startIndex; i <= endIndex; i++) {\n\t\t\tconst task = gantt.getTaskByIndex(i);\n\t\t\tif (task) {\n\t\t\t\tresult.push(gantt.getTaskByIndex(i));\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tprivate _getTaskPositionByTop(top: number){\n\t\tconst gantt = this._gantt;\n\t\tconst view = this._view;\n\t\tconst index = view.getItemIndexByTopPosition(top);\n\t\tconst task = gantt.getTaskByIndex(index);\n\t\tif(task){\n\t\t\tconst height = view.getItemHeight(task.id);\n\t\t\tconst itemTop = view.getItemTop(task.id);\n\t\t\treturn {\n\t\t\t\ttop: itemTop || 0,\n\t\t\t\theight: height || 0,\n\t\t\t\tindex\n\t\t\t};\n\t\t} else {\n\t\t\tconst dataHeight = view.getTotalHeight();\n\t\t\treturn {\n\t\t\t\ttop: top > dataHeight ? dataHeight : 0,\n\t\t\t\theight: gantt.config.row_height,\n\t\t\t\tindex: top > dataHeight ? gantt.getTaskCount() : 0\n\t\t\t};\n\t\t}\n\t}\n}","interface IPoint {\n\tx: number;\n\ty: number;\n}\n\nlet _dragInProgress: boolean = false;\n\nexport class EventsManager {\n\tstatic create(gantt: any) {\n\t\treturn new EventsManager(gantt);\n\t}\n\tstatic _isDragInProgress() {\n\t\treturn _dragInProgress;\n\t}\n\tprivate _mouseDown: boolean = false;\n\tprivate _startPoint: IPoint;\n\tprivate _scrollState: IPoint;\n\tprivate _originAutoscroll: boolean;\n\tprivate _domEvents: any;\n\tprivate _timeline: any;\n\tprivate _gantt: any;\n\tprivate _trace: IPoint[];\n\tprivate _originalReadonly: boolean;\n\n\tconstructor(gantt: any) {\n\t\tthis._gantt = gantt;\n\t\tthis._domEvents = gantt._createDomEventScope();\n\t\tthis._trace = [];\n\t}\n\n\tdestructor() {\n\t\tthis._domEvents.detachAll();\n\t}\n\n\tattach(timeline: any): void {\n\t\tthis._timeline = timeline;\n\t\tconst gantt = this._gantt;\n\t\tthis._domEvents.attach(timeline.$task, \"mousedown\", (event) => {\n\t\t\tif (!gantt.config.drag_timeline) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst { useKey,ignore, enabled } = gantt.config.drag_timeline;\n\t\t\tif(enabled === false) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet filterTargets = \".gantt_task_line, .gantt_task_link\";\n\t\t\tif(ignore !== undefined) {\n\t\t\t\tif(ignore instanceof Array){\n\t\t\t\t\tfilterTargets = ignore.join(\", \");\n\t\t\t\t} else {\n\t\t\t\t\tfilterTargets = ignore;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (filterTargets) {\n\t\t\t\tif (gantt.utils.dom.closest(event.target, filterTargets)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (useKey && event[useKey] !== true) { return; }\n\n\t\t\tthis._startDrag(event);\n\t\t});\n\n\t\tthis._domEvents.attach(document, \"keydown\", (event) => {\n\t\t\tif (!gantt.config.drag_timeline) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst { useKey } = gantt.config.drag_timeline;\n\t\t\tif (useKey && event[useKey] === true) {\n\t\t\t\tthis._applyDndReadyStyles();\n\t\t\t}\n\t\t});\n\t\tthis._domEvents.attach(document, \"keyup\", (event) => {\n\t\t\tif (!gantt.config.drag_timeline) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst { useKey } = gantt.config.drag_timeline;\n\t\t\tif (useKey && event[useKey] === false) {\n\t\t\t\tthis._clearDndReadyStyles();\n\t\t\t\tthis._stopDrag(event);\n\t\t\t}\n\t\t});\n\n\t\tthis._domEvents.attach(document, \"mouseup\", (event) => {\n\t\t\tthis._stopDrag(event);\n\t\t});\n\t\tthis._domEvents.attach(gantt.$root, \"mouseup\", (event) => {\n\t\t\tthis._stopDrag(event);\n\t\t});\n\t\tthis._domEvents.attach(document, \"mouseleave\", (event) => {\n\t\t\tthis._stopDrag(event);\n\t\t});\n\t\tthis._domEvents.attach(gantt.$root, \"mouseleave\", (event) => {\n\t\t\tthis._stopDrag(event);\n\t\t});\n\n\t\tthis._domEvents.attach(gantt.$root, \"mousemove\", (event) => {\n\t\t\tif (!gantt.config.drag_timeline) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst { useKey } = gantt.config.drag_timeline;\n\t\t\tif (useKey && event[useKey] !== true) { return; }\n\t\t\t// GS-854. If we don't have useKey for the drag_timeline extension,\n\t\t\t// check the click_drag to not simultaneously use both extensions\n\t\t\tconst clickDrag = this._gantt.ext.clickDrag;\n\t\t\tconst clickDragUseKey = (this._gantt.config.click_drag || {}).useKey;\n\t\t\tif (clickDrag && clickDragUseKey) {\n\t\t\t\tif (!useKey && event[clickDragUseKey]) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this._mouseDown === true) {\n\t\t\t\tthis._trace.push({ x: event.clientX, y: event.clientY });\n\t\t\t\tconst scrollPosition: IPoint = this._countNewScrollPosition({ x: event.clientX, y: event.clientY });\n\t\t\t\tthis._setScrollPosition(timeline, scrollPosition);\n\t\t\t\tthis._scrollState = scrollPosition;\n\t\t\t\tthis._startPoint = { x: event.clientX, y: event.clientY };\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate _calculateDirectionVector = () => {\n\t\tconst traceSteps = 10;\n\t\tif(this._trace.length >= traceSteps) {\n\t\t\tconst dots = this._trace.slice(this._trace.length - traceSteps);\n\n\t\t\tconst vectors = [];\n\t\t\tfor(let i = 1; i < dots.length; i++) {\n\t\t\t\tvectors.push({\n\t\t\t\t\tx: dots[i].x - dots[i - 1].x,\n\t\t\t\t\ty: dots[i].y - dots[i - 1].y\n\t\t\t\t});\n\t\t\t}\n\t\t\tconst resultVector = {x:0, y:0};\n\n\t\t\tvectors.forEach((vector) => {\n\t\t\t\tresultVector.x += vector.x;\n\t\t\t\tresultVector.y += vector.y;\n\t\t\t});\n\n\t\t\tconst magnitude = Math.sqrt(resultVector.x*resultVector.x + resultVector.y*resultVector.y);\n\t\t\tconst angleDegrees = Math.atan2(Math.abs(resultVector.y), Math.abs(resultVector.x)) * 180 / Math.PI;\n\n\t\t\treturn {\n\t\t\t\tmagnitude,\n\t\t\t\tangleDegrees\n\t\t\t};\n\n\t\t}\n\t\treturn null;\n\t};\n\n\tprivate _applyDndReadyStyles = (): void => {\n\t\tthis._timeline.$task.classList.add(\"gantt_timeline_move_available\");\n\t};\n\n\tprivate _clearDndReadyStyles = (): void => {\n\t\tthis._timeline.$task.classList.remove(\"gantt_timeline_move_available\");\n\t};\n\n\tprivate _getScrollPosition = (timeline: any): IPoint => {\n\t\tconst gantt = this._gantt;\n\t\treturn {\n\t\t\tx: gantt.$ui.getView(timeline.$config.scrollX).getScrollState().position,\n\t\t\ty: gantt.$ui.getView(timeline.$config.scrollY).getScrollState().position\n\t\t};\n\t};\n\tprivate _countNewScrollPosition = (coords: IPoint): IPoint => {\n\t\tconst vector = this._calculateDirectionVector();\n\t\tlet shiftX = this._startPoint.x - coords.x;\n\t\tlet shiftY = this._startPoint.y - coords.y;\n\t\tif(vector){\n\t\t\tif(vector.angleDegrees < 15){\n\t\t\t\tshiftY = 0;\n\t\t\t} else if(vector.angleDegrees > 75){\n\t\t\t\tshiftX = 0;\n\t\t\t}\n\t\t}\n\n\t\tconst result = {\n\t\t\tx: this._scrollState.x + shiftX,\n\t\t\ty: this._scrollState.y + shiftY\n\t\t};\n\t\treturn result;\n\t};\n\tprivate _setScrollPosition = (timeline: any, coords: IPoint): void => {\n\t\tconst gantt = this._gantt;\n\t\trequestAnimationFrame(() => {\n\t\t\tgantt.scrollLayoutCell(timeline.$id, coords.x, coords.y);\n\t\t});\n\t};\n\tprivate _stopDrag = (event: Event): void => {\n\t\tconst gantt = this._gantt;\n\t\tthis._trace = [];\n\t\tgantt.$root.classList.remove(\"gantt_noselect\");\n\n\t\t// We need to set the readonly mode because with the key modifiers, \n\t\t// users may expect to start dragging the timeline on the task and link coordinates\n\t\tif(this._originalReadonly !== undefined && this._mouseDown){\n\t\t\tgantt.config.readonly = this._originalReadonly;\n\t\t\tif(gantt.config.drag_timeline && gantt.config.drag_timeline.render){\n\t\t\t\tgantt.render();\n\t\t\t}\n\t\t}\n\n\t\tif(this._originAutoscroll !== undefined){\n\t\t\tgantt.config.autoscroll = this._originAutoscroll;\n\t\t}\n\n\t\tif(gantt.config.drag_timeline){\n\t\t\tconst { useKey } = gantt.config.drag_timeline;\n\t\t\tif (useKey && event[useKey] !== true) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tthis._mouseDown = false;\n\t\t_dragInProgress = false;\n\t};\n\n\tprivate _startDrag = (event: any) : void => {\n\t\tconst gantt = this._gantt;\n\t\tthis._originAutoscroll = gantt.config.autoscroll;\n\t\tgantt.config.autoscroll = false;\n\t\t_dragInProgress = true;\n\n\t\tgantt.$root.classList.add(\"gantt_noselect\");\n\t\tthis._originalReadonly = gantt.config.readonly;\n\t\tgantt.config.readonly = true;\n\n\t\tif(gantt.config.drag_timeline && gantt.config.drag_timeline.render){\n\t\t\tgantt.render();\n\t\t}\n\n\t\tthis._trace = [];\n\t\tthis._mouseDown = true;\n\t\tconst { x, y } = this._getScrollPosition(this._timeline);\n\t\tthis._scrollState = { x, y };\n\t\tthis._startPoint = { x: event.clientX, y: event.clientY };\n\t\tthis._trace.push(this._startPoint);\n\t};\n}","import * as helpers from \"./helpers\";\n\nvar plainObjectConstructor = ({}).constructor.toString();\nfunction isCustomType(object){\n\tvar constructorString = object.constructor.toString();\n\n\treturn constructorString !== plainObjectConstructor;\n}\n\nfunction isExternalType(object){\n\t// react elements are not plain objects, but they are not custom types either\n\t// can't deep copy them\n\treturn object.$$typeof && object.$$typeof.toString().includes(\"react.\");\n}\n\nfunction copy(object) {\n\tvar i, result; // iterator, types array, result\n\n\tif (object && typeof object == \"object\") {\n\n\t\tswitch (true){\n\t\t\tcase (helpers.isDate(object)):\n\t\t\t\tresult = new Date(object);\n\t\t\t\tbreak;\n\t\t\tcase (helpers.isArray(object)):\n\t\t\t\tresult = new Array(object.length);\n\t\t\t\tfor(i = 0; i < object.length; i++){\n\t\t\t\t\tresult[i] = copy(object[i]);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t/*\t\tcase (helpers.isStringObject(object)):\n\t\t\t\tresult = new String(object);\n\t\t\t\tbreak;\n\t\t\tcase (helpers.isNumberObject(object)):\n\t\t\t\tresult = new Number(object);\n\t\t\t\tbreak;\n\t\t\tcase (helpers.isBooleanObject(object)):\n\t\t\t\tresult = new Boolean(object);\n\t\t\t\tbreak;*/\n\t\t\tdefault:\n\t\t\t\tif(isCustomType(object)){\n\t\t\t\t\tresult = Object.create(object);\n\t\t\t\t}else if (isExternalType(object)){\n\t\t\t\t\tresult = object;\n\t\t\t\t\treturn result;\n\t\t\t\t} else {\n\t\t\t\t\tresult = {};\n\t\t\t\t}\n\n\t\t\t\tfor (i in object) {\n\t\t\t\t\tif (Object.prototype.hasOwnProperty.apply(object, [i]))\n\t\t\t\t\t\tresult[i] = copy(object[i]);\n\t\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn result || object;\n}\n\nfunction mixin (target, source, force){\n\tfor (var f in source)\n\t\tif (((target[f] === undefined) || force)) target[f]=source[f];\n\treturn target;\n}\n\nfunction defined(obj) {\n\treturn typeof(obj) != \"undefined\";\n}\n\nvar seed;\nfunction uid() {\n\tif (!seed)\n\t\tseed = (new Date()).valueOf();\n\n\tseed++;\n\treturn seed;\n}\n\n//creates function with specified \"this\" pointer\nfunction bind(functor, object){\n\tif(functor.bind)\n\t\treturn functor.bind(object);\n\telse\n\t\treturn function(){ return functor.apply(object,arguments); };\n}\n\nfunction event(el, event, handler, capture){\n\tif (el.addEventListener)\n\t\tel.addEventListener(event, handler, capture === undefined ? false : capture);\n\n\telse if (el.attachEvent)\n\t\tel.attachEvent(\"on\"+event, handler);\n}\n\nfunction eventRemove(el, event, handler, capture){\n\tif (el.removeEventListener)\n\t\tel.removeEventListener(event, handler, capture === undefined ? false : capture);\n\n\telse if (el.detachEvent)\n\t\tel.detachEvent(\"on\"+event, handler);\n}\n\nexport {\n\tcopy,\n\tdefined,\n\tmixin,\n\tuid,\n\tbind,\n\tevent,\n\teventRemove\n};","import * as utils from \"../../../utils/utils\";\n\nfunction ScaleHelper(gantt){\n\tvar dateHelper = gantt.date;\n\tvar services = gantt.$services;\n\n\treturn {\n\t\tgetSum: function (sizes, from, to) {\n\t\t\tif (to === undefined)\n\t\t\t\tto = sizes.length - 1;\n\t\t\tif (from === undefined)\n\t\t\t\tfrom = 0;\n\n\t\t\tvar summ = 0;\n\t\t\tfor (var i = from; i <= to; i++)\n\t\t\t\tsumm += sizes[i];\n\n\t\t\treturn summ;\n\t\t},\n\t\tsetSumWidth: function (sum_width, scale, from, to) {\n\t\t\tvar parts = scale.width;\n\n\t\t\tif (to === undefined)\n\t\t\t\tto = parts.length - 1;\n\t\t\tif (from === undefined)\n\t\t\t\tfrom = 0;\n\t\t\tvar length = to - from + 1;\n\n\t\t\tif (from > parts.length - 1 || length <= 0 || to > parts.length - 1)\n\t\t\t\treturn;\n\n\t\t\tvar oldWidth = this.getSum(parts, from, to);\n\n\t\t\tvar diff = sum_width - oldWidth;\n\n\t\t\tthis.adjustSize(diff, parts, from, to);\n\t\t\tthis.adjustSize(-diff, parts, to + 1);\n\n\t\t\tscale.full_width = this.getSum(parts);\n\t\t},\n\t\tsplitSize: function (width, count) {\n\t\t\tvar arr = [];\n\t\t\tfor (var i = 0; i < count; i++) arr[i] = 0;\n\n\t\t\tthis.adjustSize(width, arr);\n\t\t\treturn arr;\n\n\t\t},\n\t\tadjustSize: function (width, parts, from, to) {\n\t\t\tif (!from)\n\t\t\t\tfrom = 0;\n\t\t\tif (to === undefined)\n\t\t\t\tto = parts.length - 1;\n\n\t\t\tvar length = to - from + 1;\n\n\t\t\tvar full = this.getSum(parts, from, to);\n\n\t\t\tfor (var i = from; i <= to; i++) {\n\t\t\t\tvar share = Math.floor(width * (full ? (parts[i] / full) : (1 / length)));\n\n\t\t\t\tfull -= parts[i];\n\t\t\t\twidth -= share;\n\t\t\t\tlength--;\n\n\t\t\t\tparts[i] += share;\n\t\t\t}\n\t\t\tparts[parts.length - 1] += width;\n\t\t},\n\t\tsortScales: function (scales) {\n\t\t\tfunction cellSize(unit, step) {\n\t\t\t\tvar d = new Date(1970, 0, 1);\n\t\t\t\treturn dateHelper.add(d, step, unit) - d;\n\t\t\t}\n\n\t\t\tscales.sort(function (a, b) {\n\t\t\t\tif (cellSize(a.unit, a.step) < cellSize(b.unit, b.step)) {\n\t\t\t\t\treturn 1;\n\t\t\t\t} else if (cellSize(a.unit, a.step) > cellSize(b.unit, b.step)) {\n\t\t\t\t\treturn -1;\n\t\t\t\t} else {\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tfor (var i = 0; i < scales.length; i++) {\n\t\t\t\tscales[i].index = i;\n\t\t\t}\n\t\t},\n\t\t_prepareScaleObject: function(scale){\n\t\t\tvar format = scale.format;\n\t\t\tif(!format){\n\t\t\t\tformat = scale.template || scale.date || \"%d %M\";\n\t\t\t}\n\n\t\t\tif(typeof format === \"string\"){\n\t\t\t\tformat = gantt.date.date_to_str(format);\n\t\t\t}\n\t\t\treturn {\n\t\t\t\tunit: scale.unit || \"day\",\n\t\t\t\tstep: scale.step || 1,\n\t\t\t\tformat: format,\n\t\t\t\tcss: scale.css,\n\t\t\t\tprojection: scale.projection || null,\n\t\t\t\tcolumn_width: scale.column_width || null\n\t\t\t};\n\t\t},\n\t\tprimaryScale: function(config) {\n\t\t\tconst scaleConfig = config || gantt.config;\n\n\t\t\tconst primaryScale = scaleConfig.scales[0];\n\t\t\tconst result = {\n\t\t\t\tunit: primaryScale.unit,\n\t\t\t\tstep: primaryScale.step,\n\t\t\t\ttemplate: primaryScale.template,\n\t\t\t\tformat: primaryScale.format,\n\t\t\t\tdate: primaryScale.date,\n\t\t\t\tcss: primaryScale.css || gantt.templates.scale_cell_class,\n\t\t\t\tprojection: primaryScale.projection || null,\n\t\t\t\tcolumn_width: primaryScale.column_width || null\n\t\t\t};\n\n\t\t\treturn this._prepareScaleObject(result);\n\t\t},\n\t\tgetAdditionalScales: function(config) {\n\t\t\tconst scaleConfig = config || gantt.config;\n\t\t\tconst scales = scaleConfig.scales.slice(1);\n\n\t\t\treturn scales.map(function(scale){\n\t\t\t\treturn this._prepareScaleObject(scale);\n\t\t\t}.bind(this));\n\t\t},\n\t\tprepareConfigs: function (scales, min_coll_width, container_width, scale_height, minDate, maxDate, rtl) {\n\t\t\tvar heights = this.splitSize(scale_height, scales.length);\n\t\t\tvar full_width = container_width;\n\n\t\t\tvar configs = [];\n\t\t\tfor (var i = scales.length - 1; i >= 0; i--) {\n\t\t\t\tvar main_scale = (i == scales.length - 1);\n\t\t\t\tvar cfg = this.initScaleConfig(scales[i], minDate, maxDate);\n\t\t\t\tif (main_scale) {\n\t\t\t\t\tthis.processIgnores(cfg);\n\t\t\t\t}\n\n\t\t\t\tif(main_scale && cfg.column_width){\n\t\t\t\t\tfull_width = cfg.column_width * (cfg.display_count || cfg.count);\n\t\t\t\t}\n\n\t\t\t\tthis.initColSizes(cfg, min_coll_width, full_width, heights[i]);\n\t\t\t\tthis.limitVisibleRange(cfg);\n\n\t\t\t\tif (main_scale) {\n\t\t\t\t\tfull_width = cfg.full_width;\n\t\t\t\t}\n\n\t\t\t\tconfigs.unshift(cfg);\n\t\t\t}\n\n\n\t\t\tfor (var i = 0; i < configs.length - 1; i++) {\n\t\t\t\tthis.alineScaleColumns(configs[configs.length - 1], configs[i]);\n\t\t\t}\n\t\t\tfor (var i = 0; i < configs.length; i++) {\n\n\t\t\t\tif(rtl){\n\t\t\t\t\tthis.reverseScale(configs[i]);\n\t\t\t\t}\n\t\t\t\tthis.setPosSettings(configs[i]);\n\t\t\t}\n\t\t\treturn configs;\n\n\t\t},\n\n\t\treverseScale: function(scale){\n\t\t\tscale.width = scale.width.reverse();\n\t\t\tscale.trace_x = scale.trace_x.reverse();\n\n\t\t\tvar indexes = scale.trace_indexes;\n\t\t\tscale.trace_indexes = {};\n\t\t\tscale.trace_index_transition = {};\n\t\t\tscale.rtl = true;\n\t\t\tfor(var i = 0; i < scale.trace_x.length; i++){\n\t\t\t\tscale.trace_indexes[scale.trace_x[i].valueOf()] = i;\n\t\t\t\tscale.trace_index_transition[indexes[scale.trace_x[i].valueOf()]] = i;\n\t\t\t}\n\t\t\treturn scale;\n\t\t},\n\n\t\tsetPosSettings: function (config) {\n\t\t\tfor (var i = 0, len = config.trace_x.length; i < len; i++) {\n\t\t\t\tconfig.left.push((config.width[i - 1] || 0) + (config.left[i - 1] || 0));\n\t\t\t}\n\t\t},\n\n\t\t_ignore_time_config: function (date, scale) {\n\n\t\t\tif (gantt.config.skip_off_time) {\n\t\t\t\tvar skip = true;\n\t\t\t\tvar probe = date;\n\n\t\t\t\t// check dates in case custom scale unit, e.g. {unit: \"month\", step: 3}\n\t\t\t\tfor (var i = 0; i < scale.step; i++) {\n\t\t\t\t\tif (i) {\n\t\t\t\t\t\tprobe = dateHelper.add(date, i, scale.unit);\n\t\t\t\t\t}\n\n\t\t\t\t\tskip = skip && !this.isWorkTime(probe, scale.unit);\n\t\t\t\t}\n\n\t\t\t\treturn skip;\n\t\t\t}\n\t\t\treturn false;\n\t\t},\n\t\t//defined in an extension\n\t\tprocessIgnores: function (config) {\n\t\t\tconfig.ignore_x = {};\n\t\t\tconfig.display_count = config.count;\n\t\t},\n\t\tinitColSizes: function (config, min_col_width, full_width, line_height) {\n\t\t\tvar cont_width = full_width;\n\n\t\t\tconfig.height = line_height;\n\n\t\t\tvar column_count = config.display_count === undefined ? config.count : config.display_count;\n\n\t\t\tif (!column_count)\n\t\t\t\tcolumn_count = 1;\n\n\t\t\tconst fixedMode = !isNaN(config.column_width*1) && config.column_width*1 > 0;\n\t\t\tif (fixedMode) {\n\t\t\t\tconst baseCellWidth = config.column_width*1;\n\t\t\t\tconfig.col_width = baseCellWidth;\n\t\t\t\tcont_width = baseCellWidth * column_count;\n\t\t\t} else {\n\t\t\t\tconfig.col_width = Math.floor(cont_width / column_count);\n\t\t\t\tif (min_col_width) {\n\t\t\t\t\tif (config.col_width < min_col_width) {\n\t\t\t\t\t\tconfig.col_width = min_col_width;\n\t\t\t\t\t\tcont_width = config.col_width * column_count;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconfig.width = [];\n\t\t\tvar ignores = config.ignore_x || {};\n\t\t\tfor (var i = 0; i < config.trace_x.length; i++) {\n\t\t\t\tif (ignores[config.trace_x[i].valueOf()] || (config.display_count == config.count)) {\n\t\t\t\t\tif(fixedMode){\n\t\t\t\t\t\tconfig.width[i] = config.col_width;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconfig.width[i] = 0;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// width of month columns should be proportional month duration\n\t\t\t\t\tvar width = 1;\n\t\t\t\t\tif (config.unit == \"month\") {\n\t\t\t\t\t\tvar days = Math.round((dateHelper.add(config.trace_x[i], config.step, config.unit) - config.trace_x[i]) / (1000 * 60 * 60 * 24));\n\t\t\t\t\t\twidth = days;\n\t\t\t\t\t}\n\t\t\t\t\tconfig.width[i] = width;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(!fixedMode){\n\t\t\t\tthis.adjustSize(cont_width - this.getSum(config.width)/* 1 width per column from the code above */, config.width);\n\t\t\t}\n\n\t\t\tconfig.full_width = this.getSum(config.width);\n\t\t},\n\t\tinitScaleConfig: function (config, min_date, max_date) {\n\t\t\tvar cfg = utils.mixin({\n\t\t\t\tcount: 0,\n\t\t\t\tcol_width: 0,\n\t\t\t\tfull_width: 0,\n\t\t\t\theight: 0,\n\t\t\t\twidth: [],\n\t\t\t\tleft: [],\n\t\t\t\ttrace_x: [],\n\t\t\t\ttrace_indexes: {},\n\t\t\t\tmin_date: new Date(min_date),\n\t\t\t\tmax_date: new Date(max_date)\n\t\t\t}, config);\n\n\t\t\tthis.eachColumn(config.unit, config.step, min_date, max_date, function (date) {\n\t\t\t\tcfg.count++;\n\t\t\t\tcfg.trace_x.push(new Date(date));\n\t\t\t\tcfg.trace_indexes[date.valueOf()] = cfg.trace_x.length - 1;\n\t\t\t});\n\n\t\t\tcfg.trace_x_ascending = cfg.trace_x.slice();\n\t\t\treturn cfg;\n\t\t},\n\t\titerateScales: function (lower_scale, upper_scale, from, to, callback) {\n\t\t\tvar upper_dates = upper_scale.trace_x;\n\t\t\tvar lower_dates = lower_scale.trace_x;\n\n\t\t\tvar prev = from || 0;\n\t\t\tvar end = to || (lower_dates.length - 1);\n\t\t\tvar prevUpper = 0;\n\n\n\t\t\tfor (var up = 1; up < upper_dates.length; up++) {\n\t\t\t\tvar target_index = (lower_scale.trace_indexes[+upper_dates[up]]);\n\t\t\t\tif (target_index !== undefined && target_index <= end) {\n\t\t\t\t\tif (callback) {\n\t\t\t\t\t\tcallback.apply(this, [prevUpper, up, prev, target_index]);\n\t\t\t\t\t}\n\t\t\t\t\tprev = target_index;\n\t\t\t\t\tprevUpper = up;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\talineScaleColumns: function (lower_scale, upper_scale, from, to) {\n\t\t\tthis.iterateScales(lower_scale, upper_scale, from, to, function (upper_start, upper_end, lower_start, lower_end) {\n\t\t\t\tvar targetWidth = this.getSum(lower_scale.width, lower_start, lower_end - 1);\n\t\t\t\tvar actualWidth = this.getSum(upper_scale.width, upper_start, upper_end - 1);\n\t\t\t\tif (actualWidth != targetWidth) {\n\t\t\t\t\tthis.setSumWidth(targetWidth, upper_scale, upper_start, upper_end - 1);\n\t\t\t\t}\n\n\t\t\t});\n\t\t},\n\n\t\teachColumn: function (unit, step, min_date, max_date, callback) {\n\t\t\tvar start = new Date(min_date),\n\t\t\t\tend = new Date(max_date);\n\t\t\tif (dateHelper[unit + \"_start\"]) {\n\t\t\t\tstart = dateHelper[unit + \"_start\"](start);\n\t\t\t}\n\n\t\t\tvar curr = new Date(start);\n\t\t\tif (+curr >= +end) {\n\t\t\t\tend = dateHelper.add(curr, step, unit);\n\t\t\t}\n\t\t\twhile (+curr < +end) {\n\t\t\t\tcallback.call(this, new Date(curr));\n\t\t\t\tvar tzOffset = curr.getTimezoneOffset();\n\t\t\t\tcurr = dateHelper.add(curr, step, unit);\n\t\t\t\tcurr = gantt._correct_dst_change(curr, tzOffset, step, unit);\n\t\t\t\tif (dateHelper[unit + '_start'])\n\t\t\t\t\tcurr = dateHelper[unit + \"_start\"](curr);\n\t\t\t}\n\t\t},\n\t\tlimitVisibleRange: function (cfg) {\n\t\t\tvar dates = cfg.trace_x;\n\n\t\t\tvar left = 0, right = cfg.width.length - 1;\n\t\t\tvar diff = 0;\n\t\t\tif (+dates[0] < +cfg.min_date && left != right) {\n\t\t\t\tvar width = Math.floor(cfg.width[0] * ((dates[1] - cfg.min_date) / (dates[1] - dates[0])));\n\t\t\t\tdiff += cfg.width[0] - width;\n\t\t\t\tcfg.width[0] = width;\n\n\t\t\t\tdates[0] = new Date(cfg.min_date);\n\t\t\t}\n\n\t\t\tvar last = dates.length - 1;\n\t\t\tvar lastDate = dates[last];\n\t\t\tvar outDate = dateHelper.add(lastDate, cfg.step, cfg.unit);\n\t\t\tif (+outDate > +cfg.max_date && last > 0) {\n\t\t\t\tvar width = cfg.width[last] - Math.floor(cfg.width[last] * ((outDate - cfg.max_date) / (outDate - lastDate)));\n\t\t\t\tdiff += cfg.width[last] - width;\n\t\t\t\tcfg.width[last] = width;\n\t\t\t}\n\n\t\t\tif (diff) {\n\t\t\t\tvar full = this.getSum(cfg.width);\n\t\t\t\tvar shared = 0;\n\t\t\t\tfor (var i = 0; i < cfg.width.length; i++) {\n\t\t\t\t\tvar share = Math.floor(diff * (cfg.width[i] / full));\n\t\t\t\t\tcfg.width[i] += share;\n\t\t\t\t\tshared += share;\n\t\t\t\t}\n\t\t\t\tthis.adjustSize(diff - shared, cfg.width);\n\t\t\t}\n\n\t\t}\n\t};\n}\n\nexport default ScaleHelper;\n","\nimport ScaleHelper from \"./scales\";\n\nfunction ScaleIgnoreHelper(gantt){\n\tvar helper = new ScaleHelper(gantt);\n\n\thelper.processIgnores = function (config) {\n\t\tvar display_count = config.count;\n\t\tconfig.ignore_x = {};\n\t\tif (gantt.ignore_time || gantt.config.skip_off_time) {\n\t\t\tvar ignore = gantt.ignore_time || function () {\n\t\t\t\treturn false;\n\t\t\t};\n\t\t\tdisplay_count = 0;\n\n\t\t\tfor (var i = 0; i < config.trace_x.length; i++) {\n\n\t\t\t\tif (ignore.call(gantt, config.trace_x[i]) || this._ignore_time_config.call(gantt, config.trace_x[i], config)) {\n\t\t\t\t\tconfig.ignore_x[config.trace_x[i].valueOf()] = true;\n\t\t\t\t\tconfig.ignored_colls = true;\n\t\t\t\t} else {\n\t\t\t\t\tdisplay_count++;\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\t\tconfig.display_count = display_count;\n\t};\n\n\treturn helper;\n}\n\nexport default ScaleIgnoreHelper;","export default function(gantt) {\n\n\t(function () {\n\t\tvar modalsStack = [];\n\n\t\tfunction isModal() {\n\t\t\treturn !!modalsStack.length;\n\t\t}\n\n\t\tfunction afterPopup(box) {\n\t\t\tsetTimeout(function () {\n\t\t\t\tif (!isModal()){\n\t\t\t\t\tif(!gantt.$destroyed){\n\t\t\t\t\t\tgantt.focus();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}, 1);\n\t\t}\n\n\t\tfunction startModal(box) {\n\t\t\tgantt.eventRemove(box, \"keydown\", trapFocus);\n\t\t\tgantt.event(box, \"keydown\", trapFocus);\n\t\t\tmodalsStack.push(box);\n\t\t\t//gantt.$keyboardNavigation.dispatcher.disable();\n\t\t}\n\n\t\tfunction endModal() {\n\t\t\tvar box = modalsStack.pop();\n\t\t\tif (box) {\n\t\t\t\tgantt.eventRemove(box, \"keydown\", trapFocus);\n\t\t\t}\n\t\t\tafterPopup(box);\n\n\t\t}\n\n\n\t\tfunction isTopModal(box) {\n\t\t\treturn box == modalsStack[modalsStack.length - 1];\n\t\t}\n\n\t\tfunction trapFocus(event) {\n\t\t\tvar target = event.currentTarget;\n\t\t\tif (!isTopModal(target)) return;\n\n\t\t\tgantt.$keyboardNavigation.trapFocus(target, event);\n\t\t}\n\n\t\tfunction traceLightbox() {\n\t\t\tstartModal(gantt.getLightbox());\n\t\t}\n\n\t\tgantt.attachEvent(\"onLightbox\", traceLightbox);\n\t\tgantt.attachEvent(\"onAfterLightbox\", endModal);\n\t\tgantt.attachEvent(\"onLightboxChange\", function () {\n\t\t\tendModal();\n\t\t\ttraceLightbox();\n\t\t});\n\n\n\t\tgantt.attachEvent(\"onAfterQuickInfo\", function () {\n\t\t\tafterPopup();\n\t\t});\n\n\t\tgantt.attachEvent(\"onMessagePopup\", function (box) {\n\t\t\tsaveFocus();\n\t\t\tstartModal(box);\n\t\t});\n\t\tgantt.attachEvent(\"onAfterMessagePopup\", function () {\n\t\t\tendModal();\n\t\t\trestoreFocus();\n\t\t});\n\n\t\tvar focusElement = null;\n\n\t\tfunction saveFocus() {\n\t\t\tfocusElement = gantt.utils.dom.getActiveElement();\n\t\t}\n\n\t\tfunction restoreFocus() {\n\t\t\tsetTimeout(function () {\n\t\t\t\tif (focusElement && focusElement.focus) {\n\t\t\t\t\tfocusElement.focus();\n\t\t\t\t\tfocusElement = null;\n\t\t\t\t}\n\t\t\t}, 1);\n\t\t}\n\n\t\tgantt.$keyboardNavigation.isModal = isModal;\n\n\n\t})();\n\n};","\ninterface IQuickInfoContainer{\n\tparent: HTMLElement;\n\txViewport: HTMLElement;\n\tyViewport: HTMLElement;\n}\n\nexport class QuickInfo {\n\tprivate _quickInfoTask: TaskID;\n\tprivate _quickInfoBoxId: number | string;\n\tprivate _quickInfoBox: HTMLElement;\n\tprivate _quickInfoReadonly: boolean | null;\n\tprivate _container: HTMLElement;\n\tprivate _gantt: any;\n\n\tconstructor(gantt: any) {\n\t\tthis._gantt = gantt;\n\t}\n\n\t// show at coordinates:\n\t// show(x: number, y: number)\n\t// show for a task:\n\t// show(id: TaskID)\n\tshow : {\n\t\t(x: number, y: number) : void;\n\t\t(id: TaskID) : void;\n\t} = (id: TaskID | number, y? : number) : void => {\n\t\tif (y === undefined) {\n\t\t\tthis._showForTask(id);\n\t\t} else {\n\t\t\tthis._showAtCoordinates(id as number, y);\n\t\t}\n\t};\n\n\thide = (forced?: boolean) : any => {\n\t\tconst gantt = this._gantt;\n\t\tconst qi = this._quickInfoBox;\n\t\tthis._quickInfoBoxId = 0;\n\t\tconst taskId = this._quickInfoTask;\n\t\tthis._quickInfoTask = null;\n\n\t\tif (qi && qi.parentNode){\n\n\t\t\tif (gantt.config.quick_info_detached) {\n\t\t\t\tgantt.callEvent(\"onAfterQuickInfo\", [taskId]);\n\t\t\t\treturn qi.parentNode.removeChild(qi);\n\t\t\t}\n\n\t\t\tqi.className += \" gantt_qi_hidden\";\n\t\t\tif (qi.style.right === \"auto\"){\n\t\t\t\tqi.style.left = \"-350px\";\n\t\t\t} else {\n\t\t\t\tqi.style.right = \"-350px\";\n\t\t\t}\n\n\t\t\tif (forced) {\n\t\t\t\tqi.style.left = qi.style.right = \"\";\n\t\t\t\tqi.parentNode.removeChild(qi);\n\t\t\t}\n\t\t\tgantt.callEvent(\"onAfterQuickInfo\", [taskId]);\n\t\t}\n\t};\n\n\tgetNode = (): HTMLElement => {\n\t\tif(this._quickInfoBox) {\n\t\t\treturn this._quickInfoBox;\n\t\t}\n\t\treturn null;\n\t};\n\n\tsetContainer = (container: string|HTMLElement): void => {\n\t\tif(container){\n\t\t\tthis._container = typeof container === \"string\" ? document.getElementById(container) : container;\n\t\t}\n\t};\n\n\tsetContent = (content?: IQuickInfoContent) => {\n\t\tconst gantt = this._gantt;\n\n\t\tconst defaultContent = {\n\t\t\ttaskId: null,\n\t\t\theader: {\n\t\t\t\ttitle: \"\",\n\t\t\t\tdate: \"\"\n\t\t\t},\n\t\t\tcontent: \"\",\n\t\t\tbuttons: gantt.config.quickinfo_buttons\n\t\t};\n\n\t\tif(!content){\n\t\t\tcontent = defaultContent;\n\t\t}\n\n\t\tif(!content.taskId){\n\t\t\tcontent.taskId = defaultContent.taskId;\n\t\t}\n\n\t\tif(!content.header){\n\t\t\tcontent.header = defaultContent.header;\n\t\t}\n\n\t\tif(!content.header.title){\n\t\t\tcontent.header.title = defaultContent.header.title;\n\t\t}\n\t\tif(!content.header.date){\n\t\t\tcontent.header.date = defaultContent.header.date;\n\t\t}\n\t\tif(!content.content){\n\t\t\tcontent.content = defaultContent.content;\n\t\t}\n\t\tif(!content.buttons){\n\t\t\tcontent.buttons = defaultContent.buttons;\n\t\t}\n\n\n\t\tlet qi = this.getNode();\n\t\tif(!qi){\n\t\t\tqi = this._createQuickInfoElement();\n\t\t}\n\n\t\tif(content.taskId){\n\t\t\tthis._quickInfoBoxId = content.taskId;\n\t\t}\n\n\t\tconst titleBox = qi.querySelector(\".gantt_cal_qi_title\") as HTMLElement;\n\t\tconst titleContent = titleBox.querySelector(\".gantt_cal_qi_tcontent\");\n\t\tconst titleDate = titleBox.querySelector(\".gantt_cal_qi_tdate\");\n\t\tconst main = qi.querySelector(\".gantt_cal_qi_content\");\n\t\tconst controls = qi.querySelector(\".gantt_cal_qi_controls\") as HTMLElement;\n\n\t\tgantt._waiAria.quickInfoHeader(qi, [content.header.title, content.header.date].join(\" \"));\n\n\t\ttitleContent.innerHTML = content.header.title;\n\t\ttitleDate.innerHTML = content.header.date;\n\n\t\tif(!content.header.title && !content.header.date){\n\t\t\ttitleBox.style.display = \"none\";\n\t\t}else{\n\t\t\ttitleBox.style.display = \"\";\n\t\t}\n\t\tmain.innerHTML = content.content;\n\n\t\tconst buttons = content.buttons;\n\t\tif(!buttons.length){\n\t\t\tcontrols.style.display = \"none\";\n\t\t}else{\n\t\t\tcontrols.style.display = \"\";\n\t\t}\n\t\tlet html = \"\";\n\t\tfor (let i = 0; i < buttons.length; i++){\n\n\t\t\tconst ariaAttr = gantt._waiAria.quickInfoButtonAttrString(gantt.locale.labels[buttons[i]]);\n\n\t\t\thtml += `<div class=\"gantt_qi_big_icon ${buttons[i]} dhx_gantt_${buttons[i]}\" title=\"${gantt.locale.labels[buttons[i]]}\" ${ariaAttr}>\n            <div class='dhx_menu_icon dhx_gantt_icon ${buttons[i]} gantt_menu_icon dhx_gantt_${buttons[i]}'></div>\n            <div>${gantt.locale.labels[buttons[i]]}</div>\n         </div>`;\n\t\t}\n\t\tcontrols.innerHTML = html;\n\n\t\tgantt.eventRemove(qi, \"click\", this._qiButtonClickHandler);\n\t\tgantt.eventRemove(qi, \"keypress\", this._qiKeyPressHandler);\n\n\t\tgantt.event(qi, \"click\", this._qiButtonClickHandler);\n\t\tgantt.event(qi, \"keypress\", this._qiKeyPressHandler);\n\t};\n\n\tprivate _qiButtonClickHandler = (ev) => {\n\t\tthis._qi_button_click(ev.target);\n\t};\n\n\tprivate _qiKeyPressHandler = (e) => {\n\n\t\tconst code = e.which;\n\t\tif (code === 13 || code === 32){\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis._qi_button_click(e.target);\n\t\t\t},1);\n\t\t}\n\t};\n\n\tprivate _showAtCoordinates(x: number, y: number) : void {\n\t\tthis.hide(true);\n\t\tthis._quickInfoBoxId = 0;\n\t\tthis._quickInfoTask = null;\n\t\tif(!this._quickInfoBox){\n\t\t\tthis._createQuickInfoElement();\n\t\t\tthis.setContent();\n\t\t}\n\n\t\tthis._appendAtCoordinates(x, y);\n\t\tthis._gantt.callEvent(\"onQuickInfo\", [null]);\n\t}\n\n\tprivate _showForTask(id: TaskID) : void {\n\t\tconst gantt = this._gantt;\n\t\tif ((\n\t\t\tid === this._quickInfoBoxId &&\n\t\t\tgantt.utils.dom.isChildOf(this._quickInfoBox, document.body)\n\t\t) || !gantt.config.show_quick_info) {\n\t\t\t// not show if the quick info is already displayed for this task, or if it shouldn't be displayed\n\t\t\treturn;\n\t\t}\n\t\tthis.hide(true);\n\t\tconst offset = 6; // offset TASK <> QI-BOX in 'px'\n\t\tconst container = this._getContainer();\n\t\tconst pos = this._get_event_counter_part(id, offset, container.xViewport, container.yViewport);\n\n\t\tif (pos){\n\t\t\tthis._quickInfoBox = this._init_quick_info(id);\n\t\t\tthis._quickInfoTask = id;\n\t\t\tthis._quickInfoBox.className = this._prepare_quick_info_classname(id);\n\n\t\t\tthis._fill_quick_data(id);\n\t\t\tthis._show_quick_info(pos, offset);\n\t\t\tgantt.callEvent(\"onQuickInfo\", [id]);\n\t\t}\n\t}\n\n\tprivate _get_event_counter_part(id: TaskID, offset: number, xViewport: HTMLElement, yViewport: HTMLElement) : any {\n\t\tconst gantt = this._gantt;\n\t\tlet domEv = gantt.getTaskNode(id);\n\t\tif (!domEv) {\n\t\t\tdomEv = gantt.getTaskRowNode(id);\n\t\t\tif (!domEv) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t\tlet left = 0;\n\t\tconst top = offset + domEv.offsetTop + domEv.offsetHeight;\n\n\t\tlet node = domEv;\n\n\t\tif (gantt.utils.dom.isChildOf(node, xViewport)) {\n\t\t\twhile (node && node !== xViewport){\n\t\t\t\tleft += node.offsetLeft;\n\t\t\t\tnode = node.offsetParent;\n\t\t\t}\n\t\t}\n\n\t\tconst scroll = gantt.getScrollState();\n\n\t\tif(node){\n\t\t\tconst dx = (left + domEv.offsetWidth/2) - scroll.x > (xViewport.offsetWidth/2) ? 1 : 0;\n\t\t\tconst dy = (top + domEv.offsetHeight/2) - scroll.y > (yViewport.offsetHeight/2) ? 1 : 0;\n\n\t\t\treturn { left, top, dx, dy, width:domEv.offsetWidth, height:domEv.offsetHeight };\n\t\t}\n\t\treturn null;\n\t}\n\n\tprivate _createQuickInfoElement() : HTMLElement {\n\t\tconst gantt = this._gantt;\n\t\tconst qi = document.createElement(\"div\");\n\t\tqi.className += \"gantt_cal_quick_info\";\n\t\tgantt._waiAria.quickInfoAttr(qi);\n\n\t\t// title\n\t\tconst ariaAttr = gantt._waiAria.quickInfoHeaderAttrString();\n\t\tvar html = `\n\t\t<div class=\"gantt_cal_qi_tcontrols\">\n\t\t\t<a class=\"gantt_cal_qi_close_btn dhx_gantt_icon dhx_gantt_icon_close\"></a>\n\t\t</div>\n\t\t<div class=\"gantt_cal_qi_title\" ${ariaAttr}>\n\t\t\t\t\n\t\t\t\t<div class=\"gantt_cal_qi_tcontent\"></div>\n\t\t\t\t<div class=\"gantt_cal_qi_tdate\"></div>\n\t\t\t</div>\n\t\t\t<div class=\"gantt_cal_qi_content\"></div>`;\n\n\t\t//buttons\n\t\thtml += \"<div class=\\\"gantt_cal_qi_controls\\\">\";\n\n\t\thtml += \"</div>\";\n\n\t\tqi.innerHTML = html;\n\n\n\t\tif (gantt.config.quick_info_detached) {\n\t\t\tconst container = this._getContainer();\n\t\t\tgantt.event(container.parent, \"scroll\", () => { this.hide(); });\n\t\t}\n\n\t\tthis._quickInfoBox = qi;\n\t\treturn qi;\n\t}\n\n\tprivate _init_quick_info(id: TaskID) : HTMLElement {\n\t\tconst gantt = this._gantt;\n\t\tconst task = gantt.getTask(id);\n\t\t\n\n\t\tif(typeof this._quickInfoReadonly === \"boolean\"){\n\t\t\tif(gantt.isReadonly(task) !== this._quickInfoReadonly){\n\t\t\t\tthis.hide(true);\n\t\t\t\tthis._quickInfoBox = null;\n\t\t\t}\n\t\t}\n\n\t\tthis._quickInfoReadonly = gantt.isReadonly(task);\n\n\t\tif (!this._quickInfoBox){\n\t\t\tthis._quickInfoBox = this._createQuickInfoElement();\n\t\t}\n\n\t\treturn this._quickInfoBox;\n\t}\n\n\tprivate _prepare_quick_info_classname(id: TaskID) : string {\n\t\tconst gantt = this._gantt;\n\t\tconst task = gantt.getTask(id);\n\t\tconst taskType = gantt.getTaskType(task);\n\n\t\tlet css = `gantt_cal_quick_info gantt_${taskType}`;\n\t\tconst template = gantt.templates.quick_info_class(task.start_date, task.end_date, task);\n\n\t\tif(template){\n\t\t\tcss += \" \" + template;\n\t\t}\n\t\treturn css;\n\t}\n\n\tprivate _fill_quick_data(id: TaskID) : void {\n\t\tconst gantt = this._gantt;\n\t\tconst ev = gantt.getTask(id);\n\n\t\tthis._quickInfoBoxId = id;\n\n\t\tlet allowedButtons = [];\n\t\tif (this._quickInfoReadonly){\n\t\t\tconst buttons = gantt.config.quickinfo_buttons;\n\t\t\tconst isEditor = {icon_delete: true, icon_edit: true};\n\t\t\tfor (let i = 0; i < buttons.length; i++){\n\t\t\t\tif(this._quickInfoReadonly && isEditor[buttons[i]]){\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tallowedButtons.push(buttons[i]);\n\t\t\t}\n\t\t} else {\n\t\t\tallowedButtons = gantt.config.quickinfo_buttons;\n\t\t}\n\n\t\tthis.setContent({\n\t\t\theader: {\n\t\t\t\ttitle: gantt.templates.quick_info_title(ev.start_date, ev.end_date, ev),\n\t\t\t\tdate: gantt.templates.quick_info_date(ev.start_date, ev.end_date, ev)\n\t\t\t},\n\t\t\tcontent: gantt.templates.quick_info_content(ev.start_date, ev.end_date, ev),\n\t\t\tbuttons: allowedButtons\n\t\t});\n\t}\n\n\tprivate _appendAtCoordinates(x: number, y: number): void {\n\t\tconst qi = this._quickInfoBox;\n\t\tconst container = this._getContainer();\n\t\tif (!qi.parentNode ||\n\t\t\tqi.parentNode.nodeName.toLowerCase() === \"#document-fragment\"){ // IE8\n\t\t\tcontainer.parent.appendChild(qi);\n\t\t}\n\n\t\tqi.style.left = x + \"px\";\n\t\tqi.style.top = y + \"px\";\n\t}\n\n\tprivate _show_quick_info(pos: any, offset: number) : void {\n\t\tconst gantt = this._gantt;\n\t\tconst qi = this._quickInfoBox;\n\t\tif (gantt.config.quick_info_detached) {\n\t\t\tconst container = this._getContainer();\n\t\t\tif (!qi.parentNode ||\n\t\t\t\tqi.parentNode.nodeName.toLowerCase() === \"#document-fragment\"){ // IE8\n\t\t\t\tcontainer.parent.appendChild(qi);\n\t\t\t}\n\t\t\tconst width = qi.offsetWidth;\n\t\t\tconst popupHeight = qi.offsetHeight;\n\n\t\t\tconst scrolls = gantt.getScrollState();\n\t\t\tconst xViewport = container.xViewport;\n\t\t\tconst yViewport = container.yViewport;\n\t\t\tconst screenWidth = xViewport.offsetWidth + scrolls.x - width;\n\n\t\t\tconst relativePopupTop = pos.top - scrolls.y;\n\t\t\tconst relativePopupBottom = relativePopupTop + popupHeight;\n\n\t\t\tlet top = pos.top;\n\t\t\tif(relativePopupBottom > yViewport.offsetHeight / 2){\n\t\t\t\ttop = pos.top - (popupHeight + pos.height + 2*offset);\n\t\t\t\tif(top < scrolls.y && relativePopupBottom <= yViewport.offsetHeight){\n\t\t\t\t\ttop = pos.top;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (top < scrolls.y) {\n\t\t\t\ttop = scrolls.y;\n\t\t\t}\n\n\t\t\tconst x = Math.min(Math.max(scrolls.x, pos.left - pos.dx*(width - pos.width)), screenWidth);\n\t\t\tconst y = top;\n\n\t\t\tthis._appendAtCoordinates(x, y);\n\t\t} else {\n\t\t\tqi.style.top = 20 + \"px\";\n\t\t\tif (pos.dx === 1){\n\t\t\t\tqi.style.right = \"auto\";\n\t\t\t\tqi.style.left = \"-300px\";\n\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tqi.style.left = \"10px\";\n\t\t\t\t},1);\n\t\t\t} else {\n\t\t\t\tqi.style.left = \"auto\";\n\t\t\t\tqi.style.right = \"-300px\";\n\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tqi.style.right = \"10px\";\n\t\t\t\t},1);\n\t\t\t}\n\t\t\tqi.className += \" gantt_qi_\"+(pos.dx === 1 ? \"left\" : \"right\");\n\t\t\tgantt.$root.appendChild(qi);\n\t\t}\n\t}\n\n\tprivate _qi_button_click(node: any) : void {\n\t\tconst gantt = this._gantt;\n\t\tconst box = this._quickInfoBox;\n\t\tif (!node || node === box){\n\t\t\treturn;\n\t\t}\n\t\tif(node.closest(\".gantt_cal_qi_close_btn\")){\n\t\t\tthis.hide();\n\t\t\treturn;\n\t\t}\n\n\t\tconst mask = node.className;\n\t\tif (mask.indexOf(\"_icon\") !== -1){\n\t\t\tconst id = this._quickInfoBoxId;\n\t\t\tgantt.$click.buttons[mask.split(\" \")[1].replace(\"icon_\",\"\")](id);\n\t\t} else {\n\t\t\tthis._qi_button_click(node.parentNode);\n\t\t}\n\t}\n\n\tprivate _getContainer(): IQuickInfoContainer{\n\t\tconst gantt = this._gantt;\n\t\tlet container = this._container ? this._container : gantt.$task_data;\n\t\tif (container && container.offsetHeight && container.offsetWidth) {\n\t\t\treturn {\n\t\t\t\tparent: container,\n\t\t\t\txViewport: gantt.$task,\n\t\t\t\tyViewport: gantt.$task_data\n\t\t\t};\n\t\t}\n\t\tcontainer = this._container ? this._container : gantt.$grid_data;\n\t\tif (container && container.offsetHeight && container.offsetWidth) {\n\t\t\treturn {\n\t\t\t\tparent: container,\n\t\t\t\txViewport: gantt.$grid,\n\t\t\t\tyViewport: gantt.$grid_data\n\t\t\t};\n\t\t}\n\n\t\treturn {\n\t\t\tparent: this._container ? this._container : gantt.$layout,\n\t\t\txViewport: gantt.$layout,\n\t\t\tyViewport: gantt.$layout\n\t\t};\n\t}\n}\n","import * as utils from \"../../../utils/utils\";\n\nfunction createScope(addEvent, removeEvent) {\n\taddEvent = addEvent || utils.event;\n\tremoveEvent = removeEvent || utils.eventRemove;\n\n\tvar handlers = [];\n\n\tvar eventScope = {\n\t\tattach: function(el, event, callback, capture){\n\t\t\thandlers.push({element: el, event:event, callback: callback, capture: capture});\n\t\t\taddEvent(el, event, callback, capture);\n\t\t},\n\t\tdetach: function(el, event, callback, capture){\n\t\t\tremoveEvent(el, event, callback, capture);\n\t\t\tfor(var i = 0; i < handlers.length; i++){\n\t\t\t\tvar handler = handlers[i];\n\t\t\t\tif (handler.element === el && handler.event === event && handler.callback === callback && handler.capture === capture) {\n\t\t\t\t\thandlers.splice(i, 1);\n\t\t\t\t\ti--;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tdetachAll: function () {\n\t\t\tvar staticArray = handlers.slice();\n\t\t\t// original handlers array can be spliced on every iteration\n\t\t\tfor (var i = 0; i < staticArray.length; i++){\n\t\t\t\tvar handler = staticArray[i];\n\t\t\t\teventScope.detach(handler.element, handler.event, handler.callback, handler.capture);\n\t\t\t\teventScope.detach(handler.element, handler.event, handler.callback, undefined);\n\t\t\t\teventScope.detach(handler.element, handler.event, handler.callback, false);\n\t\t\t\teventScope.detach(handler.element, handler.event, handler.callback, true);\n\t\t\t}\n\t\t\thandlers.splice(0, handlers.length);\n\t\t},\n\t\textend: function(){\n\t\t\treturn createScope(this.event, this.eventRemove);\n\t\t}\n\t};\n\n\treturn eventScope;\n}\n\nexport default createScope;","import * as domHelpers from \"../../core/ui/utils/dom_helpers\";\n\n/* eslint-disable no-restricted-globals */\n\ninterface IViewPosition{\n\ttop: number;\n\tleft: number;\n}\n\ninterface IViewBox extends IViewPosition{\n\twidth: number;\n\theight: number;\n\tbottom: number;\n\tright: number;\n}\n\nexport class Tooltip {\n\tprivate _root: HTMLElement;\n\tprivate _tooltipNode: HTMLElement;\n\tprivate _gantt: any;\n\n\tconstructor(gantt: any){\n\t\tthis._gantt = gantt;\n\t}\n\n\tgetNode() : HTMLElement {\n\t\tconst gantt = this._gantt;\n\t\tif (!this._tooltipNode){\n\t\t\tthis._tooltipNode = document.createElement(\"div\");\n\t\t\tthis._tooltipNode.className = \"gantt_tooltip\";\n\t\t\tgantt._waiAria.tooltipAttr(this._tooltipNode);\n\t\t}\n\t\treturn this._tooltipNode;\n\t}\n\n\tsetViewport(node: HTMLElement):Tooltip{\n\t\tthis._root = node;\n\t\treturn this;\n\t}\n\n\tshow(left: number, top: number): Tooltip;\n\tshow(event: MouseEvent): Tooltip;\n\tshow(left: number | MouseEvent, top?: number): Tooltip {\n\t\tconst gantt = this._gantt;\n\t\tconst container = document.body;\n\t\tconst node = this.getNode();\n\n\t\tif(!domHelpers.isChildOf(node, container)){\n\t\t\tthis.hide();\n\t\t\t// GS-2463. Don't put the node beyond the body coordinates\n\t\t\t// as it may trigger the resize event\n\t\t\tnode.style.top = node.style.top || \"0px\";\n\t\t\tnode.style.left = node.style.left || \"0px\";\n\t\t\tcontainer.appendChild(node);\n\t\t}\n\n\t\tif (this._isLikeMouseEvent(left)) {\n\t\t\tconst position = this._calculateTooltipPosition(left as MouseEvent);\n\t\t\ttop = position.top;\n\t\t\tleft = position.left;\n\t\t}\n\n\t\tnode.style.top = top + \"px\";\n\t\tnode.style.left = left + \"px\";\n\n\t\tgantt._waiAria.tooltipVisibleAttr(node);\n\t\treturn this;\n\t}\n\thide() : Tooltip{\n\t\tconst gantt = this._gantt;\n\t\tconst node = this.getNode();\n\t\tif(node && node.parentNode){\n\t\t\tnode.parentNode.removeChild(node);\n\t\t}\n\t\tgantt._waiAria.tooltipHiddenAttr(node);\n\t\treturn this;\n\t}\n\n\tsetContent(html: string) : Tooltip{\n\t\tconst node = this.getNode();\n\t\tnode.innerHTML = html;\n\t\treturn this;\n\t}\n\n\t// it is for salesforce, because it proxies event to it own events\n\tprivate _isLikeMouseEvent(event: any): boolean {\n\t\tif (!event || typeof event !== \"object\") {\n\t\t\treturn false;\n\t\t}\n\t\treturn \"clientX\" in event && \"clientY\" in event;\n\t}\n\n\tprivate _getViewPort() : HTMLElement {\n\t\treturn this._root || document.body;\n\t}\n\n\n\tprivate _calculateTooltipPosition(event: MouseEvent): IViewPosition{\n\t\tconst gantt = this._gantt;\n\t\t// top/left coordinates inside the viewport by mouse position\n\t\tconst viewport =  this._getViewPortSize();\n\t\tconst tooltipNode = this.getNode();\n\t\tconst tooltip: IViewBox = {\n\t\t\ttop:0,\n\t\t\tleft: 0,\n\t\t\twidth: tooltipNode.offsetWidth,\n\t\t\theight: tooltipNode.offsetHeight,\n\t\t\tbottom: 0,\n\t\t\tright: 0\n\t\t};\n\n\t\tconst offsetX = gantt.config.tooltip_offset_x;\n\t\tconst offsetY = gantt.config.tooltip_offset_y;\n\n\t\tconst container = document.body;\n\t\tconst mouse = domHelpers.getRelativeEventPosition(event, container);\n\t\tconst containerPos = domHelpers.getNodePosition(container);\n\t\tmouse.y += containerPos.y; // to fix margin collapsing\n\n\t\ttooltip.top = mouse.y;\n\t\ttooltip.left = mouse.x;\n\t\ttooltip.top += offsetY;\n\t\ttooltip.left += offsetX;\n\t\ttooltip.bottom = tooltip.top + tooltip.height;\n\t\ttooltip.right = tooltip.left + tooltip.width;\n\n\t\tconst scrollTop = window.scrollY + container.scrollTop; // to fix margin collapsing\n\t\t// edge cases when the tooltip element can be partially hidden by edges of the viewport\n\t\tif(tooltip.top < viewport.top - scrollTop){\n\t\t\ttooltip.top = viewport.top;\n\t\t\ttooltip.bottom = tooltip.top + tooltip.height;\n\t\t}else if(tooltip.bottom > viewport.bottom){\n\t\t\ttooltip.bottom = viewport.bottom;\n\t\t\ttooltip.top = tooltip.bottom - tooltip.height;\n\t\t}\n\n\t\tif(tooltip.left < viewport.left){\n\t\t\ttooltip.left = viewport.left;\n\t\t\ttooltip.right = viewport.left + tooltip.width;\n\t\t}else if(tooltip.right > viewport.right){\n\t\t\ttooltip.right = viewport.right;\n\t\t\ttooltip.left = tooltip.right - tooltip.width;\n\t\t}\n\n\t\tif(mouse.x >= tooltip.left && mouse.x <= tooltip.right) {\n\t\t\ttooltip.left = mouse.x - tooltip.width - offsetX;\n\t\t\ttooltip.right = tooltip.left + tooltip.width;\n\t\t}\n\n\t\tif(mouse.y >= tooltip.top && mouse.y <= tooltip.bottom) {\n\t\t\ttooltip.top = mouse.y - tooltip.height - offsetY;\n\t\t\ttooltip.bottom = tooltip.top + tooltip.height;\n\t\t}\n\n\t\t// GS-2827: when tooltip width too long\n\t\tif(tooltip.left < 0){\n\t\t\ttooltip.left = 0;\n\t\t}\n\t\tif(tooltip.right < 0){\n\t\t\ttooltip.right = 0;\n\t\t}\n\n\t\treturn tooltip;\n\t}\n\n\tprivate _getViewPortSize() : IViewBox {\n\t\tconst gantt = this._gantt;\n\t\tconst container = this._getViewPort();\n\t\tlet viewport = container;\n\t\tlet scrollTop = window.scrollY + document.body.scrollTop;\n\t\tlet scrollLeft = window.scrollX + document.body.scrollLeft;\n\t\tlet pos;\n\t\t// support for the initial tooltip mode where the tooltip element was attached to the data area of gantt\n\t\tif(container === gantt.$task_data){\n\t\t\tviewport = gantt.$task;\n\t\t\tscrollTop = 0;\n\t\t\tscrollLeft = 0;\n\t\t\tpos = domHelpers.getNodePosition(gantt.$task);\n\t\t}else{\n\t\t\tpos = domHelpers.getNodePosition(viewport);\n\t\t}\n\t\treturn {\n\t\t\tleft:pos.x + scrollLeft,\n\t\t\ttop: pos.y + scrollTop,\n\t\t\twidth: pos.width,\n\t\t\theight: pos.height,\n\t\t\tbottom: pos.y + pos.height + scrollTop,\n\t\t\tright: pos.x + pos.width + scrollLeft\n\t\t};\n\t}\n}\n","import domEventsScope from \"../../core/ui/utils/dom_event_scope\";\nimport * as domHelpers from \"../../core/ui/utils/dom_helpers\";\nimport * as helpers from \"../../utils/helpers\";\nimport { Tooltip } from \"./tooltip\";\n\ninterface ITrackerTarget {\n\tselector: string;\n\tonmouseenter: (event: MouseEvent, node: HTMLElement) => void;\n\tonmousemove: (event: MouseEvent, node: HTMLElement) => void;\n\tonmouseleave: (event: MouseEvent, node: HTMLElement) => void;\n\tglobal: boolean;\n}\n\ninterface ITooltipConfig {\n\tselector: string;\n\thtml: (event: MouseEvent, node: HTMLElement) => string;\n\tglobal: boolean;\n}\n\nexport class TooltipManager{\n\ttooltip: Tooltip;\n\tprotected _domEvents: any;\n\tprivate _listeners: object = {};\n\tprivate _gantt: any;\n\tprivate delayShow: any;\n\tprivate delayHide: any;\n\n\tconstructor(gantt: any) {\n\t\tthis.tooltip = new Tooltip(gantt);\n\t\tthis._gantt = gantt;\n\t\tthis._domEvents = domEventsScope();\n\t\tthis._initDelayedFunctions();\n\t}\n\n\tdestructor(): void{\n\t\tthis.tooltip.hide();\n\t\tthis._domEvents.detachAll();\n\t}\n\thideTooltip(): void{\n\t\tthis.delayHide();\n\t}\n\tattach(config: ITrackerTarget): void {\n\t\tlet root = document.body;\n\t\tconst gantt = this._gantt;\n\t\tif(!config.global){\n\t\t\troot = gantt.$root;\n\t\t}\n\n\t\tlet watchableTarget = null;\n\t\tconst handler = (event) => {\n\t\t\tconst eventTarget = domHelpers.getTargetNode(event);\n\t\t\tconst targetNode = domHelpers.closest(eventTarget, config.selector);\n\t\t\tif(domHelpers.isChildOf(eventTarget, this.tooltip.getNode())){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst doOnMouseEnter = () => {\n\t\t\t\twatchableTarget = targetNode;\n\t\t\t\tconfig.onmouseenter(event, targetNode);\n\t\t\t};\n\n\t\t\tif(watchableTarget){\n\t\t\t\tif(targetNode && targetNode === watchableTarget){\n\t\t\t\t\tconfig.onmousemove(event, targetNode);\n\t\t\t\t}else{\n\t\t\t\t\tconfig.onmouseleave(event, watchableTarget);\n\t\t\t\t\twatchableTarget = null;\n\n\t\t\t\t\tif(targetNode && targetNode !== watchableTarget){\n\t\t\t\t\t\tdoOnMouseEnter();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tif(targetNode){\n\t\t\t\t\tdoOnMouseEnter();\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tthis.detach(config.selector);\n\t\tthis._domEvents.attach(root, \"mousemove\", handler);\n\t\tthis._listeners[config.selector] = {\n\t\t\tnode: root,\n\t\t\thandler\n\t\t};\n\t}\n\n\tdetach(selector: string): void {\n\t\tconst listener = this._listeners[selector];\n\t\tif(listener){\n\t\t\tthis._domEvents.detach(listener.node, \"mousemove\", listener.handler);\n\t\t}\n\t}\n\n\ttooltipFor(config: ITooltipConfig): void {\n\t\tconst cloneDomEvent = (event: MouseEvent) => {\n\t\t\tlet clone = event;\n\t\t\t// making events survive timeout in ie\n\t\t\t// tslint:disable-next-line no-string-literal\n\t\t\tif(document[\"createEventObject\"] && !document.createEvent){\n\t\t\t\t// tslint:disable-next-line no-string-literal\n\t\t\t\tclone = document[\"createEventObject\"](event);\n\t\t\t}\n\t\t\treturn clone;\n\t\t};\n\t\tthis._initDelayedFunctions();\n\t\tthis.attach({\n\t\t\tselector: config.selector,\n\t\t\tglobal: config.global,\n\t\t\tonmouseenter:(event: MouseEvent, node: HTMLElement) => {\n\t\t\t\tconst html = config.html(event, node);\n\t\t\t\tif(html){\n\t\t\t\t\tthis.delayShow(cloneDomEvent(event), html);\n\t\t\t\t}\n\t\t\t},\n\t\t\tonmousemove:(event: MouseEvent, node: HTMLElement) => {\n\t\t\t\tconst html = config.html(event, node);\n\t\t\t\tif(html){\n\t\t\t\t\tthis.delayShow(cloneDomEvent(event), html);\n\t\t\t\t}else{\n\t\t\t\t\tthis.delayShow.$cancelTimeout();\n\t\t\t\t\tthis.delayHide();\n\t\t\t\t}\n\t\t\t},\n\t\t\tonmouseleave:() => {\n\t\t\t\tthis.delayShow.$cancelTimeout();\n\t\t\t\tthis.delayHide();\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate _initDelayedFunctions(){\n\t\tconst gantt = this._gantt;\n\t\t// reset delayed functions in order to apply current values of tooltip_timeout\n\t\tif(this.delayShow){\n\t\t\tthis.delayShow.$cancelTimeout();\n\t\t}\n\t\tif(this.delayHide){\n\t\t\tthis.delayHide.$cancelTimeout();\n\t\t}\n\t\tthis.tooltip.hide();\n\n\t\tthis.delayShow = helpers.delay((event: MouseEvent, html: string) => {\n\t\t\tif(gantt.callEvent(\"onBeforeTooltip\", [event]) === false) {\n\t\t\t\tthis.tooltip.hide();\n\t\t\t} else {\n\t\t\t\tthis.tooltip.setContent(html);\n\t\t\t\tthis.tooltip.show(event);\n\t\t\t}\n\t\t}, gantt.config.tooltip_timeout || 1);\n\n\t\tthis.delayHide = helpers.delay(() => {\n\t\t\tthis.delayShow.$cancelTimeout();\n\t\t\tthis.tooltip.hide();\n\t\t}, gantt.config.tooltip_hide_timeout || 1);\n\t}\n\n}","import { IInlineEditState, IMonitor, IUndo, IUndoCommand, TActionType, TEntityType, TUndoValue } from \"./types\";\n\nconst noTrack = {\n\tonBeforeUndo: \"onAfterUndo\",\n\tonBeforeRedo: \"onAfterRedo\"\n};\n\nconst batchActions = [\n\t\"onTaskDragStart\",\n\t\"onAfterTaskUpdate\",\n\t\"onAfterParentExpand\",\n\t\"onAfterTaskDelete\",\n\t\"onBeforeBatchUpdate\"\n];\n\nexport class Monitor implements IMonitor {\n\tprivate _batchAction = null;\n\tprivate _batchMode = false;\n\tprivate _ignore = false;\n\tprivate _ignoreMoveEvents = false;\n\tprivate _initialTasks = {};\n\tprivate _initialLinks = {};\n\tprivate _nestedTasks =  {};\n\tprivate _nestedLinks = {};\n\tprivate _timeout;\n\tprivate _gantt: any;\n\tprivate _undo: IUndo;\n\n\tconstructor(undo: IUndo, gantt: any) {\n\t\tthis._undo = undo;\n\t\tthis._gantt = gantt;\n\t\tthis._attachEvents();\n\t}\n\n\tstore(id: TaskID | LinkID, type: TEntityType, overwrite: boolean = false) {\n\t\tif (type === this._gantt.config.undo_types.task) {\n\t\t\treturn this._storeTask(id, overwrite);\n\t\t}\n\t\tif (type === this._gantt.config.undo_types.link) {\n\t\t\treturn this._storeLink(id, overwrite);\n\t\t}\n\t\treturn false;\n\t}\n\tisMoveEventsIgnored() {\n\t\treturn this._ignoreMoveEvents;\n\t}\n\ttoggleIgnoreMoveEvents(newValue?: boolean) {\n\t\tthis._ignoreMoveEvents = newValue || false;\n\t}\n\tstartIgnore() {\n\t\tthis._ignore = true;\n\t}\n\tstopIgnore() {\n\t\tthis._ignore = false;\n\t}\n\tstartBatchAction() {\n\t\t// try catching updates made from event handlers using timeout\n\t\tif (!this._timeout){\n\t\t\tthis._timeout = setTimeout(() => {\n\t\t\t\tthis.stopBatchAction();\n\t\t\t\tthis._timeout = null;\n\t\t\t}, 10);\n\t\t}\n\n\n\t\tif (this._ignore || this._batchMode) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._batchMode = true;\n\t\tthis._batchAction = this._undo.action.create();\n\t}\n\tstopBatchAction() {\n\t\tif (this._ignore) {\n\t\t\treturn;\n\t\t}\n\t\tconst undo = this._undo;\n\t\tif (this._batchAction) {\n\t\t\tundo.logAction(this._batchAction);\n\t\t}\n\t\tthis._batchMode = false;\n\t\tthis._batchAction = null;\n\t}\n\tonTaskAdded(task: ITask) {\n\t\tif (!this._ignore) {\n\t\t\tthis._storeTaskCommand(task, this._undo.command.type.add);\n\t\t}\n\t}\n\tonTaskUpdated(task: ITask) {\n\t\tif (!this._ignore) {\n\t\t\tthis._storeTaskCommand(task, this._undo.command.type.update);\n\t\t}\n\t}\n\tonTaskMoved(task: ITask) {\n\t\tif (!this._ignore) {\n\t\t\t(task as any).$local_index = this._gantt.getTaskIndex(task.id);\n\t\t\tthis._storeEntityCommand(\n\t\t\t\ttask,\n\t\t\t\tthis.getInitialTask(task.id),\n\t\t\t\tthis._undo.command.type.move,\n\t\t\t\tthis._undo.command.entity.task\n\t\t\t);\n\t\t}\n\t}\n\tonTaskDeleted(task: ITask) {\n\t\tif (!this._ignore) {\n\t\t\tthis._storeTaskCommand(task, this._undo.command.type.remove);\n\t\t\tif (this._nestedTasks[task.id]) {\n\t\t\t\tconst children = this._nestedTasks[task.id];\n\t\t\t\tfor (let i = 0; i < children.length; i++) {\n\t\t\t\t\tthis._storeTaskCommand(children[i], this._undo.command.type.remove);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this._nestedLinks[task.id]) {\n\t\t\t\tconst childrenLinks = this._nestedLinks[task.id];\n\t\t\t\tfor (let i = 0; i < childrenLinks.length; i++) {\n\t\t\t\t\tthis._storeLinkCommand(childrenLinks[i], this._undo.command.type.remove);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tonLinkAdded(link: ILink) {\n\t\tif (!this._ignore) {\n\t\t\tthis._storeLinkCommand(link, this._undo.command.type.add);\n\t\t}\n\t}\n\tonLinkUpdated(link: ILink) {\n\t\tif (!this._ignore) {\n\t\t\tthis._storeLinkCommand(link, this._undo.command.type.update);\n\t\t}\n\t}\n\tonLinkDeleted(link: ILink) {\n\t\tif (!this._ignore) {\n\t\t\tthis._storeLinkCommand(link, this._undo.command.type.remove);\n\t\t}\n\t}\n\tsetNestedTasks(id: TaskID, taskIds: TaskID[]) {\n\t\tconst gantt = this._gantt;\n\t\tlet task = null;\n\t\tconst tasks = [];\n\t\tlet\tlinkIds = this._getLinks(gantt.getTask(id));\n\n\t\tfor (let i = 0; i < taskIds.length; i++) {\n\t\t\ttask = this.setInitialTask(taskIds[i]);\n\t\t\tlinkIds = linkIds.concat(this._getLinks(task));\n\t\t\ttasks.push(task);\n\t\t}\n\n\t\tconst uniqueLinks = {};\n\t\tfor (let i = 0; i < linkIds.length; i++) {\n\t\t\tuniqueLinks[linkIds[i]] = true;\n\t\t}\n\t\tconst links = [];\n\t\tfor (const i in uniqueLinks) {\n\t\t\tlinks.push(this.setInitialLink(i));\n\t\t}\n\t\tthis._nestedTasks[id] = tasks;\n\t\tthis._nestedLinks[id] = links;\n\t}\n\tsetInitialTask(id: TaskID, overwrite?: boolean) {\n\t\tconst gantt = this._gantt;\n\t\tif (overwrite || (!this._initialTasks[id] || !this._batchMode)) {\n\t\t\tconst task = gantt.copy(gantt.getTask(id));\n\t\t\ttask.$index = gantt.getGlobalTaskIndex(id);\n\t\t\ttask.$local_index = gantt.getTaskIndex(id);\n\t\t\tthis.setInitialTaskObject(id, task);\n\t\t}\n\t\treturn this._initialTasks[id];\n\t}\n\tgetInitialTask(id: TaskID) {\n\t\treturn this._initialTasks[id];\n\t}\n\tclearInitialTasks() {\n\t\tthis._initialTasks = {};\n\t}\n\tsetInitialTaskObject(id: TaskID, object: ITask) {\n\t\tthis._initialTasks[id] = object;\n\t}\n\tsetInitialLink(id: LinkID, overwrite?: boolean) {\n\t\tif (!this._initialLinks[id] || !this._batchMode) {\n\t\t\tthis._initialLinks[id] = this._gantt.copy(this._gantt.getLink(id));\n\t\t}\n\t\treturn this._initialLinks[id];\n\t}\n\tgetInitialLink(id: LinkID) {\n\t\treturn this._initialLinks[id];\n\t}\n\tclearInitialLinks() {\n\t\tthis._initialLinks = {};\n\t}\n\tprivate _attachEvents() {\n\t\tlet deleteCacheCooldown = null;\n\t\tconst gantt = this._gantt;\n\n\t\tconst saveInitialAll = () => {\n\t\t\tif (!deleteCacheCooldown) {\n\t\t\t\tdeleteCacheCooldown = setTimeout(() => {\n\t\t\t\t\tdeleteCacheCooldown = null;\n\t\t\t\t});\n\n\t\t\t\tthis.clearInitialTasks();\n\t\t\t\tgantt.eachTask((task: ITask) => {\n\t\t\t\t\tthis.setInitialTask(task.id);\n\t\t\t\t});\n\n\t\t\t\tthis.clearInitialLinks();\n\t\t\t\tgantt.getLinks().forEach((link: ILink) => {\n\t\t\t\t\tthis.setInitialLink(link.id);\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t\tconst getMoveObjectByTaskId = (id: TaskID) => {\n\t\t\treturn gantt.copy(gantt.getTask(id));\n\t\t};\n\n\t\tfor (const i in noTrack) {\n\t\t\tgantt.attachEvent(i, () => {\n\t\t\t\tthis.startIgnore();\n\t\t\t\treturn true;\n\t\t\t});\n\t\t\tgantt.attachEvent(noTrack[i], () => {\n\t\t\t\tthis.stopIgnore();\n\t\t\t\treturn true;\n\t\t\t});\n\t\t}\n\n\t\tfor (let i  = 0; i < batchActions.length; i++) {\n\t\t\tgantt.attachEvent(batchActions[i], () => {\n\t\t\t\tthis.startBatchAction();\n\t\t\t\treturn true;\n\t\t\t});\n\t\t}\n\n\t\tgantt.attachEvent(\"onParse\", () => {\n\t\t\tthis._undo.clearUndoStack();\n\t\t\tthis._undo.clearRedoStack();\n\t\t\tsaveInitialAll();\n\t\t});\n\t\tgantt.attachEvent(\"onAfterTaskAdd\", (id: TaskID, task: ITask) => {\n\t\t\tthis.setInitialTask(id, true);\n\t\t\tthis.onTaskAdded(task);\n\t\t});\n\t\tgantt.attachEvent(\"onAfterTaskUpdate\", (id: TaskID, task: ITask) => {\n\t\t\tthis.onTaskUpdated(task);\n\t\t});\n\t\tgantt.attachEvent(\"onAfterParentExpand\", (id: TaskID, task: ITask) => {\n\t\t\tthis.onTaskUpdated(task);\n\t\t});\n\t\tgantt.attachEvent(\"onAfterTaskDelete\", (id: TaskID, task: ITask) => {\n\t\t\tthis.onTaskDeleted(task);\n\t\t});\n\t\tgantt.attachEvent(\"onAfterLinkAdd\", (id: LinkID, link: ILink) => {\n\t\t\tthis.setInitialLink(id, true);\n\t\t\tthis.onLinkAdded(link);\n\t\t});\n\t\tgantt.attachEvent(\"onAfterLinkUpdate\", (id: LinkID, link: ILink) => {\n\t\t\tthis.onLinkUpdated(link);\n\t\t});\n\t\tgantt.attachEvent(\"onAfterLinkDelete\", (id: LinkID, link: ILink) => {\n\t\t\tthis.onLinkDeleted(link);\n\t\t});\n\t\tgantt.attachEvent(\"onRowDragEnd\", (id: TaskID, target: TaskID) => {\n\t\t\tthis.onTaskMoved(getMoveObjectByTaskId(id));\n\t\t\tthis.toggleIgnoreMoveEvents();\n\t\t\treturn true;\n\t\t});\n\t\tgantt.attachEvent(\"onBeforeTaskDelete\", (id: TaskID) => {\n\t\t\tthis.store(id, gantt.config.undo_types.task);\n\t\t\tconst nested = [];\n\n\t\t\t// remember task indexes in case their being deleted in a loop, so they could be restored in the correct order\n\t\t\tsaveInitialAll();\n\n\t\t\tgantt.eachTask((task: ITask) => {\n\t\t\t\tnested.push(task.id);\n\t\t\t}, id);\n\t\t\tthis.setNestedTasks(id, nested);\n\t\t\treturn true;\n\t\t});\n\t\tconst datastore = gantt.getDatastore(\"task\");\n\n\t\tdatastore.attachEvent(\"onBeforeItemMove\", (id: TaskID, parent: TaskID, tindex: number) => {\n\t\t\tif (!this.isMoveEventsIgnored()) {\n\t\t\t\tsaveInitialAll();\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\n\t\tdatastore.attachEvent(\"onAfterItemMove\", (id: TaskID, parent: TaskID, tindex: number) => {\n\t\t\tif (!this.isMoveEventsIgnored()) {\n\t\t\t\tthis.onTaskMoved(getMoveObjectByTaskId(id));\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\n\t\tgantt.attachEvent(\"onRowDragStart\", (id: TaskID, target: TaskID, e: Event) => {\n\t\t\tthis.toggleIgnoreMoveEvents(true);\n\t\t\tsaveInitialAll();\n\t\t\treturn true;\n\t\t});\n\n\t\tlet dragId = null;\n\t\tlet projectDrag = false;\n\t\tgantt.attachEvent(\"onBeforeTaskDrag\", (taskId: TaskID) => {\n\t\t\tdragId = gantt.getState().drag_id;\n\t\t\tif (dragId === taskId){\n\t\t\t\tconst task = gantt.getTask(taskId);\n\t\t\t\tif (gantt.isSummaryTask(task) && gantt.config.drag_project){\n\t\t\t\t\tprojectDrag = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\t// GS-99. Store the initial task dates before multiple drag\n\t\t\tif (gantt.plugins().multiselect){\n\t\t\t\tconst selectedIds = gantt.getSelectedTasks();\n\t\t\t\tif (selectedIds.length > 1){\n\t\t\t\t\tselectedIds.forEach((id)=>{\n\t\t\t\t\t\tthis.store(id, gantt.config.undo_types.task, true);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn this.store(taskId, gantt.config.undo_types.task);\n\t\t});\n\n\t\tgantt.attachEvent(\"onAfterTaskDrag\", (taskId: TaskID) => {\n\t\t\t// if we drag multiple tasks and other tasks move to another date after that,\n\t\t\t// auto-scheduling/correct work time should occur in anoher command.\n\t\t\t// otherwise, when we undo the changes, the task constraint is not restored correctly\n\t\t\tconst multipleDrag = projectDrag || (gantt.plugins().multiselect && gantt.getSelectedTasks().length > 1);\n\t\t\tif (multipleDrag && dragId === taskId){\n\t\t\t\tprojectDrag = false;\n\t\t\t\tdragId = null;\n\t\t\t\tthis.stopBatchAction();\n\t\t\t}\n\t\t\t// GS-99. When dragging multiple tasks, we need to store the initial tasks\n\t\t\tthis.store(taskId, gantt.config.undo_types.task, true);\n\t\t});\n\n\t\tgantt.attachEvent(\"onLightbox\", (taskId: TaskID) => this.store(taskId, gantt.config.undo_types.task));\n\n\t\tgantt.attachEvent(\"onBeforeTaskAutoSchedule\", (task: ITask) => {\n\t\t\tthis.store(task.id, gantt.config.undo_types.task, true);\n\t\t\treturn true;\n\t\t});\n\n\t\tif (gantt.ext.inlineEditors) {\n\t\t\t// remove the onGanttLayoutReady wrapper when GS-1288 is merged\n\t\t\tlet onBeforeEditStartId = null;\n\t\t\tlet onEditStart = null;\n\t\t\tgantt.attachEvent(\"onGanttLayoutReady\", () => {\n\t\t\t\tif (onBeforeEditStartId) {\n\t\t\t\t\tgantt.ext.inlineEditors.detachEvent(onBeforeEditStartId);\n\t\t\t\t}\n\t\t\t\tif (onEditStart) {\n\t\t\t\t\tgantt.ext.inlineEditors.detachEvent(onEditStart);\n\t\t\t\t}\n\n\t\t\t\tonEditStart = gantt.ext.inlineEditors.attachEvent(\"onEditStart\", (state: IInlineEditState) => {\n\t\t\t\t\t// GS-2598: skip saving changes of resource lightbox grid\n\t\t\t\t\tif(gantt.$data.tempAssignmentsStore && gantt._lightbox_id){\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tthis.store(state.id, gantt.config.undo_types.task);\n\t\t\t\t});\n\n\t\t\t\t// GS-99. If another inline editor is opened and we open a new inline editor,\n\t\t\t\t// we shouldn't use the batchAction\n\t\t\t\tonBeforeEditStartId = gantt.ext.inlineEditors.attachEvent(\"onBeforeEditStart\", (state: IInlineEditState) => {\n\t\t\t\t\tthis.stopBatchAction();\n\t\t\t\t\treturn true;\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t}\n\n\tprivate _storeCommand(command: IUndoCommand) {\n\t\tconst undo = this._undo;\n\t\tundo.updateConfigs();\n\n\t\tif (!undo.undoEnabled) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._batchMode) {\n\t\t\tthis._batchAction.commands.push(command);\n\t\t} else {\n\t\t\tconst action = undo.action.create([command]);\n\t\t\tundo.logAction(action);\n\t\t}\n\t}\n\tprivate _storeEntityCommand(obj: TUndoValue, old: TUndoValue, actionType: TActionType, entityType: TEntityType) {\n\t\tconst undo = this._undo;\n\t\tconst command = undo.command.create(obj, old, actionType, entityType);\n\t\tthis._storeCommand(command);\n\t}\n\tprivate _storeTaskCommand(obj: ITask, type: TActionType) {\n\t\tif(this._gantt.isTaskExists(obj.id)){\n\t\t\t(obj as any).$local_index = this._gantt.getTaskIndex(obj.id);\n\t\t}\n\n\t\tthis._storeEntityCommand(obj, this.getInitialTask(obj.id), type, this._undo.command.entity.task);\n\t}\n\tprivate _storeLinkCommand(obj: ILink, type: TActionType) {\n\t\tthis._storeEntityCommand(obj, this.getInitialLink(obj.id), type, this._undo.command.entity.link);\n\t}\n\tprivate _getLinks(task: ITask) {\n\t\treturn task.$source.concat(task.$target);\n\t}\n\tprivate _storeTask(taskId: TaskID, overwrite: boolean = false) {\n\t\tconst gantt = this._gantt;\n\t\tthis.setInitialTask(taskId, overwrite);\n\t\tgantt.eachTask((child: ITask) => {\n\t\t\tthis.setInitialTask(child.id);\n\t\t}, taskId);\n\t\treturn true;\n\t}\n\tprivate _storeLink(linkId: LinkID, overwrite: boolean = false) {\n\t\tthis.setInitialLink(linkId, overwrite);\n\t\treturn true;\n\t}\n}","import { IUndo, IUndoCommand, IUndoCommands, IUndoPropAction, IUndoPropCommand, TActionType, TEntityType, TUndoStack, TUndoValue } from \"./types\";\n\nconst MAX_UNDO_STEPS = 100;\n\nexport class Undo implements IUndo {\n\n\tmaxSteps = MAX_UNDO_STEPS;\n\tundoEnabled = true;\n\tredoEnabled = true;\n\taction: IUndoPropAction = {\n\t\tcreate: (commands?: IUndoCommand[]): IUndoCommands => {\n\t\t\treturn { commands: (commands ? commands.slice() : []) };\n\t\t},\n\t\tinvert: (action: IUndoCommands): IUndoCommands => {\n\t\t\tconst gantt = this._gantt;\n\t\t\tconst revert = gantt.copy(action);\n\t\t\tconst commands = this.command;\n\t\t\tfor (let i = 0; i < action.commands.length; i++) {\n\t\t\t\tconst command = revert.commands[i] = commands.invert(revert.commands[i]);\n\t\t\t\tif (command.type === commands.type.update || command.type === commands.type.move) {\n\t\t\t\t\t[command.value, command.oldValue] = [command.oldValue, command.value];\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn revert as IUndoCommands;\n\t\t}\n\t};\n\tcommand: IUndoPropCommand = {\n\t\t// entities that require different processing for undoing-redoing changes (gantt.config.undo_types)\n\t\tentity: null,\n\n\t\t// types of traced actions (gantt.config.undo_actions)\n\t\ttype: null,\n\n\t\tcreate: (value: TUndoValue, oldValue: TUndoValue, type: TActionType, entity: TEntityType): IUndoCommand => {\n\t\t\tconst gantt = this._gantt;\n\t\t\treturn {\n\t\t\t\tentity,\n\t\t\t\ttype,\n\t\t\t\tvalue: gantt.copy(value),\n\t\t\t\toldValue: gantt.copy(oldValue || value)\n\t\t\t};\n\t\t},\n\t\tinvert: (command: IUndoCommand): IUndoCommand => {\n\t\t\tconst gantt = this._gantt;\n\t\t\tconst revert = gantt.copy(command);\n\t\t\trevert.type = this.command.inverseCommands(command.type);\n\t\t\treturn revert;\n\t\t},\n\t\tinverseCommands: (command: TActionType): TActionType => {\n\t\t\tconst gantt = this._gantt;\n\t\t\tconst types = this.command.type;\n\t\t\tswitch (command) {\n\t\t\t\tcase types.update:\n\t\t\t\t\treturn types.update;\n\t\t\t\tcase types.remove:\n\t\t\t\t\treturn types.add;\n\t\t\t\tcase types.add:\n\t\t\t\t\treturn types.remove;\n\t\t\t\tcase types.move:\n\t\t\t\t\treturn types.move;\n\t\t\t\tdefault:\n\t\t\t\t\tgantt.assert(false, \"Invalid command \"+ command);\n\t\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t};\n\n\tprivate _undoStack = [];\n\tprivate _redoStack = [];\n\tprivate _gantt: any;\n\n\tconstructor(gantt: any){\n\t\tthis._gantt = gantt;\n\t}\n\tgetUndoStack() {\n\t\treturn this._undoStack;\n\t}\n\tsetUndoStack(stack: []) {\n\t\tthis._undoStack = stack;\n\t}\n\n\tgetRedoStack() {\n\t\treturn this._redoStack;\n\t}\n\tsetRedoStack(stack: []) {\n\t\tthis._redoStack = stack;\n\t}\n\n\tclearUndoStack() {\n\t\tthis._undoStack = [];\n\t}\n\n\tclearRedoStack() {\n\t\tthis._redoStack = [];\n\t}\n\n\tupdateConfigs() {\n\t\tconst gantt = this._gantt;\n\t\tthis.maxSteps = gantt.config.undo_steps || MAX_UNDO_STEPS;\n\t\tthis.command.entity = gantt.config.undo_types;\n\t\tthis.command.type = gantt.config.undo_actions;\n\t\tthis.undoEnabled = !!gantt.config.undo;\n\t\tthis.redoEnabled = !!gantt.config.redo; // GS-873, Redo should work even when the `gantt.config.undo` is disabled.\n\t}\n\n\tundo() {\n\t\tconst gantt = this._gantt;\n\t\tthis.updateConfigs();\n\t\tif (!this.undoEnabled) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst action = this._pop(this._undoStack);\n\t\tif (action) {\n\t\t\tthis._reorderCommands(action);\n\t\t}\n\t\tif (gantt.callEvent(\"onBeforeUndo\", [action]) !== false) {\n\t\t\tif (action) {\n\t\t\t\tthis._applyAction(this.action.invert(action));\n\t\t\t\tthis._push(this._redoStack, gantt.copy(action));\n\t\t\t\tgantt.callEvent(\"onAfterUndo\", [action]);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tgantt.callEvent(\"onAfterUndo\", [null]);\n\t}\n\n\tredo() {\n\t\tconst gantt = this._gantt;\n\t\tthis.updateConfigs();\n\t\tif (!this.redoEnabled) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst action = this._pop(this._redoStack);\n\t\tif (action) {\n\t\t\tthis._reorderCommands(action);\n\t\t}\n\n\t\tif (gantt.callEvent(\"onBeforeRedo\", [action]) !== false) {\n\t\t\tif (action) {\n\t\t\t\tthis._applyAction(action);\n\t\t\t\tthis._push(this._undoStack, gantt.copy(action));\n\t\t\t\tgantt.callEvent(\"onAfterRedo\", [action]);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tgantt.callEvent(\"onAfterRedo\", [null]);\n\t}\n\n\t// storeUndo:\n\tlogAction(action: IUndoCommands) {\n\t\tthis._push(this._undoStack, action);\n\t\tthis._redoStack = [];\n\t}\n\n\tprivate _push(stack: TUndoStack, action: IUndoCommands): IUndoCommands {\n\t\tconst gantt = this._gantt;\n\t\tif (!action.commands.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst event = stack === this._undoStack ? \"onBeforeUndoStack\" : \"onBeforeRedoStack\";\n\t\tif (gantt.callEvent(event, [action]) === false){\n\t\t\treturn;\n\t\t}\n\t\t// commands can be removed from event handler\n\t\tif (!action.commands.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tstack.push(action);\n\t\twhile (stack.length > this.maxSteps) {\n\t\t\tstack.shift();\n\t\t}\n\t\treturn action;\n\t}\n\n\tprivate _pop(stack: TUndoStack): IUndoCommands {\n\t\treturn stack.pop();\n\t}\n\n\tprivate _reorderCommands(action) {\n\t\t// firstly process tasks and only then links\n\t\t// in order to ensure links are added not earlier than their tasks\n\t\t// firstly to 'move' actions and only then updates\n\t\tconst weights = { any: 0, link:1, task:2 };\n\t\tconst actionWeights = { move: 1, any:0 };\n\t\taction.commands.sort(function(a, b) {\n\t\t\tif (a.entity === \"task\" && b.entity === \"task\") {\n\t\t\t\tif (a.type !== b.type) {\n\t\t\t\t\treturn (actionWeights[b.type] || 0) - (actionWeights[a.type] || 0);\n\t\t\t\t} else if (a.type === \"move\" && a.oldValue && b.oldValue && b.oldValue.parent === a.oldValue.parent) {\n\t\t\t\t\treturn a.oldValue.$index - b.oldValue.$index;\n\t\t\t\t} else {\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst weightA = weights[a.entity] || weights.any;\n\t\t\t\tconst weightB = weights[b.entity] || weights.any;\n\t\t\t\treturn weightB - weightA;\n\t\t\t}\n\n\t\t});\n\t}\n\n\tprivate _applyAction(action: IUndoCommands) {\n\t\tlet command = null;\n\t\tconst entities = this.command.entity;\n\t\tconst actions = this.command.type;\n\t\tconst gantt = this._gantt;\n\t\tconst methods = {};\n\t\tmethods[entities.task] = {\n\t\t\tadd: \"addTask\",\n\t\t\tget: \"getTask\",\n\t\t\tupdate: \"updateTask\",\n\t\t\tremove: \"deleteTask\",\n\t\t\tmove: \"moveTask\",\n\t\t\tisExists: \"isTaskExists\"\n\t\t};\n\t\tmethods[entities.link] = {\n\t\t\tadd: \"addLink\",\n\t\t\tget: \"getLink\",\n\t\t\tupdate: \"updateLink\",\n\t\t\tremove: \"deleteLink\",\n\t\t\tisExists: \"isLinkExists\"\n\t\t};\n\n\t\tgantt.batchUpdate(function() {\n\t\t\t// it is logical to undo actions from the last one to the first one\n\t\t\t// but we have to do it from the first one because the order\n\t\t\t// of tasks ($index and $local_index) depends on the existing tasks\n\t\t\tfor (let i = 0; i < action.commands.length; i++) {\n\t\t\t\tcommand = action.commands[i];\n\t\t\t\tconst method = methods[command.entity][command.type];\n\t\t\t\tconst getMethod = methods[command.entity].get;\n\t\t\t\tconst check = methods[command.entity].isExists;\n\n\t\t\t\tif (command.type === actions.add) {\n\t\t\t\t\tgantt[method](command.oldValue, command.oldValue.parent, command.oldValue.$local_index);\n\t\t\t\t} else if (command.type === actions.remove) {\n\t\t\t\t\tif (gantt[check](command.value.id)) {\n\t\t\t\t\t\tgantt[method](command.value.id);\n\t\t\t\t\t}\n\t\t\t\t} else if (command.type === actions.update) {\n\t\t\t\t\tconst item = gantt[getMethod](command.value.id);\n\t\t\t\t\tfor(const prop in command.value){\n\t\t\t\t\t\tconst internalProperty = prop.startsWith(\"$\") || prop.startsWith(\"_\");\n\t\t\t\t\t\tconst whitelist = [\"$open\"];\n\t\t\t\t\t\tlet copyProperty = !internalProperty;\n\t\t\t\t\t\tif (whitelist.indexOf(prop) > -1){\n\t\t\t\t\t\t\tcopyProperty = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(copyProperty){\n\t\t\t\t\t\t\titem[prop] = command.value[prop];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tgantt[method](command.value.id);\n\t\t\t\t} else if (command.type === actions.move) {\n\t\t\t\t\tgantt[method](command.value.id, command.value.$local_index, command.value.parent);\n\t\t\t\t\t// GS-680: We should send the changes to the server after we undo vertical reorder\n\t\t\t\t\tgantt.callEvent(\"onRowDragEnd\", [command.value.id]);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n}","import auto_scheduling from \"./auto_scheduling\";\nimport click_drag from \"./click_drag\";\nimport critical_path from \"./critical_path\";\nimport drag_timeline from \"./drag_timeline\";\nimport export_api from \"./export_api\";\nimport fullscreen from \"./fullscreen\";\nimport grouping from \"./grouping\";\nimport keyboard_navigation from \"./keyboard_navigation\";\nimport marker from \"./marker\";\nimport multiselect from \"./multiselect\";\nimport overlay from \"./overlay\";\nimport quick_info from \"./quick_info\";\nimport tooltip from \"./tooltip\";\nimport undo from \"./undo\";\n\nexport default {\n\tauto_scheduling,\n\tclick_drag,\n\tcritical_path,\n\tdrag_timeline,\n\tfullscreen,\n\tkeyboard_navigation,\n\tquick_info,\n\ttooltip,\n\tundo,\n\tgrouping,\n\tmarker,\n\tmultiselect,\n\toverlay,\n\texport_api\n};","\nimport links_common from \"../core/relations/links_common\";\nimport graph_helper from \"../core/relations/graph_helper\";\n\nimport LinksBuilder from \"../core/relations/links_builder\";\nimport {ConstraintTypes} from \"./auto_scheduling/constraint_types\";\nimport {ConstraintsHelper} from \"./auto_scheduling/constraints\";\nimport {AutoSchedulingPlanner} from \"./auto_scheduling/planner\";\nimport {ConnectedGroupsHelper} from \"./auto_scheduling/connected_groups\";\nimport {LoopsFinder} from \"./auto_scheduling/loops_finder\";\n\nimport ConfigBuilder from \"../core/plugins/auto_scheduling_config\";\n\nimport {attachUIHandlers} from \"./auto_scheduling/ui_handlers\";\n\nexport default function(gantt){\n\n\tconst { getDefaultAutoSchedulingConfig, getAutoSchedulingConfig} = ConfigBuilder(gantt);\n\n\tlinks_common(gantt);\n\nvar linksBuilder = LinksBuilder(gantt);\nvar graphHelper = graph_helper(gantt);\n\n\nvar constraintsHelper = ConstraintsHelper.Create(\n\tgantt\n);\n\n\nvar planner = new AutoSchedulingPlanner(gantt, graphHelper, constraintsHelper);\n\nvar connectedGroups = new ConnectedGroupsHelper(gantt, linksBuilder);\n\nvar loopsFinder = new LoopsFinder(\n\tgantt,\n\tgraphHelper,\n\tlinksBuilder\n);\n\ngantt.getConnectedGroup = connectedGroups.getConnectedGroup;\ngantt.getConstraintType = constraintsHelper.getConstraintType;\ngantt.getConstraintLimitations = function (task) {\n\tvar plan = constraintsHelper.processConstraint(task, null);\n\tif (plan) {\n\t\treturn {\n\t\t\tearliestStart: plan.earliestStart || null,\n\t\t\tearliestEnd: plan.earliestEnd || null,\n\t\t\tlatestStart: plan.latestStart || null,\n\t\t\tlatestEnd: plan.latestEnd || null\n\t\t};\n\t} else {\n\t\treturn {\n\t\t\tearliestStart: null,\n\t\t\tearliestEnd: null,\n\t\t\tlatestStart: null,\n\t\t\tlatestEnd: null\n\t\t};\n\t}\n};\n\ngantt.isCircularLink = loopsFinder.isCircularLink;\ngantt.findCycles = loopsFinder.findCycles;\n\ngantt.config.auto_scheduling = getDefaultAutoSchedulingConfig();\ngantt.config.constraint_types = ConstraintTypes;\n\nfunction preferInitialTaskDates(startTask, relations) {\n\tif (gantt._getAutoSchedulingConfig().apply_constraints) {\n\t\treturn;\n\t}\n\n\t// .preferredStart exists only to emulate pre 6.1 auto scheduling behavior\n\tfor (var i = 0; i < relations.length; i++) {\n\t\tvar rel = relations[i];\n\t\tvar task = gantt.getTask(rel.target);\n\n\t\tif ((gantt._getAutoSchedulingConfig().gap_behavior === \"preserve\") || rel.target == startTask) {\n\t\t\trel.preferredStart = new Date(task.start_date);\n\t\t}\n\t}\n}\n\nvar afterRenderBeforeFirstRepaint = false;\ngantt.attachEvent(\"onParse\", function(){\n\tafterRenderBeforeFirstRepaint = true;\n\treturn true;\n});\n\ngantt.attachEvent(\"onBeforeGanttRender\", function(){\n\tafterRenderBeforeFirstRepaint = false;\n\treturn true;\n});\n\nfunction updateParentsAndCallEvents(updatedTasks) {\n\tif(!updatedTasks.length){\n\t\treturn;\n\t}\n\n\tgantt.batchUpdate(function payload() {\n\t\tfor (var i = 0; i < updatedTasks.length; i++) {\n\t\t\tgantt.updateTask(updatedTasks[i]);\n\t\t}\n\t}, afterRenderBeforeFirstRepaint); // don't call repaint if auto scheduling on parse before initial repain\n}\n\ngantt._autoSchedule = function (id, relations) {\n\tif (gantt.callEvent(\"onBeforeAutoSchedule\", [id]) === false) {\n\t\treturn;\n\t}\n\tgantt._autoscheduling_in_progress = true;\n\n\tvar constraints = constraintsHelper.getConstraints(\n\t\tid,\n\t\tgantt.isTaskExists(id) ? relations : null\n\t);\n\n\tvar updatedTasks = [];\n\n\tvar cycles = graphHelper.findLoops(relations);\n\tif (cycles.length) {\n\t\tgantt.callEvent(\"onAutoScheduleCircularLink\", [cycles]);\n\t} else {\n\t\tpreferInitialTaskDates(id, relations);\n\n\t\t// GS-2427. Auto-schedule twice when there are links with project tasks\n\t\t// as we cannot be sure that the project duration doesn't change\n\t\tfor (let i = 0; i < relations.length; i++) {\n\t\t\tif (relations[i].subtaskLink){\n\t\t\t\tplanner._secondIterationRequired = true;\n\t\t\t\tplanner._secondIteration = false;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tvar plan = planner.generatePlan(relations, constraints);\n\t\tupdatedTasks = planner.applyProjectPlan(plan);\n\n\t\tupdateParentsAndCallEvents(updatedTasks);\n\t}\n\n\tgantt._autoscheduling_in_progress = false;\n\tgantt.callEvent(\"onAfterAutoSchedule\", [id, updatedTasks]);\n};\n\ngantt.autoSchedule = function (id, inclusive) {\n\tif (inclusive === undefined) {\n\t\tinclusive = true;\n\t} else {\n\t\tinclusive = !!inclusive;\n\t}\n\n\tvar relations;\n\tif (id !== undefined) {\n\t\tif (!gantt._getAutoSchedulingConfig().apply_constraints) {\n\t\t\trelations = linksBuilder.getLinkedTasks(id, inclusive);\n\t\t} else {\n\t\t\trelations = connectedGroups.getConnectedGroupRelations(id);\n\t\t}\n\t} else {\n\t\trelations = linksBuilder.getLinkedTasks();\n\t}\n\n\tgantt._autoSchedule(id, relations);\n};\n\ngantt.attachEvent(\"onTaskLoading\", function (task) {\n\tif (task.constraint_date && typeof task.constraint_date === \"string\") {\n\t\ttask.constraint_date = gantt.date.parseDate(task.constraint_date, \"parse_date\");\n\t}\n\ttask.constraint_type = gantt.getConstraintType(task);\n\treturn true;\n});\ngantt.attachEvent(\"onTaskCreated\", function (task) {\n\ttask.constraint_type = gantt.getConstraintType(task);\n\treturn true;\n});\n\nattachUIHandlers(gantt, linksBuilder, loopsFinder, connectedGroups);\n\n};","import { EventsManager } from \"./eventsManager\";\nimport { ISelectedRegionConfig, SelectedRegion } from \"./selectedRegion\";\n\nexport default function(gantt: any){\n\tif (!gantt.ext) {\n\t\tgantt.ext = {};\n\t}\n\n\tconst defaultConfig: ISelectedRegionConfig = {\n\t\tclassName: \"gantt_click_drag_rect\",\n\t\tuseRequestAnimationFrame: true,\n\t\tcallback: undefined,\n\t\tsingleRow: false\n\t};\n\n\tfunction setClickDrag(){\n\t\tconst config: ISelectedRegionConfig = { viewPort: gantt.$task_data, ...defaultConfig };\n\t\tif (gantt.ext.clickDrag){\n\t\t\tgantt.ext.clickDrag.destructor();\n\t\t}\n\t\tgantt.ext.clickDrag = new EventsManager(gantt);\n\t\tconst clickDrag = gantt.config.click_drag;\n\t\tconfig.render = clickDrag.render || defaultConfig.render;\n\t\tconfig.className = clickDrag.className || defaultConfig.className;\n\t\tconfig.callback = clickDrag.callback || defaultConfig.callback;\n\t\tconfig.viewPort = clickDrag.viewPort || gantt.$task_data;\n\t\tconfig.useRequestAnimationFrame = clickDrag.useRequestAnimationFrame === undefined ?\n\t\t\tdefaultConfig.useRequestAnimationFrame : clickDrag.useRequestAnimationFrame;\n\n\t\tconfig.singleRow = clickDrag.singleRow === undefined ? defaultConfig.singleRow : clickDrag.singleRow;\n\t\tconst timeline = gantt.$ui.getView(\"timeline\");\n\t\tconst selectedRegion = new SelectedRegion(config, gantt, timeline);\n\t\tgantt.ext.clickDrag.attach(selectedRegion, clickDrag.useKey, clickDrag.ignore);\n\t}\n\n\tgantt.attachEvent(\"onGanttReady\", () => {\n\t\tif (gantt.config.click_drag){\n\t\t\tsetClickDrag();\n\t\t}\n\t});\n\n\tgantt.attachEvent(\"onGanttLayoutReady\", function(){\n\t\tif (gantt.$container && gantt.config.click_drag){\n\t\t\tgantt.attachEvent(\"onGanttRender\", function(){\n\t\t\t\tsetClickDrag();\n\t\t\t}, {once:true});\n\t\t}\n\t});\n\n\tgantt.attachEvent(\"onDestroy\", () => {\n\t\tif (gantt.ext.clickDrag){\n\t\t\tgantt.ext.clickDrag.destructor();\n\t\t}\n\t});\n\n}","\n\nimport links_common from \"../core/relations/links_common\";\nimport slackPrivate from \"./critical_path/slack\";\nimport critical_path from \"./critical_path/critical_path\";\n\n\nexport default function(gantt){\n\tlinks_common(gantt);\n\nvar _private = slackPrivate(gantt);\n_private.init();\n\ngantt.getFreeSlack = function(task) {\n\treturn _private.getFreeSlack(task);\n};\n\ngantt.getTotalSlack = function(task) {\n\treturn _private.getTotalSlack(task);\n};\n\nvar criticalPath = critical_path(gantt);\ngantt.config.highlight_critical_path = false;\ncriticalPath.init(_private);\n\ngantt.isCriticalTask = function (task) {\n\tgantt.assert(!!(task && task.id !== undefined), \"Invalid argument for gantt.isCriticalTask\");\n\treturn criticalPath.isCriticalTask(task);\n};\n\ngantt.isCriticalLink = function (link) {\n\treturn this.isCriticalTask(gantt.getTask(link.source));\n};\n\n\ngantt.getSlack = function(task1, task2) {\n\tvar minSlack = 0;\n\tvar relations = [];\n\tvar common = {};\n\n\tfor (var i = 0; i < task1.$source.length; i++) {\n\t\tcommon[task1.$source[i]] = true;\n\t}\n\tfor (var i = 0; i < task2.$target.length; i++) {\n\t\tif(common[task2.$target[i]])\n\t\t\trelations.push(task2.$target[i]);\n\t}\n\t// there is at least one link\n\tif (relations[0]){\n\t\tfor (var i = 0; i < relations.length; i++) {\n\t\t\tvar link = this.getLink(relations[i]);\n\t\t\tvar newSlack = this._getSlack(task1, task2, this._convertToFinishToStartLink(link.id, link, task1, task2, task1.parent, task2.parent));\n\n\t\t\tif (minSlack > newSlack || i === 0) {\n\t\t\t\tminSlack = newSlack;\n\t\t\t}\n\t\t}\n\t}\n\telse { // there are no links, but we still need the slack (for the children of a project task)\n\t\tminSlack = this._getSlack(task1, task2, {});\n\t}\n\treturn minSlack;\n};\n\ngantt._getSlack = function (task, next_task, relation) {\n\t// relation - link expressed as finish-to-start (gantt._convertToFinishToStartLink)\n\tvar types = this.config.types;\n\n\tvar from = null;\n\tif (this.getTaskType(task.type) == types.milestone) {\n\t\tfrom = task.start_date;\n\t} else {\n\t\tfrom = task.end_date;\n\t}\n\n\tvar to = next_task.start_date;\n\n\tvar duration = 0;\n\tif (+from > +to) {\n\t\tduration = -this.calculateDuration({start_date: to, end_date: from, task: task});\n\t} else {\n\t\tduration = this.calculateDuration({start_date: from, end_date: to, task: task});\n\t}\n\n\tvar lag = relation.lag;\n\tif (lag && lag*1 == lag) {\n\t\tduration -= lag;\n\t}\n\n\treturn duration;\n};\n\n\n};","import LinksBuilder from \"../../core/relations/links_builder\";\nimport GraphHelper from \"../../core/relations/graph_helper\";\n\nexport default function(gantt) {\n\tvar linksBuilder = LinksBuilder(gantt);\n\tvar graphHelper = GraphHelper(gantt);\n\tvar _private = {\n\t\t_freeSlack: {},\n\t\t_totalSlack: {},\n\t\t_slackNeedCalculate: true,\n\t\t_linkedTasksById: {},\n\t\t_successorsByTaskId: {},\n\t\t_projectEnd: null,\n\t\t\n\t\t_calculateSlacks: function(){\n\t\t\tvar linkedTasks = linksBuilder.getLinkedTasks();\n\t\t\t\n\t\t\tvar loops = graphHelper.findLoops(linkedTasks);\n\t\t\tif(loops.length){\n\t\t\t\tgantt.callEvent(\"onAutoScheduleCircularLink\", [loops]);\n\t\t\t\tvar loopLinks = {};\n\t\t\t\t\n\t\t\t\tloops.forEach(function(loop){\n\t\t\t\t\t// remove loop\n\t\t\t\t\tloop.linkKeys.forEach(function(key){\n\t\t\t\t\t\tloopLinks[key] = true;\n\t\t\t\t\t});\n\t\t\t\t\t//const problemLink = loop.linkKeys[0];\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tfor(var i = 0; i < linkedTasks.length; i++){\n\t\t\t\t\tif(linkedTasks[i].hashSum in loopLinks){\n\t\t\t\t\t\tlinkedTasks.splice(i, 1);\n\t\t\t\t\t\ti--;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tconst reversedOrder = graphHelper.topologicalSort(linkedTasks).reverse();\n\t\t\tconst successorsByTaskId = {};\n\t\t\tlinkedTasks.forEach((entry) => {\n\n\t\t\t\t// get successors\n\t\t\t\tif (!successorsByTaskId[entry.source]) {\n\t\t\t\t\tsuccessorsByTaskId[entry.source] = {\n\t\t\t\t\t\tlinked: []\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\tsuccessorsByTaskId[entry.source].linked.push({\n\t\t\t\t\ttarget: entry.target,\n\t\t\t\t\tlink: entry\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tconst distCalculator = {\n\t\t\t\t_cache: {},\n\t\t\t\tgetDist: function(source, target){\n\t\t\t\t\tconst key = `${source.id}_${target.id}`;\n\t\t\t\t\tif(this._cache[key]){\n\t\t\t\t\t\treturn this._cache[key];\n\t\t\t\t\t}else{\n\t\t\t\t\t\tconst dist = gantt.calculateDuration({\n\t\t\t\t\t\t\tstart_date: source.end_date,\n\t\t\t\t\t\t\tend_date: target.start_date,\n\t\t\t\t\t\t\ttask: source});\n\t\t\t\t\t\t\n\t\t\t\t\t\tthis._cache[key] = dist;\n\t\t\t\t\t\treturn dist;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\tthis._projectEnd = gantt.getSubtaskDates().end_date;\n\t\t\tthis._calculateFreeSlack(linkedTasks, reversedOrder, successorsByTaskId, distCalculator);\n\t\t\tthis._calculateTotalSlack(linkedTasks, reversedOrder, successorsByTaskId, distCalculator);\n\t\t},\n\t\t_isCompletedTask: function(task){\n\t\t\tconst autoSchedulingConfig = gantt._getAutoSchedulingConfig();\n\t\t\treturn autoSchedulingConfig.use_progress && task.progress == 1;\n\t\t},\n\t\t_calculateFreeSlack: function(linkedTasks, orderedFromEnd, successorsMap, distCalculator){\n\t\t\t\n\t\t\tconst freeSlack = this._freeSlack = {};\n\t\t\tconst tasksToDo = {};\n\t\t\tgantt.eachTask(function(task){\n\t\t\t\tif(!gantt.isSummaryTask(task)){\n\t\t\t\t\ttasksToDo[task.id] = task;\n\t\t\t\t}\n\t\t\t});\n\t\t\tconst processedTasks = {};\n\t\t\tlinkedTasks.forEach((entry) => {\n\t\t\t\tconst task = tasksToDo[entry.source];\n\t\t\t\t// GS-1995: Don't calculate slack if the task's parent is not loaded\n\t\t\t\tif (!task){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tprocessedTasks[entry.source] = true;\n\t\t\t\tlet ownSlack = distCalculator.getDist(task, gantt.getTask(entry.target));\n\t\t\t\townSlack -= entry.lag || 0;\n\n\t\t\t\tif(freeSlack[entry.source] !== undefined){\n\t\t\t\t\tfreeSlack[entry.source] = Math.min(ownSlack, freeSlack[entry.source]);\n\t\t\t\t}else{\n\t\t\t\t\tfreeSlack[entry.source] = ownSlack;\n\t\t\t\t}\n\t\t\t});\n\t\t\tfor(const id in tasksToDo){\n\t\t\t\tif(processedTasks[id]){\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tconst task = tasksToDo[id];\n\t\t\t\tif(this._isCompletedTask(task) || task.unscheduled){\n\t\t\t\t\tfreeSlack[task.id] = 0;\n\t\t\t\t}else{\n\t\t\t\t\tfreeSlack[task.id] = gantt.calculateDuration({start_date: task.end_date, end_date: this._projectEnd, task:task});\n\t\t\t\t}\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\treturn this._freeSlack;\n\n\t\t},\n\t\t_disconnectedTaskSlack(task){\n\t\t\tif(this._isCompletedTask(task)){\n\t\t\t\treturn 0;\n\t\t\t}else{\n\t\t\t\treturn Math.max(gantt.calculateDuration(task.end_date, this._projectEnd), 0);\n\t\t\t}\n\t\t},\n\t\t_calculateTotalSlack: function(linkedTasks, orderedFromEnd, successorsMap,  distCalculator) {\n\t\t\tthis._totalSlack = {};\n\t\t\tthis._slackNeedCalculate = false;\n\t\t\tvar totalSlackByTaskId = {};\n\t\t\tvar tasks = gantt.getTaskByTime();\n\n\t\t\tfor(var i = 0; i < orderedFromEnd.length; i++){\n\t\t\t\tconst task = gantt.getTask(orderedFromEnd[i]);\n\t\t\t\t\n\t\t\t\tif(this._isCompletedTask(task)){\n\t\t\t\t\ttotalSlackByTaskId[task.id] = 0;\n\t\t\t\t} else if(!successorsMap[task.id] && !gantt.isSummaryTask(task)){\n\t\t\t\t\ttotalSlackByTaskId[task.id] = this.getFreeSlack(task);\n\t\t\t\t}else{\n\t\t\t\t\tconst successorLinks = successorsMap[task.id].linked;\n\t\t\t\t\tlet totalSlack = null;\n\t\t\t\t\tfor(var j = 0; j < successorLinks.length; j++){\n\t\t\t\t\t\tconst successorLink = successorLinks[j];\n\t\t\t\t\t\tconst successor = gantt.getTask(successorLink.target);\n\t\t\t\t\t\tlet successorSlack = 0;\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(totalSlackByTaskId[successor.id] !== undefined){\n\t\t\t\t\t\t\tsuccessorSlack += totalSlackByTaskId[successor.id];\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tsuccessorSlack += Math.max(distCalculator.getDist(task, successor) - successorLink.link.targetLag, 0);\n\n\t\t\t\t\t\tsuccessorSlack -= successorLink.link.trueLag || 0;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\tif(totalSlack === null){\n\t\t\t\t\t\t\ttotalSlack = successorSlack;\n\t\t\t\t\t\t} else{\n\t\t\t\t\t\t\ttotalSlack = Math.min(totalSlack, successorSlack);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\ttotalSlackByTaskId[task.id] = totalSlack || 0;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\ttasks.forEach(function(task){\n\t\t\t\tif(totalSlackByTaskId[task.id] === undefined && !gantt.isSummaryTask(task)){\n\t\t\t\t\ttotalSlackByTaskId[task.id] = this.getFreeSlack(task);\n\t\t\t\t}\n\t\t\t}.bind(this));\n\t\t\t\n\t\t\tthis._totalSlack = totalSlackByTaskId;\n\t\t\treturn this._totalSlack;\n\t\t},\n\n\t\t_resetTotalSlackCache: function() {\n\t\t\tthis._slackNeedCalculate = true;\n\t\t},\n\n\t\t_shouldCalculateTotalSlack: function() {\n\t\t\treturn this._slackNeedCalculate;\n\t\t},\n\n\t\tgetFreeSlack: function(task) {\n\t\t\tif (this._shouldCalculateTotalSlack()) {\n\t\t\t\tthis._calculateSlacks();\n\t\t\t}\n\t\t\tif (!gantt.isTaskExists(task.id)) {\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t\tif(this._isCompletedTask(task)){\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tif(gantt.isSummaryTask(task)){\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\treturn this._freeSlack[task.id] || 0; \n\t\t},\n\n\t\tgetTotalSlack: function(task) {\n\t\t\tif (this._shouldCalculateTotalSlack()) {\n\t\t\t\tthis._calculateSlacks();\n\t\t\t}\n\t\t\tif (task === undefined) {\n\t\t\t\treturn this._totalSlack;\n\t\t\t}\n\t\t\t\n\t\t\tvar id;\n\t\t\tif (task.id !== undefined){\n\t\t\t\tid = task.id;\n\t\t\t}else{\n\t\t\t\tid = task;\n\t\t\t}\n\n\t\t\tif(this._isCompletedTask(task)){\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t\tif(this._totalSlack[id] === undefined){\n\t\t\t\tif(gantt.isSummaryTask(gantt.getTask(id))){\n\t\t\t\t\tvar minSlack = null;\n\t\t\t\t\tgantt.eachTask(function(child){\n\t\t\t\t\t\tvar childSlack = this._totalSlack[child.id];\n\t\t\t\t\t\tif(childSlack !== undefined && (minSlack === null || childSlack < minSlack)){\n\t\t\t\t\t\t\tminSlack = childSlack;\n\t\t\t\t\t\t}\n\t\t\t\t\t}.bind(this), id);\n\t\t\t\t\t\n\t\t\t\t\tif(minSlack !== null){\n\t\t\t\t\t\tthis._totalSlack[id] = minSlack;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tthis._totalSlack[id] = gantt.calculateDuration({\n\t\t\t\t\t\t\tstart_date: task.end_date,\n\t\t\t\t\t\t\tend_date: this._projectEnd,\n\t\t\t\t\t\t\ttask: task\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\treturn this._totalSlack[id];\n\t\t\t\t\t\n\t\t\t\t}else{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\treturn this._totalSlack[id] || 0;\n\t\t\t}\n\t\t},\n\n\t\tdropCachedFreeSlack: function() {\n\t\t\tthis._freeSlack =  {};\n\t\t\tthis._resetTotalSlackCache();\n\t\t},\n\n\t\tinit: function(){\n\t\t\tfunction slackHandler(){\n\t\t\t\t_private.dropCachedFreeSlack();\n\t\t\t}\n\n\t\t\tgantt.attachEvent(\"onAfterLinkAdd\", slackHandler);\n\t\t\tgantt.attachEvent(\"onTaskIdChange\", slackHandler);\n\t\t\tgantt.attachEvent(\"onAfterLinkUpdate\", slackHandler);\n\t\t\tgantt.attachEvent(\"onAfterLinkDelete\", slackHandler);\n\t\t\tgantt.attachEvent(\"onAfterTaskAdd\", slackHandler);\n\t\t\tgantt.attachEvent(\"onAfterTaskUpdate\", slackHandler);\n\t\t\tgantt.attachEvent(\"onAfterTaskDelete\", slackHandler);\n\t\t\tgantt.attachEvent(\"onRowDragEnd\", slackHandler);\n\t\t\tgantt.attachEvent(\"onAfterTaskMove\", slackHandler);\n\t\t\tgantt.attachEvent(\"onParse\", slackHandler);\n\t\t\tgantt.attachEvent(\"onClear\", slackHandler);\n\t\t\tgantt.$data.tasksStore.attachEvent(\"onClearAll\", slackHandler);\n\t\t\tgantt.$data.linksStore.attachEvent(\"onClearAll\", slackHandler);\n\t\t}\n\t};\n\n\treturn _private;\n};","export default function(gantt){\n\tgantt._isProjectEnd = function(task) {\n\t\treturn !(this._hasDuration({\n\t\t\tstart_date: task.end_date,\n\t\t\tend_date: this._getProjectEnd(),\n\t\t\ttask: task\n\t\t}));\n\t};\n\n\treturn {\n\t\t_cache: {},\n\t\t_slackHelper: null,\n\t\treset: function(){\n\t\t\tthis._cache = {};\n\t\t},\n\t\t_calculateCriticalPath: function(){\n\t\t\tthis.reset();\n\t\t},\n\t\t\n\t\tisCriticalTask: function(task){\n\t\t\tif(!task) return false;\n\n\t\t\tconst autoSchedulingConfig = gantt._getAutoSchedulingConfig();\n\t\t\tif(autoSchedulingConfig.use_progress && task.progress === 1){\n\t\t\t\tthis._cache[task.id] = false;\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (task.unscheduled){\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif(this._cache[task.id] === undefined){\n\t\t\t\tif(gantt.isSummaryTask(task)){\n\t\t\t\t\tlet hasCritical = false;\n\t\t\t\t\tgantt.eachTask((function(child){\n\t\t\t\t\t\tif(!hasCritical){\n\t\t\t\t\t\t\thasCritical = this.isCriticalTask(child);\n\t\t\t\t\t\t}\n\t\t\t\t\t}).bind(this), task.id);\n\t\t\t\t\t\n\t\t\t\t\tthis._cache[task.id] = hasCritical;\n\t\t\t\t}else{\n\t\t\t\t\tthis._cache[task.id] = this._slackHelper.getTotalSlack(task) <= 0;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\treturn this._cache[task.id];\n\t\t},\n\n\t\tinit: function(slackHelper){\n\t\t\tthis._slackHelper = slackHelper;\n\t\t\tvar resetCache = gantt.bind(function(){\n\t\t\t\tthis.reset();\n\t\t\t\treturn true;\n\t\t\t}, this);\n\n\t\t\tvar handleTaskIdChange = gantt.bind(function (oldId, newId) {\n\t\t\t\tif (this._cache) {\n\t\t\t\t\tthis._cache[newId] = this._cache[oldId];\n\t\t\t\t\tdelete this._cache[oldId];\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}, this);\n\n\t\t\tgantt.attachEvent(\"onAfterLinkAdd\", resetCache);\n\t\t\tgantt.attachEvent(\"onAfterLinkUpdate\", resetCache);\n\t\t\tgantt.attachEvent(\"onAfterLinkDelete\", resetCache);\n\t\t\tgantt.attachEvent(\"onAfterTaskAdd\", resetCache);\n\t\t\tgantt.attachEvent(\"onTaskIdChange\", handleTaskIdChange);\n\t\t\tgantt.attachEvent(\"onAfterTaskUpdate\", resetCache);\n\t\t\tgantt.attachEvent(\"onAfterTaskDelete\", resetCache);\n\t\t\tgantt.attachEvent(\"onParse\", resetCache);\n\t\t\tgantt.attachEvent(\"onClear\", resetCache);\n\t\t\tgantt.$data.tasksStore.attachEvent(\"onClearAll\", resetCache);\n\t\t\tgantt.$data.linksStore.attachEvent(\"onClearAll\", resetCache);\n\n\t\t\tvar criticalPathHandler = function(){\n\t\t\t\tif(gantt.config.highlight_critical_path && !gantt.getState(\"batchUpdate\").batch_update)\n\t\t\t\t\tgantt.render();\n\t\t\t};\n\t\t\tgantt.attachEvent(\"onAfterLinkAdd\", criticalPathHandler);\n\t\t\tgantt.attachEvent(\"onAfterLinkUpdate\", criticalPathHandler);\n\t\t\tgantt.attachEvent(\"onAfterLinkDelete\", criticalPathHandler);\n\t\t\tgantt.attachEvent(\"onAfterTaskAdd\", criticalPathHandler);\n\t\t\tgantt.attachEvent(\"onTaskIdChange\", function (oldId, newId) {\n\t\t\t\tif (gantt.config.highlight_critical_path && gantt.isTaskExists(newId)) {\n\t\t\t\t\tgantt.refreshTask(newId);\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t});\n\t\t\tgantt.attachEvent(\"onAfterTaskUpdate\", criticalPathHandler);\n\t\t\tgantt.attachEvent(\"onAfterTaskDelete\", criticalPathHandler);\n\t\t}\n\t};\n};","import { EventsManager } from \"./eventsManager\";\nexport default function(gantt: any){\n\tif (!gantt.ext){\n\t\tgantt.ext = {};\n\t}\n\n\tgantt.ext.dragTimeline = {\n\t\tcreate: () => EventsManager.create(gantt),\n\t\t_isDragInProgress: () => EventsManager._isDragInProgress\n\t};\n\n\tgantt.config.drag_timeline = {\n\t\tenabled: true,\n\t\trender: false\n\t};\n}","export default function(gantt: any){\n\ninterface IBody extends HTMLElement {\n\tmsRequestFullscreen?: () => void;\n\tmozRequestFullScreen?: () => void;\n\twebkitRequestFullscreen?: (ALLOW_KEYBOARD_INPUT: any) => void;\n}\n\n\ninterface IConsole extends Console {\n\twarning?: (str: string) => void;\n}\n\ninterface IDocument extends Document {\n\tfullscreenElement: Element;\n\tmozFullScreenElement?: Element;\n\twebkitFullscreenElement?: Element;\n\tmsFullscreenElement?: Element;\n\twebkitFullscreenEnabled?: boolean;\n\tmozFullScreenEnabled?: boolean;\n\tmsFullscreenEnabled?: boolean;\n\tmsExitFullscreen?: () => void;\n\tmozCancelFullScreen?: () => void;\n\twebkitExitFullscreen?: () => void;\n}\n\ninterface IElement extends Element {\n\tALLOW_KEYBOARD_INPUT?: boolean;\n}\n\ninterface IElementSizes extends ISizes {\n\tmodified: boolean;\n}\n\ninterface ISizes {\n\twidth: null | string;\n\theight: null | string;\n\ttop: null | string;\n\tleft: null | string;\n\tposition: null | string;\n\tzIndex: null | number;\n}\n\nfunction isExpanded() {\n\tconst element = ((document as IDocument).fullscreenElement ||\n\t\t(document as IDocument).mozFullScreenElement ||\n\t\t(document as IDocument).webkitFullscreenElement ||\n\t\t(document as IDocument).msFullscreenElement);\n\treturn !!(element && element === document.body);\n}\n\nfunction isFullscreenAvailable() {\n\ttry {\n\t\treturn (document as IDocument).fullscreenEnabled ||\n\t\t\t(document as IDocument).webkitFullscreenEnabled ||\n\t\t\t(document as IDocument).mozFullScreenEnabled ||\n\t\t\t(document as IDocument).msFullscreenEnabled;\n\t} catch (e) {\n\t\t// eslint-disable-next-line no-console\n\t\tconsole.error(\"Fullscreen is not available:\", e); \n\t}\n}\n\nconst state = gantt.$services.getService(\"state\");\nstate.registerProvider(\"fullscreen\", () => {\n\tif (isFullscreenAvailable()){\n\t\treturn { fullscreen: isExpanded() };\n\t} else {\n\t\treturn undefined;\n\t}\n});\n\nlet backupBodyPadding = {\n\toverflow: null,\n\tpadding: null,\n\tpaddingTop: null,\n\tpaddingRight: null,\n\tpaddingBottom: null,\n\tpaddingLeft: null\n};\n\nconst backupElementSizes: IElementSizes = {\n\twidth: null,\n\theight: null,\n\ttop: null,\n\tleft: null,\n\tposition: null,\n\tzIndex: null,\n\tmodified: false\n};\n\nlet backupPositioning = null;\nfunction resetParentPositioning(root){\n\tlet parent = root.parentNode;\n\tconst positions = [];\n\twhile(parent && parent.style){\n\t\tpositions.push({\n\t\t\telement: parent,\n\t\t\toriginalPositioning: parent.style.position\n\t\t});\n\t\tparent.style.position = \"static\";\n\t\tparent = parent.parentNode;\n\t}\n\treturn positions;\n}\n\nfunction restoreParentPositioning(positions: any[]){\n\tpositions.forEach(record => {\n\t\trecord.element.style.position = record.originalPositioning;\n\t});\n}\n\n// expand gantt root element to fullscreen automatically\nfunction setFullScreenSizes() {\n\tconst root = gantt.ext.fullscreen.getFullscreenElement();\n\tconst body = document.body;\n\tupdateSizes(root.style, backupElementSizes);\n\tbackupBodyPadding = {\n\t\toverflow: body.style.overflow,\n\t\tpadding: body.style.padding ? body.style.padding : null,\n\t\tpaddingTop: body.style.paddingTop ? body.style.paddingTop : null,\n\t\tpaddingRight: body.style.paddingRight ? body.style.paddingRight : null,\n\t\tpaddingBottom: body.style.paddingBottom ? body.style.paddingBottom : null,\n\t\tpaddingLeft: body.style.paddingLeft ? body.style.paddingLeft : null\n\t};\n\n\tif (body.style.padding) {\n\t\tbody.style.padding = \"0\";\n\t}\n\tif (body.style.paddingTop) {\n\t\tbody.style.paddingTop = \"0\";\n\t}\n\tif (body.style.paddingRight) {\n\t\tbody.style.paddingRight = \"0\";\n\t}\n\tif (body.style.paddingBottom) {\n\t\tbody.style.paddingBottom = \"0\";\n\t}\n\tif (body.style.paddingLeft) {\n\t\tbody.style.paddingLeft = \"0\";\n\t}\n\n\tbody.style.overflow = \"hidden\";\n\n\troot.style.width = \"100vw\";\n\troot.style.height = \"100vh\";\n\troot.style.top = \"0px\";\n\troot.style.left = \"0px\";\n\troot.style.position = \"absolute\";\n\troot.style.zIndex = 1;\n\tbackupElementSizes.modified = true;\n\tbackupPositioning = resetParentPositioning(root);\n}\n\nfunction restoreSizes() {\n\tconst root = gantt.ext.fullscreen.getFullscreenElement();\n\tconst body = document.body;\n\tif (backupElementSizes.modified) {\n\t\tif (backupBodyPadding.padding) {\n\t\t\tbody.style.padding = backupBodyPadding.padding;\n\t\t}\n\t\tif (backupBodyPadding.paddingTop) {\n\t\t\tbody.style.paddingTop = backupBodyPadding.paddingTop;\n\t\t}\n\t\tif (backupBodyPadding.paddingRight) {\n\t\t\tbody.style.paddingRight = backupBodyPadding.paddingRight;\n\t\t}\n\t\tif (backupBodyPadding.paddingBottom) {\n\t\t\tbody.style.paddingBottom = backupBodyPadding.paddingBottom;\n\t\t}\n\t\tif (backupBodyPadding.paddingLeft) {\n\t\t\tbody.style.paddingLeft = backupBodyPadding.paddingLeft;\n\t\t}\n\n\t\tbody.style.overflow = backupBodyPadding.overflow;\n\t\tbackupBodyPadding = {\n\t\t\toverflow: null,\n\t\t\tpadding: null,\n\t\t\tpaddingTop: null,\n\t\t\tpaddingRight: null,\n\t\t\tpaddingBottom: null,\n\t\t\tpaddingLeft: null\n\t\t};\n\t\tupdateSizes(backupElementSizes, root.style);\n\t\tbackupElementSizes.modified = false;\n\t}\n\trestoreParentPositioning(backupPositioning);\n\tbackupPositioning = null;\n}\n\nfunction updateSizes(source: ISizes, target: ISizes) {\n\ttarget.width = source.width;\n\ttarget.height = source.height;\n\ttarget.top = source.top;\n\ttarget.left = source.left;\n\ttarget.position = source.position;\n\ttarget.zIndex = source.zIndex;\n}\n\nfunction addDOMEvents() {\n\tgantt.event(document, \"webkitfullscreenchange\", onFullScreenChange);\n\tgantt.event(document, \"mozfullscreenchange\", onFullScreenChange);\n\tgantt.event(document, \"MSFullscreenChange\", onFullScreenChange);\n\t// For IE on Win 10\n\tgantt.event(document, \"fullscreenChange\", onFullScreenChange);\n\tgantt.event(document, \"fullscreenchange\", onFullScreenChange);\n}\n\nlet expandGantt = false;\nfunction onFullScreenChange() {\n\tif (!gantt.$container) {\n\t\t// do nothing if gantt is not yet initialized\n\t\treturn;\n\t}\n\tlet event: \"onExpand\" | \"onCollapse\";\n\tconst isBodyExpanded = isExpanded();\n\n\tif (isBodyExpanded) {\n\t\tif (expandGantt) {\n\t\t\tevent = \"onExpand\";\n\t\t\tsetFullScreenSizes();\n\t\t}\n\t} else if (expandGantt) {\n\t\texpandGantt = false;\n\t\tevent = \"onCollapse\";\n\t\trestoreSizes();\n\t}\n\tsetTimeout(() => {\n\t\tgantt.render();\n\t});\n\tsetTimeout(() => {\n\t\tgantt.callEvent(event, [gantt.ext.fullscreen.getFullscreenElement()]);\n\t});\n}\n\nfunction cantFullscreen() {\n\tif (!gantt.$container) { // check is gantt initialized or not\n\t\treturn true;\n\t}\n\tif (!gantt.ext.fullscreen.getFullscreenElement()) {\n\t\treturn true;\n\t}\n\tif (!isFullscreenAvailable()) {\n\t\t// eslint-disable-next-line no-console\n\t\tconst method = (console as IConsole).warning || console.log;\n\t\tmethod(\"The `fullscreen` feature not being allowed, or full-screen mode not being supported\");\n\t\treturn true;\n\t}\n\treturn false;\n}\n\ngantt.ext.fullscreen = {\n\texpand(): void {\n\t\tif (cantFullscreen()) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (isExpanded()) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!gantt.callEvent(\"onBeforeExpand\", [this.getFullscreenElement()])) {\n\t\t\treturn;\n\t\t}\n\t\texpandGantt = true;\n\n\t\t// we switch body to fullscreen and then expand fullscreen element to viewport\n\t\t// we do it to correct display common elements: lightboxes, tooltip etc.\n\t\tconst element = document.body as IBody;\n\t\tconst requestArguments = element.webkitRequestFullscreen ?\n\t\t\t[(Element as unknown as IElement).ALLOW_KEYBOARD_INPUT] : [];\n\n\t\tconst requestFullscreen = element.msRequestFullscreen ||\n\t\t\telement.mozRequestFullScreen ||\n\t\t\telement.webkitRequestFullscreen ||\n\t\t\telement.requestFullscreen;\n\n\t\tif (requestFullscreen) {\n\t\t\trequestFullscreen.apply(element, requestArguments);\n\t\t}\n\t},\n\tcollapse(): void {\n\t\tif (cantFullscreen()) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!isExpanded()) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!gantt.callEvent(\"onBeforeCollapse\", [this.getFullscreenElement()])) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst requestExitFullscreen = (document as IDocument).msExitFullscreen ||\n\t\t\t(document as IDocument).mozCancelFullScreen ||\n\t\t\t(document as IDocument).webkitExitFullscreen ||\n\t\t\t(document as IDocument).exitFullscreen;\n\n\t\tif (requestExitFullscreen) {\n\t\t\trequestExitFullscreen.apply(document);\n\t\t}\n\t},\n\ttoggle(): void {\n\t\tif (cantFullscreen()) {\n\t\t\treturn;\n\t\t}\n\t\tif (!isExpanded()) {\n\t\t\tthis.expand();\n\t\t} else {\n\t\t\tthis.collapse();\n\t\t}\n\n\t},\n\tgetFullscreenElement(): HTMLElement {\n\t\treturn gantt.$root;\n\t}\n};\n\ngantt.expand = function() {\n\tgantt.ext.fullscreen.expand();\n};\n\ngantt.collapse = function(){\n\tgantt.ext.fullscreen.collapse();\n};\n\ngantt.attachEvent(\"onGanttReady\", addDOMEvents);\n\n}","import eventable from \"../utils/eventable\";\nimport * as domHelpers from \"../core/ui/utils/dom_helpers\";\n\nimport keyboard_shortcuts from \"./keyboard_navigation/common/keyboard_shortcuts\";\nimport eventhandler from \"./keyboard_navigation/common/eventhandler\";\nimport trap_modal_focus from \"./keyboard_navigation/common/trap_modal_focus\";\nimport gantt_node from \"./keyboard_navigation/elements/gantt_node\";\nimport nav_node from \"./keyboard_navigation/elements/nav_node\";\nimport header_cell from \"./keyboard_navigation/elements/header_cell\";\nimport task_row from \"./keyboard_navigation/elements/task_row\";\nimport task_cell from \"./keyboard_navigation/elements/task_cell\";\nimport modals from \"./keyboard_navigation/modals\";\nimport core from \"./keyboard_navigation/core\";\n\n\n\nexport default function(gantt){\n\tfunction setupKeyNav(gantt){\n\t\tgantt.config.keyboard_navigation = true;\n\t\tgantt.config.keyboard_navigation_cells = false;\n\n\t\tgantt.$keyboardNavigation = {};\n\n\t\tgantt._compose = function(){\n\t\t\tvar parts = Array.prototype.slice.call(arguments, 0);\n\t\t\tvar res = {};\n\t\t\tfor(var i = 0; i < parts.length; i++){\n\t\t\t\tvar obj = parts[i];\n\t\t\t\tif(typeof obj == \"function\"){\n\t\t\t\t\tobj = new obj();\n\t\t\t\t}\n\n\t\t\t\tfor(var p in obj){\n\t\t\t\t\tres[p] = obj[p];\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn res;\n\t\t};\n\n\t\tkeyboard_shortcuts(gantt);\n\t\teventhandler(gantt);\n\t\ttrap_modal_focus(gantt);\n\t\tgantt_node(gantt);\n\t\tnav_node(gantt);\n\t\theader_cell(gantt);\n\t\ttask_row(gantt);\n\t\ttask_cell(gantt);\n\t\tmodals(gantt);\n\t\tcore(gantt);\n\n\n\t\t(function(){\n\t\t\tvar dispatcher = gantt.$keyboardNavigation.dispatcher;\n\n\t\t\tdispatcher.isTaskFocused = function(id){\n\t\t\t\tvar node = dispatcher.activeNode;\n\t\t\t\tif(node instanceof gantt.$keyboardNavigation.TaskRow || node instanceof gantt.$keyboardNavigation.TaskCell) {\n\t\t\t\t\tif (node.taskId == id) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t};\n\n\t\t\tvar keyDownHandler = function(e){\n\t\t\t\tif(!gantt.config.keyboard_navigation) return;\n\t\t\t\t// GS-734 & GS-1078: we don't need keyboard navigation inside inline editors\n\t\t\t\tif(!gantt.config.keyboard_navigation_cells && isInlineEditorCell(e)) return;\n\n\t\t\t\tif (isNoKeyboardNavigationElement(e) || isLightboxElement(e)){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\treturn dispatcher.keyDownHandler(e);\n\t\t\t};\n\n\t\t\tvar focusHandler = function(e){\n\t\t\t\tif(dispatcher.$preventDefault){\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tgantt.$container.blur();\n\t\t\t\t\treturn false;\n\t\t\t\t// do nothing if key-nav focus is already planned\n\t\t\t\t} else if (!dispatcher.awaitsFocus()) {\n\t\t\t\t\t// otherwise - re-focus key-nav element on gantt focus\n\t\t\t\t\tdispatcher.focusGlobalNode();\n\t\t\t\t}\n\n\t\t\t};\n\n\t\t\tvar reFocusActiveNode = function(){\n\t\t\t\tif(!dispatcher.isEnabled())\n\t\t\t\t\treturn;\n\n\t\t\t\tconst outsideGantt = !domHelpers.isChildOf(document.activeElement, gantt.$container) && document.activeElement.localName != \"body\";\n\t\t\t\tvar activeNode = dispatcher.getActiveNode();\n\t\t\t\tif(!activeNode || outsideGantt)\n\t\t\t\t\treturn;\n\n\t\t\t\tvar domElement = activeNode.getNode();\n\t\t\t\tvar top, left;\n\t\t\t\tif(domElement && domElement.parentNode){\n\t\t\t\t\ttop = domElement.parentNode.scrollTop;\n\t\t\t\t\tleft = domElement.parentNode.scrollLeft;\n\n\t\t\t\t}\n\n\t\t\t\tactiveNode.focus(true);\n\n\t\t\t\tif(domElement && domElement.parentNode){\n\t\t\t\t\tdomElement.parentNode.scrollTop = top;\n\t\t\t\t\tdomElement.parentNode.scrollLeft = left;\n\t\t\t\t}\n\t\t\t};\n\n\n\t\t\tgantt.attachEvent(\"onDataRender\", function(){\n\t\t\t\tif(!gantt.config.keyboard_navigation) return;\n\t\t\t\treFocusActiveNode();\n\t\t\t});\n\n\t\t\tgantt.attachEvent(\"onGanttRender\", function(){\n\t\t\t\t//GS-2230: in case if `getGanttInstance` created without container\n\t\t\t\tif(!gantt.$root) return;\n\t\t\t\tgantt.eventRemove(gantt.$root, \"keydown\", keyDownHandler);\n\t\t\t\tgantt.eventRemove(gantt.$container, \"focus\", focusHandler);\n\t\t\t\tgantt.eventRemove(gantt.$container, \"mousedown\", mousedownHandler);\n\n\t\t\t\tif(gantt.config.keyboard_navigation){\n\n\t\t\t\t\tgantt.event(gantt.$root, \"keydown\", keyDownHandler);\n\t\t\t\t\tgantt.event(gantt.$container, \"focus\", focusHandler);\n\t\t\t\t\tgantt.event(gantt.$container, \"mousedown\", mousedownHandler);\n\t\t\t\t\tgantt.$container.setAttribute(\"tabindex\", \"0\");\n\n\t\t\t\t}else{\n\t\t\t\t\tgantt.$container.removeAttribute(\"tabindex\");\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tfunction getTaskNodeConstructor(){\n\t\t\t\tif (gantt.config.keyboard_navigation_cells) {\n\t\t\t\t\treturn gantt.$keyboardNavigation.TaskCell;\n\t\t\t\t} else {\n\t\t\t\t\treturn gantt.$keyboardNavigation.TaskRow;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction isInlineEditorCell(e){\n\t\t\t\treturn !!domHelpers.closest(e.target, \".gantt_grid_editor_placeholder\");\n\t\t\t}\n\t\t\t// GS-1445. Cancel keyboard navigation within custom elements\n\t\t\tfunction isNoKeyboardNavigationElement(e){\n\t\t\t\treturn !!domHelpers.closest(e.target, \".no_keyboard_navigation\");\n\t\t\t}\n\t\t\tfunction isLightboxElement(e){\n\t\t\t\treturn !!domHelpers.closest(e.target, \".gantt_cal_light\");\n\t\t\t}\n\n\t\t\tfunction mousedownHandler(e){\n\t\t\t\tif(!gantt.config.keyboard_navigation) return true;\n\t\t\t\t// GS-734 & GS-1078: we don't need keyboard navigation inside inline editors\n\t\t\t\tif(!gantt.config.keyboard_navigation_cells && isInlineEditorCell(e)) return true;\n\n\t\t\t\tif (isNoKeyboardNavigationElement(e)){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tvar focusNode;\n\t\t\t\tvar locateTask = dispatcher.fromDomElement(e);\n\t\t\t\tif(locateTask){\n\t\t\t\t\t//var node = getTaskNodeConstructor();\n\t\t\t\t\tif(dispatcher.activeNode instanceof gantt.$keyboardNavigation.TaskCell && domHelpers.isChildOf(e.target, gantt.$task)){\n\t\t\t\t\t\tlocateTask = new gantt.$keyboardNavigation.TaskCell(locateTask.taskId, dispatcher.activeNode.columnIndex);\n\t\t\t\t\t}\n\t\t\t\t\tfocusNode = locateTask;\n\t\t\t\t\t// GS-1541 and GS-1542. If you click on the task row element (possible with custom styles)\n\t\t\t\t\t// or the task bar element, there is no information about the target grid cell,\n\t\t\t\t\t// so we need to set focus on the first visible cell\n\t\t\t\t\tconst visibleGrid = gantt.config.show_grid && gantt.$ui.getView(\"grid\");\n\t\t\t\t\tif(visibleGrid && gantt.config.keyboard_navigation_cells){\n\t\t\t\t\t\tconst taskRow = e.target.classList.contains(\"gantt_row\");\n\t\t\t\t\t\tconst taskBar = e.target.closest(\".gantt_task_line\");\n\n\t\t\t\t\t\tconst gridLeft = gantt.utils.dom.getNodePosition(gantt.$grid).x;\n\t\t\t\t\t\tconst gridRight = gridLeft + gantt.$grid.offsetWidth;\n\t\t\t\t\t\tconst nodePosition = gantt.utils.dom.getNodePosition(document.activeElement).x;\n\t\t\t\t\t\tconst nodeHidden = nodePosition < gridLeft || gridRight < nodePosition;\n\n\t\t\t\t\t\tif (taskRow || (taskBar && nodeHidden)){\n\t\t\t\t\t\t\tlet scrollPosition = gantt.$grid.scrollLeft;\n\t\t\t\t\t\t\tconst rightPosition = scrollPosition + gantt.$grid.offsetWidth;\n\t\t\t\t\t\t\tlet positionX = 0;\n\t\t\t\t\t\t\tif (taskRow){\n\t\t\t\t\t\t\t\tscrollPosition = gantt.utils.dom.getRelativeEventPosition(e, gantt.$grid).x;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tfor (let i = 0; i < gantt.config.columns.length; i++) {\n\t\t\t\t\t\t\t\tconst column = gantt.config.columns[i];\n\t\t\t\t\t\t\t\tif (column.hide){\n\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tpositionX += column.width;\n\t\t\t\t\t\t\t\tif (scrollPosition < positionX){\n\t\t\t\t\t\t\t\t\tif (rightPosition < positionX){\n\t\t\t\t\t\t\t\t\t\tpositionX -= column.width;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tfocusNode.columnIndex = i;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (focusNode) {\n\t\t\t\t\tif (!dispatcher.isEnabled()) {\n\t\t\t\t\t\tdispatcher.activeNode = focusNode;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdispatcher.delay(function () {\n\t\t\t\t\t\t\tdispatcher.setActiveNode(focusNode);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// empty click should drop focus from gantt, insert of reselecting default node\n\t\t\t\t\tdispatcher.$preventDefault = true;\n\t\t\t\t\tsetTimeout(function(){\n\t\t\t\t\t\tdispatcher.$preventDefault = false;\n\t\t\t\t\t}, 300);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar onReady = gantt.attachEvent(\"onGanttReady\", function(){\n\t\t\t\t// restore focus on repainted tasks\n\t\t\t\tgantt.detachEvent(onReady);\n\n\t\t\t\tgantt.$data.tasksStore.attachEvent(\"onStoreUpdated\", function(id){\n\t\t\t\t\tif (gantt.config.keyboard_navigation && dispatcher.isEnabled()) {\n\t\t\t\t\t\tconst currentNode = dispatcher.getActiveNode();\n\t\t\t\t\t\tconst grid = gantt.$ui.getView(\"grid\");\n\t\t\t\t\t\tif (!grid || !grid.$grid_data){\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst top = grid.getItemTop(id);\n\t\t\t\t\t\tconst gridDataTopScroll = grid.$grid_data.scrollTop;\n\t\t\t\t\t\tconst gridDataBottomScroll = gridDataTopScroll + grid.$grid_data.getBoundingClientRect().height;\n\t\t\t\t\t\tif(currentNode && currentNode.taskId == id){\n\t\t\t\t\t\t\t// GS-2539: Don't refocus the node if it is selected and outside the visible range in the grid\n\t\t\t\t\t\t\tif(gridDataTopScroll <= top && gridDataBottomScroll >= top){\n\t\t\t\t\t\t\t\treFocusActiveNode();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif(gantt._smart_render){\n\t\t\t\t\tvar updateRender = gantt._smart_render._redrawTasks;\n\t\t\t\t\tgantt._smart_render._redrawTasks = function(renderers, items){\n\t\t\t\t\t\tif(gantt.config.keyboard_navigation && dispatcher.isEnabled()){\n\t\t\t\t\t\t\tvar currentNode = dispatcher.getActiveNode();\n\t\t\t\t\t\t\tif(currentNode && currentNode.taskId !== undefined){\n\t\t\t\t\t\t\t\tvar focusedItemVisible = false;\n\t\t\t\t\t\t\t\tfor(var i = 0; i < items.length; i++){\n\t\t\t\t\t\t\t\t\tif(items[i].id == currentNode.taskId && items[i].start_date){\n\t\t\t\t\t\t\t\t\t\tfocusedItemVisible = true;\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif(!focusedItemVisible){\n\t\t\t\t\t\t\t\t\titems.push(gantt.getTask(currentNode.taskId));\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar res = updateRender.apply(this, arguments);\n\n\t\t\t\t\t\treturn res;\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t});\n\n\n\t\t\tlet createdTaskId = null;\n\t\t\tlet keepFocusOnNewTask = false;\n\t\t\tgantt.attachEvent(\"onTaskCreated\", function (task) {\n\t\t\t\tcreatedTaskId = task.id;\n\t\t\t\treturn true;\n\t\t\t});\n\n\t\t\tgantt.attachEvent(\"onAfterTaskAdd\", function(id,item){\n\t\t\t\tif(!gantt.config.keyboard_navigation) return true;\n\t\t\t\tif(dispatcher.isEnabled()){\n\n\t\t\t\t\t// GS-1394. After adding a new task, the focus shouldn't change to the placeholder task\n\t\t\t\t\tif (id == createdTaskId) {\n\t\t\t\t\t\tkeepFocusOnNewTask = true;\n\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\tkeepFocusOnNewTask = false;\n\t\t\t\t\t\t\tcreatedTaskId = null;\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tif (keepFocusOnNewTask && item.type == gantt.config.types.placeholder) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar columnIndex = 0;\n\t\t\t\t\tvar node = dispatcher.activeNode;\n\t\t\t\t\tif(node instanceof gantt.$keyboardNavigation.TaskCell){\n\t\t\t\t\t\tcolumnIndex = node.columnIndex;\n\t\t\t\t\t}\n\t\t\t\t\tvar nodeConstructor = getTaskNodeConstructor();\n\n\t\t\t\t\tif (item.type == gantt.config.types.placeholder && gantt.config.placeholder_task.focusOnCreate === false) {\n\t\t\t\t\t\t// do not focus on the placeholder task\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdispatcher.setActiveNode(new nodeConstructor(id, columnIndex));\n\t\t\t\t\t}\n\n\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tgantt.attachEvent(\"onTaskIdChange\", function(oldId, newId){\n\t\t\t\tif(!gantt.config.keyboard_navigation) return true;\n\n\t\t\t\tvar node = dispatcher.activeNode;\n\t\t\t\tif(dispatcher.isTaskFocused(oldId)){\n\t\t\t\t\tnode.taskId = newId;\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\t\t\t});\n\n\t\t\tvar interval = setInterval(function(){\n\t\t\t\tif(!gantt.config.keyboard_navigation) return;\n\t\t\t\tif(!dispatcher.isEnabled()){\n\t\t\t\t\tdispatcher.enable();\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}, 500);\n\n\t\t\tgantt.attachEvent(\"onDestroy\", function(){\n\t\t\t\tclearInterval(interval);\n\t\t\t});\n\n\t\t\tfunction getScopeName(obj){\n\t\t\t\tif(obj instanceof gantt.$keyboardNavigation.GanttNode){\n\t\t\t\t\treturn \"gantt\";\n\t\t\t\t}else if(obj instanceof gantt.$keyboardNavigation.HeaderCell){\n\t\t\t\t\treturn \"headerCell\";\n\t\t\t\t}else if(obj instanceof gantt.$keyboardNavigation.TaskRow){\n\t\t\t\t\treturn \"taskRow\";\n\t\t\t\t}else if(obj instanceof gantt.$keyboardNavigation.TaskCell){\n\t\t\t\t\treturn \"taskCell\";\n\t\t\t\t}\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tfunction getScope(mode){\n\t\t\t\tvar scopes = {\n\t\t\t\t\t\"gantt\":gantt.$keyboardNavigation.GanttNode,\n\t\t\t\t\t\"headerCell\": gantt.$keyboardNavigation.HeaderCell,\n\t\t\t\t\t\"taskRow\": gantt.$keyboardNavigation.TaskRow,\n\t\t\t\t\t\"taskCell\": gantt.$keyboardNavigation.TaskCell\n\t\t\t\t};\n\n\t\t\t\treturn scopes[mode] || scopes.gantt;\n\t\t\t}\n\n\t\t\tfunction findVisibleColumnIndex(columnName) {\n\t\t\t\tvar columns = gantt.getGridColumns();\n\t\t\t\tfor (var i = 0; i < columns.length; i++){\n\t\t\t\t\tif(columns[i].name == columnName){\n\t\t\t\t\t\treturn i;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t\tvar keyNavFacade = {};\n\t\t\teventable(keyNavFacade);\n\t\t\tgantt.mixin(keyNavFacade, {\n\t\t\t\taddShortcut: function(shortcut, handler, scope){\n\t\t\t\t\tvar scopeObject = getScope(scope);\n\t\t\t\t\tif(scopeObject){\n\t\t\t\t\t\tscopeObject.prototype.bind(shortcut, handler);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tgetShortcutHandler: function(shortcut, scope){\n\t\t\t\t\tvar commands = gantt.$keyboardNavigation.shortcuts.parse(shortcut);\n\t\t\t\t\tif(commands.length){\n\t\t\t\t\t\treturn keyNavFacade.getCommandHandler(commands[0], scope);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tgetCommandHandler: function(command, scope){\n\t\t\t\t\tvar scopeObject = getScope(scope);\n\t\t\t\t\tif(scopeObject){\n\t\t\t\t\t\tif(command){\n\t\t\t\t\t\t\treturn scopeObject.prototype.findHandler(command);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tremoveShortcut: function(shortcut, scope){\n\t\t\t\t\tvar scopeObject = getScope(scope);\n\t\t\t\t\tif(scopeObject){\n\t\t\t\t\t\tscopeObject.prototype.unbind(shortcut);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tfocus: function(config){\n\t\t\t\t\tvar type = config ? config.type : null;\n\t\t\t\t\tvar constructor = getScope(type);\n\t\t\t\t\tvar node;\n\t\t\t\t\tswitch (type){\n\t\t\t\t\t\tcase \"taskCell\":\n\t\t\t\t\t\t\tnode = new constructor(config.id, findVisibleColumnIndex(config.column));\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"taskRow\":\n\t\t\t\t\t\t\tnode = new constructor(config.id);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"headerCell\":\n\t\t\t\t\t\t\tnode = new constructor(findVisibleColumnIndex(config.column));\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tdispatcher.delay(function(){\n\t\t\t\t\t\tif(node){\n\t\t\t\t\t\t\tdispatcher.setActiveNode(node);\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tdispatcher.enable();\n\t\t\t\t\t\t\tif(!dispatcher.getActiveNode()){\n\n\t\t\t\t\t\t\t\tdispatcher.setDefaultNode();\n\t\t\t\t\t\t\t}else{\n\n\t\t\t\t\t\t\t\tif(!dispatcher.awaitsFocus()){\n\t\t\t\t\t\t\t\t\tdispatcher.enable();\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t});\n\t\t\t\t},\n\n\t\t\t\tgetActiveNode: function(){\n\t\t\t\t\tif(dispatcher.isEnabled()){\n\t\t\t\t\t\tvar node = dispatcher.getActiveNode();\n\t\t\t\t\t\tvar scope = getScopeName(node);\n\t\t\t\t\t\tvar columns = gantt.getGridColumns();\n\t\t\t\t\t\tswitch (scope){\n\t\t\t\t\t\t\tcase \"taskCell\":\n\t\t\t\t\t\t\t\treturn {type:\"taskCell\", id:node.taskId, column:columns[node.columnIndex].name};\n\t\t\t\t\t\t\tcase \"taskRow\":\n\t\t\t\t\t\t\t\treturn {type:\"taskRow\", id:node.taskId};\n\t\t\t\t\t\t\tcase \"headerCell\":\n\t\t\t\t\t\t\t\treturn {type:\"headerCell\", column:columns[node.index].name};\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tgantt.$keyboardNavigation.facade = keyNavFacade;\n\n\t\t\tgantt.ext.keyboardNavigation = keyNavFacade;\n\t\t\tgantt.focus = function(){\n\t\t\t\tkeyNavFacade.focus();\n\t\t\t};\n\t\t\tgantt.addShortcut = keyNavFacade.addShortcut;\n\t\t\tgantt.getShortcutHandler = keyNavFacade.getShortcutHandler;\n\t\t\tgantt.removeShortcut = keyNavFacade.removeShortcut;\n\t\t})();\n\n\n\t}\n\n\tsetupKeyNav(gantt);\n\n\n\n};","export default function(gantt) {\n\n\tgantt.$keyboardNavigation.shortcuts = {\n\t\tcreateCommand: function () {\n\t\t\treturn {\n\t\t\t\tmodifiers: {\n\t\t\t\t\t\"shift\": false,\n\t\t\t\t\t\"alt\": false,\n\t\t\t\t\t\"ctrl\": false,\n\t\t\t\t\t\"meta\": false\n\t\t\t\t},\n\t\t\t\tkeyCode: null\n\t\t\t};\n\t\t},\n\t\tparse: function (shortcut) {\n\t\t\tvar commands = [];\n\n\t\t\tvar expr = this.getExpressions(this.trim(shortcut));\n\t\t\tfor (var i = 0; i < expr.length; i++) {\n\t\t\t\tvar words = this.getWords(expr[i]);\n\n\t\t\t\tvar command = this.createCommand();\n\n\t\t\t\tfor (var j = 0; j < words.length; j++) {\n\t\t\t\t\tif (this.commandKeys[words[j]]) {\n\t\t\t\t\t\tcommand.modifiers[words[j]] = true;\n\t\t\t\t\t} else if (this.specialKeys[words[j]]) {\n\t\t\t\t\t\tcommand.keyCode = this.specialKeys[words[j]];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcommand.keyCode = words[j].charCodeAt(0);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tcommands.push(command);\n\t\t\t}\n\t\t\treturn commands;\n\t\t},\n\n\t\tgetCommandFromEvent: function (domEvent) {\n\t\t\tvar command = this.createCommand();\n\t\t\tcommand.modifiers.shift = !!domEvent.shiftKey;\n\t\t\tcommand.modifiers.alt = !!domEvent.altKey;\n\t\t\tcommand.modifiers.ctrl = !!domEvent.ctrlKey;\n\t\t\tcommand.modifiers.meta = !!domEvent.metaKey;\n\t\t\tcommand.keyCode = domEvent.which || domEvent.keyCode;\n\n\t\t\tif(command.keyCode >= 96 && command.keyCode <= 105){\n\t\t\t\t// numpad keys 96-105 -> 48-57\n\t\t\t\tcommand.keyCode -= 48;//convert numpad  number code to regular number code\n\t\t\t}\n\n\t\t\tvar printableKey = String.fromCharCode(command.keyCode);\n\t\t\tif (printableKey) {\n\t\t\t\tcommand.keyCode = printableKey.toLowerCase().charCodeAt(0);\n\t\t\t}\n\t\t\treturn command;\n\t\t},\n\n\t\tgetHashFromEvent: function (domEvent) {\n\t\t\treturn this.getHash(this.getCommandFromEvent(domEvent));\n\t\t},\n\n\t\tgetHash: function (command) {\n\t\t\tvar parts = [];\n\t\t\tfor (var i in command.modifiers) {\n\t\t\t\tif (command.modifiers[i]) {\n\t\t\t\t\tparts.push(i);\n\t\t\t\t}\n\t\t\t}\n\t\t\tparts.push(command.keyCode);\n\n\t\t\treturn parts.join(this.junctionChar);\n\t\t},\n\n\t\tgetExpressions: function (shortcut) {\n\t\t\treturn shortcut.split(this.junctionChar);\n\t\t},\n\t\tgetWords: function (term) {\n\t\t\treturn term.split(this.combinationChar);\n\t\t},\n\t\ttrim: function (shortcut) {\n\t\t\treturn shortcut.replace(/\\s/g, \"\");\n\t\t},\n\t\tjunctionChar: \",\",\n\t\tcombinationChar: \"+\",\n\t\tcommandKeys: {\n\t\t\t\"shift\": 16,\n\t\t\t\"alt\": 18,\n\t\t\t\"ctrl\": 17,\n\t\t\t\"meta\": true\n\t\t},\n\t\tspecialKeys: {\n\t\t\t\"backspace\": 8,\n\t\t\t\"tab\": 9,\n\t\t\t\"enter\": 13,\n\t\t\t\"esc\": 27,\n\t\t\t\"space\": 32,\n\t\t\t\"up\": 38,\n\t\t\t\"down\": 40,\n\t\t\t\"left\": 37,\n\t\t\t\"right\": 39,\n\t\t\t\"home\": 36,\n\t\t\t\"end\": 35,\n\t\t\t\"pageup\": 33,\n\t\t\t\"pagedown\": 34,\n\t\t\t\"delete\": 46,\n\t\t\t\"insert\": 45,\n\t\t\t\"plus\": 107,\n\t\t\t\"f1\": 112,\n\t\t\t\"f2\": 113,\n\t\t\t\"f3\": 114,\n\t\t\t\"f4\": 115,\n\t\t\t\"f5\": 116,\n\t\t\t\"f6\": 117,\n\t\t\t\"f7\": 118,\n\t\t\t\"f8\": 119,\n\t\t\t\"f9\": 120,\n\t\t\t\"f10\": 121,\n\t\t\t\"f11\": 122,\n\t\t\t\"f12\": 123\n\t\t}\n\t};\n};","export default function(gantt) {\n\n\tgantt.$keyboardNavigation.EventHandler = {\n\t\t_handlers: null,\n\t\tfindHandler: function (command) {\n\t\t\tif (!this._handlers) this._handlers = {};\n\t\t\tvar shortcuts = gantt.$keyboardNavigation.shortcuts;\n\t\t\tvar hash = shortcuts.getHash(command);\n\n\t\t\treturn this._handlers[hash];\n\t\t},\n\n\t\tdoAction: function (command, e) {\n\t\t\tvar handler = this.findHandler(command);\n\t\t\tif (handler) {\n\t\t\t\tvar eventFacade = gantt.$keyboardNavigation.facade;\n\n\t\t\t\tif(eventFacade.callEvent(\"onBeforeAction\", [command, e]) === false){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\thandler.call(this, e);\n\n\t\t\t\tif (e.preventDefault) e.preventDefault();\n\t\t\t\telse e.returnValue = false;\n\n\t\t\t}\n\t\t},\n\t\tbind: function (shortcut, handler) {\n\t\t\tif (!this._handlers) this._handlers = {};\n\n\t\t\tvar shortcuts = gantt.$keyboardNavigation.shortcuts;\n\n\t\t\tvar commands = shortcuts.parse(shortcut);\n\t\t\tfor (var i = 0; i < commands.length; i++) {\n\t\t\t\tthis._handlers[shortcuts.getHash(commands[i])] = handler;\n\t\t\t}\n\t\t},\n\t\tunbind: function (shortcut) {\n\t\t\tvar shortcuts = gantt.$keyboardNavigation.shortcuts;\n\n\t\t\tvar commands = shortcuts.parse(shortcut);\n\t\t\tfor (var i = 0; i < commands.length; i++) {\n\t\t\t\tif (this._handlers[shortcuts.getHash(commands[i])]) {\n\t\t\t\t\tdelete this._handlers[shortcuts.getHash(commands[i])];\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\tbindAll: function (map) {\n\t\t\tfor (var i in map) {\n\t\t\t\tthis.bind(i, map[i]);\n\t\t\t}\n\t\t},\n\t\tinitKeys: function () {\n\t\t\tif (!this._handlers)\n\t\t\t\tthis._handlers = {};\n\t\t\tif (this.keys) {\n\t\t\t\tthis.bindAll(this.keys);\n\t\t\t}\n\t\t}\n\t};\n\n};","import * as domHelpers from \"../../../core/ui/utils/dom_helpers\";\n\nexport default function(gantt) {\n\n\t(function () {\n\t\t\n\t\tgantt.$keyboardNavigation.getFocusableNodes = domHelpers.getFocusableNodes;\n\n\t\tgantt.$keyboardNavigation.trapFocus = function trapFocus(root, e) {\n\t\t\tif (e.keyCode != 9) return false;\n\n\t\t\tvar focusable = gantt.$keyboardNavigation.getFocusableNodes(root);\n\t\t\tvar currentFocus = domHelpers.getActiveElement();\n\t\t\tvar currentIndex = -1;\n\t\t\tfor (var i = 0; i < focusable.length; i++) {\n\t\t\t\tif (focusable[i] == currentFocus) {\n\t\t\t\t\tcurrentIndex = i;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (e.shiftKey) {\n\t\t\t\t// back tab\n\t\t\t\tif (currentIndex <= 0) {\n\t\t\t\t\t// go to the last element if we focused on the first\n\t\t\t\t\tvar lastItem = focusable[focusable.length - 1];\n\t\t\t\t\tif (lastItem) {\n\t\t\t\t\t\tlastItem.focus();\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t} else {\n\t\t\t\t// forward tab\n\t\t\t\tif (currentIndex >= focusable.length - 1) {\n\t\t\t\t\t// forward tab from last element should go back to the first element\n\t\t\t\t\tvar firstItem = focusable[0];\n\t\t\t\t\tif (firstItem) {\n\t\t\t\t\t\tfirstItem.focus();\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn false;\n\t\t};\n\t})();\n\n};","export default function(gantt) {\n\n\tgantt.$keyboardNavigation.GanttNode = function () {\n\t};\n\n\tgantt.$keyboardNavigation.GanttNode.prototype = gantt._compose(\n\t\tgantt.$keyboardNavigation.EventHandler,\n\t\t{\n\n\t\t\tfocus: function () {\n\t\t\t\tgantt.focus();\n\t\t\t},\n\n\t\t\tblur: function () {\n\n\t\t\t},\n\n\t\t\tisEnabled: function () {\n\t\t\t\treturn gantt.$container.hasAttribute(\"tabindex\");\n\t\t\t},\n\n\t\t\tscrollHorizontal: function scrollHorizontal(dir) {\n\t\t\t\tvar date = gantt.dateFromPos(gantt.getScrollState().x);\n\t\t\t\tvar scale = gantt.getScale();\n\t\t\t\tvar step = dir < 0 ? -scale.step : scale.step;\n\t\t\t\tdate = gantt.date.add(date, step, scale.unit);\n\t\t\t\tgantt.scrollTo(gantt.posFromDate(date));\n\t\t\t},\n\n\t\t\tscrollVertical: function scrollVertical(dir) {\n\t\t\t\tvar top = gantt.getScrollState().y;\n\t\t\t\tvar step = gantt.config.row_height;\n\t\t\t\tgantt.scrollTo(null, top + (dir < 0 ? -1 : 1) * step);\n\t\t\t},\n\n\t\t\tkeys: {\n\t\t\t\t\"alt+left\": function (e) {\n\t\t\t\t\tthis.scrollHorizontal(-1);\n\t\t\t\t},\n\t\t\t\t\"alt+right\": function (e) {\n\t\t\t\t\tthis.scrollHorizontal(1);\n\t\t\t\t},\n\t\t\t\t\"alt+up\": function (e) {\n\t\t\t\t\tthis.scrollVertical(-1);\n\t\t\t\t},\n\t\t\t\t\"alt+down\": function (e) {\n\t\t\t\t\tthis.scrollVertical(1);\n\t\t\t\t},\n\n\t\t\t\t// undo\n\t\t\t\t\"ctrl+z\": function () {\n\t\t\t\t\tif (gantt.undo) gantt.undo();\n\t\t\t\t},\n\n\t\t\t\t// redo\n\t\t\t\t\"ctrl+r\": function () {\n\t\t\t\t\tif (gantt.redo) gantt.redo();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t);\n\n\tgantt.$keyboardNavigation.GanttNode.prototype.bindAll(gantt.$keyboardNavigation.GanttNode.prototype.keys);\n\n};","export default function(gantt) {\n\n\tgantt.$keyboardNavigation.KeyNavNode = function () {\n\t};\n\n\tgantt.$keyboardNavigation.KeyNavNode.prototype = gantt._compose(\n\t\tgantt.$keyboardNavigation.EventHandler,\n\t\t{\n\t\t\tisValid: function () {\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tfallback: function () {\n\t\t\t\treturn null;\n\t\t\t},\n\n\t\t\tmoveTo: function (element) {\n\t\t\t\tgantt.$keyboardNavigation.dispatcher.setActiveNode(element);\n\t\t\t},\n\n\t\t\tcompareTo: function (b) {\n\t\t\t\t// good enough comparison of two random objects\n\t\t\t\tif (!b) return false;\n\t\t\t\tfor (var i in this) {\n\t\t\t\t\tif (!!this[i] != !!b[i]) return false;\n\n\t\t\t\t\tvar canStringifyThis = !!(this[i] && this[i].toString);\n\t\t\t\t\tvar canStringifyThat = !!(b[i] && b[i].toString);\n\t\t\t\t\tif (canStringifyThat != canStringifyThis) return false;\n\t\t\t\t\tif (!(canStringifyThat && canStringifyThis)) {\n\t\t\t\t\t\tif (b[i] != this[i]) return false;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (b[i].toString() != this[i].toString())\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t},\n\n\t\t\tgetNode: function () {\n\t\t\t},\n\t\t\tfocus: function () {\n\t\t\t\tvar node = this.getNode();\n\t\t\t\tif(!node)\n\t\t\t\t\treturn;\n\n\t\t\t\tvar eventFacade = gantt.$keyboardNavigation.facade;\n\n\t\t\t\tif(eventFacade.callEvent(\"onBeforeFocus\", [node]) === false){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (node) {\n\t\t\t\t\tnode.setAttribute(\"tabindex\", \"-1\");\n\t\t\t\t\tif(!node.$eventAttached){\n\t\t\t\t\t\tnode.$eventAttached = true;\n\t\t\t\t\t\tgantt.event(node, \"focus\",function(e){\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}, false);\n\t\t\t\t\t}\n\t\t\t\t\t//node.className += \" gantt_focused\";\n\t\t\t\t\tif (gantt.utils.dom.isChildOf(document.activeElement, node)){\n\t\t\t\t\t\tnode = document.activeElement;\n\t\t\t\t\t}\n\t\t\t\t\tif (node.focus) node.focus();\n\n\t\t\t\t\teventFacade.callEvent(\"onFocus\", [this.getNode()]);\n\t\t\t\t}\n\n\t\t\t},\n\t\t\tblur: function () {\n\t\t\t\tvar node = this.getNode();\n\t\t\t\tif (node) {\n\t\t\t\t\tvar eventFacade = gantt.$keyboardNavigation.facade;\n\t\t\t\t\teventFacade.callEvent(\"onBlur\", [node]);\n\t\t\t\t\tnode.setAttribute(\"tabindex\", \"-1\");\n\t\t\t\t\t//node.className = (node.className || \"\").replace(/ ?gantt_focused/g, \"\");\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t);\n\n};","import * as domHelpers from \"../../../core/ui/utils/dom_helpers\";\n\nexport default function(gantt) {\n\n\tgantt.$keyboardNavigation.HeaderCell = function (index) {\n\t\tthis.index = index || 0;\n\t};\n\n\tgantt.$keyboardNavigation.HeaderCell.prototype = gantt._compose(\n\t\tgantt.$keyboardNavigation.KeyNavNode,\n\t\t{\n\t\t\t_handlers: null,\n\n\t\t\tisValid: function () {\n\t\t\t\tif (!gantt.config.show_grid) {\n\t\t\t\t\tif (gantt.getVisibleTaskCount())\n\t\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\treturn !!gantt.getGridColumns()[this.index] || !gantt.getVisibleTaskCount();\n\t\t\t},\n\t\t\tfallback: function () {\n\t\t\t\tif (!gantt.config.show_grid) {\n\t\t\t\t\tif (gantt.getVisibleTaskCount()) {\n\t\t\t\t\t\treturn new gantt.$keyboardNavigation.TaskRow();\n\t\t\t\t\t}\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\tvar visibleColumns = gantt.getGridColumns();\n\t\t\t\tvar index = this.index;\n\t\t\t\twhile (index >= 0) {\n\t\t\t\t\tif (visibleColumns[index])\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tindex--;\n\t\t\t\t}\n\t\t\t\tif (visibleColumns[index]) {\n\t\t\t\t\treturn new gantt.$keyboardNavigation.HeaderCell(index);\n\t\t\t\t} else {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tfromDomElement: function(el){\n\t\t\t\tvar cellElement = domHelpers.locateClassName(el, \"gantt_grid_head_cell\");\n\t\t\t\tif(cellElement){\n\t\t\t\t\tvar index = 0;\n\t\t\t\t\twhile(cellElement && cellElement.previousSibling){\n\t\t\t\t\t\tcellElement = cellElement.previousSibling;\n\t\t\t\t\t\tindex += 1;\n\t\t\t\t\t}\n\t\t\t\t\treturn new gantt.$keyboardNavigation.HeaderCell(index);\n\t\t\t\t}else{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tgetNode: function () {\n\t\t\t\tconst scale = gantt.$grid_scale;\n\t\t\t\tif (!scale){\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\tconst cells = scale.childNodes;\n\t\t\t\treturn cells[this.index];\n\t\t\t},\n\n\n\t\t\tkeys: {\n\n\t\t\t\t\"left\": function () {\n\t\t\t\t\tif (this.index > 0) {\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.HeaderCell(this.index - 1));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"right\": function () {\n\t\t\t\t\tvar columns = gantt.getGridColumns();\n\t\t\t\t\tif (this.index < columns.length - 1) {\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.HeaderCell(this.index + 1));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"down\": function () {\n\t\t\t\t\tvar taskRow;\n\t\t\t\t\tvar rootLevel = gantt.getChildren(gantt.config.root_id);\n\t\t\t\t\tif (gantt.isTaskExists(rootLevel[0])) {\n\t\t\t\t\t\ttaskRow = rootLevel[0];\n\t\t\t\t\t}\n\t\t\t\t\tif (taskRow) {\n\t\t\t\t\t\tif (gantt.config.keyboard_navigation_cells) {\n\t\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskCell(taskRow, this.index));\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskRow(taskRow));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\t\"end\": function () {\n\t\t\t\t\tvar columns = gantt.getGridColumns();\n\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.HeaderCell(columns.length - 1));\n\t\t\t\t},\n\t\t\t\t\"home\": function () {\n\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.HeaderCell(0));\n\t\t\t\t},\n\n\n\t\t\t\t// press header button\n\t\t\t\t\"enter, space\": function () {\n\t\t\t\t\tvar node = domHelpers.getActiveElement();\n\t\t\t\t\tnode.click();\n\t\t\t\t},\n\n\t\t\t\t// add new task\n\t\t\t\t\"ctrl+enter\": function () {\n\t\t\t\t\tif (gantt.isReadonly(this)) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tgantt.createTask({}, this.taskId);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t);\n\n\tgantt.$keyboardNavigation.HeaderCell.prototype.bindAll(gantt.$keyboardNavigation.HeaderCell.prototype.keys);\n\n};","export default function(gantt) {\n\n\tgantt.$keyboardNavigation.TaskRow = function (taskId) {\n\t\tif (!taskId) {\n\t\t\tvar rootLevel = gantt.getChildren(gantt.config.root_id);\n\t\t\tif (rootLevel[0]) {\n\t\t\t\ttaskId = rootLevel[0];\n\t\t\t}\n\t\t}\n\t\tthis.taskId = taskId;\n\t\tif (gantt.isTaskExists(this.taskId)) {\n\t\t\tthis.index = gantt.getTaskIndex(this.taskId);\n\t\t\tthis.globalIndex = gantt.getGlobalTaskIndex(this.taskId);\n\t\t\tthis.splitItem = !!gantt.getTask(this.taskId).$split_subtask;\n\t\t\tthis.parentId = gantt.getParent(this.taskId);\n\t\t}\n\t};\n\n\tgantt.$keyboardNavigation.TaskRow.prototype = gantt._compose(\n\t\tgantt.$keyboardNavigation.KeyNavNode,\n\t\t{\n\t\t\t_handlers: null,\n\t\t\tisValid: function () {\n\t\t\t\treturn gantt.isTaskExists(this.taskId) && (gantt.getTaskIndex(this.taskId) > -1);\n\t\t\t},\n\t\t\tfallback: function () {\n\t\t\t\tif (!gantt.getVisibleTaskCount()) {\n\t\t\t\t\tvar header = new gantt.$keyboardNavigation.HeaderCell();\n\t\t\t\t\tif (!header.isValid()) return null;\n\t\t\t\t\telse return header;\n\t\t\t\t} else {\n\n\t\t\t\t\tif(!this.splitItem){\n\t\t\t\t\t\tvar nextIndex = -1;\n\t\t\t\t\t\t// GS-1393. When Gantt tries to restore the focus, it should rely on the global index\n\t\t\t\t\t\tif (gantt.getTaskByIndex(this.globalIndex - 1)) {\n\t\t\t\t\t\t\tnextIndex = this.globalIndex - 1;\n\t\t\t\t\t\t} else if (gantt.getTaskByIndex(this.globalIndex + 1)) {\n\t\t\t\t\t\t\tnextIndex = this.globalIndex + 1;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvar globalIndex = this.globalIndex;\n\t\t\t\t\t\t\twhile (globalIndex >= 0) {\n\t\t\t\t\t\t\t\tif (gantt.getTaskByIndex(globalIndex)) {\n\t\t\t\t\t\t\t\t\tnextIndex = globalIndex;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tglobalIndex--;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (nextIndex > -1) {\n\t\t\t\t\t\t\treturn new gantt.$keyboardNavigation.TaskRow(gantt.getTaskByIndex(nextIndex).id);\n\t\t\t\t\t\t}\n\t\t\t\t\t}else {\n\t\t\t\t\t\treturn new gantt.$keyboardNavigation.TaskRow(this.parentId);\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tfromDomElement: function(el){\n\t\t\t\tif(gantt.config.keyboard_navigation_cells){\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tvar taskId = gantt.locate(el);\n\t\t\t\tif(gantt.isTaskExists(taskId)){\n\t\t\t\t\treturn new gantt.$keyboardNavigation.TaskRow(taskId);\n\t\t\t\t}else{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tgetNode: function () {\n\t\t\t\tif (gantt.isTaskExists(this.taskId) && gantt.isTaskVisible(this.taskId)) {\n\t\t\t\t\tif (gantt.config.show_grid) {\n\t\t\t\t\t\treturn gantt.$grid.querySelector(`.gantt_row[${gantt.config.task_attribute}=\"${String(this.taskId).replaceAll('\"', '\\\\\"')}\"]`);\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn gantt.getTaskNode(this.taskId);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tfocus: function (keptFocus) {\n\t\t\t\tif(!keptFocus) {\n\t\t\t\t\tconst pos = gantt.getTaskPosition(gantt.getTask(this.taskId));\n\t\t\t\t\tconst height = gantt.getTaskHeight(this.taskId);\n\t\t\t\t\tconst scroll = gantt.getScrollState();\n\n\t\t\t\t\tlet viewWidth;\n\t\t\t\t\tif(gantt.$task){\n\t\t\t\t\t\tviewWidth = gantt.$task.offsetWidth;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tviewWidth = scroll.inner_width;\n\t\t\t\t\t}\n\n\t\t\t\t\tlet viewHeight;\n\t\t\t\t\tif(gantt.$grid_data || gantt.$task_data){\n\t\t\t\t\t\tviewHeight = (gantt.$grid_data || gantt.$task_data).offsetHeight;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tviewHeight = scroll.inner_height;\n\t\t\t\t\t}\n\t\t\t\t\tconst visibleTimeline = gantt.config.show_chart && gantt.$ui.getView(\"timeline\");\n\n\t\t\t\t\tif (pos.top < scroll.y || pos.top + height > (scroll.y + viewHeight)) {\n\t\t\t\t\t\t// GS-2346: additional scrolling to be sure that the task will be in the required range\n\t\t\t\t\t\tgantt.scrollTo(null, pos.top - 20);\n\t\t\t\t\t} else if (gantt.config.scroll_on_click && visibleTimeline) {\n\t\t\t\t\t\t// horizontal scroll activated\n\t\t\t\t\t\tif (pos.left > (scroll.x + viewWidth)) { // scroll forward to the start of the task\n\t\t\t\t\t\t\tgantt.scrollTo(pos.left - gantt.config.task_scroll_offset);\n\t\t\t\t\t\t} else if (pos.left + pos.width < scroll.x) {  // scroll back to the end of the task\n\t\t\t\t\t\t\tgantt.scrollTo(pos.left + pos.width - gantt.config.task_scroll_offset);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tgantt.$keyboardNavigation.KeyNavNode.prototype.focus.apply(this, [keptFocus]);\n\n\t\t\t\t// GS-152 if there are scrollbars with custom names, change their scroll position\n\t\t\t\tscrollGrid();\n\n\t\t\t\tfunction scrollGrid() {\n\t\t\t\t\tvar grid = gantt.$ui.getView(\"grid\");\n\t\t\t\t\tif (!grid || !grid.$grid_data){\n\t\t\t\t\t\t// GS-1805. Don't try to focus the row that doesn't exist\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tvar scrollPositionX = parseInt(grid.$grid.scrollLeft);\n\t\t\t\t\tvar scrollPositionY = parseInt(grid.$grid_data.scrollTop);\n\n\t\t\t\t\tvar attachedScrollbarHorizontal = grid.$config.scrollX;\n\n\t\t\t\t\tif (attachedScrollbarHorizontal && grid.$config.scrollable) {\n\t\t\t\t\t\tvar scrollbarHorizontal = gantt.$ui.getView(attachedScrollbarHorizontal);\n\t\t\t\t\t\tif (scrollbarHorizontal) {\n\t\t\t\t\t\t\tscrollbarHorizontal.scrollTo(scrollPositionX, scrollPositionY);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tvar attachedScrollbarVertical = grid.$config.scrollY;\n\n\t\t\t\t\tif (attachedScrollbarVertical) {\n\t\t\t\t\t\tvar scrollbarVertical = gantt.$ui.getView(attachedScrollbarVertical);\n\t\t\t\t\t\tif (scrollbarVertical) {\n\t\t\t\t\t\t\tscrollbarVertical.scrollTo(scrollPositionX, scrollPositionY);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\tkeys: {\n\t\t\t\t\"pagedown\": function () {\n\t\t\t\t\tif (gantt.getVisibleTaskCount()) {\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskRow(gantt.getTaskByIndex(gantt.getVisibleTaskCount() - 1).id));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"pageup\": function () {\n\t\t\t\t\tif (gantt.getVisibleTaskCount()) {\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskRow(gantt.getTaskByIndex(0).id));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"up\": function () {\n\t\t\t\t\tvar nextElement = null;\n\t\t\t\t\tvar prevTask = gantt.getPrev(this.taskId);\n\t\t\t\t\tif (!gantt.isTaskExists(prevTask)) {\n\t\t\t\t\t\tnextElement = new gantt.$keyboardNavigation.HeaderCell();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnextElement = new gantt.$keyboardNavigation.TaskRow(prevTask);\n\t\t\t\t\t}\n\t\t\t\t\tthis.moveTo(nextElement);\n\t\t\t\t},\n\t\t\t\t\"down\": function () {\n\t\t\t\t\tvar nextTask = gantt.getNext(this.taskId);\n\t\t\t\t\tif (gantt.isTaskExists(nextTask)) {\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskRow(nextTask));\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\t\"shift+down\": function(){\n\t\t\t\t\tif(gantt.hasChild(this.taskId) && !gantt.getTask(this.taskId).$open){\n\t\t\t\t\t\tgantt.open(this.taskId);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"shift+up\": function(){\n\t\t\t\t\tif(gantt.hasChild(this.taskId) && gantt.getTask(this.taskId).$open){\n\t\t\t\t\t\tgantt.close(this.taskId);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"shift+right\": function() {\n\t\t\t\t\tif (gantt.isReadonly(this)) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tvar prevId = gantt.getPrevSibling(this.taskId);\n\t\t\t\t\tif(gantt.isTaskExists(prevId) && !gantt.isChildOf(this.taskId, prevId)){\n\t\t\t\t\t\tvar parent = gantt.getTask(prevId);\n\t\t\t\t\t\tparent.$open = true;\n\t\t\t\t\t\tvar result = gantt.moveTask(this.taskId, -1, prevId);\n\t\t\t\t\t\tif(result !== false)\n\t\t\t\t\t\t\tgantt.updateTask(this.taskId);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"shift+left\": function() {\n\t\t\t\t\tif (gantt.isReadonly(this)) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tvar parent = gantt.getParent(this.taskId);\n\t\t\t\t\tif(gantt.isTaskExists(parent)){\n\t\t\t\t\t\tvar result =  gantt.moveTask(this.taskId, gantt.getTaskIndex(parent) + 1, gantt.getParent(parent));\n\t\t\t\t\t\tif(result !== false)\n\t\t\t\t\t\t\tgantt.updateTask(this.taskId);\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\t// select\n\t\t\t\t\"space\": function (e) {\n\t\t\t\t\tif (!gantt.isSelectedTask(this.taskId)) {\n\t\t\t\t\t\tgantt.selectTask(this.taskId);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tgantt.unselectTask(this.taskId);\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\t// collapse\n\t\t\t\t\"ctrl+left\": function (e) {\n\t\t\t\t\tgantt.close(this.taskId);\n\t\t\t\t},\n\t\t\t\t// expand\n\t\t\t\t\"ctrl+right\": function (e) {\n\t\t\t\t\tgantt.open(this.taskId);\n\t\t\t\t},\n\n\t\t\t\t// delete task\n\t\t\t\t\"delete\": function (e) {\n\t\t\t\t\tif (gantt.isReadonly(this)) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tgantt.$click.buttons[\"delete\"](this.taskId);\n\t\t\t\t},\n\n\t\t\t\t// open lightbox\n\t\t\t\t\"enter\": function () {\n\t\t\t\t\tif (gantt.isReadonly(this)) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tgantt.showLightbox(this.taskId);\n\t\t\t\t},\n\n\t\t\t\t// add subtask\n\t\t\t\t\"ctrl+enter\": function () {\n\t\t\t\t\tif (gantt.isReadonly(this)) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tgantt.createTask({}, this.taskId);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t);\n\tgantt.$keyboardNavigation.TaskRow.prototype.bindAll(gantt.$keyboardNavigation.TaskRow.prototype.keys);\n\n};","import * as domHelpers from \"../../../core/ui/utils/dom_helpers\";\nimport {replaceValidZeroId} from \"../../../utils/helpers\";\n\nexport default function(gantt) {\n\n\n\tgantt.$keyboardNavigation.TaskCell = function (taskId, index) {\n\t\ttaskId = replaceValidZeroId(taskId, gantt.config.root_id);\n\t\tif (!taskId) {\n\t\t\tvar rootLevel = gantt.getChildren(gantt.config.root_id);\n\t\t\tif (rootLevel[0]) {\n\t\t\t\ttaskId = rootLevel[0];\n\t\t\t}\n\t\t}\n\t\tthis.taskId = taskId;\n\t\tthis.columnIndex = index || 0;\n\t\t// provided task may not exist, in this case node will be detectes as invalid\n\t\tif (gantt.isTaskExists(this.taskId)) {\n\t\t\tthis.index = gantt.getTaskIndex(this.taskId);\n\t\t\tthis.globalIndex = gantt.getGlobalTaskIndex(this.taskId);\n\t\t}\n\t};\n\n\tgantt.$keyboardNavigation.TaskCell.prototype = gantt._compose(\n\t\tgantt.$keyboardNavigation.TaskRow,\n\t\t{\n\t\t\t_handlers: null,\n\t\t\tisValid: function () {\n\n\t\t\t\treturn gantt.$keyboardNavigation.TaskRow.prototype.isValid.call(this) && !!gantt.getGridColumns()[this.columnIndex];\n\t\t\t},\n\t\t\tfallback: function () {\n\n\t\t\t\tvar node = gantt.$keyboardNavigation.TaskRow.prototype.fallback.call(this);\n\t\t\t\tvar result = node;\n\t\t\t\tif (node instanceof gantt.$keyboardNavigation.TaskRow) {\n\t\t\t\t\tvar visibleColumns = gantt.getGridColumns();\n\t\t\t\t\tvar index = this.columnIndex;\n\t\t\t\t\twhile (index >= 0) {\n\t\t\t\t\t\tif (visibleColumns[index])\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tindex--;\n\t\t\t\t\t}\n\t\t\t\t\tif (visibleColumns[index]) {\n\t\t\t\t\t\tresult = new gantt.$keyboardNavigation.TaskCell(node.taskId, index);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn result;\n\t\t\t},\n\n\t\t\tfromDomElement: function(el){\n\t\t\t\tif(!gantt.config.keyboard_navigation_cells){\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\tvar taskId = gantt.locate(el);\n\t\t\t\tif(gantt.isTaskExists(taskId)){\n\t\t\t\t\tvar index = 0;\n\t\t\t\t\tvar cellElement = domHelpers.locateAttribute(el, \"data-column-index\");\n\n\t\t\t\t\tif(cellElement){\n\t\t\t\t\t\tindex = cellElement.getAttribute(\"data-column-index\")*1;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn new gantt.$keyboardNavigation.TaskCell(taskId, index);\n\t\t\t\t}else{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tgetNode: function () {\n\t\t\t\tif (gantt.isTaskExists(this.taskId) && (gantt.isTaskVisible(this.taskId) || gantt.config.show_tasks_outside_timescale)) {\n\t\t\t\t\tif (gantt.config.show_grid && gantt.$grid) {\n\t\t\t\t\t\tvar row = gantt.$grid.querySelector(\".gantt_row[\" + gantt.config.task_attribute + \"='\" + this.taskId + \"']\");\n\t\t\t\t\t\tif(!row)\n\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\treturn row.querySelector(\"[data-column-index='\"+this.columnIndex+\"']\");\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn gantt.getTaskNode(this.taskId);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tkeys: {\n\t\t\t\t\"up\": function () {\n\n\t\t\t\t\tvar nextElement = null;\n\t\t\t\t\tvar prevTask = gantt.getPrev(this.taskId);\n\t\t\t\t\tif (!gantt.isTaskExists(prevTask)) {\n\t\t\t\t\t\tnextElement = new gantt.$keyboardNavigation.HeaderCell(this.columnIndex);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnextElement = new gantt.$keyboardNavigation.TaskCell(prevTask, this.columnIndex);\n\t\t\t\t\t}\n\t\t\t\t\tthis.moveTo(nextElement);\n\t\t\t\t},\n\t\t\t\t\"down\": function () {\n\t\t\t\t\tvar nextTask = gantt.getNext(this.taskId);\n\t\t\t\t\tif (gantt.isTaskExists(nextTask)) {\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskCell(nextTask, this.columnIndex));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"left\": function () {\n\t\t\t\t\tif (this.columnIndex > 0) {\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskCell(this.taskId, this.columnIndex - 1));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"right\": function () {\n\t\t\t\t\tvar columns = gantt.getGridColumns();\n\t\t\t\t\tif (this.columnIndex < columns.length - 1) {\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskCell(this.taskId, this.columnIndex + 1));\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\t\"end\": function () {\n\t\t\t\t\tvar columns = gantt.getGridColumns();\n\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskCell(this.taskId, columns.length - 1));\n\t\t\t\t},\n\t\t\t\t\"home\": function () {\n\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskCell(this.taskId, 0));\n\t\t\t\t},\n\t\t\t\t\"pagedown\": function () {\n\t\t\t\t\tif (gantt.getVisibleTaskCount()) {\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskCell(gantt.getTaskByIndex(gantt.getVisibleTaskCount() - 1).id, this.columnIndex));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t\"pageup\": function () {\n\t\t\t\t\tif (gantt.getVisibleTaskCount()) {\n\t\t\t\t\t\tthis.moveTo(new gantt.$keyboardNavigation.TaskCell(gantt.getTaskByIndex(0).id, this.columnIndex));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t);\n\n\n\tgantt.$keyboardNavigation.TaskCell.prototype.bindAll(gantt.$keyboardNavigation.TaskRow.prototype.keys);\n\tgantt.$keyboardNavigation.TaskCell.prototype.bindAll(gantt.$keyboardNavigation.TaskCell.prototype.keys);\n\n};","export default function(gantt) {\n\n\tgantt.$keyboardNavigation.dispatcher = {\n\t\tisActive: false,\n\t\tactiveNode: null,\n\t\tglobalNode: new gantt.$keyboardNavigation.GanttNode(),\n\n\t\tenable: function () {\n\t\t\tthis.isActive = true;\n\t\t\tthis.setActiveNode(this.getActiveNode());\n\t\t},\n\n\t\tdisable: function () {\n\t\t\tthis.isActive = false;\n\t\t},\n\n\t\tisEnabled: function () {\n\t\t\treturn !!this.isActive;\n\t\t},\n\n\t\tgetDefaultNode: function () {\n\t\t\tvar node;\n\t\t\tif (gantt.config.keyboard_navigation_cells) {\n\t\t\t\tnode = new gantt.$keyboardNavigation.TaskCell();\n\t\t\t} else {\n\t\t\t\tnode = new gantt.$keyboardNavigation.TaskRow();\n\t\t\t}\n\n\t\t\tif (!node.isValid()) {\n\t\t\t\tnode = node.fallback();\n\t\t\t}\n\t\t\treturn node;\n\t\t},\n\n\t\tsetDefaultNode: function () {\n\t\t\tthis.setActiveNode(this.getDefaultNode());\n\t\t},\n\n\t\tgetActiveNode: function () {\n\t\t\tvar node = this.activeNode;\n\t\t\tif (node && !node.isValid()) {\n\t\t\t\tnode = node.fallback();\n\t\t\t}\n\t\t\treturn node;\n\t\t},\n\n\t\tfromDomElement: function(e){\n\t\t\tvar inputs = [\n\t\t\t\tgantt.$keyboardNavigation.TaskRow,\n\t\t\t\tgantt.$keyboardNavigation.TaskCell,\n\t\t\t\tgantt.$keyboardNavigation.HeaderCell\n\t\t\t];\n\t\t\tfor(var i = 0; i < inputs.length; i++){\n\t\t\t\tif(inputs[i].prototype.fromDomElement){\n\t\t\t\t\tvar node = inputs[i].prototype.fromDomElement(e);\n\t\t\t\t\tif(node) return node;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t},\n\n\t\tfocusGlobalNode: function () {\n\t\t\tthis.blurNode(this.globalNode);\n\t\t\tthis.focusNode(this.globalNode);\n\t\t},\n\n\t\tsetActiveNode: function (el) {\n\t\t\t//console.trace()\n\t\t\tvar focusChanged = true;\n\t\t\tif (this.activeNode) {\n\t\t\t\tif (this.activeNode.compareTo(el)) {\n\t\t\t\t\tfocusChanged = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this.isEnabled()) {\n\t\t\t\tif(focusChanged)\n\t\t\t\t\tthis.blurNode(this.activeNode);\n\n\t\t\t\tthis.activeNode = el;\n\t\t\t\tthis.focusNode(this.activeNode, !focusChanged);\n\t\t\t}\n\t\t},\n\n\t\tfocusNode: function (el, keptFocus) {\n\t\t\tif (el && el.focus) {\n\t\t\t\tel.focus(keptFocus);\n\t\t\t}\n\t\t},\n\t\tblurNode: function (el) {\n\t\t\tif (el && el.blur) {\n\t\t\t\tel.blur();\n\t\t\t}\n\t\t},\n\n\t\tkeyDownHandler: function (e) {\n\n\t\t\tif (gantt.$keyboardNavigation.isModal())\n\t\t\t\treturn;\n\n\t\t\tif (!this.isEnabled())\n\t\t\t\treturn;\n\n\t\t\tif(e.defaultPrevented){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar ganttNode = this.globalNode;\n\n\t\t\tvar command = gantt.$keyboardNavigation.shortcuts.getCommandFromEvent(e);\n\n\t\t\tvar activeElement = this.getActiveNode();\n\t\t\tvar eventFacade = gantt.$keyboardNavigation.facade;\n\t\t\tif(eventFacade.callEvent(\"onKeyDown\", [command, e]) === false){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!activeElement) {\n\t\t\t\tthis.setDefaultNode();\n\t\t\t} else if (activeElement.findHandler(command)) {\n\t\t\t\tactiveElement.doAction(command, e);\n\t\t\t} else if (ganttNode.findHandler(command)) {\n\t\t\t\tganttNode.doAction(command, e);\n\t\t\t}\n\n\t\t},\n\t\t_timeout: null,\n\t\tawaitsFocus: function(){\n\t\t\treturn this._timeout !== null;\n\t\t},\n\t\tdelay: function(callback, delay){\n\n\t\t\tclearTimeout(this._timeout);\n\t\t\tthis._timeout = setTimeout(gantt.bind(function(){\n\t\t\t\tthis._timeout = null;\n\t\t\t\tcallback();\n\t\t\t}, this)  , delay || 1);\n\n\t\t},\n\t\tclearDelay: function(){\n\t\t\tclearTimeout(this._timeout);\n\t\t}\n\t};\n\n};","import { QuickInfo } from \"./quickInfo\";\n\nexport default function(gantt: any){\n\nif (!gantt.ext) {\n\tgantt.ext = {};\n}\ngantt.ext.quickInfo = new QuickInfo(gantt);\n\ngantt.config.quickinfo_buttons = [\"icon_edit\", \"icon_delete\"];\ngantt.config.quick_info_detached = true;\ngantt.config.show_quick_info = true;\n\ngantt.templates.quick_info_title = function(start, end, ev){ return ev.text.substr(0,50); };\ngantt.templates.quick_info_content = function(start, end, ev){ return ev.details || ev.text; };\ngantt.templates.quick_info_date = function(start, end, ev){\n\treturn gantt.templates.task_time(start, end, ev);\n};\ngantt.templates.quick_info_class = function(start, end, task){ return \"\"; };\n\ngantt.attachEvent(\"onTaskClick\", function(id,e){\n\t// GS-1460 and GS-1787. Don't show Quick Info when clicking on the add, collapse, and expand buttons\n\tconst addButton = gantt.utils.dom.closest(e.target, \".gantt_add\");\n\tconst collapseButton = gantt.utils.dom.closest(e.target, \".gantt_close\");\n\tconst expandButton = gantt.utils.dom.closest(e.target, \".gantt_open\");\n\tconst showQuickInfo = !addButton && !collapseButton && !expandButton;\n\tif (showQuickInfo){\n\t\tsetTimeout(function() {\n\t\t\tgantt.ext.quickInfo.show(id);\n\t\t}, 0);\n\t}\n\n\treturn true;\n});\n\nconst events = [\"onViewChange\", \"onLightbox\", \"onBeforeTaskDelete\", \"onBeforeDrag\"];\nconst hidingFunction = function(){\n\tgantt.ext.quickInfo.hide();\n\treturn true;\n};\nfor (let i=0; i<events.length; i++){\n\tgantt.attachEvent(events[i], hidingFunction);\n}\n// GS-957: We don't want to hide QuickInfo when we click on it.\ngantt.attachEvent(\"onEmptyClick\", function(e){\n\tlet hideQuickInfo = true;\n\tconst parent = document.querySelector(\".gantt_cal_quick_info\");\n\tif (parent){\n\t\tconst quickInfoClick = gantt.utils.dom.isChildOf(e.target, parent);\n\t\tif (quickInfoClick){\n\t\t\thideQuickInfo = false;\n\t\t}\n\t}\n\tif (hideQuickInfo){\n\t\thidingFunction();\n\t}\n});\nfunction clearQuickInfo() {\n\tgantt.ext.quickInfo.hide();\n\tgantt.ext.quickInfo._quickInfoBox = null;\n\treturn true;\n}\ngantt.attachEvent(\"onGanttReady\", clearQuickInfo);\ngantt.attachEvent(\"onDestroy\", clearQuickInfo);\n\n// eslint-disable-next-line no-restricted-globals\ngantt.event(window, \"keydown\", function(e){\n\tif (e.keyCode === 27){\n\t\tgantt.ext.quickInfo.hide();\n\t}\n});\n\ngantt.showQuickInfo = function(){\n\tgantt.ext.quickInfo.show.apply(gantt.ext.quickInfo, arguments);\n};\ngantt.hideQuickInfo = function(){\n\tgantt.ext.quickInfo.hide.apply(gantt.ext.quickInfo, arguments);\n};\n\n}","import {TooltipManager} from \"./tooltipManager\";\n\nexport default function(gantt: any){\n\ngantt.config.tooltip_timeout = 30;\ngantt.config.tooltip_offset_y = 20;\ngantt.config.tooltip_offset_x = 10;\ngantt.config.tooltip_hide_timeout = 30;\n\n\n\nconst tooltipManager = new TooltipManager(gantt);\n\ngantt.ext.tooltips = tooltipManager;\n\ngantt.attachEvent(\"onGanttReady\", function(){\n\t//GS-2230: in case if `getGanttInstance` created without container\n\tif(!gantt.$root) return;\n\ttooltipManager.tooltipFor({\n\t\tselector: \"[\"+gantt.config.task_attribute+\"]:not(.gantt_task_row)\",\n\t\thtml: (event: MouseEvent) => {\n\t\t\tif (gantt.config.touch && !gantt.config.touch_tooltip) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst targetTaskId = gantt.locate(event);\n\t\t\tif(gantt.isTaskExists(targetTaskId)){\n\t\t\t\tconst task = gantt.getTask(targetTaskId);\n\t\t\t\treturn gantt.templates.tooltip_text(task.start_date, task.end_date, task);\n\t\t\t}\n\t\t\treturn null;\n\t\t},\n\t\tglobal: false\n\t});\n});\n\ngantt.attachEvent(\"onDestroy\", function() {\n\ttooltipManager.destructor();\n});\n\ngantt.attachEvent(\"onLightbox\", function() {\n\ttooltipManager.hideTooltip();\n});\nconst isLinkCreate = () => {\n\tconst state = gantt.getState();\n\treturn !!state.link_source_id;\n};\ngantt.attachEvent(\"onBeforeTooltip\", function() {\n\tif (isLinkCreate()){\n\t\treturn false;\n\t}\n});\n\ngantt.attachEvent(\"onGanttScroll\", function(){\n\ttooltipManager.hideTooltip();\n});\n\n}","import { Monitor } from \"./monitor\";\nimport { IMonitor, IUndoCommand, TEntityType, TUndoStack } from \"./types\";\nimport { Undo } from \"./undo\";\n\nexport default function(gantt: any){\n\nconst _undo = new Undo(gantt);\nconst monitor: IMonitor = new Monitor(_undo, gantt);\n\ngantt.config.undo = true;\ngantt.config.redo = true;\n\n/**\n * entities that require different processing for undoing-redoing changes\n * @type {{link: string, task: string}}\n */\ngantt.config.undo_types = {\n\tlink: \"link\",\n\ttask: \"task\"\n};\n\n/**\n * types of traced actions\n * @type {{update: string, remove: string, add: string}}\n */\ngantt.config.undo_actions = {\n\tupdate: \"update\",\n\tremove: \"remove\", // remove item from datastore\n\tadd: \"add\",\n\tmove: \"move\" // move task in grid\n};\n\nif (!gantt.ext) {\n\tgantt.ext = {};\n}\n\ngantt.ext.undo = {\n\tundo: () => _undo.undo(),\n\tredo: () => _undo.redo(),\n\tgetUndoStack: () => _undo.getUndoStack(),\n\tsetUndoStack: (stack:[]) => _undo.setUndoStack(stack),\n\tgetRedoStack: () => _undo.getRedoStack(),\n\tsetRedoStack: (stack:[]) => _undo.setRedoStack(stack),\n\tclearUndoStack: () => _undo.clearUndoStack(),\n\tclearRedoStack: () => _undo.clearRedoStack(),\n\tsaveState: (id: TaskID | LinkID, type: TEntityType) => monitor.store(id, type, true),\n\tgetInitialState: (id: TaskID | LinkID, type: TEntityType) => {\n\t\tif(type === gantt.config.undo_types.link){\n\t\t\treturn monitor.getInitialLink(id);\n\t\t}else{\n\t\t\treturn monitor.getInitialTask(id);\n\t\t}\n\t}\n};\n\ngantt.undo = gantt.ext.undo.undo;\ngantt.redo = gantt.ext.undo.redo;\ngantt.getUndoStack = gantt.ext.undo.getUndoStack;\ngantt.getRedoStack = gantt.ext.undo.getRedoStack;\ngantt.clearUndoStack = gantt.ext.undo.clearUndoStack;\ngantt.clearRedoStack = gantt.ext.undo.clearRedoStack;\n\nfunction isEqualIds(first: TaskID, second: TaskID){\n\treturn String(first) === String(second);\n};\n\nfunction updTask(task: ITask, oldId: TaskID, newId: TaskID) {\n\tif (!task) { return; }\n\n\tif (isEqualIds(task.id, oldId)) {\n\t\ttask.id = newId;\n\t}\n\n\tif (isEqualIds(task.parent, oldId)) {\n\t\ttask.parent = newId;\n\t}\n}\n\nfunction changeTaskCommandId(command: IUndoCommand, oldId: TaskID, newId: TaskID) {\n\tupdTask(command.value, oldId, newId);\n\tupdTask(command.oldValue, oldId, newId);\n}\n\nfunction updLink(link: ILink, oldTaskId: TaskID, newTaskId: TaskID) {\n\tif (!link) { return; }\n\tif (isEqualIds(link.source, oldTaskId)) {\n\t\tlink.source = newTaskId;\n\t}\n\tif (isEqualIds(link.target, oldTaskId)) {\n\t\tlink.target = newTaskId;\n\t}\n}\n\nfunction changeLinkCommandId(command: IUndoCommand, oldId: LinkID, newId: LinkID) {\n\tupdLink(command.value, oldId, newId);\n\tupdLink(command.oldValue, oldId, newId);\n}\n\nfunction updateTasksIds(log: TUndoStack, oldId: TaskID, newId: TaskID) {\n\tconst undo = _undo;\n\n\tfor (let i = 0; i < log.length; i++) {\n\t\tconst entry = log[i];\n\t\tfor (let j = 0; j < entry.commands.length; j++) {\n\t\t\tif (entry.commands[j].entity === undo.command.entity.task) {\n\t\t\t\tchangeTaskCommandId(entry.commands[j], oldId, newId);\n\t\t\t} else if (entry.commands[j].entity === undo.command.entity.link) {\n\t\t\t\tchangeLinkCommandId(entry.commands[j], oldId, newId);\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction updateLinksIds(log: TUndoStack, oldId: LinkID, newId: LinkID) {\n\tconst undo = _undo;\n\n\tfor (let i = 0; i < log.length; i++) {\n\t\tconst entry = log[i];\n\t\tfor (let j = 0; j < entry.commands.length; j++) {\n\t\t\tconst command = entry.commands[j];\n\t\t\tif (command.entity === undo.command.entity.link) {\n\t\t\t\tif (command.value && command.value.id === oldId) {\n\t\t\t\t\tcommand.value.id = newId;\n\t\t\t\t}\n\t\t\t\tif (command.oldValue && command.oldValue.id === oldId) {\n\t\t\t\t\tcommand.oldValue.id = newId;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\ngantt.attachEvent(\"onTaskIdChange\", (oldId: TaskID, newId: TaskID) => {\n\tconst undo = _undo;\n\tupdateTasksIds(undo.getUndoStack(), oldId, newId);\n\tupdateTasksIds(undo.getRedoStack(), oldId, newId);\n});\n\ngantt.attachEvent(\"onLinkIdChange\", (oldId: LinkID, newId: LinkID) => {\n\tconst undo = _undo;\n\tupdateLinksIds(undo.getUndoStack(), oldId, newId);\n\tupdateLinksIds(undo.getRedoStack(), oldId, newId);\n});\n\ngantt.attachEvent(\"onGanttReady\", () => {\n\t_undo.updateConfigs();\n});\n\n}","import * as helpers from \"../utils/helpers\";\n\nexport default function(gantt){\n\ngantt._groups = {\n\trelation_property: null,\n\trelation_id_property: '$group_id',\n\tgroup_id: null,\n\tgroup_text: null,\n\tloading: false,\n\tloaded: 0,\n\tdynamicGroups: false,\n\tset_relation_value: undefined,\n\t_searchCache: null,\n\tinit: function(gantt){\n\t\tvar self = this;\n\n\t\tgantt.attachEvent(\"onClear\", function(){\n\t\t\tself.clear();\n\t\t});\n\t\tself.clear();\n\n\t\tvar originalGetParent = gantt.$data.tasksStore.getParent; // gantt._get_parent_id;\n\t\tthis._searchCache = null;\n\t\tgantt.attachEvent(\"onBeforeTaskMove\", function(id, parent, tindex) {\n\t\t\t// GS-504: If we allow several owners/resources, the task should be moved to \n\t\t\t// a new position only if there is the function that handles that logic\n\t\t\tvar invalidParent = parent === this.config.root_id;\n\t\t\tvar noRelationValueFunction = this._groups.dynamicGroups && !(this._groups.set_relation_value instanceof Function);\n\n\t\t\tif (self.is_active() && (invalidParent || noRelationValueFunction)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tvar task = gantt.getTask(id);\n\t\t\t// to allow reordering from regular task to virtual task in the group mode\n\t\t\tif (this._groups.save_tree_structure && gantt.isTaskExists(task.parent) && gantt.isTaskExists(parent)) {\n\t\t\t\tvar oldParentTask = gantt.getTask(task.parent);\n\t\t\t\tvar newParentTask = gantt.getTask(parent);\n\t\t\t\tif (newParentTask.$virtual && gantt.isChildOf(oldParentTask.id, newParentTask.id)) {\n\t\t\t\t\ttask.parent = gantt.config.root_id;\n\t\t\t\t}\n\t\t\t\t// avoid cyclic tree:\n\t\t\t\tlet cyclicTree = false;\n\t\t\t\tlet parentTask = newParentTask;\n\t\t\t\twhile (parentTask) {\n\t\t\t\t\tif (id == parentTask.parent) {\n\t\t\t\t\t\tcyclicTree = true;\n\t\t\t\t\t}\n\t\t\t\t\tif (gantt.isTaskExists(parentTask.parent)) {\n\t\t\t\t\t\tparentTask = gantt.getTask(parentTask.parent);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tparentTask = null;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (cyclicTree) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\n\t\t// restore initial parent if the task is moved to a different group on the root level\n\t\tgantt.attachEvent(\"onRowDragStart\", function (id, target) {\n\t\t\tvar task = gantt.getTask(id);\n\t\t\tif (this._groups.save_tree_structure && gantt.isTaskExists(task.parent) && gantt.config.order_branch && gantt.config.order_branch != \"marker\") {\n\t\t\t\ttask.$initial_parent = task.parent;\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\n\t\tgantt.attachEvent(\"onRowDragEnd\", function (id, target) {\n\t\t\tif (gantt.config.order_branch && gantt.config.order_branch != \"marker\") {\n\t\t\t\tvar task = gantt.getTask(id);\n\t\t\t\tif (task.$initial_parent) {\n\t\t\t\t\tif (task.parent == gantt.config.root_id) {\n\t\t\t\t\t\tvar renderedParent = gantt.getTask(task.$rendered_parent);\n\t\t\t\t\t\tvar initialParent = gantt.getTask(task.$initial_parent);\n\t\t\t\t\t\tvar restoreParent = false;\n\t\t\t\t\t\tif (this._groups.dynamicGroups && renderedParent[this._groups.group_id] != initialParent[this._groups.group_id]) {\n\t\t\t\t\t\t\trestoreParent = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!this._groups.dynamicGroups && renderedParent[this._groups.group_id] != initialParent[this._groups.relation_property]) {\n\t\t\t\t\t\t\trestoreParent = true;\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (restoreParent) {\n\t\t\t\t\t\t\ttask.parent = task.$initial_parent;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tdelete task.$initial_parent;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tgantt.$data.tasksStore._listenerToDrop = gantt.$data.tasksStore.attachEvent(\"onStoreUpdated\", gantt.bind(_initBeforeDataRender, gantt));\n\n\t\tgantt.$data.tasksStore.getParent = function(task) {\n\t\t\tif (self.is_active()) {\n\t\t\t\treturn self.get_parent(gantt, task);\n\t\t\t} else {\n\t\t\t\treturn originalGetParent.apply(this, arguments);\n\t\t\t}\n\t\t};\n\n\t\tvar originalSetParent = gantt.$data.tasksStore.setParent;\n\n\t\tgantt.$data.tasksStore.setParent = function(task, new_pid) {\n\t\t\tif (!self.is_active()) {\n\t\t\t\treturn originalSetParent.apply(this, arguments);\n\t\t\t} else if (self.set_relation_value instanceof Function && gantt.isTaskExists(new_pid)) {\n\t\t\t\tvar parent = gantt.getTask(new_pid);\n\t\t\t\tvar groupIds = parent[self.relation_id_property];\n\t\t\t\tif (!parent.$virtual) {\n\t\t\t\t\tvar groupId = _getGroupId(parent, self.relation_property);\n\t\t\t\t\tif (!self._searchCache) {\n\t\t\t\t\t\tself._buildCache();\n\t\t\t\t\t}\n\t\t\t\t\tvar virtualParentId = self._searchCache[groupId];\n\t\t\t\t\tvar virtualParent = gantt.getTask(virtualParentId);\n\t\t\t\t\tgroupIds = virtualParent[self.relation_id_property];\n\t\t\t\t}\n\t\t\t\tif (task[self.group_id] === undefined) {\n\t\t\t\t\t// to avoid nulling of relation_property if the group is not set\n\t\t\t\t\ttask[self.group_id] = groupIds;\n\t\t\t\t}\n\n\t\t\t\tif (self.save_tree_structure && task[self.group_id] != groupIds) {\n\t\t\t\t\ttask[self.group_id] = groupIds;\n\t\t\t\t}\n\n\t\t\t\tif (groupIds){\n\t\t\t\t\tif (typeof groupIds == \"string\"){\n\t\t\t\t\t\tgroupIds = groupIds.split(\",\");\n\t\t\t\t\t} else {\n\t\t\t\t\t\tgroupIds = [groupIds];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// GS-504: This is a way to save the relation_property and customize the logic\n\t\t\t\ttask[self.relation_property] = self.set_relation_value(groupIds, task.id, task[self.relation_property]) || groupIds;\n\n\t\t\t} else if (gantt.isTaskExists(new_pid)) {\n\t\t\t\tvar parent = gantt.getTask(new_pid);\n\n\t\t\t\tif (!self.dynamicGroups) {\n\t\t\t\t\tif (parent.$virtual) {\n\t\t\t\t\t\ttask[self.relation_property] = parent[self.relation_id_property];\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttask[self.relation_property] = parent[self.relation_property];\n\t\t\t\t\t}\n\t\t\t\t\t// task[self.group_id] = parent[self.group_id] || task[self.group_id];\n\t\t\t\t}\n\n\t\t\t\tthis._setParentInner.apply(this, arguments);\n\t\t\t} else if(self.dynamicGroups) {\n\t\t\t\tif (task[self.group_id] === undefined || (!task.$virtual && task[self.relation_property][0] === [][0])) {\n\t\t\t\t\tif(task[self.relation_property] !== self.group_id){\n\t\t\t\t\t\t// GS:2547 dynamically added tasks could have relation_property\n\t\t\t\t\t\ttask[self.relation_property] = task[self.relation_property] || 0;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// GS-1332 the tasks without the group should be moved to the default group:\n\t\t\t\t\t\ttask[self.relation_property] = 0;\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t}\n\t\t\t// GS-1449. Update the parent when it was changed in the group mode\n\t\t\tif (gantt.isTaskExists(new_pid)) {\n\t\t\t\ttask.$rendered_parent = new_pid;\n\t\t\t\tif (!gantt.getTask(new_pid).$virtual) {\n\t\t\t\t\treturn originalSetParent.apply(this, arguments) || new_pid;\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tgantt.attachEvent(\"onBeforeTaskDisplay\", function(id, task){\n\t\t\tif(self.is_active()){\n\t\t\t\tif(task.type == gantt.config.types.project && !task.$virtual)\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\n\t\tgantt.attachEvent(\"onBeforeParse\", function(){\n\t\t\tself.loading = true;\n\t\t\tself._clearCache();\n\t\t});\n\n\t\tgantt.attachEvent(\"onTaskLoading\", function(){\n\t\t\tif(self.is_active()){\n\t\t\t\tself.loaded--;\n\t\t\t\tif(self.loaded <= 0){\n\t\t\t\t\tself.loading = false;\n\t\t\t\t\tself._clearCache();\n\t\t\t\t\tgantt.eachTask(gantt.bind(function(t){\n\t\t\t\t\t\tthis.get_parent(gantt, t);\n\t\t\t\t\t}, self));\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\n\t\t});\n\t\tgantt.attachEvent(\"onParse\", function(){\n\t\t\tself.loading = false;\n\t\t\tself.loaded = 0;\n\t\t});\n\t},\n\n\t_clearCache: function(){\n\t\tthis._searchCache = null;\n\t},\n\t_buildCache: function(){\n\t\tthis._searchCache = {};\n\t\tvar items = gantt.$data.tasksStore.getItems();\n\t\tfor(var i = 0; i < items.length; i++){\n\t\t\tthis._searchCache[items[i][this.relation_id_property]] = items[i].id;\n\t\t}\n\n\t},\n\tget_parent: function(gantt, task, tasks) {\n\t\tif (task.id === undefined) {\n\t\t\ttask = gantt.getTask(task);\n\t\t}\n\n\t\tvar group_id = _getGroupId(task, this.relation_property);\n\n\t\tif (this.save_tree_structure && gantt.isTaskExists(task.parent)) {\n\t\t\tlet parentTask = gantt.getTask(task.parent);\n\n\t\t\tconst parent_group_id = _getGroupId(parentTask, this.relation_property);\n\n\t\t\tif (parentTask.type != \"project\" && group_id == parent_group_id) {\n\t\t\t\treturn task.parent;\n\t\t\t}\n\t\t}\n\n\t\tif (this._groups_pull[group_id] === task.id){\n\t\t\treturn gantt.config.root_id;\n\t\t}\n\t\tif (this._groups_pull[group_id] !== undefined) {\n\t\t\treturn this._groups_pull[group_id];\n\t\t}\n\n\t\tvar parent_id = gantt.config.root_id;\n\n\t\tif (!this.loading && group_id !== undefined) {\n\n\t\t\tif(!this._searchCache){\n\t\t\t\tthis._buildCache();\n\t\t\t}\n\t\t\tvar parent = this._searchCache[group_id];\n\t\t\tif(gantt.isTaskExists(parent) && parent != task.id){\n\t\t\t\tparent_id = this._searchCache[group_id];\n\t\t\t}\n\n\t\t\tthis._groups_pull[group_id] = parent_id;\n\t\t}\n\n\t\treturn parent_id;\n\t},\n\n\tclear: function(){\n\t\tthis._groups_pull = {};\n\t\tthis.relation_property = null;\n\t\tthis.group_id = null;\n\t\tthis.group_text = null;\n\t\tthis._clearCache();\n\t},\n\tis_active: function(){\n\t\treturn !!(this.relation_property);\n\t},\n\tgenerate_sections: function(list, groups_type){\n\t\tvar groups = [];\n\t\tfor(var i = 0; i < list.length; i++){\n\t\t\tvar group = gantt.copy(list[i]);\n\t\t\tgroup.type = groups_type;\n\t\t\tif(group.open === undefined){\n\t\t\t\tgroup.open = true;\n\t\t\t}\n\t\t\tgroup.$virtual = true;\n\t\t\tgroup.readonly = true;\n\t\t\tgroup[this.relation_id_property] = group[this.group_id];\n\t\t\tgroup.text = group[this.group_text];\n\t\t\tgroups.push(group);\n\t\t}\n\t\treturn groups;\n\n\t},\n\tclear_temp_tasks: function(tasks){\n\t\tfor(var i =0; i < tasks.length; i++){\n\t\t\tif(tasks[i].$virtual){\n\t\t\t\ttasks.splice(i, 1);\n\t\t\t\ti--;\n\t\t\t}\n\t\t}\n\t},\n\n\tgenerate_data: function(gantt, groups){\n\t\tvar links = gantt.getLinks();\n\t\tvar tasks = gantt.getTaskByTime();\n\n\t\tthis.clear_temp_tasks(tasks);\n\n\t\ttasks.forEach(function(task){\n\t\t\ttask.$calculate_duration = false;// no need to recalculate durations of tasks after group by\n\t\t});\n\n\t\tvar categories = [];\n\t\tif(this.is_active() && groups && groups.length){\n\t\t\tcategories = this.generate_sections(groups, gantt.config.types.project);\n\t\t}\n\n\t\tvar data = {links: links};\n\t\tdata.data = categories.concat(tasks);\n\n\t\treturn data;\n\t},\n\tupdate_settings: function(relation, group_id, group_text){\n\t\tthis.clear();\n\t\tthis.relation_property = relation;\n\t\tthis.group_id = group_id;\n\t\tthis.group_text = group_text;\n\t},\n\tgroup_tasks: function (gantt, groups_array, relation_property, group_id, group_text){\n\t\tthis.update_settings(relation_property, group_id, group_text);\n\t\tvar data = this.generate_data(gantt, groups_array);\n\t\tthis.loaded = data.data.length;\n\n\t\t// save task selection before grouping tasks\n\t\t// We need to iterate selected tasks with the \"isSelectedTask\" method\n\t\t// because it will work with and without the multiselect extension\n\t\tvar selectedTasks = [];\n\t\tgantt.eachTask(function(task){\n\t\t\tif (gantt.isSelectedTask(task.id)){\n\t\t\t\tselectedTasks.push(task.id);\n\t\t\t}\n\t\t});\n\n\t\tgantt._clear_data();\n\t\tconst schedulingOnParse = gantt._getAutoSchedulingConfig().schedule_on_parse;\n\t\tconst deprecatedConfig = gantt.config.auto_scheduling_initial;\n\n\t\tif(deprecatedConfig) {\n\t\t\tgantt.config.auto_scheduling_initial = false;\n\t\t} else if (schedulingOnParse){\n\t\t\tgantt.config.auto_scheduling.schedule_on_parse = false;\n\t\t}\n\t\t\n\t\tgantt.parse(data);\n\n\t\t// restore task selection after grouping tasks\n\t\tselectedTasks.forEach(function(taskId){\n\t\t\tif (gantt.isTaskExists(taskId)){\n\t\t\t\tgantt.selectTask(taskId);\n\t\t\t}\n\t\t});\n\n\t\tif(deprecatedConfig) {\n\t\t\tgantt.config.auto_scheduling_initial = schedulingOnParse;\n\t\t} else if (schedulingOnParse){\n\t\t\tgantt.config.auto_scheduling.schedule_on_parse = schedulingOnParse;\n\t\t}\n\t}\n};\n\ngantt._groups.init(gantt);\n\nfunction setRelationValueForAssignmentsArray(newGroupValues, id, oldRelationProperty) {\n\tif (!newGroupValues) {\n\t\treturn 0;\n\t}\n\n\tif (Array.isArray(oldRelationProperty) && !oldRelationProperty[0]) {\n\t\treturn 0;\n\t}\n\n\tif (newGroupValues && !Array.isArray(oldRelationProperty)) {\n\t\tconst resources = [];\n\t\tnewGroupValues.map(function(id){\n\t\t\tresources.push({ resource_id: id, value: 8 });\n\t\t});\n\t\treturn resources;\n\t}\n\tif (!oldRelationProperty[0].resource_id) {\n\t\toldRelationProperty = [{ resource_id: oldRelationProperty, value: 8 }];\n\t}\n\n\tif (typeof newGroupValues == \"string\") {\n\t\tnewGroupValues = newGroupValues.split(',');\n\t}\n\n\tif (newGroupValues.length == 1) {\n\t\toldRelationProperty[0].resource_id = newGroupValues[0];\n\t\treturn [oldRelationProperty[0]];\n\t}\n\n\tconst newRelationProperty = [];\n\t// GS-2493: need to take into account that task could have assigments on different dates\n\t// with the same resource\n\tif (newGroupValues.length > 1) {\n\t\tnewGroupValues = [...new Set(newGroupValues)]; // need to remove repeated ids if they exist\n\t}\n\t\n\tfor (let i = 0; i < newGroupValues.length; i++) {\n\t\tlet new_value = newGroupValues[i];\n\t\tlet arrOfResourceIds = oldRelationProperty.map(function (e) { return e.resource_id; });\n\t\t// need to get the positions of the resources\n\t\tlet pos = arrOfResourceIds.reduce(function(resourceAssignmentIndexes, resourceId, index) {\n\t\t\tif (resourceId === new_value)\n\t\t\t\tresourceAssignmentIndexes.push(index);\n\t\t\treturn resourceAssignmentIndexes;\n\t\t}, []);\n\t\t\n\t\tif (pos.length > 0) {\n\t\t\tpos.forEach((assignmentIndex) => {\n\t\t\t\toldRelationProperty[assignmentIndex].resource_id = new_value;\n\t\t\t\tnewRelationProperty.push(oldRelationProperty[assignmentIndex]);\n\t\t\t});\n\t\t}\n\t\telse {\n\t\t\tlet copy = gantt.copy(oldRelationProperty[0]);\n\t\t\tcopy.resource_id = new_value;\n\t\t\tnewRelationProperty.push(copy);\n\t\t}\n\t}\n\treturn newRelationProperty;\n}\n\nfunction setRelationValueForPrimitivesArray(newGroupValues, id, oldRelationProperty) {\n\treturn newGroupValues;\n}\n\nfunction inspectRelationProperty(tasks, relationProperty){\n\tvar resourceAssignments = false;\n\tvar arrays = false;\n\tfor(var i = 0; i < tasks.length; i++){\n\t\tvar value = tasks[i][relationProperty];\n\t\tif(Array.isArray(value)){\n\t\t\tarrays = true;\n\t\t\tif(value.length) {\n\t\t\t\tif(value[0].resource_id !== undefined){\n\t\t\t\t\tresourceAssignments = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn {\n\t\thaveArrays: arrays,\n\t\thaveResourceAssignments: resourceAssignments\n\t};\n}\n\nfunction selectRelationFunction(relationInfo){\n\tif(relationInfo.haveResourceAssignments){\n\t\treturn setRelationValueForAssignmentsArray;\n\t}else if(relationInfo.haveArrays){\n\t\treturn setRelationValueForPrimitivesArray;\n\t}\n\treturn null;\n}\n\ngantt.groupBy = function(config) {\n\tvar _this = this;\n\tvar tasks = gantt.getTaskByTime();\n\n\tthis._groups.set_relation_value = config.set_relation_value;\n\tthis._groups.dynamicGroups = false;\n\tthis._groups.save_tree_structure = config.save_tree_structure;\n\n\tvar relationInfo = inspectRelationProperty(tasks, config.relation_property);\n\n\tif(relationInfo.haveArrays){\n\t\tthis._groups.dynamicGroups = true;\n\t}\n\n\tif(!this._groups.set_relation_value) {\n\t\tthis._groups.set_relation_value = selectRelationFunction(relationInfo);\n\t}\n\n\tconfig = config || {};\n\tconfig.default_group_label = config.default_group_label || this.locale.labels.default_group || \"None\";\n\n\tvar relation_property = config.relation_property || null;\n\tvar group_id = config.group_id || \"key\";\n\tvar group_text = config.group_text || \"label\";\n\n\tthis._groups.regroup = function() {\n\t\tvar tasks = gantt.getTaskByTime();\n\t\tvar groupOpenCloseState = {};\n\t\tvar restoreOpenCloseState = false;\n\t\ttasks.forEach(function(task){\n\t\t\tif(task.$virtual && task.$open !== undefined){\n\t\t\t\tgroupOpenCloseState[task[group_id]] = task.$open;\n\t\t\t\trestoreOpenCloseState = true;\n\t\t\t}\n\t\t});\n\t\tvar groups = _initGroups(config, tasks, gantt);\n\t\tif(groups && restoreOpenCloseState){\n\t\t\tgroups.forEach(function(group){\n\t\t\t\tif(groupOpenCloseState[group[group_id]] !== undefined){\n\t\t\t\t\tgroup.open = groupOpenCloseState[group[group_id]];\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t_this._groups.group_tasks(_this, groups, relation_property, group_id, group_text);\n\t\treturn true;\n\t};\n\tthis._groups.regroup();\n};\n\nfunction _initGroups(config, tasks, gantt) {\n\tvar groups;\n\tif (config.groups) {\n\t\tif (gantt._groups.dynamicGroups) {\n\t\t\tgroups = _getGroupForMultiItems(tasks, config);\n\t\t} else {\n\t\t\tgroups = config.groups;\n\t\t}\n\n\t} else {\n\t\tgroups = null;\n\t}\n\treturn groups;\n}\n\nfunction _getResourcesIds(resources){\n\treturn resources.map(_getEntryId).sort().join(\",\");\n}\n\nfunction _getEntryId(entry){\n\tif(entry && typeof entry == \"object\"){\n\t\treturn String(entry.resource_id);\n\t}else{\n\t\treturn String(entry);\n\t}\n}\n\nfunction _getGroupId(task, relationProperty) {\n\tvar group_id;\n\tif (task[relationProperty] instanceof Array) {\n\t\t// GS-1332 We want to assign tasks with the empty relationProperty to a default group\n\t\tif (!task[relationProperty].length) {\n\t\t\tgroup_id = 0;\n\t\t}\n\t\telse {\n\t\t\tgroup_id = _getResourcesIds(task[relationProperty]);\n\t\t}\n\t} else {\n\t\tgroup_id = task[relationProperty];\n\t}\n\treturn group_id;\n}\n\nfunction _getGroupForMultiItems(tasks, config) {\n\tvar resultObj = {};\n\tvar result = [];\n\tvar itemsByKey = {};\n\tvar property = config.relation_property;\n\tvar delimiter = config.delimiter || \",\";\n\n\tvar hasDefaultGroup = false;\n\tvar defaultGroupId = 0;\n\n\thelpers.forEach(config.groups, function(entry) {\n\t\tif(entry.default){\n\t\t\thasDefaultGroup = true;\n\t\t\tdefaultGroupId = entry.group_id;\n\t\t}\n\t\titemsByKey[entry.key || entry[config.group_id]] = entry;\n\t});\n\n\tfor (var i=0; i < tasks.length; i++) {\n\t\tvar key;\n\t\tvar label;\n\t\tvar task = tasks[i];\n\t\tvar taskGroupValue = task[property];\n\n\t\tif (helpers.isArray(taskGroupValue)) {\n\t\t\tif(taskGroupValue.length > 0) {\n\t\t\t\tkey = _getResourcesIds(taskGroupValue);\n\t\t\t\tlabel = taskGroupValue.map(function(entry, index) {\n\t\t\t\t\tvar key;\n\t\t\t\t\tif (entry && typeof entry == \"object\") {\n\t\t\t\t\t\tkey = entry.resource_id;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tkey = entry;\n\t\t\t\t\t}\n\t\t\t\t\tentry = itemsByKey[key];\n\t\t\t\t\treturn entry.label || entry.text;\n\t\t\t\t}).sort();\n\t\t\t\t// GS-2493: need to take into account that task could have assigments on different dates\n\t\t\t\t// with the same resource\n\t\t\t\tlabel = [...new Set(label)].join(delimiter);\n\t\t\t} else {\n\t\t\t\tif(hasDefaultGroup)\n\t\t\t\t\tcontinue;\n\t\t\t\tkey = 0;\n\t\t\t\tlabel = config.default_group_label;\n\t\t\t}\n\t\t} else if (taskGroupValue) {\n\t\t\tkey = taskGroupValue;\n\t\t\tlabel = itemsByKey[key].label || itemsByKey[key].text;\n\t\t} else {\n\t\t\tif(hasDefaultGroup)\n\t\t\t\tcontinue;\n\t\t\tkey = 0;\n\t\t\tlabel = config.default_group_label;\n\t\t}\n\t\tif (key === undefined || resultObj[key] !== undefined) {\n\t\t\tcontinue;\n\t\t}\n\t\tresultObj[key] = { key: key, label: label };\n\t\tif(key === defaultGroupId){\n\t\t\tresultObj[key].default = true;\n\t\t}\n\t\tresultObj[key][config.group_text] = label;\n\t\tresultObj[key][config.group_id] = key;\n\t}\n\tresult = helpers.hashToArray(resultObj);\n\tresult.forEach(function(group){\n\t\tif(group.key == defaultGroupId){\n\t\t\tgroup.default = true;\n\t\t}\n\t});\n\treturn result;\n}\n\nvar state = gantt.$services.getService(\"state\");\nstate.registerProvider(\"groupBy\", function () {\n\treturn {\n\t\tgroup_mode: gantt._groups.is_active() ? gantt._groups.relation_property : null\n\t};\n});\n\nfunction _initBeforeDataRender() {\n\tconst _this = this;\n\tif (this.$data.tasksStore._listenerToDrop) {\n\t\tthis.$data.tasksStore.detachEvent(this.$data.tasksStore._listenerToDrop);\n\t}\n\n\t// updateTask can be called many times from batchUpdate or autoSchedule,\n\t// add a delay in order to perform grouping only once when everything is done\n\tconst delayedFunction = helpers.delay(function() {\n\t\tif (!_this._groups.dynamicGroups) {\n\t\t\treturn true;\n\t\t}\n\t\tif (_this._groups.regroup) {\n\t\t\tconst scrollState = gantt.getScrollState();\n\t\t\t_this._groups.regroup();\n\t\t\tif(scrollState){\n\t\t\t\tgantt.scrollTo(scrollState.x, scrollState.y);\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t});\n\t\n\tthis.$data.tasksStore.attachEvent(\"onAfterUpdate\", function(){\n\t\t// do not reset delayed function each time since onAfterUpdate can be called huge number of times and clearTimeout/setTimeout gets expensive\n\t\tif(!delayedFunction.$pending){\n\t\t\tdelayedFunction();\n\t\t}\n\t\treturn true;\n\t});\n\t// GS:2547 dynamically added tasks need to regroup\n\tthis.$data.tasksStore.attachEvent(\"onParse\", function(){\n\t\tif (!_this._groups.dynamicGroups) {\n\t\t\t// GS-2823: if the updated tasks change the relation property from primitive to array\n\t\t\t// need to regroup the tasks\n\t\t\tif(_this._groups.is_active()){\n\t\t\t\tconst tasks = gantt.getTaskByTime();\n\t\t\t\tconst relationInfo = inspectRelationProperty(tasks, _this._groups.relation_property);\n\t\t\t\tif(relationInfo.haveArrays){\n\t\t\t\t\t_this._groups.dynamicGroups = true;\n\t\t\t\t\tif (_this._groups.regroup && gantt.getScrollState) {\n\t\t\t\t\t\tconst scrollState = gantt.getScrollState();\n\t\t\t\t\t\t_this._groups.regroup();\n\t\t\t\t\t\tif(scrollState){\n\t\t\t\t\t\t\tgantt.scrollTo(scrollState.x, scrollState.y);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n}\n\n};","\nexport default function(gantt){\n\nif(!gantt._markers) {\n\tgantt._markers = gantt.createDatastore({\n\t\tname: \"marker\",\n\t\tinitItem: function (marker) {\n\t\t\tmarker.id = marker.id || gantt.uid();\n\t\t\treturn marker;\n\t\t}\n\t});\n}\n\ngantt.config.show_markers = true;\n\nfunction render_marker(marker){\n\tif(!gantt.config.show_markers)\n\t\treturn false;\n\n\tif(!marker.start_date)\n\t\treturn false;\n\n\tvar state = gantt.getState();\n\tif(+marker.start_date > +state.max_date)\n\t\treturn;\n\tif((!marker.end_date || +marker.end_date < +state.min_date) && +marker.start_date < +state.min_date)\n\t\treturn;\n\n\tvar div = document.createElement(\"div\");\n\n\tdiv.setAttribute(\"data-marker-id\", marker.id);\n\n\tvar css = \"gantt_marker\";\n\tif(gantt.templates.marker_class)\n\t\tcss += \" \" + gantt.templates.marker_class(marker);\n\n\tif(marker.css){\n\t\tcss += \" \" + marker.css;\n\t}\n\n\tif(gantt.templates.marker_class)\n\t\tcss += \" \" + gantt.templates.marker_class(marker);\n\n\tif(marker.title){\n\t\tdiv.title = marker.title;\n\t}\n\tdiv.className = css;\n\n\tvar start = gantt.posFromDate(marker.start_date);\n\tdiv.style.left = start + \"px\";\n\tlet markerHeight = Math.max(gantt.getRowTop(gantt.getVisibleTaskCount()), 0) + \"px\";\n\tif (gantt.config.timeline_placeholder && gantt.$task_data){\n\t\tmarkerHeight = gantt.$task_data.scrollHeight + \"px\";\n\t}\n\tdiv.style.height = markerHeight;\n\tif(marker.end_date){\n\t\tvar end = gantt.posFromDate(marker.end_date);\n\t\tdiv.style.width = Math.max((end - start), 0) + \"px\";\n\n\t}\n\n\tif(marker.text){\n\t\tlet content = null;\n\t\tif(typeof marker.text === \"function\"){\n\t\t\tcontent = marker.text(marker);\n\t\t}else {\n\t\t\tcontent = marker.text;\n\t\t}\n\t\tif(content){\n\t\t\tif(gantt.config.external_render && gantt.config.external_render.isElement(content)){\n\t\t\t\tdiv.innerHTML = \"<div class='gantt_marker_content' ></div>\";\n\t\t\t\tgantt.config.external_render.renderElement(content, div.querySelector(\".gantt_marker_content\"));\n\t\t\t}else{\n\t\t\t\tdiv.innerHTML = \"<div class='gantt_marker_content' >\" + marker.text + \"</div>\";\n\t\t\t}\n\n\t\t}\n\n\n\t\t\n\t}\n\n\treturn div;\n}\n\nfunction initMarkerArea(){\n\t// GS-481. Reset $marker_area if there is no timeline\n\tif(!gantt.$task_data || !gantt.$root.contains(gantt.$task_data)){\n\t\tgantt.$marker_area = null;\n\t\treturn;\n\t}\n\n\t// GS-2084. Don't add $marker_area when it already exists\n\tif(gantt.$marker_area && gantt.$task_data.contains(gantt.$marker_area)){\n\t\treturn;\n\t}\n\n\tvar markerArea = document.createElement(\"div\");\n\tmarkerArea.className = \"gantt_marker_area\";\n\tgantt.$task_data.appendChild(markerArea);\n\tgantt.$marker_area = markerArea;\n}\n\ngantt.attachEvent(\"onBeforeGanttRender\", function(){\n\tif(!gantt.$marker_area)\n\t\tinitMarkerArea();\n});\n\ngantt.attachEvent(\"onDataRender\", function(){\n\tif(!gantt.$marker_area){\n\t\tinitMarkerArea();\n\t\tgantt.renderMarkers();\n\t}\n});\n\ngantt.attachEvent(\"onGanttLayoutReady\", function(){\n\t// GS-1304 - markers should attach when layout is initialized, both on gantt.init and gantt.resetLayout\n\t// wait for \"onBeforeGanttRender\", so all layout elements will be in DOM\n\tgantt.attachEvent(\"onBeforeGanttRender\", function(){\n\t\t// GS-882. If markers are rendered in the onDataRender handler, \n\t\t// they are not attached to the layer, so we need to remove the DOM elements\n\t\tif (gantt.$marker_area) {\n\t\t\tgantt.$marker_area.innerHTML = \"\";\n\t\t}\n\t\tinitMarkerArea();\n\n\t\tvar layers = gantt.$services.getService(\"layers\");\n\t\tvar markerRenderer = layers.createDataRender({\n\t\t\tname: \"marker\",\n\t\t\tdefaultContainer: function(){ return gantt.$marker_area;}\n\t\t});\n\t\tmarkerRenderer.addLayer(render_marker);\n\t}, {once: true});\n});\n\ngantt.getMarker = function(id){\n\tif(!this._markers) return null;\n\n\treturn this._markers.getItem(id);\n};\n\ngantt.addMarker = function(marker){\n\treturn this._markers.addItem(marker);\n};\n\ngantt.deleteMarker = function(id){\n\tif(!this._markers.exists(id))\n\t\treturn false;\n\n\tthis._markers.removeItem(id);\n\treturn true;\n};\ngantt.updateMarker = function(id){\n\tthis._markers.refresh(id);\n};\n\ngantt._getMarkers = function(){\n\treturn this._markers.getItems();\n};\n\ngantt.renderMarkers = function () {\n\tthis._markers.refresh();\n};\n\n};","import {replaceValidZeroId} from \"../utils/helpers\";\n\nexport default function(gantt){\n\ngantt.config.multiselect = true;\ngantt.config.multiselect_one_level = false;\n\ngantt._multiselect = {\n\t_selected: {},\n\t_one_level: false,\n\t_active: true,\n\t_first_selected_when_shift: null,\n\tgetDefaultSelected: function() {\n\t\tvar selected = this.getSelected();\n\t\treturn selected.length ? selected[selected.length - 1] : null;\n\t},\n\tsetFirstSelected: function(id) {\n\t\tthis._first_selected_when_shift = id;\n\t},\n\tgetFirstSelected: function() {\n\t\treturn this._first_selected_when_shift;\n\t},\n\tisActive: function() {\n\t\tthis.updateState();\n\t\treturn this._active;\n\t},\n\tupdateState: function() {\n\t\tthis._one_level = gantt.config.multiselect_one_level;\n\t\tvar active = this._active;\n\t\tthis._active = gantt.config.select_task;\n\t\tif (this._active != active) {\n\t\t\tthis.reset();\n\t\t}\n\t},\n\treset: function () {\n\t\tthis._selected = {};\n\t},\n\tsetLastSelected: function (id) {\n\t\tgantt.$data.tasksStore.silent(function(){\n\t\t\tvar store = gantt.$data.tasksStore;\n\t\t\tif (id)\n\t\t\t\tstore.select(id+\"\");\n\t\t\telse\n\t\t\t\tstore.unselect(null);\n\t\t});\n\t},\n\tgetLastSelected: function () {\n\t\tvar last = gantt.$data.tasksStore.getSelectedId();\n\t\tif (last && gantt.isTaskExists(last))\n\t\t\treturn last;\n\t\treturn null;\n\t},\n\tselect: function (id, e) {\n\t\tif (id && gantt.callEvent(\"onBeforeTaskMultiSelect\", [id, true, e]) && gantt.callEvent(\"onBeforeTaskSelected\", [id])) {\n\t\t\tthis._selected[id] = true;\n\t\t\tthis.setLastSelected(id);\n\t\t\tthis.afterSelect(id);\n\t\t\tgantt.callEvent(\"onTaskMultiSelect\", [id, true, e]);\n\t\t\tgantt.callEvent(\"onTaskSelected\", [id]);\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t},\n\ttoggle: function (id, e) {\n\t\tif (this._selected[id]) {\n\t\t\tthis.unselect(id, e);\n\t\t} else {\n\t\t\tthis.select(id, e);\n\t\t}\n\t},\n\tunselect: function (id, e) {\n\t\tif (id && gantt.callEvent(\"onBeforeTaskMultiSelect\", [id, false, e])) {\n\t\t\tthis._selected[id] = false;\n\t\t\tif (this.getLastSelected() == id)\n\t\t\t\tthis.setLastSelected(this.getDefaultSelected());\n\t\t\tthis.afterSelect(id);\n\t\t\tgantt.callEvent(\"onTaskMultiSelect\", [id, false, e]);\n\t\t\tgantt.callEvent(\"onTaskUnselected\", [id]);\n\t\t}\n\t},\n\tisSelected: function (id) {\n\t\treturn !!(gantt.isTaskExists(id) && this._selected[id]);\n\t},\n\tgetSelected: function () {\n\t\tvar res = [];\n\t\tfor (var i in this._selected) {\n\t\t\tif (this._selected[i] && gantt.isTaskExists(i)) {\n\t\t\t\tres.push(i);\n\t\t\t} else {\n\t\t\t\tthis._selected[i] = false;\n\t\t\t}\n\t\t}\n\t\tres.sort(function(a, b) {\n\t\t\treturn gantt.getGlobalTaskIndex(a) > gantt.getGlobalTaskIndex(b) ? 1 : -1;\n\t\t});\n\t\treturn res;\n\t},\n\tforSelected: function (callback) {\n\t\tvar selected = this.getSelected();\n\t\tfor (var i = 0; i < selected.length; i++) {\n\t\t\tcallback(selected[i]);\n\t\t}\n\t},\n\tisSameLevel: function(id) {\n\t\tif (!this._one_level)\n\t\t\treturn true;\n\t\tvar last = this.getLastSelected();\n\t\tif (!last)\n\t\t\treturn true;\n\t\tif (!(gantt.isTaskExists(last) && gantt.isTaskExists(id)))\n\t\t\treturn true;\n\t\treturn !!(gantt.calculateTaskLevel(gantt.getTask(last)) == gantt.calculateTaskLevel(gantt.getTask(id)));\n\t},\n\tafterSelect: function(id) {\n\t\tif (gantt.isTaskExists(id)){\n\t\t\t// FIXME: quick workaround to prevent re-filtering inside refresh on multiselect\n\t\t\tgantt._quickRefresh(function(){\n\t\t\t\tgantt.refreshTask(id);\n\t\t\t});\n\t\t}\n\t},\n\tdoSelection: function(e) {\n\t\tif (!this.isActive())\n\t\t\treturn false;\n\n\t\t// deny selection when click on 'expand' or 'collapse' icons\n\t\tif (gantt._is_icon_open_click(e))\n\t\t\treturn false;\n\n\t\tvar target_ev = gantt.locate(e);\n\t\tif (!target_ev)\n\t\t\treturn false;\n\n\t\tif (!gantt.callEvent(\"onBeforeMultiSelect\", [e]))\n\t\t\treturn false;\n\n\t\tvar selected = this.getSelected();\n\t\tvar defaultLast = this.getFirstSelected();\n\t\tvar isLast = false;\n\t\tvar last = this.getLastSelected();\n\t\tvar multiSelect = gantt.config.multiselect;\n\n\n\t\tvar singleSelection = (function () {\n\t\t\t// GS-719: If the multiselect extension is added we still need a way\n\t\t\t// to open the inline editors after clicking on the cells in the grid\n\t\t\tconst controller = gantt.ext.inlineEditors;\n\t\t\tif(controller && controller.getState){\n\t\t\t\tconst state = controller.getState();\n\t\t\t\tconst cell = controller.locateCell(e.target);\n\n\t\t\t\tif (gantt.config.inline_editors_multiselect_open && cell && controller.getEditorConfig(cell.columnName)) {\n\t\t\t\t\tif (controller.isVisible() && state.id == cell.id && state.columnName == cell.columnName) {\n\t\t\t\t\t\t// do nothing if editor is already active in this cell\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcontroller.startEdit(cell.id, cell.columnName);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.setFirstSelected(target_ev);\n\n\t\t\tif (!this.isSelected(target_ev)) {\n\t\t\t\tthis.select(target_ev, e);\n\t\t\t}\n\t\t\tselected = this.getSelected();\n\t\t\tfor (var i = 0; i < selected.length; i++) {\n\t\t\t\tif (selected[i] !== target_ev) {\n\t\t\t\t\tthis.unselect(selected[i], e);\n\t\t\t\t}\n\t\t\t}\n\t\t}).bind(this);\n\n\t\tvar blockSelection = (function(){\n\t\t\tif (!last)\n\t\t\t\tlast = target_ev;\n\t\t\telse if (target_ev) {\n\t\t\t\tvar first_indx = gantt.getGlobalTaskIndex(this.getFirstSelected());\n\t\t\t\tvar target_indx = gantt.getGlobalTaskIndex(target_ev);\n\t\t\t\tvar last_indx = gantt.getGlobalTaskIndex(last);\n\t\t\t\t// GS-1969: if the selected tasks are collapsed, need to remove them\n\t\t\t\tif(first_indx == -1 || last_indx == -1){\n\t\t\t\t\tfirst_indx = target_indx;\n\t\t\t\t\tthis.reset();\n\t\t\t\t}\n\t\t\t\t// clear prev selection\n\t\t\t\tvar tmp = last;\n\t\t\t\twhile (gantt.getGlobalTaskIndex(tmp) !== first_indx) {\n\t\t\t\t\tthis.unselect(tmp, e);\n\t\t\t\t\ttmp = (first_indx > last_indx) ? gantt.getNext(tmp) : gantt.getPrev(tmp);\n\t\t\t\t}\n\t\t\t\ttmp = target_ev;\n\t\t\t\twhile (gantt.getGlobalTaskIndex(tmp) !== first_indx) {\n\t\t\t\t\tif (this.select(tmp, e) && !isLast) {\n\t\t\t\t\t\tisLast = true;\n\t\t\t\t\t\tdefaultLast = tmp;\n\t\t\t\t\t}\n\t\t\t\t\ttmp = (first_indx > target_indx) ? gantt.getNext(tmp) : gantt.getPrev(tmp);\n\t\t\t\t}\n\t\t\t}\n\t\t}).bind(this);\n\n\n\t\tif (multiSelect && (e.ctrlKey || e.metaKey)) {\n\t\t\tif (!this.isSelected(target_ev))\n\t\t\t\tthis.setFirstSelected(target_ev);\n\n\t\t\tif (target_ev) {\n\t\t\t\tthis.toggle(target_ev, e);\n\t\t\t}\n\t\t}\n\n\t\telse if (multiSelect && e.shiftKey) {\n\t\t\tif (!gantt.isTaskExists(this.getFirstSelected()) || this.getFirstSelected() === null) {\n\t\t\t\tthis.setFirstSelected(target_ev);\n\t\t\t}\n\n\t\t\tif (selected.length) { // select a group of tasks\n\t\t\t\tblockSelection();\n\t\t\t}\n\t\t\telse { // select a task when no task is selected and Shift is pressed\n\t\t\t\tsingleSelection();\n\t\t\t}\n\t\t}\n\t\t\n\t\telse { // no key press or no multiple selection on the mouse click\n\t\t\tsingleSelection();\n\t\t}\n\n\n\t\tif (this.isSelected(target_ev)) {\n\t\t\tthis.setLastSelected(target_ev);\n\t\t} else if (defaultLast) {\n\t\t\tif (target_ev == last)\n\t\t\t\tthis.setLastSelected(e.shiftKey ? defaultLast : this.getDefaultSelected());\n\t\t} else {\n\t\t\tthis.setLastSelected(null);\n\t\t}\n\n\t\tif (!this.getSelected().length)\n\t\t\tthis.setLastSelected(null);\n\n\t\tif (!this.getLastSelected() || !this.isSelected(this.getFirstSelected()))\n\t\t\tthis.setFirstSelected(this.getLastSelected());\n\n\t\treturn true;\n\t}\n};\n\n(function(){\n\tvar old_selectTask = gantt.selectTask;\n\tgantt.selectTask = function(id) {\n\t\tid = replaceValidZeroId(id, this.config.root_id);\n\t\tif (!id)\n\t\t\treturn false;\n\t\tvar multiselect = gantt._multiselect;\n\t\tvar res = id;\n\t\tif (multiselect.isActive()) {\n\t\t\tif (multiselect.select(id, null)) {\n\t\t\t\tmultiselect.setLastSelected(id);\n\t\t\t}\n\t\t\tmultiselect.setFirstSelected(multiselect.getLastSelected());\n\t\t} else {\n\t\t\tres = old_selectTask.call(this, id);\n\t\t}\n\t\treturn res;\n\t};\n\n\tvar old_unselectTask = gantt.unselectTask;\n\tgantt.unselectTask = function(id) {\n\t\tvar multiselect = gantt._multiselect;\n\t\tvar isActive = multiselect.isActive();\n\t\tid = id || multiselect.getLastSelected();\n\t\tif(id && isActive) {\n\t\t\tmultiselect.unselect(id, null);\n\t\t\tif (id == multiselect.getLastSelected())\n\t\t\t\tmultiselect.setLastSelected(null);\n\t\t\tgantt.refreshTask(id);\n\t\t\tmultiselect.setFirstSelected(multiselect.getLastSelected());\n\t\t}\n\t\tvar res = id;\n\t\tif (!isActive)\n\t\t\tres = old_unselectTask.call(this, id);\n\t\treturn res;\n\t};\n\n\tgantt.toggleTaskSelection = function(id) {\n\t\tvar multiselect = gantt._multiselect;\n\t\tif (id && multiselect.isActive()) {\n\t\t\tmultiselect.toggle(id);\n\t\t\tmultiselect.setFirstSelected(multiselect.getLastSelected());\n\t\t}\n\t};\n\tgantt.getSelectedTasks = function() {\n\t\tvar multiselect = gantt._multiselect;\n\t\tmultiselect.isActive();\n\t\treturn multiselect.getSelected();\n\t};\n\tgantt.eachSelectedTask = function(callback){\n\t\treturn this._multiselect.forSelected(callback);\n\t};\n\tgantt.isSelectedTask = function(id){\n\t\treturn this._multiselect.isSelected(id);\n\t};\n\tgantt.getLastSelectedTask = function(){\n\t\treturn this._multiselect.getLastSelected();\n\t};\n\tgantt.attachEvent(\"onGanttReady\", function(){\n\t\tvar old_isSelected = gantt.$data.tasksStore.isSelected;\n\t\tgantt.$data.tasksStore.isSelected = function(id){\n\t\t\tif (gantt._multiselect.isActive()) {\n\t\t\t\treturn gantt._multiselect.isSelected(id);\n\t\t\t}\n\t\t\treturn old_isSelected.call(this, id);\n\t\t};\n\t});\n})();\n\ngantt.attachEvent(\"onTaskIdChange\", function (id, new_id) {\n\tvar multiselect = gantt._multiselect;\n\tif (!multiselect.isActive())\n\t\treturn true;\n\tif (gantt.isSelectedTask(id)) {\n\t\tmultiselect.unselect(id, null);\n\t\tmultiselect.select(new_id, null);\n\t}\n});\n\ngantt.attachEvent(\"onAfterTaskDelete\", function (id, item) {\n\tvar multiselect = gantt._multiselect;\n\tif (!multiselect.isActive())\n\t\treturn true;\n\n\tif (multiselect._selected[id]) {\n\t\t// GS-1057: don't unselect the task here because the task is already unselected \n\t\t// it was in the select.js file before it was deleted\n\t\t// multiselect.unselect(id, null);\n\t\tmultiselect._selected[id] = false;\n\t\tmultiselect.setLastSelected(multiselect.getDefaultSelected());\n\t}\n\n\tmultiselect.forSelected(function (task_id) {\n\t\tif (!gantt.isTaskExists(task_id))\n\t\t\tmultiselect.unselect(task_id, null);\n\t});\n});\n\ngantt.attachEvent(\"onBeforeTaskMultiSelect\", function(id, state, e){\n\tconst multiselect = gantt._multiselect;\n\tif (state && multiselect.isActive()) {\n\t\t//GS-1321: prevent unselecting task\n\t\tlet oldSelectedId = gantt.getSelectedId();\n\t\tlet oldSelectedTask = null;\n\t\tif (oldSelectedId) {\n\t\t\toldSelectedTask = gantt.getTask(oldSelectedId);\n\t\t}\n\t\tlet newSelectedTask = gantt.getTask(id);\n\t\tlet differentTreeLevel = false;\n\t\tif (oldSelectedTask && oldSelectedTask.$level != newSelectedTask.$level){\n\t\t\tdifferentTreeLevel = true;\n\t\t}\n\n\t\tif (gantt.config.multiselect_one_level && differentTreeLevel && !e.ctrlKey && !e.shiftKey) {\n\t\t\treturn true;\n\t\t}\n\t\tif (multiselect._one_level) {\n\t\t\treturn multiselect.isSameLevel(id);\n\t\t}\n\t}\n\treturn true;\n});\n\ngantt.attachEvent(\"onTaskClick\", function(id, e) {\n\tif (gantt._multiselect.doSelection(e))\n\t\tgantt.callEvent(\"onMultiSelect\", [e]);\n\treturn true;\n});\n\n};","export default function(gantt) {\n\tif (!gantt.ext) {\n\t\tgantt.ext = {};\n\t}\n\n\tgantt.ext.overlay = {};\n\n\tvar overlays = {};\n\n\tfunction createOverlay(id, render) {\n\t\tvar div = document.createElement(\"div\");\n\t\tdiv.setAttribute(\"data-overlay-id\", id);\n\t\tvar css = \"gantt_overlay\";\n\t\tdiv.className = css;\n\t\tdiv.style.display = \"none\";\n\t\treturn {\n\t\t\tid: id,\n\t\t\trender: render,\n\t\t\tisVisible: false,\n\t\t\tisAttached: false,\n\t\t\tnode: div\n\t\t};\n\t}\n\n\tfunction initOverlayArea() {\n\t\tif(!gantt.$task_data) {\n\t\t\treturn;\n\t\t}\n\t\tgantt.event(gantt.$task_data, \"scroll\", function(e){\n\t\t\tif (!gantt.ext.$overlay_area) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tgantt.ext.$overlay_area.style.top = e.target.scrollTop + \"px\";\n\t\t});\n\t\tvar overlayArea = document.createElement(\"div\");\n\t\toverlayArea.className = \"gantt_overlay_area\";\n\t\tgantt.$task_data.appendChild(overlayArea);\n\t\tgantt.ext.$overlay_area = overlayArea;\n\n\t\tattachUnnattached();\n\t}\n\n\tfunction attachUnnattached(){\n\t\tfor(var i in overlays){\n\t\t\tvar overlay = overlays[i];\n\t\t\tif(!overlay.isAttached){\n\t\t\t\tattachOverlay(overlay);\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction attachOverlay(overlay){\n\t\tgantt.ext.$overlay_area.appendChild(overlay.node);\n\t\toverlay.isAttached = true;\n\t}\n\n\tfunction showOverlayArea(){\n\t\tgantt.ext.$overlay_area.style.display = \"block\";\n\t}\n\n\tfunction hideIfNoVisibleLayers(){\n\t\tvar any = false;\n\t\tfor(var i in overlays){\n\t\t\tvar overlay = overlays[i];\n\t\t\tif(overlay.isVisible){\n\t\t\t\tany = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif(!any){\n\t\t\tgantt.ext.$overlay_area.style.display = \"none\";\n\t\t}\n\t}\n\n\tgantt.attachEvent(\"onBeforeGanttRender\", function() {\n\t\t//GS-2230: in case if `getGanttInstance` created without container\n\t\tif(!gantt.$root) return;\n\t\tif (!gantt.ext.$overlay_area) {\n\t\t\tinitOverlayArea();\n\t\t}\n\n\t\tif (!gantt.ext.$overlay_area.isConnected){\n\t\t\tgantt.ext.$overlay_area.innerHTML = \"\";\n\t\t\tgantt.ext.$overlay_area.remove();\n\t\t\tgantt.ext.$overlay_area = null;\n\t\t\tinitOverlayArea();\n\t\n\t\t\tfor(var i in overlays){\n\t\t\t\toverlays[i].isAttached = false;\n\t\t\t}\n\t\t}\n\n\t\tattachUnnattached();\n\t\thideIfNoVisibleLayers();\n\t});\n\n\tgantt.attachEvent(\"onGanttReady\", function() {\n\t\t//GS-2230: in case if `getGanttInstance` created without container\n\t\tif(!gantt.$root) return;\n\t\tinitOverlayArea();\n\t\tattachUnnattached();\n\t\thideIfNoVisibleLayers();\n\t});\n\n\tgantt.ext.overlay.addOverlay = function(render, id) {\n\t\tvar id = id || gantt.uid();\n\t\toverlays[id] = createOverlay(id, render);\n\t\treturn id;\n\t};\n\n\tgantt.ext.overlay.deleteOverlay = function(id) {\n\t\tif (!overlays[id])\n\t\t\treturn false;\n\n\t\tdelete overlays[id];\n\t\thideIfNoVisibleLayers();\n\t\treturn true;\n\t};\n\n\tgantt.ext.overlay.getOverlaysIds = function() {\n\t\tvar ids = [];\n\t\tfor(var i in overlays){\n\t\t\tids.push(i);\n\t\t}\n\t\treturn ids;\n\t};\n\n\tgantt.ext.overlay.refreshOverlay = function(id) {\n\t\tshowOverlayArea();\n\t\toverlays[id].isVisible = true;\n\t\toverlays[id].node.innerHTML = \"\";\n\t\toverlays[id].node.style.display = \"block\";\n\t\toverlays[id].render(overlays[id].node);\n\t};\n\n\tgantt.ext.overlay.showOverlay = function(id) {\n\t\tshowOverlayArea();\n\t\tthis.refreshOverlay(id);\n\t};\n\n\tgantt.ext.overlay.hideOverlay = function(id) {\n\n\t\toverlays[id].isVisible = false;\n\t\toverlays[id].node.style.display = \"none\";\n\t\thideIfNoVisibleLayers();\n\t};\n\tgantt.ext.overlay.isOverlayVisible = function(id) {\n\t\tif (!id) {\n\t\t\treturn false;\n\t\t}\n\t\treturn overlays[id].isVisible;\n\t};\n};","/* eslint-disable */\n\nimport ScaleHelper from \"../../core/ui/timeline/scales_ignore\";\nimport * as helpers from \"../../utils/helpers\";\n\nexport default function(gantt: any) {\n\n\tgantt.ext = gantt.ext || {};\n\n\tgantt.ext.export_api = gantt.ext.export_api || {\n\n\t\t_apiUrl: \"https://export.dhtmlx.com/gantt\",\n\n\t\t_preparePDFConfigRaw(config:any, type:any){\n\t\t\tlet previousDateRage:any = null;\n\t\t\tif (config.start && config.end){\n\t\t\t\tpreviousDateRage = {\n\t\t\t\t\tstart_date: gantt.config.start_date,\n\t\t\t\t\tend_date: gantt.config.end_date,\n\t\t\t\t};\n\t\t\t\tgantt.config.start_date = gantt.date.str_to_date(gantt.config.date_format)(config.start);\n\t\t\t\tgantt.config.end_date = gantt.date.str_to_date(gantt.config.date_format)(config.end);\n\t\t\t}\n\n\t\t\tconfig = gantt.mixin(config, {\n\t\t\t\tname: \"gantt.\" + type, data: gantt.ext.export_api._serializeHtml()\n\t\t\t});\n\n\t\t\tif (previousDateRage){\n\t\t\t\tgantt.config.start_date = previousDateRage.start_date;\n\t\t\t\tgantt.config.end_date = previousDateRage.end_date;\n\t\t\t}\n\t\t},\n\n\t\t_prepareConfigPDF(config:any, type:any){\n\t\t\tconfig = gantt.mixin((config || {}), {\n\t\t\t\tname: \"gantt.\" + type,\n\t\t\t\tdata: gantt.ext.export_api._serializeAll(),\n\t\t\t\tconfig: gantt.config\n\t\t\t});\n\t\t\tgantt.ext.export_api._fixColumns(config.config.columns);\n\t\t\treturn config;\n\t\t},\n\n\t\t_pdfExportRouter(config:any, type:any){\n\t\t\tif (config && config.raw) {\n\t\t\t\tgantt.ext.export_api._preparePDFConfigRaw(config, type);\n\t\t\t} else {\n\t\t\t\tconfig = gantt.ext.export_api._prepareConfigPDF(config, type);\n\t\t\t}\n\t\t\tconfig.version = gantt.version;\n\t\t\tgantt.ext.export_api._sendToExport(config, type);\n\t\t},\n\n\t\texportToPDF(config:any) {\n\t\t\tgantt.ext.export_api._pdfExportRouter(config, \"pdf\");\n\t\t},\n\n\t\texportToPNG(config:any) {\n\t\t\tgantt.ext.export_api._pdfExportRouter(config, \"png\");\n\t\t},\n\n\n\t\texportToICal(config:any) {\n\t\t\tconfig = gantt.mixin((config || {}), {\n\t\t\t\tname: \"gantt.ical\",\n\t\t\t\tdata: gantt.ext.export_api._serializePlain().data,\n\t\t\t\tversion: gantt.version\n\t\t\t});\n\t\t\tgantt.ext.export_api._sendToExport(config, \"ical\");\n\t\t},\n\n\t\texportToExcel(config:any) {\n\t\t\tconfig = config || {};\n\n\t\t\tlet tasks;\n\t\t\tlet dates: any = [];\n\t\t\tlet state;\n\t\t\tlet scroll;\n\t\t\t// GS-2124, we need to get all task nodes to correctly obtain the colors\n\t\t\tconst smartRendering = gantt.config.smart_rendering;\n\t\t\tif (config.visual === \"base-colors\"){\n\t\t\t\tgantt.config.smart_rendering = false;\n\t\t\t}\n\n\t\t\tif (config.start || config.end) {\n\t\t\t\tstate = gantt.getState();\n\t\t\t\tdates = [gantt.config.start_date, gantt.config.end_date];\n\t\t\t\tscroll = gantt.getScrollState();\n\t\t\t\tconst convert = gantt.date.str_to_date(gantt.config.date_format);\n\t\t\t\ttasks = gantt.eachTask;\n\n\t\t\t\tif (config.start){\n\t\t\t\t\tgantt.config.start_date = convert(config.start);\n\t\t\t\t}\n\t\t\t\tif (config.end){\n\t\t\t\t\tgantt.config.end_date = convert(config.end);\n\t\t\t\t}\n\n\t\t\t\tgantt.render();\n\t\t\t\tgantt.config.smart_rendering = smartRendering;\n\n\t\t\t\tgantt.eachTask = gantt.ext.export_api._eachTaskTimed(gantt.config.start_date, gantt.config.end_date);\n\t\t\t} else if (config.visual === \"base-colors\"){\n\t\t\t\tgantt.render();\n\t\t\t\tgantt.config.smart_rendering = smartRendering;\n\t\t\t}\n\n\t\t\tconfig = gantt.mixin(config, {\n\t\t\t\tname: \"gantt.xlsx\",\n\t\t\t\ttitle: \"Tasks\",\n\t\t\t\tdata: gantt.ext.export_api._serializeTimeline(config),\n\t\t\t\tcolumns: gantt.ext.export_api._serializeGrid({ raw: config.raw, rawDates: true }),\n\t\t\t\tversion: gantt.version\n\t\t\t});\n\n\t\t\tif (config.visual){\n\t\t\t\tconfig.scales = gantt.ext.export_api._serializeScales(config);\n\t\t\t}\n\n\t\t\tgantt.ext.export_api._sendToExport(config, \"excel\");\n\n\t\t\tif (config.start || config.end) {\n\t\t\t\tgantt.config.start_date = state.min_date;\n\t\t\t\tgantt.config.end_date = state.max_date;\n\t\t\t\tgantt.eachTask = tasks;\n\n\t\t\t\tgantt.render();\n\t\t\t\tgantt.scrollTo(scroll.x, scroll.y);\n\n\t\t\t\tgantt.config.start_date = dates[0];\n\t\t\t\tgantt.config.end_date = dates[1];\n\t\t\t}\n\t\t},\n\n\t\texportToJSON(config:any) {\n\t\t\tconfig = gantt.mixin((config || {}), {\n\t\t\t\tname: \"gantt.json\",\n\t\t\t\tdata: gantt.ext.export_api._serializeAll(),\n\t\t\t\tconfig: gantt.config,\n\t\t\t\tcolumns: gantt.ext.export_api._serializeGrid(),\n\t\t\t\tworktime: gantt.ext.export_api._getWorktimeSettings(),\n\t\t\t\tversion: gantt.version\n\t\t\t});\n\t\t\tgantt.ext.export_api._sendToExport(config, \"json\");\n\t\t},\n\n\n\t\timportFromExcel(config:any) {\n\t\t\ttry {\n\t\t\t\tconst formData = config.data;\n\t\t\t\tif (formData instanceof File) {\n\t\t\t\t\tconst data = new FormData();\n\t\t\t\t\tdata.append(\"file\", formData);\n\t\t\t\t\tconfig.data = data;\n\t\t\t\t}\n\t\t\t} catch (error) {}\n\t\t\tgantt.ext.export_api._sendImportAjaxExcel(config);\n\t\t},\n\n\t\timportFromMSProject(config:any) {\n\t\t\tconst formData = config.data;\n\t\t\ttry {\n\t\t\t\tif (formData  instanceof File) {\n\t\t\t\t\tconst data = new FormData();\n\t\t\t\t\tdata.append(\"file\", formData);\n\t\t\t\t\tconfig.data = data;\n\t\t\t\t}\n\t\t\t} catch (error) {}\n\t\t\tgantt.ext.export_api._sendImportAjaxMSP(config);\n\t\t},\n\n\t\timportFromPrimaveraP6(config:any) {\n\t\t\tconfig.type = \"primaveraP6-parse\";\n\t\t\treturn gantt.importFromMSProject(config);\n\t\t},\n\n\t\texportToMSProject(config:any) {\n\t\t\tconfig = config || {};\n\t\t\tconfig.skip_circular_links = config.skip_circular_links === undefined ? true : !!config.skip_circular_links;\n\n\t\t\tconst oldXmlFormat = gantt.templates.xml_format;\n\t\t\tconst oldFormatDate = gantt.templates.format_date;\n\t\t\tconst oldXmlDate = gantt.config.xml_date;\n\t\t\tconst oldDateFormat = gantt.config.date_format;\n\n\t\t\tconst exportServiceDateFormat = \"%d-%m-%Y %H:%i:%s\";\n\n\t\t\tgantt.config.xml_date = exportServiceDateFormat;\n\t\t\tgantt.config.date_format = exportServiceDateFormat;\n\t\t\tgantt.templates.xml_format = gantt.date.date_to_str(exportServiceDateFormat);\n\t\t\tgantt.templates.format_date = gantt.date.date_to_str(exportServiceDateFormat);\n\t\t\tconst data = gantt.ext.export_api._serializeAll();\n\n\t\t\tgantt.ext.export_api._customProjectProperties(data, config);\n\n\t\t\tgantt.ext.export_api._customTaskProperties(data, config);\n\n\t\t\tif (config.skip_circular_links) {\n\t\t\t\tgantt.ext.export_api._clearRecLinks(data);\n\t\t\t}\n\n\t\t\tconfig = gantt.ext.export_api._exportConfig(data, config);\n\n\t\t\tgantt.ext.export_api._sendToExport(config, config.type || \"msproject\");\n\t\t\tgantt.config.xml_date = oldXmlDate;\n\t\t\tgantt.config.date_format = oldDateFormat;\n\t\t\tgantt.templates.xml_format = oldXmlFormat;\n\t\t\tgantt.templates.format_date = oldFormatDate;\n\n\t\t\tgantt.config.$custom_data = null;\n\t\t\tgantt.config.custom = null;\n\t\t},\n\n\t\texportToPrimaveraP6(config:any) {\n\t\t\tconfig = config || {};\n\t\t\tconfig.type = \"primaveraP6\";\n\t\t\treturn gantt.exportToMSProject(config);\n\t\t},\n\n\t\t_fixColumns(columns:any) {\n\t\t\tfor (let i = 0; i < columns.length; i++) {\n\t\t\t\tcolumns[i].label = columns[i].label || gantt.locale.labels[\"column_\" + columns[i].name];\n\t\t\t\tif (typeof columns[i].width === \"string\") {\n\t\t\t\t\tcolumns[i].width = columns[i].width * 1;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t_xdr(url:any, pack:any, cb:any) {\n\t\t\tgantt.ajax.post(url, pack, cb);\n\t\t},\n\n\t\t_markColumns(base:any) {\n\t\t\tconst columns = base.config.columns;\n\t\t\tif (columns){\n\t\t\t\tfor (let i = 0; i < columns.length; i++) {\n\t\t\t\t\tif (columns[i].template){\n\t\t\t\t\t\tcolumns[i].$template = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\n\t\t_sendImportAjaxExcel(config:any) {\n\t\t\tconst url = config.server || gantt.ext.export_api._apiUrl;\n\t\t\tconst store = config.store || 0;\n\t\t\tconst formData = config.data;\n\t\t\tconst callback = config.callback;\n\n\t\t\tformData.append(\"type\", \"excel-parse\");\n\t\t\tformData.append(\"data\", JSON.stringify({\n\t\t\t\tsheet: config.sheet || 0\n\t\t\t}));\n\n\t\t\tif (store){\n\t\t\t\tformData.append(\"store\", store);\n\t\t\t}\n\n\t\t\tconst xhr = new XMLHttpRequest();\n\t\t\txhr.onreadystatechange = function(e) {\n\t\t\t\tif (xhr.readyState === 4 && xhr.status === 0) {// network error\n\t\t\t\t\tif (callback) {\n\t\t\t\t\t\tcallback(null);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\n\t\t\txhr.onload = function() {\n\t\t\t\tconst fail = xhr.status > 400;\n\t\t\t\tlet info = null;\n\n\t\t\t\tif (!fail) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tinfo = JSON.parse(xhr.responseText);\n\t\t\t\t\t} catch (e) { }\n\t\t\t\t}\n\n\t\t\t\tif (callback) {\n\t\t\t\t\tcallback(info);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\txhr.open(\"POST\", url, true);\n\t\t\txhr.setRequestHeader(\"X-Requested-With\", \"XMLHttpRequest\");\n\t\t\txhr.send(formData);\n\t\t},\n\n\n\t\t_ajaxToExport(data:any, type:any, callback:any) {\n\t\t\tdelete data.callback;\n\n\t\t\tconst url = data.server || gantt.ext.export_api._apiUrl;\n\t\t\tconst pack = \"type=\" + type + \"&store=1&data=\" + encodeURIComponent(JSON.stringify(data));\n\n\t\t\tconst cb = function(loader:any) {\n\t\t\t\tconst xdoc = loader.xmlDoc || loader;\n\t\t\t\tconst fail = xdoc.status > 400;\n\t\t\t\tlet info = null;\n\n\t\t\t\tif (!fail) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tinfo = JSON.parse(xdoc.responseText);\n\t\t\t\t\t} catch (e) { }\n\t\t\t\t}\n\t\t\t\tcallback(info);\n\t\t\t};\n\n\t\t\tgantt.ext.export_api._xdr(url, pack, cb);\n\t\t},\n\t\t_serializableGanttConfig(config:any) {\n\t\t\tconst result = gantt.mixin({}, config);\n\n\t\t\tif (result.columns) {\n\t\t\t\tresult.columns = result.columns.map(function(col:any) {\n\t\t\t\t\tconst copy = gantt.mixin({}, col);\n\t\t\t\t\tdelete copy.editor;\n\t\t\t\t\treturn copy;\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tdelete result.editor_types;\n\t\t\treturn result;\n\t\t},\n\n\t\t_sendToExport(data:any, type:any) {\n\t\t\tconst convert = gantt.date.date_to_str(gantt.config.date_format || gantt.config.xml_date);\n\t\t\tif(!data.skin){\n\t\t\t\tdata.skin = gantt.skin;\n\t\t\t}\n\t\t\tif (data.config) {\n\t\t\t\tdata.config = gantt.copy(gantt.ext.export_api._serializableGanttConfig(data.config));\n\t\t\t\tgantt.ext.export_api._markColumns(data, type);\n\n\t\t\t\tif (data.config.start_date && data.config.end_date) {\n\t\t\t\t\tif (data.config.start_date instanceof Date) {\n\t\t\t\t\t\tdata.config.start_date = convert(data.config.start_date);\n\t\t\t\t\t}\n\t\t\t\t\tif (data.config.end_date instanceof Date) {\n\t\t\t\t\t\tdata.config.end_date = convert(data.config.end_date);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (data.callback) {\n\t\t\t\treturn gantt.ext.export_api._ajaxToExport(data, type, data.callback);\n\t\t\t}\n\n\t\t\tconst form = gantt.ext.export_api._createHiddenForm();\n\t\t\tform.firstChild.action = data.server || gantt.ext.export_api._apiUrl;\n\t\t\tform.firstChild.childNodes[0].value = JSON.stringify(data);\n\t\t\tform.firstChild.childNodes[1].value = type;\n\t\t\tform.firstChild.submit();\n\t\t},\n\n\t\t_createHiddenForm() {\n\t\t\tif (!gantt.ext.export_api._hidden_export_form) {\n\t\t\t\tconst t = gantt.ext.export_api._hidden_export_form = document.createElement(\"div\");\n\t\t\t\tt.style.display = \"none\";\n\t\t\t\tt.innerHTML = \"<form method='POST' target='_blank'><textarea name='data' style='width:0px; height:0px;' readonly='true'></textarea><input type='hidden' name='type' value=''></form>\";\n\t\t\t\tdocument.body.appendChild(t);\n\t\t\t}\n\t\t\treturn gantt.ext.export_api._hidden_export_form;\n\t\t},\n\n\n\t\t_copyObjectBase(obj: any) {\n\t\t\tconst copy: any = {\n\t\t\t\tstart_date: undefined,\n\t\t\t\tend_date: undefined,\n\t\t\t\tconstraint_date: undefined,\n\t\t\t\tdeadline: undefined\n\t\t\t};\n\t\t\tfor (const key in obj) {\n\t\t\t\tif (key.charAt(0) === \"$\" || key === \"baselines\"){\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tcopy[key] = obj[key];\n\t\t\t}\n\t\t\tconst formatDate = gantt.templates.xml_format || gantt.templates.format_date;\n\n\t\t\tcopy.start_date = formatDate(copy.start_date);\n\t\t\tif (copy.end_date){\n\t\t\t\tcopy.end_date = formatDate(copy.end_date);\n\t\t\t}\n\t\t\tif (copy.constraint_date){\n\t\t\t\tcopy.constraint_date = formatDate(copy.constraint_date);\n\t\t\t}\n\t\t\tif (copy.deadline){\n\t\t\t\tcopy.deadline = formatDate(copy.deadline);\n\t\t\t}\n\n\t\t\treturn copy;\n\t\t},\n\n\n\t\t_color_box: null,\n\t\t_color_hash: {},\n\n\t\t_getStyles(css:any) {\n\t\t\tif (!gantt.ext.export_api._color_box) {\n\t\t\t\tgantt.ext.export_api._color_box = document.createElement(\"DIV\");\n\t\t\t\tgantt.ext.export_api._color_box.style.cssText = \"position:absolute; display:none;\";\n\t\t\t\tdocument.body.appendChild(gantt.ext.export_api._color_box);\n\t\t\t}\n\t\t\tif (gantt.ext.export_api._color_hash[css]){\n\t\t\t\treturn gantt.ext.export_api._color_hash[css];\n\t\t\t}\n\n\t\t\tgantt.ext.export_api._color_box.className = css;\n\t\t\tconst color = gantt.ext.export_api._getColor(gantt.ext.export_api._color_box, \"color\");\n\t\t\tconst backgroundColor = gantt.ext.export_api._getColor(gantt.ext.export_api._color_box, \"backgroundColor\");\n\t\t\treturn (gantt.ext.export_api._color_hash[css] = color + \";\" + backgroundColor);\n\t\t},\n\n\n\t\t_getMinutesWorktimeSettings(parsedRanges:any) {\n\t\t\tconst minutes:any = [];\n\t\t\tparsedRanges.forEach(function(range:any) {\n\t\t\t\tminutes.push(range.startMinute);\n\t\t\t\tminutes.push(range.endMinute);\n\t\t\t});\n\t\t\treturn minutes;\n\t\t},\n\n\t\t_getWorktimeSettings() {\n\n\t\t\tconst defaultWorkTimes = {\n\t\t\t\thours: [0, 24],\n\t\t\t\tminutes: null,\n\t\t\t\tdates: { 0: true, 1: true, 2: true, 3: true, 4: true, 5: true, 6: true }\n\t\t\t};\n\n\t\t\tlet time: any;\n\t\t\tif (!gantt.config.work_time) {\n\t\t\t\ttime = defaultWorkTimes;\n\t\t\t} else {\n\t\t\t\tconst wTime = gantt._working_time_helper;\n\t\t\t\tif (wTime && wTime.get_calendar) {\n\t\t\t\t\ttime = wTime.get_calendar();\n\t\t\t\t} else if (wTime) {\n\t\t\t\t\ttime = {\n\t\t\t\t\t\thours: wTime.hours,\n\t\t\t\t\t\tminutes: null,\n\t\t\t\t\t\tdates: wTime.dates\n\t\t\t\t\t};\n\t\t\t\t} else if (gantt.config.worktimes && gantt.config.worktimes.global) {\n\t\t\t\t\tconst settings = gantt.config.worktimes.global;\n\n\t\t\t\t\tif (settings.parsed) {\n\t\t\t\t\t\tconst minutes = gantt.ext.export_api._getMinutesWorktimeSettings(settings.parsed.hours);\n\t\t\t\t\t\ttime = {\n\t\t\t\t\t\t\thours: null,\n\t\t\t\t\t\t\tminutes,\n\t\t\t\t\t\t\tdates: {}\n\t\t\t\t\t\t};\n\t\t\t\t\t\tfor (const i in settings.parsed.dates) {\n\t\t\t\t\t\t\tif (Array.isArray(settings.parsed.dates[i])) {\n\t\t\t\t\t\t\t\ttime.dates[i] = gantt.ext.export_api._getMinutesWorktimeSettings(settings.parsed.dates[i]);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\ttime.dates[i] = settings.parsed.dates[i];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttime = {\n\t\t\t\t\t\t\thours: settings.hours,\n\t\t\t\t\t\t\tminutes: null,\n\t\t\t\t\t\t\tdates: settings.dates\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\t\t\t\t\ttime = defaultWorkTimes;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn time;\n\t\t},\n\n\n\t\t_eachTaskTimed(start:any, end:any) {\n\t\t\treturn function(code:any, parent:any, master:any) {\n\t\t\t\tparent = parent || gantt.config.root_id;\n\t\t\t\tmaster = master || gantt;\n\n\t\t\t\tconst branch = gantt.getChildren(parent);\n\t\t\t\tif (branch){\n\t\t\t\t\tfor (let i = 0; i < branch.length; i++) {\n\t\t\t\t\t\tconst item = gantt._pull[branch[i]];\n\t\t\t\t\t\tif ((!start || item.end_date > start) && (!end || item.start_date < end)){\n\t\t\t\t\t\t\tcode.call(master, item);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (gantt.hasChild(item.id)){\n\t\t\t\t\t\t\tgantt.eachTask(code, item.id, master);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\n\n\t\t// patch broken json serialization in gantt 2.1\n\t\t_originalCopyObject: gantt.json._copyObject,\n\n\t\t_copyObjectPlainICal(task: any) {\n\t\t\tconst text = gantt.templates.task_text(task.start_date, task.end_date, task);\n\n\t\t\tconst copy = gantt.ext.export_api._copyObjectBase(task);\n\t\t\tcopy.text = text || copy.text;\n\n\t\t\treturn copy;\n\t\t},\n\n\t\t_copyObjectPlainExcel(task: any) {\n\t\t\tconst text = gantt.templates.task_text(task.start_date, task.end_date, task);\n\n\t\t\tconst copy = gantt.json.serializeTask(task);\n\t\t\tcopy.text = text || copy.text;\n\n\t\t\treturn copy;\n\t\t},\n\n\t\t_getColor(node:any, style:any) {\n\t\t\tlet value = node.currentStyle ? node.currentStyle[style] : getComputedStyle(node, null)[style];\n\t\t\t// if we get the black background color for the progress bar, \n\t\t\t// most likely, it is the transparent color.\n\t\t\t// In that case, we need to confirm that and return the color of the task bar\n\t\t\tif (node.closest(\".gantt_task_progress\") && value === \"rgba(0, 0, 0, 0.15)\"){\n\t\t\t\tnode = node.parentNode.parentNode;\n\t\t\t\tvalue = node.currentStyle ? node.currentStyle[style] : getComputedStyle(node, null)[style];\n\t\t\t}\n\t\t\tconst rgb = value.replace(/\\s/g, \"\").match(/^rgba?\\((\\d+),(\\d+),(\\d+)/i);\n\t\t\treturn ((rgb && rgb.length === 4) ?\n\t\t\t\t(\"0\" + parseInt(rgb[1], 10).toString(16)).slice(-2) +\n\t\t\t\t(\"0\" + parseInt(rgb[2], 10).toString(16)).slice(-2) +\n\t\t\t\t(\"0\" + parseInt(rgb[3], 10).toString(16)).slice(-2) : value).replace(\"#\", \"\");\n\t\t},\n\n\n\t\t// excel serialization\n\t\t_copyObjectTable(obj:any) {\n\t\t\t// Excel interprets UTC time as local time in every timezone, send local time instead of actual UTC time.\n\t\t\t// https://github.com/SheetJS/js-xlsx/issues/126#issuecomment-60531614\n\t\t\tconst toISOstring = gantt.date.date_to_str(\"%Y-%m-%dT%H:%i:%s.000Z\");\n\n\t\t\tconst copy = gantt.ext.export_api._copyObjectColumns(obj, gantt.ext.export_api._copyObjectPlainExcel(obj));\n\t\t\tif (copy.start_date){\n\t\t\t\tif (typeof copy.start_date === \"string\"){\n\t\t\t\t\tcopy.original_start_date = gantt.date.str_to_date(gantt.config.date_format)(copy.start_date);\n\t\t\t\t} else {\n\t\t\t\t\tcopy.original_start_date = copy.start_date;\n\t\t\t\t\tcopy.start_date = toISOstring(obj.start_date);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (copy.end_date){\n\t\t\t\tif (typeof copy.end_date === \"string\"){\n\t\t\t\t\tcopy.original_end_date = gantt.date.str_to_date(gantt.config.date_format)(copy.end_date);\n\t\t\t\t} else {\n\t\t\t\t\tcopy.original_end_date = copy.end_date;\n\t\t\t\t\tcopy.end_date = toISOstring(obj.end_date);\n\t\t\t\t}\n\t\t\t} else if (copy.original_start_date){\n\t\t\t\tcopy.original_end_date = gantt.calculateEndDate({\n\t\t\t\t\tstart_date: copy.original_start_date,\n\t\t\t\t\tduration: copy.duration,\n\t\t\t\t\ttask: copy\n\t\t\t\t});\n\t\t\t\tcopy.end_date = toISOstring(copy.original_end_date);\n\t\t\t}\n\n\t\t\treturn copy;\n\t\t},\n\n\t\t_generatedScales: null,\n\t\t_generateScales(){\n\t\t\tconst state = gantt.getState();\n\t\t\tconst scaleHelper = ScaleHelper(gantt);\n\t\t\tconst scales = [scaleHelper.primaryScale(gantt.config)].concat(scaleHelper.getSubScales(gantt.config));\n\n\t\t\tconst scalesConfig = scaleHelper.prepareConfigs(scales, gantt.config.min_column_width, 1000, gantt.config.scale_height - 1, state.min_date, state.max_date, gantt.config.rtl);\n\t\t\tgantt.ext.export_api._generatedScales = scalesConfig;\n\t\t\treturn scalesConfig;\n\t\t},\n\n\t\t_getDayIndex (scales:any, date:any){\n\t\t\tlet days = scales.trace_indexes\n\t\t\tif (days[+date]) {\n\t\t\t\treturn days[+date]\n\t\t\t} else {\n\t\t\t\tdays = scales.trace_x;\n\t\t\t\tconst state = gantt.getState();\n\n\t\t\t\tif (+date <= state.min_date) {\n\t\t\t\t\tif (gantt.config.rtl) {\n\t\t\t\t\t\treturn days.length;\n\t\t\t\t\t} else{\n\t\t\t\t\t\treturn 0;\n\t\t\t\t\t}\n\t\t\t\t} else if (+date >= state.max_date) {\n\t\t\t\t\tif (gantt.config.rtl) {\n\t\t\t\t\t\treturn 0;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn days.length;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tconst index = helpers.findBinary(days, +date);\n\t\t\t\treturn index;\n\t\t\t}\n\t\t},\n\n\t\t_copyObjectColors(obj:any, config:any) {\n\t\t\tconst copy = gantt.ext.export_api._copyObjectTable(obj);\n\n\t\t\tlet startDate = copy.original_start_date;\n\t\t\tlet endDate = copy.original_end_date;\n\n\t\t\tlet getDayIndex = gantt.columnIndexByDate;\n\n\t\t\tlet scales;\n\t\t\tif (gantt.ext.export_api._generatedScales){ \n\t\t\t\tconst allScales = gantt.ext.export_api._generatedScales;\n\t\t\t\tscales = allScales[allScales.length - 1];\n\n\t\t\t\tcopy.$start = gantt.ext.export_api._getDayIndex(scales, startDate);\n\t\t\t\tcopy.$end = gantt.ext.export_api._getDayIndex(scales, endDate);\n\t\t\t} else {\n\t\t\t\tscales = gantt.getScale();\n\t\t\t\tcopy.$start = getDayIndex.call(gantt, startDate);\n\t\t\t\tcopy.$end = getDayIndex.call(gantt, endDate);\n\t\t\t}\n\n\t\t\t// GS-2100. Correct bar position considering hidden cells\n\t\t\tlet hiddenCells = 0;\n\t\t\tconst scaleCellsWidth = scales.width;\n\t\t\tif (scaleCellsWidth.indexOf(0) > -1) {\n\t\t\t\tlet i = 0;\n\t\t\t\tfor (i; i < copy.$start; i++) {\n\t\t\t\t\tif (!scaleCellsWidth[i]) {\n\t\t\t\t\t\thiddenCells++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcopy.$start -= hiddenCells;\n\n\t\t\t\tfor (i; i < copy.$end; i++) {\n\t\t\t\t\tif (!scaleCellsWidth[i]) {\n\t\t\t\t\t\thiddenCells++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcopy.$end -= hiddenCells;\n\t\t\t}\n\n\t\t\tcopy.$level = obj.$level;\n\t\t\tcopy.$type = obj.$rendered_type;\n\n\t\t\tconst tmps = gantt.templates;\n\t\t\tcopy.$text = tmps.task_text(obj.start, obj.end_date, obj);\n\t\t\tcopy.$left = tmps.leftside_text ? tmps.leftside_text(obj.start, obj.end_date, obj) : \"\";\n\t\t\tcopy.$right = tmps.rightside_text ? tmps.rightside_text(obj.start, obj.end_date, obj) : \"\";\n\n\t\t\tconst node = gantt.getTaskNode && gantt.getTaskNode(obj.id);\n\t\t\tif (node && node.firstChild) {\n\t\t\t\tlet targetNode = node;\n\t\t\t\tif (config.visual !== \"base-colors\"){\n\t\t\t\t\ttargetNode = node.querySelector(\".gantt_task_progress\")\n\t\t\t\t}\n\n\t\t\t\tlet color = gantt.ext.export_api._getColor(targetNode, \"backgroundColor\");\n\t\t\t\tif (color === \"363636\"){\n\t\t\t\t\tcolor = gantt.ext.export_api._getColor(node, \"backgroundColor\");\n\t\t\t\t}\n\n\t\t\t\tcopy.$color = color;\n\t\t\t} else if (obj.color){\n\t\t\t\tcopy.$color = obj.color;\n\t\t\t} else {\n\t\t\t\tconst cellCss = gantt.templates.task_class(obj.start, obj.end, obj);\n\t\t\t\tif (cellCss){\n\t\t\t\t\tconst styles = gantt.ext.export_api._getStyles(cellCss);\n\t\t\t\t\tcopy.$color = styles.split(\";\")[1]\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn copy;\n\t\t},\n\n\t\t_copyObjectColumns(obj:any, copy:any) {\n\t\t\tfor (let i = 0; i < gantt.config.columns.length; i++) {\n\t\t\t\tconst ct = gantt.config.columns[i].template;\n\t\t\t\tif (ct) {\n\t\t\t\t\tlet val = ct(obj);\n\t\t\t\t\tif (val instanceof Date){\n\t\t\t\t\t\tval = gantt.templates.date_grid(val, obj);\n\t\t\t\t\t}\n\t\t\t\t\tcopy[\"_\" + i] = val;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn copy;\n\t\t},\n\n\t\t_copyObjectAll(obj:any) {\n\t\t\tconst copy = gantt.ext.export_api._copyObjectBase(obj);\n\n\t\t\tconst templates = [\n\t\t\t\t\"leftside_text\",\n\t\t\t\t\"rightside_text\",\n\t\t\t\t\"task_text\",\n\t\t\t\t\"progress_text\",\n\t\t\t\t\"task_class\"\n\t\t\t];\n\n\t\t\t// serialize all text templates\n\t\t\tfor (let i = 0; i < templates.length; i++) {\n\t\t\t\tconst template = gantt.templates[templates[i]];\n\t\t\t\tif (template){\n\t\t\t\t\tcopy[\"$\" + i] = template(obj.start_date, obj.end_date, obj);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tgantt.ext.export_api._copyObjectColumns(obj, copy);\n\t\t\tcopy.open = obj.$open;\n\t\t\treturn copy;\n\t\t},\n\n\n\t\t_serializeHtml() {\n\t\t\tconst smartScales = gantt.config.smart_scales;\n\t\t\tconst smartRendering = gantt.config.smart_rendering;\n\t\t\tif (smartScales || smartRendering) {\n\t\t\t\tgantt.config.smart_rendering = false;\n\t\t\t\tgantt.config.smart_scales = false;\n\t\t\t\tgantt.render();\n\t\t\t}\n\n\t\t\tconst html = gantt.$container.parentNode.innerHTML;\n\n\t\t\tif (smartScales || smartRendering) {\n\t\t\t\tgantt.config.smart_scales = smartScales;\n\t\t\t\tgantt.config.smart_rendering = smartRendering;\n\t\t\t\tgantt.render();\n\t\t\t}\n\n\t\t\treturn html;\n\t\t},\n\n\t\t_serializeAll() {\n\t\t\tgantt.json._copyObject = gantt.ext.export_api._copyObjectAll;\n\t\t\tconst data = gantt.ext.export_api._exportSerialize();\n\t\t\tgantt.json._copyObject = gantt.ext.export_api._originalCopyObject;\n\t\t\treturn data;\n\t\t},\n\n\t\t_serializePlain() {\n\t\t\tconst oldXmlFormat = gantt.templates.xml_format;\n\t\t\tconst oldFormatDate = gantt.templates.format_date;\n\t\t\tgantt.templates.xml_format = gantt.date.date_to_str(\"%Y%m%dT%H%i%s\", true);\n\t\t\tgantt.templates.format_date = gantt.date.date_to_str(\"%Y%m%dT%H%i%s\", true);\n\t\t\tgantt.json._copyObject = gantt.ext.export_api._copyObjectPlainICal;\n\n\t\t\tconst data = gantt.ext.export_api._exportSerialize();\n\n\t\t\tgantt.templates.xml_format = oldXmlFormat;\n\t\t\tgantt.templates.format_date = oldFormatDate;\n\t\t\tgantt.json._copyObject = gantt.ext.export_api._originalCopyObject;\n\n\t\t\tdelete data.links;\n\t\t\treturn data;\n\t\t},\n\n\t\t_getRaw() {\n\t\t\tconst timeline = gantt.$ui.getView(\"timeline\");\n\t\t\tif (timeline && gantt.config.show_chart) {\n\t\t\t\tlet availWidth = timeline.$config.width;\n\t\t\t\tif (gantt.config.autosize === \"x\" || gantt.config.autosize === \"xy\") {\n\t\t\t\t\tavailWidth = Math.max(gantt.config.autosize_min_width, 0);\n\t\t\t\t}\n\t\t\t\tconst state = gantt.getState();\n\t\t\t\tconst scales = timeline._getScales();\n\t\t\t\tconst minWidth = gantt.config.min_column_width;\n\t\t\t\tconst height = gantt.config.scale_height - 1;\n\t\t\t\tconst rtl = gantt.config.rtl;\n\n\t\t\t\treturn timeline.$scaleHelper.prepareConfigs(scales, minWidth, availWidth, height, state.min_date, state.max_date, rtl);\n\t\t\t} else {\n\t\t\t\treturn gantt.ext.export_api._generateScales();\n\t\t\t}\n\t\t},\n\n\t\t_serializeTimeline(config:any) {\n\t\t\tgantt.ext.export_api._generatedScales = null;\n\t\t\tlet scales;\n\t\t\tif (config.visual){\n\t\t\t\tscales = gantt.ext.export_api._getRaw(config.start, config.end);\n\t\t\t}\n\t\t\tif (config.data){\n\t\t\t\tconfig.custom_dataset = true;\n\t\t\t}\n\n\t\t\tlet tasks = config.data || gantt.serialize().data;\n\t\t\ttasks.forEach(function(task:any, index:any){\n\t\t\t\tif (config.visual){\n\t\t\t\t\t// Save split tasks dates inside the parent object\n\t\t\t\t\tif (task.render == \"split\"){\n\t\t\t\t\t\tconst children:any = [];\n\t\t\t\t\t\tif (config.custom_dataset){\n\t\t\t\t\t\t\ttasks.forEach(function(child:any){\n\t\t\t\t\t\t\t\tif (child.parent == task.id){\n\t\t\t\t\t\t\t\t\tconst childBar = gantt.ext.export_api._copyObjectColors(child, config);\n\t\t\t\t\t\t\t\t\tchildBar.$split_subtask = true;\n\t\t\t\t\t\t\t\t\tchildren.push(childBar);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tgantt.eachTask(function(child:any){\n\t\t\t\t\t\t\t\tconst childBar = gantt.ext.export_api._copyObjectColors(child, config);\n\t\t\t\t\t\t\t\tchildren.push(childBar);\n\t\t\t\t\t\t\t}, task.id);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\ttask.split_bars = [];\n\n\t\t\t\t\t\t// Skip overlap children\n\t\t\t\t\t\tconst skippedTasks:any = {};\n\t\t\t\t\t\tfor (let i = 0; i < children.length; i++) {\n\t\t\t\t\t\t\tconst child = children[i];\n\t\t\t\t\t\t\tfor (let j = 0; j < children.length; j++) {\n\t\t\t\t\t\t\t\tconst sibling = children[j];\n\t\t\t\t\t\t\t\tif (child.id == sibling.id || skippedTasks[sibling.id]){\n\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tconst overlap = +child.original_start_date < +sibling.original_start_date && +sibling.original_start_date <= +child.original_end_date;\n\t\t\t\t\t\t\t\t// const overlap = +child.original_start_date < +sibling.original_end_date && +sibling.original_end_date <= +child.original_end_date;\n\t\t\t\t\t\t\t\tconst cover = +sibling.original_start_date <= +child.original_start_date && +child.original_end_date <= +sibling.original_end_date;\n\t\t\t\t\t\t\t\tif (overlap){\n\t\t\t\t\t\t\t\t\tchild.original_end_date = sibling.original_start_date;\n\t\t\t\t\t\t\t\t\tchild.end_date = sibling.start_date;\n\t\t\t\t\t\t\t\t\tchild.$end = sibling.$start;\n\t\t\t\t\t\t\t\t\t// child.original_start_date = sibling.original_end_date;\n\t\t\t\t\t\t\t\t\t// child.start_date = sibling.end_date;\n\t\t\t\t\t\t\t\t\t// child.$start = sibling.$end;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (cover){\n\t\t\t\t\t\t\t\t\t// skip the task as it won't be visible\n\t\t\t\t\t\t\t\t\tskippedTasks[child.id] = true;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (!skippedTasks[child.id]){\n\t\t\t\t\t\t\t\ttask.split_bars.push(child)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\ttasks[index] = task;\n\t\t\t\t\t} else if (!task.$split_subtask){\n\t\t\t\t\t\ttasks[index] = gantt.ext.export_api._copyObjectColors(task, config);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\ttasks[index] = gantt.ext.export_api._copyObjectTable(task);\n\t\t\t\t}\n\t\t\t})\n\n\t\t\t// Filter tasks\n\t\t\tif (config.raw && !config.data){\n\t\t\t\tconst taskStore = gantt.getDatastore(\"task\");\n\t\t\t\tconst filteredIds = taskStore.visibleOrder;\n\t\t\t\tif (tasks.length !== filteredIds.length){\n\t\t\t\t\tconst filteredDataset:any = [];\n\t\t\t\t\ttasks.forEach(function(task:any){\n\t\t\t\t\t\tif (filteredIds.indexOf(task.id) > -1){\n\t\t\t\t\t\t\tfilteredDataset.push(task);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\ttasks = filteredDataset;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (config.cellColors) {\n\t\t\t\tconst css = gantt.templates.timeline_cell_class || gantt.templates.task_cell_class;\n\t\t\t\tif (css) {\n\t\t\t\t\tlet steps = scales[0].trace_x;\n\t\t\t\t\tfor (let i = 1; i < scales.length; i++){\n\t\t\t\t\t\tif (scales[i].trace_x.length > steps.length){\n\t\t\t\t\t\t\tsteps = scales[i].trace_x;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tfor (let i = 0; i < tasks.length; i++) {\n\t\t\t\t\t\ttasks[i].styles = [];\n\t\t\t\t\t\tconst task = gantt.getTask(tasks[i].id);\n\t\t\t\t\t\tfor (let j = 0; j < steps.length; j++) {\n\t\t\t\t\t\t\tconst date = steps[j];\n\t\t\t\t\t\t\tconst cellCss = css(task, date);\n\t\t\t\t\t\t\tif (cellCss){\n\t\t\t\t\t\t\t\ttasks[i].styles.push({ index: j, styles: gantt.ext.export_api._getStyles(cellCss) });\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn tasks;\n\t\t},\n\n\t\t_serializeScales(config:any) {\n\t\t\tconst scales:any = [];\n\t\t\tconst raw = gantt.ext.export_api._getRaw();\n\n\t\t\tlet min = Infinity;\n\t\t\tlet max = 0;\n\t\t\tfor (let i = 0; i < raw.length; i++) {\n\t\t\t\tmin = Math.min(min, raw[i].col_width);\n\t\t\t}\n\n\t\t\tfor (let i = 0; i < raw.length; i++) {\n\t\t\t\tlet start = 0;\n\t\t\t\tlet end = 0;\n\t\t\t\tconst row:any = [];\n\n\t\t\t\tscales.push(row);\n\t\t\t\tconst step = raw[i];\n\t\t\t\tmax = Math.max(max, step.trace_x.length);\n\t\t\t\tconst template = step.format || step.template || gantt.date.date_to_str(step.date);\n\n\t\t\t\tfor (let j = 0; j < step.trace_x.length; j++) {\n\t\t\t\t\tconst date = step.trace_x[j];\n\t\t\t\t\tend = start + Math.round(step.width[j] / min);\n\n\t\t\t\t\tconst scaleCell = { text: template(date), start, end, styles: \"\" };\n\n\t\t\t\t\tif (config.cellColors) {\n\t\t\t\t\t\tconst css = step.css || gantt.templates.scaleCell_class;\n\t\t\t\t\t\tif (css) {\n\t\t\t\t\t\t\tconst scaleCss = css(date);\n\t\t\t\t\t\t\tif (scaleCss){\n\t\t\t\t\t\t\t\tscaleCell.styles = gantt.ext.export_api._getStyles(scaleCss);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\trow.push(scaleCell);\n\t\t\t\t\tstart = end;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn { width: max, height: scales.length, data: scales };\n\t\t},\n\n\t\t_serializeGrid(config:any) {\n\t\t\tgantt.exportMode = true;\n\n\t\t\tconst columns:any = [];\n\t\t\tconst cols = gantt.config.columns;\n\n\t\t\tlet ccount = 0;\n\t\t\tfor (let i = 0; i < cols.length; i++) {\n\t\t\t\tif (cols[i].name === \"add\" || cols[i].name === \"buttons\") {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif (config && config.raw && cols[i].hide){\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tcolumns[ccount] = {\n\t\t\t\t\tid: ((cols[i].template) ? (\"_\" + i) : cols[i].name),\n\t\t\t\t\theader: cols[i].label || gantt.locale.labels[\"column_\" + cols[i].name],\n\t\t\t\t\twidth: (cols[i].width ? Math.floor(cols[i].width / 4) : \"\"),\n\t\t\t\t\ttree: cols[i].tree || false\n\t\t\t\t};\n\n\t\t\t\tif (cols[i].name === \"duration\"){\n\t\t\t\t\tcolumns[ccount].type = \"number\";\n\t\t\t\t}\n\t\t\t\tif (cols[i].name === \"start_date\" || cols[i].name === \"end_date\") {\n\t\t\t\t\tcolumns[ccount].type = \"date\";\n\t\t\t\t\tif (config && config.rawDates){\n\t\t\t\t\t\tcolumns[ccount].id = cols[i].name;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tccount++;\n\t\t\t}\n\n\t\t\tgantt.exportMode = false;\n\t\t\treturn columns;\n\t\t},\n\n\t\t_exportSerialize() {\n\t\t\tgantt.exportMode = true;\n\n\t\t\tconst xmlFormat = gantt.templates.xml_format;\n\t\t\tconst formatDate = gantt.templates.format_date;\n\n\t\t\t// use configuration date format for serialization so date could be parsed on the export\n\t\t\t// required when custom format date function is defined\n\t\t\tgantt.templates.xml_format =\n\t\t\t\tgantt.templates.format_date =\n\t\t\t\tgantt.date.date_to_str(gantt.config.date_format || gantt.config.xml_date);\n\n\t\t\tconst data = gantt.serialize();\n\n\t\t\tgantt.templates.xml_format = xmlFormat;\n\t\t\tgantt.templates.format_date = formatDate;\n\t\t\tgantt.exportMode = false;\n\t\t\treturn data;\n\t\t},\n\n\n\t\t_setLevel(data:any) {\n\t\t\tfor (let i = 0; i < data.length; i++) {\n\t\t\t\t// tslint:disable-next-line triple-equals\n\t\t\t\tif (data[i].parent == 0) {\n\t\t\t\t\tdata[i]._lvl = 1;\n\t\t\t\t}\n\t\t\t\tfor (let j = i + 1; j < data.length; j++) {\n\t\t\t\t\t// tslint:disable-next-line triple-equals\n\t\t\t\t\tif (data[i].id == data[j].parent) {\n\t\t\t\t\t\tdata[j]._lvl = data[i]._lvl + 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t_clearLevel(data:any) {\n\t\t\tfor (let i = 0; i < data.length; i++) {\n\t\t\t\tdelete data[i]._lvl;\n\t\t\t}\n\t\t},\n\n\t\t_clearRecLinks(data:any) {\n\t\t\tgantt.ext.export_api._setLevel(data.data);\n\t\t\tconst tasks:any = {};\n\t\t\tfor (let i = 0; i < data.data.length; i++) {\n\t\t\t\ttasks[data.data[i].id] = data.data[i];\n\t\t\t}\n\n\t\t\tconst links:any = {};\n\n\t\t\tfor (let i = 0; i < data.links.length; i++) {\n\t\t\t\tconst link = data.links[i];\n\t\t\t\tif (gantt.isTaskExists(link.source) && gantt.isTaskExists(link.target) &&\n\t\t\t\t\ttasks[link.source] && tasks[link.target]) {\n\t\t\t\t\tlinks[link.id] = link;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor (const j in links) {\n\t\t\t\tgantt.ext.export_api._makeLinksSameLevel(links[j], tasks);\n\t\t\t}\n\n\t\t\tconst skippedLinks = {};\n\t\t\tfor (const j in tasks) {\n\t\t\t\tgantt.ext.export_api._clearCircDependencies(tasks[j], links, tasks, {}, skippedLinks, null);\n\t\t\t}\n\n\t\t\tif (Object.keys(links)) {\n\t\t\t\tgantt.ext.export_api._clearLinksSameLevel(links, tasks);\n\t\t\t}\n\n\t\t\tfor (let i = 0; i < data.links.length; i++) {\n\t\t\t\tif (!links[data.links[i].id]) {\n\t\t\t\t\tdata.links.splice(i, 1);\n\t\t\t\t\ti--;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tgantt.ext.export_api._clearLevel(data.data);\n\t\t},\n\n\t\t_clearCircDependencies(task:any, links:any, tasks:any, usedTasks:any, skippedLinks:any, prevLink:any) {\n\t\t\tconst sources = task.$_source;\n\t\t\tif (!sources) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (usedTasks[task.id]) {\n\t\t\t\tgantt.ext.export_api._onCircDependencyFind(prevLink, links, usedTasks, skippedLinks);\n\t\t\t}\n\n\t\t\tusedTasks[task.id] = true;\n\n\t\t\tconst targets:any = {};\n\n\t\t\tfor (let i = 0; i < sources.length; i++) {\n\t\t\t\tif (skippedLinks[sources[i]]) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tconst curLink = links[sources[i]];\n\t\t\t\tconst targetTask = tasks[curLink._target];\n\t\t\t\tif (targets[targetTask.id]) { // two link from one task to another\n\t\t\t\t\tgantt.ext.export_api._onCircDependencyFind(curLink, links, usedTasks, skippedLinks);\n\t\t\t\t}\n\t\t\t\ttargets[targetTask.id] = true;\n\t\t\t\tgantt.ext.export_api._clearCircDependencies(targetTask, links, tasks, usedTasks, skippedLinks, curLink);\n\t\t\t}\n\t\t\tusedTasks[task.id] = false;\n\t\t},\n\n\t\t_onCircDependencyFind(link:any, links:any, usedTasks:any, skippedLinks:any) {\n\t\t\tif (link) {\n\t\t\t\tif (gantt.callEvent(\"onExportCircularDependency\", [link.id, link])) {\n\t\t\t\t\tdelete links[link.id];\n\t\t\t\t}\n\n\t\t\t\tdelete usedTasks[link._source];\n\t\t\t\tdelete usedTasks[link._target];\n\t\t\t\tskippedLinks[link.id] = true;\n\t\t\t}\n\t\t},\n\n\t\t_makeLinksSameLevel(link:any, tasks:any) {\n\t\t\tlet task;\n\t\t\tlet targetLvl;\n\t\t\tconst linkT:any = {\n\t\t\t\ttarget: tasks[link.target],\n\t\t\t\tsource: tasks[link.source]\n\t\t\t};\n\t\t\t// tslint:disable-next-line triple-equals\n\t\t\tif (linkT.target._lvl != linkT.source._lvl) {\n\t\t\t\tif (linkT.target._lvl < linkT.source._lvl) {\n\t\t\t\t\ttask = \"source\";\n\t\t\t\t\ttargetLvl = linkT.target._lvl;\n\t\t\t\t} else {\n\t\t\t\t\ttask = \"target\";\n\t\t\t\t\ttargetLvl = linkT.source._lvl;\n\t\t\t\t}\n\n\t\t\t\tdo {\n\t\t\t\t\tconst parent = tasks[linkT[task].parent];\n\t\t\t\t\tif (!parent) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tlinkT[task] = parent;\n\t\t\t\t} while (linkT[task]._lvl < targetLvl);\n\n\t\t\t\tlet sourceParent = tasks[linkT.source.parent];\n\t\t\t\tlet\ttargetParent = tasks[linkT.target.parent];\n\t\t\t\t// tslint:disable-next-line triple-equals\n\t\t\t\twhile (sourceParent && targetParent && sourceParent.id != targetParent.id) {\n\t\t\t\t\tlinkT.source = sourceParent;\n\t\t\t\t\tlinkT.target = targetParent;\n\t\t\t\t\tsourceParent = tasks[linkT.source.parent];\n\t\t\t\t\ttargetParent = tasks[linkT.target.parent];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlink._target = linkT.target.id;\n\t\t\tlink._source = linkT.source.id;\n\n\t\t\tif (!linkT.target.$_target){\n\t\t\t\tlinkT.target.$_target = [];\n\t\t\t}\n\t\t\tlinkT.target.$_target.push(link.id);\n\n\t\t\tif (!linkT.source.$_source){\n\t\t\t\tlinkT.source.$_source = [];\n\t\t\t}\n\t\t\tlinkT.source.$_source.push(link.id);\n\t\t},\n\n\t\t_clearLinksSameLevel(links:any, tasks:any) {\n\t\t\tfor (const link in links) {\n\t\t\t\tdelete links[link]._target;\n\t\t\t\tdelete links[link]._source;\n\t\t\t}\n\n\t\t\tfor (const task in tasks) {\n\t\t\t\tdelete tasks[task].$_source;\n\t\t\t\tdelete tasks[task].$_target;\n\t\t\t}\n\t\t},\n\n\n\t\t_customProjectProperties(data:any, config:any) {\n\t\t\tif (config && config.project) {\n\t\t\t\tfor (const i in config.project) {\n\t\t\t\t\tif (!gantt.config.$custom_data){\n\t\t\t\t\t\tgantt.config.$custom_data = {};\n\t\t\t\t\t}\n\t\t\t\t\tgantt.config.$custom_data[i] = typeof config.project[i] === \"function\" ? config.project[i](gantt.config) : config.project[i];\n\t\t\t\t}\n\t\t\t\tdelete config.project;\n\t\t\t}\n\t\t},\n\n\t\t_customTaskProperties(data:any, config:any) {\n\t\t\tif (config && config.tasks) {\n\t\t\t\tdata.data.forEach(function(el:any) {\n\t\t\t\t\tfor (const i in config.tasks) {\n\t\t\t\t\t\tif (!el.$custom_data){\n\t\t\t\t\t\t\tel.$custom_data = {};\n\t\t\t\t\t\t}\n\t\t\t\t\t\tel.$custom_data[i] = typeof config.tasks[i] === \"function\" ? config.tasks[i](el, gantt.config) : config.tasks[i];\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tdelete config.tasks;\n\t\t\t}\n\t\t},\n\n\t\t_exportConfig(data:any, config:any) {\n\t\t\tconst projectName = config.name || \"gantt.xml\";\n\t\t\tdelete config.name;\n\n\t\t\tgantt.config.custom = config;\n\n\t\t\tconst time = gantt.ext.export_api._getWorktimeSettings();\n\n\t\t\tconst projectDates = gantt.getSubtaskDates();\n\t\t\tif (projectDates.start_date && projectDates.end_date) {\n\t\t\t\tconst formatDate = gantt.templates.format_date || gantt.templates.xml_format;\n\t\t\t\tgantt.config.start_end = {\n\t\t\t\t\tstart_date: formatDate(projectDates.start_date),\n\t\t\t\t\tend_date: formatDate(projectDates.end_date)\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tconst autoSchedulingConfig = gantt._getAutoSchedulingConfig();\n\n\t\t\tconst manual = !!(autoSchedulingConfig.enabled);\n\n\t\t\tconst res:any = {\n\t\t\t\tcallback: config.callback || null,\n\t\t\t\tconfig: gantt.config,\n\t\t\t\tdata,\n\t\t\t\tmanual,\n\t\t\t\tname: projectName,\n\t\t\t\tworktime: time\n\t\t\t};\n\t\t\tfor (const i in config) {\n\t\t\t\tres[i] = config[i];\n\t\t\t}\n\t\t\treturn res;\n\t\t},\n\n\n\t\t_sendImportAjaxMSP(config:any) {\n\t\t\tconst url = config.server || gantt.ext.export_api._apiUrl;\n\t\t\tconst store = config.store || 0;\n\t\t\tconst formData = config.data;\n\t\t\tconst callback = config.callback;\n\n\t\t\tconst settings = {\n\t\t\t\tdurationUnit: config.durationUnit || undefined,\n\t\t\t\tprojectProperties: config.projectProperties || undefined,\n\t\t\t\ttaskProperties: config.taskProperties || undefined\n\t\t\t};\n\n\t\t\tformData.append(\"type\", config.type || \"msproject-parse\");\n\t\t\tformData.append(\"data\", JSON.stringify(settings));\n\n\t\t\tif (store){\n\t\t\t\tformData.append(\"store\", store);\n\t\t\t}\n\n\t\t\tconst xhr = new XMLHttpRequest();\n\t\t\txhr.onreadystatechange = function(e) {\n\t\t\t\tif (xhr.readyState === 4 && xhr.status === 0) {// network error\n\t\t\t\t\tif (callback) {\n\t\t\t\t\t\tcallback(null);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\n\t\t\txhr.onload = function(){\n\t\t\t\tconst fail = xhr.status > 400;\n\t\t\t\tlet info = null;\n\n\t\t\t\tif (!fail) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tinfo = JSON.parse(xhr.responseText);\n\t\t\t\t\t} catch (e) { }\n\t\t\t\t}\n\n\t\t\t\tif (callback) {\n\t\t\t\t\tcallback(info);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\txhr.open(\"POST\", url, true);\n\t\t\txhr.setRequestHeader(\"X-Requested-With\", \"XMLHttpRequest\");\n\t\t\txhr.send(formData);\n\t\t}\n\n\t};\n\n\n\tgantt.exportToPDF = gantt.ext.export_api.exportToPDF;\n\tgantt.exportToPNG = gantt.ext.export_api.exportToPNG;\n\tgantt.exportToICal = gantt.ext.export_api.exportToICal;\n\tgantt.exportToExcel = gantt.ext.export_api.exportToExcel;\n\tgantt.exportToJSON = gantt.ext.export_api.exportToJSON;\n\tgantt.importFromExcel = gantt.ext.export_api.importFromExcel;\n\tgantt.importFromMSProject = gantt.ext.export_api.importFromMSProject;\n\tgantt.exportToMSProject = gantt.ext.export_api.exportToMSProject;\n\tgantt.importFromPrimaveraP6 = gantt.ext.export_api.importFromPrimaveraP6;\n\tgantt.exportToPrimaveraP6 = gantt.ext.export_api.exportToPrimaveraP6;\n\n\n\treturn gantt.ext.export_api;\n}\n","export default {\n\tKEY_CODES: {\n\t\tUP: 38,\n\t\tDOWN: 40,\n\t\tLEFT: 37,\n\t\tRIGHT: 39,\n\t\tSPACE: 32,\n\t\tENTER: 13,\n\t\tDELETE: 46,\n\t\tESC: 27,\n\t\tTAB: 9\n\t}\n};","export default class ExtensionsManager{\n\tprivate _extensions:{[key:string]: GanttPlugin };\n\n\tconstructor(config: {[key:string]: GanttPlugin }){\n\t\tthis._extensions = {};\n\t\tfor(const i in config){\n\t\t\tthis._extensions[i] = config[i];\n\t\t}\n\t}\n\n\taddExtension = (name: string, ext: GanttPlugin) => {\n\t\tthis._extensions[name] = ext;\n\t};\n\n\tgetExtension = (name: string): GanttPlugin => {\n\t\treturn this._extensions[name];\n\t};\n}","import global from \"./global\";\n\n/* eslint-disable no-restricted-globals */\nvar isWindowAwailable = typeof window !== \"undefined\";\n\n/* eslint-enable no-restricted-globals */\n\nconst nav = typeof navigator !== \"undefined\" ? navigator : {userAgent:\"\"};\n\nexport default {\n\tisIE: isWindowAwailable && (nav.userAgent.indexOf(\"MSIE\") >= 0 || nav.userAgent.indexOf(\"Trident\") >= 0),\n\tisOpera: isWindowAwailable && (nav.userAgent.indexOf(\"Opera\") >= 0 || nav.userAgent.indexOf(\"OPR\") >= 0),\n\tisChrome: isWindowAwailable && (nav.userAgent.indexOf(\"Chrome\") >= 0),\n\tisSafari: isWindowAwailable && (nav.userAgent.indexOf(\"Safari\") >= 0 || nav.userAgent.indexOf(\"Konqueror\") >= 0),\n\tisFF: isWindowAwailable && (nav.userAgent.indexOf(\"Firefox\") >= 0),\n\tisIPad: isWindowAwailable && (nav.userAgent.search(/iPad/gi) >= 0),\n\tisEdge: isWindowAwailable && (nav.userAgent.indexOf(\"Edge\")!=-1),\n\tisNode: (!isWindowAwailable || typeof navigator == \"undefined\" || (typeof PRODUCTION !== \"undefined\" && PRODUCTION === \"test\")),\n\tisSalesforce: isWindowAwailable && (!!global[\"Sfdc\"] || !!global[\"$A\"] || global[\"Aura\"])\n};\n","export default function serialize(data: object | string) {\n\tif (typeof data === \"string\" || typeof data === \"number\") {\n\t\treturn data;\n\t}\n\n\tlet result = \"\";\n\n\tfor (const key in data) {\n\t\tlet serialized = \"\";\n\t\tif (data.hasOwnProperty(key)) {\n\t\t\tif (typeof data[key] === \"string\") {\n\t\t\t\tserialized = encodeURIComponent(data[key]);\n\t\t\t} else if (typeof data[key] === \"number\") {\n\t\t\t\tserialized = String(data[key]);\n\t\t\t} else {\n\t\t\t\tserialized = encodeURIComponent(JSON.stringify(data[key]));\n\t\t\t}\n\t\t\tserialized = key + \"=\" + serialized;\n\n\t\t\tif (result.length) {\n\t\t\t\tserialized = \"&\" + serialized;\n\t\t\t}\n\t\t\tresult += serialized;\n\t\t}\n\t}\n\treturn result;\n}\n","import env from \"../../utils/env\";\nimport global from \"../../utils/global\";\nimport serialize from \"./serialize\";\n\nfunction createConfig(method, args) {\n\tvar result = {\n\t\tmethod: method\n\t};\n\n\tif (args.length === 0) {\n\t\tthrow new Error(\"Arguments list of query is wrong.\");\n\t}\n\tif (args.length === 1) {\n\t\tif (typeof args[0] === \"string\") {\n\t\t\tresult.url = args[0];\n\t\t\tresult.async = true;\n\t\t} else {\n\t\t\tresult.url = args[0].url;\n\t\t\tresult.async = (args[0].async || true);\n\t\t\tresult.callback = args[0].callback;\n\t\t\tresult.headers = args[0].headers;\n\t\t}\n\t\tif (method === \"POST\" || \"PUT\") {\n\t\t\tif (args[0].data) {\n\t\t\t\tif (typeof args[0].data !== \"string\") {\n\t\t\t\t\tresult.data = serialize(args[0].data);\n\t\t\t\t} else {\n\t\t\t\t\tresult.data = args[0].data;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tresult.data = \"\";\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tresult.url = args[0];\n\tswitch(method) {\n\t\tcase \"GET\":\n\t\tcase \"DELETE\":\n\t\t\tresult.callback = args[1];\n\t\t\tresult.headers = args[2];\n\t\tbreak;\n\t\tcase \"POST\":\n\t\tcase \"PUT\":\n\t\t\tif (args[1]) {\n\t\t\t\tif (typeof args[1] !== \"string\") {\n\t\t\t\t\tresult.data = serialize(args[1]);\n\t\t\t\t} else {\n\t\t\t\t\tresult.data = args[1];\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tresult.data = \"\";\n\t\t\t}\n\t\t\tresult.callback = args[2];\n\t\t\tresult.headers = args[3];\n\t\tbreak;\n\t}\n\treturn result;\n}\n\nexport default function(gantt) {\n\treturn {\n\n\t\t// if false - dhxr param will added to prevent caching on client side (default),\n\t\t// if true - do not add extra params\n\t\tcache: true,\n\n\t\t// default method for load/loadStruct, post/get allowed\n\t\t// get - since 4.1.1, this should fix 412 error for macos safari\n\t\tmethod: \"get\",\n\n\t\tparse: function(data) {\n\t\t\tif (typeof data !== \"string\") return data;\n\n\t\t\tvar obj;\n\t\t\tdata = data.replace(/^[\\s]+/,\"\");\n\t\t\tif (typeof DOMParser !== \"undefined\" && !env.isIE) { // ff,ie9\n\t\t\t\tobj = (new DOMParser()).parseFromString(data, \"text/xml\");\n\t\t\t} else if (typeof global.ActiveXObject !== \"undefined\") {\n\t\t\t\tobj = new global.ActiveXObject(\"Microsoft.XMLDOM\");\n\t\t\t\tobj.async = \"false\";\n\t\t\t\tobj.loadXML(data);\n\t\t\t}\n\t\t\treturn obj;\n\t\t},\n\t\txmltop: function(tagname, xhr, obj) {\n\t\t\tif (typeof xhr.status == \"undefined\" || xhr.status < 400) {\n\t\t\t\tvar xml = (!xhr.responseXML) ? this.parse(xhr.responseText || xhr) : (xhr.responseXML || xhr);\n\t\t\t\tif (xml && xml.documentElement !== null && !xml.getElementsByTagName(\"parsererror\").length) {\n\t\t\t\t\treturn xml.getElementsByTagName(tagname)[0];\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (obj !== -1) gantt.callEvent(\"onLoadXMLError\",[\"Incorrect XML\", arguments[1], obj]);\n\t\t\treturn document.createElement(\"DIV\");\n\t\t},\n\t\txpath: function(xpathExp, docObj) {\n\t\t\tif (!docObj.nodeName) docObj = docObj.responseXML || docObj;\n\t\t\tif (env.isIE) {\n\t\t\t\treturn docObj.selectNodes(xpathExp)||[];\n\t\t\t} else {\n\t\t\t\tvar rows = [];\n\t\t\t\tvar first;\n\t\t\t\tvar col = (docObj.ownerDocument||docObj).evaluate(xpathExp, docObj, null, XPathResult.ANY_TYPE, null);\n\n\t\t\t\twhile (true){\n\t\t\t\t\tfirst = col.iterateNext();\n\t\t\t\t\tif(first){\n\t\t\t\t\t\trows.push(first);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn rows;\n\t\t\t}\n\t\t},\n\t\tquery: function(config) {\n\t\t\treturn this._call(\n\t\t\t\t(config.method || \"GET\"),\n\t\t\t\tconfig.url,\n\t\t\t\tconfig.data || \"\",\n\t\t\t\t(config.async || true),\n\t\t\t\tconfig.callback,\n\t\t\t\tconfig.headers\n\t\t\t);\n\t\t},\n\t\tget: function(url, onLoad, headers) {\n\t\t\tvar config = createConfig(\"GET\", arguments);\n\t\t\treturn this.query(config);\n\t\t},\n\t\tgetSync: function(url, headers) {\n\t\t\tvar config = createConfig(\"GET\", arguments);\n\t\t\tconfig.async = false;\n\t\t\treturn this.query(config);\n\t\t},\n\t\tput: function(url, postData, onLoad, headers) {\n\t\t\tvar config = createConfig(\"PUT\", arguments);\n\t\t\treturn this.query(config);\n\t\t},\n\t\tdel: function(url, onLoad, headers) {\n\t\t\t/**\n\t\t\t * https://tools.ietf.org/html/rfc7231#section-4.3.5\n\t\t\t * A payload within a DELETE request message has no defined semantics;\n\t\t\t * sending a payload body on a DELETE request might cause some existing\n\t\t\t * implementations to reject the request.\n\t\t\t */\n\t\t\tvar config = createConfig(\"DELETE\", arguments);\n\t\t\treturn this.query(config);\n\t\t},\n\t\tpost: function(url, postData, onLoad, headers) {\n\t\t\tif (arguments.length == 1) {\n\t\t\t\tpostData = \"\";\n\t\t\t} else if (arguments.length == 2 && typeof(postData) == \"function\") {\n\t\t\t\tonLoad = postData;\n\t\t\t\tpostData = \"\";\n\t\t\t}\n\t\t\tvar config = createConfig(\"POST\", arguments);\n\t\t\treturn this.query(config);\n\t\t},\n\t\tpostSync: function(url, postData, headers) {\n\t\t\tpostData = (postData === null ? \"\" : String(postData));\n\n\t\t\tvar config = createConfig(\"POST\", arguments);\n\t\t\tconfig.async = false;\n\t\t\treturn this.query(config);\n\t\t},\n\t\t_call: function(method, url, postData, async, onLoad, headers) {\n\t\t\treturn new gantt.Promise(function(resolve, reject) {\n\t\t\t\tvar t = (typeof XMLHttpRequest !== undefined ? new XMLHttpRequest() : new global.ActiveXObject(\"Microsoft.XMLHTTP\"));\n\t\t\t\tvar isQt = (navigator.userAgent.match(/AppleWebKit/) !== null && navigator.userAgent.match(/Qt/) !== null && navigator.userAgent.match(/Safari/) !== null);\n\n\t\t\t\tif (!!async) {\n\t\t\t\t\tt.onreadystatechange = function() {\n\t\t\t\t\t\tif ((t.readyState == 4) || (isQt && t.readyState == 3)) { // what for long response and status 404?\n\t\t\t\t\t\t\tconst errorStatus = t.status < 200 || t.status > 299;\n\t\t\t\t\t\t\tif (errorStatus || t.responseText === \"\")\n\t\t\t\t\t\t\t\tif (!gantt.callEvent(\"onAjaxError\", [t])) return;\n\n\t\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\t\tif (typeof(onLoad) == \"function\") {\n\t\t\t\t\t\t\t\t\tonLoad.apply(global, [{xmlDoc:t, filePath:url}]); // dhtmlx-compat, response.xmlDoc.responseXML/responseText\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tresolve(t);\n\t\t\t\t\t\t\t\tif (typeof(onLoad) == \"function\") {\n\t\t\t\t\t\t\t\t\tonLoad = null;\n\t\t\t\t\t\t\t\t\tt = null;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}, 0);\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tvar noCache = !this || !this.cache;\n\t\t\t\tif (method == \"GET\" && noCache) {\n\t\t\t\t\turl += (url.indexOf(\"?\")>=0?\"&\":\"?\")+\"dhxr\"+new Date().getTime()+\"=1\";\n\t\t\t\t}\n\n\t\t\t\tt.open(method, url, async);\n\n\t\t\t\tif (headers){\n\t\t\t\t\tfor (var key in headers)\n\t\t\t\t\t\tt.setRequestHeader(key, headers[key]);\n\t\t\t\t} else if (method.toUpperCase() == \"POST\" || method == \"PUT\" || method == \"DELETE\") {\n\t\t\t\t\tt.setRequestHeader(\"Content-Type\", \"application/x-www-form-urlencoded\");\n\t\t\t\t} else if (method == \"GET\") {\n\t\t\t\t\tpostData = null;\n\t\t\t\t}\n\n\t\t\t\tt.setRequestHeader(\"X-Requested-With\", \"XMLHttpRequest\");\n\n\t\t\t\tt.send(postData);\n\n\t\t\t\tif (!async) return {xmlDoc:t, filePath:url}; // dhtmlx-compat, response.xmlDoc.responseXML/responseText\n\t\t\t});\n\t\t},\n\t\turlSeparator: function(str){\n\t\t\tif (str.indexOf(\"?\") != -1)\n\t\t\t\treturn \"&\";\n\t\t\telse\n\t\t\t\treturn \"?\";\n\t\t}\n\t};\n};\n","const dateToStr = (format: string, utc: boolean, gantt) => {\n\tformat = format.replace(/%[a-zA-Z]/g, (a) => {\n\t\tswitch (a) {\n\t\t\tcase \"%d\":\n\t\t\t\treturn `\"+to_fixed(date.get${utc?\"UTC\":\"\"}Date())+\"`;\n\t\t\tcase \"%m\":\n\t\t\t\treturn `\"+to_fixed((date.get${utc?\"UTC\":\"\"}Month()+1))+\"`;\n\t\t\tcase \"%j\":\n\t\t\t\treturn `\"+date.get${utc?\"UTC\":\"\"}Date()+\"`;\n\t\t\tcase \"%n\":\n\t\t\t\treturn `\"+(date.get${utc?\"UTC\":\"\"}Month()+1)+\"`;\n\t\t\tcase \"%y\":\n\t\t\t\treturn `\"+to_fixed(date.get${utc?\"UTC\":\"\"}FullYear()%100)+\"`;\n\t\t\tcase \"%Y\":\n\t\t\t\treturn `\"+date.get${utc?\"UTC\":\"\"}FullYear()+\"`;\n\t\t\tcase \"%D\":\n\t\t\t\treturn `\"+locale.date.day_short[date.get${utc?\"UTC\":\"\"}Day()]+\"`;\n\t\t\tcase \"%l\":\n\t\t\t\treturn `\"+locale.date.day_full[date.get${utc?\"UTC\":\"\"}Day()]+\"`;\n\t\t\tcase \"%M\":\n\t\t\t\treturn `\"+locale.date.month_short[date.get${utc?\"UTC\":\"\"}Month()]+\"`;\n\t\t\tcase \"%F\":\n\t\t\t\treturn `\"+locale.date.month_full[date.get${utc?\"UTC\":\"\"}Month()]+\"`;\n\t\t\tcase \"%h\":\n\t\t\t\treturn `\"+to_fixed((date.get${utc?\"UTC\":\"\"}Hours()+11)%12+1)+\"`;\n\t\t\tcase \"%g\":\n\t\t\t\treturn `\"+((date.get${utc?\"UTC\":\"\"}Hours()+11)%12+1)+\"`;\n\t\t\tcase \"%G\":\n\t\t\t\treturn `\"+date.get${utc?\"UTC\":\"\"}Hours()+\"`;\n\t\t\tcase \"%H\":\n\t\t\t\treturn `\"+to_fixed(date.get${utc?\"UTC\":\"\"}Hours())+\"`;\n\t\t\tcase \"%i\":\n\t\t\t\treturn `\"+to_fixed(date.get${utc?\"UTC\":\"\"}Minutes())+\"`;\n\t\t\tcase \"%a\":\n\t\t\t\treturn `\"+(date.get${utc?\"UTC\":\"\"}Hours()>11?\"pm\":\"am\")+\"`;\n\t\t\tcase \"%A\":\n\t\t\t\treturn `\"+(date.get${utc?\"UTC\":\"\"}Hours()>11?\"PM\":\"AM\")+\"`;\n\t\t\tcase \"%s\":\n\t\t\t\treturn `\"+to_fixed(date.get${utc?\"UTC\":\"\"}Seconds())+\"`;\n\t\t\tcase \"%W\":\n\t\t\t\treturn `\"+to_fixed(getISOWeek(date))+\"`;\n\t\t\tcase \"%w\":\n\t\t\t\treturn `\"+to_fixed(getWeek(date))+\"`;\n\t\t\tdefault:\n\t\t\t\treturn a;\n\t\t}\n\t});\n\n\t// tslint:disable-next-line: function-constructor\n\tconst dateToStrFn = new Function(\"date\", \"to_fixed\", \"locale\", \"getISOWeek\", \"getWeek\", `return \"${format}\";`);\n\n\treturn (date: Date) => {\n\t\treturn dateToStrFn(date, gantt.date.to_fixed, gantt.locale, gantt.date.getISOWeek, gantt.date.getWeek);\n\t};\n};\n\n\nconst strToDate = (format: string, utc: boolean, gantt:any) => {\n\tlet splt = \"var temp=date.match(/[a-zA-Z]+|[0-9]+/g);\";\n\tconst mask = format.match(/%[a-zA-Z]/g);\n\tfor (let i = 0; i < mask.length; i++) {\n\t\tswitch (mask[i]) {\n\t\t\tcase \"%j\":\n\t\t\tcase \"%d\":\n\t\t\t\tsplt += `set[2]=temp[${i}]||1;`;\n\t\t\t\tbreak;\n\t\t\tcase \"%n\":\n\t\t\tcase \"%m\":\n\t\t\t\tsplt += `set[1]=(temp[${i}]||1)-1;`;\n\t\t\t\tbreak;\n\t\t\tcase \"%y\":\n\t\t\t\tsplt += `set[0]=temp[${i}]*1+(temp[${i}]>50?1900:2000);`;\n\t\t\t\tbreak;\n\t\t\tcase \"%g\":\n\t\t\tcase \"%G\":\n\t\t\tcase \"%h\":\n\t\t\tcase \"%H\":\n\t\t\t\tsplt += `set[3]=temp[${i}]||0;`;\n\t\t\t\tbreak;\n\t\t\tcase \"%i\":\n\t\t\t\tsplt += `set[4]=temp[${i}]||0;`;\n\t\t\t\tbreak;\n\t\t\tcase \"%Y\":\n\t\t\t\tsplt += `set[0]=temp[${i}]||0;`;\n\t\t\t\tbreak;\n\t\t\tcase \"%a\":\n\t\t\tcase \"%A\":\n\t\t\t\tsplt += `set[3]=set[3]%12+((temp[${i}]||'').toLowerCase()=='am'?0:12);`;\n\t\t\t\tbreak;\n\t\t\tcase \"%s\":\n\t\t\t\tsplt += `set[5]=temp[${i}]||0;`;\n\t\t\t\tbreak;\n\t\t\tcase \"%M\":\n\t\t\t\tsplt += `set[1]=locale.date.month_short_hash[temp[${i}]]||0;`;\n\t\t\t\tbreak;\n\t\t\tcase \"%F\":\n\t\t\t\tsplt += `set[1]=locale.date.month_full_hash[temp[${i}]]||0;`;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\t}\n\tlet code = \"set[0],set[1],set[2],set[3],set[4],set[5]\";\n\tif (utc) { code = ` Date.UTC(${code})`; }\n\t// tslint:disable-next-line: function-constructor\n\tconst strToDateFn = new Function(\"date\", \"locale\", `var set=[0,0,1,0,0,0]; ${splt} return new Date(${code});`);\n\n\treturn (dateString) => {\n\t\treturn strToDateFn(dateString, gantt.locale);\n\t};\n};\n\nconst fastVersion = {\n\tdate_to_str: dateToStr,\n\tstr_to_date: strToDate\n};\n\nexport default fastVersion;","const dateToStr = (format: string, utc: boolean, gantt) => {\n\treturn (date) => {\n\t\treturn format.replace(/%[a-zA-Z]/g, (a) => {\n\t\t\tswitch (a) {\n\t\t\t\tcase \"%d\": return utc ? gantt.date.to_fixed(date.getUTCDate()) : gantt.date.to_fixed(date.getDate());\n\t\t\t\tcase \"%m\": return utc ? gantt.date.to_fixed((date.getUTCMonth() + 1)) : gantt.date.to_fixed((date.getMonth() + 1));\n\t\t\t\tcase \"%j\": return utc ? date.getUTCDate() : date.getDate();\n\t\t\t\tcase \"%n\": return utc ? (date.getUTCMonth() + 1) : (date.getMonth() + 1);\n\t\t\t\tcase \"%y\": return utc ? gantt.date.to_fixed(date.getUTCFullYear() % 100) : gantt.date.to_fixed(date.getFullYear() % 100);\n\t\t\t\tcase \"%Y\": return utc ? date.getUTCFullYear() : date.getFullYear();\n\t\t\t\tcase \"%D\": return utc ? gantt.locale.date.day_short[date.getUTCDay()] : gantt.locale.date.day_short[date.getDay()];\n\t\t\t\tcase \"%l\": return utc ? gantt.locale.date.day_full[date.getUTCDay()] : gantt.locale.date.day_full[date.getDay()];\n\t\t\t\tcase \"%M\": return utc ? gantt.locale.date.month_short[date.getUTCMonth()] : gantt.locale.date.month_short[date.getMonth()];\n\t\t\t\tcase \"%F\": return utc ? gantt.locale.date.month_full[date.getUTCMonth()] : gantt.locale.date.month_full[date.getMonth()];\n\t\t\t\tcase \"%h\": return utc ? gantt.date.to_fixed((date.getUTCHours() + 11) % 12 + 1) : gantt.date.to_fixed((date.getHours() + 11) % 12 + 1);\n\t\t\t\tcase \"%g\": return utc ? ((date.getUTCHours() + 11) % 12 + 1) : ((date.getHours() + 11) % 12 + 1);\n\t\t\t\tcase \"%G\": return utc ? date.getUTCHours() : date.getHours();\n\t\t\t\tcase \"%H\": return utc ? gantt.date.to_fixed(date.getUTCHours()) : gantt.date.to_fixed(date.getHours());\n\t\t\t\tcase \"%i\": return utc ? gantt.date.to_fixed(date.getUTCMinutes()) : gantt.date.to_fixed(date.getMinutes());\n\t\t\t\tcase \"%a\": return utc ? (date.getUTCHours() > 11 ? \"pm\" : \"am\") : (date.getHours() > 11 ? \"pm\" : \"am\");\n\t\t\t\tcase \"%A\": return utc ? (date.getUTCHours() > 11 ? \"PM\" : \"AM\") : (date.getHours() > 11 ? \"PM\" : \"AM\");\n\t\t\t\tcase \"%s\": return utc ? gantt.date.to_fixed(date.getUTCSeconds()) : gantt.date.to_fixed(date.getSeconds());\n\t\t\t\tcase \"%W\": return utc ? gantt.date.to_fixed(gantt.date.getUTCISOWeek(date)) : gantt.date.to_fixed(gantt.date.getISOWeek(date));\n\t\t\t\tcase \"%w\": return gantt.date.to_fixed(gantt.date.getWeek(date));\n\t\t\t\tdefault: return a;\n\t\t\t}\n\t\t});\n\t};\n};\nconst strToDate = (format: string, utc: boolean, gantt:any) => {\n\treturn (date: string) => {\n\t\tconst set: Array<string|number> = [0, 0, 1, 0, 0, 0];\n\t\tconst temp = date.match(/[a-zA-Z]+|[0-9]+/g);\n\t\tconst mask = format.match(/%[a-zA-Z]/g);\n\n\t\tfor (let i = 0; i < mask.length; i++) {\n\t\t\tswitch (mask[i]) {\n\t\t\t\tcase \"%j\":\n\t\t\t\tcase \"%d\":\n\t\t\t\t\tset[2] = temp[i] as unknown as number || 1;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%n\":\n\t\t\t\tcase \"%m\":\n\t\t\t\t\tset[1] = (temp[i] as unknown as number || 1) - 1;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%y\":\n\t\t\t\t\tset[0] = temp[i] as unknown as number * 1 + ((temp[i] as unknown as number) > 50 ? 1900 : 2000);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%g\":\n\t\t\t\tcase \"%G\":\n\t\t\t\tcase \"%h\":\n\t\t\t\tcase \"%H\":\n\t\t\t\t\tset[3] = temp[i] as unknown as number || 0;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%i\":\n\t\t\t\t\tset[4] = temp[i] as unknown as number || 0;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%Y\":\n\t\t\t\t\tset[0] = temp[i] as unknown as number || 0;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%a\":\n\t\t\t\tcase \"%A\":\n\t\t\t\t\tset[3] = set[3] as number % 12 + ((temp[i] || \"\").toLowerCase() === \"am\" ? 0 : 12);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%s\":\n\t\t\t\t\tset[5] = temp[i] || 0;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%M\":\n\t\t\t\t\tset[1] = gantt.locale.date.month_short_hash[temp[i]] || 0;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%F\":\n\t\t\t\t\tset[1] = gantt.locale.date.month_full_hash[temp[i]] || 0;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (utc) {\n\t\t\treturn new Date(Date.UTC(\n\t\t\t\tset[0] as number,\n\t\t\t\tset[1] as number,\n\t\t\t\tset[2] as number,\n\t\t\t\tset[3] as number,\n\t\t\t\tset[4] as number,\n\t\t\t\tset[5] as number\n\t\t\t));\n\t\t}\n\t\treturn new Date(\n\t\t\tset[0] as number,\n\t\t\tset[1] as number,\n\t\t\tset[2] as number,\n\t\t\tset[3] as number,\n\t\t\tset[4] as number,\n\t\t\tset[5] as number\n\t\t);\n\t};\n\n};\n\n\nconst cspVersion = {\n\tdate_to_str: dateToStr,\n\tstr_to_date: strToDate\n};\n\nexport default cspVersion;","/*\n %d - the day as a number with a leading zero ( 01 to 31 );\n %j - the day as a number without a leading zero ( 1 to 31 );\n %D - the day as an abbreviation ( Sun to Sat );\n %l - the day as a full name ( Sunday to Saturday );\n %W - the ISO-8601 week number of the year. Weeks start on Monday; 1)\n %m - the month as a number without a leading zero ( 1 to 12 );\n %n - the month as a number with a leading zero ( 01 to 12);\n %M - the month as an abbreviation ( Jan to Dec );\n %F - the month as a full name ( January to December );\n %y - the year as a two-digit number ( 00 to 99 );\n %Y - the year as a four-digit number ( 19009999 );\n %h - the hour based on the 12-hour clock ( 00 to 11 );\n %H - the hour based on the 24-hour clock ( 00 to 23 );\n %i - the minute as a number with a leading zero ( 00 to 59 );\n %s - the second as a number without a leading zero ( 00 to 59 ); 2)\n %a - displays am (for times from midnight until noon) and pm (for times from noon until midnight);\n %A - displays AM (for times from midnight until noon) and PM (for times from noon until midnight).\n*/\n\nimport fastVersion from \"./date_parsers/fast_version\";\nimport cspCompliantVersion from \"./date_parsers/csp_compliant_version\";\n\nexport default function(gantt) {\n\tvar canUseCsp = null;\n\tfunction cspAutoCheck() {\n\t\ttry {\n\t\t\tnew Function(\"canUseCsp = false;\");\n\t\t} catch(e) {\n\t\t\tcanUseCsp = true;\n\t\t}\n\t}\n\tfunction useCsp() {\n\t\tvar result = false;\n\t\tif (gantt.config.csp === \"auto\") {\n\t\t\tif(canUseCsp === null) {\n\t\t\t\tcspAutoCheck();\n\t\t\t}\n\t\t\tresult = canUseCsp;\n\t\t} else {\n\t\t\tresult = gantt.config.csp;\n\t\t}\n\t\treturn result;\n\t}\n\n\tvar dateHelper = {\n\t\tinit: function () {\n\t\t\tvar locale = gantt.locale;\n\n\t\t\tvar s = locale.date.month_short;\n\t\t\tvar t = locale.date.month_short_hash = {};\n\t\t\tfor (var i = 0; i < s.length; i++)\n\t\t\t\tt[s[i]] = i;\n\n\t\t\tvar s = locale.date.month_full;\n\t\t\tvar t = locale.date.month_full_hash = {};\n\t\t\tfor (var i = 0; i < s.length; i++)\n\t\t\t\tt[s[i]] = i;\n\t\t},\n\t\tdate_part: function (date) {\n\t\t\tvar old = new Date(date);\n\t\t\tdate.setHours(0);\n\t\t\tthis.hour_start(date);\n\t\t\tif (date.getHours() && //shift to yesterday on dst\n\t\t\t\t(date.getDate() < old.getDate() || date.getMonth() < old.getMonth() || date.getFullYear() < old.getFullYear()))\n\t\t\t\tdate.setTime(date.getTime() + 60 * 60 * 1000 * (24 - date.getHours()));\n\t\t\treturn date;\n\t\t},\n\t\ttime_part: function (date) {\n\t\t\treturn (date.valueOf() / 1000 - date.getTimezoneOffset() * 60) % 86400;\n\t\t},\n\t\tweek_start: function (date) {\n\t\t\tvar shift = date.getDay();\n\t\t\tif (gantt.config.start_on_monday) {\n\t\t\t\tif (shift === 0) shift = 6;\n\t\t\t\telse shift--;\n\t\t\t}\n\t\t\treturn this.date_part(this.add(date, -1 * shift, \"day\"));\n\t\t},\n\t\tmonth_start: function (date) {\n\t\t\tdate.setDate(1);\n\t\t\treturn this.date_part(date);\n\t\t},\n\t\tquarter_start: function (date) {\n\t\t\tthis.month_start(date);\n\t\t\tvar m = date.getMonth(),\n\t\t\t\tres_month;\n\n\t\t\tif (m >= 9) {\n\t\t\t\tres_month = 9;\n\t\t\t} else if (m >= 6) {\n\t\t\t\tres_month = 6;\n\t\t\t} else if (m >= 3) {\n\t\t\t\tres_month = 3;\n\t\t\t} else {\n\t\t\t\tres_month = 0;\n\t\t\t}\n\n\t\t\tdate.setMonth(res_month);\n\t\t\treturn date;\n\t\t},\n\t\tyear_start: function (date) {\n\t\t\tdate.setMonth(0);\n\t\t\treturn this.month_start(date);\n\t\t},\n\t\tday_start: function (date) {\n\t\t\treturn this.date_part(date);\n\t\t},\n\t\thour_start: function (date) {\n\t\t\tif (date.getMinutes())\n\t\t\t\tdate.setMinutes(0);\n\t\t\tthis.minute_start(date);\n\n\t\t\treturn date;\n\t\t},\n\t\tminute_start: function (date) {\n\t\t\tif (date.getSeconds())\n\t\t\t\tdate.setSeconds(0);\n\t\t\tif (date.getMilliseconds())\n\t\t\t\tdate.setMilliseconds(0);\n\t\t\treturn date;\n\t\t},\n\t\t_add_days: function (modifiedDate, inc, originalDate) {\n\n\t\t\tmodifiedDate.setDate(modifiedDate.getDate() + inc);\n\t\t\tvar incCondition = inc >= 0;\n\t\t\tvar getHoursCondition = !originalDate.getHours() && modifiedDate.getHours(); //shift to yesterday on dst\n\t\t\tvar getDateCondition = (modifiedDate.getDate() <= originalDate.getDate() || modifiedDate.getMonth() < originalDate.getMonth() || modifiedDate.getFullYear() < originalDate.getFullYear());\n\t\t\tif (incCondition && getHoursCondition && getDateCondition){\n\t\t\t\tmodifiedDate.setTime(modifiedDate.getTime() + 60 * 60 * 1000 * (24 - modifiedDate.getHours()));\n\t\t\t}\n\t\t\tvar worktimeCalculation = inc > 1;\n\t\t\tif (worktimeCalculation && getHoursCondition){\n\t\t\t\t// try to shift the modified Date to 00:00\n\t\t\t\tmodifiedDate.setHours(0);\n\t\t\t}\n\t\t\treturn modifiedDate;\n\t\t},\n\n\t\tadd: function (date, inc, mode) {\n\t\t\t/*jsl:ignore*/\n\t\t\tvar ndate = new Date(date.valueOf());\n\t\t\tswitch (mode) {\n\t\t\t\tcase \"day\":\n\t\t\t\t\tndate = this._add_days(ndate, inc, date);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"week\":\n\t\t\t\t\tndate = this._add_days(ndate, inc * 7, date);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"month\":\n\t\t\t\t\tndate.setMonth(ndate.getMonth() + inc);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"year\":\n\t\t\t\t\tndate.setYear(ndate.getFullYear() + inc);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"hour\":\n\t\t\t\t\t/*\n\t\t\t\t\t\tadding hours/minutes via setHour(getHour() + inc) gives weird result when\n\t\t\t\t\t\tadding one hour to the time before switch to a Daylight Saving time\n\n\t\t\t\t\t\texample: //Sun Mar 30 2014 01:00:00 GMT+0100 (W. Europe Standard Time)\n\t\t\t\t\t\tnew Date(2014, 02, 30, 1).setHours(2)\n\t\t\t\t\t\t>>Sun Mar 30 2014 01:00:00 GMT+0100 (W. Europe Standard Time)\n\n\t\t\t\t\t\tsetTime seems working as expected\n\t\t\t\t\t */\n\t\t\t\t\tndate.setTime(ndate.getTime() + inc * 60 * 60 * 1000);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"minute\":\n\n\t\t\t\t\tndate.setTime(ndate.getTime() + inc * 60 * 1000);\n\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\treturn this[\"add_\" + mode](date, inc, mode);\n\t\t\t}\n\t\t\treturn ndate;\n\t\t\t/*jsl:end*/\n\t\t},\n\t\tadd_quarter: function (date, inc) {\n\t\t\treturn this.add(date, inc * 3, \"month\");\n\t\t},\n\n\t\tto_fixed: function (num) {\n\t\t\tif (num < 10) return \"0\" + num;\n\t\t\treturn num;\n\t\t},\n\t\tcopy: function (date) {\n\t\t\treturn new Date(date.valueOf());\n\t\t},\n\t\tdate_to_str: function (format, utc) {\n\t\t\tvar result = fastVersion;\n\t\t\tif (useCsp()) {\n\t\t\t\tresult = cspCompliantVersion;\n\t\t\t}\n\t\t\treturn result.date_to_str(format, utc, gantt);\n\t\t},\n\t\tstr_to_date: function (format, utc) {\n\t\t\tvar result = fastVersion;\n\t\t\tif (useCsp()) {\n\t\t\t\tresult = cspCompliantVersion;\n\t\t\t}\n\t\t\treturn result.str_to_date(format, utc, gantt);\n\t\t},\n\t\tgetISOWeek: function (ndate) {\n\t\t\treturn gantt.date._getWeekNumber(ndate, true);\n\t\t},\n\t\t_getWeekNumber: function(ndate, isoWeek){\n\t\t\tif (!ndate) return false;\n\t\t\tvar nday = ndate.getDay();\n\t\t\tif(isoWeek){\n\t\t\t\tif (nday === 0) {\n\t\t\t\t\tnday = 7;\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar first_thursday = new Date(ndate.valueOf());\n\t\t\tfirst_thursday.setDate(ndate.getDate() + (4 - nday));\n\t\t\tvar year_number = first_thursday.getFullYear(); // year of the first Thursday\n\t\t\tvar ordinal_date = Math.round((first_thursday.getTime() - new Date(year_number, 0, 1).getTime()) / 86400000); //ordinal date of the first Thursday - 1 (so not really ordinal date)\n\t\t\tvar week_number = 1 + Math.floor(ordinal_date / 7);\n\t\t\treturn week_number;\n\t\t},\n\n\t\tgetWeek: function(ndate){\n\t\t\treturn gantt.date._getWeekNumber(ndate, gantt.config.start_on_monday);\n\t\t},\n\t\tgetUTCISOWeek: function (ndate) {\n\t\t\treturn gantt.date.getISOWeek(ndate);\n\t\t},\n\t\tconvert_to_utc: function (date) {\n\t\t\treturn new Date(date.getUTCFullYear(), date.getUTCMonth(), date.getUTCDate(), date.getUTCHours(), date.getUTCMinutes(), date.getUTCSeconds());\n\t\t},\n\t\tparseDate: function (date, format) {\n\t\t\t// raw date may be of type string, number (timestamp) or something else\n\t\t\t// do not check for instanceof Date explicitly, since we may swap native date with different date implementation at some point\n\t\t\tif (date && !date.getFullYear) {\n\t\t\t\tif (typeof(format) !== \"function\") {\n\t\t\t\t\tif (typeof(format) === \"string\") {\n\t\t\t\t\t\tif (format === \"parse_date\" || format === \"xml_date\") {\n\t\t\t\t\t\t\tformat = gantt.defined(gantt.templates.xml_date) ? gantt.templates.xml_date : gantt.templates.parse_date;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tformat = gantt.defined(gantt.templates[format]) ? gantt.templates[format] : gantt.date.str_to_date(format);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tformat = gantt.defined(gantt.templates.xml_date) ? gantt.templates.xml_date : gantt.templates.parse_date;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (date) {\n\t\t\t\t\tdate = format(date);\n\t\t\t\t} else {\n\t\t\t\t\tdate = null;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn date;\n\t\t}\n\t};\n\treturn dateHelper;\n};","class t{constructor(t){const{url:e,token:s}=t;this._url=e,this._token=s,this._mode=1,this._seed=1,this._queue=[],this.data={},this.api={},this._events={}}headers(){return{Accept:\"application/json\",\"Content-Type\":\"application/json\",\"Remote-Token\":this._token}}fetch(t,e){const s={credentials:\"include\",headers:this.headers()};return e&&(s.method=\"POST\",s.body=e),fetch(t,s).then(t=>t.json())}load(t){return t&&(this._url=t),this.fetch(this._url).then(t=>this.parse(t))}parse(t){const{key:e,websocket:s}=t;e&&(this._token=t.key);for(const e in t.data)this.data[e]=t.data[e];for(const e in t.api){const s=this.api[e]={},i=t.api[e];for(const t in i)s[t]=this._wrapper(e+\".\"+t)}return s&&this.connect(),this}connect(){const t=this._socket;t&&(this._socket=null,t.onclose=function(){},t.close()),this._mode=2,this._socket=function(t,e,s,i){let n=e;\"/\"===n[0]&&(n=document.location.protocol+\"//\"+document.location.host+e);n=n.replace(/^http(s|):/,\"ws$1:\");const o=-1!=n.indexOf(\"?\")?\"&\":\"?\";n=`${n}${o}token=${s}&ws=1`;const r=new WebSocket(n);return r.onclose=()=>setTimeout(()=>t.connect(),2e3),r.onmessage=e=>{const s=JSON.parse(e.data);switch(s.action){case\"result\":t.result(s.body,[]);break;case\"event\":t.fire(s.body.name,s.body.value);break;case\"start\":i();break;default:t.onError(s.data)}},r}(this,this._url,this._token,()=>(this._mode=3,this._send(),this._resubscribe(),this))}_wrapper(t){return function(){const e=[].slice.call(arguments);let s=null;const i=new Promise((i,n)=>{s={data:{id:this._uid(),name:t,args:e},status:1,resolve:i,reject:n},this._queue.push(s)});return this.onCall(s,i),3===this._mode?this._send(s):setTimeout(()=>this._send(),1),i}.bind(this)}_uid(){return(this._seed++).toString()}_send(t){if(2==this._mode)return void setTimeout(()=>this._send(),100);const e=t?[t]:this._queue.filter(t=>1===t.status);if(!e.length)return;const s=e.map(t=>(t.status=2,t.data));3!==this._mode?this.fetch(this._url,JSON.stringify(s)).catch(t=>this.onError(t)).then(t=>this.result(t,s)):this._socket.send(JSON.stringify({action:\"call\",body:s}))}result(t,e){const s={};if(t)for(let e=0;e<t.length;e++)s[t[e].id]=t[e];else for(let t=0;t<e.length;t++)s[e[t].id]={id:e[t].id,error:\"Network Error\",data:null};for(let t=this._queue.length-1;t>=0;t--){const e=this._queue[t],i=s[e.data.id];i&&(this.onResponse(e,i),i.error?e.reject(i.error):e.resolve(i.data),this._queue.splice(t,1))}}on(t,e){const s=this._uid();let i=this._events[t];const n=!!i;return n||(i=this._events[t]=[]),i.push({id:s,handler:e}),n||3!=this._mode||this._socket.send(JSON.stringify({action:\"subscribe\",name:t})),{name:t,id:s}}_resubscribe(){if(3==this._mode)for(const t in this._events)this._socket.send(JSON.stringify({action:\"subscribe\",name:t}))}detach(t){if(!t){if(3==this._mode)for(const t in this._events)this._socket.send(JSON.stringify({action:\"unsubscribe\",key:t}));return void(this._events={})}const{id:e,name:s}=t,i=this._events[s];if(i){const t=i.filter(t=>t.id!=e);t.length?this._events[s]=t:(delete this._events[s],3==this._mode&&this._socket.send(JSON.stringify({action:\"unsubscribe\",name:s})))}}fire(t,e){const s=this._events[t];if(s)for(let t=0;t<s.length;t++)s[t].handler(e)}onError(t){return null}onCall(t,e){}onResponse(t,e){}}export{t as Client};\n//# sourceMappingURL=remote.es6.js.map\n","import * as remote_client from \"remote-client\";\nexport const remoteEvents = function(url, token) {\n    const remote = new remote_client.Client({\n      url,\n      token\n    });\n\n    // temporary patch, as we do not want credentials\n    remote.fetch = function (url, body) {\n      const req = {\n        headers: this.headers()\n      };\n      if (body) {\n        req.method = \"POST\";\n        req.body = body;\n      }\n\n      return fetch(url, req).then((res) => res.json());\n    };\n\n    this._ready = remote.load().then((back) => (this._remote = back));\n\n    function ready() {\n      return this._ready;\n    }\n  \n    function on(name, handler) {\n      this.ready().then((back) => {\n        if (typeof name === \"string\") back.on(name, handler);\n        else {\n          for (const key in name) {\n            back.on(key, name[key]);\n          }\n        }\n      });\n    }\n\n    this.ready = ready;\n    this.on = on;\n  };\n\n","function checkTimeout(host, updPerSecond){\n\tif (!updPerSecond)\n\t\treturn true;\n\t\n\tif (host._on_timeout)\n\t\treturn false;\n\t\n\tvar timeout = Math.ceil(1000/updPerSecond);\n\tif (timeout < 2) return true;\n\n\tsetTimeout(function(){\n\t\tdelete host._on_timeout;\n\t}, timeout);\n\n\thost._on_timeout = true;\n\treturn true;\n}\n\nexport default checkTimeout;","import * as utils from \"../../utils/utils\";\n\nvar StateService = (function(){\n\tvar stateProviders = {};\n\n\tfunction getState(name){\n\t\tvar provider = stateProviders[name];\n\t\tif(provider){\n\t\t\treturn stateProviders[name].method();\n\t\t}else{\n\t\t\tvar res = {};\n\t\t\tfor(var i in stateProviders){\n\t\t\t\tif(!stateProviders[i].internal)\n\t\t\t\t\tutils.mixin(res, stateProviders[i].method(), true);\n\t\t\t}\n\t\t\treturn res;\n\t\t}\n\t}\n\n\tfunction registerProvider(name, provider, internal){\n\t\tstateProviders[name] = { method: provider, internal: internal};\n\t}\n\n\tfunction unregisterProvider(name){\n\t\tdelete stateProviders[name];\n\t}\n\n\treturn {\n\t\tgetState: getState,\n\t\tregisterProvider: registerProvider,\n\t\tunregisterProvider: unregisterProvider\n\t};\n});\n\nexport default StateService;\n\n","export default Promise;","import * as utils from \"../../utils/utils\";\nimport {replaceValidZeroId} from \"../../utils/helpers\";\n\nvar createTasksDatastoreFacade = function(){\n\treturn {\n\tgetTask: function (id) {\n\t\tid = replaceValidZeroId(id, this.config.root_id);\n\t\tthis.assert(id, \"Invalid argument for gantt.getTask\");\n\t\tvar task = this.$data.tasksStore.getItem(id);\n\t\tthis.assert(task, \"Task not found id=\" + id);\n\t\treturn task;\n\t},\n\tgetTaskByTime: function (from, to) {\n\t\tvar p = this.$data.tasksStore.getItems();\n\n\t\tvar res = [];\n\n\t\tif (!(from || to)) {\n\t\t\tres = p;\n\t\t} else {\n\t\t\tfrom = +from || -Infinity;\n\t\t\tto = +to || Infinity;\n\t\t\tfor (var t = 0; t < p.length; t++){\n\t\t\t\tvar task = p[t];\n\t\t\t\tif (+task.start_date < to && +task.end_date > from)\n\t\t\t\t\tres.push(task);\n\t\t\t}\n\t\t}\n\t\treturn res;\n\t},\n\tisTaskExists: function (id) {\n\t\tif(!this.$data || !this.$data.tasksStore){\n\t\t\treturn false;\n\t\t}\n\t\treturn this.$data.tasksStore.exists(id);\n\t},\n\tupdateTask: function (id, item) {\n\t\tif (!utils.defined(item)) item = this.getTask(id);\n\t\tthis.$data.tasksStore.updateItem(id, item);\n\t\tif(this.isTaskExists(id))\n\t\t\tthis.refreshTask(id);\n\t},\n\taddTask: function (item, parent, index) {\n\t\tif (!utils.defined(item.id))\n\t\t\titem.id = utils.uid();\n\n\t\t//GS-761: assert unique ID\n\t\tif (this.isTaskExists(item.id)){\n\t\t\tvar task = this.getTask(item.id);\n\t\t\tif (task.$index != item.$index) {\n\t\t\t\t// Someone may try to mistakenly add a task with the same ID, and most likely\n\t\t\t\t// use the string format for the dates. Gantt shouldn't break in this scenario\n\t\t\t\tif (item.start_date && typeof item.start_date === \"string\"){\n\t\t\t\t\titem.start_date = this.date.parseDate(item.start_date, \"parse_date\");\n\t\t\t\t}\n\t\t\t\tif (item.end_date && typeof item.end_date === \"string\"){\n\t\t\t\t\titem.end_date = this.date.parseDate(item.end_date, \"parse_date\");\n\t\t\t\t}\n\n\t\t\t\treturn this.$data.tasksStore.updateItem(item.id, item);\n\t\t\t}\n\t\t}\n\n\n\t\tif (!utils.defined(parent)) parent = this.getParent(item) || 0;\n\t\tif (!this.isTaskExists(parent)) parent = this.config.root_id;\n\t\tthis.setParent(item, parent);\n\n\t\t// GS-1583. Save the $open state to the Undo Stack\n\t\tif (this.getState().lightbox && this.isTaskExists(parent)) {\n\t\t\tvar parentObj = this.getTask(parent);\n\t\t\tthis.callEvent(\"onAfterParentExpand\", [parent, parentObj]);\n\t\t}\n\t\treturn this.$data.tasksStore.addItem(item, index, parent);\n\t},\n\tdeleteTask: function (id) {\n\t\tid = replaceValidZeroId(id, this.config.root_id);\n\t\treturn this.$data.tasksStore.removeItem(id);\n\t},\n\tgetTaskCount: function () {\n\t\treturn this.$data.tasksStore.count();\n\t},\n\tgetVisibleTaskCount: function () {\n\t\treturn this.$data.tasksStore.countVisible();\n\t},\n\tgetTaskIndex: function (id) {\n\t\treturn this.$data.tasksStore.getBranchIndex(id);\n\t},\n\tgetGlobalTaskIndex: function (id) {\n\t\tid = replaceValidZeroId(id, this.config.root_id);\n\t\tthis.assert(id, \"Invalid argument\");\n\t\treturn this.$data.tasksStore.getIndexById(id);\n\t},\n\teachTask: function (code, parent, master) {\n\t\treturn this.$data.tasksStore.eachItem(utils.bind(code, master||this), parent);\n\t},\n\teachParent: function (callback, startTask, master) {\n\t\treturn this.$data.tasksStore.eachParent(utils.bind(callback, master || this), startTask);\n\t},\n\tchangeTaskId: function (oldid, newid) {\n\t\tthis.$data.tasksStore.changeId(oldid, newid);\n\t\tvar task = this.$data.tasksStore.getItem(newid);\n\n\t\tvar links = [];\n\n\t\tif (task.$source) {\n\t\t\tlinks = links.concat(task.$source);\n\t\t}\n\t\tif (task.$target) {\n\t\t\tlinks = links.concat(task.$target);\n\t\t}\n\n\t\tfor (var i = 0; i < links.length; i++) {\n\t\t\tvar link = this.getLink(links[i]);\n\t\t\tif (link.source == oldid) {\n\t\t\t\tlink.source = newid;\n\t\t\t}\n\t\t\tif (link.target == oldid) {\n\t\t\t\tlink.target = newid;\n\t\t\t}\n\t\t}\n\t},\n\tcalculateTaskLevel: function (item) {\n\t\treturn this.$data.tasksStore.calculateItemLevel(item);\n\t},\n\tgetNext: function (id) {\n\t\treturn this.$data.tasksStore.getNext(id);\n\t},\n\tgetPrev: function (id) {\n\t\treturn this.$data.tasksStore.getPrev(id);\n\t},\n\tgetParent: function (id) {\n\t\treturn this.$data.tasksStore.getParent(id);\n\t},\n\tsetParent: function (task, new_pid, silent) {\n\t\treturn this.$data.tasksStore.setParent(task, new_pid, silent);\n\t},\n\tgetSiblings: function (id) {\n\t\treturn this.$data.tasksStore.getSiblings(id).slice();\n\t},\n\tgetNextSibling: function (id) {\n\t\treturn this.$data.tasksStore.getNextSibling(id);\n\t},\n\tgetPrevSibling: function (id) {\n\t\treturn this.$data.tasksStore.getPrevSibling(id);\n\t},\n\tgetTaskByIndex: function(index){\n\t\tvar id = this.$data.tasksStore.getIdByIndex(index);\n\t\tif(this.isTaskExists(id)){\n\t\t\treturn this.getTask(id);\n\t\t}else{\n\t\t\treturn null;\n\t\t}\n\t},\n\tgetChildren: function (id) {\n\t\tif(!this.hasChild(id)){\n\t\t\treturn [];\n\t\t}else{\n\t\t\treturn this.$data.tasksStore.getChildren(id).slice();\n\t\t}\n\t},\n\thasChild: function (id) {\n\t\treturn this.$data.tasksStore.hasChild(id);\n\t},\n\topen: function (id) {\n\t\tthis.$data.tasksStore.open(id);\n\t},\n\tclose: function (id) {\n\t\tthis.$data.tasksStore.close(id);\n\t},\n\tmoveTask: function (sid, tindex, parent) {\n\t\tparent = replaceValidZeroId(parent, this.config.root_id);\n\t\treturn this.$data.tasksStore.move.apply(this.$data.tasksStore, arguments);\n\t},\n\tsort: function(field, desc, parent, silent) {\n\t\tvar render = !silent;//4th argument to cancel redraw after sorting\n\n\t\tthis.$data.tasksStore.sort(field, desc, parent);\n\t\tthis.callEvent(\"onAfterSort\", [field, desc, parent]);\n\n\t\tif (render) {\n\t\t\tthis.render();\n\t\t}\n\t}\n};\n};\n\nexport default createTasksDatastoreFacade;\n\n\n","import * as utils from \"../../utils/utils\";\n\nvar $powerArray  = {\n\t$create: function(array){\n\t\treturn utils.mixin(array || [], this);\n\t},\n\t//remove element at specified position\n\t$removeAt:function(pos,len){\n\t\tif (pos>=0) this.splice(pos,(len||1));\n\t},\n\t//find element in collection and remove it\n\t$remove:function(value){\n\t\tthis.$removeAt(this.$find(value));\n\t},\n\t//add element to collection at specific position\n\t$insertAt:function(data,pos){\n\t\tif (!pos && pos!==0) \t//add to the end by default\n\t\t\tthis.push(data);\n\t\telse {\n\t\t\tvar b = this.splice(pos,(this.length-pos));\n\t\t\tthis[pos] = data;\n\t\t\tthis.push.apply(this,b); //reconstruct array without loosing this pointer\n\t\t}\n\t},\n\t//return index of element, -1 if it doesn't exists\n\t$find:function(data){\n\t\tfor (var i=0; i<this.length; i++)\n\t\t\tif (data==this[i]) return i;\n\t\treturn -1;\n\t},\n\t//execute some method for each element of array\n\t$each:function(functor,master){\n\t\tfor (var i=0; i < this.length; i++)\n\t\t\tfunctor.call((master||this),this[i]);\n\t},\n\t//create new array from source, by using results of functor\n\t$map:function(functor,master){\n\t\tfor (var i=0; i < this.length; i++)\n\t\t\tthis[i]=functor.call((master||this),this[i]);\n\t\treturn this;\n\t},\n\t$filter:function(functor, master){\n\t\tfor (var i=0; i < this.length; i++)\n\t\t\tif (!functor.call((master||this),this[i])){\n\t\t\t\tthis.splice(i,1);\n\t\t\t\ti--;\n\t\t\t}\n\t\treturn this;\n\t}\n};\n\nexport default $powerArray;","/**\n * Check the over task or draggble task is placeholder task\n */\n\nexport default function isPlaceholderTask(id, gantt, store, config) {\n\t// return false;\n\tvar config = gantt ? gantt.config : config;\n\tif (config && config.placeholder_task) {\n\t\tif (store.exists(id)){\n\t\t\tvar item = store.getItem(id);\n\t\t\treturn item.type === config.types.placeholder;\n\t\t}\n\t}\n\treturn false;\n};","import powerArray from \"./power_array\";\nimport * as utils from \"../../utils/utils\";\nimport eventable from \"../../utils/eventable\";\nimport isPlaceholderTask from \"../../utils/placeholder_task\";\n\nvar DataStore = function(config){\n\tthis.pull = {};\n\tthis.$initItem = config.initItem;\n\tthis.visibleOrder = powerArray.$create();\n\tthis.fullOrder = powerArray.$create();\n\tthis._skip_refresh = false;\n\tthis._filterRule = null;\n\tthis._searchVisibleOrder = {};\n\tthis._indexRangeCache = {};\n\tthis._getItemsCache = null;\n\tthis.$config = config;\n\teventable(this);\n\n\tthis._attachDataChange(function(){\n\t\tthis._indexRangeCache = {};\n\t\tthis._getItemsCache = null;\n\t\treturn true;\n\t});\n\treturn this;\n};\nDataStore.prototype = {\n\n\t_attachDataChange: function(callback){\n\t\tthis.attachEvent(\"onClearAll\", callback);\n\t\tthis.attachEvent(\"onBeforeParse\", callback);\n\t\tthis.attachEvent(\"onBeforeUpdate\", callback);\n\t\tthis.attachEvent(\"onBeforeDelete\", callback);\n\t\tthis.attachEvent(\"onBeforeAdd\", callback);\n\t\tthis.attachEvent(\"onParse\", callback);\n\t\tthis.attachEvent(\"onBeforeFilter\", callback);\n\t},\n\t_parseInner: function(data){\n\t\tvar item = null,\n\t\t\tloaded = [];\n\t\tfor(var i = 0, len = data.length; i< len; i++){\n\t\t\titem = data[i];\n\t\t\tif(this.$initItem){\n\t\t\t\tif(this.$config.copyOnParse()){\n\t\t\t\t\titem = utils.copy(item);\n\t\t\t\t}\n\t\t\t\titem = this.$initItem(item);\n\t\t\t}\n\t\t\t\n\t\t\tif(this.callEvent(\"onItemLoading\", [item])){\n\t\t\t\tif (!this.pull.hasOwnProperty(item.id)) {\n\t\t\t\t\tthis.fullOrder.push(item.id);\n\t\t\t\t}\n\t\t\t\tloaded.push(item);\n\t\t\t\tthis.pull[item.id] = item;\n\t\t\t}\n\t\t}\n\t\treturn loaded;\n\t},\n\tparse: function(data){\n\t\tif (!this.isSilent()) {\n\t\t\tthis.callEvent(\"onBeforeParse\", [data]);\n\t\t}\n\t\tvar loaded = this._parseInner(data);\n\t\tif (!this.isSilent()) {\n\t\t\tthis.refresh();\n\t\t\tthis.callEvent(\"onParse\", [loaded]);\n\t\t}\n\t},\n\tgetItem: function(id){\n\t\treturn this.pull[id];\n\t},\n\n\t_updateOrder: function(code){\n\t\tcode.call(this.visibleOrder);\n\t\tcode.call(this.fullOrder);\n\t},\n\tupdateItem: function(id, item){\n\t\tif (!utils.defined(item)) item = this.getItem(id);\n\n\t\tif (!this.isSilent()) {\n\t\t\tif (this.callEvent(\"onBeforeUpdate\", [item.id, item]) === false) return false;\n\t\t}\n\t\t// This is how it worked before updating the properties:\n\t\t// this.pull[id]=item;\n\t\tutils.mixin(this.pull[id],item, true);\n\t\tif (!this.isSilent()) {\n\t\t\tthis.callEvent(\"onAfterUpdate\", [item.id, item]);\n\t\t\tthis.callEvent(\"onStoreUpdated\", [item.id, item, \"update\"]);\n\t\t}\n\t},\n\n\t_removeItemInner: function(id){\n\t\t//clear from collections\n\t\t//this.visibleOrder.$remove(id);\n\t\tthis._updateOrder(function(){ this.$remove(id);});\n\t\tdelete this.pull[id];\n\t},\n\n\tremoveItem: function(id){\n\t\t//utils.assert(this.exists(id), \"Not existing ID in remove command\"+id);\n\n\t\tvar obj = this.getItem(id);\t//save for later event\n\t\tif (!this.isSilent()) {\n\t\t\tif (this.callEvent(\"onBeforeDelete\", [obj.id, obj]) === false) return false;\n\t\t}\n\n\t\tthis.callEvent(\"onAfterDeleteConfirmed\", [obj.id, obj]);\n\t\tthis._removeItemInner(id);\n\t\t\n\t\tif (this.isSilent()) {\n\t\t\tthis.callEvent(\"onAfterSilentDelete\", [obj.id, obj]);\n\t\t}\n\n\t\tif (!this.isSilent()) {\n\t\t\tthis.filter();\n\t\t\tthis.callEvent(\"onAfterDelete\", [obj.id, obj]);\n\t\t\t//repaint signal\n\t\t\tthis.callEvent(\"onStoreUpdated\", [obj.id, obj, \"delete\"]);\n\t\t}\n\t},\n\n\t_addItemInner: function(item, index){\n\t\t//in case of treetable order is sent as 3rd parameter\n\t\t//var order = index;\n\n\t\tif(this.exists(item.id)){\n\t\t\tthis.silent(function(){this.updateItem(item.id, item);});\n\t\t}else{\n\t\t\tvar order = this.visibleOrder;\n\n\t\t\t//by default item is added to the end of the list\n\t\t\tvar data_size = order.length;\n\n\t\t\tif (!utils.defined(index) || index < 0)\n\t\t\t\tindex = data_size;\n\t\t\t//check to prevent too big indexes\n\t\t\tif (index > data_size){\n\t\t\t\t//dhx.log(\"Warning\",\"DataStore:add\",\"Index of out of bounds\");\n\t\t\t\tindex = Math.min(order.length,index);\n\t\t\t}\n\t\t}\n\n\n\t\t//gantt.assert(!this.exists(id), \"Not unique ID\");\n\n\t\tthis.pull[item.id]=item;\n\t\tthis._updateOrder(function(){\n\t\t\tif(this.$find(item.id) === -1)\n\t\t\t\tthis.$insertAt(item.id,index);\n\t\t});\n\t\tthis.filter();\n\t\t//order.$insertAt(item.id,index);\n\t},\n\n\n\tisVisible: function(id){\n\t\treturn this.visibleOrder.$find(id) > -1;\n\t},\n\tgetVisibleItems: function(){\n\t\treturn this.getIndexRange();\n\t},\n\n\taddItem: function(item, index){\n\t\tif (!utils.defined(item.id))\n\t\t\titem.id = utils.uid();\n\n\t\tif(this.$initItem){\n\t\t\titem = this.$initItem(item);\n\t\t}\n\n\t\tif (!this.isSilent()){\n\t\t\tif (this.callEvent(\"onBeforeAdd\", [item.id, item]) === false) return false;\n\t\t}\n\n\n\t\tthis._addItemInner(item, index);\n\n\t\tif (!this.isSilent()){\n\t\t\tthis.callEvent(\"onAfterAdd\",[item.id, item]);\n\t\t\t//repaint signal\n\t\t\tthis.callEvent(\"onStoreUpdated\",[item.id,item,\"add\"]);\n\t\t} else {\n\t\t\tif(this.sync_link){\n\t\t\t\tthis.sync_link(item);\n\t\t\t}\n\t\t}\n\t\treturn item.id;\n\t},\n\n\t_changeIdInner: function(oldId, newId){\n\t\tif(this.pull[oldId])\n\t\t\tthis.pull[newId] = this.pull[oldId];\n\n\t\tvar visibleOrder = this._searchVisibleOrder[oldId];\n\t\tthis.pull[newId].id = newId;\n\t\tthis._updateOrder(function(){\n\t\t\tthis[this.$find(oldId)] = newId;\n\t\t});\n\t\tthis._searchVisibleOrder[newId] = visibleOrder;\n\t\tdelete this._searchVisibleOrder[oldId];\n\n\t\t//this.visibleOrder[this.visibleOrder.$find(oldId)]=newId;\n\t\tdelete this.pull[oldId];\n\t},\n\tchangeId: function(oldId, newId){\n\t\tthis._changeIdInner(oldId, newId);\n\n\t\tthis.callEvent(\"onIdChange\", [oldId, newId]);\n\n\t},\n\texists: function(id){\n\t\treturn !!(this.pull[id]);\n\t},\n\n\t_moveInner: function(sindex, tindex){\n\t\tvar id = this.getIdByIndex(sindex);\n\n\t\tthis._updateOrder(function(){\n\t\t\tthis.$removeAt(sindex);\n\t\t\tthis.$insertAt(id,Math.min(this.length, tindex));\n\t\t});\n\t\t//this.visibleOrder.$removeAt(sindex);\t//remove at old position\n\t\t//if (sindex<tindex) tindex--;\t//correct shift, caused by element removing\n\t\t//this.visibleOrder.$insertAt(id,Math.min(this.visibleOrder.length, tindex));\t//insert at new position\n\t},\n\n\tmove: function(sindex, tindex){\n\t\t//gantt.assert(sindex>=0 && tindex>=0, \"DataStore::move\",\"Incorrect indexes\");\n\n\t\tvar id = this.getIdByIndex(sindex);\n\t\tvar obj = this.getItem(id);\n\t\tthis._moveInner(sindex, tindex);\n\n\t\tif (!this.isSilent()) {\n\t\t\t//repaint signal\n\t\t\tthis.callEvent(\"onStoreUpdated\", [obj.id, obj, \"move\"]);\n\t\t}\n\t},\n\tclearAll: function(){\n\t\tif(this.$destroyed){\n\t\t\treturn;\n\t\t}\n\t\t// GS-956 We need to unselect the resource as its ID is cached\n\t\tthis.silent(function(){\n\t\t\tthis.unselect();\n\t\t});\n\t\tthis.pull = {};\n\t\tthis.visibleOrder = powerArray.$create();\n\t\tthis.fullOrder = powerArray.$create();\n\t\tif (this.isSilent()) return;\n\t\tthis.callEvent(\"onClearAll\",[]);\n\t\tthis.refresh();\n\t},\n\n\tsilent:function(code, master){\n\t\tvar alreadySilent = false;\n\t\tif(this.isSilent()) {\n\t\t\talreadySilent = true;\n\t\t}\n\t\tthis._skip_refresh = true;\n\t\tcode.call(master||this);\n\t\t\n\t\tif (!alreadySilent) {\n\t\t\tthis._skip_refresh = false;\n\t\t}\n\t},\n\tisSilent: function(){\n\t\treturn !!this._skip_refresh;\n\t},\n\n\tarraysEqual: function (arr1, arr2) {\n\t\tif(arr1.length !== arr2.length)\n\t\t\treturn false;\n\t\tfor(var i = 0; i < arr1.length; i++) {\n\t\t\tif(arr1[i] !== arr2[i])\n\t\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t},\n\n\trefresh: function(id, quick){\n\t\tif(this.$destroyed){\n\t\t\treturn;\n\t\t}\n\t\tif (this.isSilent()) return;\n\n\t\tvar item;\n\t\tif(id){\n\t\t\titem = this.getItem(id);\n\t\t}\n\n\t\tvar args;\n\t\tif (id){\n\t\t\targs = [id, item, \"paint\"];\n\t\t}else{\n\t\t\targs = [null,null,null];\n\t\t}\n\n\t\tif(this.callEvent(\"onBeforeStoreUpdate\", args) === false){\n\t\t\treturn;\n\t\t}\n\n\t\tvar skipFilter = this._quick_refresh && !this._mark_recompute;\n\t\tthis._mark_recompute = false;\n\t\tif(id){\n\t\t\t// if item changes visible order (e.g. expand-collapse branch) - do a complete repaint\n\t\t\tif(!quick && !skipFilter){\n\t\t\t\tvar oldOrder = this.visibleOrder;\n\t\t\t\tthis.filter();\n\t\t\t\tif(!this.arraysEqual(oldOrder, this.visibleOrder)){\n\t\t\t\t\tid = undefined;\n\t\t\t\t}\n\t\t\t}\n\n\t\t}else if(!skipFilter){\n\t\t\tthis.filter();\n\t\t}\n\n\t\tif (id){\n\t\t\targs = [id, item, \"paint\"];\n\t\t}else{\n\t\t\targs = [null,null,null];\n\t\t}\n\n\t\tthis.callEvent(\"onStoreUpdated\",args);\n\t},\n\n\tcount: function(){\n\t\treturn this.fullOrder.length;\n\t},\n\tcountVisible: function(){\n\t\treturn this.visibleOrder.length;\n\t},\n\n\tsort: function(sort){},\n\n\tserialize: function(){},\n\n\teachItem: function(code){\n\t\tfor (var i=0; i<this.fullOrder.length; i++) {\n\t\t\tvar item = this.getItem(this.fullOrder[i]);\n\t\t\tcode.call(this, item);\n\t\t}\n\t},\n\n\tfind: function(filter) {\n\t\tvar result = [];\n\t\tthis.eachItem(function(item) {\n\t\t\tif(filter(item)){\n\t\t\t\tresult.push(item);\n\t\t\t}\n\t\t});\n\t\treturn result;\n\t},\n\n\tfilter: function(rule){\n\t\tif (!this.isSilent()) {\n\t\t\tthis.callEvent(\"onBeforeFilter\", []);\n\t\t}\n\t\tthis.callEvent(\"onPreFilter\", []);\n\t\tvar filteredOrder = powerArray.$create();\n\t\tvar placeholderIds = [];\n\t\tthis.eachItem(function(item){\n\t\t\tif(this.callEvent(\"onFilterItem\", [item.id, item])){\n\t\t\t\tif(isPlaceholderTask(item.id, null, this, this._ganttConfig)){\n\t\t\t\t\tplaceholderIds.push(item.id);\n\t\t\t\t} else {\n\t\t\t\t\tfilteredOrder.push(item.id);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tfor(var i = 0; i < placeholderIds.length; i++){\n\t\t\tfilteredOrder.push(placeholderIds[i]);\n\t\t}\n\n\t\tthis.visibleOrder = filteredOrder;\n\t\tthis._searchVisibleOrder = {};\n\t\tfor(var i = 0; i < this.visibleOrder.length; i++){\n\t\t\tthis._searchVisibleOrder[this.visibleOrder[i]] = i;\n\t\t}\n\t\tif (!this.isSilent()) {\n\t\t\tthis.callEvent(\"onFilter\", []);\n\t\t}\n\t},\n\n\tgetIndexRange: function(from, to){\n\t\tvar max = Math.min((to||Infinity),this.countVisible()-1);\n\t\tvar min = from||0;\n\n\t\tvar cacheKey = min + '-' + max;\n\t\tif(this._indexRangeCache[cacheKey]){\n\t\t\treturn this._indexRangeCache[cacheKey].slice();\n\t\t}\n\n\t\tvar ret= [];\n\t\tfor (var i=min; i <= max; i++)\n\t\t\tret.push(this.getItem(this.visibleOrder[i]));\n\n\t\tthis._indexRangeCache[cacheKey] = ret.slice();\n\t\treturn ret;\n\t},\n\tgetItems: function(){\n\t\tif(this._getItemsCache){\n\t\t\treturn this._getItemsCache.slice();\n\t\t}\n\n\t\tvar res = [];\n\t\tfor(var i in this.pull){\n\t\t\tres.push(this.pull[i]);\n\t\t}\n\t\tthis._getItemsCache = res.slice();\n\n\t\treturn res;\n\t},\n\n\tgetIdByIndex: function(index){\n\t\treturn this.visibleOrder[index];\n\t},\n\tgetIndexById: function(id){\n\t\tvar res = this._searchVisibleOrder[id];\n\t\tif(res === undefined){\n\t\t\tres = -1;\n\t\t}\n\t\treturn res;\n\t},\n\t_getNullIfUndefined: function(value){\n\t\tif(value === undefined){\n\t\t\treturn null;\n\t\t}else{\n\t\t\treturn value;\n\t\t}\n\t},\n\tgetFirst: function(){\n\t\treturn this._getNullIfUndefined(this.visibleOrder[0]);\n\t},\n\tgetLast: function(){\n\t\treturn this._getNullIfUndefined(this.visibleOrder[this.visibleOrder.length-1]);\n\t},\n\tgetNext: function(id){\n\t\treturn this._getNullIfUndefined(this.visibleOrder[this.getIndexById(id) + 1]);\n\t},\n\tgetPrev: function(id){\n\t\treturn this._getNullIfUndefined(this.visibleOrder[this.getIndexById(id) - 1]);\n\t},\n\tdestructor: function(){\n\t\tthis.callEvent(\"onDestroy\", []);\n\t\tthis.detachAllEvents();\n\t\tthis.$destroyed = true;\n\t\tthis.pull = null;\n\t\tthis.$initItem = null;\n\t\tthis.visibleOrder = null;\n\t\tthis.fullOrder = null;\n\t\tthis._skip_refresh = null;\n\t\tthis._filterRule = null;\n\t\tthis._searchVisibleOrder = null;\n\t\tthis._indexRangeCache = {};\n\t}\n};\n\nexport default DataStore;","export default class SplitTasksHelper {\n\n\t_datastore: any = null;\n\n\tconstructor (datastore: any) {\n\t\tthis._datastore = datastore;\n\t}\n\tisSplitItem = (item: any) => {\n\t\treturn (item.render == \"split\" && this._datastore.hasChild(item.id));\n\t};\n\tisSubrowSplitItem = (item: any) => {\n\t\treturn (item.split_placement == \"subrow\");\n\t};\n\tisDefaultSplitItem = (item: any) => {\n\t\treturn (item.split_placement == \"auto\" || item.split_placement === undefined);\n\t};\n\tisInlineSplitItem = (item: any) => {\n\t\treturn (item.split_placement == \"inline\");\n\t};\n};","import powerArray from \"./power_array\";\nimport * as utils from \"../../utils/utils\";\nimport * as helpers from \"../../utils/helpers\";\nimport DataStore from \"./datastore\";\nimport isPlaceholderTask from \"../../utils/placeholder_task\";\nimport {replaceValidZeroId} from \"../../utils/helpers\";\nimport SplitTasksHelper from \"../common/split_task_helpers\";\n\nvar TreeDataStore = function(config){\n\tDataStore.apply(this, [config]);\n\tthis._branches = {};\n\tthis._splitTaskHelper = new SplitTasksHelper(this);\n\n\tthis.pull = {};\n\t//GS-761 Update existing item instead of adding it to the new position\n\tthis.$initItem = function (item){\n\t\tvar loadedItem = item;\n\t\tif(config.initItem){\n\t\t\tloadedItem = config.initItem(loadedItem);\n\t\t}\n\t\tvar existingItem = this.getItem(item.id);\n\t\tif(existingItem && !isEqualIds(existingItem.parent,loadedItem.parent)){\n\t\t\tthis.move(loadedItem.id, loadedItem.$index || -1, loadedItem.parent || this._ganttConfig.root_id);\n\t\t}\n\t\treturn loadedItem;\n\t};\n\tthis.$parentProperty = config.parentProperty || \"parent\";\n\n\tif(typeof config.rootId !== \"function\"){\n\t\tthis.$getRootId = (function(val){\n\t\t\treturn function(){return val;};\n\t\t})(config.rootId || 0);\n\t}else{\n\t\tthis.$getRootId = config.rootId;\n\t}\n\n\t// TODO: replace with live reference to gantt config\n\tthis.$openInitially = config.openInitially;\n\n\tthis.visibleOrder = powerArray.$create();\n\tthis.fullOrder = powerArray.$create();\n\tthis._searchVisibleOrder = {};\n\tthis._indexRangeCache = {};\n\tthis._eachItemMainRangeCache = null;\n\tthis._getItemsCache = null;\n\tthis._skip_refresh = false;\n\n\tthis._ganttConfig = null;\n\tif(config.getConfig){\n\t\tthis._ganttConfig = config.getConfig();\n\t}\n\n\tvar splitParents = {};\n\tvar splitItems = {};\n\n\tvar taskOpenState = {};\n\tvar taskVisibility = {};\n\tvar haveSplitItems = false;\n\n\tthis._attachDataChange(function(){\n\t\tthis._indexRangeCache = {};\n\t\tthis._eachItemMainRangeCache = null;\n\t\tthis._getItemsCache = null;\n\t\treturn true;\n\t});\n\n\tthis.attachEvent(\"onPreFilter\", function(){\n\t\tthis._indexRangeCache = {};\n\t\tthis._eachItemMainRangeCache = null;\n\n\t\tsplitParents = {};\n\t\tsplitItems = {};\n\t\ttaskOpenState = {};\n\t\ttaskVisibility = {};\n\t\thaveSplitItems = false;\n\n\t\tthis.eachItem(function(item){\n\t\t\tvar parent = this.getParent(item.id);\n\t\t\tif(item.$open && taskOpenState[parent] !== false){\n\t\t\t\ttaskOpenState[item.id] = true;\n\t\t\t}else{\n\t\t\t\ttaskOpenState[item.id] = false;\n\t\t\t}\n\n\t\t\tif(this._isSplitItem(item)){\n\t\t\t\thaveSplitItems = true;\n\t\t\t\tsplitParents[item.id] = true;\n\t\t\t\tsplitItems[item.id] = true;\n\t\t\t}\n\n\n\t\t\tif(haveSplitItems && splitItems[parent]){\n\t\t\t\tif(this._isDefaultItem(item) || this._isInlineChildItem(item)) splitItems[item.id] = true;\n\t\t\t}\n\n\n\t\t\tif(taskOpenState[parent] || taskOpenState[parent] === undefined || this._isInlineChildItem(item)){\n\t\t\t\ttaskVisibility[item.id] = true;\n\t\t\t}else{\n\t\t\t\ttaskVisibility[item.id] = false;\n\t\t\t}\n\t\t});\n\t});\n\n\tthis.attachEvent(\"onFilterItem\", function(id, item){\n\n\t\tvar canOpenSplitTasks = false;\n\t\tif(this._ganttConfig){\n\t\t\tvar canOpenSplitTasks = this._ganttConfig.open_split_tasks;\n\t\t}\n\n\t\tvar open = taskVisibility[item.id];\n\n\t\tif(haveSplitItems){\n\t\t\tif(open && splitItems[item.id] && !splitParents[item.id]){\n\t\t\t\topen = !!canOpenSplitTasks;\n\t\t\t}\n\n\t\t\tif(splitItems[item.id] && !splitParents[item.id]){\n\t\t\t\tif(!this._isSplitChildItem(item)) item.$split_subtask = true;\n\t\t\t}\n\t\t}\n\n\t\titem.$expanded_branch = !!taskVisibility[item.id];\n\t\tif(this._isInlineChildItem(item)){\n\t\t\topen = false;\n\t\t}\n\t\treturn !!open;\n\t});\n\n\tthis.attachEvent(\"onFilter\", function(){\n\t\tsplitParents = {};\n\t\tsplitItems = {};\n\n\t\ttaskOpenState = {};\n\t\ttaskVisibility = {};\n\t});\n\n\treturn this;\n};\n\nTreeDataStore.prototype = utils.mixin({\n\n\t\t_buildTree: function(data){\n\t\t\tvar item = null;\n\t\t\tvar rootId = this.$getRootId();\n\t\t\tfor (var i = 0, len = data.length; i < len; i++){\n\t\t\t\titem = data[i];\n\t\t\t\tthis.setParent(item, replaceValidZeroId(this.getParent(item), rootId) || rootId);\n\t\t\t}\n\n\t\t\t// calculating $level for each item\n\t\t\tfor (var i = 0, len = data.length; i < len; i++){\n\t\t\t\titem = data[i];\n\t\t\t\tthis._add_branch(item);\n\t\t\t\titem.$level = this.calculateItemLevel(item);\n\t\t\t\titem.$local_index = this.getBranchIndex(item.id);\n\n\t\t\t\tif (!utils.defined(item.$open)) {\n\t\t\t\t\titem.$open = utils.defined(item.open) ? item.open : this.$openInitially();\n\t\t\t\t}\n\n\t\t\t}\n\t\t\tthis._updateOrder();\n\t\t},\n\t\t_isSplitItem: function(item){\n\t\t\treturn this._splitTaskHelper.isSplitItem(item);\n\t\t},\n\t\t_isSplitChildItem: function(item){\n\t\t\treturn this._splitTaskHelper.isSubrowSplitItem(item);\n\t\t},\n\t\t_isDefaultItem: function(item){\n\t\t\treturn this._splitTaskHelper.isDefaultSplitItem(item);\n\t\t},\n\t\t_isInlineChildItem: function(item){\n\t\t\treturn this._splitTaskHelper.isInlineSplitItem(item);\n\t\t},\n\t\tparse: function(data){\n\t\t\tif (!this._skip_refresh) {\n\t\t\t\tthis.callEvent(\"onBeforeParse\", [data]);\n\t\t\t}\n\t\t\tvar loaded = this._parseInner(data);\n\t\t\tthis._buildTree(loaded);\n\t\t\tthis.filter();\n\t\t\tif (!this._skip_refresh) {\n\t\t\t\tthis.callEvent(\"onParse\", [loaded]);\n\t\t\t}\n\t\t},\n\n\t\t_addItemInner: function(item, index){\n\n\t\t\tvar parent = this.getParent(item);\n\n\t\t\tif(!utils.defined(parent)){\n\t\t\t\tparent = this.$getRootId();\n\t\t\t\tthis.setParent(item, parent);\n\t\t\t}\n\n\t\t\tvar parentIndex = this.getIndexById(parent);\n\t\t\tvar targetIndex = parentIndex + Math.min(Math.max(index, 0), this.visibleOrder.length);\n\n\t\t\tif(targetIndex*1 !== targetIndex){\n\t\t\t\ttargetIndex = undefined;\n\t\t\t}\n\t\t\tDataStore.prototype._addItemInner.call(this, item, targetIndex);\n\t\t\tthis.setParent(item, parent);\n\n\t\t\tif(item.hasOwnProperty(\"$rendered_parent\")){\n\t\t\t\tthis._move_branch(item, item.$rendered_parent);\n\t\t\t}\n\t\t\tthis._add_branch(item, index);\n\t\t},\n\t\t_changeIdInner: function(oldId, newId){\n\t\t\tvar children = this.getChildren(oldId);\n\t\t\tvar visibleOrder = this._searchVisibleOrder[oldId];\n\n\t\t\tDataStore.prototype._changeIdInner.call(this, oldId, newId);\n\n\t\t\tvar parent = this.getParent(newId);\n\n\t\t\tthis._replace_branch_child(parent, oldId, newId);\n\n\t\t\tif(this._branches[oldId]){\n\t\t\t\tthis._branches[newId] = this._branches[oldId];\n\t\t\t}\n\t\t\tfor(var i = 0; i < children.length; i++){\n\t\t\t\tvar child = this.getItem(children[i]);\n\t\t\t\tchild[this.$parentProperty] = newId;\n\t\t\t\tchild.$rendered_parent = newId;\n\t\t\t}\n\n\t\t\tthis._searchVisibleOrder[newId] = visibleOrder;\n\t\t\tdelete this._branches[oldId];\n\t\t},\n\n\t\t_traverseBranches: function(code, parent){\n\t\t\tif (!utils.defined(parent)) {\n\t\t\t\tparent = this.$getRootId();\n\t\t\t}\n\t\t\tvar branch = this._branches[parent];\n\t\t\tif (branch) {\n\t\t\t\tfor (var i = 0; i < branch.length; i++) {\n\t\t\t\t\tvar itemId = branch[i];\n\t\t\t\t\tcode.call(this, itemId);\n\t\t\t\t\tif (this._branches[itemId])\n\t\t\t\t\t\tthis._traverseBranches(code, itemId);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t_updateOrder: function(code){\n\n\t\t\tthis.fullOrder = powerArray.$create();\n\t\t\tthis._traverseBranches(function(taskId){\n\t\t\t\tthis.fullOrder.push(taskId);\n\t\t\t});\n\n\t\t\tif(code)\n\t\t\t\tDataStore.prototype._updateOrder.call(this, code);\n\t\t},\n\n\t\t_removeItemInner: function(id){\n\n\t\t\tvar items = [];\n\t\t\tthis.eachItem(function(child){\n\t\t\t\titems.push(child);\n\t\t\t}, id);\n\n\t\t\titems.push(this.getItem(id));\n\n\t\t\tfor(var i = 0; i < items.length; i++){\n\n\t\t\t\tthis._move_branch(items[i], this.getParent(items[i]), null);\n\t\t\t\tDataStore.prototype._removeItemInner.call(this, items[i].id);\n\t\t\t\tthis._move_branch(items[i], this.getParent(items[i]), null);\n\t\t\t}\n\t\t},\n\n\t\tmove: function(sid, tindex, parent){\n\t\t\t//target id as 4th parameter\n\t\t\tvar id = arguments[3];\n\t\t\tvar config = this._ganttConfig || {};\n\t\t\tvar root_id = config.root_id || 0;\n\t\t\tid = replaceValidZeroId(id, root_id);\n\t\t\tif (id) {\n\t\t\t\tif (id === sid) return;\n\n\t\t\t\tparent = this.getParent(id);\n\t\t\t\ttindex = this.getBranchIndex(id);\n\t\t\t}\n\t\t\tif(isEqualIds(sid, parent)){\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (!utils.defined(parent)) {\n\t\t\t\tparent = this.$getRootId();\n\t\t\t}\n\t\t\tvar source = this.getItem(sid);\n\t\t\tvar source_pid = this.getParent(source.id);\n\n\t\t\tvar tbranch = this.getChildren(parent);\n\n\t\t\tif (tindex == -1)\n\t\t\t\ttindex = tbranch.length + 1;\n\t\t\tif (isEqualIds(source_pid, parent)) {\n\t\t\t\tvar sindex = this.getBranchIndex(sid);\n\t\t\t\tif (sindex == tindex) return;\n\t\t\t}\n\n\t\t\tif(this.callEvent(\"onBeforeItemMove\", [sid, parent, tindex]) === false)\n\t\t\t\treturn false;\n\n\t\t\tvar placeholderIds = [];\n\t\t\tfor(var i = 0; i < tbranch.length; i++){\n\t\t\t\tif (isPlaceholderTask(tbranch[i], null, this, this._ganttConfig)){\n\t\t\t\t\tplaceholderIds.push(tbranch[i]);\n\t\t\t\t\ttbranch.splice(i, 1);\n\t\t\t\t\ti--;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis._replace_branch_child(source_pid, sid);\n\t\t\ttbranch = this.getChildren(parent);\n\n\t\t\tvar tid = tbranch[tindex];\n\t\t\ttid = replaceValidZeroId(tid, root_id);\n\t\t\tif (!tid) //adding as last element\n\t\t\t\ttbranch.push(sid);\n\t\t\telse\n\t\t\t\ttbranch = tbranch.slice(0, tindex).concat([ sid ]).concat(tbranch.slice(tindex));\n\n\t\t\tif (placeholderIds.length){\n\t\t\t\ttbranch = tbranch.concat(placeholderIds);\n\t\t\t}\n\t\t\t// GS-2423 to return initial parent to the task before it will be moved\n\t\t\tif (!isEqualIds(source.$rendered_parent, source_pid) && !isEqualIds(source_pid, parent)){\n\t\t\t\tsource.$rendered_parent = source_pid;\n\t\t\t}\n\t\t\tthis.setParent(source, parent);\n\t\t\tthis._branches[parent] = tbranch;\n\n\t\t\tvar diff = this.calculateItemLevel(source) - source.$level;\n\t\t\tsource.$level += diff;\n\t\t\tthis.eachItem(function(item){\n\t\t\t\titem.$level += diff;\n\t\t\t}, source.id, this);\n\n\n\t\t\tthis._moveInner(this.getIndexById(sid), this.getIndexById(parent) + tindex);\n\n\t\t\tthis.callEvent(\"onAfterItemMove\", [sid, parent, tindex]);\n\t\t\tthis.refresh();\n\t\t},\n\n\t\tgetBranchIndex: function(id){\n\t\t\tvar branch = this.getChildren(this.getParent(id));\n\t\t\tlet index = branch.indexOf(id + \"\");\n\t\t\tif (index == -1){\n\t\t\t\tindex = branch.indexOf(+id);\n\t\t\t}\n\t\t\treturn index;\n\t\t},\n\t\thasChild: function(id){\n\t\t\tvar branch = this._branches[id];\n\t\t\treturn branch && branch.length;\n\t\t},\n\t\tgetChildren: function(id){\n\t\t\tvar branch = this._branches[id];\n\t\t\treturn branch ? branch : powerArray.$create();\n\t\t},\n\n\t\tisChildOf: function(childId, parentId){\n\t\t\tif (!this.exists(childId))\n\t\t\t\treturn false;\n\t\t\tif (parentId === this.$getRootId())\n\t\t\t\treturn true;\n\n\t\t\tif (!this.hasChild(parentId))\n\t\t\t\treturn false;\n\n\t\t\tvar item = this.getItem(childId);\n\t\t\tvar pid = this.getParent(childId);\n\n\t\t\tvar parent = this.getItem(parentId);\n\t\t\tif(parent.$level >= item.$level){\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\twhile (item && this.exists(pid)) {\n\t\t\t\titem = this.getItem(pid);\n\n\t\t\t\tif (item && isEqualIds(item.id, parentId))\n\t\t\t\t\treturn true;\n\t\t\t\tpid = this.getParent(item);\n\t\t\t}\n\t\t\treturn false;\n\t\t},\n\n\t\tgetSiblings: function(id){\n\t\t\tif(!this.exists(id)){\n\t\t\t\treturn powerArray.$create();\n\t\t\t}\n\t\t\tvar parent = this.getParent(id);\n\t\t\treturn this.getChildren(parent);\n\n\t\t},\n\t\tgetNextSibling: function(id){\n\t\t\tvar siblings = this.getSiblings(id);\n\t\t\tfor(var i= 0, len = siblings.length; i < len; i++){\n\t\t\t\tif(isEqualIds(siblings[i], id)){\n\t\t\t\t\tvar nextSibling = siblings[i+1];\n\t\t\t\t\tif (nextSibling === 0 && i > 0){\n\t\t\t\t\t\tnextSibling = \"0\";\n\t\t\t\t\t}\n\t\t\t\t\treturn nextSibling || null;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t},\n\t\tgetPrevSibling: function(id){\n\t\t\tvar siblings = this.getSiblings(id);\n\t\t\tfor(var i= 0, len = siblings.length; i < len; i++){\n\t\t\t\tif(isEqualIds(siblings[i], id)){\n\t\t\t\t\tvar previousSibling = siblings[i-1];\n\t\t\t\t\tif (previousSibling === 0 && i > 0){\n\t\t\t\t\t\tpreviousSibling = \"0\";\n\t\t\t\t\t}\n\t\t\t\t\treturn previousSibling || null;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t},\n\t\tgetParent: function(id){\n\t\t\tvar item = null;\n\t\t\tif(id.id !== undefined){\n\t\t\t\titem = id;\n\t\t\t}else{\n\t\t\t\titem = this.getItem(id);\n\t\t\t}\n\n\t\t\tvar parent;\n\t\t\tif(item){\n\t\t\t\tparent = item[this.$parentProperty];\n\t\t\t}else{\n\t\t\t\tparent = this.$getRootId();\n\t\t\t}\n\t\t\treturn parent;\n\n\t\t},\n\n\t\tclearAll: function(){\n\t\t\tthis._branches = {};\n\t\t\tDataStore.prototype.clearAll.call(this);\n\t\t},\n\n\t\tcalculateItemLevel: function(item){\n\t\t\tvar level = 0;\n\t\t\tthis.eachParent(function(){\n\t\t\t\tlevel++;\n\t\t\t}, item);\n\t\t\treturn level;\n\t\t},\n\n\t\t_setParentInner: function(item, new_pid, silent){\n\t\t\tif(!silent){\n\t\t\t\tif(item.hasOwnProperty(\"$rendered_parent\")){\n\t\t\t\t\tthis._move_branch(item, item.$rendered_parent, new_pid);\n\t\t\t\t}else{\n\t\t\t\t\tthis._move_branch(item, item[this.$parentProperty], new_pid);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tsetParent: function(item, new_pid, silent){\n\t\t\tthis._setParentInner(item, new_pid, silent);\n\n\t\t\titem[this.$parentProperty] = new_pid;\n\t\t},\n\n\t\t_eachItemCached: function(code, cache){\n\t\t\tfor(var i = 0, len = cache.length; i < len; i++){\n\t\t\t\tcode.call(this, cache[i]);\n\t\t\t}\n\t\t},\n\t\t_eachItemIterate: function(code, startId, cache){\n\t\t\tvar itemsStack = this.getChildren(startId);\n\t\t\tif(itemsStack.length){\n\t\t\t\titemsStack = itemsStack.slice().reverse();\n\t\t\t}\n\t\t\twhile(itemsStack.length){\n\t\t\t\tvar itemId = itemsStack.pop();\n\t\t\t\tvar item = this.getItem(itemId);\n\t\t\t\tcode.call(this, item);\n\t\t\t\tif(cache){\n\t\t\t\t\tcache.push(item);\n\t\t\t\t}\n\n\t\t\t\tif(this.hasChild(item.id)){\n\t\t\t\t\tvar children = this.getChildren(item.id);\n\t\t\t\t\tvar len = children.length;\n\t\t\t\t\tfor(var i = len - 1; i >= 0; i--){\n\t\t\t\t\t\titemsStack.push(children[i]);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\t\t},\n\n\t\teachItem: function(code, parent){\n\t\t\tvar rootId = this.$getRootId();\n\t\t\tif (!utils.defined(parent)) {\n\t\t\t\tparent = rootId;\n\t\t\t}\n\t\t\tvar startId = replaceValidZeroId(parent, rootId) || rootId;\n\n\t\t\tvar useCache = false;\n\t\t\tvar buildCache = false;\n\t\t\tvar cache = null;\n\t\t\tif(startId === rootId){\n\t\t\t\tif(this._eachItemMainRangeCache){\n\t\t\t\t\tuseCache = true;\n\t\t\t\t\tcache = this._eachItemMainRangeCache;\n\t\t\t\t}else{\n\t\t\t\t\tbuildCache = true;\n\t\t\t\t\tcache = this._eachItemMainRangeCache = [];\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(useCache){\n\t\t\t\tthis._eachItemCached(code, cache);\n\t\t\t}else{\n\t\t\t\tthis._eachItemIterate(code, startId, buildCache ? cache : null);\n\t\t\t}\n\t\t},\n\t\teachParent: function(code, startItem) {\n\t\t\tvar parentsHash = {};\n\t\t\tvar item = startItem;\n\t\t\tvar parent = this.getParent(item);\n\n\t\t\twhile (this.exists(parent)) {\n\t\t\t\tif (parentsHash[parent]) {\n\t\t\t\t\tthrow new Error(\"Invalid tasks tree. Cyclic reference has been detected on task \" + parent);\n\t\t\t\t}\n\t\t\t\tparentsHash[parent] = true;\n\t\t\t\titem = this.getItem(parent);\n\t\t\t\tcode.call(this, item);\n\t\t\t\tparent = this.getParent(item);\n\t\t\t}\n\t\t},\n\t\t_add_branch: function(item, index, parent){\n\t\t\tvar pid = parent === undefined ? this.getParent(item) : parent;\n\t\t\tif (!this.hasChild(pid))\n\t\t\t\tthis._branches[pid] = powerArray.$create();\n\t\t\tvar branch = this.getChildren(pid);\n\t\t\tvar added_already = branch.indexOf(item.id + \"\") > -1 || branch.indexOf(+item.id) > -1;\n\t\t\tif(!added_already){\n\t\t\t\tif(index*1 == index){\n\n\t\t\t\t\tbranch.splice(index, 0, item.id);\n\t\t\t\t}else{\n\t\t\t\t\tbranch.push(item.id);\n\t\t\t\t}\n\n\t\t\t\titem.$rendered_parent = pid;\n\t\t\t}\n\t\t},\n\t\t_move_branch: function(item, old_parent, new_parent){\n\t\t\tthis._eachItemMainRangeCache = null;\n\t\t\t//this.setParent(item, new_parent);\n\t\t\t//this._sync_parent(task);\n\t\t\tthis._replace_branch_child(old_parent, item.id);\n\t\t\tif(this.exists(new_parent) || isEqualIds(new_parent, this.$getRootId())){\n\n\t\t\t\tthis._add_branch(item, undefined, new_parent);\n\t\t\t}else{\n\t\t\t\tdelete this._branches[item.id];\n\t\t\t}\n\t\t\titem.$level =  this.calculateItemLevel(item);\n\t\t\tthis.eachItem(function(child){\n\t\t\t\tchild.$level = this.calculateItemLevel(child);\n\t\t\t}, item.id);\n\t\t},\n\n\t\t_replace_branch_child: function(node, old_id, new_id){\n\t\t\tvar branch = this.getChildren(node);\n\t\t\tif (branch && node !== undefined){\n\t\t\t\tvar newbranch = powerArray.$create();\n\n\t\t\t\tlet index = branch.indexOf(old_id + \"\");\n\t\t\t\tif (index == -1 && !isNaN(+old_id)){\n\t\t\t\t\tindex = branch.indexOf(+old_id);\n\t\t\t\t} \n\n\t\t\t\tif (index > -1){\n\t\t\t\t\tif (new_id){\n\t\t\t\t\t\tbranch.splice(index, 1, new_id);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbranch.splice(index, 1);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tnewbranch = branch;\n\n\t\t\t\tthis._branches[node] = newbranch;\n\t\t\t}\n\n\t\t},\n\n\t\tsort: function(field, desc, parent){\n\t\t\tif (!this.exists(parent)) {\n\t\t\t\tparent = this.$getRootId();\n\t\t\t}\n\n\t\t\tif (!field) field = \"order\";\n\t\t\tvar criteria = (typeof(field) == \"string\") ? (function(a, b) {\n\t\t\t\tif (a[field] == b[field] ||\n\t\t\t\t\t(helpers.isDate(a[field]) && helpers.isDate(b[field]) && a[field].valueOf() == b[field].valueOf()))\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\tvar result = a[field] > b[field];\n\t\t\t\treturn result ? 1 : -1;\n\t\t\t}) : field;\n\n\t\t\tif (desc) {\n\t\t\t\tvar original_criteria = criteria;\n\t\t\t\tcriteria = function (a, b) {\n\t\t\t\t\treturn original_criteria(b, a);\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tvar els = this.getChildren(parent);\n\n\t\t\tif (els){\n\t\t\t\tvar temp = [];\n\t\t\t\tfor (var i = els.length - 1; i >= 0; i--)\n\t\t\t\t\ttemp[i] = this.getItem(els[i]);\n\n\t\t\t\ttemp.sort(criteria);\n\n\t\t\t\tfor (var i = 0; i < temp.length; i++) {\n\t\t\t\t\tels[i] = temp[i].id;\n\t\t\t\t\tthis.sort(field, desc, els[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\tfilter: function(rule){\n\t\t\tfor(let i in this.pull){\n\t\t\t\tconst renderedParent = this.pull[i].$rendered_parent;\n\t\t\t\tconst actualParent = this.getParent(this.pull[i]);\n\t\t\t\t//GS-2339: could be different types of the ids\n\t\t\t\tif(!isEqualIds(renderedParent,actualParent)){\n\t\t\t\t\tthis._move_branch(this.pull[i], renderedParent, actualParent);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn DataStore.prototype.filter.apply(this, arguments);\n\t\t},\n\n\t\topen: function(id){\n\t\t\tif(this.exists(id)){\n\t\t\t\tthis.getItem(id).$open = true;\n\t\t\t\t// GS-2170. Do not recalculate the indexes and dates as they will be recalculated later\n\t\t\t\tthis._skipTaskRecalculation = true;\n\t\t\t\tthis.callEvent(\"onItemOpen\", [id]);\n\t\t\t}\n\t\t},\n\n\t\tclose: function(id){\n\t\t\tif(this.exists(id)){\n\t\t\t\tthis.getItem(id).$open = false;\n\t\t\t\t// GS-2170. Do not recalculate the indexes and dates as they will be recalculated later\n\t\t\t\tthis._skipTaskRecalculation = true;\n\t\t\t\tthis.callEvent(\"onItemClose\", [id]);\n\t\t\t}\n\t\t},\n\n\t\tdestructor: function(){\n\t\t\tDataStore.prototype.destructor.call(this);\n\t\t\tthis._branches = null;\n\t\t\tthis._indexRangeCache = {};\n\t\t\tthis._eachItemMainRangeCache = null;\n\t\t}\n\t},\n\tDataStore.prototype\n);\n\nfunction isEqualIds(first, second){\n\treturn String(first) === String(second);\n};\n\nexport default TreeDataStore;","import env from \"./env\";\n\nexport default function(gantt){\n\treturn env.isNode || !gantt.$root;\n};","import isHeadless from \"../../utils/is_headless\";\n\nconst storeRenderCreator = function(name, gantt){\n\n\tconst store = gantt.getDatastore(name);\n\n\tconst itemRepainter = {\n\t\trenderItem: function(id, renderer){\n\n\t\t\tconst renders = renderer.getLayers();\n\n\t\t\tconst item = store.getItem(id);\n\t\t\tif(item && store.isVisible(id)) {\n\t\t\t\tfor (let i = 0; i < renders.length; i++)\n\t\t\t\t\trenders[i].render_item(item);\n\t\t\t}\n\t\t},\n\t\trenderItems: function(renderer){\n\t\t\tconst renderers = renderer.getLayers();\n\t\t\tfor (let i = 0; i < renderers.length; i++) {\n\t\t\t\trenderers[i].clear();\n\t\t\t}\n\n\t\t\tlet allData = null;\n\n\t\t\tconst loadedRanges = {};\n\t\t\tfor (let i = 0; i < renderers.length; i++) {\n\t\t\t\tconst layer = renderers[i];\n\t\t\t\tlet layerData;\n\t\t\t\tif(layer.get_visible_range){\n\n\t\t\t\t\tvar range = layer.get_visible_range(store);\n\t\t\t\t\tif(range.start !== undefined && range.end !== undefined){\n\t\t\t\t\t\tvar key = range.start + \" - \" + range.end;\n\t\t\t\t\t\tif(loadedRanges[key]){\n\t\t\t\t\t\t\tlayerData = loadedRanges[key];\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tlayerData = store.getIndexRange(range.start, range.end);\n\t\t\t\t\t\t\tloadedRanges[key] = layerData;\n\t\t\t\t\t\t}\n\t\t\t\t\t}else if(range.ids !== undefined){\n\t\t\t\t\t\tlayerData = range.ids.map(function(id){\n\t\t\t\t\t\t\treturn store.getItem(id);\n\t\t\t\t\t\t});\n\t\t\t\t\t}else{\n\t\t\t\t\t\tthrow new Error(\"Invalid range returned from 'getVisibleRange' of the layer\");\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\tif(!allData){\n\t\t\t\t\t\tallData = store.getVisibleItems();\n\t\t\t\t\t}\n\t\t\t\t\tlayerData = allData;\n\t\t\t\t}\n\n\t\t\t\tif (layer.prepare_data) {\n\t\t\t\t\t// GS-1605. Highlight timeline cells below tasks and in an empty chart\n\t\t\t\t\tlayer.prepare_data(layerData);\n\t\t\t\t}\n\n\t\t\t\trenderers[i].render_items(layerData);\n\t\t\t}\n\t\t},\n\t\tupdateItems: function(layer) {\n\t\t\tif(layer.update_items){\n\t\t\t\tlet data = [];\n\t\t\t\tif(layer.get_visible_range){\n\n\t\t\t\t\tvar range = layer.get_visible_range(store);\n\t\t\t\t\tif(range.start !== undefined && range.end !== undefined){\n\t\t\t\t\t\tdata = store.getIndexRange(range.start, range.end);\n\t\t\t\t\t}\n\t\t\t\t\tif(range.ids !== undefined){\n\t\t\t\t\t\tlet extraDataArr = range.ids.map(function(id){\n\t\t\t\t\t\t\treturn store.getItem(id);\n\t\t\t\t\t\t});\n\t\t\t\t\t\t// GS-2502: range.ids might not exist in other datastores\n\t\t\t\t\t\tif(extraDataArr.length > 0){\n\t\t\t\t\t\t\textraDataArr = extraDataArr.filter(element => element !== undefined);\n\t\t\t\t\t\t\tdata = data.concat(extraDataArr);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif((range.start == undefined || range.end == undefined) && range.ids == undefined)  {\n\t\t\t\t\t\tthrow new Error(\"Invalid range returned from 'getVisibleRange' of the layer\");\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\tdata = store.getVisibleItems();\n\t\t\t\t}\n\n\t\t\t\tif (layer.prepare_data) {\n\t\t\t\t\t// GS-1605. Highlight timeline cells below tasks and in an empty chart\n\t\t\t\t\tlayer.prepare_data(data, layer);\n\t\t\t\t}\n\t\t\t\tlayer.update_items(data);\n\t\t\t}\n\t\t}\n\t};\n\n\tstore.attachEvent(\"onStoreUpdated\", function(id, item, action){\n\t\tif(isHeadless(gantt)){\n\t\t\treturn true;\n\t\t}\n\n\t\tconst renderer = gantt.$services.getService(\"layers\").getDataRender(name);\n\t\tif(renderer){\n\t\t\trenderer.onUpdateRequest = function(layer){\n\t\t\t\titemRepainter.updateItems(layer);\n\t\t\t};\n\t\t}\n\t});\n\n\tfunction skipRepaint(gantt){\n\t\tconst state = gantt.$services.getService(\"state\");\n\t\tif(state.getState(\"batchUpdate\").batch_update){\n\t\t\treturn true;\n\t\t}else{\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tstore.attachEvent(\"onStoreUpdated\", function(id, item, action){\n\t\tif(skipRepaint(gantt)){\n\t\t\treturn;\n\t\t}\n\t\tif(!id || action == \"move\" || action == \"delete\"){\n\t\t\tstore.callEvent(\"onBeforeRefreshAll\", []);\n\t\t\tstore.callEvent(\"onAfterRefreshAll\", []);\n\t\t}else{\n\t\t\tstore.callEvent(\"onBeforeRefreshItem\", [item.id]);\n\t\t\tstore.callEvent(\"onAfterRefreshItem\", [item.id]);\n\t\t}\n\t});\n\n\tstore.attachEvent(\"onAfterRefreshAll\", function(){\n\t\tif(isHeadless(gantt)){\n\t\t\treturn true;\n\t\t}\n\n\t\tconst renderer = gantt.$services.getService(\"layers\").getDataRender(name);\n\t\tif(renderer && !skipRepaint(gantt)){\n\t\t\titemRepainter.renderItems(renderer);\n\t\t}\n\t});\n\tstore.attachEvent(\"onAfterRefreshItem\", function(id){\n\t\tif(isHeadless(gantt)){\n\t\t\treturn true;\n\t\t}\n\n\t\tconst renderer = gantt.$services.getService(\"layers\").getDataRender(name);\n\t\tif(renderer){\n\t\t\titemRepainter.renderItem(id, renderer);\n\t\t}\n\t});\n\n\t// TODO: probably can be done more in a more efficient way\n\tstore.attachEvent(\"onItemOpen\", function(){\n\t\tif(isHeadless(gantt) || store.isSilent()){\n\t\t\treturn true;\n\t\t}\n\n\t\tgantt.render();\n\t});\n\n\tstore.attachEvent(\"onItemClose\", function(){\n\t\tif(isHeadless(gantt) || store.isSilent()){\n\t\t\treturn true;\n\t\t}\n\n\t\tgantt.render();\n\t});\n\n\tfunction refreshId(renders, oldId, newId, item) {\n\t\tfor (let i = 0; i < renders.length; i++) {\n\t\t\trenders[i].change_id(oldId, newId);\n\t\t}\n\t}\n\n\tstore.attachEvent(\"onIdChange\", function(oldId, newId){\n\t\tif(isHeadless(gantt)){\n\t\t\treturn true;\n\t\t}\n\n\t\t// in case of linked datastores (tasks <-> links), id change should recalculate something in linked datastore before any repaint\n\t\t// use onBeforeIdChange for this hook.\n\t\t// TODO: use something more reasonable instead\n\t\tstore.callEvent(\"onBeforeIdChange\", [oldId, newId]);\n\n\t\tif(skipRepaint(gantt)){\n\t\t\treturn;\n\t\t}\n\t\tif(!store.isSilent()){\n\t\t\tconst renderer = gantt.$services.getService(\"layers\").getDataRender(name);\n\t\t\tif(renderer){ // missing check for renderer GS-1814\n\t\t\t\trefreshId(renderer.getLayers(), oldId, newId, store.getItem(newId));\n\t\t\t\titemRepainter.renderItem(newId, renderer);\n\t\t\t}else{\n\t\t\t\t// GS-1814 repaint ui to apply new id when the datastore don't have own renderer\n\t\t\t\tgantt.render();\n\t\t\t}\n\t\t}\n\t});\n\n};\n\nexport default {\n\tbindDataStore: storeRenderCreator\n};","import * as utils from \"../../utils/utils\";\nimport createTasksFacade from \"./datastore_tasks\";\nimport createLinksFacade from \"./datastore_links\";\nimport DataStore from \"../datastore/datastore\";\nimport TreeDataStore from \"../datastore/treedatastore\";\nimport createDatastoreSelect from \"../datastore/select\";\nimport datastoreRender from \"../datastore/datastore_render\";\nimport isHeadless from \"../../utils/is_headless\";\nimport {replaceValidZeroId} from \"../../utils/helpers\";\n\nfunction getDatastores(){\n\tvar storeNames = this.$services.getService(\"datastores\");\n\tvar res = [];\n\tfor(var i = 0; i < storeNames.length; i++){\n\t\tvar store = this.getDatastore(storeNames[i]);\n\t\tif(!store.$destroyed){\n\t\t\tres.push(store);\n\t\t}\n\t}\n\treturn res;\n}\n\nvar createDatastoreFacade = function(){\n\treturn {\n\tcreateDatastore: function(config){\n\n\t\tvar $StoreType = (config.type || \"\").toLowerCase() == \"treedatastore\" ? TreeDataStore : DataStore;\n\n\t\tif (config) {\n\t\t\tvar self = this;\n\t\t\tconfig.openInitially = function(){ return self.config.open_tree_initially; };\n\t\t\tconfig.copyOnParse = function(){ return self.config.deepcopy_on_parse; };\n\t\t}\n\n\t\tvar store = new $StoreType(config);\n\t\tthis.mixin(store, createDatastoreSelect(store));\n\n\t\tif (config.name) {\n\t\t\tvar servicePrefix = \"datastore:\";\n\t\t\tvar storeAccessName = servicePrefix + config.name;\n\n\t\t\tstore.attachEvent(\"onDestroy\", function(){\n\t\t\t\tthis.$services.dropService(storeAccessName);\n\t\t\t\tvar storeList = this.$services.getService(\"datastores\");\n\t\t\t\tfor(var i = 0; i < storeList.length; i++){\n\t\t\t\t\tif(storeList[i] === config.name){\n\t\t\t\t\t\tstoreList.splice(i, 1);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}.bind(this));\n\n\t\t\tthis.$services.dropService(storeAccessName);\n\t\t\tthis.$services.setService(storeAccessName, function() { return store; } );\n\n\t\t\tvar storeList = this.$services.getService(\"datastores\");\n\t\t\tif (!storeList) {\n\t\t\t\tstoreList = [];\n\t\t\t\tthis.$services.setService(\"datastores\", function() { return storeList; });\n\t\t\t\tstoreList.push(config.name);\n\t\t\t} else if (storeList.indexOf(config.name) < 0) {\n\t\t\t\tstoreList.push(config.name);\n\t\t\t}\n\n\t\t\tdatastoreRender.bindDataStore(config.name, this);\n\n\t\t}\n\n\t\treturn store;\n\t},\n\tgetDatastore: function(name){\n\t\treturn this.$services.getService(\"datastore:\" + name);\n\t},\n\t_getDatastores: getDatastores,\n\n\trefreshData: function () {\n\t\tvar scrollState;\n\t\tif(!isHeadless(this)){\n\t\t\tscrollState = this.getScrollState();\n\t\t}\n\n\t\tthis.callEvent(\"onBeforeDataRender\", []);\n\n\t\tvar stores = getDatastores.call(this);\n\t\tfor(var i = 0; i < stores.length; i++){\n\t\t\tstores[i].refresh();\n\t\t}\n\n\t\tif(this.config.preserve_scroll && !isHeadless(this)){\n\t\t\tif(scrollState.x || scrollState.y){\n\t\t\t\tthis.scrollTo(scrollState.x, scrollState.y);\n\t\t\t}\n\t\t\t// GS-2866: need to restore the scroll position after resizing the resource view\n\t\t\t// in case if it was increased\n\t\t\tconst scrollbarsInfo = this.$layout.getScrollbarsInfo();\n\t\t\tscrollbarsInfo.forEach((scroll_info) => {\n\t\t\t\tconst scroll = this.$ui.getView(scroll_info.id);\n\t\t\t\tif(!scroll) return;\n\t\t\t\tconst scrollbarNodeVisible = this.utils.dom.isChildOf(scroll.$view, this.$container);\n\t\t\t\tscroll_info.boundViews.forEach((viewName) => {\n\t\t\t\t\tconst view = this.$ui.getView(viewName);\n\t\t\t\t\tif(scroll_info.y){\n\t\t\t\t\t\tif(view && !scrollbarNodeVisible){\n\t\t\t\t\t\t\tview.scrollTo(undefined, 0);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t\tthis.callEvent(\"onDataRender\", []);\n\n\t},\n\n\tisChildOf: function(childId, parentId){\n\t\treturn this.$data.tasksStore.isChildOf(childId, parentId);\n\t},\n\n\trefreshTask: function (taskId, refresh_links) {\n\t\tvar task = this.getTask(taskId);\n\t\tvar self = this;\n\t\tfunction refreshLinks(){\n\t\t\tif (refresh_links !== undefined && !refresh_links)\n\t\t\t\treturn;\n\t\t\tfor (var i = 0; i < task.$source.length; i++) {\n\t\t\t\tself.refreshLink(task.$source[i]);\n\t\t\t}\n\t\t\tfor (var i = 0; i < task.$target.length; i++) {\n\t\t\t\tself.refreshLink(task.$target[i]);\n\t\t\t}\n\t\t}\n\n\t\tif (task && this.isTaskVisible(taskId)) {\n\t\t\tthis.$data.tasksStore.refresh(taskId, !!this.getState(\"tasksDnd\").drag_id || refresh_links === false);// do quick refresh during drag and drop\n\t\t\trefreshLinks();\n\t\t}else if(this.isTaskExists(taskId) && this.isTaskExists(this.getParent(taskId)) && !this._bulk_dnd){\n\t\t\tthis.refreshTask(this.getParent(taskId));\n\n\t\t\tvar hasSplitParent = false;\n\t\t\tthis.eachParent(function(parent){\n\t\t\t\tif(hasSplitParent || this.isSplitTask(parent)){\n\t\t\t\t\thasSplitParent = true;\n\t\t\t\t}\n\t\t\t}, taskId);\n\t\t\tif(hasSplitParent){\n\t\t\t\trefreshLinks();\n\t\t\t}\n\t\t}\n\n\t},\n\trefreshLink: function (linkId) {\n\t\tthis.$data.linksStore.refresh(linkId, !!this.getState(\"tasksDnd\").drag_id);// do quick refresh during drag and drop\n\t},\n\n\tsilent: function(code){\n\t\tvar gantt = this;\n\t\tgantt.$data.tasksStore.silent(function(){\n\t\t\tgantt.$data.linksStore.silent(function(){\n\t\t\t\tcode();\n\t\t\t});\n\t\t});\n\t},\n\n\tclearAll: function () {\n\t\tvar stores = getDatastores.call(this);\n\t\t\n\t\t// clear all stores without invoking clearAll event\n\t\t// in order to prevent calling handlers when only some stores are cleared\n\t\tfor(var i = 0; i < stores.length; i++){\n\t\t\tstores[i].silent(function(){\n\t\t\t\tstores[i].clearAll();\t\n\t\t\t});\n\t\t}\n\t\t// run clearAll again to invoke events\n\t\tfor(var i = 0; i < stores.length; i++){\n\t\t\tstores[i].clearAll();\t\n\t\t}\n\n\t\tthis._update_flags();\n\t\tthis.userdata = {};\n\t\tthis.callEvent(\"onClear\", []);\n\t\tthis.render();\n\t},\n\t_clear_data: function () {\n\t\tthis.$data.tasksStore.clearAll();\n\t\tthis.$data.linksStore.clearAll();\n\t\tthis._update_flags();\n\t\tthis.userdata = {};\n\t},\n\n\tselectTask: function(id){\n\t\tvar store = this.$data.tasksStore;\n\t\tif(!this.config.select_task)\n\t\t\treturn false;\n\t\tid = replaceValidZeroId(id, this.config.root_id);\n\t\tif (id){\n\t\t\tlet oldSelectId = this.getSelectedId();\n\t\t\t// Don't repaint the resource panel as the data didn't change\n\t\t\tstore._skipResourceRepaint = true;\n\t\t\tstore.select(id);\n\t\t\tstore._skipResourceRepaint = false;\n\t\t\t// GS-730. Split task is not included in the tree, \n\t\t\t// so the datastore renderer will think that the task is not visible\n\t\t\tif (oldSelectId && store.pull[oldSelectId].$split_subtask && oldSelectId != id) {\n\t\t\t\tthis.refreshTask(oldSelectId);\n\t\t\t}\n\t\t\tif (store.pull[id].$split_subtask && oldSelectId != id) {// GS-1850. Do not repaint split task after double click\n\t\t\t\tthis.refreshTask(id);\n\t\t\t}\n\t\t}\n\t\treturn store.getSelectedId();\n\t},\n\tunselectTask: function(id){\n\t\tvar store = this.$data.tasksStore;\n\t\tstore.unselect(id);\n\t\t// GS-730. Split task is not included in the tree, \n\t\t// so the datastore renderer will think that the task is not visible\n\t\tif (id && store.pull[id].$split_subtask) {\n\t\t\tthis.refreshTask(id);\n\t\t}\n\t},\n\tisSelectedTask: function(id){\n\t\treturn this.$data.tasksStore.isSelected(id);\n\t},\n\tgetSelectedId: function() {\n\t\treturn this.$data.tasksStore.getSelectedId();\n\t}\n};\n};\n\nfunction createFacade(){\n\tvar res = utils.mixin({}, createDatastoreFacade());\n\tutils.mixin(res, createTasksFacade());\n\tutils.mixin(res, createLinksFacade());\n\treturn res;\n}\n\n\n\n\nexport default {create: createFacade};","function createDataStoreSelectMixin(store){\n\tvar selectedId = null;\n\n\tvar deleteItem = store._removeItemInner;\n\t\n\tfunction unselect(id){\n\t\tselectedId = null;\n\t\tthis.callEvent(\"onAfterUnselect\", [id]);\n\t}\n\n\tstore._removeItemInner = function(id){\n\t\tif(selectedId == id){\n\t\t\tunselect.call(this, id);\n\t\t}\n\n\t\tif(selectedId && this.eachItem){\n\t\t\tthis.eachItem(function(subItem){\n\t\t\t\tif(subItem.id == selectedId){\n\t\t\t\t\tunselect.call(this, subItem.id);\n\t\t\t\t}\n\t\t\t}, id);\n\t\t}\n\n\t\treturn deleteItem.apply(this, arguments);\n\t};\n\n\tstore.attachEvent(\"onIdChange\", function(oldId, newId) {\n\t\tif (store.getSelectedId() == oldId) {\n\t\t\tstore.silent(function () {\n\t\t\t\tstore.unselect(oldId);\n\t\t\t\tstore.select(newId);\n\t\t\t});\n\t\t}\n\t});\n\n\treturn {\n\t\tselect: function(id){\n\t\t\tif (id){\n\n\t\t\t\tif(selectedId == id)\n\t\t\t\t\treturn selectedId;\n\n\t\t\t\tif(!this._skip_refresh) {\n\t\t\t\t\tif (!this.callEvent(\"onBeforeSelect\", [id])) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis.unselect();\n\n\t\t\t\tselectedId = id;\n\n\t\t\t\tif(!this._skip_refresh) {\n\t\t\t\t\tthis.refresh(id);\n\t\t\t\t\tthis.callEvent(\"onAfterSelect\", [id]);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn selectedId;\n\t\t},\n\t\tgetSelectedId: function(){\n\t\t\treturn selectedId;\n\t\t},\n\t\tisSelected: function(id){\n\t\t\treturn id == selectedId;\n\t\t},\n\t\tunselect: function(id){\n\t\t\tvar id = id || selectedId;\n\t\t\tif(!id)\n\t\t\t\treturn;\n\t\t\tselectedId = null;\n\t\t\tif(!this._skip_refresh){\n\t\t\t\tthis.refresh(id);\n\t\t\t\tunselect.call(this, id);\n\t\t\t}\n\t\t}\n\t};\n}\n\nexport default createDataStoreSelectMixin;","import * as utils from \"../../utils/utils\";\n\n\nvar createLinksStoreFacade = function(){\n\treturn {\n\tgetLinkCount: function () {\n\t\treturn this.$data.linksStore.count();\n\t},\n\n\tgetLink : function (id) {\n\t\treturn this.$data.linksStore.getItem(id);\n\t},\n\n\tgetLinks : function () {\n\t\treturn this.$data.linksStore.getItems();\n\t},\n\n\tisLinkExists : function (id) {\n\t\treturn this.$data.linksStore.exists(id);\n\t},\n\n\taddLink : function (link) {\n\t\treturn this.$data.linksStore.addItem(link);\n\t},\n\n\tupdateLink : function (id, data) {\n\t\tif (!utils.defined(data))\n\t\t\tdata = this.getLink(id);\n\t\tthis.$data.linksStore.updateItem(id, data);\n\t},\n\n\tdeleteLink : function (id) {\n\t\treturn this.$data.linksStore.removeItem(id);\n\t},\n\n\tchangeLinkId : function (oldid, newid) {\n\t\treturn this.$data.linksStore.changeId(oldid, newid);\n\t}\n};\n};\n\nexport default createLinksStoreFacade;","import ScaleHelper from \"./ui/timeline/scales_ignore\";\nimport PrimaryScaleHelper from \"./ui/timeline/scales\";\n\nfunction resolveConfigRange(unit, gantt){\n\tvar range = {\n\t\tstart_date:null,\n\t\tend_date:null\n\t};\n\n\tif (gantt.config.start_date && gantt.config.end_date) {\n\t\trange.start_date = gantt.date[unit + \"_start\"](new Date(gantt.config.start_date));\n\n\t\tvar end = new Date(gantt.config.end_date);\n\t\tvar start_interval = gantt.date[unit + \"_start\"](new Date(end));\n\t\tif (+end != +start_interval) {\n\t\t\tend = gantt.date.add(start_interval, 1, unit);\n\t\t} else {\n\t\t\tend = start_interval;\n\t\t}\n\n\t\trange.end_date = end;\n\t}\n\treturn range;\n}\n\nfunction _scale_range_unit(gantt) {\n\tconst primaryScale = (new PrimaryScaleHelper(gantt)).primaryScale();\n\tlet unit = primaryScale.unit;\n\tlet step = primaryScale.step;\n\tif (gantt.config.scale_offset_minimal) {\n\n\t\tconst helper = new ScaleHelper(gantt);\n\t\tconst scales = [helper.primaryScale()].concat(helper.getAdditionalScales());\n\n\t\thelper.sortScales(scales);\n\t\tunit = scales[scales.length - 1].unit;\n\t\tstep = scales[scales.length - 1].step || 1;\n\t}\n\treturn { unit:unit, step:step };\n}\n\nfunction _init_tasks_range(gantt) {\n\tvar cfg = _scale_range_unit(gantt);\n\tvar unit = cfg.unit,\n\t\tstep = cfg.step;\n\tvar range = resolveConfigRange(unit, gantt);\n\n\t// GS-1544: Show correct date range if we have tasks or only projects\n\tif(!(range.start_date && range.end_date)){\n\t\tvar onlyProjectTasks = true;\n\t\tvar tasks = gantt.getTaskByTime();\n\t\tfor (var i = 0; i < tasks.length; i++) {\n\t\t\tvar task = tasks[i];\n\t\t\tif (task.type !== gantt.config.types.project){\n\t\t\t\tonlyProjectTasks = false;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (tasks.length && onlyProjectTasks){\n\t\t\tvar start_date = tasks[0].start_date;\n\t\t\tvar end_date = gantt.date.add(start_date, 1, gantt.config.duration_unit);\n\t\t\trange = {\n\t\t\t\tstart_date: new Date(start_date),\n\t\t\t\tend_date: new Date(end_date)\n\t\t\t};\n\t\t} else{\n\t\t\trange = gantt.getSubtaskDates();\n\t\t}\n\n\t\tif(!range.start_date || !range.end_date){\n\t\t\trange = {\n\t\t\t\tstart_date: new Date(),\n\t\t\t\tend_date: new Date()\n\t\t\t};\n\t\t}\n\t\t// extend the displayed date range including the constraints, deadlines and baselines\n\t\tgantt.eachTask(function(task){\n\t\t\tif (gantt.config.deadlines && task.deadline){\n\t\t\t\textendRangeForDates(range, task.deadline, task.deadline);\n\t\t\t}\n\t\t\tif (task.constraint_date && task.constraint_type){\n\t\t\t\tif (gantt._getAutoSchedulingConfig().apply_constraints && gantt.config.constraint_types && task.constraint_type !== gantt.config.constraint_types.ASAP && task.constraint_type !== gantt.config.constraint_types.ALAP){\n\t\t\t\t\textendRangeForDates(range, task.constraint_date, task.constraint_date);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (gantt.config.baselines && task.baselines){\n\t\t\t\ttask.baselines.forEach(function(baseline){\n\t\t\t\t\textendRangeForDates(range, baseline.start_date, baseline.end_date);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\trange.start_date = gantt.date[unit + \"_start\"](range.start_date);\n\t\trange.start_date = gantt.calculateEndDate({\n\t\t\tstart_date: gantt.date[unit + \"_start\"](range.start_date),\n\t\t\tduration: -1,\n\t\t\tunit: unit,\n\t\t\tstep:step\n\t\t});//one free column before first task\n\n\t\trange.end_date = gantt.date[unit + \"_start\"](range.end_date);\n\t\trange.end_date = gantt.calculateEndDate({start_date: range.end_date, duration: 2, unit: unit, step:step});//one free column after last task\n\t}\n\n\tgantt._min_date = range.start_date;\n\tgantt._max_date = range.end_date;\n}\n\nfunction extendRangeForDates(range, start_date, end_date){\n\tif (start_date < range.start_date){\n\t\trange.start_date = new Date(start_date);\n\t}\n\tif (end_date > range.end_date){\n\t\trange.end_date = new Date(end_date);\n\t}\n}\n\nfunction _adjust_scales(gantt) {\n\tif (gantt.config.fit_tasks) {\n\t\tvar old_min = +gantt._min_date,\n\t\t\told_max = +gantt._max_date;\n\t\t//this._init_tasks_range();\n\t\tif (+gantt._min_date != old_min || +gantt._max_date != old_max) {\n\t\t\tgantt.render();\n\n\t\t\tgantt.callEvent(\"onScaleAdjusted\", []);\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n}\n\nexport default function updateTasksRange(gantt){\n\t_init_tasks_range(gantt);\n\t_adjust_scales(gantt);\n};\n","function copyLinkIdsArray(gantt, linkIds, targetHash){\n\tfor(var i = 0; i < linkIds.length; i++) {\n\t\tif(gantt.isLinkExists(linkIds[i])){\n\t\t\ttargetHash[linkIds[i]] = gantt.getLink(linkIds[i]);\n\t\t}\n\t}\n}\n\nfunction copyLinkIds(gantt, task, targetHash){\n\tcopyLinkIdsArray(gantt, task.$source, targetHash);\n\tcopyLinkIdsArray(gantt, task.$target, targetHash);\n}\n\nfunction getSubtreeLinks(gantt, rootId){\n\tvar res = {};\n\n\tif(gantt.isTaskExists(rootId)){\n\t\tcopyLinkIds(gantt, gantt.getTask(rootId), res);\n\t}\n\n\tgantt.eachTask(function(child){\n\t\tcopyLinkIds(gantt, child, res);\n\t}, rootId);\n\n\treturn res;\n}\n\nfunction getSubtreeTasks(gantt, rootId){\n\tvar res = {};\n\n\tgantt.eachTask(function(child){\n\t\tres[child.id] = child;\n\t}, rootId);\n\n\treturn res;\n}\n\nexport default {\n\tgetSubtreeLinks: getSubtreeLinks,\n\tgetSubtreeTasks: getSubtreeTasks\n};","import * as helpers from \"../../utils/helpers\";\nimport treeHelper from \"../../utils/task_tree_helpers\";\n\n\nexport default class DataProcessorEvents {\n\tprotected _dataProcessorHandlers: any[];\n\tprotected $gantt: any;\n\tprotected $dp: any;\n\n\tconstructor(gantt: any, dp: any) {\n\t\tthis.$gantt = gantt;\n\t\tthis.$dp = dp;\n\t\tthis._dataProcessorHandlers = [];\n\t}\n\n\tattach() {\n\t\tconst dp = this.$dp;\n\t\tconst gantt = this.$gantt;\n\t\tconst cascadeDelete = {};\n\n\t\tconst clientSideDelete = (id) => {\n\t\t\treturn this.clientSideDelete(id, dp, gantt);\n\t\t};\n\n\t\tfunction getTaskLinks(task) {\n\t\t\tlet _links = [];\n\n\t\t\tif (task.$source) {\n\t\t\t\t_links = _links.concat(task.$source);\n\t\t\t}\n\t\t\tif (task.$target) {\n\t\t\t\t_links = _links.concat(task.$target);\n\t\t\t}\n\n\t\t\treturn _links;\n\t\t}\n\n\t\tthis._dataProcessorHandlers.push(gantt.attachEvent(\"onAfterTaskAdd\", function(id, item) { // tslint:disable-line\n\t\t\tif (gantt.isTaskExists(id)) {\n\t\t\t\tdp.setGanttMode(\"tasks\");\n\t\t\t\tdp.setUpdated(id, true, \"inserted\");\n\t\t\t}\n\t\t}));\n\n\t\tthis._dataProcessorHandlers.push(gantt.attachEvent(\"onAfterTaskUpdate\", function(id, item) { // tslint:disable-line\n\t\t\tif (gantt.isTaskExists(id)) {\n\t\t\t\tdp.setGanttMode(\"tasks\");\n\t\t\t\tdp.setUpdated(id, true);\n\n\t\t\t\t// gantt can be destroyed/reinitialized after dp.setUpdated\n\t\t\t\tif(gantt._sendTaskOrder){\n\t\t\t\t\tgantt._sendTaskOrder(id, item);\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\n\t\tthis._dataProcessorHandlers.push(gantt.attachEvent(\"onBeforeTaskDelete\", function(id, item) { // tslint:disable-line\n\t\t\tif (gantt.config.cascade_delete) {\n\t\t\t\tcascadeDelete[id] = {\n\t\t\t\t\ttasks: treeHelper.getSubtreeTasks(gantt, id),\n\t\t\t\t\tlinks: treeHelper.getSubtreeLinks(gantt, id)\n\t\t\t\t};\n\t\t\t}\n\t\t\t// GS-631. Keep the deleted item in Gantt until we receive the successful response from the server\n\t\t\tif (dp.deleteAfterConfirmation) {\n\t\t\t\tdp.setGanttMode(\"tasks\");\n\t\t\t\tdp.setUpdated(id, true, \"deleted\");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t}));\n\n\t\tthis._dataProcessorHandlers.push(gantt.attachEvent(\"onAfterTaskDelete\", function(id, item) { // tslint:disable-line\n\t\t\tdp.setGanttMode(\"tasks\");\n\n\t\t\t// not send delete request if item is not inserted into the db - just remove it from the client\n\t\t\tconst needDbDelete = !clientSideDelete(id);\n\t\t\tconst needCascadeDelete = gantt.config.cascade_delete && cascadeDelete[id];\n\t\t\tif (!needDbDelete && !needCascadeDelete) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (needCascadeDelete) {\n\t\t\t\tconst dpMode = dp.updateMode;\n\t\t\t\tdp.setUpdateMode(\"off\");\n\n\t\t\t\tconst cascade = cascadeDelete[id];\n\t\t\t\tfor (const i in cascade.tasks) {\n\t\t\t\t\tif (!clientSideDelete(i)) {\n\t\t\t\t\t\tdp.storeItem(cascade.tasks[i]);\n\t\t\t\t\t\tdp.setUpdated(i, true, \"deleted\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tdp.setGanttMode(\"links\");\n\t\t\t\tfor (const i in cascade.links) {\n\t\t\t\t\tif (!clientSideDelete(i)) {\n\t\t\t\t\t\tdp.storeItem(cascade.links[i]);\n\t\t\t\t\t\tdp.setUpdated(i, true, \"deleted\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcascadeDelete[id] = null;\n\n\t\t\t\tif (dpMode !== \"off\") {\n\t\t\t\t\tdp.sendAllData();\n\t\t\t\t}\n\t\t\t\tdp.setGanttMode(\"tasks\");\n\t\t\t\tdp.setUpdateMode(dpMode);\n\t\t\t}\n\n\t\t\tif (needDbDelete){\n\t\t\t\tdp.storeItem(item);\n\t\t\t\tif (!dp.deleteAfterConfirmation){\n\t\t\t\t\tdp.setUpdated(id, true, \"deleted\");\n\t\t\t\t}\n\t\t\t}\n\n\n\t\t\tif (dp.updateMode !== \"off\" && !dp._tSend) {\n\t\t\t\tdp.sendAllData();\n\t\t\t}\n\t\t}));\n\n\t\tthis._dataProcessorHandlers.push(gantt.attachEvent(\"onAfterLinkUpdate\", function(id, item) { // tslint:disable-line\n\t\t\tif (gantt.isLinkExists(id)) {\n\t\t\t\tdp.setGanttMode(\"links\");\n\t\t\t\tdp.setUpdated(id, true);\n\t\t\t}\n\t\t}));\n\n\t\tthis._dataProcessorHandlers.push(gantt.attachEvent(\"onAfterLinkAdd\", function(id, item) { // tslint:disable-line\n\t\t\tif (gantt.isLinkExists(id)) {\n\t\t\t\tdp.setGanttMode(\"links\");\n\t\t\t\tdp.setUpdated(id, true,\"inserted\");\n\t\t\t}\n\t\t}));\n\n\t\tthis._dataProcessorHandlers.push(gantt.attachEvent(\"onAfterLinkDelete\", function(id, item) { // tslint:disable-line\n\t\t\tdp.setGanttMode(\"links\");\n\n\t\t\tconst needDbDelete = !clientSideDelete(id);\n\t\t\tif (!needDbDelete) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tdp.storeItem(item);\n\t\t\tdp.setUpdated(id, true,\"deleted\");\n\t\t}));\n\n\t\tthis._dataProcessorHandlers.push(gantt.attachEvent(\"onRowDragEnd\", function(id, target) { // tslint:disable-line\n\t\t\tgantt._sendTaskOrder(id, gantt.getTask(id));\n\t\t}));\n\n\t\tlet tasks = null;\n\t\tlet links = null;\n\n\t\tthis._dataProcessorHandlers.push(gantt.attachEvent(\"onTaskIdChange\", function(oldId, newId) { // tslint:disable-line\n\t\t\tif (!dp._waitMode) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst children = gantt.getChildren(newId);\n\t\t\tif (children.length) {\n\t\t\t\ttasks = tasks || {};\n\n\t\t\t\tfor (let i = 0; i < children.length; i++) {\n\t\t\t\t\tconst ch = this.getTask(children[i]);\n\t\t\t\t\ttasks[ch.id] = ch;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst item = this.getTask(newId);\n\t\t\tconst itemLinks = getTaskLinks(item);\n\n\t\t\tif (itemLinks.length) {\n\t\t\t\tlinks = links || {};\n\n\t\t\t\tfor (let i = 0; i < itemLinks.length; i++) {\n\t\t\t\t\tconst link = this.getLink(itemLinks[i]);\n\t\t\t\t\tlinks[link.id] = link;\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\n\t\tdp.attachEvent(\"onAfterUpdateFinish\", function() {\n\t\t\tif (tasks || links) {\n\t\t\t\tgantt.batchUpdate(function() {\n\t\t\t\t\tfor (const id in tasks) {\n\t\t\t\t\t\tgantt.updateTask(tasks[id].id);\n\t\t\t\t\t}\n\n\t\t\t\t\tfor (const id in links) {\n\t\t\t\t\t\tgantt.updateLink(links[id].id);\n\t\t\t\t\t}\n\t\t\t\t\ttasks = null;\n\t\t\t\t\tlinks = null;\n\t\t\t\t});\n\t\t\t\tif (tasks) {\n\t\t\t\t\tgantt._dp.setGanttMode(\"tasks\");\n\t\t\t\t} else {\n\t\t\t\t\tgantt._dp.setGanttMode(\"links\");\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tdp.attachEvent(\"onBeforeDataSending\", function() {\n\t\t\tif (this._tMode === \"CUSTOM\") {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tlet url = this._serverProcessor;\n\t\t\tif (this._tMode === \"REST-JSON\" || this._tMode === \"REST\") {\n\t\t\t\tconst mode = this._ganttMode;\n\n\t\t\t\turl = url.substring(0, url.indexOf(\"?\") > -1 ? url.indexOf(\"?\") : url.length);\n\t\t\t\t// editing=true&\n\t\t\t\tthis.serverProcessor = url + (url.slice(-1) === \"/\" ? \"\" : \"/\") + mode;\n\t\t\t} else {\n\t\t\t\tconst pluralizedMode = this._ganttMode + \"s\";\n\t\t\t\tthis.serverProcessor = url + gantt.ajax.urlSeparator(url) + \"gantt_mode=\" + pluralizedMode;\n\t\t\t}\n\n\t\t\treturn true;\n\t\t});\n\n\t\tdp.attachEvent(\"insertCallback\", function insertCallback(upd, id, parent, mode) { // tslint:disable-line\n\t\t\tconst data = upd.data || gantt.xml._xmlNodeToJSON(upd.firstChild);\n\t\t\tconst methods = {\n\t\t\t\tadd: gantt.addTask,\n\t\t\t\tisExist: gantt.isTaskExists\n\t\t\t};\n\t\t\tif (mode === \"links\") {\n\t\t\t\tmethods.add = gantt.addLink;\n\t\t\t\tmethods.isExist = gantt.isLinkExists;\n\t\t\t}\n\t\t\tif (methods.isExist.call(gantt, id)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tdata.id = id;\n\t\t\tmethods.add.call(gantt, data);\n\t\t});\n\n\t\tdp.attachEvent(\"updateCallback\", function updateCallback(upd, id) {\n\t\t\tconst data = upd.data || gantt.xml._xmlNodeToJSON(upd.firstChild);\n\t\t\tif (!gantt.isTaskExists(id)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst objData = gantt.getTask(id);\n\t\t\tfor (const key in data) {\n\t\t\t\tlet property = data[key];\n\t\t\t\tswitch (key) {\n\t\t\t\t\tcase \"id\":\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\tcase \"start_date\":\n\t\t\t\t\tcase \"end_date\":\n\t\t\t\t\t\tproperty = gantt.defined(gantt.templates.xml_date) ? gantt.templates.xml_date(property) : gantt.templates.parse_date(property);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"duration\":\n\t\t\t\t\t\tobjData.end_date = gantt.calculateEndDate({start_date: objData.start_date, duration: property, task:objData});\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tobjData[key] = property;\n\t\t\t}\n\t\t\tgantt.updateTask(id);\n\t\t\tgantt.refreshData();\n\t\t});\n\t\tdp.attachEvent(\"deleteCallback\", function deleteCallback(upd, id, parent, mode) { // tslint:disable-line\n\t\t\tconst methods = {\n\t\t\t\tdelete: gantt.deleteTask,\n\t\t\t\tisExist: gantt.isTaskExists\n\t\t\t};\n\t\t\tif (mode === \"links\") {\n\t\t\t\tmethods.delete = gantt.deleteLink;\n\t\t\t\tmethods.isExist = gantt.isLinkExists;\n\t\t\t} else if(mode === \"assignment\") {\n\t\t\t\tmethods.delete = function(val) {\n\t\t\t\t\tgantt.$data.assignmentsStore.remove(val);\n\t\t\t\t};\n\t\t\t\tmethods.isExist = function(val){\n\t\t\t\t\treturn gantt.$data.assignmentsStore.exists(val);\n\t\t\t\t};\n\t\t\t}\n\t\t\tif (methods.isExist.call(gantt, id)) {\n\t\t\t\tmethods.delete.call(gantt, id);\n\t\t\t}\n\t\t});\n\n\t\tthis.handleResourceCRUD(dp, gantt);\n\t\tthis.handleResourceAssignmentCRUD(dp, gantt);\n\t\tthis.handleBaselineCRUD(dp, gantt);\n\t}\n\n\tclientSideDelete(id, dp, gantt){\n\t\tconst updated = dp.updatedRows.slice();\n\t\tlet clientOnly = false;\n\n\t\tif(gantt.getUserData(id, \"!nativeeditor_status\", dp._ganttMode) === \"true_deleted\"){\n\t\t\tclientOnly = true;\n\t\t\tdp.setUpdated(id,false);\n\t\t}\n\n\t\tfor (let i = 0; i < updated.length && !dp._in_progress[id]; i++) {\n\t\t\tif (updated[i] === id) {\n\t\t\t\tif (gantt.getUserData(id, \"!nativeeditor_status\", dp._ganttMode) === \"inserted\") {\n\t\t\t\t\tclientOnly = true;\n\t\t\t\t}\n\t\t\t\tdp.setUpdated(id,false);\n\t\t\t}\n\t\t}\n\t\treturn clientOnly;\n\t}\n\n\thandleResourceAssignmentCRUD(dp, gantt){\n\t\tif(!gantt.config.resources || gantt.config.resources.dataprocessor_assignments !== true){\n\t\t\treturn;\n\t\t}\n\n\t\tconst assignmentsStore = gantt.getDatastore(gantt.config.resource_assignment_store);\n\t\tconst insertedTasks = {};\n\t\tconst pendingAssignments = {};\n\n\t\tgantt.attachEvent(\"onBeforeTaskAdd\", function(id, task){\n\t\t\tinsertedTasks[id] = true;\n\t\t\treturn true;\n\t\t});\n\n\t\tfunction putAssignmentToQueue(item){\n\t\t\tpendingAssignments[item.id] = item;\n\t\t\tinsertedTasks[item.task_id] = true;\n\t\t}\n\n\t\tfunction insertResourceAssignment(assignment){\n\t\t\tconst id = assignment.id;\n\t\t\tif (assignmentsStore.exists(id)) {\n\t\t\t\tdp.setGanttMode(\"assignment\");\n\t\t\t\tdp.setUpdated(id, true,\"inserted\");\n\t\t\t}\n\t\t\tdelete pendingAssignments[id];\n\t\t}\n\n\t\tgantt.attachEvent(\"onTaskIdChange\", function(id, newId){\n\t\t\tdelete insertedTasks[id];\n\t\t});\n\n\t\tassignmentsStore.attachEvent(\"onAfterAdd\", (id, item) => {\n\t\t\tif(insertedTasks[item.task_id]){\n\t\t\t\t// inserting assignment of new task\n\t\t\t\t// task is not saved yet, need to wait till it gets permanent id and save assigmnents after that\n\t\t\t\tputAssignmentToQueue(item);\n\t\t\t}else{\n\t\t\t\tinsertResourceAssignment(item);\n\t\t\t}\n\t\t});\n\n\t\tassignmentsStore.attachEvent(\"onAfterUpdate\", (id, item) => {\n\t\t\tif (assignmentsStore.exists(id)) {\n\t\t\t\tif(pendingAssignments[id]){\n\t\t\t\t\tinsertResourceAssignment(item);\n\t\t\t\t}else{\n\t\t\t\t\tdp.setGanttMode(\"assignment\");\n\t\t\t\t\tdp.setUpdated(id, true);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tassignmentsStore.attachEvent(\"onAfterDelete\", (id, item) => {\n\t\t\tdp.setGanttMode(\"assignment\");\n\n\t\t\tconst needDbDelete = !this.clientSideDelete(id, dp, gantt);\n\t\t\tif (!needDbDelete) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tdp.storeItem(item);\n\t\t\tdp.setUpdated(id, true,\"deleted\");\n\t\t});\n\n\t}\n\n\thandleResourceCRUD(dp, gantt){\n\t\tif(!gantt.config.resources || gantt.config.resources.dataprocessor_resources !== true){\n\t\t\treturn;\n\t\t}\n\n\t\tconst resourcesStore = gantt.getDatastore(gantt.config.resource_store);\n\n\t\tfunction insertResource(resource){\n\t\t\tconst id = resource.id;\n\t\t\tif (resourcesStore.exists(id)) {\n\t\t\t\tdp.setGanttMode(\"resource\");\n\t\t\t\tdp.setUpdated(id, true,\"inserted\");\n\t\t\t}\n\t\t}\n\n\t\tresourcesStore.attachEvent(\"onAfterAdd\", (id, item) => {\n\t\t\tinsertResource(item);\n\t\t});\n\n\t\tresourcesStore.attachEvent(\"onAfterUpdate\", (id, item) => {\n\t\t\tif (resourcesStore.exists(id)) {\n\t\t\t\tdp.setGanttMode(\"resource\");\n\t\t\t\tdp.setUpdated(id, true);\n\t\t\t}\n\t\t});\n\n\t\tresourcesStore.attachEvent(\"onAfterDelete\", (id, item) => {\n\t\t\tdp.setGanttMode(\"resource\");\n\n\t\t\tconst needDbDelete = !this.clientSideDelete(id, dp, gantt);\n\t\t\tif (!needDbDelete) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tdp.storeItem(item);\n\t\t\tdp.setUpdated(id, true,\"deleted\");\n\t\t});\n\n\t}\n\n\thandleBaselineCRUD(dp, gantt){\n\t\tif(!gantt.config.baselines || gantt.config.baselines.dataprocessor_baselines !== true){\n\t\t\treturn;\n\t\t}\n\n\t\tconst baselineStore = gantt.getDatastore(gantt.config.baselines.datastore);\n\n\t\tfunction insertResource(resource){\n\t\t\tconst id = resource.id;\n\t\t\tif (baselineStore.exists(id)) {\n\t\t\t\tdp.setGanttMode(\"baseline\");\n\t\t\t\tdp.setUpdated(id, true,\"inserted\");\n\t\t\t}\n\t\t}\n\n\t\tbaselineStore.attachEvent(\"onAfterAdd\", (id, item) => {\n\t\t\tinsertResource(item);\n\t\t});\n\n\t\tbaselineStore.attachEvent(\"onAfterUpdate\", (id, item) => {\n\t\t\tif (baselineStore.exists(id)) {\n\t\t\t\tdp.setGanttMode(\"baseline\");\n\t\t\t\tdp.setUpdated(id, true);\n\t\t\t}\n\t\t});\n\n\t\tbaselineStore.attachEvent(\"onAfterDelete\", (id, item) => {\n\t\t\tdp.setGanttMode(\"baseline\");\n\n\t\t\tconst needDbDelete = !this.clientSideDelete(id, dp, gantt);\n\t\t\tif (!needDbDelete) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tdp.storeItem(item);\n\t\t\tdp.setUpdated(id, true,\"deleted\");\n\t\t});\n\t}\n\n\tdetach() {\n\t\thelpers.forEach(this._dataProcessorHandlers, (e) => {\n\t\t\tthis.$gantt.detachEvent(e);\n\t\t});\n\t\tthis._dataProcessorHandlers = [];\n\t}\n}\n","import * as utils from \"../../utils/utils\";\n\nexport default class SimpleStorage {\n\tpublic static create = () : SimpleStorage => {\n\t\treturn new SimpleStorage();\n\t};\n\n\tprotected _storage: { [id: string]: any; };\n\n\tprotected constructor() {\n\t\tthis._storage = {};\n\t}\n\n\tpublic clear = (): void => {\n\t\tthis._storage = {};\n\t};\n\n\tpublic storeItem = (item: any): void => {\n\t\tthis._storage[item.id] = utils.copy(item);\n\t};\n\n\tpublic getStoredItem = (id: string): any => {\n\t\treturn this._storage[id] || null;\n\t};\n}","import eventable from \"../../utils/eventable\";\nimport * as helpers from \"../../utils/helpers\";\nimport * as utils from \"../../utils/utils\";\nimport DataProcessorEvents from \"./data_processor_events\";\nimport extendGantt from \"./extend_gantt\";\nimport SimpleStorage from \"./simple_storage\";\nimport global from \"../../utils/global\";\n\nexport interface DataProcessor { // tslint:disable-line\n\t$gantt: any;\n\tdetachAllEvents: any;\n\tattachEvent: any;\n\tcallEvent: any;\n\n\tserverProcessor: string;\n\taction_param: string;\n\tupdatedRows: any[];\n\tautoUpdate: boolean;\n\tupdateMode: string;\n\tmessages: any[];\n\tstyles: object;\n\tdnd: any;\n\tdeleteAfterConfirmation?: any;\n}\n\nexport function createDataProcessor(config: any) {\n\tlet router;\n\tlet tMode;\n\tlet headers;\n\tif (config instanceof Function) {\n\t\trouter = config;\n\t} else if (config.hasOwnProperty(\"router\")) {\n\t\trouter = config.router;\n\t} else if (config.hasOwnProperty(\"assignment\") || config.hasOwnProperty(\"baseline\") || config.hasOwnProperty(\"link\") || config.hasOwnProperty(\"task\")) {\n\t\trouter = config;\n\t} else if(config.hasOwnProperty(\"headers\")){\n\t\t// GS-2312 for custom headers\n\t\theaders = config.headers;\n\t}\n\tif (router) {\n\t\ttMode = \"CUSTOM\";\n\t} else {\n\t\ttMode = config.mode || \"REST-JSON\";\n\t}\n\tconst gantt = this; // tslint:disable-line\n\tconst dp = new DataProcessor(config.url);\n\n\n\tdp.init(gantt);\n\tdp.setTransactionMode({\n\t\tmode: tMode,\n\t\trouter,\n\t\theaders\n\t}, config.batchUpdate);\n\tif(config.deleteAfterConfirmation){\n\t\tdp.deleteAfterConfirmation = config.deleteAfterConfirmation;\n\t}\n\treturn dp;\n}\n\nexport class DataProcessor {\n\tpublic modes: object;\n\tpublic serverProcessor: string;\n\tpublic action_param: string; // tslint:disable-line\n\tpublic updatedRows: any[];\n\tpublic autoUpdate: boolean;\n\tpublic updateMode: string;\n\tpublic messages: any[];\n\tpublic styles: object;\n\tpublic dnd: any;\n\n\tprotected _tMode: string;\n\tprotected _headers: any;\n\tprotected _payload: any;\n\tprotected _postDelim: string;\n\tprotected _waitMode: number;\n\tprotected _in_progress: object; // tslint:disable-line\n\tprotected _invalid: object;\n\tprotected _storage: SimpleStorage;\n\tprotected _tSend: boolean;\n\tprotected _serializeAsJson: boolean;\n\tprotected _router: any;\n\tprotected _utf: boolean;\n\tprotected _methods: any[];\n\tprotected _user: any;\n\tprotected _uActions: object;\n\tprotected _needUpdate: boolean;\n\tprotected _ganttMode: \"task\"|\"link\";\n\tprotected _routerParametersFormat: \"parameters\"|\"object\";\n\n\tprotected _silent_mode: any; // tslint:disable-line\n\tprotected _updateBusy: any;\n\tprotected _serverProcessor: any;\n\tprotected _initialized: boolean;\n\n\tconstructor(serverProcessorURL?) {\n\t\tthis.serverProcessor = serverProcessorURL;\n\t\tthis.action_param = \"!nativeeditor_status\";\n\n\t\tthis.updatedRows = []; // ids of updated rows\n\n\t\tthis.autoUpdate = true;\n\t\tthis.updateMode = \"cell\";\n\t\tthis._headers = null;\n\t\tthis._payload = null;\n\t\tthis._postDelim = \"_\";\n\t\tthis._routerParametersFormat = \"parameters\";\n\n\t\tthis._waitMode = 0;\n\t\tthis._in_progress = {}; // ?\n\t\tthis._storage = SimpleStorage.create();\n\t\tthis._invalid = {};\n\t\tthis.messages = [];\n\n\t\tthis.styles = {\n\t\t\tupdated: \"font-weight:bold;\",\n\t\t\tinserted: \"font-weight:bold;\",\n\t\t\tdeleted: \"text-decoration : line-through;\",\n\t\t\tinvalid: \"background-color:FFE0E0;\",\n\t\t\tinvalid_cell: \"border-bottom:2px solid red;\",\n\t\t\terror: \"color:red;\",\n\t\t\tclear: \"font-weight:normal;text-decoration:none;\"\n\t\t};\n\t\tthis.enableUTFencoding(true);\n\t\teventable(this);\n\t}\n\n\tsetTransactionMode(mode:any, total?:any) {\n\t\tif (typeof mode === \"object\") {\n\t\t\tthis._tMode = mode.mode || this._tMode;\n\n\t\t\tif (utils.defined(mode.headers)) {\n\t\t\t\tthis._headers = mode.headers;\n\t\t\t}\n\n\t\t\tif (utils.defined(mode.payload)) {\n\t\t\t\tthis._payload = mode.payload;\n\t\t\t}\n\t\t\tthis._tSend = !!total;\n\t\t} else {\n\t\t\tthis._tMode = mode;\n\t\t\tthis._tSend = total;\n\t\t}\n\n\t\tif (this._tMode === \"REST\") {\n\t\t\tthis._tSend = false;\n\t\t}\n\n\t\tif (this._tMode === \"JSON\" || this._tMode === \"REST-JSON\") {\n\t\t\tthis._tSend = false;\n\t\t\tthis._serializeAsJson = true;\n\t\t\tthis._headers = this._headers || {};\n\t\t\tthis._headers[\"Content-Type\"] = \"application/json\";\n\t\t}else{\n\t\t\tif(this._headers && !this._headers[\"Content-Type\"]){\n\t\t\t\tthis._headers[\"Content-Type\"] = \"application/x-www-form-urlencoded\";\n\t\t\t}\n\t\t}\n\n\t\tif (this._tMode === \"CUSTOM\") {\n\t\t\tthis._tSend = false;\n\t\t\tthis._router = mode.router;\n\t\t}\n\t}\n\n\tescape(data:any) {\n\t\tif (this._utf) {\n\t\t\treturn encodeURIComponent(data);\n\t\t} else {\n\t\t\treturn escape(data);\n\t\t}\n\t}\n\n\t/**\n\t * @desc: allows to set escaping mode\n\t * @param: true - utf based escaping, simple - use current page encoding\n\t * @type: public\n\t */\n\tenableUTFencoding(mode:boolean) {\n\t\tthis._utf = !!mode;\n\t}\n\n\t/**\n\t * @desc: get state of updating\n\t * @returns:   true - all in sync with server, false - some items not updated yet.\n\t * @type: public\n\t */\n\tgetSyncState() {\n\t\treturn !this.updatedRows.length;\n\t}\n\n\t/**\n\t * @desc: set if rows should be send to server automatically\n\t * @param: mode - \"row\" - based on row selection changed, \"cell\" - based on cell editing finished, \"off\" - manual data sending\n\t * @type: public\n\t */\n\tsetUpdateMode(mode: string, dnd: any) {\n\t\tthis.autoUpdate = (mode === \"cell\");\n\t\tthis.updateMode = mode;\n\t\tthis.dnd = dnd;\n\t}\n\n\tignore(code: any, master: any) {\n\t\tthis._silent_mode = true;\n\t\tcode.call(master || global);\n\t\tthis._silent_mode = false;\n\t}\n\n\t/**\n\t * @desc: mark row as updated/normal. check mandatory fields, initiate autoupdate (if turned on)\n\t * @param: rowId - id of row to set update-status for\n\t * @param: state - true for \"updated\", false for \"not updated\"\n\t * @param: mode - update mode name\n\t * @type: public\n\t */\n\tsetUpdated(rowId:number|string, state: boolean, mode?: string) {\n\t\tif (this._silent_mode) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst ind = this.findRow(rowId);\n\n\t\tmode = mode || \"updated\";\n\t\tconst existing = this.$gantt.getUserData(rowId, this.action_param, this._ganttMode);\n\t\tif (existing && mode === \"updated\") {\n\t\t\tmode = existing;\n\t\t}\n\t\tif (state) {\n\t\t\tthis.set_invalid(rowId, false); // clear previous error flag\n\t\t\tthis.updatedRows[ind] = rowId;\n\t\t\tthis.$gantt.setUserData(rowId, this.action_param, mode, this._ganttMode);\n\t\t\tif (this._in_progress[rowId]) {\n\t\t\t\tthis._in_progress[rowId] = \"wait\";\n\t\t\t}\n\t\t} else {\n\t\t\tif (!this.is_invalid(rowId)) {\n\t\t\t\tthis.updatedRows.splice(ind, 1);\n\t\t\t\tthis.$gantt.setUserData(rowId, this.action_param, \"\", this._ganttMode);\n\t\t\t}\n\t\t}\n\n\t\tthis.markRow(rowId, state, mode);\n\t\tif (state && this.autoUpdate) {\n\t\t\tthis.sendData(rowId);\n\t\t}\n\t}\n\n\tmarkRow(id: number | string, state: boolean, mode: string) {\n\t\tlet str = \"\";\n\t\tconst invalid = this.is_invalid(id);\n\t\tif (invalid) {\n\t\t\tstr = this.styles[invalid];\n\t\t\tstate = true;\n\t\t}\n\t\tif (this.callEvent(\"onRowMark\", [id, state, mode, invalid])) {\n\t\t\t// default logic\n\t\t\tstr = this.styles[state ? mode : \"clear\"] + \" \" + str;\n\n\t\t\tthis.$gantt[this._methods[0]](id, str);\n\n\t\t\tif (invalid && invalid.details) {\n\t\t\t\tstr += this.styles[invalid + \"_cell\"];\n\t\t\t\tfor (let i = 0; i < invalid.details.length; i++) {\n\t\t\t\t\tif (invalid.details[i]) {\n\t\t\t\t\t\tthis.$gantt[this._methods[1]](id, i, str);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tgetActionByState(state: string):string {\n\t\tif (state === \"inserted\") {\n\t\t\treturn \"create\";\n\t\t}\n\n\t\tif (state === \"updated\") {\n\t\t\treturn \"update\";\n\t\t}\n\n\t\tif (state === \"deleted\") {\n\t\t\treturn \"delete\";\n\t\t}\n\n\t\t// reorder\n\t\treturn \"update\";\n\t}\n\n\tgetState(id: number | string) {\n\t\treturn this.$gantt.getUserData(id, this.action_param, this._ganttMode);\n\t}\n\n\tis_invalid(id: number | string) {\n\t\treturn this._invalid[id];\n\t}\n\n\tset_invalid(id: number | string, mode: any, details?) {\n\t\tif (details) {\n\t\t\tmode = {\n\t\t\t\tvalue: mode,\n\t\t\t\tdetails,\n\t\t\t\ttoString: function() { // tslint:disable-line\n\t\t\t\t\treturn this.value.toString();\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t\tthis._invalid[id] = mode;\n\t}\n\n\t/**\n\t * @desc: check mandatory fields and verify values of cells, initiate update (if specified). Can be redefined in order to provide custom validation\n\t * @param: rowId - id of row to set update-status for\n\t * @type: public\n\t */\n\t// tslint:disable-next-line\n\tcheckBeforeUpdate(rowId: number | string) {\n\t\treturn true;\n\t}\n\n\t/**\n\t * @desc: send row(s) values to server\n\t * @param: rowId - id of row which data to send. If not specified, then all \"updated\" rows will be send\n\t * @type: public\n\t */\n\tsendData(rowId?: any) {\n\t\tif (this.$gantt.editStop) {\n\t\t\tthis.$gantt.editStop();\n\t\t}\n\n\t\tif (typeof rowId === \"undefined\" || this._tSend) {\n\n\t\t\tconst pendingUpdateModes = [];\n\t\t\tif(this.modes){\n\t\t\t\tconst knownModes = [\"task\", \"link\", \"assignment\", \"baseline\"];\n\t\t\t\tknownModes.forEach((mode) => {\n\t\t\t\t\tif(this.modes[mode] && this.modes[mode].updatedRows.length){\n\t\t\t\t\t\tpendingUpdateModes.push(mode);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (pendingUpdateModes.length){\n\t\t\t\tfor(let i = 0; i < pendingUpdateModes.length; i++){\n\t\t\t\t\tthis.setGanttMode(pendingUpdateModes[i]);\n\t\t\t\t\tthis.sendAllData();\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t} else {\n\t\t\t\treturn this.sendAllData();\n\t\t\t}\n\t\t}\n\t\tif (this._in_progress[rowId]) {\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.messages = [];\n\t\tif (!this.checkBeforeUpdate(rowId) && this.callEvent(\"onValidationError\", [rowId, this.messages])) {\n\t\t\treturn false;\n\t\t}\n\t\tthis._beforeSendData(this._getRowData(rowId), rowId);\n\t}\n\n\tserialize(data: any, id: any) {\n\t\tif (this._serializeAsJson) {\n\t\t\treturn  this._serializeAsJSON(data);\n\t\t}\n\n\t\tif (typeof data === \"string\") {\n\t\t\treturn data;\n\t\t}\n\t\tif (typeof id !== \"undefined\") {\n\t\t\treturn this.serialize_one(data, \"\");\n\t\t} else {\n\t\t\tconst stack = [];\n\t\t\tconst keys = [];\n\t\t\tfor (const key in data) {\n\t\t\t\tif (data.hasOwnProperty(key)) {\n\t\t\t\t\tstack.push(this.serialize_one(data[key], key + this._postDelim));\n\t\t\t\t\tkeys.push(key);\n\t\t\t\t}\n\t\t\t}\n\t\t\tstack.push(\"ids=\" + this.escape(keys.join(\",\")));\n\t\t\tif (this.$gantt.security_key) {\n\t\t\t\tstack.push(\"dhx_security=\" + this.$gantt.security_key);\n\t\t\t}\n\t\t\treturn stack.join(\"&\");\n\t\t}\n\t}\n\n\tserialize_one(data: any, pref: string) {\n\t\tif (typeof data === \"string\") {\n\t\t\treturn data;\n\t\t}\n\t\tconst stack: string[] = [];\n\t\tlet serialized = \"\";\n\t\tfor (const key in data)\n\t\t\tif (data.hasOwnProperty(key)) {\n\t\t\t\tif ((key === \"id\" ||\n\t\t\t\t\tkey == this.action_param) && // tslint:disable-line\n\t\t\t\t\tthis._tMode === \"REST\") {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif (typeof data[key] === \"string\" || typeof data[key] === \"number\") {\n\t\t\t\t\tserialized = String(data[key]);\n\t\t\t\t} else {\n\t\t\t\t\tserialized = JSON.stringify(data[key]);\n\t\t\t\t}\n\t\t\t\tstack.push(this.escape((pref || \"\") + key) + \"=\" + this.escape(serialized));\n\t\t\t}\n\t\treturn stack.join(\"&\");\n\t}\n\n\tsendAllData() {\n\t\tif (!this.updatedRows.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.messages = [];\n\t\tlet valid: any = true;\n\n\t\tthis._forEachUpdatedRow(function(rowId) {\n\t\t\tvalid = valid && this.checkBeforeUpdate(rowId);\n\t\t});\n\n\t\tif (!valid && !this.callEvent(\"onValidationError\", [\"\", this.messages])) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (this._tSend) {\n\t\t\tthis._sendData(this._getAllData());\n\t\t} else {\n\t\t\t// this.updatedRows can be spliced from onBeforeUpdate via dp.setUpdated false\n\t\t\t// use an iterator instead of for(var i = 0; i < this.updatedRows; i++) then\n\t\t\tthis._forEachUpdatedRow(function(rowId) {\n\t\t\t\tif (!this._in_progress[rowId]) {\n\t\t\t\t\tif (this.is_invalid(rowId)) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tthis._beforeSendData(this._getRowData(rowId), rowId);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tfindRow(pattern: any) {\n\t\tlet i = 0;\n\t\tfor (i = 0; i < this.updatedRows.length; i++) {\n\t\t\tif (pattern == this.updatedRows[i]) { // tslint:disable-line\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn i;\n\t}\n\n\t/**\n\t * @desc: define custom actions\n\t * @param: name - name of action, same as value of action attribute\n\t * @param: handler - custom function, which receives a XMl response content for action\n\t * @type: private\n\t */\n\tdefineAction(name: string, handler: any) {\n\t\tif (!this._uActions) {\n\t\t\tthis._uActions = {};\n\t\t}\n\t\tthis._uActions[name] = handler;\n\t}\n\n\t/**\n\t * @desc: used in combination with setOnBeforeUpdateHandler to create custom client-server transport system\n\t * @param: sid - id of item before update\n\t * @param: tid - id of item after up0ate\n\t * @param: action - action name\n\t * @type: public\n\t * @topic: 0\n\t */\n\tafterUpdateCallback(sid: number | string, tid: number | string, action: string, btag: any, ganttMode: string) {\n\t\tif(!this.$gantt){\n\t\t\t// destructor has been called before the callback\n\t\t\treturn;\n\t\t}\n\n\t\tthis.setGanttMode(ganttMode);\n\n\t\tconst marker = sid;\n\t\tconst correct = (action !== \"error\" && action !== \"invalid\");\n\t\tif (!correct) {\n\t\t\tthis.set_invalid(sid, action);\n\t\t}\n\t\tif ((this._uActions) && (this._uActions[action]) && (!this._uActions[action](btag))) {\n\t\t\treturn (delete this._in_progress[marker]);\n\t\t}\n\n\t\tif (this._in_progress[marker] !== \"wait\") {\n\t\t\tthis.setUpdated(sid, false);\n\t\t}\n\n\t\tconst originalSid = sid;\n\n\t\tswitch (action) {\n\t\t\tcase \"inserted\":\n\t\t\tcase \"insert\":\n\t\t\t\tif (tid != sid) { // tslint:disable-line\n\t\t\t\t\tthis.setUpdated(sid, false);\n\t\t\t\t\tthis.$gantt[this._methods[2]](sid, tid);\n\t\t\t\t\tsid = tid;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase \"delete\":\n\t\t\tcase \"deleted\":\n\t\t\t\tif(!this.deleteAfterConfirmation || this._ganttMode !== \"task\"){\n\t\t\t\t\tthis.$gantt.setUserData(sid, this.action_param, \"true_deleted\", this._ganttMode);\n\t\t\t\t\tthis.$gantt[this._methods[3]](sid);\n\t\t\t\t\tdelete this._in_progress[marker];\n\t\t\t\t\treturn this.callEvent(\"onAfterUpdate\", [sid, action, tid, btag]);\n\t\t\t\t}else{\n\t\t\t\t\tif (this._ganttMode === \"task\" && this.$gantt.isTaskExists(sid)) {\n\t\t\t\t\t\tthis.$gantt.setUserData(sid, this.action_param, \"true_deleted\", this._ganttMode);\n\t\t\t\t\t\tconst task = this.$gantt.getTask(sid);\n\t\t\t\t\t\tthis.$gantt.silent(() => {\n\t\t\t\t\t\t\tthis.$gantt.deleteTask(sid);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis.$gantt.callEvent(\"onAfterTaskDelete\", [sid, task]);\n\t\t\t\t\t\tthis.$gantt.render();\n\t\t\t\t\t\tdelete this._in_progress[marker];\n\t\t\t\t\t}\n\t\t\t\t\treturn this.callEvent(\"onAfterUpdate\", [sid, action, tid, btag]);\n\t\t\t\t}\n\n\t\t}\n\n\t\tif (this._in_progress[marker] !== \"wait\") {\n\t\t\tif (correct) {\n\t\t\t\tthis.$gantt.setUserData(sid, this.action_param, \"\", this._ganttMode);\n\t\t\t}\n\t\t\tdelete this._in_progress[marker];\n\t\t} else {\n\t\t\tdelete this._in_progress[marker];\n\t\t\tthis.setUpdated(tid, true, this.$gantt.getUserData(sid, this.action_param, this._ganttMode));\n\t\t}\n\n\t\tthis.callEvent(\"onAfterUpdate\", [originalSid, action, tid, btag]);\n\t}\n\n\t/**\n\t * @desc: response from server\n\t * @param: xml - XMLLoader object with response XML\n\t * @type: private\n\t */\n\tafterUpdate(that: any, xml: any, id?:any) {\n\t\tlet _xml;\n\t\tif (arguments.length === 3) {\n\t\t\t_xml = arguments[1];\n\t\t} else {\n\t\t\t// old dataprocessor\n\t\t\t_xml = arguments[4];\n\t\t}\n\t\tlet mode = this.getGanttMode();\n\t\tconst reqUrl = _xml.filePath || _xml.url;\n\n\t\tif (this._tMode !== \"REST\" && this._tMode !== \"REST-JSON\") {\n\t\t\tif (reqUrl.indexOf(\"gantt_mode=links\") !== -1) {\n\t\t\t\tmode = \"link\";\n\t\t\t} else if (reqUrl.indexOf(\"gantt_mode=assignments\") !== -1) {\n\t\t\t\tmode = \"assignment\";\n\t\t\t} else if (reqUrl.indexOf(\"gantt_mode=baselines\") !== -1) {\n\t\t\t\tmode = \"baseline\";\n\t\t\t} else {\n\t\t\t\tmode = \"task\";\n\t\t\t}\n\t\t} else {\n\t\t\tif (reqUrl.indexOf(\"/link\") >= 0) {\n\t\t\t\tmode = \"link\";\n\t\t\t} else if(reqUrl.indexOf(\"/assignment\") >= 0){\n\t\t\t\tmode = \"assignment\";\n\t\t\t} else if(reqUrl.indexOf(\"/baseline\") >= 0){\n\t\t\t\tmode = \"baseline\";\n\t\t\t} else {\n\t\t\t\tmode = \"task\";\n\t\t\t}\n\t\t}\n\t\tthis.setGanttMode(mode);\n\n\t\tconst ajax = this.$gantt.ajax;\n\t\t// try to use json first\n\t\tlet tag;\n\n\t\ttry {\n\t\t\ttag = JSON.parse(xml.xmlDoc.responseText);\n\t\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\n\t\t} catch (e) {\n\n\t\t\t// empty response also can be processed by json handler\n\t\t\tif (!xml.xmlDoc.responseText.length) {\n\t\t\t\ttag = {};\n\t\t\t}\n\t\t}\n\n\t\tconst processCallback = (itemId: any) => {\n\t\t\tconst action = tag.action || this.getState(itemId) || \"updated\";\n\t\t\tconst sid = tag.sid || itemId[0];\n\t\t\tconst tid = tag.tid || itemId[0];\n\t\t\tthat.afterUpdateCallback(sid, tid, action, tag, mode);\n\t\t};\n\t\tif (tag) {\n\t\t\t// GS-753. When multiple tasks are updated, unhighlight all of them\n\t\t\tif (Array.isArray(id) && id.length > 1) {\n\t\t\t\tid.forEach((taskId) => processCallback(taskId));\n\t\t\t} else {\n\t\t\t\tprocessCallback(id);\n\t\t\t}\n\t\t\tthat.finalizeUpdate();\n\t\t\tthis.setGanttMode(mode);\n\t\t\treturn;\n\t\t}\n\n\t\t// xml response\n\t\tconst top = ajax.xmltop(\"data\", xml.xmlDoc); // fix incorrect content type in IE\n\t\tif (!top) {\n\t\t\treturn this.cleanUpdate(id);\n\t\t}\n\t\tconst atag = ajax.xpath(\"//data/action\", top);\n\t\tif (!atag.length) {\n\t\t\treturn this.cleanUpdate(id);\n\t\t}\n\n\t\tfor (let i = 0; i < atag.length; i++) {\n\t\t\tconst btag = atag[i];\n\t\t\tconst action = btag.getAttribute(\"type\");\n\t\t\tconst sid = btag.getAttribute(\"sid\");\n\t\t\tconst tid = btag.getAttribute(\"tid\");\n\n\t\t\tthat.afterUpdateCallback(sid, tid, action, btag, mode);\n\t\t}\n\t\tthat.finalizeUpdate();\n\t}\n\n\tcleanUpdate(id: any[]) {\n\t\tif (id) {\n\t\t\tfor (let i = 0; i < id.length; i++) {\n\t\t\t\tdelete this._in_progress[id[i]];\n\t\t\t}\n\t\t}\n\t}\n\n\tfinalizeUpdate() {\n\t\tif (this._waitMode) {\n\t\t\tthis._waitMode--;\n\t\t}\n\n\t\tthis.callEvent(\"onAfterUpdateFinish\", []);\n\t\tif (!this.updatedRows.length) {\n\t\t\tthis.callEvent(\"onFullSync\", []);\n\t\t}\n\t}\n\n\t/**\n\t * @desc: initializes data-processor\n\t * @param: gantt - dhtmlxGantt object to attach this data-processor to\n\t * @type: public\n\t */\n\tinit(gantt: any) {\n\t\tif (this._initialized) {\n\t\t\treturn;\n\t\t}\n\t\tthis.$gantt = gantt;\n\t\tif (this.$gantt._dp_init) {\n\t\t\tthis.$gantt._dp_init(this);\n\t\t}\n\n\t\tthis._setDefaultTransactionMode();\n\n\t\tthis.styles = {\n\t\t\tupdated:\"gantt_updated\",\n\t\t\torder:\"gantt_updated\",\n\t\t\tinserted:\"gantt_inserted\",\n\t\t\tdeleted:\"gantt_deleted\",\n\t\t\tdelete_confirmation:\"gantt_deleted\",\n\t\t\tinvalid:\"gantt_invalid\",\n\t\t\terror:\"gantt_error\",\n\t\t\tclear:\"\"\n\t\t};\n\n\t\tthis._methods=[\"_row_style\",\"setCellTextStyle\",\"_change_id\",\"_delete_task\"];\n\t\textendGantt(this.$gantt, this);\n\t\tconst dataProcessorEvents = new DataProcessorEvents(this.$gantt, this);\n\t\tdataProcessorEvents.attach();\n\t\tthis.attachEvent(\"onDestroy\", function() {\n\t\t\tdelete this.setGanttMode;\n\t\t\tdelete this._getRowData;\n\n\t\t\tdelete this.$gantt._dp;\n\t\t\tdelete this.$gantt._change_id;\n\t\t\tdelete this.$gantt._row_style;\n\t\t\tdelete this.$gantt._delete_task;\n\t\t\tdelete this.$gantt._sendTaskOrder;\n\t\t\tdelete this.$gantt;\n\n\t\t\tdataProcessorEvents.detach();\n\t\t});\n\t\tthis.$gantt.callEvent(\"onDataProcessorReady\", [this]);\n\t\tthis._initialized = true;\n\t}\n\n\tsetOnAfterUpdate(handler) {\n\t\tthis.attachEvent(\"onAfterUpdate\", handler);\n\t}\n\n\tsetOnBeforeUpdateHandler(handler) {\n\t\tthis.attachEvent(\"onBeforeDataSending\", handler);\n\t}\n\n\t/* starts autoupdate mode\n\t\t@param interval time interval for sending update requests\n\t*/\n\tsetAutoUpdate(interval, user) {\n\t\tinterval = interval || 2000;\n\n\t\tthis._user = user || (new Date()).valueOf();\n\t\tthis._needUpdate = false;\n\n\t\tthis._updateBusy = false;\n\n\t\tthis.attachEvent(\"onAfterUpdate\", this.afterAutoUpdate); // arguments sid, action, tid, xml_node;\n\n\t\tthis.attachEvent(\"onFullSync\", this.fullSync);\n\n\t\tsetInterval(() => {\n\t\t\tthis.loadUpdate();\n\t\t}, interval);\n\t}\n\n\t/* process updating request response\n\t\tif status == collision version is deprecated\n\t\tset flag for autoupdating immediately\n\t*/\n\tafterAutoUpdate(sid, action, tid, xml_node) { // tslint:disable-line\n\t\tif (action === \"collision\") {\n\t\t\tthis._needUpdate = true;\n\t\t\treturn false;\n\t\t} else {\n\t\t\treturn true;\n\t\t}\n\t}\n\n\t/* callback function for onFillSync event\n\t\tcall update function if it's need\n\t*/\n\tfullSync() {\n\t\tif (this._needUpdate) {\n\t\t\tthis._needUpdate = false;\n\t\t\tthis.loadUpdate();\n\t\t}\n\t\treturn true;\n\t}\n\n\t/* sends query to the server and call callback function\n\t*/\n\tgetUpdates(url, callback) {\n\t\tconst ajax = this.$gantt.ajax;\n\t\tif (this._updateBusy) {\n\t\t\treturn false;\n\t\t} else {\n\t\t\tthis._updateBusy = true;\n\t\t}\n\n\t\tajax.get(url, callback);\n\n\t}\n\n\t/* loads updates and processes them\n\t*/\n\tloadUpdate() {\n\t\tconst ajax = this.$gantt.ajax;\n\t\tconst version = this.$gantt.getUserData(0, \"version\", this._ganttMode);\n\t\tlet url = this.serverProcessor + ajax.urlSeparator(this.serverProcessor) + [\"dhx_user=\" + this._user, \"dhx_version=\" + version].join(\"&\");\n\t\turl = url.replace(\"editing=true&\", \"\");\n\t\tthis.getUpdates(url, (xml) => {\n\t\t\tconst vers = ajax.xpath(\"//userdata\", xml);\n\t\t\tthis.$gantt.setUserData(0, \"version\", this._getXmlNodeValue(vers[0]), this._ganttMode);\n\n\t\t\tconst updates = ajax.xpath(\"//update\", xml);\n\t\t\tif (updates.length) {\n\t\t\t\tthis._silent_mode = true;\n\n\t\t\t\tfor (let i = 0; i < updates.length; i++) {\n\t\t\t\t\tconst status = updates[i].getAttribute(\"status\");\n\t\t\t\t\tconst id = updates[i].getAttribute(\"id\");\n\t\t\t\t\tconst parent = updates[i].getAttribute(\"parent\");\n\t\t\t\t\tswitch (status) {\n\t\t\t\t\t\tcase \"inserted\":\n\t\t\t\t\t\t\tthis.callEvent(\"insertCallback\", [updates[i], id, parent]);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"updated\":\n\t\t\t\t\t\t\tthis.callEvent(\"updateCallback\", [updates[i], id, parent]);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"deleted\":\n\t\t\t\t\t\t\tthis.callEvent(\"deleteCallback\", [updates[i], id, parent]);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis._silent_mode = false;\n\t\t\t}\n\n\t\t\tthis._updateBusy = false;\n\t\t});\n\t}\n\n\tdestructor() {\n\t\tthis.callEvent(\"onDestroy\", []);\n\t\tthis.detachAllEvents();\n\n\t\tthis.updatedRows = [];\n\t\tthis._in_progress = {}; // ?\n\t\tthis._invalid = {};\n\t\tthis._storage.clear();\n\t\tthis._storage = null;\n\t\tthis._headers = null;\n\t\tthis._payload = null;\n\t\tdelete this._initialized;\n\t}\n\n\tsetGanttMode(mode) {\n\t\tif (mode === \"tasks\") {\n\t\t\tmode = \"task\";\n\t\t} else if (mode === \"links\") {\n\t\t\tmode = \"link\";\n\t\t}\n\n\t\tconst modes = this.modes || {};\n\t\tconst ganttMode = this.getGanttMode();\n\t\tif (ganttMode) {\n\t\t\tmodes[ganttMode] = {\n\t\t\t\t_in_progress : this._in_progress,\n\t\t\t\t_invalid: this._invalid,\n\t\t\t\t_storage: this._storage,\n\t\t\t\tupdatedRows : this.updatedRows\n\t\t\t};\n\t\t}\n\n\t\tlet newState = modes[mode];\n\t\tif (!newState) {\n\t\t\tnewState = modes[mode] = {\n\t\t\t\t_in_progress : {},\n\t\t\t\t_invalid : {},\n\t\t\t\t_storage : SimpleStorage.create(),\n\t\t\t\tupdatedRows : []\n\t\t\t};\n\t\t}\n\t\tthis._in_progress = newState._in_progress;\n\t\tthis._invalid = newState._invalid;\n\t\tthis._storage = newState._storage;\n\t\tthis.updatedRows = newState.updatedRows;\n\t\tthis.modes = modes;\n\t\tthis._ganttMode = mode;\n\t}\n\tgetGanttMode():string {\n\t\treturn this._ganttMode;\n\t}\n\n\tstoreItem(item) {\n\t\tthis._storage.storeItem(item);\n\t}\n\n\turl(url: string) {\n\t\tthis.serverProcessor = this._serverProcessor = url;\n\t}\n\n\tprotected _beforeSendData(data: any, rowId: any) {\n\t\tif (!this.callEvent(\"onBeforeUpdate\", [rowId, this.getState(rowId), data])) {\n\t\t\treturn false;\n\t\t}\n\t\tthis._sendData(data, rowId);\n\t}\n\n\tprotected _serializeAsJSON(data: any) {\n\t\tif (typeof data === \"string\") {\n\t\t\treturn data;\n\t\t}\n\n\t\tconst copy = utils.copy(data);\n\t\tif (this._tMode === \"REST-JSON\") {\n\t\t\tdelete copy.id;\n\t\t\tdelete copy[this.action_param];\n\t\t}\n\n\t\treturn JSON.stringify(copy);\n\t}\n\n\tprotected _applyPayload(url: string) {\n\t\tconst ajax = this.$gantt.ajax;\n\t\tif (this._payload) {\n\t\t\tfor (const key in this._payload) {\n\t\t\t\turl = url + ajax.urlSeparator(url) + this.escape(key) + \"=\" + this.escape(this._payload[key]);\n\t\t\t}\n\t\t}\n\t\treturn url;\n\t}\n\n\t// GET/POST/JSON modes of the dataProcessor didn't send the whole data items in 'delete' requests\n\t// clear extra info from the data in order not to change the request format\n\tprotected _cleanupArgumentsBeforeSend(dataToSend: any) {\n\t\tlet processedData;\n\t\tif(dataToSend[this.action_param] === undefined){// hash of updated items, and not an individual item\n\t\t\tprocessedData = {};\n\t\t\tfor(const i in dataToSend) {\n\t\t\t\tprocessedData[i] = this._cleanupArgumentsBeforeSend(dataToSend[i]);\n\t\t\t}\n\t\t} else {\n\t\t\tprocessedData = this._cleanupItemBeforeSend(dataToSend);\n\t\t}\n\t\treturn processedData;\n\t}\n\tprotected _cleanupItemBeforeSend(updatedItem: any) {\n\t\tlet output = null;\n\t\tif(updatedItem){\n\t\t\tif(updatedItem[this.action_param] === \"deleted\"){\n\t\t\t\toutput = {};\n\t\t\t\toutput.id = updatedItem.id;\n\t\t\t\toutput[this.action_param] = updatedItem[this.action_param];\n\t\t\t}else{\n\t\t\t\toutput = updatedItem;\n\t\t\t}\n\t\t}\n\n\t\treturn output;\n\t}\n\n\tprotected _sendData(dataToSend: any, rowId?: any) {\n\t\tif (!dataToSend) {\n\t\t\treturn; // nothing to send\n\t\t}\n\t\tif (!this.callEvent(\"onBeforeDataSending\", rowId ? [rowId, this.getState(rowId), dataToSend] : [null, null, dataToSend])) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (rowId) {\n\t\t\tthis._in_progress[rowId] = (new Date()).valueOf();\n\t\t}\n\n\t\tconst ajax = this.$gantt.ajax;\n\n\t\tif (this._tMode === \"CUSTOM\") {\n\t\t\tconst taskState = this.getState(rowId);\n\t\t\tconst taskAction = this.getActionByState(taskState);\n\t\t\tdelete dataToSend[this.action_param]; // not send !nativeeditor_status parameter in router mode\n\t\t\tconst ganttMode = this.getGanttMode();\n\t\t\tconst _onResolvedCreateUpdate = (tag) => {\n\t\t\t\tlet action = taskState || \"updated\";\n\t\t\t\tlet sid = rowId;\n\t\t\t\tlet tid = rowId;\n\n\t\t\t\tif (tag) {\n\t\t\t\t\taction = tag.action || taskState;\n\t\t\t\t\tsid = tag.sid || sid;\n\t\t\t\t\ttid = tag.id || tag.tid || tid;\n\t\t\t\t}\n\t\t\t\tthis.afterUpdateCallback(sid, tid, action, tag, ganttMode);\n\t\t\t};\n\n\t\t\tlet actionPromise;\n\t\t\tif (this._router instanceof Function) {\n\t\t\t\tif(this._routerParametersFormat === \"object\"){\n\t\t\t\t\tconst obj = {\n\t\t\t\t\t\tentity: ganttMode,\n\t\t\t\t\t\taction: taskAction,\n\t\t\t\t\t\tdata: dataToSend,\n\t\t\t\t\t\tid: rowId\n\t\t\t\t\t};\n\t\t\t\t\tactionPromise = this._router(obj);\n\t\t\t\t} else {\n\t\t\t\t\tactionPromise = this._router(ganttMode, taskAction, dataToSend, rowId);\n\t\t\t\t}\n\t\t\t} else if (this._router[ganttMode] instanceof Function) {\n\t\t\t\tactionPromise = this._router[ganttMode](taskAction, dataToSend, rowId);\n\t\t\t} else {\n\n\t\t\t\tconst errorMsgStart = \"Incorrect configuration of gantt.createDataProcessor\";\n\t\t\t\tconst errorMsgEnd = `\nYou need to either add missing properties to the dataProcessor router object or to use a router function.\nSee https://docs.dhtmlx.com/gantt/desktop__server_side.html#customrouting and https://docs.dhtmlx.com/gantt/api__gantt_createdataprocessor.html for details.`;\n\n\t\t\t\tif(!this._router[ganttMode]){\n\t\t\t\t\tthrow new Error(`${errorMsgStart}: router for the **${ganttMode}** entity is not defined. ${errorMsgEnd}`);\n\t\t\t\t}\n\t\t\t\tswitch (taskState) {\n\t\t\t\t\tcase \"inserted\":\n\t\t\t\t\t\tif(!this._router[ganttMode].create){\n\t\t\t\t\t\t\tthrow new Error(`${errorMsgStart}: **create** action for the **${ganttMode}** entity is not defined. ${errorMsgEnd}`);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tactionPromise = this._router[ganttMode].create(dataToSend);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"deleted\":\n\t\t\t\t\t\tif(!this._router[ganttMode].delete){\n\t\t\t\t\t\t\tthrow new Error(`${errorMsgStart}: **delete** action for the **${ganttMode}** entity is not defined. ${errorMsgEnd}`);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tactionPromise = this._router[ganttMode].delete(rowId);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tif(!this._router[ganttMode].update){\n\t\t\t\t\t\t\tthrow new Error(`${errorMsgStart}: **update**\" action for the **${ganttMode}** entity is not defined. ${errorMsgEnd}`);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tactionPromise = this._router[ganttMode].update(dataToSend, rowId);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(actionPromise){\n\t\t\t\t// neither promise nor {tid: newId} response object\n\t\t\t\tif(!actionPromise.then &&\n\t\t\t\t\t(actionPromise.id === undefined && actionPromise.tid === undefined && actionPromise.action === undefined)){\n\t\t\t\t\tthrow new Error(\"Incorrect router return value. A Promise or a response object is expected\");\n\t\t\t\t}\n\n\t\t\t\tif(actionPromise.then){\n\t\t\t\t\tactionPromise.then(_onResolvedCreateUpdate).catch((error) => {\n\t\t\t\t\t\tif(error && error.action){\n\t\t\t\t\t\t\t_onResolvedCreateUpdate(error);\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t_onResolvedCreateUpdate({ action: \"error\", value: error});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}else{\n\t\t\t\t\t// custom method may return a response object in case of sync action\n\t\t\t\t\t_onResolvedCreateUpdate(actionPromise);\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\t_onResolvedCreateUpdate(null);\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tlet queryParams: any;\n\t\tqueryParams = {\n\t\t\tcallback: (xml) => {\n\t\t\t\tconst ids = [];\n\n\t\t\t\tif (rowId) {\n\t\t\t\t\tids.push(rowId);\n\t\t\t\t} else if (dataToSend) {\n\t\t\t\t\tfor (const key in dataToSend) {\n\t\t\t\t\t\tids.push(key);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn this.afterUpdate(this, xml, ids);\n\t\t\t},\n\t\t\theaders: this._headers\n\t\t};\n\n\t\tconst dhxVersion = \"dhx_version=\" + this.$gantt.getUserData(0, \"version\", this._ganttMode);\n\t\tconst urlParams = this.serverProcessor + (this._user ? (ajax.urlSeparator(this.serverProcessor) + [\"dhx_user=\" + this._user, dhxVersion].join(\"&\")) : \"\");\n\t\tlet url: any = this._applyPayload(urlParams);\n\t\tlet data;\n\n\t\tswitch (this._tMode) {\n\t\t\tcase \"GET\":\n\t\t\t\tdata = this._cleanupArgumentsBeforeSend(dataToSend);\n\t\t\t\tqueryParams.url = url + ajax.urlSeparator(url) + this.serialize(data, rowId);\n\t\t\t\tqueryParams.method = \"GET\";\n\t\t\t\tbreak;\n\t\t\tcase \"POST\":\n\t\t\t\tdata = this._cleanupArgumentsBeforeSend(dataToSend);\n\t\t\t\tqueryParams.url = url;\n\t\t\t\tqueryParams.method = \"POST\";\n\t\t\t\tqueryParams.data = this.serialize(data, rowId);\n\t\t\t\tbreak;\n\t\t\tcase \"JSON\":\n\t\t\t\tdata = {};\n\t\t\t\tconst preprocessedData = this._cleanupItemBeforeSend(dataToSend);\n\t\t\t\tfor (const key in preprocessedData) {\n\t\t\t\t\tif (key === this.action_param || key === \"id\" || key === \"gr_id\") {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tdata[key] = preprocessedData[key];\n\t\t\t\t}\n\n\t\t\t\tqueryParams.url = url;\n\t\t\t\tqueryParams.method = \"POST\";\n\t\t\t\tqueryParams.data = JSON.stringify({\n\t\t\t\t\tid: rowId,\n\t\t\t\t\taction: dataToSend[this.action_param],\n\t\t\t\t\tdata\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\tcase \"REST\":\n\t\t\tcase \"REST-JSON\":\n\t\t\t\turl = urlParams.replace(/(&|\\?)editing=true/, \"\");\n\t\t\t\tdata = \"\";\n\n\t\t\t\tswitch (this.getState(rowId)) {\n\t\t\t\t\tcase \"inserted\":\n\t\t\t\t\t\tqueryParams.method = \"POST\";\n\t\t\t\t\t\tqueryParams.data = this.serialize(dataToSend, rowId);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"deleted\":\n\t\t\t\t\t\tqueryParams.method = \"DELETE\";\n\t\t\t\t\t\turl = url + (url.slice(-1) === \"/\" ? \"\" : \"/\") + rowId;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tqueryParams.method = \"PUT\";\n\t\t\t\t\t\tqueryParams.data = this.serialize(dataToSend, rowId);\n\t\t\t\t\t\turl = url + (url.slice(-1) === \"/\" ? \"\" : \"/\") + rowId;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tqueryParams.url = this._applyPayload(url);\n\t\t\t\tbreak;\n\t\t}\n\n\t\tthis._waitMode++;\n\t\treturn ajax.query(queryParams);\n\t}\n\n\tprotected _forEachUpdatedRow(code: any) {\n\t\tconst updatedRows = this.updatedRows.slice();\n\t\tfor (let i = 0; i < updatedRows.length; i++) {\n\t\t\tconst rowId = updatedRows[i];\n\t\t\tif (this.$gantt.getUserData(rowId, this.action_param, this._ganttMode)) {\n\t\t\t\tcode.call(this, rowId);\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected _setDefaultTransactionMode() {\n\t\tif (this.serverProcessor) {\n\t\t\tthis.setTransactionMode(\"POST\", true);\n\t\t\tthis.serverProcessor += (this.serverProcessor.indexOf(\"?\") !== -1 ? \"&\" : \"?\") + \"editing=true\";\n\t\t\tthis._serverProcessor = this.serverProcessor;\n\t\t}\n\t}\n\n\t/* returns xml node value\n\t\t@param node\n\t\t\txml node\n\t*/\n\tprotected _getXmlNodeValue(node) {\n\t\tif (node.firstChild) {\n\t\t\treturn node.firstChild.nodeValue;\n\t\t}\n\t\treturn \"\";\n\t}\n\n\tprotected _getAllData() {\n\t\tconst out = {};\n\t\tlet hasOne = false;\n\n\t\tthis._forEachUpdatedRow(function(id) {\n\t\t\tif (this._in_progress[id] || this.is_invalid(id)){\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst row = this._getRowData(id);\n\t\t\tif (!this.callEvent(\"onBeforeUpdate\", [id, this.getState(id), row])) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tout[id] = row;\n\t\t\thasOne = true;\n\t\t\tthis._in_progress[id] = (new Date()).valueOf();\n\t\t});\n\n\t\treturn hasOne ? out : null;\n\t}\n\n\tprotected _prepareDate(value: Date) : string {\n\t\treturn this.$gantt.defined(this.$gantt.templates.xml_format) ? this.$gantt.templates.xml_format(value) : this.$gantt.templates.format_date(value);\n\t}\n\n\tprotected _prepareArray(value: any[], traversedObjects: object[]) : any[] {\n\t\ttraversedObjects.push(value);\n\n\t\treturn value.map((item) => {\n\t\t\tif(helpers.isDate(item)){\n\t\t\t\treturn this._prepareDate(item);\n\t\t\t} else if (Array.isArray(item) && !helpers.arrayIncludes(traversedObjects, item)){\n\t\t\t\treturn this._prepareArray(item, traversedObjects);\n\t\t\t} else if (item && typeof item === \"object\" && !helpers.arrayIncludes(traversedObjects, item)) {\n\t\t\t\treturn this._prepareObject(item, traversedObjects);\n\t\t\t} else {\n\t\t\t\treturn item;\n\t\t\t}\n\t\t});\n\t}\n\n\tprotected _prepareObject(rawItem: any, traversedObjects: object[]) : any {\n\t\tconst processedItem = {};\n\t\ttraversedObjects.push(rawItem);\n\n\t\tfor (const key in rawItem) {\n\t\t\tif (key.substr(0, 1) === \"$\") {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst value = rawItem[key];\n\t\t\tif (helpers.isDate(value)) {\n\t\t\t\tprocessedItem[key] = this._prepareDate(value);\n\t\t\t} else if(value === null) {\n\t\t\t\tprocessedItem[key] = \"\";\n\t\t\t} else if (Array.isArray(value) && !helpers.arrayIncludes(traversedObjects, value)){\n\t\t\t\tprocessedItem[key] = this._prepareArray(value, traversedObjects);\n\t\t\t} else if (value && typeof value === \"object\" && !helpers.arrayIncludes(traversedObjects, value)) {\n\t\t\t\tprocessedItem[key] = this._prepareObject(value, traversedObjects);\n\t\t\t} else {\n\t\t\t\tprocessedItem[key] = value;\n\t\t\t}\n\t\t}\n\t\treturn processedItem;\n\t}\n\n\tprotected _prepareDataItem(rawItem: any): any {\n\t\tconst processedItem = this._prepareObject(rawItem, []);\n\n\t\tprocessedItem[this.action_param] = this.$gantt.getUserData(rawItem.id, this.action_param, this._ganttMode);\n\t\treturn processedItem;\n\t}\n\n\tprotected getStoredItem(id){\n\t\treturn this._storage.getStoredItem(id);\n\t}\n\n\tprotected _getRowData(id) {\n\t\tlet dataItem;\n\t\tconst gantt = this.$gantt;\n\t\tif (this.getGanttMode() === \"task\") {\n\t\t\tif(gantt.isTaskExists(id)){\n\t\t\t\tdataItem =this.$gantt.getTask(id);\n\t\t\t}\n\t\t} else if (this.getGanttMode() === \"assignment\") {\n\t\t\tif(this.$gantt.$data.assignmentsStore.exists(id)){\n\t\t\t\tdataItem =this.$gantt.$data.assignmentsStore.getItem(id);\n\t\t\t}\n\t\t} else if (this.getGanttMode() === \"baseline\") {\n\t\t\tif(this.$gantt.$data.baselineStore.exists(id)){\n\t\t\t\tdataItem =this.$gantt.$data.baselineStore.getItem(id);\n\t\t\t}\n\t\t} else {\n\t\t\tif(gantt.isLinkExists(id)){\n\t\t\t\tdataItem =this.$gantt.getLink(id);\n\t\t\t}\n\t\t}\n\n\t\tif (!dataItem) {\n\t\t\tdataItem = this.getStoredItem(id);\n\t\t}\n\n\t\tif (!dataItem) {\n\t\t\tdataItem = { id };\n\t\t}\n\n\t\treturn this._prepareDataItem(dataItem);\n\t}\n}","\nexport default function extendGantt(gantt: any, dp: any) {\n\tgantt.getUserData = function(id, name, store) {\n\t\tif (!this.userdata) {\n\t\t\tthis.userdata = {};\n\t\t}\n\t\tthis.userdata[store] = this.userdata[store] || {};\n\t\tif (this.userdata[store][id] && this.userdata[store][id][name]) {\n\t\t\treturn this.userdata[store][id][name];\n\t\t}\n\t\treturn \"\";\n\t};\n\tgantt.setUserData = function(id, name, value, store) {\n\t\tif (!this.userdata) {\n\t\t\tthis.userdata = {};\n\t\t}\n\t\tthis.userdata[store] = this.userdata[store] || {};\n\t\tthis.userdata[store][id] = this.userdata[store][id] || {};\n\t\tthis.userdata[store][id][name] = value;\n\t};\n\n\tgantt._change_id = function(oldId, newId) {\n\t\tswitch (this._dp._ganttMode) {\n\t\t\tcase \"task\":\n\t\t\t\tthis.changeTaskId(oldId, newId);\n\t\t\t\tbreak;\n\t\t\tcase \"link\":\n\t\t\t\tthis.changeLinkId(oldId, newId);\n\t\t\t\tbreak;\n\t\t\tcase \"assignment\":\n\t\t\t\tthis.$data.assignmentsStore.changeId(oldId, newId);\n\t\t\t\tbreak;\n\t\t\tcase \"resource\":\n\t\t\t\tthis.$data.resourcesStore.changeId(oldId, newId);\n\t\t\t\tbreak;\n\t\t\tcase \"baseline\":\n\t\t\t\tthis.$data.baselineStore.changeId(oldId, newId);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tthrow new Error(`Invalid mode of the dataProcessor after database id is received: ${this._dp._ganttMode}, new id: ${newId}`);\n\t\t}\n\t};\n\n\tgantt._row_style = function(rowId, classname){\n\t\tif (this._dp._ganttMode !== \"task\") {\n\t\t\treturn;\n\t\t}\n\t\tif (!gantt.isTaskExists(rowId)) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst task = gantt.getTask(rowId);\n\t\ttask.$dataprocessor_class = classname;\n\t\tgantt.refreshTask(rowId);\n\t};\n\n\t// fake method for dataprocessor\n\tgantt._delete_task = function(rowId, node) {}; // tslint:disable-line\n\n\tgantt._sendTaskOrder = function(id, item){\n\t\tif (item.$drop_target) {\n\t\t\tthis._dp.setGanttMode(\"task\");\n\t\t\tthis.getTask(id).target = item.$drop_target;\n\t\t\tthis._dp.setUpdated(id, true,\"order\");\n\t\t\tdelete this.getTask(id).$drop_target;\n\t\t}\n\t};\n\n\tgantt.setDp = function() {\n\t\tthis._dp = dp;\n\t};\n\n\tgantt.setDp();\n}","import * as DataProcessor from \"./data_processor\";\nexport default {\n\tDEPRECATED_api: function(server) {\n\t\treturn new (DataProcessor.DataProcessor)(server);\n\t},\n\tcreateDataProcessor: DataProcessor.createDataProcessor\n};","import global from \"../../utils/global\";\n\nfunction createMethod(gantt){\n\tvar methods = {};\n\tvar isActive = false;\n\tfunction disableMethod(methodName, dummyMethod){\n\t\tdummyMethod = typeof dummyMethod == \"function\" ? dummyMethod : function(){};\n\n\t\tif(!methods[methodName]){\n\t\t\tmethods[methodName] = this[methodName];\n\t\t\tthis[methodName] = dummyMethod;\n\t\t}\n\t}\n\tfunction restoreMethod(methodName){\n\t\tif(methods[methodName]){\n\t\t\tthis[methodName] = methods[methodName];\n\t\t\tmethods[methodName] = null;\n\t\t}\n\t}\n\tfunction disableMethods(methodsHash){\n\t\tfor(var i in methodsHash){\n\t\t\tdisableMethod.call(this, i, methodsHash[i]);\n\t\t}\n\t}\n\tfunction restoreMethods(){\n\t\tfor(var i in methods){\n\t\t\trestoreMethod.call(this, i);\n\t\t}\n\t}\n\n\tfunction batchUpdatePayload(callback){\n\t\ttry{\n\t\t\tcallback();\n\t\t}catch(e){\n\t\t\tglobal.console.error(e);\n\t\t}\n\t}\n\n\tvar state = gantt.$services.getService(\"state\");\n\tstate.registerProvider(\"batchUpdate\", function(){\n\t\treturn {\n\t\t\tbatch_update: isActive\n\t\t};\n\t}, false);\n\n\treturn function batchUpdate(callback, noRedraw) {\n\t\tif(isActive){\n\t\t\t// batch mode is already active\n\t\t\tbatchUpdatePayload(callback);\n\t\t\treturn;\n\t\t}\n\n\t\tvar call_dp = (this._dp && this._dp.updateMode != \"off\");\n\t\tvar dp_mode;\n\t\tif (call_dp){\n\t\t\tdp_mode = this._dp.updateMode;\n\t\t\tthis._dp.setUpdateMode(\"off\");\n\t\t}\n\n\t\t// temporary disable some methods while updating multiple tasks\n\t\tvar resetProjects = {};\n\t\tvar methods = {\n\t\t\t\"render\":true,\n\t\t\t\"refreshData\":true,\n\t\t\t\"refreshTask\":true,\n\t\t\t\"refreshLink\":true,\n\t\t\t\"resetProjectDates\":function(task){\n\t\t\t\tresetProjects[task.id] = task;\n\t\t\t}\n\t\t};\n\n\t\tdisableMethods.call(this, methods);\n\n\t\tisActive = true;\n\t\tthis.callEvent(\"onBeforeBatchUpdate\", []);\n\n\t\tbatchUpdatePayload(callback);\n\n\t\tthis.callEvent(\"onAfterBatchUpdate\", []);\n\n\t\trestoreMethods.call(this);\n\n\t\t// do required updates after changes applied\n\t\tfor(var i in resetProjects){\n\t\t\tthis.resetProjectDates(resetProjects[i]);\n\t\t}\n\n\t\tisActive = false;\n\n\t\tif(!noRedraw){\n\t\t\tthis.render();\n\t\t}\n\n\t\tif (call_dp) {\n\t\t\tthis._dp.setUpdateMode(dp_mode);\n\t\t\tthis._dp.setGanttMode(\"task\");\n\t\t\tthis._dp.sendData();\n\t\t\tthis._dp.setGanttMode(\"link\");\n\t\t\tthis._dp.sendData();\n\t\t}\n\t};\n\n\n\n}\n\nexport default function(gantt){\n\tgantt.batchUpdate = createMethod(gantt);\n};","const createWbs = (function(gantt){\n\treturn {\n\t_needRecalc: true,\n\treset: function(){\n\t\tthis._needRecalc = true;\n\t},\n\t_isRecalcNeeded: function(){\n\t\treturn (!this._isGroupSort() && this._needRecalc);\n\t},\n\t_isGroupSort: function() {\n\t\treturn !!(gantt.getState().group_mode);\n\t},\n\t_getWBSCode: function(task) {\n\t\tif(!task) return \"\";\n\n\t\tif(this._isRecalcNeeded()){\n\t\t\tthis._calcWBS();\n\t\t}\n\n\t\tif(task.$virtual) return \"\";\n\t\tif(this._isGroupSort()) return task.$wbs || \"\";\n\n\t\tif(!task.$wbs) {\n\t\t\tthis.reset();\n\t\t\tthis._calcWBS();\n\t\t}\n\t\treturn task.$wbs;\n\t},\n\t_setWBSCode: function(task, value) {\n\t\ttask.$wbs = value;\n\t},\n\tgetWBSCode: function(task) {\n\t\treturn this._getWBSCode(task);\n\t},\n\tgetByWBSCode: function(code){\n\t\tlet parts = code.split(\".\");\n\t\tlet currentNode = gantt.config.root_id;\n\t\tfor(let i = 0; i < parts.length; i++){\n\t\t\tconst children = gantt.getChildren(currentNode);\n\t\t\tlet index = parts[i]*1 - 1;\n\t\t\tif(gantt.isTaskExists(children[index])){\n\t\t\t\tcurrentNode = children[index];\n\t\t\t}else{\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t\tif(gantt.isTaskExists(currentNode)){\n\t\t\treturn gantt.getTask(currentNode);\n\t\t}else{\n\t\t\treturn null;\n\t\t}\n\t},\n\t_calcWBS: function() {\n\t\tif(!this._isRecalcNeeded()) return;\n\n\t\tlet _isFirst = true;\n\t\tgantt.eachTask(function(ch) {\n\t\t\tif(ch.type == gantt.config.types.placeholder) return;\n\t\t\tif(_isFirst) {\n\t\t\t\t_isFirst = false;\n\t\t\t\tthis._setWBSCode(ch, \"1\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst _prevSibling = this._getPrevNonPlaceholderSibling(ch.id);\n\t\t\tif (_prevSibling !== null) {\n\t\t\t\tthis._increaseWBS(ch, _prevSibling);\n\t\t\t} else {\n\t\t\t\tlet _parent = gantt.getParent(ch.id);\n\t\t\t\tthis._setWBSCode(ch, gantt.getTask(_parent).$wbs + \".1\");\n\t\t\t}\n\t\t}, gantt.config.root_id, this);\n\n\t\tthis._needRecalc = false;\n\t},\n\t_increaseWBS: function(task, siblingiId){\n\t\tlet _wbs = gantt.getTask(siblingiId).$wbs;\n\t\tif(_wbs) {\n\t\t\t_wbs = _wbs.split(\".\");\n\t\t\t_wbs[_wbs.length-1]++;\n\t\t\tthis._setWBSCode(task, _wbs.join(\".\"));\n\t\t}\n\t},\n\t_getPrevNonPlaceholderSibling: function(childId) {\n\t\tlet prevSibling;\n\t\tlet currentId = childId;\n\t\tdo {\n\t\t\tprevSibling = gantt.getPrevSibling(currentId);\n\t\t\tcurrentId = prevSibling;\n\t\t} while (prevSibling !== null && gantt.getTask(prevSibling).type == gantt.config.types.placeholder);\n\t\treturn prevSibling;\n   }\n};\n});\n\nexport default function(gantt){\n\tconst wbs = createWbs(gantt);\n\tgantt.getWBSCode = function getWBSCode(task) {\n\t\treturn wbs.getWBSCode(task);\n\t};\n\n\tgantt.getTaskByWBSCode = function(code) {\n\t\treturn wbs.getByWBSCode(code);\n\t};\n\n\tfunction resetCache(){\n\t\twbs.reset();\n\t\treturn true;\n\t}\n\n\tgantt.attachEvent(\"onAfterTaskMove\", resetCache);\n\tgantt.attachEvent(\"onBeforeParse\", resetCache);\n\tgantt.attachEvent(\"onAfterTaskDelete\", resetCache);\n\tgantt.attachEvent(\"onAfterTaskAdd\", resetCache);\n\tgantt.attachEvent(\"onAfterSort\", resetCache);\n\n};\n","import * as helpers from \"../../utils/helpers\";\nimport * as dom_helpers from \"../ui/utils/dom_helpers\";\nfunction createResourceMethods(gantt){\n\n\tvar resourceTaskCache = {};\n\tvar singleResourceCacheBuilt = false;\n\n\tgantt.$data.tasksStore.attachEvent(\"onStoreUpdated\", function(){\n\t\tresourceTaskCache = {};\n\t\tsingleResourceCacheBuilt = false;\n\t});\n\tgantt.attachEvent(\"onBeforeGanttRender\", function(){\n\t\tresourceTaskCache = {};\n\t});\n\n\tfunction getTaskBy(propertyName, propertyValue, typeFilter) {\n\t\tif (typeof propertyName == \"function\") {\n\t\t\treturn filterResourceTasks(propertyName);\n\t\t} else {\n\t\t\tif (helpers.isArray(propertyValue)) {\n\t\t\t\treturn getResourceTasks(propertyName, propertyValue, typeFilter);\n\t\t\t} else {\n\t\t\t\treturn getResourceTasks(propertyName, [propertyValue], typeFilter);\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction filterResourceTasks(filter) {\n\t\tvar res = [];\n\t\tgantt.eachTask(function (task) {\n\t\t\tif (filter(task)) {\n\t\t\t\tres.push(task);\n\t\t\t}\n\t\t});\n\t\treturn res;\n\t}\n\n\tvar falsyValuePrefix = String(Math.random());\n\tfunction resourceHashFunction(value){\n\t\tif (value === null){\n\t\t\treturn falsyValuePrefix + String(value);\n\t\t}\n\t\treturn String(value);\n\t}\n\n\tfunction getCacheKey(resourceIds, property, typeFilter) {\n\t\tif (Array.isArray(resourceIds)) {\n\t\t\treturn resourceIds.map(function (value) {\n\t\t\t\treturn resourceHashFunction(value);\n\t\t\t}).join(\"_\") + `_${property}_${typeFilter}`;\n\t\t} else {\n\t\t\treturn resourceHashFunction(resourceIds) + `_${property}_${typeFilter}`;\n\t\t}\n\t}\n\n\tfunction getResourceTasks(property, resourceIds, typeFilter) {\n\t\tvar res;\n\t\tvar cacheKey = getCacheKey(resourceIds, property, JSON.stringify(typeFilter));\n\t\tvar matchingResources = {};\n\t\thelpers.forEach(resourceIds, function(resourceId) {\n\t\t\tmatchingResources[resourceHashFunction(resourceId)] = true;\n\t\t});\n\n\t\tif (!resourceTaskCache[cacheKey]) {\n\t\t\tres = resourceTaskCache[cacheKey] = [];\n\t\t\tgantt.eachTask(function (task) {\n\t\t\t\tif (typeFilter) {\n\t\t\t\t\tif (!typeFilter[gantt.getTaskType(task)]) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t} else if (task.type == gantt.config.types.project) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (property in task) {\n\t\t\t\t\tvar resourceValue;\n\t\t\t\t\tif (!helpers.isArray(task[property])) {\n\t\t\t\t\t\tresourceValue = [task[property]];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresourceValue = task[property];\n\t\t\t\t\t}\n\n\t\t\t\t\thelpers.forEach(resourceValue, function(value) {\n\t\t\t\t\t\tvar resourceValue = (value && value.resource_id) ? value.resource_id : value;\n\n\t\t\t\t\t\tif (matchingResources[resourceHashFunction(resourceValue)]) {\n\t\t\t\t\t\t\tres.push(task);\n\t\t\t\t\t\t}else if(!singleResourceCacheBuilt){\n\n\t\t\t\t\t\t\tvar key = getCacheKey(value, property);\n\t\t\t\t\t\t\tif(!resourceTaskCache[key]){\n\t\t\t\t\t\t\t\tresourceTaskCache[key] = [];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tresourceTaskCache[key].push(task);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tsingleResourceCacheBuilt = true;\n\t\t} else {\n\t\t\tres = resourceTaskCache[cacheKey];\n\t\t}\n\n\t\treturn res;\n\t}\n\n\tfunction selectAssignments(resourceId, taskId, result){\n\t\tvar property = gantt.config.resource_property;\n\t\tvar owners = [];\n\t\tif (gantt.getDatastore(\"task\").exists(taskId)) {\n\t\t\tvar task = gantt.getTask(taskId);\n\t\t\towners = task[property] || [];\n\t\t}\n\n\t\tif (!Array.isArray(owners)) {\n\t\t\towners = [owners];\n\t\t}\n\t\tfor (var i = 0; i < owners.length; i++) {\n\t\t\tif (owners[i].resource_id == resourceId) {\n\t\t\t\tresult.push({task_id: task.id, resource_id:owners[i].resource_id, value:owners[i].value});\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction getResourceAssignments(resourceId, taskId){\n\t\t// resource assignment as an independent module:\n\t\t// {taskId:, resourceId, value}\n\t\t// TODO: probably should add a separate datastore for these\n\t\tvar assignments = [];\n\t\tvar property = gantt.config.resource_property;\n\t\tif(taskId !== undefined){\n\t\t\tselectAssignments(resourceId, taskId, assignments);\n\t\t}else{\n\t\t\tvar tasks = gantt.getTaskBy(property, resourceId);\n\t\t\ttasks.forEach(function(task){\n\t\t\t\tselectAssignments(resourceId, task.id, assignments);\n\t\t\t});\n\t\t}\n\t\treturn assignments;\n\t}\n\n\treturn {\n\t\tgetTaskBy: getTaskBy,\n\t\tgetResourceAssignments: getResourceAssignments\n\t};\n}\n\nfunction createHelper(gantt){\n\tconst resourcePlugin = {\n\t\trenderEditableLabel: function(start_date, end_date, resource, tasks, assignments){\n\t\t\tconst editable = gantt.config.readonly ? \"\" : \"contenteditable\";\n\t\t\tif(start_date < resource.end_date && end_date > resource.start_date){\n\t\t\t\tfor(let i = 0; i < assignments.length; i++){\n\t\t\t\t\tconst a = assignments[i];\n\t\t\t\t\t\treturn \"<div \"+editable+\" data-assignment-cell data-assignment-id='\"+a.id+\"'\"+\n\t\t\t\t\t\t\" data-row-id='\"+resource.id+\"'\"+\n\t\t\t\t\t\t\" data-task='\"+resource.$task_id+\"'\"+\n\t\t\t\t\t\t\" data-start-date='\"+gantt.templates.format_date(start_date)+\"'\"+\n\t\t\t\t\t\t\" data-end-date='\"+gantt.templates.format_date(end_date)+\"'>\" + a.value + \"</div>\";\n\t\t\t\t}\n\t\t\t\treturn \"<div \"+editable+\" data-assignment-cell data-empty \"+ \n\t\t\t\t\t\t\" data-row-id='\"+resource.id+\"'\"+\n\t\t\t\t\t\t\" data-resource-id='\"+resource.$resource_id+\"'\"+\n\t\t\t\t\t\t\" data-task='\"+resource.$task_id+\"'\"+\n\t\t\t\t\t\t\" data-start-date='\"+gantt.templates.format_date(start_date)+\"'\"+\n\t\t\t\t\t\t\"'  data-end-date='\"+gantt.templates.format_date(end_date)+\"'>-</div>\";\n\t\t\t}\n\t\t\treturn \"\";\n\t\t},\n\t\trenderSummaryLabel: function(start_date, end_date, resource, tasks, assignments){\n\t\t\tlet sum = assignments.reduce(function(total, assignment){ \n\t\t\t\treturn total + Number(assignment.value);\n\t\t\t}, 0);\n\n\t\t\tif(sum % 1){\n\t\t\t\tsum = Math.round(sum * 10)/10;\n\t\t\t}\n\n\t\t\tif(sum){\n\t\t\t\treturn \"<div>\" + sum + \"</div>\";\n\t\t\t}\n\t\t\treturn \"\";\n\t\t},\n\t\teditableResourceCellTemplate: function(start_date, end_date, resource, tasks, assignments){\n\t\t\tif(resource.$role === \"task\"){\n\t\t\t\treturn resourcePlugin.renderEditableLabel(start_date, end_date, resource, tasks, assignments);\n\t\t\t}else{\n\t\t\t\treturn resourcePlugin.renderSummaryLabel(start_date, end_date, resource, tasks, assignments);\n\t\t\t}\n\n\t\t},\n\t\t\n\t\teditableResourceCellClass: function(start_date, end_date, resource, tasks, assignments){\n\t\t\tconst css = [];\n\t\t\tcss.push(\"resource_marker\");\n\n\t\t\tif(resource.$role === \"task\"){\n\t\t\t\tcss.push(\"task_cell\");\n\t\t\t}else{\n\t\t\t\tcss.push(\"resource_cell\");\n\t\t\t}\n\n\t\t\tconst sum = assignments.reduce(function(total, assignment){ \n\t\t\t\treturn total + Number(assignment.value);\n\t\t\t}, 0);\n\n\t\t\tlet capacity = Number(resource.capacity);\n\t\t\tif(isNaN(capacity)){\n\t\t\t\tcapacity = 8;\n\t\t\t}\n\t\t\tif (sum <= capacity) {\n\t\t\t\tcss.push(\"workday_ok\");\n\t\t\t} else {\n\t\t\t\tcss.push(\"workday_over\");\n\t\t\t}\n\t\t\treturn css.join(\" \");\n\t\t},\n\t\tgetSummaryResourceAssignments: function getResourceAssignments(resourceId) {\n\t\t\tlet assignments;\n\t\t\tconst store = gantt.getDatastore(gantt.config.resource_store);\n\t\t\tconst resource = store.getItem(resourceId);\n\n\t\t\tif(resource.$role === \"task\"){\n\t\t\t\tassignments = gantt.getResourceAssignments(resource.$resource_id, resource.$task_id);\n\t\t\t}else{\n\t\t\t\tassignments = gantt.getResourceAssignments(resourceId);\n\t\t\t\tif(store.eachItem){\n\t\t\t\t\tstore.eachItem(function(childResource){\n\t\t\t\t\t\tif(childResource.$role !== \"task\"){\n\t\t\t\t\t\t\tassignments = assignments.concat(gantt.getResourceAssignments(childResource.id));\n\t\t\t\t\t\t}\n\t\t\t\t\t}, resourceId);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn assignments;\n\t\t},\n\t\t\n\t\tinitEditableDiagram: function(){\n\t\t\tgantt.config.resource_render_empty_cells = true;\n\t\t\t\n\t\t\t\n\t\t\t(function(){\n\t\t\t\t/// salesforce locker workaround\n\t\t\t\t// SF removes 'contenteditable' attribute from cells\n\t\t\t\t// restore it on render\n\t\t\t\tlet timeoutId = null;\n\t\t\t\tfunction makeEditable() {\n\t\t\t\t\tif (timeoutId) {\n\t\t\t\t\t\tcancelAnimationFrame(timeoutId);\n\t\t\t\t\t}\n\t\t\t\t\ttimeoutId = requestAnimationFrame(function () {\n\t\t\t\t\t\tif (gantt.$container){\n\t\t\t\t\t\t\tvar cells = Array.prototype.slice.call(gantt.$container.querySelectorAll(\".resourceTimeline_cell [data-assignment-cell]\"));\n\t\t\t\t\t\t\tcells.forEach(function (cell) {\n\t\t\t\t\t\t\t\tcell.contentEditable = true;\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tgantt.attachEvent(\"onGanttReady\", function(){\n\t\t\t\t\tgantt.getDatastore(gantt.config.resource_assignment_store).attachEvent(\"onStoreUpdated\", makeEditable);\n\t\t\t\t\tgantt.getDatastore(gantt.config.resource_store).attachEvent(\"onStoreUpdated\", makeEditable);\n\t\t\t\t}, {once: true});\n\t\t\t\tgantt.attachEvent(\"onGanttLayoutReady\", function(){\n\t\t\t\t\tconst ganttViews = gantt.$layout.getCellsByType(\"viewCell\");\n\t\t\t\t\tganttViews.forEach(function(view){\n\t\t\t\t\t\tif(view.$config && view.$config.view === \"resourceTimeline\" && view.$content){\n\t\t\t\t\t\t\tview.$content.attachEvent(\"onScroll\", makeEditable);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t})();\n\t\t\t//GS-2766: need to restore focus after updating assignments\n\t\t\tlet currentFocusIndex = null;\n\t\t\tfunction setNextFocus(){\n\t\t\t\tsetTimeout(function(){\n\t\t\t\t\tconst focusableElementsAfterRender = dom_helpers.getFocusableNodes(gantt.$container);\n\t\t\t\t\tif(currentFocusIndex > -1){\n\t\t\t\t\t\tfocusableElementsAfterRender[currentFocusIndex +1]?.focus();\n\t\t\t\t\t}\n\t\t\t\t}, 300);\n\t\t\t};\n\n\t\t\tfunction handleAssignmentEdit(e, elem){\n\t\t\t\tlet target = elem || e.target.closest(\".resourceTimeline_cell [data-assignment-cell]\");\n\t\t\t\tif(target){\n\t\t\t\t\tlet strValue = (target.innerText || \"\").trim();\n\t\t\t\t\tif(strValue == \"-\"){\n\t\t\t\t\t\tstrValue = \"0\";\n\t\t\t\t\t}\n\t\t\t\t\tlet value = Number(strValue);\n\t\t\t\t\tlet rowId = target.getAttribute(\"data-row-id\");\n\t\t\t\t\tlet assignmentId = target.getAttribute(\"data-assignment-id\");\n\t\t\t\t\tlet taskId = target.getAttribute(\"data-task\");\n\t\t\t\t\tlet resourceId = target.getAttribute(\"data-resource-id\");\n\t\t\t\t\tlet startDate = gantt.templates.parse_date(target.getAttribute(\"data-start-date\"));\n\t\t\t\t\tlet endDate = gantt.templates.parse_date(target.getAttribute(\"data-end-date\"));\n\n\t\t\t\t\tconst assignmentStore = gantt.getDatastore(gantt.config.resource_assignment_store);\n\t\t\t\t\tif(isNaN(value)){\n\t\t\t\t\t\tgantt.getDatastore(gantt.config.resource_store).refresh(rowId);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tconst task = gantt.getTask(taskId);\n\t\t\t\t\t\tif(assignmentId){\n\t\t\t\t\t\t\t// GS-2141. Track the changes by the Undo extension\n\t\t\t\t\t\t\tif (gantt.plugins().undo){\n\t\t\t\t\t\t\t\tgantt.ext.undo.saveState(taskId, \"task\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tconst assignment = assignmentStore.getItem(assignmentId);\n\t\t\t\t\t\t\tif(!assignment || value === assignment.value){\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(assignment.start_date.valueOf() === startDate.valueOf() && assignment.end_date.valueOf() === endDate.valueOf()){\n\t\t\t\t\t\t\t\tassignment.value = value;\n\t\t\t\t\t\t\t\tif(!value){\n\t\t\t\t\t\t\t\t\tassignmentStore.removeItem(assignment.id);\n\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\tassignmentStore.updateItem(assignment.id);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif(assignment.end_date.valueOf() > endDate.valueOf()){\n\t\t\t\t\t\t\t\t\tconst nextChunk = gantt.copy(assignment);\n\t\t\t\t\t\t\t\t\tnextChunk.id = gantt.uid();\n\t\t\t\t\t\t\t\t\tnextChunk.start_date = endDate;\n\t\t\t\t\t\t\t\t\tnextChunk.duration = gantt.calculateDuration({\n\t\t\t\t\t\t\t\t\t\tstart_date: nextChunk.start_date,\n\t\t\t\t\t\t\t\t\t\tend_date: nextChunk.end_date,\n\t\t\t\t\t\t\t\t\t\ttask: task\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tnextChunk.delay = gantt.calculateDuration({\n\t\t\t\t\t\t\t\t\t\tstart_date: task.start_date,\n\t\t\t\t\t\t\t\t\t\tend_date: nextChunk.start_date,\n\t\t\t\t\t\t\t\t\t\ttask: task\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tnextChunk.mode = assignment.mode || \"default\";\n\t\t\t\t\t\t\t\t\tif(nextChunk.duration !== 0){\n\t\t\t\t\t\t\t\t\t\tassignmentStore.addItem(nextChunk);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tif(assignment.start_date.valueOf() < startDate.valueOf()){\n\t\t\t\t\t\t\t\t\tassignment.end_date = startDate;\n\t\t\t\t\t\t\t\t\tassignment.duration = gantt.calculateDuration({\n\t\t\t\t\t\t\t\t\t\tstart_date: assignment.start_date,\n\t\t\t\t\t\t\t\t\t\tend_date: assignment.end_date,\n\t\t\t\t\t\t\t\t\t\ttask: task\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tassignment.mode = \"fixedDuration\";\n\n\t\t\t\t\t\t\t\t\tif(assignment.duration === 0){\n\t\t\t\t\t\t\t\t\t\tassignmentStore.removeItem(assignment.id);\n\t\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\t\tassignmentStore.updateItem(assignment.id);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\tassignmentStore.removeItem(assignment.id);\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tif(value){\n\t\t\t\t\t\t\t\t\tassignmentStore.addItem({\n\t\t\t\t\t\t\t\t\t\ttask_id: assignment.task_id,\n\t\t\t\t\t\t\t\t\t\tresource_id: assignment.resource_id,\n\t\t\t\t\t\t\t\t\t\tvalue: value,\n\t\t\t\t\t\t\t\t\t\tstart_date: startDate,\n\t\t\t\t\t\t\t\t\t\tend_date: endDate,\n\t\t\t\t\t\t\t\t\t\tduration: gantt.calculateDuration({\n\t\t\t\t\t\t\t\t\t\t\tstart_date: startDate,\n\t\t\t\t\t\t\t\t\t\t\tend_date: endDate,\n\t\t\t\t\t\t\t\t\t\t\ttask: task\n\t\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\t\tdelay: gantt.calculateDuration({\n\t\t\t\t\t\t\t\t\t\t\tstart_date: task.start_date,\n\t\t\t\t\t\t\t\t\t\t\tend_date: startDate,\n\t\t\t\t\t\t\t\t\t\t\ttask: task\n\t\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\t\tmode: \"fixedDuration\"\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tgantt.updateTaskAssignments(task.id);\n\t\t\t\t\t\t\tgantt.updateTask(task.id);\n\n\t\t\t\t\t\t}else if(value){\n\t\t\t\t\t\t\tlet assignment = {\n\t\t\t\t\t\t\t\ttask_id: taskId,\n\t\t\t\t\t\t\t\tresource_id: resourceId,\n\t\t\t\t\t\t\t\tvalue: value,\n\t\t\t\t\t\t\t\tstart_date: startDate,\n\t\t\t\t\t\t\t\tend_date: endDate,\n\t\t\t\t\t\t\t\tduration: gantt.calculateDuration({\n\t\t\t\t\t\t\t\t\tstart_date: startDate,\n\t\t\t\t\t\t\t\t\tend_date: endDate,\n\t\t\t\t\t\t\t\t\ttask: task\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\tdelay: gantt.calculateDuration({\n\t\t\t\t\t\t\t\t\tstart_date: task.start_date,\n\t\t\t\t\t\t\t\t\tend_date: startDate,\n\t\t\t\t\t\t\t\t\ttask: task\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\tmode: \"fixedDuration\"\n\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\tassignmentStore.addItem(assignment);\n\t\t\t\t\t\t\tgantt.updateTaskAssignments(task.id);\n\t\t\t\t\t\t\tgantt.updateTask(task.id);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tgantt.attachEvent(\"onGanttReady\", function(){\n\t\t\t\tlet editedElem = null;\n\t\t\t\tgantt.event(gantt.$container, \"keypress\", function(e){\n\t\t\t\t\tlet target = e.target.closest(\".resourceTimeline_cell [data-assignment-cell]\");\n\t\t\t\t\tif(target){\n\t\t\t\t\t\tif (e.keyCode === 13 || e.keyCode === 27) {\n\t\t\t\t\t\t\ttarget.blur();\n\t\t\t\t\t\t\thandleAssignmentEdit(e);\n\t\t\t\t\t\t}\n\t\t\t\t\t\teditedElem = e.target;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tgantt.event(gantt.$container, \"keydown\", function(event){\n\t\t\t\t\tif (event.key === \"Tab\") {\n\t\t\t\t\t\tconst focusableElements = dom_helpers.getFocusableNodes(gantt.$container);\n\t\t\t\t\t\tcurrentFocusIndex = focusableElements.indexOf(document.activeElement);\n\t\t\t\t\t\thandleAssignmentEdit(event);\n\t\t\t\t\t\tsetNextFocus();\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tgantt.event(gantt.$container, \"click\", function(e) {\n\t\t\t\t\tif(editedElem){\n\t\t\t\t\t\thandleAssignmentEdit(e, editedElem);\n\t\t\t\t\t\teditedElem = null;\n\t\t\t\t\t\t//handle click on the editable content\n\t\t\t\t\t\tif(e.target.hasAttribute(\"data-assignment-id\")){\n\t\t\t\t\t\t\tconst focusableElements = gantt.$container.querySelectorAll(\"[contenteditable='true']\");\n\t\t\t\t\t\t\tconst target = Array.from(focusableElements).find(elem =>\n\t\t\t\t\t\t\t\telem.getAttribute(\"data-start-date\") == e.target.getAttribute(\"data-start-date\") &&\n\t\t\t\t\t\t\t\telem.getAttribute(\"data-assignment-id\") == e.target.getAttribute(\"data-assignment-id\")\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t//set focus after editing assignment\n\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\tconst focusableElementsAfterUpdate = gantt.$container.querySelectorAll(\"[contenteditable='true']\");\n\t\t\t\t\t\t\t\tconst targetAfterUpdate = Array.from(focusableElementsAfterUpdate).find(elem =>\n\t\t\t\t\t\t\t\t\telem.getAttribute(\"data-start-date\") == target.getAttribute(\"data-start-date\") &&\n\t\t\t\t\t\t\t\t\telem.getAttribute(\"data-row-id\") == target.getAttribute(\"data-row-id\")\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tif (targetAfterUpdate) {\n\t\t\t\t\t\t\t\t\ttargetAfterUpdate.focus();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}, 400);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}, {once: true});\n\t\t}\n\t};\n\treturn resourcePlugin;\n}\n\nexport default function(gantt){\n\tvar methods = createResourceMethods(gantt);\n\t\n\tgantt.ext.resources = createHelper(gantt);\n\n\tgantt.config.resources = {\n\t\tdataprocessor_assignments: false,\n\t\tdataprocessor_resources: false,\n\t\teditable_resource_diagram: false,\n\t\tresource_store: {\n\t\t\ttype: \"treeDataStore\",\n\t\t\tfetchTasks: false,\n\t\t\tinitItem: function(item) {\n\t\t\t\titem.parent = item.parent || gantt.config.root_id;\n\t\t\t\titem[gantt.config.resource_property] = item.parent;\n\t\t\t\titem.open = true;\n\t\t\t\treturn item;\n\t\t\t}\n\t\t},\n\t\tlightbox_resources: function selectResourceControlOptions(resources){\n\t\t\tconst lightboxOptions = [];\n\t\t\tconst store = gantt.getDatastore(gantt.config.resource_store);\n\t\t\tresources.forEach(function(res) {\n\t\t\t\tif (!store.hasChild(res.id)) {\n\t\t\t\t\tconst copy = gantt.copy(res);\n\t\t\t\t\tcopy.key = res.id;\n\t\t\t\t\tcopy.label = res.text;\n\t\t\t\t\tlightboxOptions.push(copy);\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn lightboxOptions;\n\t\t}\n\t};\n\n\tgantt.attachEvent(\"onBeforeGanttReady\", function(){\n\t\tif(gantt.getDatastore(gantt.config.resource_store)){\n\t\t\treturn;\n\t\t}\n\n\t\tconst resourceStoreConfig = gantt.config.resources ? gantt.config.resources.resource_store : undefined;\n\t\tlet fetchTasks = resourceStoreConfig ? resourceStoreConfig.fetchTasks : undefined;\n\t\tif(gantt.config.resources && gantt.config.resources.editable_resource_diagram){\n\t\t\tfetchTasks = true;\n\t\t}\n\n\t\tlet initItems = function(item) {\n\t\t\titem.parent = item.parent || gantt.config.root_id;\n\t\t\titem[gantt.config.resource_property] = item.parent;\n\t\t\titem.open = true;\n\t\t\treturn item;\n\t\t};\n\n\t\tif(resourceStoreConfig && resourceStoreConfig.initItem){\n\t\t\tinitItems = resourceStoreConfig.initItem;\n\t\t}\n\n\t\tconst storeType = resourceStoreConfig && resourceStoreConfig.type ? resourceStoreConfig.type : \"treeDatastore\";\n\n\t\tgantt.$resourcesStore = gantt.createDatastore({\n\t\t\tname: gantt.config.resource_store,\n\t\t\ttype: storeType,\n\t\t\tfetchTasks: fetchTasks !== undefined ? fetchTasks : false,\n\t\t\tinitItem: initItems\n\t\t});\n\n\t\tgantt.$data.resourcesStore = gantt.$resourcesStore;\n\n\t\tgantt.$resourcesStore.attachEvent(\"onParse\", function() {\n\t\t\tfunction selectResourceControlOptions(resources){\n\t\t\t\tconst lightboxOptions = [];\n\t\t\t\tresources.forEach(function(res) {\n\t\t\t\t\tconst copy = gantt.copy(res);\n\t\t\t\t\tcopy.key = res.id;\n\t\t\t\t\tcopy.label = res.text;\n\t\t\t\t\tlightboxOptions.push(copy);\n\t\t\t\t});\n\t\t\t\treturn lightboxOptions;\n\t\t\t}\n\n\t\t\tlet lightboxOptionsFnc = selectResourceControlOptions;\n\t\t\tlet options;\n\t\t\tif(gantt.config.resources && gantt.config.resources.lightbox_resources){\n\t\t\t\tlightboxOptionsFnc = gantt.config.resources.lightbox_resources;\n\t\t\t}\n\t\t\tif(gantt.config.resources && gantt.config.resources.editable_resource_diagram){\n\t\t\t\t// GS-2604: case for the next parsed resources\n\t\t\t\t// to filter only resources with assignments\n\t\t\t\tconst resources = gantt.$resourcesStore.getItems();\n\t\t\t\tconst filteredResources = resources.filter(resource => {\n\t\t\t\t\tlet assignments = gantt.getResourceAssignments(resource.id);\n\t\t\t\t\tif(!gantt.$resourcesStore.hasChild(resource.id) || (assignments && assignments.length)){\n\t\t\t\t\t\tif(resource.$resource_id && resource.$task_id){\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\toptions = lightboxOptionsFnc(filteredResources);\n\t\t\t} else {\n\t\t\t\toptions = lightboxOptionsFnc(gantt.$resourcesStore.getItems());\n\t\t\t}\n\t\t\tgantt.updateCollection(\"resourceOptions\", options);\n\t\t});\n\t});\n\n\tgantt.getTaskBy = methods.getTaskBy;\n\tgantt.getResourceAssignments = methods.getResourceAssignments;\n\tgantt.config.resource_property = \"owner_id\";\n\tgantt.config.resource_store = \"resource\";\n\tgantt.config.resource_render_empty_cells = false;\n\n\t/**\n\t * these are placeholder functions that should be redefined by the user\n\t*/\n\tgantt.templates.histogram_cell_class = function(start_date, end_date, resource, tasks, assignments) {};\n\tgantt.templates.histogram_cell_label = function(start_date, end_date, resource, tasks, assignments) {\n\t\treturn tasks.length + \"/3\";\n\t};\n\tgantt.templates.histogram_cell_allocated = function(start_date, end_date, resource, tasks, assignments) {\n\t\treturn tasks.length / 3;\n\t};\n\tgantt.templates.histogram_cell_capacity = function(start_date, end_date, resource, tasks, assignments) {\n\t\treturn 0;\n\t};\n\n\n\tconst defaultResourceCellClass = function(start, end, resource, tasks, assignments) {\n\t\tvar css = \"\";\n\t\tif (tasks.length <= 1) {\n\t\t\tcss = \"gantt_resource_marker_ok\";\n\t\t} else {\n\t\t\tcss = \"gantt_resource_marker_overtime\";\n\t\t}\n\t\treturn css;\n\t};\n\n\tconst defaultResourceCellTemplate = function(start, end, resource, tasks, assignments) {\n\t\treturn tasks.length * 8;\n\t};\n\n\tgantt.templates.resource_cell_value = defaultResourceCellTemplate;\n\tgantt.templates.resource_cell_class = defaultResourceCellClass;\n\n\t//editable_resource_diagram\n\tgantt.attachEvent(\"onBeforeGanttReady\", function(){\n\t\tif(gantt.config.resources && gantt.config.resources.editable_resource_diagram){\n\n\t\t\tgantt.config.resource_render_empty_cells = true;\n\t\t\tif(gantt.templates.resource_cell_value === defaultResourceCellTemplate){\n\t\t\t\tgantt.templates.resource_cell_value = gantt.ext.resources.editableResourceCellTemplate;\n\t\t\t}\n\t\t\tif(gantt.templates.resource_cell_class === defaultResourceCellClass){\n\t\t\t\tgantt.templates.resource_cell_class = gantt.ext.resources.editableResourceCellClass;\n\t\t\t}\n\t\t\t\n\t\t\tgantt.ext.resources.initEditableDiagram(gantt);\n\t\t}\n\t});\n};\n\n\n","export default function (gantt) {\n\tvar resourceAssignmentsProperty = \"$resourceAssignments\";\n\tgantt.config.resource_assignment_store = \"resourceAssignments\";\n\tgantt.config.process_resource_assignments = true;\n\n\tvar resourceAssignmentFormats = {\n\t\tauto: \"auto\",\n\t\tsingleValue: \"singleValue\",\n\t\tvalueArray: \"valueArray\",\n\t\tresourceValueArray: \"resourceValueArray\",\n\t\tassignmentsArray: \"assignmentsArray\"\n\t};\n\tvar resourceAssignmentFormat = resourceAssignmentFormats.auto;//\"primitiveSingle\";//\"primitive\";//\"object\"|\"assignment\"\n\n\tvar assignmentModes = {\n\t\tfixedDates: \"fixedDates\",\n\t\tfixedDuration: \"fixedDuration\",\n\t\tdefault: \"default\"\n\t};\n\n\n\tfunction initAssignmentFields(item, task){\n\t\tif (item.start_date) {\n\t\t\titem.start_date = gantt.date.parseDate(item.start_date, \"parse_date\");\n\t\t} else {\n\t\t\titem.start_date = null;\n\t\t}\n\n\t\tif (item.end_date) {\n\t\t\titem.end_date = gantt.date.parseDate(item.end_date, \"parse_date\");\n\t\t} else {\n\t\t\titem.end_date = null;\n\t\t}\n\n\t\tvar delay = Number(item.delay);\n\t\tvar initDelay = false;\n\t\tif (!isNaN(delay)) {\n\t\t\titem.delay = delay;\n\t\t} else {\n\t\t\titem.delay = 0;\n\t\t\tinitDelay = true;\n\t\t}\n\n\t\tif (!gantt.defined(item.value)) {\n\t\t\titem.value = null;\n\t\t}\n\n\t\tif (!item.task_id || !item.resource_id) {\n\t\t\treturn false;\n\t\t}\n\n\t\titem.mode = item.mode || assignmentModes.default;\n\n\t\tif(item.mode === assignmentModes.fixedDuration){\n\t\t\tif(isNaN(Number(item.duration))){\n\t\t\t\ttask = task || gantt.getTask(item.task_id);\n\t\t\t\titem.duration = gantt.calculateDuration({\n\t\t\t\t\tstart_date: item.start_date,\n\t\t\t\t\tend_date: item.end_date,\n\t\t\t\t\tid: task\n\t\t\t\t});\n\t\t\t}\n\t\t\tif(initDelay){\n\t\t\t\ttask = task || gantt.getTask(item.task_id);\n\t\t\t\titem.delay = gantt.calculateDuration({\n\t\t\t\t\tstart_date: task.start_date,\n\t\t\t\t\tend_date: item.start_date,\n\t\t\t\t\tid: task\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tif (item.mode !== assignmentModes.fixedDates && (task || gantt.isTaskExists(item.task_id))) {\n\t\t\ttask = task || gantt.getTask(item.task_id);\n\t\t\tvar timing = _assignmentTimeFromTask(item, task);\n\t\t\titem.start_date = timing.start_date;\n\t\t\titem.end_date = timing.end_date;\n\t\t\titem.duration = timing.duration;\n\t\t}\n\t}\n\t// gantt init\n\tvar resourceAssignmentsStore = gantt.createDatastore({\n\t\tname: gantt.config.resource_assignment_store,\n\t\tinitItem: function (item) {\n\t\t\tif (!item.id) {\n\t\t\t\titem.id = gantt.uid();\n\t\t\t}\n\n\t\t\tinitAssignmentFields(item);\n\n\t\t\treturn item;\n\t\t}\n\t});\n\t\n\tgantt.$data.assignmentsStore = resourceAssignmentsStore;\n\n\tfunction _assignmentTimeFromTask(assignment, task) {\n\n\t\tif (assignment.mode === assignmentModes.fixedDates) {\n\t\t\treturn {\n\t\t\t\tstart_date: assignment.start_date,\n\t\t\t\tend_date: assignment.end_date,\n\t\t\t\tduration: assignment.duration\n\t\t\t};\n\t\t} else {\n\t\t\tvar start = assignment.delay ? gantt.calculateEndDate({\n\t\t\t\tstart_date: task.start_date,\n\t\t\t\tduration: assignment.delay,\n\t\t\t\ttask: task\n\t\t\t}) : new Date(task.start_date);\n\n\t\t\tvar end;\n\t\t\tvar duration;\n\t\t\tif (assignment.mode === assignmentModes.fixedDuration) {\n\t\t\t\tend = gantt.calculateEndDate({\n\t\t\t\t\tstart_date: start,\n\t\t\t\t\tduration: assignment.duration,\n\t\t\t\t\ttask: task\n\t\t\t\t});\n\t\t\t\tduration = assignment.duration;\n\t\t\t} else {\n\t\t\t\tend = new Date(task.end_date);\n\t\t\t\tduration = task.duration - assignment.delay;\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\tstart_date: start,\n\t\t\tend_date: end,\n\t\t\tduration: duration\n\t\t};\n\t}\n\n\t// data loading\n\n\tfunction _makeAssignmentsFromTask(task) {\n\t\tconst property = gantt.config.resource_property;\n\t\tlet assignments = task[property];\n\t\tconst resourceAssignments = [];\n\t\tlet detectFormat = resourceAssignmentFormat === resourceAssignmentFormats.auto;\n\n\t\tif (gantt.defined(assignments) && assignments) {\n\t\t\tif (!Array.isArray(assignments)) {\n\t\t\t\tassignments = [assignments];\n\t\t\t\tif (detectFormat) {\n\t\t\t\t\tresourceAssignmentFormat = resourceAssignmentFormats.singleValue;\n\t\t\t\t\tdetectFormat = false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst usedIds = {};\n\t\t\tassignments.forEach(function (res) {\n\t\t\t\tif (!res.resource_id) { // when resource is a string/number\n\t\t\t\t\tres = { resource_id: res };\n\t\t\t\t\tif (detectFormat) {\n\t\t\t\t\t\tresourceAssignmentFormat = resourceAssignmentFormats.valueArray;\n\t\t\t\t\t\tdetectFormat = false;\n\t\t\t\t\t}\n\t\t\t\t\t//\tisSimpleArray = true;\n\t\t\t\t}\n\n\t\t\t\tif (detectFormat) {\n\t\t\t\t\tif (res.id && res.resource_id) {\n\t\t\t\t\t\tresourceAssignmentFormat = resourceAssignmentFormats.assignmentsArray;\n\t\t\t\t\t\tdetectFormat = false;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresourceAssignmentFormat = resourceAssignmentFormats.resourceValueArray;\n\t\t\t\t\t\tdetectFormat = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tlet defaultMode = assignmentModes.default;\n\t\t\t\tif(!res.mode){\n\t\t\t\t\tif((res.start_date && res.end_date) || (res.start_date && res.duration)){\n\t\t\t\t\t\tdefaultMode = assignmentModes.fixedDuration;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tlet id;\n\t\t\t\tif(!res.id && res.$id && !usedIds[res.$id]){\n\t\t\t\t\tid = res.$id;\n\t\t\t\t} else if(res.id && !usedIds[res.id]){\n\t\t\t\t\tid = res.id;\n\t\t\t\t} else{\n\t\t\t\t\tid = gantt.uid();\n\t\t\t\t}\n\t\t\t\tusedIds[id] = true;\n\n\t\t\t\tconst assignment = {\n\t\t\t\t\tid: id,\n\t\t\t\t\tstart_date: res.start_date,\n\t\t\t\t\tduration: res.duration,\n\t\t\t\t\tend_date: res.end_date,\n\t\t\t\t\tdelay: res.delay,\n\t\t\t\t\ttask_id: task.id,\n\t\t\t\t\tresource_id: res.resource_id,\n\t\t\t\t\tvalue: res.value,\n\t\t\t\t\tmode: res.mode || defaultMode\n\t\t\t\t};\n\t\t\t\t// GS-2490: to add custom properties to assignment\n\t\t\t\t// need to exclude $id which incfluences on render \n\t\t\t\tObject.keys(res).forEach(key => {\n\t\t\t\t\tif(key != \"$id\") {\n\t\t\t\t\t\tassignment[key] = res[key];\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif(!(assignment.start_date && assignment.start_date.getMonth \n\t\t\t\t\t&& assignment.end_date && assignment.end_date.getMonth && typeof assignment.duration === \"number\")){\n\t\t\t\t\tinitAssignmentFields(assignment, task);\n\t\t\t\t}\n\n\t\t\t\tresourceAssignments.push(assignment);\n\t\t\t});\n\t\t}\n\t\treturn resourceAssignments;\n\t}\n\n\tfunction _updateTaskBack(taskId) {\n\t\t// GS-1493. In some cases, the resource assignment store has the tasks that no longer exist\n\t\tif (!gantt.isTaskExists(taskId)){\n\t\t\treturn;\n\t\t}\n\n\t\tvar task = gantt.getTask(taskId);\n\t\tvar assignments = gantt.getTaskAssignments(task.id);\n\t\t_assignAssignments(task, assignments);\n\t}\n\n\tfunction _assignAssignments(task, assignments){\n\t\tassignments.sort(function(a, b){\n\t\t\tif(a.start_date && b.start_date && a.start_date.valueOf() != b.start_date.valueOf()){\n\t\t\t\treturn a.start_date - b.start_date;\n\t\t\t}else{\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t});\n\t\tif (resourceAssignmentFormat == resourceAssignmentFormats.assignmentsArray) {\n\t\t\ttask[gantt.config.resource_property] = assignments;\n\t\t} else if (resourceAssignmentFormat == resourceAssignmentFormats.resourceValueArray) {\n\t\t\ttask[gantt.config.resource_property] = assignments.map(function (a) {\n\t\t\t\treturn {\n\t\t\t\t\t$id: a.id,\n\t\t\t\t\tstart_date: a.start_date,\n\t\t\t\t\tduration: a.duration,\n\t\t\t\t\tend_date: a.end_date,\n\t\t\t\t\tdelay: a.delay,\n\t\t\t\t\tresource_id: a.resource_id,\n\t\t\t\t\tvalue: a.value,\n\t\t\t\t\tmode: a.mode\n\t\t\t\t};\n\t\t\t});\n\t\t}\n\n\t\ttask[resourceAssignmentsProperty] = assignments;\n\t}\n\n\tfunction _loadAssignmentsFromTask(task) {\n\t\tvar assignments = _makeAssignmentsFromTask(task);\n\t\tvar taskAssignments = [];\n\t\tassignments.forEach(function (a) {\n\t\t\ta.id = a.id || gantt.uid();\n\t\t\t//var newId = resourceAssignmentsStore.addItem(a);\n\t\t\ttaskAssignments.push(a);\n\t\t});\n\n\t\treturn assignments;\n\t}\n\n\tfunction diffAssignments(taskValues, assignmentsStoreValues) {\n\t\tvar result = {\n\t\t\tinBoth: [],\n\t\t\tinTaskNotInStore: [],\n\t\t\tinStoreNotInTask: []\n\t\t};\n\n\t\tif (resourceAssignmentFormat == resourceAssignmentFormats.singleValue) {\n\t\t\tvar taskOwner = taskValues[0];\n\t\t\tvar ownerId = taskOwner ? taskOwner.resource_id : null;\n\t\t\tvar foundOwnerAssignment = false;\n\t\t\tassignmentsStoreValues.forEach(function (a) {\n\t\t\t\tif (a.resource_id != ownerId) {\n\t\t\t\t\tresult.inStoreNotInTask.push(a);\n\t\t\t\t} else if (a.resource_id == ownerId) {\n\t\t\t\t\tresult.inBoth.push({ store: a, task: taskOwner });\n\t\t\t\t\tfoundOwnerAssignment = true;\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (!foundOwnerAssignment && taskOwner) {\n\t\t\t\tresult.inTaskNotInStore.push(taskOwner);\n\t\t\t}\n\n\n\t\t} else if (resourceAssignmentFormat == resourceAssignmentFormats.valueArray){\n\n\t\t\tvar taskSearch = {};\n\t\t\tvar storeSearch = {};\n\t\t\tvar processedIds = {};\n\t\t\ttaskValues.forEach(function (a) {\n\t\t\t\ttaskSearch[a.resource_id] = a;\n\t\t\t});\n\t\t\tassignmentsStoreValues.forEach(function (a) {\n\t\t\t\tstoreSearch[a.resource_id] = a;\n\t\t\t});\n\t\t\ttaskValues.concat(assignmentsStoreValues).forEach(function (a) {\n\t\t\t\tif (processedIds[a.resource_id]) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tprocessedIds[a.resource_id] = true;\n\t\t\t\tvar inTask = taskSearch[a.resource_id];\n\t\t\t\tvar inStore = storeSearch[a.resource_id];\n\n\t\t\t\tif (inTask && inStore) {\n\t\t\t\t\tresult.inBoth.push({ store: inStore, task: inTask });\n\t\t\t\t} else if (inTask && !inStore) {\n\t\t\t\t\tresult.inTaskNotInStore.push(inTask);\n\t\t\t\t} else if (!inTask && inStore) {\n\t\t\t\t\tresult.inStoreNotInTask.push(inStore);\n\t\t\t\t}\n\t\t\t});\n\t\t} else if ((resourceAssignmentFormat == resourceAssignmentFormats.assignmentsArray)\n\t\t\t|| (resourceAssignmentFormat == resourceAssignmentFormats.resourceValueArray)) {\n\t\t\tvar taskSearch = {};\n\t\t\tvar storeSearch = {};\n\t\t\tvar processedIds = {};\n\t\t\ttaskValues.forEach(function (a) {\n\t\t\t\ttaskSearch[a.id || a.$id] = a;\n\t\t\t});\n\t\t\tassignmentsStoreValues.forEach(function (a) {\n\t\t\t\tstoreSearch[a.id] = a;\n\t\t\t});\n\t\t\ttaskValues.concat(assignmentsStoreValues).forEach(function (a) {\n\t\t\t\tvar id = a.id || a.$id;\n\t\t\t\tif (processedIds[id]) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tprocessedIds[id] = true;\n\t\t\t\tvar inTask = taskSearch[id];\n\t\t\t\tvar inStore = storeSearch[id];\n\n\t\t\t\tif (inTask && inStore) {\n\t\t\t\t\tresult.inBoth.push({ store: inStore, task: inTask });\n\t\t\t\t} else if (inTask && !inStore) {\n\t\t\t\t\tresult.inTaskNotInStore.push(inTask);\n\t\t\t\t} else if (!inTask && inStore) {\n\t\t\t\t\tresult.inStoreNotInTask.push(inStore);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\treturn result;\n\t}\n\n\tfunction assignmentHasChanged(source, target) {\n\t\tvar ignoreFields = {\n\t\t\tid: true\n\t\t};\n\n\t\tfor (var i in source) {\n\t\t\tif (!ignoreFields[i]) {\n\t\t\t\tif (String(source[i]) !== String(target[i])) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\tfunction updateAssignment(source, target) {\n\t\tvar ignoreFields = {\n\t\t\tid: true\n\t\t};\n\n\t\tfor (var i in source) {\n\t\t\tif (!ignoreFields[i]) {\n\t\t\t\ttarget[i] = source[i];\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction _syncAssignments(task, storeAssignments){\n\t\tvar tasksAssignments = _makeAssignmentsFromTask(task);\n\n\t\tvar diff = diffAssignments(tasksAssignments, storeAssignments);\n\t\tdiff.inStoreNotInTask.forEach(function (a) {\n\t\t\tresourceAssignmentsStore.removeItem(a.id);\n\t\t});\n\t\tdiff.inTaskNotInStore.forEach(function (a) {\n\t\t\tresourceAssignmentsStore.addItem(a);\n\t\t});\n\n\t\tdiff.inBoth.forEach(function (a) {\n\t\t\tif (assignmentHasChanged(a.task, a.store)) {\n\t\t\t\tupdateAssignment(a.task, a.store);\n\t\t\t\tresourceAssignmentsStore.updateItem(a.store.id);\n\t\t\t} else {\n\t\t\t\tif (a.task.start_date && a.task.end_date && a.task.mode !== assignmentModes.fixedDates) {\n\t\t\t\t\tvar timing = _assignmentTimeFromTask(a.store, task);\n\t\t\t\t\tif (a.store.start_date.valueOf() != timing.start_date.valueOf() || a.store.end_date.valueOf() != timing.end_date.valueOf()) {\n\t\t\t\t\t\ta.store.start_date = timing.start_date;\n\t\t\t\t\t\ta.store.end_date = timing.end_date;\n\t\t\t\t\t\ta.store.duration = timing.duration;\n\t\t\t\t\t\tresourceAssignmentsStore.updateItem(a.store.id);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t_updateTaskBack(task.id);\n\t}\n\n\tfunction _syncOnTaskUpdate(task) {\n\t\tvar storeAssignments = task[resourceAssignmentsProperty] || resourceAssignmentsStore.find(function (a) {\n\t\t\treturn a.task_id == task.id;\n\t\t});\n\n\t\t_syncAssignments(task, storeAssignments);\n\t}\n\n\tfunction _syncOnTaskDelete(ids) {\n\t\tvar idsSearch = {};\n\t\tids.forEach(function (id) {\n\t\t\tidsSearch[id] = true;\n\t\t});\n\t\tvar taskResources = resourceAssignmentsStore.find(function (a) {\n\t\t\treturn idsSearch[a.task_id];\n\t\t});\n\t\ttaskResources.forEach(function (a) {\n\t\t\tresourceAssignmentsStore.removeItem(a.id);\n\t\t});\n\t}\n\n\tgantt.attachEvent(\"onGanttReady\", function(){\n\n\t\tif (gantt.config.process_resource_assignments) {\n\t\t\tgantt.attachEvent(\"onParse\", function () {\n\t\t\t\tgantt.silent(function () {\n\t\t\t\t\tresourceAssignmentsStore.clearAll();\n\t\t\t\t\tvar totalAssignments = [];\n\t\t\t\t\tgantt.eachTask(function (task) {\n\t\t\t\t\t\tif (task.type === gantt.config.types.project) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar assignments = _loadAssignmentsFromTask(task);\n\t\t\t\t\t\t_assignAssignments(task, assignments);\n\n\t\t\t\t\t\tassignments.forEach(function (a) {\n\t\t\t\t\t\t\ttotalAssignments.push(a);\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t\tresourceAssignmentsStore.parse(totalAssignments);\n\t\t\t\t});\n\n\t\t\t});\n\n\t\t\tvar batchUpdate = false;\n\t\t\tvar needUpdate = false;\n\t\t\tvar needUpdateFor = {};\n\t\t\tvar undoBatchCancel = false;\n\t\t\tgantt.attachEvent(\"onBeforeBatchUpdate\", function(){\n\t\t\t\tbatchUpdate = true;\n\t\t\t});\n\t\t\tgantt.attachEvent(\"onAfterBatchUpdate\", function(){\n\t\t\t\t\n\t\t\t\tif(needUpdate){\n\t\t\t\t\tvar assignmentsHash = {};\n\t\t\t\t\tfor(var i in needUpdateFor){\n\t\t\t\t\t\tassignmentsHash[i] = gantt.getTaskAssignments(needUpdateFor[i].id);\n\t\t\t\t\t}\n\t\t\t\t\t// GS-2546. If we add a task that has the data in the old format,\n\t\t\t\t\t// we need to reset the cache as the assignment will be added\n\t\t\t\t\t// to the assignment store, but the cache won't have the changes\n\t\t\t\t\tif (gantt.config.process_resource_assignments && resourceAssignmentFormat === \"resourceValueArray\"){\n\t\t\t\t\t\ttaskAssignmentsCache = null;\n\t\t\t\t\t}\n\t\t\t\t\tfor(var i in needUpdateFor){\n\t\t\t\t\t\t_syncAssignments(needUpdateFor[i], assignmentsHash[i]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tneedUpdate = false;\n\t\t\t\tbatchUpdate = false;\n\t\t\t\tneedUpdateFor = {};\n\t\t\t});\n\n\t\t\tgantt.attachEvent(\"onTaskCreated\", function (item) {\n\t\t\t\tvar assignments = _loadAssignmentsFromTask(item);\n\t\t\t\tresourceAssignmentsStore.parse(assignments);\n\t\t\t\t_assignAssignments(item, assignments);\n\t\t\t\treturn true;\n\t\t\t});\n\t\t\tgantt.attachEvent(\"onAfterTaskUpdate\", function (id, item) {\n\t\t\t\tif(batchUpdate){\n\t\t\t\t\tneedUpdate = true;\n\t\t\t\t\tneedUpdateFor[id] = item;\n\t\t\t\t}else if (!item.unscheduled){\n\t\t\t\t\t_syncOnTaskUpdate(item);\n\t\t\t\t}\n\t\t\t});\n\t\t\tgantt.attachEvent(\"onAfterTaskAdd\", function (id, item) {\n\t\t\t\tif(batchUpdate){\n\t\t\t\t\tneedUpdate = true;\n\t\t\t\t\tneedUpdateFor[id] = item;\n\t\t\t\t}else{\n\t\t\t\t\t_syncOnTaskUpdate(item);\n\t\t\t\t}\n\t\t\t});\n\n\t\t/*\tgantt.attachEvent(\"onRowDragMove\", function (id) {\n\t\t\t\t_syncOnTaskUpdate(gantt.getTask(id));\n\t\t\t});*/\n\t\t\tgantt.attachEvent(\"onRowDragEnd\", function (id) {\n\t\t\t\t_syncOnTaskUpdate(gantt.getTask(id));\n\t\t\t});\n\t\t\tgantt.$data.tasksStore.attachEvent(\"onAfterDeleteConfirmed\", function (id, item) {\n\t\t\t\tvar deleteIds = [id];\n\t\t\t\tgantt.eachTask(function (task) {\n\t\t\t\t\tdeleteIds.push(task.id);\n\t\t\t\t}, id);\n\t\t\t\t_syncOnTaskDelete(deleteIds);\n\t\t\t});\n\t\t\tgantt.$data.tasksStore.attachEvent(\"onClearAll\", function () {\n\t\t\t\tresourceAssignmentsCache = null;\n\t\t\t\tresourceTaskAssignmentsCache = null;\n\t\t\t\ttaskAssignmentsCache = null;\n\t\t\t\tresourceAssignmentsStore.clearAll();\n\t\t\t\treturn true;\n\t\t\t});\n\t\t\tgantt.attachEvent(\"onTaskIdChange\", function (id, new_id) {\n\t\t\t\tvar taskResources = resourceAssignmentsStore.find(function (a) {\n\t\t\t\t\treturn a.task_id == id;\n\t\t\t\t});\n\t\t\t\ttaskResources.forEach(function (a) {\n\t\t\t\t\ta.task_id = new_id;\n\t\t\t\t\tresourceAssignmentsStore.updateItem(a.id);\n\t\t\t\t});\n\t\t\t\t_updateTaskBack(new_id);\n\t\t\t\t//any custom logic here\n\t\t\t});\n\t\t\t// GS-2144. When we Undo something, the cache should be reset\n\t\t\t// during the `onStoreUpdated` event to properly update the assignments\n\t\t\tgantt.attachEvent(\"onBeforeUndo\", function (action) {\n\t\t\t\tundoBatchCancel = true;\n\t\t\t\treturn true;\n\t\t\t});\n\t\t\tgantt.attachEvent(\"onAfterUndo\", function (action) {\n\t\t\t\tundoBatchCancel = true;\n\t\t\t});\n\n\n\t\t\tvar resourceAssignmentsCache = null;\n\t\t\tvar resourceTaskAssignmentsCache = null;\n\t\t\tvar taskAssignmentsCache = null;\n\n\t\t\tresourceAssignmentsStore.attachEvent(\"onStoreUpdated\", function resetCache(){\n\t\t\t\tif(batchUpdate && !undoBatchCancel){\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\tresourceAssignmentsCache = null;\n\t\t\t\tresourceTaskAssignmentsCache = null;\n\t\t\t\ttaskAssignmentsCache = null;\n\t\t\t\treturn true;\n\t\t\t});\n\n\t\t\tgantt.getResourceAssignments = function (resourceId, taskId) {\n\t\t\t\tvar searchTaskId = gantt.defined(taskId) && taskId !== null;\n\n\t\t\t\tif(resourceAssignmentsCache === null){\n\t\t\t\t\tresourceAssignmentsCache = {};\n\t\t\t\t\tresourceTaskAssignmentsCache = {};\n\n\t\t\t\t\tresourceAssignmentsStore.eachItem(function (a) {\n\t\t\t\t\t\tif(!resourceAssignmentsCache[a.resource_id]){\n\t\t\t\t\t\t\tresourceAssignmentsCache[a.resource_id] = [];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tresourceAssignmentsCache[a.resource_id].push(a);\n\n\t\t\t\t\t\tvar resourceTaskCacheKey = a.resource_id + \"-\" + a.task_id;\n\t\t\t\t\t\tif(!resourceTaskAssignmentsCache[resourceTaskCacheKey]){\n\t\t\t\t\t\t\tresourceTaskAssignmentsCache[resourceTaskCacheKey] = [];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tresourceTaskAssignmentsCache[resourceTaskCacheKey].push(a);\n\t\t\t\t\t});\n\t\t\t\t}\n\n\n\t\t\t\tif(searchTaskId){\n\t\t\t\t\treturn (resourceTaskAssignmentsCache[resourceId + \"-\" + taskId] || []).slice();\n\t\t\t\t}else{\n\t\t\t\t\treturn (resourceAssignmentsCache[resourceId] || []).slice();\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t\n\t\t\tgantt.getTaskAssignments = function (taskId) {\n\t\t\t\tif(taskAssignmentsCache === null){\n\t\t\t\t\tvar result = [];\n\t\t\t\t\ttaskAssignmentsCache = {};\n\t\t\t\t\tresourceAssignmentsStore.eachItem(function (a) {\n\t\t\t\t\t\tif(!taskAssignmentsCache[a.task_id]){\n\t\t\t\t\t\t\ttaskAssignmentsCache[a.task_id] = [];\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttaskAssignmentsCache[a.task_id].push(a);\n\t\t\t\t\t\tif (a.task_id == taskId) {\n\t\t\t\t\t\t\tresult.push(a);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\treturn (taskAssignmentsCache[taskId] || []).slice();\n\t\t\t};\n\t\t\t\n\t\t\tgantt.getTaskResources = function (taskId) {\n\t\t\t\tconst store = gantt.getDatastore(\"resource\");\n\t\t\t\tconst assignments = gantt.getTaskAssignments(taskId);\n\t\n\t\t\t\tconst uniqueResources = {};\n\t\t\t\tassignments.forEach(function(a){\n\t\t\t\t\tif(!uniqueResources[a.resource_id]){\n\t\t\t\t\t\tuniqueResources[a.resource_id] = a.resource_id;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tconst resources = [];\n\t\t\t\tfor(const i in uniqueResources){\n\t\t\t\t\tconst res = store.getItem(uniqueResources[i]);\n\t\t\t\t\tif(res){\n\t\t\t\t\t\tresources.push(res);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn resources;\n\t\t\t};\n\n\t\t\tgantt.updateTaskAssignments = _updateTaskBack;\n\t\t}\n\t}, {once: true});\n};","export default function addPlaceholder(gantt){\n\tfunction isEnabled(){\n\t\treturn gantt.config.placeholder_task;\n\t}\n\n\tfunction callIfEnabled(callback){\n\t\treturn function(){\n\t\t\tif(!isEnabled()){\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn callback.apply(this, arguments);\n\t\t};\n\t}\n\n\tfunction silenceDataProcessor(dataProcessor){\n\t\tif(dataProcessor && !dataProcessor._silencedPlaceholder){\n\t\t\tdataProcessor._silencedPlaceholder = true;\n\t\t\tdataProcessor.attachEvent(\"onBeforeUpdate\", callIfEnabled(function(id, state, data){\n\t\t\t\tif(data.type == gantt.config.types.placeholder){\n\t\t\t\t\tdataProcessor.setUpdated(id, false);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}));\n\t\t}\n\t}\n\n\tfunction insertPlaceholder(){\n\t\tvar placeholders = gantt.getTaskBy(\"type\", gantt.config.types.placeholder);\n\t\tif(!placeholders.length || !gantt.isTaskExists(placeholders[0].id)){\n\t\t\tvar placeholder = {\n\t\t\t\tunscheduled: true,\n\t\t\t\ttype: gantt.config.types.placeholder,\n\t\t\t\tduration:0,\n\t\t\t\ttext: gantt.locale.labels.new_task\n\t\t\t};\n\t\t\tif(gantt.callEvent(\"onTaskCreated\", [placeholder]) === false){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tgantt.addTask(placeholder);\n\t\t\t\n\t\t}\n\t}\n\n\tfunction afterEdit(id){\n\t\tvar item = gantt.getTask(id);\n\t\tif(item.type == gantt.config.types.placeholder) {\n\t\t\tif(item.start_date && item.end_date && item.unscheduled){\n\t\t\t\titem.unscheduled = false;\n\t\t\t}\n\n\t\t\tgantt.batchUpdate(function(){\n\t\t\t\tvar newTask = gantt.copy(item);\n\t\t\t\tgantt.silent(function(){\n\t\t\t\t\tgantt.deleteTask(item.id);\n\t\t\t\t});\n\n\t\t\t\tdelete newTask[\"!nativeeditor_status\"];\n\t\t\t\tnewTask.type = gantt.config.types.task;\n\t\t\t\tnewTask.id = gantt.uid();\n\t\t\t\tgantt.addTask(newTask);\n\n\t\t\t\t//insertPlaceholder();\n\t\t\t});\n\n\t\t}\n\t}\n\n\tgantt.config.types.placeholder = \"placeholder\";\n\tgantt.attachEvent(\"onDataProcessorReady\", callIfEnabled(silenceDataProcessor));\n\n\tvar ready = false;\n\tgantt.attachEvent(\"onGanttReady\", function(){\n\t\tif(ready){\n\t\t\treturn;\n\t\t}\n\t\tready = true;\n\t\tgantt.attachEvent(\"onAfterTaskUpdate\", callIfEnabled(afterEdit));\n\t\tgantt.attachEvent(\"onAfterTaskAdd\", callIfEnabled(function(id, task){\n\t\t\tif(task.type != gantt.config.types.placeholder){\n\t\t\t\tvar placeholders = gantt.getTaskBy(\"type\", gantt.config.types.placeholder);\n\t\t\t\tplaceholders.forEach(function(p){\n\t\t\t\t\tgantt.silent(function(){\n\t\t\t\t\t\tif(gantt.isTaskExists(p.id))\n\t\t\t\t\t\t\tgantt.deleteTask(p.id);\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t\tinsertPlaceholder();\n\t\t\t}\n\t\t}));\n\t\tgantt.attachEvent(\"onParse\", callIfEnabled(insertPlaceholder));\n\t});\n\n\tfunction isPlaceholderTask(taskId){\n\t\tif(gantt.config.types.placeholder && gantt.isTaskExists(taskId)){\n\t\t\tvar task = gantt.getTask(taskId);\n\t\t\tif(task.type == gantt.config.types.placeholder){\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\tfunction isPlaceholderLink(link){\n\t\tif(isPlaceholderTask(link.source) || isPlaceholderTask(link.target)){\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\tgantt.attachEvent(\"onLinkValidation\", function(link){\n\t\tif(isPlaceholderLink(link)){\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t});\n\tgantt.attachEvent(\"onBeforeLinkAdd\", function(id,link){\n\t\tif(isPlaceholderLink(link)){\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t});\n\n\tgantt.attachEvent(\"onBeforeUndoStack\", function(action){\n\t\tfor(var i = 0; i < action.commands.length; i++){\n\t\t\tvar command = action.commands[i];\n\t\t\tif(command.entity === \"task\" && command.value.type === gantt.config.types.placeholder){\n\t\t\t\taction.commands.splice(i,1);\n\t\t\t\ti--;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t});\n\n};","export default function(gantt) {\n\tfunction isEnabled() {\n\t\treturn gantt.config.auto_types && // if enabled\n\t\t\t(gantt.getTaskType(gantt.config.types.project) == gantt.config.types.project);// and supported\n\t}\n\n\tfunction callIfEnabled(callback) {\n\t\treturn function() {\n\t\t\tif (!isEnabled()) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn callback.apply(this, arguments);\n\t\t};\n\t}\n\n\tfunction checkTaskType(id, changedTypes) {\n\t\tvar task = gantt.getTask(id);\n\t\tvar targetType = getTaskTypeToUpdate(task);\n\t\tif (targetType !== false && gantt.getTaskType(task) !== targetType) {\n\t\t\tchangedTypes.$needsUpdate = true;\n\t\t\tchangedTypes[task.id] = {task: task, type: targetType};\n\t\t}\n\t}\n\n\tfunction getUpdatedTypes(id, changedTypes) {\n\t\tchangedTypes = changedTypes || {};\n\t\t\n\t\tcheckTaskType(id, changedTypes);\n\t\tgantt.eachParent(function(parent) {\n\t\t\tcheckTaskType(parent.id, changedTypes);\n\t\t}, id);\n\n\t\treturn changedTypes;\n\t}\n\n\tfunction applyChanges(changedTypes) {\n\t\tfor (var i in changedTypes) {\n\t\t\tif(changedTypes[i] && changedTypes[i].task){\n\t\t\t\tvar task = changedTypes[i].task;\n\t\t\t\ttask.type = changedTypes[i].type;\n\t\t\t\tgantt.updateTask(task.id);\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction updateParentTypes(startId) {\n\t\tif (gantt.getState().group_mode) {\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tvar changedTypes = getUpdatedTypes(startId);\n\t\tif (changedTypes.$needsUpdate) {\n\t\t\tgantt.batchUpdate(function() {\n\t\t\t\tapplyChanges(changedTypes);\n\t\t\t});\n\t\t}\n\t}\n\n\tvar delTaskParent;\n\n\tfunction updateTaskType(task, targetType) {\n\t\tif(!gantt.getState().group_mode){\n\t\t\ttask.type = targetType;\n\t\t\tgantt.updateTask(task.id);\n\t\t}\n\t}\n\n\tfunction getTaskTypeToUpdate(task) {\n\t\tvar allTypes = gantt.config.types;\n\t\tvar hasChildren = gantt.hasChild(task.id);\n\t\tvar taskType = gantt.getTaskType(task.type);\n\n\t\tif (hasChildren && taskType === allTypes.task) {\n\t\t\treturn allTypes.project;\n\t\t}\n\n\t\tif (!hasChildren && taskType === allTypes.project) {\n\t\t\treturn allTypes.task;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tvar isParsingDone = true;\n\n\tgantt.attachEvent(\"onParse\", callIfEnabled(function() {\n\t\tisParsingDone = false;\n\t\tif(gantt.getState().group_mode){\n\t\t\treturn;\n\t\t}\n\n\t\tgantt.batchUpdate(function() {\n\t\t\tgantt.eachTask(function(task) {\n\t\t\t\tvar targetType = getTaskTypeToUpdate(task);\n\t\t\t\tif (targetType !== false) {\n\t\t\t\t\tupdateTaskType(task, targetType);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\tisParsingDone = true;\n\t}));\n\n\tgantt.attachEvent(\"onAfterTaskAdd\", callIfEnabled(function(id) {\n\t\tif (isParsingDone) {\n\t\t\tupdateParentTypes(id);\n\t\t}\n\t}));\n\n\tgantt.attachEvent(\"onAfterTaskUpdate\", callIfEnabled(function(id) {\n\t\tif (isParsingDone) {\n\t\t\tupdateParentTypes(id);\n\t\t}\n\t}));\n\n\tfunction updateAfterRemoveChild(id){\n\t\tif (id != gantt.config.root_id && gantt.isTaskExists(id)) {\n\t\t\tupdateParentTypes(id);\n\t\t}\n\t}\n\n\tgantt.attachEvent(\"onBeforeTaskDelete\", callIfEnabled(function(id, task) {\n\t\tdelTaskParent = gantt.getParent(id);\n\t\treturn true;\n\t}));\n\n\tgantt.attachEvent(\"onAfterTaskDelete\", callIfEnabled(function(id, task) {\n\t\tupdateAfterRemoveChild(delTaskParent);\n\t}));\n\n\n\tvar originalRowDndParent;\n\n\tgantt.attachEvent(\"onRowDragStart\", callIfEnabled(function(id, target, e) {\n\t\toriginalRowDndParent = gantt.getParent(id);\n\t\treturn true;\n\t}));\n\n\tgantt.attachEvent(\"onRowDragEnd\", callIfEnabled(function(id, target) {\n\t\tupdateAfterRemoveChild(originalRowDndParent);\n\t\tupdateParentTypes(id);\n\t}));\n\n\tvar originalMoveTaskParent;\n\n\tgantt.attachEvent(\"onBeforeTaskMove\", callIfEnabled(function(sid, parent, tindex) {\n\t\toriginalMoveTaskParent = gantt.getParent(sid);\n\t\treturn true;\n\t}));\n\n\tgantt.attachEvent(\"onAfterTaskMove\", callIfEnabled(function(id, parent, tindex) {\n\t\tif (document.querySelector(\".gantt_drag_marker\")) {\n\t\t\t// vertical dnd in progress\n\t\t\treturn;\n\t\t}\n\t\tupdateAfterRemoveChild(originalMoveTaskParent);\n\t\tupdateParentTypes(id);\n\t}));\n};","interface IFormatterTransfer {\n\ttoMinutes: (value: number) => number;\n\tfromMinutes: (value: number) => number;\n}\n\nexport default class DurationFormatter implements IDurationFormatter {\n\tstatic create = (settings: IDurationFormatterConfig = null): IDurationFormatter => {\n\t\treturn new DurationFormatter(settings);\n\t};\n\tprotected transferUnits: { [unit: string]: IFormatterTransfer };\n\tprotected _config: IDurationFormatterConfig;\n\tconstructor(settings: IDurationFormatterConfig = null) {\n\n\t\tthis._config = this._defaultSettings(settings);\n\t\tthis.transferUnits = {\n\t\t\tminute: {\n\t\t\t\ttoMinutes: (value: number) => {\n\t\t\t\t\treturn value;\n\t\t\t\t},\n\t\t\t\tfromMinutes: (value: number) => {\n\t\t\t\t\treturn value;\n\t\t\t\t}\n\t\t\t},\n\t\t\thour: {\n\t\t\t\ttoMinutes: (value: number) => {\n\t\t\t\t\treturn value * this._config.minutesPerHour;\n\t\t\t\t},\n\t\t\t\tfromMinutes: (value: number) => {\n\t\t\t\t\treturn value / this._config.minutesPerHour;\n\t\t\t\t}\n\t\t\t},\n\t\t\tday: {\n\t\t\t\ttoMinutes: (value: number) => {\n\t\t\t\t\treturn value * this._config.minutesPerHour * this._config.hoursPerDay;\n\t\t\t\t},\n\t\t\t\tfromMinutes: (value: number) => {\n\t\t\t\t\treturn value / (this._config.minutesPerHour * this._config.hoursPerDay);\n\t\t\t\t}\n\t\t\t},\n\t\t\tweek: {\n\t\t\t\ttoMinutes: (value: number) => {\n\t\t\t\t\treturn value * this._config.minutesPerHour * this._config.hoursPerWeek;\n\t\t\t\t},\n\t\t\t\tfromMinutes: (value: number) => {\n\t\t\t\t\treturn value / (this._config.minutesPerHour * this._config.hoursPerWeek);\n\t\t\t\t}\n\t\t\t},\n\t\t\tmonth: {\n\t\t\t\ttoMinutes: (value: number) => {\n\t\t\t\t\treturn value * this._config.minutesPerHour * this._config.hoursPerDay * this._config.daysPerMonth;\n\t\t\t\t},\n\t\t\t\tfromMinutes: (value: number) => {\n\t\t\t\t\treturn value / (this._config.minutesPerHour * this._config.hoursPerDay * this._config.daysPerMonth);\n\t\t\t\t}\n\t\t\t},\n\t\t\tyear: {\n\t\t\t\ttoMinutes: (value: number) => {\n\t\t\t\t\treturn value * this._config.minutesPerHour * this._config.hoursPerDay * this._config.daysPerYear;\n\t\t\t\t},\n\t\t\t\tfromMinutes: (value: number) => {\n\t\t\t\t\treturn value / (this._config.minutesPerHour * this._config.hoursPerDay * this._config.daysPerYear);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}\n\n\tcanParse = (value: string) : boolean => {\n\t\tlet units = \"\";\n\t\t// create all possible unit names\n\t\tconst labels = this._config.labels;\n\t\tfor(const labelName in labels){\n\t\t\tconst label = labels[labelName];\n\t\t\tunits += `${label.full}|${label.plural}|${label.short}|`;\n\t\t}\n\t\tconst reg = new RegExp(`^([+\\-]? *[0-9\\.]{1,}\\\\s*(${units})\\\\s*)*$`); // model looks like: 4h 20 minute\n\t\treturn reg.test((value||\"\").trim());\n\t};\n\n\tformat = (value:number) : string => {\n\n\t\tconst durationUnit = this._config.store;\n\t\tconst formatUnits = this._config.format;\n\t\tconst useShortLabels = this._config.short;\n\n\t\tlet totalMinutes = this.transferUnits[durationUnit]\n\t\t\t.toMinutes(value);\n\n\t\tlet units = formatUnits;\n\t\tif(units && units === \"auto\") {\n\t\t\tunits = this._selectFormatForValue(totalMinutes);\n\t\t}\n\t\tif(!units) {\n\t\t\tunits = \"day\";\n\t\t}\n\n\t\tif(formatUnits === \"auto\" && !value){\n\t\t\treturn \"\";\n\t\t}\n\t\tunits = Array.isArray(units) ? units : [units];\n\t\tlet result = \"\";\n\t\tconst last = units.length - 1;\n\t\tfor(let i = 0; i < units.length; i++){\n\t\t\tconst unit = units[i];\n\t\t\tconst countedValue = this._getValueFromMinutes(totalMinutes, unit, i === last);\n\t\t\ttotalMinutes -= this._getValueInMinutes(countedValue, unit);\n\n\t\t\tresult += `${this._getLabelForConvert(countedValue, unit, useShortLabels)}${i === last ? \"\" : \" \"}`;\n\t\t}\n\t\treturn result;\n\t};\n\n\tparse = (value: string) : number => {\n\t\tif(this.canParse(value)){\n\t\t\tvalue = (value||\"\").trim();\n\t\t\tlet part = \"\";\n\t\t\tlet isPartReady = false;\n\t\t\tlet needToParse = false;\n\t\t\tlet result = 0;\n\t\t\tconst last = value.length - 1;\n\t\t\tconst isNumber = /^[+\\-0-9\\. ]$/; // numbers and .;\n\n\t\t\tfor(let i = 0; i < value.length; i++){\n\t\t\t\tconst symbol = value[i];\n\t\t\t\tif(isNumber.test(symbol)){\n\t\t\t\t\t// found the next number. can parse the part of value\n\t\t\t\t\tneedToParse = isPartReady;\n\t\t\t\t} else {\n\t\t\t\t\t// the number is over. letters in turn. find the next number to get whole unit name\n\t\t\t\t\tisPartReady = true;\n\t\t\t\t}\n\n\t\t\t\t// parse the part of number or the resulting part, if the last element\n\t\t\t\tif(needToParse || last === i){\n\t\t\t\t\t// add the last symbol to the part if the last element\n\t\t\t\t\tif(!needToParse) {\n\t\t\t\t\t\tpart += symbol;\n\t\t\t\t\t}\n\n\t\t\t\t\t// parse the part to minutes\n\t\t\t\t\tresult += this._getNumericValue(part);\n\t\t\t\t\tisPartReady = needToParse = false;\n\t\t\t\t\tpart = \"\";\n\t\t\t\t}\n\t\t\t\tpart += symbol;\n\t\t\t}\n\t\t\tif(result){\n\t\t\t\tconst durationUnit = this._config.store;\n\t\t\t\treturn Math.round(this.transferUnits[durationUnit]\n\t\t\t\t\t.fromMinutes(Math.ceil(result)));\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t};\n\n\tprotected _defaultSettings(settings: IDurationFormatterConfig = null){\n\t\tconst preparedSettings: IDurationFormatterConfig = {\n\t\t\tenter: \"day\",\n\t\t\tstore: \"hour\",\n\t\t\tformat: \"auto\",\n\t\t\tshort: false,\n\t\t\tminutesPerHour: 60,\n\t\t\thoursPerDay: 8,\n\t\t\thoursPerWeek: 40,\n\t\t\tdaysPerMonth: 30,\n\t\t\tdaysPerYear: 365,\n\t\t\tlabels: {\n\t\t\t\tminute: {\n\t\t\t\t\tfull: \"minute\",\n\t\t\t\t\tplural: \"minutes\",\n\t\t\t\t\tshort: \"min\"\n\t\t\t\t},\n\t\t\t\thour: {\n\t\t\t\t\tfull: \"hour\",\n\t\t\t\t\tplural: \"hours\",\n\t\t\t\t\tshort: \"h\"\n\t\t\t\t},\n\t\t\t\tday: {\n\t\t\t\t\tfull: \"day\",\n\t\t\t\t\tplural: \"days\",\n\t\t\t\t\tshort: \"d\"\n\t\t\t\t},\n\t\t\t\tweek: {\n\t\t\t\t\tfull: \"week\",\n\t\t\t\t\tplural: \"weeks\",\n\t\t\t\t\tshort: \"wk\"\n\t\t\t\t},\n\t\t\t\tmonth: {\n\t\t\t\t\tfull: \"month\",\n\t\t\t\t\tplural: \"months\",\n\t\t\t\t\tshort: \"mon\"\n\t\t\t\t},\n\t\t\t\tyear: {\n\t\t\t\t\tfull: \"year\",\n\t\t\t\t\tplural: \"years\",\n\t\t\t\t\tshort: \"y\"\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tif(settings){\n\t\t\tfor(const i in settings){\n\t\t\t\tif(settings[i] !== undefined && i !== \"labels\") {\n\t\t\t\t\tpreparedSettings[i] = settings[i];\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(settings.labels){\n\t\t\t\tfor(const i in settings.labels) {\n\t\t\t\t\tpreparedSettings.labels[i] = settings.labels[i];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn preparedSettings;\n\n\t}\n\n\tprotected _selectFormatForValue(value: number): string {\n\t\tconst units = [\"year\",\"month\",\"day\",\"hour\",\"minute\"];\n\t\tconst values = [];\n\t\tfor(let i = 0; i < units.length; i++) {\n\t\t\tvalues[i] = Math.abs(this.transferUnits[units[i]].fromMinutes(value));\n\t\t}\n\n\t\tfor(let i = 0; i < values.length; i++) {\n\t\t\tconst valueInUnit = values[i];\n\t\t\tif(valueInUnit < 1 && i < values.length - 1){\n\t\t\t\tcontinue;\n\t\t\t} else {\n\t\t\t\treturn units[i];\n\t\t\t}\n\t\t}\n\n\t\treturn \"day\";\n\t}\n\n\tprotected _getNumericValue(value: string) : number {\n\t\tconst numericValue = parseFloat(value.replace(/ /g, \"\")) || 0;\n\t\tconst lettersValue = value.match(/\\p{L}/gu) ? value.match(/\\p{L}/gu).join(\"\") : \"\";\n\t\tconst unitName = this._getUnitName(lettersValue); // leave only letters\n\n\t\tif(!numericValue || !unitName){\n\t\t\treturn 0;\n\t\t}\n\n\t\treturn this._getValueInMinutes(numericValue, unitName);\n\t}\n\n\tprotected _getValueInMinutes = (value: number, unit: string) => {\n\t\tif(this.transferUnits[unit] && this.transferUnits[unit].toMinutes){\n\t\t\treturn this.transferUnits[unit].toMinutes(value);\n\t\t}\n\t\treturn 0;\n\t};\n\n\tprotected _getLabelForConvert = (value: number, unit: string, short: boolean) : string => {\n\t\tconst labels = this._config.labels;\n\t\tconst label = labels[unit];\n\t\tif(short){\n\t\t\treturn `${value}${label.short}`;\n\t\t}\n\t\tconst plural = (value !== 1 && value !== -1);\n\t\treturn `${value} ${plural ? label.plural : label.full}`;\n\t};\n\n\tprotected _getValueFromMinutes = (value: number, unit: string, last: boolean) : number => {\n\t\tif(this.transferUnits[unit] && this.transferUnits[unit].fromMinutes){\n\t\t\tconst result = this.transferUnits[unit].fromMinutes(value);\n\n\t\t\tif(last){\n\t\t\t\treturn parseFloat(result.toFixed(2));\n\t\t\t}\n\t\t\treturn parseInt(result.toString(), 10);\n\t\t}\n\t\treturn null;\n\t};\n\n\tprotected _isUnitName = (unit: any, value: string) : boolean => {\n\t\tvalue = value.toLowerCase();\n\t\treturn unit.full.toLowerCase() === value\n\t\t\t|| unit.plural.toLowerCase() === value\n\t\t\t|| unit.short.toLowerCase() === value;\n\t};\n\n\tprotected _getUnitName = (value: string) : string => {\n\t\tconst labels = this._config.labels;\n\t\tlet labelName: string;\n\t\tlet isUnit = false;\n\t\tfor(labelName in labels){\n\t\t\tif(this._isUnitName(labels[labelName], value)){\n\t\t\t\tisUnit = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif(isUnit){\n\t\t\treturn labelName;\n\t\t}\n\t\treturn this._config.enter;\n\t};\n}","export default class LinkFormatterSimple implements ILinkFormatter {\n\tstatic create = (settings: ILinkFormatterConfig = null, gantt: any): LinkFormatterSimple => {\n\t\treturn new LinkFormatterSimple(gantt);\n\t};\n\tprotected _linkReg: RegExp;\n\tprotected _gantt: any;\n\n\tconstructor(gantt: any) {\n\t\tthis._linkReg = /^[0-9\\.]+/;\n\t\tthis._gantt = gantt;\n\t}\n\n\tformat = (link: ILink) : string => {\n\t\tconst wbs = this._getWBSCode(link.source);\n\t\treturn wbs;\n\t};\n\n\tcanParse = (value: string) : boolean => {\n\t\treturn this._linkReg.test(value);\n\t};\n\tparse = (value: string) : ILink => {\n\t\tif(!this.canParse(value)){\n\t\t\treturn null;\n\t\t}\n\n\t\tconst linkPart = this._linkReg.exec(value)[0].trim();\n\n\t\tconst source = this._findSource(linkPart) || null;\n\n\t\treturn {\n\t\t\tid: undefined,\n\t\t\tsource,\n\t\t\ttarget: null,\n\t\t\ttype: this._gantt.config.links.finish_to_start,\n\t\t\tlag: 0\n\t\t};\n\t};\n\n\tprotected _getWBSCode = (source: number | string) => {\n\t\tconst pred = this._gantt.getTask(source);\n\t\treturn this._gantt.getWBSCode(pred);\n\t};\n\n\tprotected _findSource = (value: string) => {\n\t\tconst reqTemplate = new RegExp(\"^[0-9\\.]+\", \"i\");\n\t\tif(reqTemplate.exec(value)){\n\t\t\tconst wbs = reqTemplate.exec(value)[0];\n\t\t\tconst task = this._gantt.getTaskByWBSCode(wbs);\n\t\t\tif(task){\n\t\t\t\treturn task.id;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t};\n}","import LinkFormatterSimple from \"./link_formatter_simple\";\n\nexport default class LinkFormatter extends LinkFormatterSimple implements ILinkFormatter {\n\tstatic create = (settings: ILinkFormatterConfig = null, gantt: any): LinkFormatter => {\n\t\treturn new LinkFormatter(settings, gantt);\n\t};\n\tprotected _config: ILinkFormatterConfig;\n\n\tconstructor(settings: ILinkFormatterConfig, gantt: any) {\n\t\tsuper(gantt);\n\t\tthis._config = this._defaultSettings(settings);\n\t\tthis._linkReg = /^[0-9\\.]+[a-zA-Z]*/;\n\t}\n\n\tformat = (link: ILink) : string => {\n\t\tconst formattedType = this._getFormattedLinkType(this._getLinkTypeName(link.type));\n\t\tconst wbs = this._getWBSCode(link.source);\n\t\tconst lag = this._getLagString(link.lag);\n\n\t\tif(link.type === this._gantt.config.links.finish_to_start && !link.lag){\n\t\t\treturn wbs;\n\t\t}else{\n\t\t\treturn `${wbs}${formattedType}${lag}`;\n\t\t}\n\t};\n\n\tparse = (value: string) : ILink => {\n\t\tif(!this.canParse(value)){\n\t\t\treturn null;\n\t\t}\n\n\t\tconst linkPart = this._linkReg.exec(value)[0].trim();\n\t\tconst lagPart = value.replace(linkPart, \"\").trim();\n\n\t\tconst typeFormat = this._findTypeFormat(linkPart);\n\t\tconst typeNumber = this._getLinkTypeNumber(typeFormat);\n\t\tconst source = this._findSource(linkPart) || null;\n\t\tconst lag = this._parseLag(lagPart);\n\n\t\treturn {\n\t\t\tid: undefined,\n\t\t\tsource,\n\t\t\ttarget: null,\n\t\t\ttype: typeNumber,\n\t\t\tlag\n\t\t};\n\t};\n\n\tprotected _defaultSettings(settings: ILinkFormatterConfig = null) : ILinkFormatterConfig{\n\t\tconst preparedSettings: ILinkFormatterConfig = {\n\t\t\tdurationFormatter: this._gantt.ext.formatters.durationFormatter(),\n\t\t\tlabels: {\n\t\t\t\tfinish_to_finish: \"FF\",\n\t\t\t\tfinish_to_start: \"FS\",\n\t\t\t\tstart_to_start: \"SS\",\n\t\t\t\tstart_to_finish: \"SF\"\n\t\t\t}\n\t\t};\n\n\t\tif(settings && settings.durationFormatter){\n\t\t\tpreparedSettings.durationFormatter = settings.durationFormatter;\n\t\t}\n\n\t\tif(settings && settings.labels){\n\t\t\tfor(const i in settings.labels){\n\t\t\t\tpreparedSettings.labels[i] = settings.labels[i];\n\t\t\t}\n\t\t}\n\t\treturn preparedSettings;\n\t}\n\n\tprotected _getLinkTypeName = (value: string) => {\n\t\tlet linkName = \"\";\n\t\tfor(linkName in this._config.labels){\n\t\t\tif(String(this._gantt.config.links[linkName]).toLowerCase() === String(value).toLowerCase()){\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn linkName;\n\t};\n\n\tprotected _getLinkTypeNumber = (value: string) => {\n\t\tlet linkName = \"\";\n\t\tfor(linkName in this._gantt.config.links){\n\t\t\tif(linkName.toLowerCase() === value.toLowerCase()){\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn this._gantt.config.links[linkName];\n\t};\n\n\tprotected _getFormattedLinkType = (name: string) => {\n\t\treturn this._config.labels[name] || \"\";\n\t};\n\n\tprotected _getLagString = (lag: number) => {\n\t\tif(!lag){\n\t\t\treturn \"\";\n\t\t}\n\n\t\tconst formatted = this._config.durationFormatter.format(lag);\n\t\tif(lag < 0) {\n\t\t\treturn formatted;// -3 days\n\t\t}else{\n\t\t\treturn `+${formatted}`;// + 3 days\n\t\t}\n\t};\n\n\tprotected _findTypeFormat = (value: string) => {\n\t\tconst format = value.replace(/[^a-zA-Z]/gi, \"\"); // leave only letters\n\t\tlet name = \"finish_to_start\";\n\t\tfor(const i in this._config.labels){\n\t\t\tif(this._config.labels[i].toLowerCase() === format.toLowerCase()){\n\t\t\t\tname = i;\n\t\t\t}\n\t\t}\n\t\treturn name;\n\t};\n\n\tprotected _parseLag = (value: string) => {\n\t\tif(!value){\n\t\t\treturn 0;\n\t\t}\n\t\treturn this._config.durationFormatter.parse(value);\n\t};\n}","\nimport DurationFormatter from \"../common/duration_formatter\";\nimport LinkFormatter from \"../common/link_formatter\";\n\nexport default function(gantt){\n\tgantt.ext.formatters = {\n\t\tdurationFormatter: function(settings){\n\t\t\tif(!settings){\n\t\t\t\tsettings = {};\n\t\t\t}\n\t\t\tif(!settings.store){\n\t\t\t\tsettings.store = gantt.config.duration_unit;\n\t\t\t}\n\t\t\tif(!settings.enter){\n\t\t\t\tsettings.enter = gantt.config.duration_unit;\n\t\t\t}\n\t\t\treturn DurationFormatter.create(settings, gantt);\n\t\t},\n\t\tlinkFormatter: function(settings){\n\t\t\treturn LinkFormatter.create(settings, gantt);\n\t\t}\n\t};\n};","export default function(gantt: any){\n\n\tgantt.ext = gantt.ext || {};\n\tgantt.config.show_empty_state = false;\n\n\tgantt.ext.emptyStateElement = gantt.ext.emptyStateElement || {\n\t\tisEnabled() {\n\t\t\treturn gantt.config.show_empty_state === true;\n\t\t},\n\t\tisGanttEmpty(){\n\t\t\treturn !gantt.getTaskByTime().length;\n\t\t},\n\t\trenderContent(container){\n\t\t\tconst placeholderTextElement = `<div class='gantt_empty_state_text'>\n    <div class='gantt_empty_state_text_link' data-empty-state-create-task>${gantt.locale.labels.empty_state_text_link}</div>\n    <div class='gantt_empty_state_text_description'>${gantt.locale.labels.empty_state_text_description}</div>\n    </div>`;\n\t\t\tconst placeholderImageElement = \"<div class='gantt_empty_state_image'></div>\";\n\n\t\t\tconst placeholderContainer = `<div class='gantt_empty_state'>${placeholderImageElement}${placeholderTextElement}</div>`;\n\t\t\tcontainer.innerHTML = placeholderContainer;\n\t\t},\n\n\t\tclickEvents: [],\n\t\tattachAddTaskEvent(){\n\t\t\tconst id = gantt.attachEvent(\"onEmptyClick\", function(e){\n\t\t\t\tconst domHelpers = gantt.utils.dom;\n\t\t\t\tconst gridPlaceholder = domHelpers.closest(e.target, \"[data-empty-state-create-task]\");\n\t\t\t\tif (gridPlaceholder){\n\t\t\t\t\tgantt.createTask({\n\t\t\t\t\t\tid: gantt.uid(),\n\t\t\t\t\t\ttext: \"New Task\"\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.clickEvents.push(id);\n\t\t},\n\t\tdetachAddTaskEvents(){\n\t\t\tthis.clickEvents.forEach(function(event){\n\t\t\t\tgantt.detachEvent(event);\n\t\t\t});\n\t\t\tthis.clickEvents = [];\n\t\t},\n\n\t\tgetContainer(){\n\t\t\tif (gantt.$container) {\n\t\t\t\tconst domHelpers = gantt.utils.dom;\n\t\t\t\tif (gantt.$container.contains(gantt.$grid_data)) {\n\t\t\t\t\treturn domHelpers.closest(gantt.$grid_data, \".gantt_layout_content\");\n\t\t\t\t}\n\t\t\t\tif (gantt.$container.contains(gantt.$task_data)){\n\t\t\t\t\treturn domHelpers.closest(gantt.$task_data, \".gantt_layout_content\");\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\n\t\tgetNode(){\n\t\t\tconst container = this.getContainer();\n\t\t\tif (!container){\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tconst emptyStateElementNode = container.querySelector(\".gantt_empty_state_wrapper\");\n\t\t\treturn emptyStateElementNode;\n\t\t},\n\n\t\tshow(){\n\t\t\tconst container = this.getContainer();\n\t\t\tif (!container && this.isGanttEmpty()){\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tconst wrapper = document.createElement(\"div\");\n\t\t\twrapper.className = \"gantt_empty_state_wrapper\";\n\t\t\twrapper.style.marginTop = (gantt.config.scale_height - container.offsetHeight) + \"px\";\n\t\t\tconst oldNodes = gantt.$container.querySelectorAll(\".gantt_empty_state_wrapper\");\n\t\t\t// for IE11\n\t\t\tArray.prototype.forEach.call(oldNodes, function(node){\n\t\t\t\tnode.parentNode.removeChild(node);\n\t\t\t});\n\n\t\t\tthis.detachAddTaskEvents();\n\t\t\tthis.attachAddTaskEvent();\n\n\t\t\tcontainer.appendChild(wrapper);\n\t\t\tthis.renderContent(wrapper);\n\t\t},\n\t\thide(){\n\t\t\tconst emptyStateElementNode = this.getNode();\n\t\t\tif (emptyStateElementNode){\n\t\t\t\temptyStateElementNode.parentNode.removeChild(emptyStateElementNode);\n\t\t\t} else{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t},\n\t\tinit(){ }\n\t};\n\n\tgantt.attachEvent(\"onDataRender\", function() {\n\t\tconst emptyStateElement = gantt.ext.emptyStateElement;\n\t\tif (emptyStateElement.isEnabled() && emptyStateElement.isGanttEmpty()) {\n\t\t\temptyStateElement.show();\n\t\t} else {\n\t\t\temptyStateElement.hide();\n\t\t}\n\t});\n\n\n\n\n}\n","export const hasBaselinesBelow = function (gantt, task) {\n  const baselines = task.baselines && task.baselines.length;\n  const baselinesOnDifferentRow = gantt.config.baselines.render_mode == \"separateRow\" || gantt.config.baselines.render_mode == \"individualRow\";\n  if (baselines && baselinesOnDifferentRow) {\n    return true;\n  }\n};\n\nexport const childrenHaveBaselines = function (gantt, taskId) {\n  let hasBaselines = false;\n  gantt.eachTask(function (child) {\n    if (hasBaselines) {\n      return;\n    }\n    hasBaselines = hasBaselinesBelow(gantt, child);\n  }, taskId);\n  return hasBaselines;\n};\n\nexport const isSplitChild = function (gantt, id) {\n  let splitChild = false;\n  gantt.eachParent(function (parent) {\n    if (isSplitParent(parent)) {\n      splitChild = true;\n    }\n  }, id);\n  return splitChild;\n};\n\nexport const isSplitParent = function (task) {\n  return task.render && task.render == \"split\" && !task.$open;\n};\n\nexport const getMaxParentHeight = function (gantt, view, task, heightLimit) {\n  let maxHeight = heightLimit || view.$task_data.scrollHeight;\n  let shrinkHeight = false;\n  let splitChild = false;\n\n  gantt.eachParent(function (parent) {\n    if (isSplitParent(parent)) {\n      splitChild = true;\n      const parentSizes = view.getItemPosition(parent);\n      const parentHeight = parentSizes.rowHeight;\n      if (parentHeight < maxHeight) {\n        maxHeight = parentHeight;\n        shrinkHeight = true;\n      }\n    }\n  }, task.id);\n\n  return { maxHeight, shrinkHeight, splitChild };\n};\n\nexport const getMilestoneHeight = function (height) {\n  return Math.sqrt(2 * height * height);\n};\n\nexport const getInvertedMilestoneHeight = function (height) {\n  return Math.round(height / Math.sqrt(2));\n};\n\nexport const getAdjustedPosition = function (gantt, timeline, sizes, heightLimit, task, childBaselines) {\n  const baselines = hasBaselinesBelow(gantt, task);\n\n  const splitParams = getMaxParentHeight(gantt, timeline, task);\n  let maxHeight = splitParams.maxHeight;\n\n  let height = sizes.height;\n  let largerHeight = height > heightLimit;\n  let noNeedToShrink = sizes.rowHeight >= heightLimit && !splitParams.splitChild && !baselines;\n  if (largerHeight || noNeedToShrink) {\n    height = heightLimit;\n  }\n\n  if (maxHeight < height) {\n    height = maxHeight;\n  }\n\n  let marginTop = Math.floor((sizes.rowHeight - height) / 2);\n\n  if (splitParams.splitChild) {\n    marginTop = Math.floor((maxHeight - height) / 2);\n  }\n  if (childBaselines || baselines) {\n    let heightDiff = Math.min(sizes.height, maxHeight) - height;\n\n    let additionalMargin = 2;\n    let exceedBarHeight = baselines && task.bar_height >= task.row_height;\n    let exceedParentHeight = splitParams.splitChild && sizes.height >= maxHeight;\n    if (exceedBarHeight || exceedParentHeight){\n      additionalMargin = 0;\n    }\n\n    marginTop = Math.floor(heightDiff / 2) + additionalMargin;\n    const bottom = height + marginTop;\n    if (bottom > sizes.rowHeight || bottom > maxHeight) {\n      // marginTop = 0;\n    }\n  }\n\n  return { height, marginTop };\n};\n\nexport default {\n  hasBaselinesBelow,\n  childrenHaveBaselines,\n  isSplitChild,\n  isSplitParent,\n  getMaxParentHeight,\n  getMilestoneHeight,\n  getInvertedMilestoneHeight,\n  getAdjustedPosition\n};\n","import { hasBaselinesBelow, isSplitParent } from \"../ui/render/baseline_helper\";\nimport isHeadless from \"../../utils/is_headless\";\n\nexport default function (gantt) {\n  gantt.config.baselines = {\n    datastore: \"baselines\",\n    render_mode: false,\n    dataprocessor_baselines: false,\n    row_height: 16,\n    bar_height: 8\n  };\n\n  function initBaselineFields(item, task) {\n    // don't add baseline if it doesn't belong to any task\n    // or if doesn't have the dates\n    if (!item.task_id || (!item.start_date && !item.end_date)) {\n      return false;\n    }\n\n    if (item.start_date) {\n      item.start_date = gantt.date.parseDate(item.start_date, \"parse_date\");\n    } else {\n      item.start_date = null;\n    }\n\n    if (item.end_date) {\n      item.end_date = gantt.date.parseDate(item.end_date, \"parse_date\");\n    } else {\n      item.end_date = null;\n    }\n\n    // set min baseline duration\n    item.duration = item.duration || 1;\n\n    // GS-2636. Calculate the 3rd date parameter basing on existing date parameters\n    if (item.start_date && !item.end_date){\n      item.end_date = gantt.calculateEndDate(item.start_date, item.duration);\n    } else if (item.end_date && !item.start_date){\n      item.start_date = gantt.calculateEndDate(item.end_date, -item.duration);\n    } \n  }\n  // gantt init\n  const baselineStore = gantt.createDatastore({\n    name: gantt.config.baselines.datastore,\n    initItem: function (item) {\n      if (!item.id) {\n        item.id = gantt.uid();\n      }\n\n      initBaselineFields(item);\n\n      return item;\n    }\n  });\n\n  gantt.$data.baselineStore = baselineStore;\n\n  function _syncBaselines(task) {\n    let shouldRepaint = false;\n    const iteratedBaselines = {};\n\n    const taskBaselines = task.baselines || [];\n    const exisingBaselines = gantt.getTaskBaselines(task.id);\n\n    if (taskBaselines.length != exisingBaselines.length) {\n      shouldRepaint = true;\n    }\n\n    taskBaselines.forEach(function (baseline) {\n      iteratedBaselines[baseline.id] = true;\n      const exisingBaseline = baselineStore.getItem(baseline.id);\n      if (exisingBaseline) {\n        const start = +exisingBaseline.start_date !== +baseline.start_date;\n        const end = +exisingBaseline.end_date !== +baseline.end_date;\n        if (start || end) {\n          baselineStore.updateItem(baseline.id, baseline);\n        }\n      } else {\n        baselineStore.addItem(baseline);\n      }\n    });\n\n    exisingBaselines.forEach(function (baseline) {\n      if (!iteratedBaselines[baseline.id]) {\n        baselineStore.removeItem(baseline.id);\n      }\n    });\n\n    if (shouldRepaint) {\n      if (isSplitParent(task)){\n        // here we adjust the parent height, then adjust it with the total child height\n        _adjustSplitParentHeight (task);\n      } else {\n        gantt.adjustTaskHeightForBaselines(task);\n      }\n      gantt.render();\n    }\n  }\n\n  function _deleteOrphanBaselines() {\n    baselineStore.eachItem(function (baseline) {\n      if (!gantt.isTaskExists(baseline.task_id)) {\n        baselineStore.removeItem(baseline.id);\n      }\n    });\n  }\n\n  function _adjustSplitParentHeight (task){\n    let maxParentHeight = 0;\n\n    gantt.adjustTaskHeightForBaselines(task);\n\n    gantt.eachTask(function(child){\n      let childHeight = child.row_height || gantt.config.row_height;\n\n      maxParentHeight = maxParentHeight || childHeight;\n      if (childHeight > maxParentHeight){\n        maxParentHeight = childHeight;\n      }\n    }, task.id);\n\n    if (task.row_height < maxParentHeight){\n      task.row_height = maxParentHeight;\n    }\n  }\n\n  gantt.adjustTaskHeightForBaselines = function (task) {\n    let height, baselineSize, betweenBaselines;\n    let margins = 2;\n    let baselineAmount = task.baselines && task.baselines.length || 0;\n    const subrowHeight = gantt.config.baselines.row_height;\n    //const baselineBarHeight = task?.baselines.bar_height\n\n    const timelineView = gantt.getLayoutView(\"timeline\");\n    if (!timelineView || !gantt.config.show_chart){\n      return;\n    }\n\n    switch (gantt.config.baselines.render_mode) {\n      case \"taskRow\":\n        task.row_height = task.bar_height + 8;\n        break;\n\n      case \"separateRow\":\n        height = timelineView.getBarHeight(task.id);\n        if (baselineAmount) {\n          task.bar_height = task.bar_height || height;\n\n          if (task.bar_height > height){\n            height = task.bar_height;\n          }\n\n          task.row_height = height + subrowHeight;\n        } else if (task.bar_height) {\n          task.row_height = task.bar_height + 4;\n        }\n\n        _increaseSplitParentHeight(task);\n        break;\n\n      case \"individualRow\":\n        height = timelineView.getBarHeight(task.id);\n\n        if (baselineAmount) {\n          task.bar_height = task.bar_height || height;\n\n          if (task.bar_height > height){\n            height = task.bar_height;\n          }\n\n          baselineSize = subrowHeight * baselineAmount;\n       //   betweenBaselines = 3 * (baselineAmount + 1);\n\n          task.row_height = height + baselineSize + margins;\n        } else if (task.bar_height){\n          task.row_height = task.bar_height + 4;\n        }\n\n        _increaseSplitParentHeight(task);\n        break;\n      default:\n        task.row_height = task.bar_height + 8;\n        break;\n    }\n  };\n\n  function _increaseSplitParentHeight(task) {\n    gantt.eachParent(function (parent) {\n      if (isSplitParent(parent)) {\n        const parentHeight = parent.row_height || gantt.getLayoutView(\"timeline\").getBarHeight(parent.id);\n        let maxHeight = task.row_height;\n\n        // iterate only direct children\n        const subtasks = gantt.getChildren(parent.id);\n        subtasks.forEach(function (subtaskId) {\n          const subtask = gantt.getTask(subtaskId);\n          if (subtask.id == task.id) {\n            return;\n          }\n          const subtaskHeight = subtask.row_height || gantt.getLayoutView(\"timeline\").getBarHeight(subtask.id);\n          maxHeight = maxHeight || subtaskHeight;\n          if (subtaskHeight > maxHeight) {\n            maxHeight = subtaskHeight;\n          }\n        });\n\n        parent.row_height = maxHeight;\n        parent.bar_height = parent.bar_height || parentHeight;\n      }\n    }, task.id);\n  }\n\n  gantt.attachEvent(\n    \"onGanttReady\",\n    function () {\n\n      if(!gantt.config.baselines){\n        return;\n      }\n\n      gantt.attachEvent(\"onParse\", function () {\n        baselineStore.eachItem(function (baseline) {\n          const taskId = baseline.task_id;\n          if (gantt.isTaskExists(taskId)) {\n            const task = gantt.getTask(taskId);\n\n            task.baselines = task.baselines || [];\n\n            let newBaseline = true;\n            for (let i = 0; i < task.baselines.length; i++) {\n              let existingBaseline = task.baselines[i];\n              if (existingBaseline.id == baseline.id){\n                newBaseline = false;\n                gantt.mixin(existingBaseline, baseline, true);\n                break;\n              }\n            }\n            if (newBaseline){\n              task.baselines.push(baseline);\n            }\n\n            if(!isHeadless(gantt)){\n              if (isSplitParent(task)){\n                _adjustSplitParentHeight (task);\n              } else {\n                gantt.adjustTaskHeightForBaselines(task);\n              }\n            }\n          }\n        });\n      });\n\n      gantt.attachEvent(\"onBeforeTaskUpdate\", function (id, task) {\n        _syncBaselines(task);\n        return true;\n      });\n\n      gantt.attachEvent(\"onAfterUndo\", function(action){\n        const baselinesRenderedBelow = gantt.config.baselines.render_mode == \"separateRow\" || gantt.config.baselines.render_mode == \"individualRow\";\n        if (baselinesRenderedBelow && action){\n          let repaint = false;\n          action.commands.forEach(function(command){\n            if (command.entity == \"task\"){\n              const taskId = command.value.id;\n              if (gantt.isTaskExists(taskId)){\n                const task = gantt.getTask(taskId);\n                if (task.parent && gantt.isTaskExists(task.parent)){\n                  const parent = gantt.getTask(task.parent);\n                  if (isSplitParent(parent)){\n                    _adjustSplitParentHeight (parent);\n                    repaint = true;\n                  }\n                }\n              }    \n            }\n          });\n          if (repaint){\n            gantt.render();\n          }\n        }\n      });\n\n      gantt.attachEvent(\"onAfterTaskDelete\", function (id, task) {\n        if (hasBaselinesBelow){\n          if (task.parent && gantt.isTaskExists(task.parent)){\n            const parent = gantt.getTask(task.parent);\n            if (isSplitParent(parent)){\n              _adjustSplitParentHeight (parent);\n            }\n          }\n        }\n        _deleteOrphanBaselines();\n      });\n\n      gantt.getTaskBaselines = function (taskId) {\n        const baselines = [];\n        baselineStore.eachItem(function (baseline) {\n          if (baseline.task_id == taskId) {\n            baselines.push(baseline);\n          }\n        });\n        return baselines;\n      };\n      gantt.$data.baselineStore.attachEvent(\"onClearAll\", function () {\n        gantt.eachTask(function(task){\n          if (task.baselines){\n            delete task.baselines;\n          }\n        });\n        // The data should not be repainted as otherwise it causes issues when we have resource \n        // assignments and group tasks. It should be fixed when we add a repaint stack\n        // gantt.refreshData();\n        return true;\n      });\n\n      gantt.$data.tasksStore.attachEvent(\"onClearAll\", function () {\n        baselineStore.clearAll();\n        return true;\n      });\n      gantt.attachEvent(\"onTaskIdChange\", function (id, new_id) {\n        const baselines = baselineStore.find(function (a) {\n          return a.task_id == id;\n        });\n        baselines.forEach(function (a) {\n          a.task_id = new_id;\n          baselineStore.updateItem(a.id);\n        });\n      });\n    },\n    { once: true }\n  );\n};\n","import { Client } from \"remote-client\";\n\nexport default class RemoteEvents {\n\tprotected _remote: any;\n\tprotected _ready: Promise<any>;\n\n\tconstructor(url: string, token: string) {\n\t\tconst remote = new Client({\n\t\t\turl,\n\t\t\ttoken\n\t\t});\n\n\t\t// temporary patch, as we do not want credentials\n\t\tremote.fetch = function (url: string, body?: BodyInit) {\n\t\t\tconst req: RequestInit = {\n\t\t\t\theaders: this.headers()\n\t\t\t};\n\t\t\tif (body) {\n\t\t\t\treq.method = \"POST\";\n\t\t\t\treq.body = body;\n\t\t\t}\n\n\t\t\treturn fetch(url, req).then(res => res.json());\n\t\t};\n\n\t\tthis._ready = remote.load().then(back => (this._remote = back));\n\t}\n\n\tprotected ready() {\n\t\treturn this._ready;\n\t}\n\n\tprotected on(name: string | any, handler?: any) {\n\t\tthis.ready().then(back => {\n\t\t\tif (typeof name === \"string\") back.on(name, handler);\n\t\t\telse {\n\t\t\t\tfor (const key in name) {\n\t\t\t\t\tback.on(key, name[key]);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n}\n","function createHandlers(gantt) {\n\tlet updateQueue = [];\n\tlet updateTimeout = null;\n\tconst UPDATE_DELAY = 50;\n\n\tfunction remoteUpdates(message) {\n\t\tif (!message || !message.type || !(message.task?.id || message.link?.id)) {\n\t\t\t// eslint-disable-next-line no-console\n\t\t\tconsole.error(\"Invalid message format:\", message);\n\t\t\treturn;\n\t\t}\n\n\t\tconst { type, task, link } = message;\n\t\tif ((task && gantt._dp._in_progress[task.id]) || (link && gantt._dp._in_progress[link.id])) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (type === \"add-task\") {\n\t\t\tfor (const id in gantt._dp._in_progress) {\n\t\t\t\tif (gantt._dp.getState(id) === \"inserted\") {\n\t\t\t\t\tgantt._dp.attachEvent(\"onFullSync\", function () {\n\t\t\t\t\t\tif (!gantt.isTaskExists(task.id)) {\n\t\t\t\t\t\t\tprocessUpdate(message);\n\t\t\t\t\t\t}\n\t\t\t\t\t}, { once: true });\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tupdateQueue.push(message);\n\t\tif (updateTimeout) clearTimeout(updateTimeout);\n\t\tupdateTimeout = setTimeout(processQueue, UPDATE_DELAY);\n\t}\n\n\tfunction processQueue() {\n\t\tif (updateQueue.length === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (updateQueue.length === 1) {\n\t\t\tprocessUpdate(updateQueue[0]);\n\t\t} else {\n\t\t\tgantt.batchUpdate(function () {\n\t\t\t\t\tupdateQueue.forEach(message => {\n\t\t\t\t\t\tprocessUpdate(message);\n\t\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\tupdateQueue = [];\n\t}\n\n\tfunction processUpdate(message) {\n\t\tconst { type, task, link } = message;\n\t\tswitch (type) {\n\t\t\tcase \"add-task\":\n\t\t\t\thandleAddTask(task);\n\t\t\t\tbreak;\n\t\t\tcase \"update-task\":\n\t\t\t\thandleUpdateTask(task);\n\t\t\t\tbreak;\n\t\t\tcase \"delete-task\":\n\t\t\t\thandleDeleteTask(task);\n\t\t\t\tbreak;\n\t\t\tcase \"add-link\":\n\t\t\t\thandleAddLink(link);\n\t\t\t\tbreak;\n\t\t\tcase \"update-link\":\n\t\t\t\thandleUpdateLink(link);\n\t\t\t\tbreak;\n\t\t\tcase \"delete-link\":\n\t\t\t\thandleDeleteLink(link);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tfunction ignore(code){\n\t\tif(gantt._dp){\n\t\t\tgantt._dp.ignore(code);\n\t\t}\n\t\telse {\n\t\t\tcode();\n\t\t}\n\t}\n\n\tfunction handleAddTask(taskData) {\n\t\tif (gantt.isTaskExists(taskData.id)) {\n\t\t\t// eslint-disable-next-line no-console\n\t\t\tconsole.warn(`Task with ID ${taskData.id} already exists. Skipping add.`);\n\t\t\treturn;\n\t\t}\n\n\t\ttaskData.start_date = gantt.templates.parse_date(taskData.start_date);\n\t\tif (taskData.end_date) taskData.end_date = gantt.templates.parse_date(taskData.end_date);\n\n\t\tignore(() => {\n\t\t\tgantt.addTask(taskData);\n\t\t});\n\n\t}\n\n\tfunction handleUpdateTask(taskData) {\n\t\tconst sid = taskData.id;\n\n\t\tif (!gantt.getTask(sid)) {\n\t\t\t// eslint-disable-next-line no-console\n\t\t\tconsole.warn(`Task with ID ${sid} does not exist. Skipping update.`);\n\t\t\treturn;\n\t\t}\n\n\t\tconst initTask = gantt.getDatastore(\"task\").$initItem.bind(gantt.getDatastore(\"task\"));\n\n\t\tconst existingTask = gantt.getTask(sid);\n\n\t\tignore(() => {\n\n\t\t\tconst remoteTask = initTask(taskData);\n\t\t\t\n\t\t\tfor (let key in remoteTask) {\n\t\t\t\texistingTask[key] = remoteTask[key];\n\t\t\t}\n\t\t\t//Object.assign(existingTask, taskData);\n\t\t//\texistingTask.start_date = gantt.templates.parse_date(taskData.start_date);\n\t\t\t//if (existingTask.end_date && taskData.end_date) { \n\t\t\t//\texistingTask.end_date = gantt.templates.parse_date(taskData.end_date);\n\t\t\tif (!remoteTask.end_date) {\n\t\t\t\texistingTask.end_date = gantt.calculateEndDate(existingTask);\n\t\t\t}\n\n\t\t\tgantt.updateTask(sid);\n\n\t\t\tif (sid !== taskData.id) {\n\t\t\t\tgantt.changeTaskId(sid, taskData.id);\n\t\t\t}\n\t\t});\n\n\t}\n\n\tfunction handleDeleteTask(taskData) {\n\t\tconst sid = taskData.id;\n\n\t\tif (!gantt.isTaskExists(sid)) {\n\t\t\treturn;\n\t\t}\n\n\t\tignore(() => {\n\t\t\tconst task = gantt.getTask(sid);\n\n\t\t\tif (task) {\n\t\t\t\t// handle unsaved edits in the lightbox\n\t\t\t\tif (gantt.getState().lightbox_id == sid) {\n\t\t\t\t\t//this._new_event = this._lightbox_id;\n\t\t\t\t\ttaskData.id = this._lightbox_id;\n\t\t\t\t\tlet currentTask = gantt.getTask(this._lightbox_id);\n\t\t\t\t\tcurrentTask = taskData;\n\t\t\t\t}\n\n\t\t\t\t// delete the task\n\t\t\t\tgantt.deleteTask(sid, true);\n\t\t\t}\n\n\t\t});\n\n\t}\n\n\tfunction handleAddLink(linkData) {\n\t\tif (gantt.isLinkExists(linkData.id)) {\n\t\t\t// eslint-disable-next-line no-console\n\t\t\tconsole.warn(`Link with ID ${linkData.id} already exists. Skipping add.`);\n\t\t\treturn;\n\t\t}\n\n\t\tignore(() => {\n\t\t\tgantt.addLink(linkData);\n\t\t});\n\n\t}\n\n\tfunction handleUpdateLink(linkData) {\n\t\tconst sid = linkData.id;\n\n\t\tif (!gantt.isLinkExists(sid)) {\n\t\t\t// eslint-disable-next-line no-console\n\t\t\tconsole.warn(`Link with ID ${sid} does not exist. Skipping update.`);\n\t\t\treturn;\n\t\t}\n\n\t\tconst existingLink= gantt.getLink(sid);\n\n\t\tignore(() => {\n\t\t\tObject.assign(existingLink, linkData);\n\t\t\tgantt.updateLink(sid);\n\n\t\t\tif (sid !== linkData.id) {\n\t\t\t\tgantt.changeLinkId(sid, linkData.id);\n\t\t\t}\n\t\t});\n\n\t}\n\n\tfunction handleDeleteLink(linkData) {\n\t\tconst sid = linkData.id;\n\n\t\tif (!gantt.getLink(sid)) {\n\t\t\treturn;\n\t\t}\n\n\t\tignore(() => {\n\t\t\tconst task = gantt.getLink(sid);\n\n\t\t\tif (task) {\n\t\t\t\t// handle unsaved edits in the lightbox\n\t\t\t\tif (gantt.getState().lightbox_id == sid) {\n\t\t\t\t\t//this._new_event = this._lightbox_id;\n\t\t\t\t\tlinkData.id = this._lightbox_id;\n\t\t\t\t\tlet currentTask = gantt.getLink(this._lightbox_id);\n\t\t\t\t\tcurrentTask = linkData;\n\t\t\t\t}\n\n\t\t\t\t// delete the link\n\t\t\t\tgantt.deleteLink(sid, true);\n\t\t\t}\n\n\t\t});\n\n\t}\n\n\treturn {\n\t\ttasks: remoteUpdates,\n\t\tlinks: remoteUpdates\n\t};\n}\n\nexport default createHandlers;","import RemoteEvents from \"./remote_events\";\nimport createHandlers from \"./handlers\";\n\nexport default function remoteEvents(gantt) {\n\tif (!gantt.ext){\n\t\tgantt.ext = {};\n\t}\n\n\tgantt.ext.liveUpdates = {\n\t\tRemoteEvents,\n\t\tremoteUpdates: createHandlers(gantt)\n\t};\n}\n\n","import quickPositionHelperFactory from \"./row_position_fixed_height\";\n\nfunction createMixin(view){\n\tvar getItemTopCache = {};\n\tvar getRowTopCache = {};\n\tvar getItemHeightCache = null;\n\tvar totalHeightCache = -1;\n\tvar getItemHeightCacheState = null;\n\n\tvar quickPosition = quickPositionHelperFactory(view);\n\n\treturn {\n\t\t_resetTopPositionHeight: function(){\n\t\t\tgetItemTopCache = {};\n\t\t\tgetRowTopCache = {};\n\t\t\tquickPosition.resetCache();\n\t\t},\n\t\t_resetHeight: function(){\n\t\t\tvar store = this.$config.rowStore;\n\t\t\tvar newState = this.getCacheStateTotalHeight(store);\n\t\t\tif(!getItemHeightCacheState){\n\t\t\t\tgetItemHeightCacheState = newState;\n\t\t\t}else if(this.shouldClearHeightCache(getItemHeightCacheState, newState)){\n\t\t\t\tgetItemHeightCacheState = newState;\n\t\t\t\tgetItemHeightCache = null;\n\t\t\t}\n\n\t\t\ttotalHeightCache = -1;\n\t\t\tquickPosition.resetCache();\n\t\t},\n\n\t\t/**\n\t\t * Get top coordinate by row index (order)\n\t\t * @param {number} index\n\t\t */\n\t\tgetRowTop: function(index){\n\t\t\tif(quickPosition.canUseSimpleCalculation()){\n\t\t\t\treturn quickPosition.getRowTop(index);\n\t\t\t}\n\n\t\t\tvar store = this.$config.rowStore;\n\t\t\tif(!store){\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tif(getRowTopCache[index] !== undefined){\n\t\t\t\treturn getRowTopCache[index];\n\t\t\t}else {\n\t\t\t\tvar all = store.getIndexRange();\n\t\t\t\tvar top = 0;\n\t\t\t\tvar result = 0;\n\t\t\t\tfor(var i = 0; i < all.length; i++){\n\t\t\t\t\tgetRowTopCache[i] = top;\n\t\t\t\t\ttop += this.getItemHeight(all[i].id);\n\t\t\t\t\tif(i < index){\n\t\t\t\t\t\tresult = top;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Get top coordinate by item id\n\t\t * @param {*} task_id\n\t\t */\n\t\tgetItemTop: function (taskId) {\n\t\t\tif(this.$config.rowStore){\n\t\t\t\tif(getItemTopCache[taskId] !== undefined){\n\t\t\t\t\treturn getItemTopCache[taskId];\n\t\t\t\t}\n\t\t\t\tvar store = this.$config.rowStore;\n\t\t\t\tif(!store) return 0;\n\n\t\t\t\tvar itemIndex = store.getIndexById(taskId);\n\n\t\t\t\tif (itemIndex === -1 && store.getParent && store.exists(taskId)) {\n\t\t\t\t\tvar parentId = store.getParent(taskId);\n\t\t\t\t\tif (store.exists(parentId)) {\n\t\t\t\t\t\t// if task is not found in list - maybe it's parent is a split task and we should use parents index instead\n\t\t\t\t\t\tvar parent = store.getItem(parentId);\n\t\t\t\t\t\tif (this.$gantt.isSplitTask(parent)) {\n\t\t\t\t\t\t\treturn this.getItemTop(parentId);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tgetItemTopCache[taskId] = this.getRowTop(itemIndex);\n\t\t\t\treturn getItemTopCache[taskId];\n\t\t\t}else{\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t},\n\n\t\t/**\n\t\t * Get height of the item by item id\n\t\t * @param {*} itemId\n\t\t */\n\t\tgetItemHeight: function (itemId) {\n\t\t\tif(quickPosition.canUseSimpleCalculation()){\n\t\t\t\treturn quickPosition.getItemHeight(itemId);\n\t\t\t}\n\n\t\t\tif(!getItemHeightCache && this.$config.rowStore){\n\t\t\t\tthis._fillHeightCache(this.$config.rowStore);\n\t\t\t}\n\n\t\t\tif(getItemHeightCache[itemId] !== undefined){\n\t\t\t\treturn getItemHeightCache[itemId];\n\t\t\t}\n\n\t\t\tvar defaultHeight = this.$getConfig().row_height;\n\n\t\t\tif(this.$config.rowStore){\n\t\t\t\tvar store = this.$config.rowStore;\n\t\t\t\tif(!store) return defaultHeight;\n\n\t\t\t\tvar item = store.getItem(itemId);\n\n\t\t\t\treturn getItemHeightCache[itemId] = item && item.row_height || defaultHeight;\n\t\t\t}else{\n\t\t\t\treturn defaultHeight;\n\t\t\t}\n\t\t},\n\n\t\t_fillHeightCache: function(store){\n\t\t\tif(!store){\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tgetItemHeightCache = {};\n\t\t\tvar defaultHeight = this.$getConfig().row_height;\n\t\t\tstore.eachItem(function(item){\n\t\t\t\treturn getItemHeightCache[item.id] = item && item.row_height || defaultHeight;\n\t\t\t});\n\t\t},\n\n\t\tgetCacheStateTotalHeight: function(store){\n\n\t\t\tvar globalHeight = this.$getConfig().row_height;\n\t\t\tvar itemHeightCache = {};\n\t\t\tvar items = [];\n\t\t\tvar sumHeight = 0;\n\t\t\tif(store){\n\t\t\t\tstore.eachItem(function(item){\n\t\t\t\t\titems.push(item);\n\t\t\t\t\titemHeightCache[item.id] = item.row_height;\n\t\t\t\t\tsumHeight += item.row_height || globalHeight;\n\t\t\t\t});\n\t\t\t}\n\n\n\t\t\treturn {\n\t\t\t\tglobalHeight: globalHeight,\n\t\t\t\titems: items,\n\t\t\t\tcount: items.length,\n\t\t\t\tsumHeight: sumHeight\n\t\t\t};\n\t\t},\n\t\tshouldClearHeightCache: function(oldState, newState){\n\n\t\t\tif(oldState.count != newState.count){\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tif(oldState.globalHeight != newState.globalHeight){\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif(oldState.sumHeight != newState.sumHeight){\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tfor(var i in oldState.items){\n\t\t\t\tvar newValue = newState.items[i];\n\t\t\t\tif(newValue !== undefined && newValue != oldState.items[i]){\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn false;\n\t\t},\n\t\t/**\n\t\t * Get total height of items\n\t\t */\n\t\tgetTotalHeight: function () {\n\t\t\tif(quickPosition.canUseSimpleCalculation()){\n\t\t\t\treturn quickPosition.getTotalHeight();\n\t\t\t}\n\n\t\t\tif(totalHeightCache != -1){\n\t\t\t\treturn totalHeightCache;\n\t\t\t}\n\n\t\t\tif(this.$config.rowStore){\n\t\t\t\tvar store = this.$config.rowStore;\n\t\t\t\tthis._fillHeightCache(store);\n\t\t\t\tvar getHeight = this.getItemHeight.bind(this);\n\t\t\t\tvar visibleItems = store.getVisibleItems();\n\t\t\t\tvar totalHeight = 0;\n\n\t\t\t\tvisibleItems.forEach(function(item){\n\t\t\t\t\ttotalHeight += getHeight(item.id);\n\t\t\t\t});\n\n\t\t\t\ttotalHeightCache = totalHeight;\n\t\t\t\treturn totalHeight;\n\t\t\t}else{\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Get item by top position\n\t\t * @param {*} top\n\t\t */\n\t\tgetItemIndexByTopPosition: function (top) {\n\t\t\tif(this.$config.rowStore){\n\t\t\t\tif(quickPosition.canUseSimpleCalculation()){\n\t\t\t\t\treturn quickPosition.getItemIndexByTopPosition(top);\n\t\t\t\t}\n\n\t\t\t\tvar store = this.$config.rowStore;\n\t\t\t\tfor(var i = 0; i < store.countVisible(); i++){\n\t\t\t\t\tvar current = this.getRowTop(i);\n\t\t\t\t\tvar next = this.getRowTop(i+1);\n\t\t\t\t\tif(!next){\n\t\t\t\t\t\tvar taskId = store.getIdByIndex(i);\n\t\t\t\t\t\tnext = current + this.getItemHeight(taskId);\n\t\t\t\t\t}\n\t\t\t\t\tif(top >= current && top < next){\n\t\t\t\t\t\treturn i;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// GS-1723: If we iterated all tasks and didn't find the position, the target is below all other tasks\n\t\t\t\treturn store.countVisible() + 2;\n\t\t\t}else{\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t}\n\t};\n}\n\nexport default createMixin;","function createHelper(view){\n\tvar cachedRowHeight = -1;\n\tvar canUseSimpleCalc = -1;\n\treturn {\n\t\tresetCache: function(){\n\t\t\tcachedRowHeight = -1;\n\t\t\tcanUseSimpleCalc = -1;\n\t\t},\n\t\t_getRowHeight: function(){\n\t\t\tif(cachedRowHeight === -1){\n\t\t\t\tcachedRowHeight = view.$getConfig().row_height;\n\t\t\t}\n\t\t\treturn cachedRowHeight;\n\t\t},\n\t\t_refreshState: function(){\n\t\t\tthis.resetCache();\n\t\t\tcanUseSimpleCalc = true;\n\t\t\tvar store = view.$config.rowStore;\n\t\t\tif(!store){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar globalRowHeight = this._getRowHeight();\n\t\t\tfor (var i=0; i<store.fullOrder.length; i++) {\n\t\t\t\tvar item = store.getItem(store.fullOrder[i]);\n\t\t\t\t// GS-1491: ignore the task when it is filtered:\n\t\t\t\tif (!item) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif(item.row_height && item.row_height !== globalRowHeight){\n\t\t\t\t\tcanUseSimpleCalc = false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\n\t\t},\n\t\tcanUseSimpleCalculation: function(){\n\t\t\tif(canUseSimpleCalc === -1){\n\t\t\t\tthis._refreshState();\n\t\t\t}\n\t\t\treturn canUseSimpleCalc;\n\t\t},\n\n\t\t/**\n\t\t * Get top coordinate by row index (order)\n\t\t * @param {number} index\n\t\t */\n\t\tgetRowTop: function(index){\n\t\t\tvar store = view.$config.rowStore;\n\t\t\tif(!store){\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\treturn index * this._getRowHeight();\n\t\t},\n\n\t\t/**\n\t\t * Get height of the item by item id\n\t\t * @param {*} itemId\n\t\t */\n\t\tgetItemHeight: function (itemId) {\n\t\t\treturn this._getRowHeight();\n\t\t},\n\n\t\t/**\n\t\t * Get total height of items\n\t\t */\n\t\tgetTotalHeight: function () {\n\t\t\tif(view.$config.rowStore){\n\t\t\t\tvar store = view.$config.rowStore;\n\t\t\t\treturn store.countVisible() * this._getRowHeight();\n\t\t\t}else{\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Get item by top position\n\t\t * @param {*} top\n\t\t */\n\t\tgetItemIndexByTopPosition: function (top) {\n\t\t\tif(view.$config.rowStore){\n\t\t\t\treturn Math.floor(top / this._getRowHeight());\n\t\t\t}else{\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t}\n\t};\n}\n\nexport default createHelper;","const SENSITIVITY = 20;\nconst TIMEOUT = 50;\nconst SCROLLSTEP = 10;\n\nexport default class ScrollableGrid {\n\tpublic getCurrentX;\n\tprivate $gantt;\n\tprivate $grid;\n\tprivate _dnd;\n\tprivate _scrollView;\n\tprivate _scrollOrder: 0 | 1 | -1 = 0;\n\n\tconstructor(params) {\n\t\tconst {gantt, grid, dnd, getCurrentX} = params;\n\t\tthis.$gantt = gantt;\n\t\tthis.$grid = grid;\n\t\tthis._dnd = dnd;\n\t\tthis.getCurrentX = getCurrentX;\n\t\tthis._scrollView = this.$gantt.$ui.getView(this.$grid.$config.scrollX);\n\t\tthis.attachEvents();\n\t}\n\tattachEvents() {\n\t\tif (this.isScrollable()) {\n\t\t\tthis._dnd.attachEvent(\"onDragMove\", (obj, e) => {\n\t\t\t\tconst gridBoundingRect = this.$grid.$grid.getBoundingClientRect();\n\t\t\t\tconst maxLeft = gridBoundingRect.right;\n\t\t\t\tconst minLeft = gridBoundingRect.left;\n\t\t\t\tconst currentX = this.getCurrentX(e.clientX);\n\n\t\t\t\tif (currentX >= maxLeft - SENSITIVITY) {\n\t\t\t\t\tthis.autoscrollRight();\n\t\t\t\t\tthis.autoscrollStart();\n\t\t\t\t}\n\t\t\t\tif (currentX <= minLeft + SENSITIVITY) {\n\t\t\t\t\tthis.autoscrollLeft();\n\t\t\t\t\tthis.autoscrollStart();\n\t\t\t\t}\n\t\t\t\tif (currentX < maxLeft - SENSITIVITY && currentX > minLeft + SENSITIVITY) {\n\t\t\t\t\tthis.autoscrollStop();\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t});\n\t\t\tthis._dnd.attachEvent(\"onDragEnd\", () => {\n\t\t\t\tthis.autoscrollStop();\n\t\t\t});\n\t\t}\n\t}\n\tautoscrollStart() {\n\t\tif (this._scrollOrder === 0) {\n\t\t\treturn;\n\t\t}\n\t\tconst scrollStep = SCROLLSTEP * this._scrollOrder;\n\t\tconst scrollState = this._scrollView.getScrollState();\n\t\tthis._scrollView.scrollTo(scrollState.position + scrollStep);\n\t\tsetTimeout(() => { this.autoscrollStart(); }, TIMEOUT);\n\t}\n\tautoscrollRight() {\n\t\tthis._scrollOrder = 1;\n\t}\n\tautoscrollLeft() {\n\t\tthis._scrollOrder = -1;\n\t}\n\tautoscrollStop() {\n\t\tthis._scrollOrder = 0;\n\t}\n\tgetCorrection() {\n\t\tif (!this.isScrollable()) {\n\t\t\treturn 0;\n\t\t}\n\t\treturn this._scrollView.getScrollState().position;\n\t}\n\tisScrollable() {\n\t\treturn !!this.$grid.$config.scrollable;\n\t}\n}","import * as domHelpers from \"../../utils/dom_helpers\";\nimport ScrollableGrid from \"./scrollable_grid\";\n\nconst COLUMN_ID_ATTR_NAME = \"data-column-id\";\n\nexport class ColumnsGridDnd {\n\tprivate $gantt;\n\tprivate $grid;\n\tprivate _dragX;\n\tprivate _dnd;\n\tprivate _originAutoscroll;\n\tprivate _scrollableGrid: ScrollableGrid;\n\tprivate _draggedCell;\n\tprivate _targetMarker = null;\n\tprivate _gridConfig;\n\tconstructor(gantt, grid) {\n\t\tthis.$gantt = gantt;\n\t\tthis.$grid = grid;\n\t}\n\tinit() {\n\t\tconst DND = this.$gantt.$services.getService(\"dnd\");\n\t\tthis._dnd = new DND(this.$grid.$grid_scale, { updates_per_second: 60 });\n\t\tthis._scrollableGrid = new ScrollableGrid({\n\t\t\tgantt: this.$gantt,\n\t\t\tgrid: this.$grid,\n\t\t\tdnd: this._dnd,\n\t\t\tgetCurrentX: this.calculateCurrentPosition\n\t\t});\n\t\tthis.attachEvents();\n\t}\n\tattachEvents() {\n\t\tthis._dnd.attachEvent(\"onBeforeDragStart\", (obj, e) => {\n\t\t\tthis._draggedCell = this.$gantt.utils.dom.closest(e.target, \".gantt_grid_head_cell\");\n\t\t\tif(!this._draggedCell){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst columns = this.$grid.$getConfig().columns;\n\t\t\tconst columnName = this._draggedCell.getAttribute(COLUMN_ID_ATTR_NAME);\n\t\t\tlet draggedColumn;\n\t\t\tlet draggedIndex;\n\t\t\tcolumns.map(function(column, index){\n\t\t\t\tif(column.name === columnName){\n\t\t\t\t\tdraggedColumn = column;\n\t\t\t\t\tdraggedIndex = index;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (this.$grid.callEvent(\"onBeforeColumnDragStart\", [{ draggedColumn, draggedIndex}]) === false) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (!this._draggedCell || !draggedColumn) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis._gridConfig = this.$grid.$getConfig();\n\t\t\tthis._originAutoscroll = this.$gantt.config.autoscroll;\n\t\t\tthis.$gantt.config.autoscroll = false;\n\t\t\treturn true;\n\t\t});\n\n\t\tthis._dnd.attachEvent(\"onAfterDragStart\", (obj, e) => {\n\t\t\tif (!this._draggedCell) {\n\t\t\t\treturn; // GS-1333: don't try to reorder a column when we resize it\n\t\t\t}\n\t\t\tthis._dnd.config.column = this._draggedCell.getAttribute(COLUMN_ID_ATTR_NAME);\n\t\t\tthis._dnd.config.marker.innerHTML = this._draggedCell.outerHTML;\n\t\t\tthis._dnd.config.marker.classList.add(\"gantt_column_drag_marker\");\n\t\t\tthis._dnd.config.marker.style.height = this._gridConfig.scale_height + \"px\";\n\t\t\tthis._dnd.config.marker.style.lineHeight = this._gridConfig.scale_height + \"px\";\n\t\t\tthis._draggedCell.classList.add(\"gantt_grid_head_cell_dragged\");\n\t\t});\n\n\t\tthis._dnd.attachEvent(\"onDragMove\", (obj, e) => {\n\t\t\tif(!this._draggedCell){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis._dragX = e.clientX;\n\t\t\tconst x = this.calculateCurrentPosition(e.clientX);\n\t\t\tconst columnIndexes = this.findColumnsIndexes();\n\t\t\tthis.setMarkerPosition(x);\n\t\t\tthis.drawTargetMarker(columnIndexes);\n\t\t\treturn true;\n\t\t});\n\n\t\tthis._dnd.attachEvent(\"onDragEnd\", () => {\n\t\t\tif (!this._draggedCell) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst columnIndexes = this.findColumnsIndexes();\n\t\t\tconst targetIndex = columnIndexes.targetIndex;\n\t\t\tconst draggedIndex = columnIndexes.draggedIndex;\n\t\t\tconst columns = this.$grid.$getConfig().columns;\n\n\t\t\tconst draggedColumn = columns[draggedIndex];\n\t\t\tconst targetColumn = columns[targetIndex];\n\t\t\tif (this.$grid.callEvent(\"onColumnDragMove\", [{ draggedColumn, targetColumn, draggedIndex, targetIndex }]) === false) {\n\t\t\t\tthis.cleanTargetMarker();\n\t\t\t\tthis.$gantt.render();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.$gantt.config.autoscroll = this._originAutoscroll;\n\t\t\tthis._draggedCell.classList.remove(\"gantt_grid_head_cell_dragged\");\n\t\t\tthis.cleanTargetMarker();\n\t\t\tthis.reorderColumns();\n\t\t});\n\n\t}\n\treorderColumns() {\n\t\tconst { targetIndex, draggedIndex } = this.findColumnsIndexes();\n\n\t\tconst columns = this.$grid.$getConfig().columns;\n\t\tconst draggedColumn = columns[draggedIndex];\n\t\tconst targetColumn = columns[targetIndex];\n\n\t\tif (this.$grid.callEvent(\"onBeforeColumnReorder\", [{ draggedColumn, targetColumn, draggedIndex, targetIndex }]) === false) {\n\t\t\treturn;\n\t\t}\n\t\tif (targetIndex === draggedIndex) {\n\t\t\treturn;\n\t\t}\n\t\tcolumns.splice(draggedIndex, 1);\n\t\tcolumns.splice(targetIndex, 0, draggedColumn);\n\t\tthis.$gantt.render();\n\t\tthis.$grid.callEvent(\"onAfterColumnReorder\", [{ draggedColumn, targetColumn, draggedIndex, targetIndex }]);\n\t}\n\tfindColumnsIndexes() {\n\t\tconst draggedId = this._dnd.config.column;\n\t\tconst columns = this.$grid.$getConfig().columns;\n\t\tlet targetIndex: number;\n\t\tlet draggedIndex: number;\n\t\tlet xBefore: number;\n\t\tlet xAfter: number;\n\t\tconst currentColumn = { startX: 0, endX: 0 };\n\n\t\tlet start = 0;\n\t\tlet end = columns.length - 1;\n\t\tlet compare = (a, b) => a <= b;\n\t\tlet next = (index) => ++index;\n\t\tif (this.$gantt.config.rtl) {\n\t\t\tstart = columns.length - 1;\n\t\t\tend = 0;\n\t\t\tcompare = (a, b) => a >= b;\n\t\t\tnext = (index) => --index;\n\t\t}\n\n\t\tlet columnRelativePos: number;\n\n\t\tconst relativeX = this._dragX - this.$grid.$grid.getBoundingClientRect().left + this._scrollableGrid.getCorrection();\n\t\tfor (let i = start; compare(i, end); i = next(i)) {\n\t\t\tif (targetIndex !== undefined && draggedIndex !== undefined) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif(!columns[i].hide) {\n\t\t\t\tcurrentColumn.startX = currentColumn.endX;\n\t\t\t\tcurrentColumn.endX += columns[i].width;\n\n\t\t\t\t// if drop on a column or drop after the last column\n\t\t\t\tif (relativeX >= currentColumn.startX && (relativeX <= currentColumn.endX || !compare(next(i), end))) {\n\t\t\t\t\ttargetIndex = i;\n\t\t\t\t\txBefore = currentColumn.startX;\n\t\t\t\t\txAfter = currentColumn.endX;\n\t\t\t\t\tcolumnRelativePos = (relativeX - currentColumn.startX) / (currentColumn.endX - currentColumn.startX);\n\t\t\t\t}\n\t\t\t\tif (draggedId === columns[i].name) {\n\t\t\t\t\tdraggedIndex = i;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\ttargetIndex,\n\t\t\tdraggedIndex,\n\t\t\txBefore,\n\t\t\txAfter,\n\t\t\tcolumnRelativePos\n\t\t};\n\t}\n\tsetMarkerPosition(x: number, y: number = 10) {\n\t\tconst { marker } = this._dnd.config;\n\t\tconst gridOffset = this._dnd._obj.getBoundingClientRect();\n\t\tmarker.style.top = `${gridOffset.y + y}px`;\n\t\tmarker.style.left = `${x}px`;\n\t}\n\tcalculateCurrentPosition = (eventX: number) => {\n\t\tconst gridBoundingRect = this.$grid.$grid.getBoundingClientRect();\n\t\tconst maxLeft = gridBoundingRect.right;\n\t\tconst minLeft = gridBoundingRect.left;\n\t\tlet x = eventX;\n\t\tif (x > maxLeft) {\n\t\t\tx = maxLeft;\n\t\t}\n\t\tif (x < minLeft) {\n\t\t\tx = minLeft;\n\t\t}\n\t\treturn x;\n\t};\n\tdrawTargetMarker({ targetIndex, draggedIndex, xBefore, xAfter, columnRelativePos }) {\n\t\tif (!this._targetMarker) {\n\t\t\tthis._targetMarker = document.createElement(\"div\");\n\t\t\tdomHelpers.addClassName(this._targetMarker, \"gantt_grid_target_marker\");\n\t\t\tthis._targetMarker.style.display = \"none\";\n\t\t\tthis._targetMarker.style.height = `${this._gridConfig.scale_height}px`;\n\t\t}\n\n\t\t// marker can be detached after gantt.render\n\t\tif(!this._targetMarker.parentNode){\n\t\t\tthis.$grid.$grid_scale.appendChild(this._targetMarker);\n\t\t}\n\n\t\tlet nextPosition: number;\n\t\tif (targetIndex > draggedIndex) {\n\t\t\tnextPosition = xAfter;\n\t\t} else if (targetIndex < draggedIndex) {\n\t\t\tnextPosition = xBefore;\n\t\t} else {\n\t\t\tif(columnRelativePos > 0.5){\n\t\t\t\tnextPosition = xAfter;\n\t\t\t}else{\n\t\t\t\tnextPosition = xBefore;\n\t\t\t}\n\t\t}\n\n\t\tthis._targetMarker.style.left = `${nextPosition}px`;\n\t\tthis._targetMarker.style.display = \"block\";\n\t}\n\tcleanTargetMarker() {\n\t\tif (this._targetMarker && this._targetMarker.parentNode) {\n\t\t\tthis.$grid.$grid_scale.removeChild(this._targetMarker);\n\t\t}\n\t\tthis._targetMarker = null;\n\t}\n}","function create(gantt){\n\tvar events = [];\n\n\treturn {\n\t\tdelegate:function(event, className, handler, root) {\n\t\t\tevents.push([event, className, handler, root]);\n\n\t\t\tvar helper = gantt.$services.getService(\"mouseEvents\");\n\t\t\thelper.delegate(event, className, handler, root);\n\t\t},\n\t\tdestructor: function(){\n\t\t\tvar mouseEvents = gantt.$services.getService(\"mouseEvents\");\n\t\t\tfor(var i = 0; i < events.length; i++){\n\t\t\t\tvar h = events[i];\n\t\t\t\tmouseEvents.detach(h[0], h[1], h[2], h[3]);\n\t\t\t}\n\t\t\tevents = [];\n\t\t}\n\t};\n}\n\nexport default create;","import * as domHelpers from \"../utils/dom_helpers\";\nimport * as utils from \"../../../utils/utils\";\nimport eventable from \"../../../utils/eventable\";\nimport gridResize from \"./grid_resize\";\nimport topPositionMixin from \"../row_position_mixin\";\nimport rowResize from \"./task_grid_row_resize\";\n\nimport ColumnDnd from \"../plugins/column_grid_dnd\";\n\nimport mouseEventContainer from \"../mouse_event_container\";\n\nvar Grid = function (parent, config, factory, gantt) {\n\tthis.$config = utils.mixin({}, config || {});\n\tthis.$gantt = gantt;\n\tthis.$parent = parent;\n\teventable(this);\n\tthis.$state = {};\n\tutils.mixin(this, topPositionMixin(this));\n};\n\n\nGrid.prototype = {\n\tinit: function(container) {\n\t\tvar gantt = this.$gantt;\n\t\tvar gridAriaAttr = gantt._waiAria.gridAttrString();\n\t\tvar gridDataAriaAttr = gantt._waiAria.gridDataAttrString();\n\t\tvar _ganttConfig = this.$getConfig();\n\t\tvar reorderColumns = _ganttConfig.reorder_grid_columns || false;\n\t\tif (this.$config.reorder_grid_columns !== undefined) {\n\t\t\treorderColumns = this.$config.reorder_grid_columns;\n\t\t}\n\n\n\t\tcontainer.innerHTML = \"<div class='gantt_grid' style='height:inherit;width:inherit;' \" + gridAriaAttr + \"></div>\";\n\t\tthis.$grid = container.childNodes[0];\n\n\t\tthis.$grid.innerHTML = \"<div class='gantt_grid_scale' \" +\n\t\t\tgantt._waiAria.gridScaleRowAttrString() + \"></div><div class='gantt_grid_data' \" + gridDataAriaAttr + \"></div>\";\n\n\t\tthis.$grid_scale = this.$grid.childNodes[0];\n\t\tthis.$grid_data = this.$grid.childNodes[1];\n\n\t\tvar attr = _ganttConfig[this.$config.bind + \"_attribute\"];\n\t\tif (!attr && this.$config.bind) {\n\t\t\tattr = \"data-\" + this.$config.bind + \"-id\";\n\t\t}\n\t\tthis.$config.item_attribute = attr || null;\n\n\t\tif (!this.$config.layers) {\n\t\t\tvar layers = this._createLayerConfig();\n\t\t\tthis.$config.layers = layers;\n\t\t}\n\n\t\tvar resizer = gridResize(gantt, this);\n\t\tresizer.init();\n\t\tthis._renderHeaderResizers = resizer.doOnRender;\n\t\tthis._mouseDelegates = mouseEventContainer(gantt);\n\n\t\tvar resizerrow = rowResize(gantt, this);\n\t\tresizerrow.init();\n\n\t\tthis._addLayers(this.$gantt);\n\t\tthis._initEvents();\n\n\t\tif (reorderColumns) {\n\t\t\tthis._columnDND = new ColumnDnd(gantt, this);\n\t\t\tthis._columnDND.init();\n\t\t}\n\n\t\tthis.callEvent(\"onReady\", []);\n\t\t//this.refresh();\n\t},\n\n\t_validateColumnWidth: function (column, property) {\n\t\t// user can set {name:\"text\", width:\"200\",...} for some reason,\n\t\t// check and convert it to number when possible\n\t\tvar value = column[property];\n\t\tif (value && value != \"*\") {\n\t\t\tvar gantt = this.$gantt;\n\t\t\tvar numericWidth = value * 1;\n\t\t\tif (isNaN(numericWidth)) {\n\t\t\t\tgantt.assert(false, \"Wrong \" + property + \" value of column \" + column.name);\n\t\t\t} else {\n\t\t\t\tcolumn[property] = numericWidth;\n\t\t\t}\n\t\t}\n\t},\n\n\tsetSize: function (width, height) {\n\t\tthis.$config.width = this.$state.width = width;\n\t\tthis.$config.height = this.$state.height = height;\n\n\t\t// TODO: maybe inherit and override in a subclass instead of extending here\n\n\t\tvar columns = this.getGridColumns(),\n\t\t\tinnerWidth = 0;\n\n\t\tvar config = this.$getConfig();\n\t\tvar elasticColumns = config.grid_elastic_columns;\n\n\t\tfor (var i = 0, l = columns.length; i < l; i++) {\n\t\t\tthis._validateColumnWidth(columns[i], \"min_width\");\n\t\t\tthis._validateColumnWidth(columns[i], \"max_width\");\n\t\t\tthis._validateColumnWidth(columns[i], \"width\");\n\n\t\t\tinnerWidth += columns[i].width * 1;\n\t\t}\n\n\t\tvar outerWidth;\n\t\tif (isNaN(innerWidth) || !this.$config.scrollable) {\n\t\t\touterWidth = this._setColumnsWidth(width + 1);\n\t\t\tinnerWidth = outerWidth;\n\t\t}\n\n\t\tif(this.$config.scrollable && elasticColumns && !isNaN(innerWidth)){\n\t\t\t// GS-1352: Allow resizing the grid columns, then the grid width is increased\n\t\t\t// or keep the grid width, but don't allow column resize to affect the grid width\n\t\t\tlet columnProperty = \"width\";\n\t\t\tif (elasticColumns == \"min_width\"){\n\t\t\t\tcolumnProperty = \"min_width\";\n\t\t\t}\n\t\t\tlet newColumnWidth = 0;\n\t\t\tcolumns.forEach(function(col){\n\t\t\t\tnewColumnWidth += col[columnProperty] || config.min_grid_column_width;\n\t\t\t});\n\t\t\t//newColumnWidth--; // the total column width shouldn't match the outerWidth // GS-2190 reducing width seems to be not needed\n\t\t\tvar columnsWidth = Math.max(newColumnWidth, width);\n\t\t\tinnerWidth = this._setColumnsWidth(columnsWidth);\n\t\t\touterWidth = width;\n\t\t}\n\n\t\tif (this.$config.scrollable) {\n\t\t\tthis.$grid_scale.style.width = innerWidth + \"px\";\n\t\t\tthis.$grid_data.style.width = innerWidth + \"px\";\n\t\t} else {\n\t\t\tthis.$grid_scale.style.width = \"inherit\";\n\t\t\tthis.$grid_data.style.width = \"inherit\";\n\t\t}\n\t\tthis.$config.width -= 1;\n\n\t\tvar config = this.$getConfig();\n\t\tif (outerWidth !== width) {\n\t\t\tif(outerWidth !== undefined){\n\t\t\t\tconfig.grid_width = outerWidth;\n\t\t\t\tthis.$config.width = outerWidth - 1;\n\t\t\t}else{\n\t\t\t\tif(!isNaN(innerWidth)){\n\t\t\t\t\tthis._setColumnsWidth(innerWidth);\n\t\t\t\t\tconfig.grid_width = innerWidth;\n\t\t\t\t\tthis.$config.width = innerWidth - 1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tvar dataHeight = Math.max(this.$state.height - config.scale_height, 0);\n\t\tthis.$grid_data.style.height = dataHeight + \"px\";\n\t\tthis.refresh();\n\t},\n\tgetSize: function () {\n\n\t\tvar config = this.$getConfig();\n\n\t\tvar store = this.$config.rowStore;\n\n\t\tvar contentHeight = store ? this.getTotalHeight() : 0,\n\t\t\tcontentWidth = this._getGridWidth();\n\n\t\tvar size = {\n\t\t\tx: this.$state.width,\n\t\t\ty: this.$state.height,\n\t\t\tcontentX: this.isVisible() ? contentWidth : 0,\n\t\t\tcontentY: this.isVisible() ? (config.scale_height + contentHeight) : 0,\n\t\t\tscrollHeight: this.isVisible() ? contentHeight : 0,\n\t\t\tscrollWidth: this.isVisible() ? contentWidth : 0\n\t\t};\n\n\t\treturn size;\n\t},\n\n\t_bindStore: function () {\n\t\tif (this.$config.bind){\n\t\t\tvar rowStore = this.$gantt.getDatastore(this.$config.bind);\n\t\t\tthis.$config.rowStore = rowStore;\n\t\t\tif(rowStore && !rowStore._gridCacheAttached){\n\t\t\t\tvar self = this;\n\t\t\t\trowStore._gridCacheAttached = rowStore.attachEvent(\"onBeforeFilter\", function(){\n\t\t\t\t\tself._resetTopPositionHeight();\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t},\n\t_unbindStore: function(){\n\t\tif (this.$config.bind){\n\t\t\tvar rowStore = this.$gantt.getDatastore(this.$config.bind);\n\t\t\tif(rowStore && rowStore._gridCacheAttached){\n\t\t\t\trowStore.detachEvent(rowStore._gridCacheAttached);\n\t\t\t\trowStore._gridCacheAttached = false;\n\t\t\t}\n\t\t}\n\t},\n\n\trefresh: function () {\n\t\tthis._bindStore();\n\n\t\tthis._resetTopPositionHeight();\n\t\tthis._resetHeight();\n\t\tthis._initSmartRenderingPlaceholder();\n\n\t\tthis._calculateGridWidth();\n\t\tthis._renderGridHeader();\n\t},\n\n\tgetViewPort: function(){\n\t\tvar scrollLeft = this.$config.scrollLeft || 0;\n\t\tvar scrollTop = this.$config.scrollTop || 0;\n\t\tvar height = this.$config.height || 0;\n\t\tvar width = this.$config.width || 0;\n\t\treturn {\n\t\t\ty: scrollTop,\n\t\t\ty_end: scrollTop + height,\n\t\t\tx: scrollLeft,\n\t\t\tx_end: scrollLeft + width,\n\t\t\theight: height,\n\t\t\twidth: width\n\t\t};\n\t},\n\n\tscrollTo: function (left, top) {\n\t\tif (!this.isVisible())\n\t\t\treturn;\n\n\t\tvar scrolled = false;\n\n\t\tthis.$config.scrollTop = this.$config.scrollTop || 0;\n\t\tthis.$config.scrollLeft = this.$config.scrollLeft || 0;\n\n\t\tif (left * 1 == left) {\n\t\t\tthis.$config.scrollLeft = this.$state.scrollLeft = this.$grid.scrollLeft = left;\n\t\t\tscrolled = true;\n\t\t}\n\n\t\t// var config = this.$getConfig();\n\t\tif (top * 1 == top) {\n\t\t\tthis.$config.scrollTop = this.$state.scrollTop = this.$grid_data.scrollTop = top;\n\t\t\tscrolled = true;\n\t\t}\n\n\t\tif(scrolled){\n\t\t\tthis.callEvent(\"onScroll\", [this.$config.scrollLeft, this.$config.scrollTop]);\n\t\t}\n\t},\n\n\tgetColumnIndex: function (name, excludeHidden) {\n\t\tvar columns = this.$getConfig().columns;\n\t\tvar hiddenIndexShift = 0;\n\n\t\tfor (var i = 0; i < columns.length; i++) {\n\t\t\t// GS-1257. If the cell is hidden, the target column index should be correct\n\t\t\tif (excludeHidden && columns[i].hide){\n\t\t\t\thiddenIndexShift++;\n\t\t\t}\n\t\t\tif (columns[i].name == name) {\n\t\t\t\treturn i - hiddenIndexShift;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t},\n\n\tgetColumn: function (name) {\n\t\tvar index = this.getColumnIndex(name);\n\t\tif (index === null) {\n\t\t\treturn null;\n\t\t}\n\t\treturn this.$getConfig().columns[index];\n\t},\n\n\tgetGridColumns: function () {\n\t\tvar config = this.$getConfig();\n\t\treturn config.columns.slice();\n\t},\n\tisVisible: function () {\n\t\tif (this.$parent && this.$parent.$config) {\n\t\t\treturn !this.$parent.$config.hidden;\n\t\t} else {\n\t\t\treturn this.$grid.offsetWidth;\n\t\t}\n\t},\n\n\t// getItemHeight: function () {\n\t// \tvar config = this.$getConfig();\n\t// \treturn config.row_height;\n\t// },\n\n\t_createLayerConfig: function () {\n\t\tvar gantt = this.$gantt;\n\t\tvar self = this;\n\t\tvar layers = [\n\t\t\t{\n\t\t\t\trenderer: gantt.$ui.layers.gridLine(),\n\t\t\t\tcontainer: this.$grid_data,\n\t\t\t\tfilter: [function () {\n\t\t\t\t\treturn self.isVisible();\n\t\t\t\t}]\n\t\t\t},\n\t\t\t{\n\t\t\t\trenderer: gantt.$ui.layers.gridTaskRowResizer(),\n\t\t\t\tcontainer: this.$grid_data,\n\t\t\t\tappend: true,\n\t\t\t\tfilter: [function () {\n\t\t\t\t\treturn gantt.config.resize_rows;\n\t\t\t\t}]\n\t\t\t}\n\t\t];\n\t\treturn layers;\n\t},\n\n\t_addLayers: function (gantt) {\n\t\tif (!this.$config.bind)\n\t\t\treturn;\n\n\t\tthis._taskLayers = [];\n\n\t\tvar self = this;\n\n\t\tvar layers = this.$gantt.$services.getService(\"layers\");\n\t\tvar taskRenderer = layers.getDataRender(this.$config.bind);\n\n\t\tif (!taskRenderer) {\n\t\t\ttaskRenderer = layers.createDataRender({\n\t\t\t\tname: this.$config.bind,\n\t\t\t\tdefaultContainer: function () { return self.$grid_data; }\n\t\t\t});\n\t\t}\n\n\t\tvar taskLayers = this.$config.layers;\n\t\tfor (var i = 0; taskLayers && i < taskLayers.length; i++) {\n\t\t\tvar layer = taskLayers[i];\n\t\t\tlayer.view = this;\n\n\t\t\tvar bar_layer = taskRenderer.addLayer(layer);\n\t\t\tthis._taskLayers.push(bar_layer);\n\t\t}\n\n\t\tthis._bindStore();\n\n\t\tthis._initSmartRenderingPlaceholder();\n\t},\n\n\t_refreshPlaceholderOnStoreUpdate: function (id) {\n\t\tvar config = this.$getConfig(),\n\t\t\tstore = this.$config.rowStore;\n\n\t\tif (!store || id !== null || !this.isVisible() || !config.smart_rendering) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar contentHeight;\n\t\tif (this.$config.scrollY) {\n\t\t\tvar scroll = this.$gantt.$ui.getView(this.$config.scrollY);\n\t\t\tif (scroll)\n\t\t\t\tcontentHeight = scroll.getScrollState().scrollSize;\n\t\t}\n\n\t\tif (!contentHeight) {\n\t\t\tcontentHeight = store ? this.getTotalHeight() : 0;\n\t\t}\n\n\t\tif (contentHeight) {\n\t\t\tif (this.$rowsPlaceholder && this.$rowsPlaceholder.parentNode) {\n\t\t\t\tthis.$rowsPlaceholder.parentNode.removeChild(this.$rowsPlaceholder);\n\t\t\t}\n\n\t\t\tvar placeholder = this.$rowsPlaceholder = document.createElement(\"div\");\n\t\t\tplaceholder.style.visibility = \"hidden\";\n\t\t\tplaceholder.style.height = contentHeight + \"px\";\n\t\t\tplaceholder.style.width = \"1px\";\n\t\t\tthis.$grid_data.appendChild(placeholder);\n\t\t}\n\t},\n\n\t_initSmartRenderingPlaceholder: function () {\n\t\tvar store = this.$config.rowStore;\n\t\tif (!store) {\n\t\t\treturn;\n\t\t} else {\n\t\t\tthis._initSmartRenderingPlaceholder = function () { };\n\t\t}\n\t\tthis._staticBgHandler = store.attachEvent(\"onStoreUpdated\", utils.bind(this._refreshPlaceholderOnStoreUpdate, this));\n\t},\n\n\t_initEvents: function () {\n\t\tvar gantt = this.$gantt;\n\t\tthis._mouseDelegates.delegate(\"click\", \"gantt_close\", gantt.bind(function (e, id, trg) {\n\t\t\tvar store = this.$config.rowStore;\n\t\t\tif (!store) return true;\n\n\t\t\tvar target = domHelpers.locateAttribute(e, this.$config.item_attribute);\n\t\t\tif (target) {\n\t\t\t\tstore.close(target.getAttribute(this.$config.item_attribute));\n\n\t\t\t}\n\t\t\treturn false;\n\t\t}, this), this.$grid);\n\n\t\tthis._mouseDelegates.delegate(\"click\", \"gantt_open\", gantt.bind(function (e, id, trg) {\n\t\t\tvar store = this.$config.rowStore;\n\t\t\tif (!store) return true;\n\n\t\t\tvar target = domHelpers.locateAttribute(e, this.$config.item_attribute);\n\t\t\tif (target) {\n\t\t\t\tstore.open(target.getAttribute(this.$config.item_attribute));\n\n\t\t\t}\n\t\t\treturn false;\n\t\t}, this), this.$grid);\n\t},\n\n\t_clearLayers: function (gantt) {\n\t\tvar layers = this.$gantt.$services.getService(\"layers\");\n\t\tvar taskRenderer = layers.getDataRender(this.$config.bind);\n\n\t\tif (this._taskLayers) {\n\t\t\tfor (var i = 0; i < this._taskLayers.length; i++) {\n\t\t\t\ttaskRenderer.removeLayer(this._taskLayers[i]);\n\t\t\t}\n\t\t}\n\n\t\tthis._taskLayers = [];\n\t},\n\n\t_getColumnWidth: function (column, config, width) {\n\t\tvar min_width = column.min_width || config.min_grid_column_width;\n\t\tvar new_width = Math.max(width, min_width || 10);\n\t\tif (column.max_width)\n\t\t\tnew_width = Math.min(new_width, column.max_width);\n\t\treturn new_width;\n\t},\n\t// set min width only if width < than config.min_grid_column_width\n\t_checkGridColumnMinWidthLimits: function (columns, config) {\n\t\tfor (var i = 0, l = columns.length; i < l; i++) {\n\t\t\tvar width = columns[i].width * 1;\n\t\t\tif (!columns[i].min_width && width < config.min_grid_column_width){\n\t\t\t\tcolumns[i].min_width = width;\n\t\t\t}\n\t\t}\n\t},\n\t// return min and max possible grid width according to restricts\n\t_getGridWidthLimits: function () {\n\t\tvar config = this.$getConfig(),\n\t\t\tcolumns = this.getGridColumns(),\n\t\t\tmin_limit = 0,\n\t\t\tmax_limit = 0;\n\n\t\tfor (var i = 0; i < columns.length; i++) {\n\t\t\tmin_limit += columns[i].min_width ? columns[i].min_width : config.min_grid_column_width;\n\t\t\tif (max_limit !== undefined) {\n\t\t\t\tmax_limit = columns[i].max_width ? (max_limit + columns[i].max_width) : undefined;\n\t\t\t}\n\t\t}\n\t\tthis._checkGridColumnMinWidthLimits(columns, config); // FIX ME: should it be before calculating limits?\n\t\treturn [min_limit, max_limit];\n\t},\n\t// resize columns to get total newWidth, starting from columns[start_index]\n\t_setColumnsWidth: function (newWidth, start_index) {\n\t\tvar config = this.$getConfig();\n\t\tvar columns = this.getGridColumns(),\n\t\t\tcolumns_width = 0,\n\t\t\tfinal_width = newWidth;\n\n\t\tstart_index = !window.isNaN(start_index) ? start_index : -1;\n\n\t\tfor (var i = 0, l = columns.length; i < l; i++) {\n\t\t\tcolumns_width += columns[i].width * 1;\n\t\t}\n\n\t\tif (window.isNaN(columns_width)) {\n\t\t\tthis._calculateGridWidth();\n\t\t\tcolumns_width = 0;\n\t\t\tfor (var i = 0, l = columns.length; i < l; i++) {\n\t\t\t\tcolumns_width += columns[i].width * 1;\n\t\t\t}\n\t\t}\n\n\t\tvar extra_width = final_width - columns_width;\n\n\t\tvar start_width = 0;\n\t\tfor (var i = 0; i < start_index + 1; i++) {\n\t\t\tstart_width += columns[i].width;\n\t\t}\n\n\t\tcolumns_width -= start_width;\n\n\t\tfor (var i = start_index + 1; i < columns.length; i++) {\n\n\t\t\tvar col = columns[i];\n\t\t\tvar share = Math.round(extra_width * (col.width / columns_width));\n\n\t\t\t// columns have 2 additional restrict fields - min_width & max_width that are set by user\n\t\t\tif (extra_width < 0) {\n\t\t\t\tif (col.min_width && col.width + share < col.min_width)\n\t\t\t\t\tshare = col.min_width - col.width;\n\t\t\t\telse if (!col.min_width && config.min_grid_column_width && col.width + share < config.min_grid_column_width)\n\t\t\t\t\tshare = config.min_grid_column_width - col.width;\n\t\t\t} else if (col.max_width && col.width + share > col.max_width)\n\t\t\t\tshare = col.max_width - col.width;\n\n\t\t\tcolumns_width -= col.width;\n\t\t\tcol.width += share;\n\t\t\textra_width -= share;\n\n\t\t}\n\n\t\tvar iterator = extra_width > 0 ? 1 : -1;\n\t\twhile ((extra_width > 0 && iterator === 1) || (extra_width < 0 && iterator === -1)) {\n\t\t\tvar curExtra = extra_width;\n\t\t\tfor (i = start_index + 1; i < columns.length; i++) {\n\t\t\t\tvar new_width = columns[i].width + iterator;\n\n\t\t\t\tif (new_width == this._getColumnWidth(columns[i], config, new_width)) {\n\t\t\t\t\textra_width -= iterator;\n\t\t\t\t\tcolumns[i].width = new_width;\n\t\t\t\t}\n\n\t\t\t\tif (!extra_width)\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tif (curExtra == extra_width)\n\t\t\t\tbreak;\n\t\t}\n\n\t\t// if impossible to resize the right-side columns, resize the start column\n\t\tif (extra_width && start_index > -1) {\n\t\t\tvar new_width = columns[start_index].width + extra_width;\n\t\t\tif (new_width == this._getColumnWidth(columns[start_index], config, new_width))\n\t\t\t\tcolumns[start_index].width = new_width;\n\t\t}\n\n\t\t//if (this.callEvent(\"onGridResizeEnd\", [config.grid_width, final_width]) === false)\n\t\t//\treturn;\n\n\t\treturn this._getColsTotalWidth();\n\t},\n\n\t_getColsTotalWidth: function () {\n\t\tvar columns = this.getGridColumns();\n\t\tvar cols_width = 0;\n\n\t\tfor (var i = 0; i < columns.length; i++) {\n\t\t\tvar v = parseFloat(columns[i].width);\n\t\t\tif (window.isNaN(v)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tcols_width += v;\n\t\t}\n\t\treturn cols_width;\n\t},\n\t_calculateGridWidth: function () {\n\t\tvar config = this.$getConfig();\n\t\tvar columns = this.getGridColumns();\n\t\tvar cols_width = 0;\n\t\tvar unknown = [];\n\t\tvar width = [];\n\n\t\tfor (var i = 0; i < columns.length; i++) {\n\t\t\tvar v = parseFloat(columns[i].width);\n\t\t\tif (window.isNaN(v)) {\n\t\t\t\tv = config.min_grid_column_width || 10;\n\t\t\t\tunknown.push(i);\n\t\t\t}\n\t\t\twidth[i] = v;\n\t\t\tcols_width += v;\n\t\t}\n\t\tvar gridWidth = this._getGridWidth() + 1;\n\t\tif (config.autofit || unknown.length) {\n\t\t\tvar diff = gridWidth - cols_width;\n\t\t\t// TODO: logic may be improved for proportional changing of width\n\n\t\t\t// autofit adjusts columns widths to the outer grid width\n\t\t\t// it doesn't makes sense if grid has inner scroll with elastic columns\n\t\t\tif (config.autofit && !config.grid_elastic_columns) {\n\t\t\t\t// delta must be added for all columns\n\t\t\t\tfor (var i = 0; i < width.length; i++) {\n\t\t\t\t\tvar delta = Math.round(diff / (width.length - i));\n\t\t\t\t\twidth[i] += delta;\n\t\t\t\t\tvar new_width = this._getColumnWidth(columns[i], config, width[i]);\n\n\t\t\t\t\tif (new_width != width[i]) {\n\t\t\t\t\t\tdelta = new_width - width[i];\n\t\t\t\t\t\twidth[i] = new_width;\n\t\t\t\t\t}\n\t\t\t\t\tdiff -= delta;\n\t\t\t\t}\n\t\t\t} else if (unknown.length) {\n\t\t\t\t// there are several columns with undefined width\n\t\t\t\tfor (var i = 0; i < unknown.length; i++) {\n\t\t\t\t\tvar delta = Math.round(diff / (unknown.length - i)); // no float values, just integer\n\t\t\t\t\tvar index = unknown[i];\n\t\t\t\t\twidth[index] += delta;\n\t\t\t\t\tvar new_width = this._getColumnWidth(columns[index], config, width[index]);\n\t\t\t\t\tif (new_width != width[index]) {\n\t\t\t\t\t\tdelta = new_width - width[index];\n\t\t\t\t\t\twidth[index] = new_width;\n\t\t\t\t\t}\n\t\t\t\t\tdiff -= delta;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor (var i = 0; i < width.length; i++) {\n\t\t\t\tcolumns[i].width = width[i];\n\t\t\t}\n\t\t} else {\n\t\t\tvar changed = (gridWidth != cols_width);\n\t\t\tthis.$config.width = cols_width - 1;\n\t\t\tconfig.grid_width = cols_width;\n\t\t\tif (changed) {\n\t\t\t\tthis.$parent._setContentSize(this.$config.width, null);\n\t\t\t}\n\t\t}\n\n\t},\n\n\t_renderGridHeader: function () {\n\t\tvar gantt = this.$gantt;\n\t\tvar config = this.$getConfig();\n\t\tvar locale = this.$gantt.locale;\n\t\tvar templates = this.$gantt.templates;\n\n\t\tvar columns = this.getGridColumns();\n\t\tif (config.rtl) {\n\t\t\tcolumns = columns.reverse();\n\t\t}\n\t\tvar cells = [];\n\t\tvar width = 0,\n\t\t\tlabels = locale.labels;\n\n\t\tvar lineHeigth = config.scale_height - 1;\n\n\t\tconst renderableComponents = {};\n\n\t\tfor (var i = 0; i < columns.length; i++) {\n\t\t\tvar last = i == columns.length - 1;\n\t\t\tvar col = columns[i];\n\n\t\t\t// ensure columns have non-empty names\n\t\t\tif (!col.name) {\n\t\t\t\tcol.name = gantt.uid() + \"\";\n\t\t\t}\n\n\t\t\tvar colWidth = col.width * 1;\n\n\t\t\tvar gridWidth = this._getGridWidth();\n\t\t\tif (last && gridWidth > width + colWidth)\n\t\t\t\tcol.width = colWidth = gridWidth - width;\n\t\t\twidth += colWidth;\n\t\t\tvar sort = (gantt._sort && col.name == gantt._sort.name) ? (`<div data-column-id=\"${col.name}\" class=\"gantt_sort gantt_${gantt._sort.direction}\"></div>`) : \"\";\n\t\t\tvar cssClass = [\"gantt_grid_head_cell\",\n\t\t\t\t(\"gantt_grid_head_\" + col.name),\n\t\t\t\t(last ? \"gantt_last_cell\" : \"\"),\n\t\t\t\ttemplates.grid_header_class(col.name, col)].join(\" \");\n\n\t\t\tvar style = \"width:\" + (colWidth - (last ? 1 : 0)) + \"px;\";\n\t\t\tvar label = (col.label || labels[\"column_\" + col.name] || labels[col.name]);\n\t\t\tif(typeof label === \"function\"){\n\t\t\t\tlabel = label.call(gantt, col.name, col);\n\t\t\t}\n\t\t\tlabel = label || \"\";\n\t\t\tlet componentLabel = false;\n\t\t\tif(gantt.config.external_render && gantt.config.external_render.isElement(label)){\n\t\t\t\tcomponentLabel = true;\n\t\t\t\trenderableComponents[col.name] = label;\n\t\t\t}\n\n\t\t\tvar ariaAttrs = gantt._waiAria.gridScaleCellAttrString(col, label);\n\n\t\t\tvar cell = \"<div class='\" + cssClass + \"' style='\" + style + \"' \" + ariaAttrs + \n\t\t\t\t\" data-column-id='\" + col.name + \"' column_id='\" + col.name + \"'\" +\n\t\t\t\t\" data-column-name='\" + col.name + \"' data-column-index='\" + i + \"'\" +\n\t\t\t\t\">\" + (!componentLabel ? label : \"<div data-component-container></div>\") + sort + \"</div>\";\n\t\t\tcells.push(cell);\n\t\t}\n\t\tthis.$grid_scale.style.height = (config.scale_height) + \"px\";\n\t\tthis.$grid_scale.style.lineHeight = lineHeigth + \"px\";\n\t\t//this.$grid_scale.style.width = \"inherit\";\n\t\tthis.$grid_scale.innerHTML = cells.join(\"\");\n\t\tfor(let i in renderableComponents){\n\t\t\tgantt.config.external_render.renderElement(renderableComponents[i], this.$grid_scale.querySelector(\"[data-column-id='\" + i + \"'] [data-component-container]\"));\n\t\t}\n\n\t\tif (this._renderHeaderResizers) {\n\t\t\tthis._renderHeaderResizers();\n\t\t}\n\t},\n\n\t_getGridWidth: function () {\n\t\t// TODO: refactor/remove/comment some of _getGridWidth/this.$config.width/this.$state.width, it's not clear what they do\n\t\treturn this.$config.width;\n\t},\n\n\tdestructor: function () {\n\t\tthis._clearLayers(this.$gantt);\n\t\tif (this._mouseDelegates) {\n\t\t\tthis._mouseDelegates.destructor();\n\t\t\tthis._mouseDelegates = null;\n\t\t}\n\t\tthis._unbindStore();\n\t\tthis.$grid = null;\n\t\tthis.$grid_scale = null;\n\t\tthis.$grid_data = null;\n\t\tthis.$gantt = null;\n\t\tif (this.$config.rowStore) {\n\t\t\tthis.$config.rowStore.detachEvent(this._staticBgHandler);\n\t\t\tthis.$config.rowStore = null;\n\t\t}\n\n\t\tthis.callEvent(\"onDestroy\", []);\n\t\tthis.detachAllEvents();\n\t}\n};\n\nexport default Grid;\n","import * as helpers from \"../../utils/helpers\";\n\nexport default function(gantt) {\n\tgantt.load = function(){\n\t\tthrow new Error(\"gantt.load() method is not available in the node.js, use gantt.parse() instead\");\n\t};\n\tgantt.parse = function (data, type) {\n\t\tthis.on_load({xmlDoc: {responseText: data}}, type);\n\t};\n\n\tgantt.serialize = function (type) {\n\t\ttype = type || \"json\";\n\t\treturn this[type].serialize();\n\t};\n\n\t/*\n\ttasks and relations\n\t{\n\tdata:[\n\t\t{\n\t\t\t\"id\":\"string\",\n\t\t\t\"text\":\"...\",\n\t\t\t\"start_date\":\"Date or string\",\n\t\t\t\"end_date\":\"Date or string\",\n\t\t\t\"duration\":\"number\",\n\t\t\t\"progress\":\"0..1\",\n\t\t\t\"parent_id\":\"string\",\n\t\t\t\"order\":\"number\"\n\t\t},...],\n\tlinks:[\n\t\t{\n\t\t\tid:\"string\",\n\t\t\tsource:\"string\",\n\t\t\ttarget:\"string\",\n\t\t\ttype:\"string\"\n\t\t},...],\n\tcollections:{\n\t\t\tcollectionName:[\n\t\t\t\t{key:, label:, optional:...},...\n\t\t\t],...\n\t\t}\n\t}\n\n\t* */\n\n\tgantt.on_load = function (resp, type) {\n\t\tif(resp.xmlDoc && resp.xmlDoc.status === 404){ // work if we don't have a file at current url\n\t\t\tthis.assert(false, \"Failed to load the data from <a href='\" + resp.xmlDoc.responseURL + \"' target='_blank'>\" \n\t\t\t\t+ resp.xmlDoc.responseURL + \"</a>, server returns 404\");\n\t\t\treturn;\n\t\t}\n\t\tif(gantt.$destroyed){\n\t\t\treturn;\n\t\t}\n\t\tthis.callEvent(\"onBeforeParse\", []);\n\t\tif (!type)\n\t\t\ttype = \"json\";\n\t\tthis.assert(this[type], \"Invalid data type:'\" + type + \"'\");\n\n\t\tvar raw = resp.xmlDoc.responseText;\n\n\t\tvar data = this[type].parse(raw, resp);\n\t\tthis._process_loading(data);\n\t};\n\n\tfunction attachAssignmentsToTasks(tasks, assignments) {\n\t\tconst assignmentsByTasks = {};\n\t\tassignments.forEach((a)=>{\n\t\t\tif(!assignmentsByTasks[a.task_id]) {\n\t\t\t\tassignmentsByTasks[a.task_id] = [];\n\t\t\t}\n\t\t\tassignmentsByTasks[a.task_id].push(a);\n\t\t});\n\t\ttasks.forEach((t) => {\n\t\t\tt[gantt.config.resource_property] = assignmentsByTasks[t.id] || [];\n\t\t});\t\n\t}\n\t\n\tgantt._process_loading = function (data) {\n\t\tif(data.collections)\n\t\t\tthis._load_collections(data.collections);\n\n\t\tif(data.resources && this.$data.resourcesStore){\n\t\t\tthis.$data.resourcesStore.parse(data.resources);\n\t\t}\n\t\tif(gantt.config.baselines && data.baselines && this.$data.baselineStore){\n\t\t\tthis.$data.baselineStore.parse(data.baselines);\n\t\t}\n\t\t\n\t\tconst tasks = data.data || data.tasks;\n\t\tif(data.assignments){\n\t\t\tattachAssignmentsToTasks(tasks, data.assignments);\n\t\t}\n\n\t\tthis.$data.tasksStore.parse(tasks);\n\t\tvar links = data.links || ((data.collections && data.collections.links) ? data.collections.links : []);\n\t\tthis.$data.linksStore.parse(links);\n\n\t\t//this._sync_links();\n\t\tthis.callEvent(\"onParse\", []);\n\t\tthis.render();\n\t};\n\n\tgantt._load_collections = function (collections) {\n\t\tvar collections_loaded = false;\n\t\tfor (var key in collections) {\n\t\t\tif (collections.hasOwnProperty(key)) {\n\t\t\t\tcollections_loaded = true;\n\t\t\t\tvar collection = collections[key];\n\t\t\t\t// GS-1728. Create an empty serverList if it doesn't exist\n\t\t\t\tthis.serverList[key] = this.serverList[key] || [];\n\t\t\t\tvar arr = this.serverList[key];\n\t\t\t\tif (!arr) continue;\n\t\t\t\tarr.splice(0, arr.length); //clear old options\n\t\t\t\tfor (var j = 0; j < collection.length; j++) {\n\t\t\t\t\tvar option = collection[j];\n\t\t\t\t\tvar obj = this.copy(option);\n\t\t\t\t\tobj.key = obj.value;// resulting option object\n\n\t\t\t\t\tfor (var option_key in option) {\n\t\t\t\t\t\tif (option.hasOwnProperty(option_key)) {\n\t\t\t\t\t\t\tif (option_key == \"value\" || option_key == \"label\")\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\tobj[option_key] = option[option_key]; // obj['value'] = option['value']\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tarr.push(obj);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (collections_loaded)\n\t\t\tthis.callEvent(\"onOptionsLoad\", []);\n\t};\n\n\tgantt.attachEvent(\"onBeforeTaskDisplay\", function (id, task) {\n\t\treturn !task.$ignore;\n\t});\n\n\tfunction jsonParseError(data){\n\t\tgantt.assert(false, \"Can't parse data: incorrect value of gantt.parse or gantt.load method. \"\n\t\t\t+ \"Actual argument value: \" + JSON.stringify(data));\n\t\tthrow new Error(\"Invalid argument for gantt.parse or gantt.load. An object or a JSON string of format https://docs.dhtmlx.com/gantt/desktop__supported_data_formats.html#json is expected. Actual argument value: \"\n\t\t\t+ JSON.stringify(data));\n\t}\n\n\tgantt.json = {\n\t\tparse: function (data) {\n\t\t\tif(!data){\n\t\t\t\tjsonParseError(data);\n\t\t\t}\n\n\t\t\tif (typeof data == \"string\") {\n\t\t\t\tif (typeof JSON != undefined){\n\t\t\t\t\ttry{\n\t\t\t\t\t\tdata = JSON.parse(data);\n\t\t\t\t\t}\n\t\t\t\t\tcatch(e) {\n\t\t\t\t\t\tjsonParseError(data);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tgantt.assert(false, \"JSON is not supported\");\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(!data.data && !data.tasks){\n\t\t\t\tjsonParseError(data);\n\t\t\t}\n\n\t\t\tif (data.dhx_security)\n\t\t\t\tgantt.security_key = data.dhx_security;\n\t\t\treturn data;\n\t\t},\n\t\tserializeTask: function (task) {\n\t\t\treturn this._copyObject(task);\n\t\t},\n\t\tserializeLink: function (link) {\n\t\t\treturn this._copyLink(link);\n\t\t},\n\t\t_copyLink: function (obj) {\n\t\t\tvar copy = {};\n\t\t\tfor (var key in obj)\n\t\t\t\tcopy[key] = obj[key];\n\t\t\treturn copy;\n\t\t},\n\t\t_copyObject: function (obj) {\n\t\t\tvar copy = {};\n\t\t\tfor (var key in obj) {\n\t\t\t\tif (key.charAt(0) == \"$\")\n\t\t\t\t\tcontinue;\n\t\t\t\tcopy[key] = obj[key];\n\n\t\t\t\tif (helpers.isDate(copy[key])) {\n\t\t\t\t\tcopy[key] = gantt.defined(gantt.templates.xml_format) ? gantt.templates.xml_format(copy[key]) : gantt.templates.format_date(copy[key]);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn copy;\n\t\t},\n\t\tserialize: function () {\n\t\t\tvar tasks = [];\n\t\t\tvar links = [];\n\t\t\tlet baselines = [];\n\n\t\t\tgantt.eachTask(function (obj) {\n\t\t\t\tgantt.resetProjectDates(obj);\n\t\t\t\ttasks.push(this.serializeTask(obj));\n\t\t\t}, gantt.config.root_id, this);\n\n\t\t\tvar rawLinks = gantt.getLinks();\n\t\t\tfor (var i = 0; i < rawLinks.length; i++) {\n\t\t\t\tlinks.push(this.serializeLink(rawLinks[i]));\n\t\t\t}\n\n\t\t\tconst baselineStore = gantt.getDatastore(\"baselines\");\n\t\t\tbaselineStore.eachItem(function(baseline){\n\t\t\t\tconst baselineCopy = gantt.json.serializeTask(baseline);\n\t\t\t\tbaselines.push(baselineCopy);\n\t\t\t});\n\n\t\t\treturn {\n\t\t\t\tdata: tasks,\n\t\t\t\tlinks,\n\t\t\t\tbaselines\n\t\t\t};\n\t\t}\n\t};\n\n\t/*\n\t<data>\n\t\t<task id:\"some\" parent_id=\"0\" progress=\"0.5\">\n\t\t\t<text>My task 1</text>\n\t\t\t<start_date>16.08.2013</start_date>\n\t\t\t<end_date>22.08.2013</end_date>\n\t\t</task>\n\t\t<coll_options>\n\t\t\t<links>\n\t\t\t\t<link source='a1' target='b2' type='c3' />\n\t\t\t</links>\n\t\t</coll_options>\n\t</data>\n\t*/\n\n\tfunction xmlParseError(data){\n\t\tgantt.assert(false, \"Can't parse data: incorrect value of gantt.parse or gantt.load method. \"\n\t\t\t+ \"Actual argument value: \" + JSON.stringify(data));\n\t\tthrow new Error(\"Invalid argument for gantt.parse or gantt.load. An XML of format https://docs.dhtmlx.com/gantt/desktop__supported_data_formats.html#xmldhtmlxgantt20 is expected. Actual argument value: \"\n\t\t\t+ JSON.stringify(data));\n\t}\n\n\tgantt.xml = {\n\t\t_xmlNodeToJSON: function (node, attrs_only) {\n\t\t\tvar t = {};\n\t\t\tfor (var i = 0; i < node.attributes.length; i++)\n\t\t\t\tt[node.attributes[i].name] = node.attributes[i].value;\n\n\t\t\tif (!attrs_only) {\n\t\t\t\tfor (var i = 0; i < node.childNodes.length; i++) {\n\t\t\t\t\tvar child = node.childNodes[i];\n\t\t\t\t\tif (child.nodeType == 1)\n\t\t\t\t\t\tt[child.tagName] = child.firstChild ? child.firstChild.nodeValue : \"\";\n\t\t\t\t}\n\n\t\t\t\tif (!t.text) t.text = node.firstChild ? node.firstChild.nodeValue : \"\";\n\t\t\t}\n\n\t\t\treturn t;\n\t\t},\n\t\t_getCollections: function (loader) {\n\t\t\tvar collection = {};\n\t\t\tvar opts = gantt.ajax.xpath(\"//coll_options\", loader);\n\t\t\tfor (var i = 0; i < opts.length; i++) {\n\t\t\t\tvar bind = opts[i].getAttribute(\"for\");\n\t\t\t\tvar arr = collection[bind] = [];\n\t\t\t\tvar itms = gantt.ajax.xpath(\".//item\", opts[i]);\n\t\t\t\tfor (var j = 0; j < itms.length; j++) {\n\t\t\t\t\tvar itm = itms[j];\n\t\t\t\t\tvar attrs = itm.attributes;\n\t\t\t\t\tvar obj = {key: itms[j].getAttribute(\"value\"), label: itms[j].getAttribute(\"label\")};\n\t\t\t\t\tfor (var k = 0; k < attrs.length; k++) {\n\t\t\t\t\t\tvar attr = attrs[k];\n\t\t\t\t\t\tif (attr.nodeName == \"value\" || attr.nodeName == \"label\")\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\tobj[attr.nodeName] = attr.nodeValue;\n\t\t\t\t\t}\n\t\t\t\t\tarr.push(obj);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn collection;\n\t\t},\n\t\t_getXML: function (text, loader, toptag) {\n\t\t\ttoptag = toptag || \"data\";\n\t\t\tif (!loader.getXMLTopNode) {\n\t\t\t\tloader = gantt.ajax.parse(loader);\n\t\t\t}\n\n\t\t\tvar xml = gantt.ajax.xmltop(toptag, loader.xmlDoc);\n\t\t\tif (!xml || xml.tagName != toptag) {\n\t\t\t\txmlParseError(text);\n\t\t\t}\n\n\t\t\tvar skey = xml.getAttribute(\"dhx_security\");\n\t\t\tif (skey)\n\t\t\t\tgantt.security_key = skey;\n\n\t\t\treturn xml;\n\t\t},\n\t\tparse: function (text, loader) {\n\t\t\tloader = this._getXML(text, loader);\n\t\t\tvar data = {};\n\n\t\t\tvar evs = data.data = [];\n\t\t\tvar xml = gantt.ajax.xpath(\"//task\", loader);\n\n\t\t\tfor (var i = 0; i < xml.length; i++)\n\t\t\t\tevs[i] = this._xmlNodeToJSON(xml[i]);\n\n\t\t\tdata.collections = this._getCollections(loader);\n\t\t\treturn data;\n\t\t},\n\t\t_copyLink: function (obj) {\n\t\t\treturn \"<item id='\" + obj.id + \"' source='\" + obj.source + \"' target='\" + obj.target + \"' type='\" + obj.type + \"' />\";\n\t\t},\n\t\t_copyObject: function (obj) {\n\t\t\treturn \"<task id='\" + obj.id + \"' parent='\" + (obj.parent || \"\") + \"' start_date='\" + obj.start_date + \"' duration='\" + obj.duration + \"' open='\" + (!!obj.open) + \"' progress='\" + obj.progress + \"' end_date='\" + obj.end_date + \"'><![CDATA[\" + obj.text + \"]]></task>\";\n\t\t},\n\t\tserialize: function () {\n\t\t\tvar tasks = [];\n\t\t\tvar links = [];\n\n\t\t\tvar json = gantt.json.serialize();\n\t\t\tfor (var i = 0, len = json.data.length; i < len; i++) {\n\t\t\t\ttasks.push(this._copyObject(json.data[i]));\n\t\t\t}\n\t\t\tfor (var i = 0, len = json.links.length; i < len; i++) {\n\t\t\t\tlinks.push(this._copyLink(json.links[i]));\n\t\t\t}\n\t\t\treturn \"<data>\" + tasks.join(\"\") + \"<coll_options for='links'>\" + links.join(\"\") + \"</coll_options></data>\";\n\t\t}\n\t};\n\n\n\tgantt.oldxml = {\n\t\tparse: function (text, loader) {\n\t\t\tloader = gantt.xml._getXML(text, loader, \"projects\");\n\t\t\tvar data = {collections: {links: []}};\n\n\t\t\tvar evs = data.data = [];\n\t\t\tvar xml = gantt.ajax.xpath(\"//task\", loader);\n\n\t\t\tfor (var i = 0; i < xml.length; i++) {\n\t\t\t\tevs[i] = gantt.xml._xmlNodeToJSON(xml[i]);\n\t\t\t\tvar parent = xml[i].parentNode;\n\n\t\t\t\tif (parent.tagName == \"project\")\n\t\t\t\t\tevs[i].parent = \"project-\" + parent.getAttribute(\"id\");\n\t\t\t\telse\n\t\t\t\t\tevs[i].parent = parent.parentNode.getAttribute(\"id\");\n\t\t\t}\n\n\t\t\txml = gantt.ajax.xpath(\"//project\", loader);\n\t\t\tfor (var i = 0; i < xml.length; i++) {\n\t\t\t\tvar ev = gantt.xml._xmlNodeToJSON(xml[i], true);\n\t\t\t\tev.id = \"project-\" + ev.id;\n\t\t\t\tevs.push(ev);\n\t\t\t}\n\n\t\t\tfor (var i = 0; i < evs.length; i++) {\n\t\t\t\tvar ev = evs[i];\n\t\t\t\tev.start_date = ev.startdate || ev.est;\n\t\t\t\tev.end_date = ev.enddate;\n\t\t\t\tev.text = ev.name;\n\t\t\t\tev.duration = ev.duration / 8;\n\t\t\t\tev.open = 1;\n\t\t\t\tif (!ev.duration && !ev.end_date) ev.duration = 1;\n\t\t\t\tif (ev.predecessortasks)\n\t\t\t\t\tdata.collections.links.push({\n\t\t\t\t\t\ttarget: ev.id,\n\t\t\t\t\t\tsource: ev.predecessortasks,\n\t\t\t\t\t\ttype: gantt.config.links.finish_to_start\n\t\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn data;\n\t\t},\n\t\tserialize: function () {\n\t\t\tgantt.message(\"Serialization to 'old XML' is not implemented\");\n\t\t}\n\t};\n\n\tgantt.serverList = function (name, array) {\n\t\tif (array) {\n\t\t\tthis.serverList[name] = array.slice(0);\n\t\t} else if (!this.serverList[name]) {\n\t\t\tthis.serverList[name] = [];\n\t\t}\n\t\treturn this.serverList[name];\n\t};\n\n};","import * as utils from \"../../utils/utils\";\nimport * as helpers from \"../../utils/helpers\";\n\n\nfunction IsWorkTimeArgument(date, unit, task, id, calendar){\n\tthis.date = date;\n\tthis.unit = unit;\n\tthis.task = task;\n\tthis.id = id;\n\tthis.calendar = calendar;\n\treturn this;\n}\n\nfunction ClosestWorkTimeArgument(date, dir, unit, task, id, calendar){\n\tthis.date = date;\n\tthis.dir = dir;\n\tthis.unit = unit;\n\tthis.task = task;\n\tthis.id = id;\n\tthis.calendar = calendar;\n\treturn this;\n}\n\nfunction CalculateEndDateArgument(start_date, duration, unit, step, task, id, calendar){\n\tthis.start_date = start_date;\n\tthis.duration = duration;\n\tthis.unit = unit;\n\tthis.step = step;\n\tthis.task = task;\n\tthis.id = id;\n\tthis.calendar = calendar;\n\treturn this;\n}\n\nfunction GetDurationArgument(start, end, task, calendar) {\n\tthis.start_date = start;\n\tthis.end_date = end;\n\tthis.task = task;\n\tthis.calendar = calendar;\n\tthis.unit = null;\n\tthis.step = null;\n\treturn this;\n}\n\nvar calendarArgumentsHelper = function(gantt){\n\treturn {\n\t\tgetWorkHoursArguments: function () {\n\t\t\tvar config = arguments[0];\n\t\t\tif (helpers.isDate(config)) {\n\t\t\t\tconfig = {\n\t\t\t\t\tdate: config\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\tconfig = utils.mixin({}, config);\n\t\t\t}\n\n\t\t\tif(!helpers.isValidDate(config.date)){\n\t\t\t\tgantt.assert(false, \"Invalid date argument for getWorkHours method\");\n\t\t\t\tthrow new Error(\"Invalid date argument for getWorkHours method\");\n\t\t\t}\n\n\t\t\treturn config;\n\t\t},\n\t\tsetWorkTimeArguments: function () {\n\t\t\treturn arguments[0];\n\t\t},\n\t\tunsetWorkTimeArguments: function () {\n\t\t\treturn arguments[0];\n\t\t},\n\t\tisWorkTimeArguments: function () {\n\t\t\tvar config = arguments[0];\n\t\t\tif(config instanceof IsWorkTimeArgument){\n\t\t\t\treturn config;\n\t\t\t}\n\n\t\t\tvar processedConfig;\n\t\t\tif (!config.date) {\n\t\t\t\t//IsWorkTimeArgument(date, unit, task, id, calendar)\n\t\t\t\tprocessedConfig = new IsWorkTimeArgument(arguments[0], arguments[1], arguments[2], null, arguments[3]);\n\t\t\t} else {\n\t\t\t\tprocessedConfig = new IsWorkTimeArgument(config.date, config.unit, config.task, null, config.calendar);\n\t\t\t}\n\n\t\t\tprocessedConfig.unit = processedConfig.unit || gantt.config.duration_unit;\n\n\t\t\tif(!helpers.isValidDate(processedConfig.date)){\n\t\t\t\tgantt.assert(false, \"Invalid date argument for isWorkTime method\");\n\t\t\t\tthrow new Error(\"Invalid date argument for isWorkTime method\");\n\t\t\t}\n\n\t\t\treturn processedConfig;\n\t\t},\n\t\tgetClosestWorkTimeArguments: function (arg) {\n\t\t\tvar config = arguments[0];\n\t\t\tif (config instanceof ClosestWorkTimeArgument)\n\t\t\t\treturn config;\n\n\t\t\tvar processedConfig;\n\t\t\tif (helpers.isDate(config)) {\n\t\t\t\tprocessedConfig = new ClosestWorkTimeArgument(config);\n\n\t\t\t} else {\n\t\t\t\tprocessedConfig = new ClosestWorkTimeArgument(\n\t\t\t\t\tconfig.date,\n\t\t\t\t\tconfig.dir,\n\t\t\t\t\tconfig.unit,\n\t\t\t\t\tconfig.task,\n\t\t\t\t\tnull,//config.id,\n\t\t\t\t\tconfig.calendar\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif(config.id){\n\t\t\t\tprocessedConfig.task = config;\n\t\t\t}\n\t\t\tprocessedConfig.dir = config.dir || 'any';\n\t\t\tprocessedConfig.unit = config.unit || gantt.config.duration_unit;\n\n\t\t\tif(!helpers.isValidDate(processedConfig.date)){\n\t\t\t\tgantt.assert(false, \"Invalid date argument for getClosestWorkTime method\");\n\t\t\t\tthrow new Error(\"Invalid date argument for getClosestWorkTime method\");\n\t\t\t}\n\t\t\treturn processedConfig;\n\t\t},\n\n\t\t_getStartEndConfig: function (param) {\n\t\t\tvar argumentType = GetDurationArgument;\n\t\t\tvar config;\n\t\t\tif (param instanceof argumentType)\n\t\t\t\treturn param;\n\n\t\t\tif (helpers.isDate(param)) {\n\t\t\t\tconfig = new argumentType(arguments[0], arguments[1], arguments[2], arguments[3]);\n\t\t\t} else {\n\t\t\t\tconfig = new argumentType(param.start_date, param.end_date, param.task);\n\t\t\t\tif (param.id !== null && param.id !== undefined) {\n\t\t\t\t\tconfig.task = param;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconfig.unit = config.unit || gantt.config.duration_unit;\n\t\t\tconfig.step = config.step || gantt.config.duration_step;\n\t\t\tconfig.start_date = config.start_date || config.start || config.date;\n\n\t\t\tif(!helpers.isValidDate(config.start_date)){\n\t\t\t\tgantt.assert(false, \"Invalid start_date argument for getDuration method\");\n\t\t\t\tthrow new Error(\"Invalid start_date argument for getDuration method\");\n\t\t\t}\n\n\t\t\tif(!helpers.isValidDate(config.end_date)){\n\t\t\t\tgantt.assert(false, \"Invalid end_date argument for getDuration method\");\n\t\t\t\tthrow new Error(\"Invalid end_date argument for getDuration method\");\n\t\t\t}\n\n\t\t\treturn config;\n\t\t},\n\n\t\tgetDurationArguments: function (start, end, unit, step) {\n\t\t\treturn this._getStartEndConfig.apply(this, arguments);\n\t\t},\n\n\t\thasDurationArguments: function (start, end, unit, step) {\n\t\t\treturn this._getStartEndConfig.apply(this, arguments);\n\t\t},\n\n\t\tcalculateEndDateArguments: function (start, duration, unit, step) {\n\t\t\tvar config = arguments[0];\n\t\t\tif (config instanceof CalculateEndDateArgument)\n\t\t\t\treturn config;\n\n\t\t\tvar processedConfig;\n\t\t\t//CalculateEndDateArgument(start_date, duration, unit, step, task, id, calendar)\n\t\t\tif (helpers.isDate(config)) {\n\t\t\t\tprocessedConfig = new CalculateEndDateArgument(\n\t\t\t\t\targuments[0],\n\t\t\t\t\targuments[1],\n\t\t\t\t\targuments[2],\n\t\t\t\t\tundefined,\n\t\t\t\t\targuments[3],\n\t\t\t\t\tundefined,\n\t\t\t\t\targuments[4]\n\t\t\t\t);\n\n\t\t\t} else {\n\t\t\t\tprocessedConfig = new CalculateEndDateArgument(\n\t\t\t\t\tconfig.start_date,\n\t\t\t\t\tconfig.duration,\n\t\t\t\t\tconfig.unit,\n\t\t\t\t\tconfig.step,\n\t\t\t\t\tconfig.task,\n\t\t\t\t\tnull,//config.id,\n\t\t\t\t\tconfig.calendar\n\t\t\t\t);\n\t\t\t}\n\t\t\tif(config.id !== null && config.id !== undefined){\n\t\t\t\tprocessedConfig.task = config;\n\n\t\t\t\t// received a task object as an argument\n\t\t\t\t// ignore 'unit' and 'step' properties in this case, since it's likely a part of data model of a task\n\t\t\t\tprocessedConfig.unit = null;\n\t\t\t\tprocessedConfig.step = null;\n\t\t\t}\n\n\t\t\tprocessedConfig.unit = processedConfig.unit || gantt.config.duration_unit;\n\t\t\tprocessedConfig.step = processedConfig.step || gantt.config.duration_step;\n\n\t\t\tif(!helpers.isValidDate(processedConfig.start_date)){\n\t\t\t\tgantt.assert(false, \"Invalid start_date argument for calculateEndDate method\");\n\t\t\t\tthrow new Error(\"Invalid start_date argument for calculateEndDate method\");\n\t\t\t}\n\n\t\t\treturn processedConfig;\n\t\t}\n\t};\n};\n\n\nexport default calendarArgumentsHelper;","import * as domHelpers from \"../utils/dom_helpers\";\n\nfunction createResizer(gantt, grid){\n// renders resize elements in the grid header\n\tvar _render_grid_header_resize = function () {\n\t\tvar columns = grid.getGridColumns(),\n\t\t\tconfig = grid.$getConfig(),\n\t\t\twidth = 0,\n\t\t\ttotalWidth = grid.$config.width,\n\t\t\tlineHeigth = config.scale_height;\n\n\t\tfor (var i = 0; i < columns.length; i++) {\n\t\t\tvar col = columns[i];\n\n\t\t\tvar pos;\n\t\t\twidth += col.width;\n\t\t\tif(config.rtl){\n\t\t\t\tpos = totalWidth - width;\n\t\t\t}else{\n\t\t\t\tpos = width;\n\t\t\t}\n\n\t\t\t// GS-205. don't add resizer for the last column\n\t\t\tif (col.resize && i != columns.length - 1) {\n\t\t\t\tvar resize_el = document.createElement(\"div\");\n\t\t\t\tresize_el.className = \"gantt_grid_column_resize_wrap\";\n\t\t\t\tresize_el.style.top = \"0px\";\n\t\t\t\tresize_el.style.height = lineHeigth + \"px\";\n\t\t\t\tresize_el.innerHTML = \"<div class='gantt_grid_column_resize'></div>\";\n\t\t\t\tresize_el.setAttribute(config.grid_resizer_column_attribute, i);\n\t\t\t\tresize_el.setAttribute(\"column_index\", i); // hardcoded for backward compatibility\n\n\t\t\t\tgantt._waiAria.gridSeparatorAttr(resize_el);\n\n\t\t\t\tgrid.$grid_scale.appendChild(resize_el);\n\n\t\t\t\tresize_el.style.left = Math.max(0, pos) + \"px\";\n\t\t\t}\n\t\t}\n\t};\n\n\tvar _grid_resize = {\n\t\tcolumn_before_start: gantt.bind(function (dnd, obj, e) {\n\t\t\tvar config = grid.$getConfig();\n\n\t\t\tvar el = domHelpers.locateAttribute(e, config.grid_resizer_column_attribute);\n\t\t\tif (!el) return false;\n\n\t\t\tif (!domHelpers.closest(el,\".gantt_grid_column_resize_wrap\")) {\n\t\t\t\t// column resize should work only when we use the resizer\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tvar column_index = this.locate(e, config.grid_resizer_column_attribute),\n\t\t\t\tcolumn = grid.getGridColumns()[column_index];\n\n\t\t\tif (grid.callEvent(\"onColumnResizeStart\", [column_index, column]) === false)\n\t\t\t\treturn false;\n\t\t}, gantt),\n\n\t\tcolumn_after_start: gantt.bind(function (dnd, obj, e) {\n\t\t\tvar config = grid.$getConfig();\n\n\t\t\tvar column_index = this.locate(e, config.grid_resizer_column_attribute);\n\t\t\tdnd.config.marker.innerHTML = \"\";\n\t\t\tdnd.config.marker.className += \" gantt_grid_resize_area\";\n\t\t\tdnd.config.marker.style.height = grid.$grid.offsetHeight + \"px\";\n\t\t\tdnd.config.marker.style.top = \"0px\";\n\t\t\tdnd.config.drag_index = column_index;\n\n\t\t}, gantt),\n\n\t\tcolumn_drag_move: gantt.bind(function (dnd, obj, e) {\n\t\t\tvar config = grid.$getConfig();\n\n\t\t\tvar dd = dnd.config,\n\t\t\t\tcolumns = grid.getGridColumns();\n\t\t\tvar index = parseInt(dd.drag_index, 10);\n\t\t\tvar target_column = columns[index];\n\t\t\tvar\tpos = domHelpers.getNodePosition(grid.$grid_scale),\n\t\t\t\tpointerPosition = parseInt(dd.marker.style.left, 10),\n\t\t\t\tminPointerPosition = target_column.min_width ? target_column.min_width : config.min_grid_column_width,\n\t\t\t\tmaxPointerPosition = grid.$grid_data.offsetWidth,// - config.min_grid_column_width * (columns.length - dd.drag_index - 2),// 1 for current column + 1 for last column\n\t\t\t\tmarkerStartPosition = 0,\n\t\t\t\tmarker_width = 0;\n\n\t\t\t\n\t\t/*\tif(config.rtl){\n\t\t\t\tindex = columns.length - 1 - index;\n\t\t\t\tcolumns = columns.reverse();\n\t\t\t}*/\n\n\t\t\tif(!config.rtl){\n\t\t\t\tpointerPosition -= pos.x - 1;\n\t\t\t}else{\n\t\t\t\tpointerPosition = (pos.x + pos.width - 1) - pointerPosition;\n\t\t\t}\n\n\t\t\t//pointerPosition -= pos.x - 1;\n\t\t\tfor (var i = 0; i < index; i++) {\n\t\t\t\tminPointerPosition += columns[i].width;\n\t\t\t\tmarkerStartPosition += columns[i].width;\n\t\t\t}\n\n\t\t\tif (pointerPosition < minPointerPosition) {\n\t\t\t\tpointerPosition = minPointerPosition;\n\t\t\t}\n\n\t\t\tif (config.keep_grid_width) {\n\t\t\t\tvar limit_max = 0;\n\t\t\t\tfor (var i=index+1; i<columns.length; i++) {\n\t\t\t\t\tif (columns[i].min_width)\n\t\t\t\t\t\tmaxPointerPosition -= columns[i].min_width;\n\t\t\t\t\telse if (config.min_grid_column_width)\n\t\t\t\t\t\tmaxPointerPosition -= config.min_grid_column_width;\n\n\t\t\t\t\tif (columns[i].max_width && limit_max !== false)\n\t\t\t\t\t\tlimit_max += columns[i].max_width;\n\t\t\t\t\telse\n\t\t\t\t\t\tlimit_max = false;\t\t\t\t\t\n\t\t\t\t}\n\n\t\t\t\t// we have to restrict min value if only ALL right-side columns have 'max_width' field\n\t\t\t\tif (limit_max) {\n\t\t\t\t\tminPointerPosition = grid.$grid_data.offsetWidth - limit_max;\n\t\t\t\t}\n\t\t\t\tif (pointerPosition < minPointerPosition) {\n\t\t\t\t\tpointerPosition = minPointerPosition;\n\t\t\t\t}\n\n\t\t\t\tif (pointerPosition > maxPointerPosition) {\n\t\t\t\t\tpointerPosition = maxPointerPosition;\n\t\t\t\t}\n\t\t\t} else if (!grid.$config.scrollable) {\n\t\t\t\tvar targetWidth = pointerPosition;\n\t\t\t\tvar maxWidth = gantt.$container.offsetWidth;\n\n\t\t\t\tvar rightColumnsWidth = 0;\n\t\t\t\t// 25 is a scrollbar width. due to GS-1314 fix, the grid should always be visible\n\t\t\t\t// because of that, the internal grid width can be larger than the visible grid width\n\t\t\t\tif (grid.$grid_data.offsetWidth <= (maxWidth - 25)){\n\t\t\t\t\tfor (var i=index+1; i<columns.length; i++) {\n\t\t\t\t\t\trightColumnsWidth += columns[i].width;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// GS-627. When the grid is not scrollable and occupies almost all Gantt container's width\n\t\t\t\t\tfor (var i=index+1; i >= 0; i--) {\n\t\t\t\t\t\trightColumnsWidth += columns[i].width;\n\t\t\t\t\t}\n\t\t\t\t\trightColumnsWidth = maxWidth - rightColumnsWidth;\n\t\t\t\t}\n\n\t\t\t\t// in case if something went wrong in the previous part\n\t\t\t\tif (rightColumnsWidth > maxWidth){\n\t\t\t\t\trightColumnsWidth -= maxWidth;\n\t\t\t\t}\n\n\t\t\t\t// prevent grid from occupying the whole layout cell, which would disable the timeline\n\t\t\t\tvar parentLayout = grid.$parent.$parent;\n\t\t\t\tif(parentLayout && parentLayout.$config.mode == \"y\"){\n\t\t\t\t\tvar parentWidth = parentLayout.$lastSize.x;\n\t\t\t\t\tmaxWidth = Math.min(maxWidth, parentWidth - (parentLayout.$cells.length - 1));\n\t\t\t\t}\n\t\n\t\t\t\tif(targetWidth + rightColumnsWidth > maxWidth){\n\t\t\t\t\tpointerPosition = maxWidth - rightColumnsWidth;\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tdd.left = pointerPosition - 1;// -1 for border\n\n\t\t\tmarker_width = Math.abs(pointerPosition - markerStartPosition);\n\n\t\t\t// column.max_width - maximum width of the column, user defined\n\t\t\tif (target_column.max_width && marker_width > target_column.max_width)\n\t\t\t\tmarker_width = target_column.max_width;\n\n\t\t\tif(config.rtl){\n\t\t\t\tmarkerStartPosition = (pos.width - markerStartPosition) + 2 - marker_width;\n\t\t\t}\n\t\t\tdd.marker.style.top = pos.y + \"px\";\n\t\t\tdd.marker.style.left = pos.x - 1 + markerStartPosition + \"px\";\n\t\t\tdd.marker.style.width = marker_width + \"px\";\n\n\t\t\tgrid.callEvent(\"onColumnResize\", [index, columns[index], marker_width - 1]);\n\t\t\treturn true;\n\t\t}, gantt),\n\n\t\tcolumn_drag_end: gantt.bind(function (dnd, obj, e) {\n\t\t\tvar config = grid.$getConfig();\n\t\t\tvar columns = grid.getGridColumns(),\n\t\t\t\tcolumns_width = 0,\n\t\t\t\tindex = parseInt(dnd.config.drag_index, 10),\n\t\t\t\ttarget_column = columns[index];\n\n\t\t\t// var colIndex = index;\n\t\t\t/*if(config.rtl){\n\t\t\t\tcolIndex = columns.length - 1 - target_index;\n\t\t\t\tcolumns = columns.reverse();\n\t\t\t}*/\n\n\t\t\tfor (var i = 0; i < index; i++) {\n\t\t\t\tcolumns_width += columns[i].width;\n\t\t\t}\n\n\t\t\tvar final_width = (target_column.min_width && (dnd.config.left - columns_width) < target_column.min_width) ?\n\t\t\t\ttarget_column.min_width : (dnd.config.left - columns_width);\n\n\t\t\tif (target_column.max_width && target_column.max_width < final_width) // TODO: probably can be omitted\n\t\t\t\tfinal_width = target_column.max_width;\n\n\t\t\tif (grid.callEvent(\"onColumnResizeEnd\", [index, target_column, final_width]) === false)\n\t\t\t\treturn;\n\n\t\t\tif (target_column.width == final_width)\n\t\t\t\treturn;\n\n\t\t\ttarget_column.width = final_width;\n\n\t\t\tif (config.keep_grid_width) {\n\t\t\t\tcolumns_width = config.grid_width;\n\t\t\t} else {\n\t\t\t\t// in other case we set a new grid width and call gantt render\n\t\t\t\tfor (var i = index, l = columns.length; i < l; i++) {\n\t\t\t\t\tcolumns_width += columns[i].width;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tgrid.callEvent(\"onColumnResizeComplete\", [columns, grid._setColumnsWidth(columns_width, index)]);\n\n\t\t\tif(!grid.$config.scrollable){\n\t\t\t\tgantt.$layout._syncCellSizes(grid.$config.group, {value: config.grid_width, isGravity: false});\n\t\t\t}\n\t\t\t//grid.callEvent(\"onColumnResizeComplete\", [columns, columns_width]);\n\n\t\t\tthis.render();\n\t\t}, gantt)\n\t};\n\n// calls the initialization of the D'n'D events for resize elements\n\tvar _init_resize = function () {\n\t\tvar DnD = gantt.$services.getService(\"dnd\");\n\n\t\tvar config = grid.$getConfig();\n\n\t\tvar dnd = new DnD(grid.$grid_scale, {updates_per_second: 60});\n\t\tif (gantt.defined(config.dnd_sensitivity))\n\t\t\tdnd.config.sensitivity = config.dnd_sensitivity;\n\n\t\tdnd.attachEvent(\"onBeforeDragStart\", function (obj, e) {\n\t\t\treturn _grid_resize.column_before_start(dnd, obj, e);\n\t\t});\n\t\tdnd.attachEvent(\"onAfterDragStart\", function (obj, e) {\n\t\t\treturn _grid_resize.column_after_start(dnd, obj, e);\n\t\t});\n\t\tdnd.attachEvent(\"onDragMove\", function (obj, e) {\n\t\t\treturn _grid_resize.column_drag_move(dnd, obj, e);\n\t\t});\n\t\tdnd.attachEvent(\"onDragEnd\", function (obj, e) {\n\t\t\treturn _grid_resize.column_drag_end(dnd, obj, e);\n\t\t});\n\n\t};\n\n\treturn {\n\t\tinit: _init_resize,\n\t\tdoOnRender: _render_grid_header_resize\n\t};\n}\n\nexport default createResizer;\n","import * as domHelpers from \"../utils/dom_helpers\";\n\nfunction createRowResizer(gantt, grid){\n\n\tvar _task_grid_row_resize = {\n\t\trow_before_start: gantt.bind(function (dnd, obj, e) {\n\t\t\tvar config = grid.$getConfig();\n\t\t\tvar store = grid.$config.rowStore;\n\n\t\t\tvar el = domHelpers.locateAttribute(e, config.task_grid_row_resizer_attribute);\n\t\t\tif (!el) return false;\n\n\t\t\tvar row_id = this.locate(e, config.task_grid_row_resizer_attribute),\n\t\t\t\trow = store.getItem(row_id);\n\n\t\t\tif (grid.callEvent(\"onBeforeRowResize\", [row]) === false)\n\t\t\t\treturn false;\n\t\t}, gantt),\n\n\t\trow_after_start: gantt.bind(function (dnd, obj, e) {\n\t\t\tvar config = grid.$getConfig();\n\n\t\t\tvar row_id = this.locate(e, config.task_grid_row_resizer_attribute);\n\t\t\tdnd.config.marker.innerHTML = \"\";\n\n\t\t\tdnd.config.marker.className += \" gantt_row_grid_resize_area\";\n\t\t\tdnd.config.marker.style.width = grid.$grid.offsetWidth + \"px\";\n\t\t\tdnd.config.drag_id = row_id;\n\n\t\t}, gantt),\n\n\t\trow_drag_move: gantt.bind(function (dnd, obj, e) {\n\t\t\tvar store = grid.$config.rowStore;\n\t\t\tvar config = grid.$getConfig();\n\t\t\tvar dd = dnd.config;\n\t\t\tvar id = dd.drag_id,\n\t\t\t\titemHeight = grid.getItemHeight(id),\n\t\t\t\titemTop = grid.getItemTop(id) - obj.scrollTop;\n\t\t\tvar pos = domHelpers.getNodePosition(grid.$grid_data),\n\t\t\t\tpointerPosition = parseInt(dd.marker.style.top, 10),\n\t\t\t\tmarkerStartPosition = itemTop + pos.y,\n\t\t\t\tmarker_height = 0,\n\t\t\t\tminPointerPosition = config.min_task_grid_row_height;\n\n\t\t\tmarker_height = pointerPosition - markerStartPosition;\n\t\t\tif(marker_height < minPointerPosition){\n\t\t\t\tmarker_height = minPointerPosition;\n\t\t\t}\n\n\t\t\tdd.marker.style.left = pos.x + \"px\";\n\t\t\tdd.marker.style.top = markerStartPosition - 1 + \"px\";\n\t\t\tdd.marker.style.height = Math.abs(marker_height) + 1 + \"px\";\n\n\t\t\tdd.marker_height = marker_height;\n\t\t\t\n\t\t\tgrid.callEvent(\"onRowResize\", [id, store.getItem(id), marker_height + itemHeight]);\n\t\t\treturn true;\n\t\t}, gantt),\n\n\t\trow_drag_end: gantt.bind(function (dnd, obj, e) {\n\t\t\tvar store = grid.$config.rowStore;\n\t\t\tvar dd = dnd.config;\n\t\t\tvar id = dd.drag_id,\n\t\t\t\titem = store.getItem(id),\n\t\t\t\toldItemHeight = grid.getItemHeight(id);\n\n\t\t\tvar finalHeight = dd.marker_height;\n\n\t\t\tif (grid.callEvent(\"onBeforeRowResizeEnd\", [id, item, finalHeight]) === false)\n\t\t\t\treturn;\n\n\t\t\tif (item.row_height == finalHeight)\n\t\t\t\treturn;\n\n\t\t\titem.row_height = finalHeight;\n\t\t\t// GS-2275: case for resizing resource grid row and others\n\t\t\tstore.updateItem(id);\n\t\t\tgrid.callEvent(\"onAfterRowResize\", [id, item, oldItemHeight, finalHeight]);\n\n\t\t\tthis.render();\n\t\t}, gantt)\n\t};\n\n\t// calls the initialization of the D'n'D events for resize elements\n\tvar _init_resize = function () {\n\n\t\tvar DnD = gantt.$services.getService(\"dnd\");\n\n\t\tvar config = grid.$getConfig();\n\n\t\tvar dnd = new DnD(grid.$grid_data, {updates_per_second: 60});\n\t\tif (gantt.defined(config.dnd_sensitivity))\n\t\t\tdnd.config.sensitivity = config.dnd_sensitivity;\n\n\t\tdnd.attachEvent(\"onBeforeDragStart\", function (obj, e) {\n\t\t\treturn _task_grid_row_resize.row_before_start(dnd, obj, e);\n\t\t});\n\t\tdnd.attachEvent(\"onAfterDragStart\", function (obj, e) {\n\t\t\treturn _task_grid_row_resize.row_after_start(dnd, obj, e);\n\t\t});\n\t\tdnd.attachEvent(\"onDragMove\", function (obj, e) {\n\t\t\treturn _task_grid_row_resize.row_drag_move(dnd, obj, e);\n\t\t});\n\t\tdnd.attachEvent(\"onDragEnd\", function (obj, e) {\n\t\t\treturn _task_grid_row_resize.row_drag_end(dnd, obj, e);\n\t\t});\n\n\t};\n\n\treturn {\n\t\tinit: _init_resize\n\t};\n}\n\nexport default createRowResizer;","import * as utils from \"../../../utils/utils\";\nfunction WorkTimeCalendarMerger(){\n}\n\nWorkTimeCalendarMerger.prototype = {\n\n\n\t/**\n\t * convert hours array items into objects, e.g. [8, 12, 17, 18] -> [{start: 8, end: 12}, {start:17, end:18}]\n\t * @param {Array} hoursArray\n\t */\n\t_getIntervals: function(hoursArray){\n\t\tvar result = [];\n\t\tfor(var i = 0; i < hoursArray.length; i += 2){\n\n\t\t\tresult.push({\n\t\t\t\tstart: hoursArray[i],\n\t\t\t\tend: hoursArray[i+1]\n\t\t\t});\n\t\t}\n\t\treturn result;\n\t},\n\n\t/**\n\t * Convert ranges config into hours array\n\t * [{start: 8, end: 12}, {start:17, end:18}] --> [8, 12, 17, 18]\n\t * @param {*} intervalsArray\n\t */\n\t_toHoursArray: function(intervalsArray){\n\t\tvar result = [];\n\n\t\tfunction toFixed(value){\n\t\t\tvar str = String(value);\n\t\t\tif(str.length < 2){\n\t\t\t\tstr = \"0\" + str;\n\t\t\t}\n\t\t\treturn str;\n\t\t}\n\t\tfunction formatHHMM(secondsValue){\n\t\t\tvar hours = Math.floor(secondsValue / (60*60));\n\t\t\tvar minutePart = secondsValue - hours * 60 * 60;\n\n\t\t\tvar minutes = Math.floor(minutePart / (60));\n\t\t\treturn hours + \":\" + toFixed(minutes);\n\t\t}\n\t\tfor(var i = 0; i < intervalsArray.length; i++){\n\t\t\tresult.push(\n\t\t\t\tformatHHMM(intervalsArray[i].start) +\n\t\t\t\t\"-\" +\n\t\t\t\tformatHHMM(intervalsArray[i].end)\n\t\t\t);\n\t\t}\n\t\treturn result;\n\t},\n\n\t/**\n\t * Build intersection of hour intervals. e.g.\n\t * first: [{start: 8, end: 12}, {start:13, end:18}]\n\t * second: [{start: 10, end: 15}]\n\t * result: [{start: 10, end: 12}, {start: 13, end: 15}]\n\t * @param {Array} first\n\t * @param {Array} second\n\t */\n\t_intersectHourRanges: function(first, second){\n\t\tvar result = [];\n\n\t\tvar baseArray = first.length > second.length ? first : second;\n\t\tvar overridesArray = first === baseArray ? second: first;\n\t\tbaseArray = baseArray.slice();\n\t\toverridesArray = overridesArray.slice();\n\n\t\tvar result = [];\n\t\tfor(var i = 0; i < baseArray.length; i++){\n\t\t\tvar base = baseArray[i];\n\n\t\t\tfor(var j = 0; j < overridesArray.length; j++){\n\t\t\t\tvar current = overridesArray[j];\n\t\t\t\tif(current.start < base.end && current.end > base.start){\n\t\t\t\t\tresult.push({\n\t\t\t\t\t\tstart: Math.max(base.start, current.start),\n\t\t\t\t\t\tend: Math.min(base.end, current.end)\n\t\t\t\t\t});\n\t\t\t\t\tif(base.end > current.end){\n\t\t\t\t\t\toverridesArray.splice(j, 1);\n\t\t\t\t\t\tj--;\n\t\t\t\t\t\ti--;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t},\n\n\t/**\n\t * Reduce the number of ranges in config when possible,\n\t * joins ranges that can be merged\n\t * parts: [{start: 8, end: 12}, {start:12, end:13}, {start: 15, end: 17}]\n\t * result: [{start: 8, end: 13}, {start: 15, end: 17}]\n\t * @param {Array} parts\n\t */\n\t_mergeAdjacentIntervals: function(parts){\n\t\tvar result = parts.slice();\n\t\tresult.sort(function(a, b){\n\t\t\treturn a.start - b.start;\n\t\t});\n\t\tvar base = result[0];\n\t\tfor(var i = 1; i < result.length; i++){\n\t\t\tvar current = result[i];\n\t\t\tif(current.start <= base.end){\n\t\t\t\tif(current.end > base.end){\n\t\t\t\t\tbase.end = current.end;\n\t\t\t\t}\n\t\t\t\tresult.splice(i, 1);\n\t\t\t\ti--;\n\t\t\t}else{\n\t\t\t\tbase = current;\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t},\n\n\t_mergeHoursConfig: function(firstHours, secondHours){\n\t\t//var firstIntervals = this._getIntervals(firstHours);\n\t\t//var secondIntervals = this._getIntervals(secondHours);\n\n\t\treturn this._mergeAdjacentIntervals(\n\t\t\tthis._intersectHourRanges(firstHours, secondHours)\n\t\t);\n\t},\n\n\tmerge: function(first, second){\n\t\tconst firstCalendar = utils.copy(first.getConfig());\n\t\tconst secondCalendar = utils.copy(second.getConfig());\n\n\t\tconst firstConfig = firstCalendar.parsed;\n\t\tconst secondConfig = secondCalendar.parsed;\n\n\t\t// GS-2101. The customWeeks config shouldn't have parsed values as we'll parse them later\n\t\tfirstConfig.customWeeks = firstCalendar.customWeeks;\n\t\tsecondConfig.customWeeks = secondCalendar.customWeeks;\n\n\t\tvar mergedSettings = {\n\t\t\thours: this._toHoursArray(this._mergeHoursConfig(firstConfig.hours, secondConfig.hours)),\n\t\t\tdates: {},\n\t\t\tcustomWeeks: {}\n\t\t};\n\n\t\tconst processCalendar = (config1, config2) => {\n\t\t\tfor (let i in config1.dates) {\n\t\t\t\tconst date1 = config1.dates[i];\n\t\n\t\t\t\t// dates contain day-of-week rules [0-7] and rules for specific dates (js date timestamps) - set false date rules initially\n\t\t\t\tif (+i > 1000) {\n\t\t\t\t\tmergedSettings.dates[i] = false;\n\t\t\t\t}\n\t\t\t\t// Check if the key exists in the fisrt calendar object\n\t\t\t\tfor (const key in config2.dates) {\n\t\t\t\t\tconst date2 = config2.dates[key];\n\t\n\t\t\t\t\t// Logical AND for week days\n\t\t\t\t\tif (key == i) {\n\t\t\t\t\t\tmergedSettings.dates[i] = !!(date1 && date2);\n\t\t\t\t\t}\n\t\n\t\t\t\t\t// Handle case where dates are arrays\n\t\t\t\t\tif (Array.isArray(date1)) {\n\t\t\t\t\t\tconst hours2 = Array.isArray(date2) ? date2 : config2.hours;\n\t\t\t\t\t\tmergedSettings.dates[i] = this._toHoursArray(this._mergeHoursConfig(date1, hours2));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\n\t\t// Check both calendars\n\t\tprocessCalendar(firstConfig, secondConfig);\n\t\tprocessCalendar(secondConfig, firstConfig);\n\n\t\t// transfer and overwrite custom week calendars\n\t\tif(firstConfig.customWeeks){\n\t\t\tfor(var i in firstConfig.customWeeks){\n\t\t\t\tmergedSettings.customWeeks[i] = firstConfig.customWeeks[i];\n\t\t\t}\n\t\t}\n\t\tif(secondConfig.customWeeks){\n\t\t\tfor(var i in secondConfig.customWeeks){\n\t\t\t\t// GS-2101. If both calendars have the same name for a period, we need to rename it\n\t\t\t\tif (mergedSettings.customWeeks[i]){\n\t\t\t\t\tmergedSettings.customWeeks[i + \"_second\"] = secondConfig.customWeeks[i];\n\t\t\t\t} else {\n\t\t\t\t\tmergedSettings.customWeeks[i] = secondConfig.customWeeks[i];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn mergedSettings;\n\n\t}\n\n};\n\nexport default WorkTimeCalendarMerger;","\n\nimport { IWorkUnitCache } from \"./workunit_cache_interface\";\n\nexport class WorkUnitsMapCache implements IWorkUnitCache {\n\tprivate _cache: Map<string, Array<Map<string, boolean>>>;\n\tconstructor() {\n\t\tthis.clear();\n\t}\n\n\tgetItem(unit: string, timestamp: string, value: Date): number|boolean {\n\t\tif (this._cache.has(unit)) {\n\t\t\tconst unitCache = this._cache.get(unit);\n\n\t\t\tconst subCache = unitCache[value.getFullYear()];\n\t\t\tif (subCache && subCache.has(timestamp)) {\n\t\t\t\treturn subCache.get(timestamp);\n\t\t\t}\n\t\t}\n\n\t\treturn -1;\n\t}\n\tsetItem(unit: string, timestamp: string, value: boolean, rawValue: Date): void {\n\t\tif (!unit || !timestamp) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst cache = this._cache;\n\t\tconst year = rawValue.getFullYear();\n\n\t\tlet unitCache;\n\t\tif (!cache.has(unit)) {\n\t\t\tunitCache = [];\n\t\t\tcache.set(unit, unitCache);\n\t\t} else {\n\t\t\tunitCache = cache.get(unit);\n\t\t}\n\n\t\tlet yearCache = unitCache[year];\n\t\tif(!yearCache){\n\t\t\tyearCache = unitCache[year] = new Map<string, boolean>();\n\t\t}\n\n\n\t\tyearCache.set(timestamp, value);\n\t}\n\tclear(): void{\n\t\tthis._cache = new Map<string, Array<Map<string, boolean>>>();\n\t}\n}","import { IWorkUnitCache } from \"./workunit_cache_interface\";\n\nexport class WorkUnitsObjectCache implements IWorkUnitCache {\n\tprivate _cache: any;\n\tconstructor() {\n\t\tthis.clear();\n\t}\n\n\tgetItem(unit: string, timestamp: string, value: Date): number|boolean {\n\t\tconst cache = this._cache;\n\t\tif (cache && cache[unit]) {\n\t\t\tconst units = cache[unit];\n\t\t\tif(units === undefined){\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t\tconst subCache = units[value.getFullYear()];\n\t\t\tif (subCache && subCache[timestamp] !== undefined) {\n\t\t\t\treturn subCache[timestamp];\n\t\t\t}\n\t\t}\n\n\t\treturn -1;\n\t}\n\tsetItem(unit: string, timestamp: string, value: boolean, rawValue: Date): void {\n\t\tif (!unit || !timestamp) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst cache = this._cache;\n\n\t\tif (!cache) {\n\t\t\treturn;\n\t\t}\n\t\tif (!cache[unit]) {\n\t\t\tcache[unit] = [];\n\t\t}\n\t\tconst unitCache = cache[unit];\n\n\t\tconst year = rawValue.getFullYear();\n\t\tlet yearCache = unitCache[year];\n\t\tif(!yearCache){\n\t\t\tyearCache = unitCache[year] = {};\n\t\t}\n\t\tyearCache[timestamp] = value;\n\t}\n\tclear(): void{\n\t\tthis._cache = {};\n\t}\n}","\n\nexport class LargerUnitsCache {\n\tprivate _weekCache: Map<number, number>;\n\tprivate _monthCache: Map<number, number>;\n\tprivate _calendar: any;\n\tconstructor(calendar) {\n\t\tthis.clear();\n\t\tthis._calendar = calendar;\n\t}\n\n\tgetMinutesPerWeek = (weekStart: Date) => {\n\t\tconst key = weekStart.valueOf();\n\n\t\tif(this._weekCache.has(key)){\n\t\t\treturn this._weekCache.get(key);\n\t\t}\n\n\t\tconst calendar = this._calendar;\n\t\tconst gantt = this._calendar.$gantt;\n\n\t\tlet minutesPerWeek = 0;\n\t\tlet start = gantt.date.week_start(new Date(weekStart));\n\t\tfor(let i = 0; i < 7; i++){\n\t\t\tminutesPerWeek += calendar.getHoursPerDay(start) * 60;\n\t\t\tstart = gantt.date.add(start, 1, \"day\");\n\t\t}\n\n\t\tthis._weekCache.set(key, minutesPerWeek);\n\t\treturn minutesPerWeek;\n\t};\n\n\tgetMinutesPerMonth = (monthStart: Date) => {\n\t\tconst key = monthStart.valueOf();\n\n\t\tif(this._monthCache.has(key)){\n\t\t\treturn this._monthCache.get(key);\n\t\t}\n\n\t\tconst calendar = this._calendar;\n\t\tconst gantt = this._calendar.$gantt;\n\n\t\tlet minutesPerMonth = 0;\n\t\tlet start = gantt.date.week_start(new Date(monthStart));\n\t\tconst nextMonth = gantt.date.add(start, 1, \"month\").valueOf();\n\t\twhile(start.valueOf() < nextMonth){\n\t\t\tminutesPerMonth += calendar.getHoursPerDay(start) * 60;\n\t\t\tstart = gantt.date.add(start, 1, \"day\");\n\t\t}\n\n\t\tthis._monthCache.set(key, minutesPerMonth);\n\t\treturn minutesPerMonth;\n\t};\n\n\tclear = (): void => {\n\t\tthis._weekCache = new Map<number, number>();\n\t\tthis._monthCache = new Map<number, number>();\n\t};\n}","export class DateDurationCache  {\n\tprivate _cache: any;\n\tconstructor() {\n\t\tthis.clear();\n\t}\n\n\t_getCacheObject(startDate: Date, unit: string, step:number){\n\t\tconst cache = this._cache;\n\t\tif (!cache[unit]) {\n\t\t\tcache[unit] = [];\n\t\t}\n\t\tlet unitCache = cache[unit];\n\t\tif(!unitCache) {\n\t\t\tunitCache = cache[unit] = {};\n\t\t}\n\n\t\tlet stepCache = unitCache[step];\n\t\tif(!stepCache) {\n\t\t\tstepCache = unitCache[step] = {};\n\t\t}\n\n\t\tconst year = startDate.getFullYear();\n\t\tlet yearCache = stepCache[year];\n\t\tif(!yearCache){\n\t\t\tyearCache = stepCache[year] = {durations: {}, endDates: {}};\n\t\t}\n\n\t\treturn yearCache;\n\t}\n\t_endDateCacheKey(startDate: number, duration: number){\n\t\treturn String(startDate) + \"-\" + String(duration);\n\t}\n\t_durationCacheKey(startDate: number, endDate: number){\n\t\treturn String(startDate) + \"-\" + String(endDate);\n\t}\n\tgetEndDate(startDate: Date, duration: number, unit: string, step: number, compute: () => Date): number|null{\n\t\tconst cache = this._getCacheObject(startDate, unit, step);\n\n\t\tconst startDateTimestamp = startDate.valueOf();\n\t\tconst key = this._endDateCacheKey(startDateTimestamp, duration);\n\t\tlet endDate;\n\t\tif(cache.endDates[key] === undefined){\n\t\t\tconst result = compute();\n\t\t\tconst resultTimestamp = result.valueOf();\n\t\t\tcache.endDates[key] = resultTimestamp;\n\t\t\tcache.durations[this._durationCacheKey(startDateTimestamp, resultTimestamp)] = duration;\n\t\t\tendDate = result;\n\t\t}else{\n\t\t\tendDate = new Date(cache.endDates[key]);\n\t\t}\n\n\t\treturn endDate;\n\t}\n\n\tgetDuration(startDate: Date, endDate: Date, unit: string, step: number, compute: () => number): number|null{\n\t\tconst cache = this._getCacheObject(startDate, unit, step);\n\n\t\tconst startDateTimestamp = startDate.valueOf();\n\t\tconst endDateTimestamp = endDate.valueOf();\n\t\tconst key = this._durationCacheKey(startDateTimestamp, endDateTimestamp);\n\t\tlet duration;\n\t\tif(cache.durations[key] === undefined){\n\t\t\tconst result = compute();\n\t\t\tcache.durations[key] = result.valueOf();\n\n\t\t\t// can't populate end date due to logic of end date calculation, current unit tests capture it\n\t\t\t// cache.endDates[this._endDateCacheKey(startDateTimestamp, result)] = endDateTimestamp;\n\t\t\tduration = result;\n\t\t}else{\n\t\t\tduration = cache.durations[key];\n\t\t}\n\n\t\treturn duration;\n\t}\n\n\tclear(): void{\n\t\tthis._cache = {};\n\t}\n}","import {createCacheObject} from \"./work_unit_cache\";\nimport {LargerUnitsCache} from \"./work_unit_cache\";\nimport * as utils from \"../../../utils/utils\";\nimport {DateDurationCache} from \"./work_unit_cache/date_duration_cache\";\n\nfunction CalendarWorkTimeStrategy(gantt, argumentsHelper) {\n\tthis.argumentsHelper = argumentsHelper;\n\tthis.$gantt = gantt;\n\tthis._workingUnitsCache = createCacheObject();\n\tthis._largeUnitsCache = new LargerUnitsCache(this);\n\tthis._dateDurationCache = new DateDurationCache();\n\tthis._worktime = null;\n\tthis._cached_timestamps = {};\n\tthis._cached_timestamps_count = 0;\n}\n\nCalendarWorkTimeStrategy.prototype = {\n\tunits: [\n\t\t\"year\",\n\t\t\"month\",\n\t\t\"week\",\n\t\t\"day\",\n\t\t\"hour\",\n\t\t\"minute\"\n\t],\n\t_clearCaches: function(){\n\t\tthis._workingUnitsCache.clear();\n\t\tthis._largeUnitsCache.clear();\n\t\tthis._dateDurationCache.clear();\n\t},\n\t// cache previously calculated worktime\n\t_getUnitOrder: function (unit) {\n\t\tfor (var i = 0, len = this.units.length; i < len; i++) {\n\t\t\tif (this.units[i] == unit)\n\t\t\t\treturn i;\n\t\t}\n\t},\n\t_resetTimestampCache: function(){\n\t\tthis._cached_timestamps = {};\n\t\tthis._cached_timestamps_count = 0;\n\t},\n\t_timestamp: function (settings) {\n\t\t// minor optimization, store calculated timestamps to reduce computations\n\t\t// reset cache when number of keys exceeds large number where key lookup may became more expensive than the recalculation\n\t\tif(this._cached_timestamps_count > 1000000){\n\t\t\tthis._resetTimestampCache();\n\t\t}\n\n\t\tvar timestamp = null;\n\t\tif ((settings.day || settings.day === 0)) {\n\t\t\ttimestamp = settings.day;\n\t\t} else if (settings.date) {\n\t\t\tvar value = String(settings.date.valueOf());\n\t\t\tif(this._cached_timestamps[value]){\n\t\t\t\ttimestamp = this._cached_timestamps[value];\n\t\t\t}else{\n\t\t\t\t// store worktime datestamp in utc so it could be recognized in different timezones (e.g. opened locally and sent to the export service in different timezone)\n\t\t\t\ttimestamp = Date.UTC(settings.date.getFullYear(), settings.date.getMonth(), settings.date.getDate());\n\t\t\t\tthis._cached_timestamps[value] = timestamp;\n\t\t\t\tthis._cached_timestamps_count++;\n\t\t\t}\n\n\t\t}\n\t\treturn timestamp;\n\t},\n\t_checkIfWorkingUnit: function (date, unit) {\n\t\t// GS-596: If unit is larger than day or has a custom logic\n\t\tif (!this[\"_is_work_\" + unit]) {\n\t\t\tconst from = this.$gantt.date[`${unit}_start`](new Date(date));\n\t\t\tconst to = this.$gantt.date.add(from, 1, unit);\n\t\t\treturn this.hasDuration(from, to);\n\t\t}\n\t\treturn this[\"_is_work_\" + unit](date);\n\t},\n\t//checkings for particular time units\n\t//methods for month-year-week can be defined, otherwise always return 'true'\n\t_is_work_day: function (date) {\n\t\tvar val = this._getWorkHours(date);\n\n\t\tif (Array.isArray(val)) {\n\t\t\treturn val.length > 0;\n\t\t}\n\t\treturn false;\n\t},\n\t_is_work_hour: function (date) {\n\t\tvar hours = this._getWorkHours(date); // [{start: 8*60*60, end: 12*60*60}, {start: 13*60*60, end: 17*60*60}]\n\t\tvar value = date.getHours();\n\t\tfor (var i = 0; i < hours.length; i++) {\n\t\t\tif(value >= hours[i].startHour && value < hours[i].endHour){\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t},\n\n\t_getTimeOfDayStamp: function(date, dayEnd) {\n\t\tvar hours = date.getHours();\n\t\tif(!date.getHours() && !date.getMinutes() && dayEnd){\n\t\t\thours = 24;\n\t\t}\n\t\treturn hours * 60 * 60 + date.getMinutes() * 60;\n\t},\n\n\t_is_work_minute: function(date){\n\t\tvar hours = this._getWorkHours(date); // [{start: 8*60*60, end: 12*60*60}, {start: 13*60*60, end: 17*60*60}]\n\t\tvar checkTime = this._getTimeOfDayStamp(date);\n\t\tfor (var i = 0; i < hours.length; i++) {\n\t\t\tif(checkTime >= hours[i].start && checkTime < hours[i].end){\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t},\n\n\t_nextDate: function (start, unit, step) {\n\t\treturn this.$gantt.date.add(start, step, unit);\n\t},\n\t_getWorkUnitsBetweenGeneric: function (from, to, unit, step) {\n\t\tvar dateHelper = this.$gantt.date;\n\t\tvar start = new Date(from),\n\t\t\tend = new Date(to);\n\t\tstep = step || 1;\n\t\tvar units = 0;\n\n\n\t\tvar next = null;\n\t\tvar stepStart,\n\t\t\tstepEnd;\n\n\t\t// calculating decimal durations, i.e. 2016-09-20 00:05:00 - 2016-09-20 01:00:00 ~ 0.95 instead of 1\n\t\t// and also  2016-09-20 00:00:00 - 2016-09-20 00:05:00 ~ 0.05 instead of 1\n\t\t// durations must be rounded later\n\t\tvar checkFirst = false;\n\t\tstepStart = dateHelper[unit + \"_start\"](new Date(start));\n\t\tif (stepStart.valueOf() != start.valueOf()) {\n\t\t\tcheckFirst = true;\n\t\t}\n\t\tvar checkLast = false;\n\t\tstepEnd = dateHelper[unit + \"_start\"](new Date(to));\n\t\tif (stepEnd.valueOf() != to.valueOf()) {\n\t\t\tcheckLast = true;\n\t\t}\n\n\t\tvar isLastStep = false;\n\t\twhile (start.valueOf() < end.valueOf()) {\n\t\t\tnext = this._nextDate(start, unit, step);\n\t\t\tisLastStep = (next.valueOf() > end.valueOf());\n\n\t\t\tif (this._isWorkTime(start, unit)) {\n\t\t\t\tif (checkFirst || (checkLast && isLastStep)) {\n\t\t\t\t\tstepStart = dateHelper[unit + \"_start\"](new Date(start));\n\t\t\t\t\tstepEnd = dateHelper.add(stepStart, step, unit);\n\t\t\t\t}\n\n\t\t\t\tif (checkFirst) {\n\t\t\t\t\tcheckFirst = false;\n\t\t\t\t\tnext = this._nextDate(stepStart, unit, step);\n\t\t\t\t\tunits += ((stepEnd.valueOf() - start.valueOf()) / (stepEnd.valueOf() - stepStart.valueOf()));\n\t\t\t\t} else if (checkLast && isLastStep) {\n\t\t\t\t\tcheckLast = false;\n\t\t\t\t\tunits += ((end.valueOf() - start.valueOf()) / (stepEnd.valueOf() - stepStart.valueOf()));\n\n\t\t\t\t} else {\n\t\t\t\t\tunits++;\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tvar unitOrder = this._getUnitOrder(unit);\n\t\t\t\tvar biggerTimeUnit = this.units[unitOrder - 1];\n\t\t\t\tif(biggerTimeUnit && !this._isWorkTime(start, biggerTimeUnit)){\n\t\t\t\t\tnext = this._getClosestWorkTimeFuture(start, biggerTimeUnit);\n\t\t\t\t}\n\t\t\t}\n\t\t\tstart = next;\n\t\t}\n\t\treturn units;\n\t},\n\n\t_getMinutesPerHour: function (date) {\n\t\tvar hourStart = this._getTimeOfDayStamp(date);\n\t\tvar hourEnd = this._getTimeOfDayStamp(this._nextDate(date, \"hour\", 1));\n\t\tif (hourEnd === 0){\n\t\t\thourEnd = 24 * 60 * 60;\n\t\t}\n\t\tvar worktimes = this._getWorkHours(date);\n\n\t\tfor(var i = 0; i < worktimes.length; i++){\n\t\t\tvar interval = worktimes[i];\n\t\t\tif(hourStart >= interval.start && hourEnd <= interval.end){\n\t\t\t\treturn 60;// hour inside a working interval, all hour is a work hour\n\t\t\t}else if(hourStart < interval.end && hourEnd > interval.start){\n\t\t\t\t// hour is partially work time\n\t\t\t\tvar duration = Math.min(hourEnd, interval.end) - Math.max(hourStart, interval.start);\n\t\t\t\treturn duration / 60;\n\t\t\t}\n\t\t}\n\n\t\treturn 0;\n\t},\n\n\t_getMinutesPerDay: function (date) {\n\t\tvar hours = this._getWorkHours(date);\n\t\tvar res = 0;\n\t\thours.forEach(function(interval){\n\t\t\tres+= interval.durationMinutes;\n\t\t});\n\t\treturn res;\n\t},\n\tgetHoursPerDay: function (date) {\n\t\tvar hours = this._getWorkHours(date);\n\t\tvar res = 0;\n\t\thours.forEach(function(interval){\n\t\t\tres+= interval.durationHours;\n\t\t});\n\t\treturn res;\n\t},\n\t_getWorkUnitsForRange: function (from, to, unit, step) {\n\t\tvar total = 0;\n\t\tvar start = new Date(from),\n\t\t\tend = new Date(to);\n\n\t\tvar getUnitsPerDay;\n\t\tif (unit == \"minute\") {\n\t\t\tgetUnitsPerDay = utils.bind(this._getMinutesPerDay, this);\n\t\t} else {\n\t\t\tgetUnitsPerDay = utils.bind(this.getHoursPerDay, this);\n\t\t}\n\n\t\twhile (start.valueOf() < end.valueOf()) {\n\t\t\tif(end - start > 1000*60*60*24*32 && start.getDate() === 0) {\n\t\t\t\tvar units = this._largeUnitsCache.getMinutesPerMonth(start);\n\t\t\t\tif(unit == \"hour\"){\n\t\t\t\t\tunits = units / 60;\n\t\t\t\t}\n\t\t\t\ttotal += units;\n\t\t\t\tstart = this.$gantt.date.add(start, 1, \"month\");\n\t\t\t\tcontinue;\n\t\t\t}else if(end - start > 1000*60*60*24*16) {\n\t\t\t\tvar weekStart = this.$gantt.date.week_start(new Date(start));\n\t\t\t\tif(start.valueOf() === weekStart.valueOf()){\n\t\t\t\t\tvar units = this._largeUnitsCache.getMinutesPerWeek(start);\n\t\t\t\t\tif(unit == \"hour\"){\n\t\t\t\t\t\tunits = units / 60;\n\t\t\t\t\t}\n\t\t\t\t\ttotal += units;\n\t\t\t\t\tstart = this.$gantt.date.add(start, 7, \"day\");\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t//\tif (this._isWorkTime(start, \"day\")) {\n\t\t\ttotal += getUnitsPerDay(start);\n\t\t//\t}\n\t\t\tstart = this._nextDate(start, \"day\", 1);\n\t\t}\n\n\t\treturn total / step;\n\t},\n\n\n\t_getMinutesBetweenSingleDay: function(from, to){\n\t\tvar range = this._getIntervalTimestamp(from, to);\n\t\tvar worktimes = this._getWorkHours(from);\n\t\tvar result = 0;\n\n\t\tfor(var i = 0; i < worktimes.length; i++){\n\t\t\tvar interval = worktimes[i];\n\t\t\tif(range.end >= interval.start && range.start <= interval.end){\n\t\t\t\tvar minuteFrom = Math.max(interval.start, range.start);\n\t\t\t\tvar minuteTo = Math.min(interval.end, range.end);\n\n\t\t\t\tresult += (minuteTo - minuteFrom) / 60;\n\t\t\t\trange.start = minuteTo;\n\t\t\t}\n\t\t}\n\n\t\treturn Math.floor(result);\n\t},\n\n\t_getMinutesBetween: function(from, to, unit, step){\n\t\tvar start = new Date(from),\n\t\t\tend = new Date(to);\n\t\tstep = step || 1;\n\n\t\tvar firstDayStart = new Date(start);\n\t\tvar firstDayEnd = this.$gantt.date.add(this.$gantt.date.day_start(new Date(start)), 1, \"day\");\n\n\t\tif (end.valueOf() <= firstDayEnd.valueOf()) {\n\t\t\treturn this._getMinutesBetweenSingleDay(from, to);\n\t\t} else {\n\n\t\t\tvar lastDayStart = this.$gantt.date.day_start(new Date(end));\n\t\t\tvar lastDayEnd = end;\n\n\t\t\tvar startPart = this._getMinutesBetweenSingleDay(firstDayStart, firstDayEnd);\n\t\t\tvar endPart = this._getMinutesBetweenSingleDay(lastDayStart, lastDayEnd);\n\n\t\t\tvar rangePart = this._getWorkUnitsForRange(firstDayEnd, lastDayStart, unit, step);\n\t\t\tvar total = startPart + rangePart + endPart;\n\n\t\t\treturn total;\n\t\t}\n\t},\n\t// optimized method for calculating work units duration of large time spans\n\t// implemented for hours and minutes units, bigger time units don't benefit from the optimization so much\n\t_getHoursBetween: function (from, to, unit, step) {\n\t\tvar start = new Date(from),\n\t\t\tend = new Date(to);\n\t\tstep = step || 1;\n\n\t\tvar firstDayStart = new Date(start);\n\t\tvar firstDayEnd = this.$gantt.date.add(this.$gantt.date.day_start(new Date(start)), 1, \"day\");\n\n\t\tif (end.valueOf() <= firstDayEnd.valueOf()) {\n\t\t\treturn Math.round(this._getMinutesBetweenSingleDay(from, to) / 60);\n\t\t} else {\n\n\t\t\tvar lastDayStart = this.$gantt.date.day_start(new Date(end));\n\t\t\tvar lastDayEnd = end;\n\n\t\t\tvar startPart = this._getMinutesBetweenSingleDay(firstDayStart, firstDayEnd, unit, step) / 60;\n\t\t\tvar endPart = this._getMinutesBetweenSingleDay(lastDayStart, lastDayEnd, unit, step) / 60;\n\n\t\t\tvar rangePart = this._getWorkUnitsForRange(firstDayEnd, lastDayStart, unit, step);\n\t\t\tvar total = startPart + rangePart + endPart;\n\n\t\t\treturn Math.round(total);\n\t\t}\n\t},\n\n\tgetConfig: function () {\n\t\treturn this._worktime;\n\t},\n\t_setConfig: function (settings) {\n\t\tthis._worktime = settings;\n\t\tthis._parseSettings();\n\t\tthis._clearCaches();\n\t},\n\t_parseSettings: function() {\n\t\tvar settings = this.getConfig();\n\t\tsettings.parsed = {\n\t\t\tdates: {},\n\t\t\thours: null,\n\t\t\thaveCustomWeeks: false,\n\t\t\tcustomWeeks: {},\n\t\t\tcustomWeeksRangeStart: null,\n\t\t\tcustomWeeksRangeEnd: null,\n\t\t\tcustomWeeksBoundaries: []\n\t\t};\n\n\t\tsettings.parsed.hours = this._parseHours(settings.hours);\n\t\tfor(var i in settings.dates){\n\t\t\tsettings.parsed.dates[i] = this._parseHours(settings.dates[i]);\n\t\t}\n\n\t\tif(settings.customWeeks) {\n\t\t\tvar minCustomRangeStart = null;\n\t\t\tvar maxCustomRangeEnd = null;\n\t\t\tfor(var i in settings.customWeeks){\n\t\t\t\tvar customTime = settings.customWeeks[i];\n\n\t\t\t\tif(customTime.from && customTime.to){\n\t\t\t\t\tvar rangeStart = customTime.from;\n\t\t\t\t\tvar rangeEnd = customTime.to;\n\t\t\t\t\tif(!minCustomRangeStart || minCustomRangeStart > rangeStart.valueOf()){\n\t\t\t\t\t\tminCustomRangeStart = rangeStart.valueOf();\n\t\t\t\t\t}\n\t\t\t\t\tif(!maxCustomRangeEnd || maxCustomRangeEnd < rangeEnd.valueOf()){\n\t\t\t\t\t\tmaxCustomRangeEnd = rangeEnd.valueOf();\n\t\t\t\t\t}\n\n\t\t\t\t\tsettings.parsed.customWeeksBoundaries.push({\n\t\t\t\t\t\tfrom: rangeStart.valueOf(),\n\t\t\t\t\t\tfromReadable: new Date(rangeStart),\n\t\t\t\t\t\tto: rangeEnd.valueOf(),\n\t\t\t\t\t\ttoReadable: new Date(rangeEnd),\n\t\t\t\t\t\tname: i\n\t\t\t\t\t});\n\n\t\t\t\t\tsettings.parsed.haveCustomWeeks = true;\n\t\t\t\t\tvar currentWeek = settings.parsed.customWeeks[i] = {\n\t\t\t\t\t\tfrom: customTime.from,\n\t\t\t\t\t\tto: customTime.to,\n\t\t\t\t\t\thours: this._parseHours(customTime.hours),\n\t\t\t\t\t\tdates: {}\n\t\t\t\t\t};\n\n\t\t\t\t\t// GS-1840. If there are no dates, it should work correctly with the weekdays\n\t\t\t\t\tif (customTime.days && !customTime.dates) {\n\t\t\t\t\t\tcustomTime.dates = customTime.dates || {};\n\t\t\t\t\t\tfor (var i = 0; i < customTime.days.length; i++) {\n\t\t\t\t\t\t\tcustomTime.dates[i] = customTime.days[i];\n\t\t\t\t\t\t\tif (!(customTime.days[i] instanceof Array)) {\n\t\t\t\t\t\t\t\tcustomTime.dates[i] = !!customTime.days[i];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdelete customTime.days;\n\t\t\t\t\t}\n\n\t\t\t\t\tfor(var d in customTime.dates){\n\t\t\t\t\t\tcurrentWeek.dates[d] = this._parseHours(customTime.dates[d]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tsettings.parsed.customWeeksRangeStart = minCustomRangeStart;\n\t\t\tsettings.parsed.customWeeksRangeEnd = maxCustomRangeEnd;\n\n\t\t}\n\t},\n\n\t_tryChangeCalendarSettings: function (payload) {\n\t\tvar backup = JSON.stringify(this.getConfig());\n\t\tpayload();\n\t\tif (!this.hasWorkTime()) {\n\t\t//\tthis.$gantt.assert(false, \"Invalid calendar settings, no worktime available\");\n\t\t\tthis._setConfig(JSON.parse(backup));\n\t\t\tthis._clearCaches();\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\n\t},\n\n\t_arraysEqual: function(a, b){\n\t\tif (a === b) return true;\n\t\tif (!a || !b) return false;\n\t\tif (a.length != b.length) return false;\n\n\t\tfor (var i = 0; i < a.length; ++i) {\n\t\t\tif (a[i] !== b[i]) return false;\n\t\t}\n\t\treturn true;\n\t},\n\n\n\t_compareSettings: function (mySettings, thatSettings) {\n\t\tif (!this._arraysEqual(mySettings.hours, thatSettings.hours)) {\n\t\t\treturn false;\n\t\t}\n\n\t\tvar myDays = Object.keys(mySettings.dates);\n\t\tvar otherDates = Object.keys(thatSettings.dates);\n\t\tmyDays.sort();\n\t\totherDates.sort();\n\n\t\tif (!this._arraysEqual(myDays, otherDates)) {\n\t\t\treturn false;\n\t\t}\n\n\t\tfor(var i = 0; i < myDays.length; i++){\n\t\t\tvar timestamp = myDays[i];\n\t\t\tvar myHours = mySettings.dates[timestamp];\n\t\t\tvar otherHours = mySettings.dates[timestamp];\n\n\t\t\t// day settings not equal\n\t\t\tif(myHours !== otherHours &&\n\t\t\t\t// but still can be two arrays with the equivalent hour settings\n\t\t\t\t!(Array.isArray(myHours) && Array.isArray(otherHours) && this._arraysEqual(myHours, otherHours))\n\t\t\t\t){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t},\n\n\tequals: function (calendar) {\n\t\tif(!(calendar instanceof CalendarWorkTimeStrategy)){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar mySettings = this.getConfig();\n\t\tvar thatSettings = calendar.getConfig();\n\n\t\tif(!this._compareSettings(mySettings, thatSettings)){\n\t\t\treturn false;\n\t\t}\n\n\t\tif(mySettings.parsed.haveCustomWeeks && thatSettings.parsed.haveCustomWeeks){\n\t\t\tif(mySettings.parsed.customWeeksBoundaries.length != thatSettings.parsed.customWeeksBoundaries.length){\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tfor(var i in mySettings.parsed.customWeeks){\n\t\t\t\tvar myWeek = mySettings.parsed.customWeeks[i];\n\t\t\t\tvar thatWeek = thatSettings.parsed.customWeeks[i];\n\t\t\t\tif(!thatWeek){\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif(!this._compareSettings(myWeek, thatWeek)){\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t}else if(mySettings.parse.haveCustomWeeks !== thatSettings.parsed.haveCustomWeeks){\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t},\n\n\tgetWorkHours: function () {\n\t\tvar config = this.argumentsHelper.getWorkHoursArguments.apply(this.argumentsHelper, arguments);\n\t\treturn this._getWorkHours(config.date, false);\n\t},\n\t_getWorkHours: function (date, parsed) {\n\t\tvar calendar = this.getConfig();\n\t\tif(parsed !== false){\n\t\t\tcalendar = calendar.parsed;\n\t\t}\n\n\t\tif(!date){\n\t\t\treturn calendar.hours;\n\t\t}\n\n\t\tconst dayStartDate = new Date(date.getFullYear(), date.getMonth(), date.getDate());\n\n\t\tvar dateValue = this._timestamp({date: dayStartDate});\n\n\t\tif(calendar.haveCustomWeeks){\n\t\t\tif(calendar.customWeeksRangeStart <= dateValue && calendar.customWeeksRangeEnd > dateValue){\n\t\t\t\tfor(var i = 0; i < calendar.customWeeksBoundaries.length; i++){\n\t\t\t\t\tif(calendar.customWeeksBoundaries[i].from <= dateValue && calendar.customWeeksBoundaries[i].to > dateValue){\n\t\t\t\t\t\tcalendar = calendar.customWeeks[calendar.customWeeksBoundaries[i].name];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tvar hours = true;\n\n\t\tif (calendar.dates[dateValue] !== undefined) {\n\t\t\thours = calendar.dates[dateValue];//custom day\n\t\t} else if (calendar.dates[date.getDay()] !== undefined) {\n\t\t\thours = calendar.dates[date.getDay()];//week day\n\t\t}\n\t\tif (hours === true) {\n\t\t\treturn calendar.hours;\n\t\t} else if (hours) {\n\t\t\treturn hours;\n\t\t}\n\t\treturn [];\n\t},\n\n\t_getIntervalTimestamp: function(from, to){\n\t\tvar res = {\n\t\t\tstart: 0,\n\t\t\tend: 0\n\t\t};\n\n\t\tres.start = from.getHours() * 60 * 60 + from.getMinutes() * 60 + from.getSeconds();\n\t\tvar endHours = to.getHours();\n\t\tif(!endHours && !to.getMinutes() && !to.getSeconds() && from.valueOf() < to.valueOf()){\n\t\t\tendHours = 24;\n\t\t}\n\t\tres.end = endHours * 60 * 60 + to.getMinutes() * 60 + to.getSeconds();\n\t\treturn res;\n\t},\n\n\t_parseHours: function(hours) {\n\t\tif(Array.isArray(hours)){\n\n\t\t\tvar timestampRanges = [];// worktime as seconds range\n\t\t\thours.forEach(function(hour){\n\t\t\t\tif(typeof hour === \"number\"){\n\t\t\t\t\ttimestampRanges.push(hour*60*60);\n\t\t\t\t}else if(typeof hour === \"string\") {\n\t\t\t\t\t// \"12-13\", or \"12:00-13:00\", or \"12:00:00-13:00:00\"\n\t\t\t\t\thour.split(\"-\").map(function(time){\n\t\t\t\t\t\treturn time.trim();\n\t\t\t\t\t}).forEach(function(part){\n\t\t\t\t\t\tvar parsed = part.split(\":\").map(function(time){\n\t\t\t\t\t\t\treturn time.trim();\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tvar value = parseInt(parsed[0]*60*60);\n\t\t\t\t\t\tif(parsed[1]){\n\t\t\t\t\t\t\tvalue += parseInt(parsed[1]*60);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(parsed[2]){\n\t\t\t\t\t\t\tvalue += parseInt(parsed[2]);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\ttimestampRanges.push(value);\n\t\t\t\t\t});\n\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tvar timerangeConfig = [];\n\t\t\tfor (var i = 0; i < timestampRanges.length; i += 2) {\n\t\t\t\tvar start = timestampRanges[i];\n\t\t\t\tvar end = timestampRanges[i + 1];\n\t\t\t\tvar duration = end - start;\n\n\t\t\t\ttimerangeConfig.push({\n\t\t\t\t\tstart: start,\n\t\t\t\t\tend: end,\n\t\t\t\t\tstartHour: Math.floor(start / (60*60)),\n\t\t\t\t\tstartMinute: Math.floor(start / (60)),\n\t\t\t\t\tendHour: Math.ceil(end / (60*60)),\n\t\t\t\t\tendMinute: Math.ceil(end / (60)),\n\t\t\t\t\tdurationSeconds: duration,\n\t\t\t\t\tdurationMinutes: duration/60,\n\t\t\t\t\tdurationHours: duration/(60 * 60)\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn timerangeConfig;\n\t\t} else {\n\t\t\treturn hours;\n\t\t}\n\t},\n\n\tsetWorkTime: function (settings) {\n\t\treturn this._tryChangeCalendarSettings(utils.bind(function () {\n\t\t\tvar hours = settings.hours !== undefined ? settings.hours : true;\n\t\t\tvar timestamp = this._timestamp(settings);\n\t\t\tvar calendarConfig = this.getConfig();\n\t\t\tif (timestamp !== null) {\n\t\t\t\tcalendarConfig.dates[timestamp] = hours;\n\t\t\t} else if(!settings.customWeeks) {\n\t\t\t\tcalendarConfig.hours = hours;\n\t\t\t}\n\n\t\t\tif(settings.customWeeks){\n\t\t\t\tif(!calendarConfig.customWeeks){\n\t\t\t\t\tcalendarConfig.customWeeks = {};\n\t\t\t\t}\n\t\t\t\t// GS-1867. allow setWorkTime to exclude dates in the customWeeks range\n\t\t\t\tif (typeof settings.customWeeks == \"string\"){\n\t\t\t\t\tif (timestamp !== null) {\n\t\t\t\t\t\tcalendarConfig.customWeeks[settings.customWeeks].dates[timestamp] = hours;\n\t\t\t\t\t} else if(!settings.customWeeks) {\n\t\t\t\t\t\tcalendarConfig.customWeeks[settings.customWeeks].hours = hours;\n\t\t\t\t\t}\t\t\n\t\t\t\t} else if (typeof settings.customWeeks === \"object\"\n\t\t\t\t&& settings.customWeeks.constructor === Object){\n\t\t\t\t\tfor(var i in settings.customWeeks){\n\t\t\t\t\t\tcalendarConfig.customWeeks[i] = settings.customWeeks[i];\n\t\t\t\t\t}\t\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis._parseSettings();\n\t\t\tthis._clearCaches();\n\t\t}, this));\n\t},\n\n\tunsetWorkTime: function (settings) {\n\t\treturn this._tryChangeCalendarSettings(utils.bind(function () {\n\t\t\tif (!settings) {\n\t\t\t\tthis.reset_calendar();\n\t\t\t} else {\n\n\t\t\t\tvar timestamp = this._timestamp(settings);\n\n\t\t\t\tif (timestamp !== null) {\n\t\t\t\t\tdelete this.getConfig().dates[timestamp];\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Load updated settings and clear work units cache\n\t\t\tthis._parseSettings();\n\t\t\tthis._clearCaches();\n\t\t}, this));\n\t},\n\n\t_isWorkTime: function (date, unit) {\n\t\t// Check if this item has in the cache\n\n\t\tvar useCache = true;//unit === \"day\"; // use cache only for days. In case of hours/minutes cache size grows too large and the overhead exceeds the gains\n\t\tvar isWorkUnit = -1;\n\t\tvar dateKey = null;\n\n\t\tif(useCache){\n\t\t\t// use string keys\n\t\t\tdateKey = String(date.valueOf());\n\t\t\tisWorkUnit = this._workingUnitsCache.getItem(unit, dateKey, date);\n\t\t}\n\n\t\tif (isWorkUnit == -1) {\n\t\t\t// calculate if not cached\n\t\t\tisWorkUnit = this._checkIfWorkingUnit(date, unit);\n\t\t\tif(useCache){\n\t\t\t\tthis._workingUnitsCache.setItem(unit, dateKey, isWorkUnit, date);\n\t\t\t}\n\t\t}\n\n\t\treturn isWorkUnit;\n\t},\n\n\tisWorkTime: function () {\n\t\tvar config =  this.argumentsHelper.isWorkTimeArguments.apply( this.argumentsHelper, arguments);\n\t\treturn this._isWorkTime(config.date, config.unit);\n\t},\n\n\tcalculateDuration: function () {\n\t\tvar config =  this.argumentsHelper.getDurationArguments.apply( this.argumentsHelper, arguments);\n\n\t\tif (!config.unit) {\n\t\t\treturn false;\n\t\t}\n\t\t//return this._calculateDuration(config.start_date, config.end_date, config.unit, config.step);\n\n\t\tvar self = this;\n\t\treturn this._dateDurationCache.getDuration(config.start_date, config.end_date, config.unit, config.step, function(){ \n\t\t\treturn self._calculateDuration(config.start_date, config.end_date, config.unit, config.step);\n\t\t});\n\t},\n\n\t_calculateDuration: function (from, to, unit, step) {\n\t\tvar res = 0;\n\n\t\tvar sign = 1;\n\t\tif(from.valueOf() > to.valueOf()){\n\t\t\tvar tmp = to;\n\t\t\tto = from;\n\t\t\tfrom = tmp;\n\t\t\tsign = -1;\n\t\t}\n\n\t\tif (unit == \"hour\" && step == 1) {\n\t\t\tres = this._getHoursBetween(from, to, unit, step);\n\t\t} else if(unit == \"minute\" && step == 1){\n\t\t\t// quick calculation for minutes with 1 minute step\n\t\t\tres = this._getMinutesBetween(from, to, unit, step);\n\t\t} else {\n\t\t\tres = this._getWorkUnitsBetweenGeneric(from, to, unit, step);\n\t\t}\n\n\t\t// getWorkUnits.. returns decimal durations\n\t\treturn sign * Math.round(res);\n\t},\n\thasDuration: function () {\n\t\tvar config =  this.argumentsHelper.getDurationArguments.apply( this.argumentsHelper, arguments);\n\n\t\tvar from = config.start_date,\n\t\t\tto = config.end_date,\n\t\t\tunit = config.unit,\n\t\t\tstep = config.step;\n\n\t\tif (!unit) {\n\t\t\treturn false;\n\t\t}\n\t\tvar start = new Date(from),\n\t\t\tend = new Date(to);\n\t\tstep = step || 1;\n\n\t\twhile (start.valueOf() < end.valueOf()) {\n\t\t\tif (this._isWorkTime(start, unit))\n\t\t\t\treturn true;\n\t\t\tstart = this._nextDate(start, unit, step);\n\t\t}\n\t\treturn false;\n\t},\n\n\tcalculateEndDate: function () {\n\t\tvar config =  this.argumentsHelper.calculateEndDateArguments.apply( this.argumentsHelper, arguments);\n\n\t\tvar from = config.start_date,\n\t\t\tduration = config.duration,\n\t\t\tunit = config.unit,\n\t\t\tstep = config.step;\n\n\t\tif (!unit)\n\t\t\treturn false;\n\n\t\tvar mult = (config.duration >= 0) ? 1 : -1;\n\t\tduration = Math.abs(duration * 1);\n\t//\tvar endDate = this._calculateEndDate(from, duration, unit, step * mult);\n\t//\treturn endDate;\n\t\tvar self = this;\n\t\treturn this._dateDurationCache.getEndDate(from, duration, unit, step * mult, function(){ \n\t\t\treturn self._calculateEndDate(from, duration, unit, step * mult);\n\t\t} );\n\t},\n\n\t_calculateEndDate: function (from, duration, unit, step) {\n\t\tif (!unit)\n\t\t\treturn false;\n\n\t\tif (step == 1 && unit == \"minute\") {\n\t\t\treturn this._calculateMinuteEndDate(from, duration, step);\n\t\t} else if(step == -1 && unit == \"minute\") {\n\t\t\treturn this._subtractMinuteDate(from, duration, step);\n\t\t} else if (step == 1 && unit == \"hour\") {\n\t\t\treturn this._calculateHourEndDate(from, duration, step);\n\t\t} else {\n\t\t\tvar interval = this._addInterval(from, duration, unit, step, null);\n\t\t\treturn interval.end;\n\t\t}\n\t},\n\n\t_addInterval: function (start, duration, unit, step, stopAction) {\n\t\tvar added = 0;\n\t\tvar current = start;\n\t\tvar dstShift = false;\n\n\t\twhile (added < duration && !(stopAction && stopAction(current))) {\n\t\t\tvar next = this._nextDate(current, unit, step);\n\n\t\t\t// GS-1501. Correct hours after DST change\n\t\t\tif (unit == \"day\"){\n\t\t\t\tdstShift = dstShift || !current.getHours() && next.getHours();\n\n\t\t\t\tif (dstShift){\n\t\t\t\t\tnext.setHours(0);\n\t\t\t\t\tif (next.getHours()){\n\t\t\t\t\t// the day when the timezone is changed, try to correct hours next time\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdstShift = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar dateValue = new Date(next.valueOf() + 1);\n\t\t\tif (step > 0) {\n\t\t\t\tdateValue = new Date(next.valueOf() - 1);\n\t\t\t}\n\t\t\tvar workTimeCheck = this._isWorkTime(dateValue, unit);\n\n\t\t\tif (workTimeCheck && !dstShift) {\n\t\t\t\tadded++;\n\t\t\t}\n\t\t\tcurrent = next;\n\t\t}\n\t\treturn {\n\t\t\tend: current,\n\t\t\tstart: start,\n\t\t\tadded: added\n\t\t};\n\t},\n\n\t_addHoursUntilDayEnd: function(from, duration) {\n\t\tvar dayEnd = this.$gantt.date.add(this.$gantt.date.day_start(new Date(from)), 1, \"day\");\n\t\tvar added = 0;\n\t\tvar left = duration;\n\n\t\tvar range = this._getIntervalTimestamp(from, dayEnd);\n\t\tvar worktimes = this._getWorkHours(from);\n\t\tfor(var i = 0; i < worktimes.length && added < duration; i++){\n\t\t\tvar interval = worktimes[i];\n\t\t\tif(range.end >= interval.start && range.start <= interval.end){\n\t\t\t\tvar minuteFrom = Math.max(interval.start, range.start);\n\t\t\t\tvar minuteTo = Math.min(interval.end, range.end);\n\t\t\t\tvar rangeHours = (minuteTo - minuteFrom) / (60 * 60);\n\t\t\t\tif(rangeHours > left){\n\t\t\t\t\trangeHours = left;\n\t\t\t\t\tminuteTo = minuteFrom + (left * 60 * 60);\n\t\t\t\t}\n\n\t\t\t\tvar addHours = Math.round((minuteTo - minuteFrom) / (60 * 60));\n\t\t\t\tadded += addHours;\n\t\t\t\tleft -= addHours;\n\t\t\t\trange.start = minuteTo;\n\t\t\t}\n\t\t}\n\n\t\tvar intervalEnd = dayEnd;\n\t\tif(added === duration){\n\t\t\tintervalEnd = new Date(from.getFullYear(), from.getMonth(), from.getDate(), 0, 0, range.start);\n\t\t}\n\t\treturn {\n\t\t\tadded: added,\n\t\t\tend: intervalEnd\n\t\t};\n\t},\n\n\t_calculateHourEndDate: function (from, duration,  step) {\n\t\tvar start = new Date(from),\n\t\tadded = 0;\n\t\tstep = step || 1;\n\t\tduration = Math.abs(duration * 1);\n\n\t\tvar interval = this._addHoursUntilDayEnd(start, duration);\n\t\tadded = interval.added;\n\t\tstart = interval.end;\n\n\t\tvar durationLeft = duration - added;\n\n\t\tif (durationLeft) {\n\t\t\tvar current = start;\n\t\t\twhile (added < duration) {\n\t\t\t\tvar next = this._nextDate(current, \"day\", step);\n\t\t\t\t// reset to day start in case DST switch happens in the process\n\t\t\t\tnext.setHours(0);\n\t\t\t\tnext.setMinutes(0);\n\t\t\t\tnext.setSeconds(0);\n\n\t\t\t\tvar hoursPerDay = 0;\n\t\t\t\tif(step > 0){\n\t\t\t\t\thoursPerDay = this.getHoursPerDay(new Date(next.valueOf() - 1));\n\t\t\t\t}else{\n\t\t\t\t\thoursPerDay = this.getHoursPerDay(new Date(next.valueOf() + 1));\n\t\t\t\t}\n\n\t\t\t\tif (added + hoursPerDay >= duration) {\n\t\t\t\t\tbreak;\n\t\t\t\t} else {\n\t\t\t\t\tadded += hoursPerDay;\n\t\t\t\t}\n\n\t\t\t\tcurrent = next;\n\t\t\t}\n\t\t\tstart = current;\n\t\t}\n\n\t\tif (added < duration) {\n\t\t\tvar durationLeft = duration - added;\n\t\t\tinterval = this._addHoursUntilDayEnd(start, durationLeft);\n\t\t\tstart = interval.end;\n\t\t}\n\n\t\treturn start;\n\t},\n\n\t_addMinutesUntilHourEnd: function(from, duration){\n\t\tif(from.getMinutes() === 0) {\n\t\t\t// already at hour end\n\t\t\treturn {\n\t\t\t\tadded: 0,\n\t\t\t\tend: new Date(from)\n\t\t\t};\n\t\t}\n\t\tvar hourEnd = this.$gantt.date.add(this.$gantt.date.hour_start(new Date(from)), 1, \"hour\");\n\t\tvar added = 0;\n\t\tvar left = duration;\n\n\t\tvar range = this._getIntervalTimestamp(from, hourEnd);\n\t\tvar worktimes = this._getWorkHours(from);\n\t\tfor(var i = 0; i < worktimes.length && added < duration; i++){\n\t\t\tvar interval = worktimes[i];\n\t\t\tif(range.end >= interval.start && range.start <= interval.end){\n\t\t\t\tvar minuteFrom = Math.max(interval.start, range.start);\n\t\t\t\tvar minuteTo = Math.min(interval.end, range.end);\n\t\t\t\tvar rangeMinutes = (minuteTo - minuteFrom) / 60;\n\t\t\t\tif(rangeMinutes > left){\n\t\t\t\t\trangeMinutes = left;\n\t\t\t\t\tminuteTo = minuteFrom + (left * 60);\n\t\t\t\t}\n\n\t\t\t\t// TODO: verify testcase https://dhtmlxsupport.teamwork.com/desk/tickets/9625700/messages\n\t\t\t\t/*if (rangeMinutes === 0) {\n\t\t\t\t\trangeMinutes = left;\n\t\t\t\t\tminuteTo = minuteFrom + (left * 60);\n\t\t\t\t}*/\n\n\t\t\t\tvar addMinutes = Math.round((minuteTo - minuteFrom) / 60);\n\t\t\t\tleft -= addMinutes;\n\t\t\t\tadded += addMinutes;\n\t\t\t\trange.start = minuteTo;\n\t\t\t}\n\t\t}\n\n\t\tvar intervalEnd = hourEnd;\n\t\tif(added === duration){\n\t\t\tintervalEnd = new Date(from.getFullYear(), from.getMonth(), from.getDate(), 0, 0, range.start);\n\t\t}\n\t\treturn {\n\t\t\tadded: added,\n\t\t\tend: intervalEnd\n\t\t};\n\t},\n\n\t_subtractMinutesUntilHourStart: function(from, duration){\n\t\tvar hourStart = this.$gantt.date.hour_start(new Date(from));\n\t\tvar added = 0;\n\t\tvar left = duration;\n\n\t\tvar hourStartTimestamp = hourStart.getHours() * 60 * 60 + hourStart.getMinutes() * 60 + hourStart.getSeconds();\n\t\tvar initialDateTimestamp = from.getHours() * 60 * 60 + from.getMinutes() * 60 + from.getSeconds();\n\n\t\tvar worktimes = this._getWorkHours(from);\n\t\tfor(var i = worktimes.length - 1; i >= 0 && added < duration; i--){\n\t\t\tvar interval = worktimes[i];\n\t\t\tif(initialDateTimestamp > interval.start && hourStartTimestamp <= interval.end){\n\t\t\t\tvar minuteFrom = Math.min(initialDateTimestamp, interval.end);\n\t\t\t\tvar minuteTo = Math.max(hourStartTimestamp, interval.start);\n\n\t\t\t//\tvar minuteFrom = Math.max(interval.start, currentHour.start);\n\t\t\t//\tvar minuteTo = Math.min(interval.end, currentHour.end);\n\t\t\t\tvar rangeMinutes = (minuteFrom - minuteTo) / 60;\n\t\t\t\tif(rangeMinutes > left){\n\t\t\t\t\trangeMinutes = left;\n\t\t\t\t\tminuteTo = minuteFrom - (left * 60);\n\t\t\t\t}\n\n\t\t\t\t// TODO: verify testcase https://dhtmlxsupport.teamwork.com/desk/tickets/9625700/messages\n\t\t\t\t/*if (rangeMinutes === 0) {\n\t\t\t\t\trangeMinutes = left;\n\t\t\t\t\tminuteTo = minuteFrom - (left * 60);\n\t\t\t\t}*/\n\n\t\t\t\tvar addMinutes = Math.abs(Math.round((minuteFrom - minuteTo) / 60));\n\t\t\t\tleft -= addMinutes;\n\t\t\t\tadded += addMinutes;\n\t\t\t\tinitialDateTimestamp = minuteTo;\n\t\t\t}\n\t\t}\n\n\t\tvar intervalEnd = hourStart;\n\t\tif(added === duration){\n\t\t\tintervalEnd = new Date(from.getFullYear(), from.getMonth(), from.getDate(), 0, 0, initialDateTimestamp);\n\t\t}\n\t\treturn {\n\t\t\tadded: added,\n\t\t\tend: intervalEnd\n\t\t};\n\t},\n\n\t_subtractMinuteDate: function (from, duration, step) {\n\t\t// var start = new Date(from),\n\t\t// GS-2683. We should start calculating minutes from the working time\n\t\tvar start = this.getClosestWorkTime({ date: from, dir: \"past\", unit: \"minute\" }),\n\t\t\tadded = 0;\n\t\tstep = step || -1;\n\t\tduration = Math.abs(duration * 1);\n\t\tduration = Math.round(duration);\n\n\t\tconst minutePrecision = this._isMinutePrecision(start);\n\n\t\tlet addedInterval = this._subtractMinutesUntilHourStart(start, duration);\n\t\tadded += addedInterval.added;\n\n\t\tstart = addedInterval.end;\n\n\t\tvar calculatedDay = 0;\n\t\tvar daySchedule = [];\n\t\tvar minutesInDay = 0;\n\n\t\twhile (added < duration) {\n\t\t\tvar dayStart = this.$gantt.date.day_start(new Date(start));\n\n\t\t\tvar iterateFromDayEnd = false;\n\t\t\tif(start.valueOf() === dayStart.valueOf()){\n\t\t\t\tdayStart = this.$gantt.date.add(dayStart, -1, \"day\");\n\t\t\t\titerateFromDayEnd = true;\n\t\t\t}\n\t\t\t//var dayStartTimestamp = this.$gantt.date.day_start(new Date(start)).valueOf();\n\t\t\tvar dayEnd = new Date(dayStart.getFullYear(), dayStart.getMonth(), dayStart.getDate(), 23, 59,59,999).valueOf();\n\n\t\t\tif(dayEnd !== calculatedDay){\n\t\t\t\tdaySchedule = this._getWorkHours(dayStart);\n\t\t\t\tminutesInDay = this._getMinutesPerDay(dayStart);\n\t\t\t\tcalculatedDay = dayEnd;\n\t\t\t}\n\n\t\t\tvar left = duration - added;\n\t\t\tvar timestamp = this._getTimeOfDayStamp(start, iterateFromDayEnd);\n\n\t\t\tif(!daySchedule.length || !minutesInDay){\n\t\t\t\tstart = this.$gantt.date.add(start, -1, \"day\");\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif(daySchedule[daySchedule.length - 1].end <= timestamp){\n\t\t\t\tif(left > minutesInDay){\n\t\t\t\t\tadded += minutesInDay;\n\t\t\t\t\tstart = this.$gantt.date.add(start, -1, \"day\");\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar isWorkHour = false;\n\t\t\tvar workInterval = null;\n\t\t\tvar prevInterval = null;\n\t\t\tfor(var i = daySchedule.length - 1; i >= 0; i--){\n\t\t\t\tif(daySchedule[i].start < timestamp - 1 && daySchedule[i].end >= timestamp - 1){\n\t\t\t\t\tisWorkHour = true;\n\t\t\t\t\tworkInterval = daySchedule[i];\n\t\t\t\t\tprevInterval = daySchedule[i-1];\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(isWorkHour){\n\n\t\t\t\t// we're at the end of worktime interval and subtracting more than the duration of the interval\n\t\t\t\t// -> subtract the duration of the interval and move to the start of the interval (we're moving from end)\n\t\t\t\tif(timestamp === workInterval.end && left >= workInterval.durationMinutes){\n\t\t\t\t\tadded += workInterval.durationMinutes;\n\t\t\t\t\tstart = this.$gantt.date.add(start, -workInterval.durationMinutes, \"minute\");\n\t\t\t\t} // worktime is set in whole hours (no intervals like 9:15-10:00)\n\t\t\t\t// the amount we need to subtract lies inside the interval\n\t\t\t\telse if(!minutePrecision && left <= (timestamp/60 - workInterval.startMinute)){\n\t\t\t\t\tadded += left;\n\t\t\t\t\tstart = this.$gantt.date.add(start, -left, \"minute\");\n\t\t\t\t}else if (minutePrecision){\n\t\t\t\t\t// GS-2129. If the working time is set in minutes, we accumulate the working time in minutes from right to left\n\t\t\t\t\t\n\t\t\t\t\t// duration we need to subtract lies completely inside the work interval\n\t\t\t\t\tif(left <= (timestamp/60 - workInterval.startMinute)){\n\t\t\t\t\t\tadded += left;\n\t\t\t\t\t\tstart = this.$gantt.date.add(start, -left, \"minute\");\n\t\t\t\t\t}else {\n\t\t\t\t\t\t// we need to go trough multiple work intervals to subtract needed time\n\t\t\t\t\t\tadded += (timestamp/60 - workInterval.startMinute);\n\t\t\t\t\t\tif(prevInterval){\n\t\t\t\t\t\t\tstart = new Date(start.getFullYear(), start.getMonth(), start.getDate(), 0, 0, prevInterval.end);\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tstart = this.$gantt.date.day_start(start);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\n\t\t\t\t}else{\n\t\t\t\t\tvar minutesInHour = this._getMinutesPerHour(start);\n\t\t\t\t\tif(minutesInHour <= left){\n\t\t\t\t\t\tadded += minutesInHour;\n\t\t\t\t\t\tstart = this._nextDate(start, \"hour\", step);\n\t\t\t\t\t}else{\n\t\t\t\t\t\taddedInterval = this._subtractMinutesUntilHourStart(start, left);\n\t\t\t\t\t\tadded += addedInterval.added;\n\t\t\t\t\t\tstart = addedInterval.end;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tif(start.getHours() === 0 && start.getMinutes() === 0 && start.getSeconds() === 0){\n\t\t\t\t\tvar prev = this._getClosestWorkTimePast(start, \"hour\");\n\t\t\t\t\tif(prev.valueOf() === start.valueOf()){\n\t\t\t\t\t\tvar prev = this.$gantt.date.add(start, -1, \"day\");\n\t\t\t\t\t\tvar times = this._getWorkHours(prev);\n\t\t\t\t\t\tif(times.length){\n\t\t\t\t\t\t\tvar lastInterval = times[times.length - 1];\n\t\t\t\t\t\t\tprev.setSeconds(lastInterval.durationSeconds);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tstart = prev;\n\n\t\t\t\t} else{\n\t\t\t\t\tstart = this._getClosestWorkTimePast(new Date(start - 1), \"hour\");\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\n\t\tif (added < duration) {\n\t\t\tvar durationLeft = duration - added;\n\t\t\taddedInterval = this._subtractMinutesUntilHourStart(start, durationLeft);\n\t\t\tadded += addedInterval.added;\n\t\t\tstart = addedInterval.end;\n\t\t}\n\n\t\treturn start;\n\t},\n\t_calculateMinuteEndDate: function (from, duration, step) {\n\t\tvar start = new Date(from),\n\t\t\tadded = 0;\n\t\tstep = step || 1;\n\t\tduration = Math.abs(duration * 1);\n\t\tduration = Math.round(duration);\n\n\t\tvar addedInterval = this._addMinutesUntilHourEnd(start, duration);\n\t\tadded += addedInterval.added;\n\n\t\tstart = addedInterval.end;\n\n\t\tvar calculatedDay = 0;\n\t\tvar daySchedule = [];\n\t\tvar minutesInDay = 0;\n\n\t\tvar minutePrecision = this._isMinutePrecision(start);\n\n\t\twhile (added < duration) {\n\t\t\tvar dayStart = this.$gantt.date.day_start(new Date(start)).valueOf();\n\t\t\tif(dayStart !== calculatedDay){\n\t\t\t\tdaySchedule = this._getWorkHours(start);\n\t\t\t\tminutesInDay = this._getMinutesPerDay(start);\n\t\t\t\tcalculatedDay = dayStart;\n\n\t\t\t}\n\n\t\t\tvar left = duration - added;\n\t\t\tvar timestamp = this._getTimeOfDayStamp(start);\n\n\t\t\tif(!daySchedule.length || !minutesInDay){\n\t\t\t\tstart = this.$gantt.date.add(this.$gantt.date.day_start(start), 1, \"day\");\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif(daySchedule[0].start >= timestamp){\n\t\t\t\tif(left >= minutesInDay){\n\t\t\t\t\tadded += minutesInDay;\n\t\t\t\t\tif (left == minutesInDay) {\n\t\t\t\t\t\tstart = new Date(start.getFullYear(), start.getMonth(), start.getDate(), 0, 0, daySchedule[daySchedule.length - 1].end);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tstart = this.$gantt.date.add(start, 1, \"day\");\n\t\t\t\t\t\tstart = this.$gantt.date.day_start(start);\n\t\t\t\t\t}\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar isWorkHour = false;\n\t\t\tvar workInterval = null;\n\t\t\tfor(var i = 0; i < daySchedule.length; i++){\n\t\t\t\tif(daySchedule[i].start <= timestamp && daySchedule[i].end > timestamp){\n\t\t\t\t\tisWorkHour = true;\n\t\t\t\t\tworkInterval = daySchedule[i];\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(isWorkHour){\n\n\t\t\t\tif(timestamp === workInterval.start && left >= workInterval.durationMinutes){\n\t\t\t\t\tadded += workInterval.durationMinutes;\n\t\t\t\t\tstart = this.$gantt.date.add(start, workInterval.durationMinutes, \"minute\");\n\t\t\t\t}else if(left <= (workInterval.endMinute - timestamp/60)){\n\t\t\t\t\tadded += left;\n\t\t\t\t\tstart = this.$gantt.date.add(start, left, \"minute\");\n\t\t\t\t}else{\n\t\t\t\t\tvar minutesInHour = this._getMinutesPerHour(start);\n\t\t\t\t\tif(minutesInHour <= left){\n\t\t\t\t\t\tadded += minutesInHour;\n\t\t\t\t\t\t// when the working time settings are set in minutes move to the next minutes\n\t\t\t\t\t\tif (minutePrecision) {\n\t\t\t\t\t\t\tstart = this.$gantt.date.add(start, minutesInHour, \"minute\");\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tstart = this._nextDate(start, \"hour\", step);\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{\n\t\t\t\t\t\taddedInterval = this._addMinutesUntilHourEnd(start, left);\n\t\t\t\t\t\tadded += addedInterval.added;\n\t\t\t\t\t\tstart = addedInterval.end;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tstart = this._getClosestWorkTimeFuture(start, \"hour\");\n\t\t\t}\n\t\t}\n\n\t\tif (added < duration) {\n\t\t\tvar durationLeft = duration - added;\n\t\t\taddedInterval = this._addMinutesUntilHourEnd(start, durationLeft);\n\t\t\tadded += addedInterval.added;\n\t\t\tstart = addedInterval.end;\n\t\t}\n\n\t\treturn start;\n\t},\n\n\tgetClosestWorkTime: function () {\n\t\tvar settings =  this.argumentsHelper.getClosestWorkTimeArguments.apply( this.argumentsHelper, arguments);\n\t\treturn this._getClosestWorkTime(settings.date, settings.unit, settings.dir);\n\t},\n\n\t_getClosestWorkTime: function (inputDate, unit, direction) {\n\t\tvar result = new Date(inputDate);\n\n\t\tif (this._isWorkTime(result, unit)) {\n\t\t\treturn result;\n\t\t}\n\n\t\tresult = this.$gantt.date[unit + '_start'](result);\n\n\t\tif (direction == 'any' || !direction) {\n\t\t\tvar closestFuture = this._getClosestWorkTimeFuture(result, unit);\n\t\t\tvar closestPast = this._getClosestWorkTimePast(result, unit);\n\t\t\tif (Math.abs(closestFuture - inputDate) <= Math.abs(inputDate - closestPast)) {\n\t\t\t\tresult = closestFuture;\n\t\t\t} else {\n\t\t\t\tresult = closestPast;\n\t\t\t}\n\t\t} else if (direction == \"past\") {\n\t\t\tresult = this._getClosestWorkTimePast(result, unit);\n\t\t} else {\n\t\t\tresult = this._getClosestWorkTimeFuture(result, unit);\n\t\t}\n\t\treturn result;\n\t},\n\n\t_getClosestWorkTimeFuture: function (date, unit) {\n\t\treturn this._getClosestWorkTimeGeneric(date, unit, 1);\n\t},\n\n\t_getClosestWorkTimePast: function (date, unit) {\n\t\tvar result = this._getClosestWorkTimeGeneric(date, unit, -1);\n\t\t// should return the end of the closest work interval\n\t\treturn this.$gantt.date.add(result, 1, unit);\n\t},\n\n\t_findClosestTimeInDay: function(date, direction, worktimes) {\n\t\tvar start = new Date(date);\n\t\tvar resultDate = null;\n\t\tvar fromDayEnd = false;\n\t\tif(!this._getWorkHours(start).length){\n\t\t\tstart = this._getClosestWorkTime(start, \"day\", direction < 0 ? \"past\" : \"future\");\n\t\t\tif(direction < 0){\n\t\t\t\tstart = new Date(start.valueOf() - 1);\n\t\t\t\tfromDayEnd = true;\n\t\t\t}\n\t\t\tworktimes = this._getWorkHours(start);\n\t\t}\n\n\t\tvar value = this._getTimeOfDayStamp(start);\n\t\tif(fromDayEnd){\n\t\t\tvalue = this._getTimeOfDayStamp(new Date(start.valueOf() + 1), fromDayEnd);\n\t\t}\n\t\tif(direction > 0){\n\t\t\tfor(var i = 0; i < worktimes.length; i++){\n\t\t\t\tif(worktimes[i].start >= value){\n\t\t\t\t\tresultDate = new Date(start.getFullYear(), start.getMonth(), start.getDate(), 0, 0, worktimes[i].start);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}else{\n\t\t\tfor(var i = worktimes.length - 1; i >= 0; i--){\n\t\t\t\tif(worktimes[i].end <= value){\n\t\t\t\t\tresultDate = new Date(start.getFullYear(), start.getMonth(), start.getDate(), 0, 0, worktimes[i].end);\n\t\t\t\t\tbreak;\n\t\t\t\t}else if(worktimes[i].end > value && worktimes[i].start <= value) {\n\t\t\t\t\tresultDate = new Date(start.getFullYear(), start.getMonth(), start.getDate(), 0, 0, value);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn resultDate;\n\t},\n\t_getClosestWorkMinute: function(date, unit, direction) {\n\t\tvar start = new Date(date);\n\t\tvar worktimes = this._getWorkHours(start);\n\t\tvar resultDate = this._findClosestTimeInDay(start, direction, worktimes);\n\t\tif(!resultDate){\n\t\t\tif(direction > 0){\n\t\t\t\tstart = this.calculateEndDate(start, direction, unit);\n\t\t\t\tstart = this.$gantt.date.day_start(start);\n\t\t\t}else{\n\t\t\t\tstart = this.calculateEndDate(start, direction, \"day\");\n\t\t\t\tstart = this.$gantt.date.day_start(start);\n\t\t\t\tstart = this.$gantt.date.add(start, 1, \"day\");\n\t\t\t\tstart = new Date(start.valueOf() - 1);\n\t\t\t}\n\t\t\tworktimes = this._getWorkHours(start);\n\t\t\tresultDate = this._findClosestTimeInDay(start, direction, worktimes);\n\t\t}\n\t\tif(direction < 0){\n\t\t\t// getClosestWorkTimePast adds one time unit to the result date after this\n\t\t\tresultDate = this.$gantt.date.add(resultDate, -1, unit);\n\t\t}\n\t\treturn resultDate;\n\t},\n\n\t_getClosestWorkTimeGeneric: function (date, unit, increment) {\n\t\tif(unit === \"hour\" || unit === \"minute\"){\n\t\t\treturn this._getClosestWorkMinute(date, unit, increment);\n\t\t}\n\n\t\tvar unitOrder = this._getUnitOrder(unit),\n\t\t\tbiggerTimeUnit = this.units[unitOrder - 1];\n\n\t\tvar result = date;\n\n\t\t// be extra sure we won't fall into infinite loop, 3k seems big enough\n\t\tvar maximumLoop = 3000,\n\t\t\tcount = 0;\n\n\t\twhile (!this._isWorkTime(result, unit)) {\n\t\t\tif (biggerTimeUnit && !this._isWorkTime(result, biggerTimeUnit)) {\n\t\t\t\t// if we look for closest work hour and detect a week-end - first find the closest work day,\n\t\t\t\t// and continue iterations after that\n\t\t\t\tif (increment > 0) {\n\t\t\t\t\tresult = this._getClosestWorkTimeFuture(result, biggerTimeUnit);\n\t\t\t\t} else {\n\t\t\t\t\tresult = this._getClosestWorkTimePast(result, biggerTimeUnit);\n\t\t\t\t}\n\n\t\t\t\tif (this._isWorkTime(result, unit)) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tcount++;\n\t\t\tif (count > maximumLoop) {\n\t\t\t\tthis.$gantt.assert(false, \"Invalid working time check\");\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tvar tzOffset = result.getTimezoneOffset();\n\t\t\tresult = this.$gantt.date.add(result, increment, unit);\n\n\t\t\tresult = this.$gantt._correct_dst_change(result, tzOffset, increment, unit);\n\t\t\tif (this.$gantt.date[unit + '_start']) {\n\t\t\t\tresult = this.$gantt.date[unit + '_start'](result);\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t},\n\n\t/**\n\t * Check whether this calendar has working time. Calendar has working time only if there are regular working days of week\n\t *\n\t */\n\thasWorkTime: function () {\n\t\tvar worktime = this.getConfig();\n\t\tvar dates = worktime.dates;\n\n\t\tvar daysOfWeek = [0, 1, 2, 3, 4, 5, 6];\n\t\tvar exceptions = [];\n\t\tfor(var i in worktime.dates){\n\t\t\tif(Number(i) > 6){\n\t\t\t\texceptions.push(Number(i));\n\t\t\t}\n\t\t}\n\n\t\tvar hasRegularHours = this._checkWorkHours(worktime.hours);\n\n\t\tvar result = false;\n\t\tdaysOfWeek.forEach((function(day){\n\t\t\tif(result){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar dayConfig = dates[day];\n\t\t\tif(dayConfig === true){\n\t\t\t\t// workday uses global hours\n\t\t\t\tresult = hasRegularHours;\n\t\t\t}else if(Array.isArray(dayConfig)){\n\t\t\t\t// workday uses custom hours\n\t\t\t\tresult = this._checkWorkHours(dayConfig);\n\t\t\t}\n\t\t}).bind(this));\n\n\t\treturn result;\n\n\t},\n\n\t_checkWorkHours: function(hoursArray) {\n\t\tif (hoursArray.length === 0) {\n\t\t\treturn false;\n\t\t}\n\t\tvar result = false;\n\t\tfor (var i = 0; i < hoursArray.length; i += 2) {\n\t\t\tif (hoursArray[i] !== hoursArray[i + 1]) {\n\t\t\t\tresult = true;\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t},\n\n\t_isMinutePrecision: function (date) {\n\t\tlet minutePrecision = false;\n\t\tthis._getWorkHours(date).forEach(function(interval){\n\t\t\tif (interval.startMinute % 60 || interval.endMinute % 60){\n\t\t\t\tminutePrecision = true;\n\t\t\t}\n\t\t});\n\t\treturn minutePrecision;\n\t}\n};\n\nexport default CalendarWorkTimeStrategy;","import { IWorkUnitCache } from \"./workunit_cache_interface\";\nimport { WorkUnitsMapCache } from \"./workunit_map_cache\";\nimport { WorkUnitsObjectCache } from \"./workunit_object_cache\";\nexport { LargerUnitsCache } from \"./larger_units_helper\";\n\nexport function createCacheObject(): IWorkUnitCache {\n\n\t// worktime hash is on the hot path,\n\t// Map seems to work faster than plain array, use it whenever possible\n\tif (typeof Map !== \"undefined\") {\n\t\treturn new WorkUnitsMapCache();\n\t} else {\n\t\treturn new WorkUnitsObjectCache();\n\t}\n}\n","export default {\n\tisLegacyResourceCalendarFormat: function(resourceCalendarsProperty){\n\t\t// modern format:\n\t\t//gantt.config.resource_calendars = {\n\t\t//\tresourceId: calendarId,\n\t\t//\tresourceId: calendarId,\n\t\t//\tresourceId: calendarId\n\t\t//\t};\n\t\t\n\t\t// legacy format:\n\t\t// gantt.config.resource_calendars = {\n\t\t//\t\"resourceProperty\": {\n\t\t//\t\tresourceId: calendarId,\n\t\t//\t\tresourceId: calendarId,\n\t\t//\t\tresourceId: calendarId\n\t\t//\t\t}\n\t\t//\t};\n\n\t\tif(!resourceCalendarsProperty){\n\t\t\treturn false;\n\t\t}\n\t\tfor(var i in resourceCalendarsProperty){\n\t\t\tif(resourceCalendarsProperty[i] && typeof resourceCalendarsProperty[i] === \"object\"){\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t},\n\tgetResourceProperty: function(config){\n\t\tvar resourceCalendarsConfig = config.resource_calendars;\n\t\tvar propertyName = config.resource_property;\n\t\tif(this.isLegacyResourceCalendarFormat(resourceCalendarsConfig)){\n\t\t\tfor(var i in config){\n\t\t\t\tpropertyName = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn propertyName;\n\t},\n\tgetCalendarIdFromLegacyConfig: function(task, config){\n\t\tif (config) {\n\t\t\tfor (var field in config) {\n\t\t\t\tvar resource = config[field];\n\t\t\t\tif (task[field]) {\n\t\t\t\t\tvar calendarId = resource[task[field]];\n\t\t\t\t\tif (calendarId) {\n\t\t\t\t\t\treturn calendarId;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n};","import * as utils from \"../../utils/utils\";\nimport createArgumentsHelper from \"./calendar_arguments_helper\";\nimport CalendarMergeHelper from \"./strategy/work_calendar_merger\";\nimport CalendarWorkTimeStrategy from \"./strategy/calendar_strategy\";\nimport legacyResourceCalendarConfig from \"./legacy_resource_config\";\nimport dynamicResourceCalendarsFactory from \"./dynamic_resource_calendars\";\n\nconst dynamicResourceCalendars = dynamicResourceCalendarsFactory();\n\nfunction CalendarManager (gantt){\n\tthis.$gantt = gantt;\n\tthis._calendars = {};\n\tthis._legacyConfig = undefined;\n\tthis.$gantt.attachEvent(\"onGanttReady\", function(){\n\t\tif(this.$gantt.config.resource_calendars){\n\t\t\tthis._isLegacyConfig = legacyResourceCalendarConfig.isLegacyResourceCalendarFormat(this.$gantt.config.resource_calendars);\n\t\t}\n\t}.bind(this));\n\n\tthis.$gantt.attachEvent(\"onBeforeGanttReady\", function(){\n\t\tthis.createDefaultCalendars();\n\t}.bind(this));\n\tthis.$gantt.attachEvent(\"onBeforeGanttRender\", function(){\n\t\tthis.createDefaultCalendars();\n\t}.bind(this));\n}\n\nCalendarManager.prototype = {\n\t_calendars: {},\n\t_convertWorkTimeSettings: function (settings) {\n\t\tconst days = settings.days;\n\t\t//GS-2864: opportunity to specify specific dates\n\t\tif(typeof days === \"object\" && !Array.isArray(days) && days !== null){\n\t\t\tconst datesConfig = {};\n\t\t\tif(days?.weekdays){\n\t\t\t\tfor(let i = 0; i < 7; i++) {\n\t\t\t\t\tdatesConfig[i] = days.weekdays[i];\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (days?.dates) {\n\t\t\t\tObject.entries(days.dates).forEach(([date, setting]) => {\n\t\t\t\t\tdatesConfig[(new Date(date)).valueOf()] = setting;\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tObject.entries(datesConfig).forEach(([key, setting]) => {\n\t\t\t\tif (!(setting instanceof Array)) {\n\t\t\t\t\tdatesConfig[key] = !!setting;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tsettings = {\n\t\t\t\t...settings,\n\t\t\t\tdates: datesConfig\n\t\t\t};\n\n\t\t} else if (days && !settings.dates) {\n\t\t\tsettings.dates = settings.dates || {};\n\t\t\tfor (let i = 0; i < days.length; i++) {\n\t\t\t\tsettings.dates[i] = days[i];\n\t\t\t\tif (!(days[i] instanceof Array)) {\n\t\t\t\t\tsettings.dates[i] = !!days[i];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tdelete settings.days;\n\t\treturn settings;\n\t},\n\tmergeCalendars: function(){\n\t\tvar calendars = [];\n\t\tvar args = arguments;\n\t\tif(Array.isArray(args[0])){\n\t\t\tcalendars = args[0].slice();\n\t\t}else{\n\t\t\tfor(var i = 0; i < arguments.length; i++){\n\t\t\t\tcalendars.push(arguments[i]);\n\t\t\t}\n\t\t}\n\n\t\tvar mergeHelper = new CalendarMergeHelper();\n\n\t\tvar result;\n\t\tcalendars.forEach(function(calendar){\n\t\t\tif(!result){\n\t\t\t\tresult = calendar;\n\t\t\t} else{\n\t\t\t\tresult = this._createCalendarFromConfig(mergeHelper.merge(result, calendar));\n\t\t\t}\n\n\t\t}.bind(this));\n\t\treturn this.createCalendar(result);\n\t},\n\n\t_createCalendarFromConfig: function(config){\n\t\tvar apiCore = new CalendarWorkTimeStrategy(this.$gantt, createArgumentsHelper(this.$gantt));\n\t\tapiCore.id = String(utils.uid());\n\n\t\tvar preparedConfig = this._convertWorkTimeSettings(config);\n\t\tif(preparedConfig.customWeeks){\n\t\t\tfor(var i in preparedConfig.customWeeks){\n\t\t\t\tpreparedConfig.customWeeks[i] = this._convertWorkTimeSettings(preparedConfig.customWeeks[i]);\n\t\t\t}\n\t\t}\n\t\tapiCore._setConfig(preparedConfig);\n\n\t\treturn apiCore;\n\t},\n\n\tcreateCalendar: function (parentCalendar) {\n\t\tvar settings;\n\n\t\tif (!parentCalendar) {\n\t\t\tparentCalendar = {};\n\t\t}\n\n\t\tif (parentCalendar.getConfig){\n\t\t\tsettings = utils.copy(parentCalendar.getConfig());\n\t\t} else if (parentCalendar.worktime) {\n\t\t\tsettings = utils.copy(parentCalendar.worktime);\n\t\t} else {\n\t\t\tsettings = utils.copy(parentCalendar);\n\t\t}\n\n\t\tvar defaults = utils.copy(this.defaults.fulltime.worktime);\n\t\tutils.mixin(settings, defaults);\n\n\t\treturn this._createCalendarFromConfig(settings);\n\t},\n\n\tgetCalendar: function (id) {\n\t\tid = id || \"global\";\n\t\tvar calendar = this._calendars[id];\n\t\tif(!calendar){\n\t\t\tthis.createDefaultCalendars();\n\t\t\tcalendar = this._calendars[id];\n\t\t}\n\n\t\treturn calendar;\n\t},\n\n\tgetCalendars: function () {\n\t\tvar res = [];\n\t\tfor (var i in this._calendars) {\n\t\t\tres.push(this.getCalendar(i));\n\t\t}\n\t\treturn res;\n\t},\n\n\t_getOwnCalendar: function(task){\n\t\tvar config = this.$gantt.config;\n\t\tif (task[config.calendar_property]) {\n\t\t\treturn this.getCalendar(task[config.calendar_property]);\n\t\t}\n\n\t\tif (config.resource_calendars) {\n\t\t\tvar calendar;\n\t\t\tvar calendarId;\n\t\t\tvar resourceProperty;\n\t\t\tif(this._legacyConfig === false){\n\t\t\t\tresourceProperty = config.resource_property;\n\t\t\t}else{\n\t\t\t\tresourceProperty = legacyResourceCalendarConfig.getResourceProperty(config);\n\t\t\t}\n\t\t\t// GS-2821. If no resource is assigned to a task,\n\t\t\t// there is no need to check the resource calendar\n\t\t\tif(Array.isArray(task[resourceProperty]) && task[resourceProperty].length){\n\t\t\t\t// if multiple resources are attached to the task - merge their calendars\n\t\t\t\tif(config.dynamic_resource_calendars){\n\t\t\t\t\tcalendarId = dynamicResourceCalendars.getCalendarIdFromMultipleResources(task[resourceProperty], this);\n\t\t\t\t} else {\n\t\t\t\t\tcalendar = this.getResourceCalendar(task[resourceProperty]);\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tif(this._legacyConfig === undefined){\n\t\t\t\t\tthis._legacyConfig = legacyResourceCalendarConfig.isLegacyResourceCalendarFormat(config.resource_calendars);\n\t\t\t\t}\n\n\t\t\t\tif(this._legacyConfig){\n\t\t\t\t\tvar calendarId = legacyResourceCalendarConfig.getCalendarIdFromLegacyConfig(task, config.resource_calendars);\n\t\t\t\t}else if(resourceProperty && task[resourceProperty] && config.resource_calendars[task[resourceProperty]]){\n\t\t\t\t\tvar calendar = this.getResourceCalendar(task[resourceProperty]);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(calendarId){\n\t\t\t\tcalendar = this.getCalendar(calendarId);\n\t\t\t}\n\n\t\t\tif(calendar){\n\t\t\t\treturn calendar;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t},\n\n\t/**\n\t * Returns calendar assigned to the specified resource.\n\t * Returns the global calendar if no custom calendar is associated with the resource.\n\t * @param {(string|number|Object)} resource - resource object or resource id\n\t * @returns {object} Calendar object\n\t */\n\tgetResourceCalendar: function(resource) {\n\t\tif (resource === null || resource === undefined) {\n\t\t\treturn this.getCalendar();\n\t\t}\n\n\t\tvar resourceId = null;\n\t\t// if task id is provided\n\t\tif((typeof resource === \"number\" || typeof resource === \"string\")){\n\t\t\tresourceId = resource;\n\t\t}else{\n\t\t\tresourceId = resource.id || resource.key;\n\t\t}\n\n\t\tvar config = this.$gantt.config;\n\t\tvar calendarsConfig = config.resource_calendars;\n\t\tvar calendarId = null;\n\n\t\t// GS-1714: if resource is specified through array\n\t\tif (Array.isArray(resource)){\n\t\t\tif (resource.length === 1){\n\t\t\t\tif (typeof resource[0] === 'object'){\n\t\t\t\t\tresourceId = resource[0].resource_id; // if resource: [\"resource_id: \"6\", value: \"4\", ...\"]\n\t\t\t\t} else {\n\t\t\t\t\tresourceId = resource[0]; // if resource: [1]\n\t\t\t\t}\n\t\t\t} \n\t\t}\n\t\t\n\t\tif (calendarsConfig) {\n\t\t\tif(this._legacyConfig === undefined){\n\t\t\t\tthis._legacyConfig = legacyResourceCalendarConfig.isLegacyResourceCalendarFormat(config.resource_calendars);\n\t\t\t}\n\n\t\t\tif(this._legacyConfig){\n\t\t\t\tfor(var field in calendarsConfig){\n\t\t\t\t\tif(calendarsConfig[field][resourceId]){\n\t\t\t\t\t\tcalendarId = calendarsConfig[field][resourceId];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tvar calendarId = calendarsConfig[resourceId];\n\t\t\t}\n\n\t\t\tif(calendarId){\n\t\t\t\treturn this.getCalendar(calendarId);\n\t\t\t}\n\n\t\t}\n\t\treturn this.getCalendar();\n\t},\n\n\t/**\n\t * Returns the calendar assigned to a task.\n\t * - Returns a calendar assigned via task[gantt.config.calendar_property] if specified.\n\t * - Returns a calendar assigned to the task resource if specified.\n\t * - Returns the global calendar otherwise.\n\t * @param {(string|number|Object)} task - task object or task id\n\t * @returns {object} Calendar object\n\t */\n\tgetTaskCalendar: function (task) {\n\t\tvar gantt = this.$gantt;\n\t\tvar taskObject;\n\t\tif (task === null || task === undefined) {\n\t\t\treturn this.getCalendar();\n\t\t}\n\n\t\t// if task id is provided\n\t\tif((typeof task === \"number\" || typeof task === \"string\") && gantt.isTaskExists(task)){\n\t\t\ttaskObject = gantt.getTask(task);\n\t\t}else{\n\t\t\ttaskObject = task;\n\t\t}\n\n\t\tif(!taskObject){\n\t\t\treturn this.getCalendar();\n\t\t}\n\n\t\tvar calendar = this._getOwnCalendar(taskObject);\n\t\tvar groupMode = !!gantt.getState().group_mode;\n\n\t\tif (!calendar && gantt.config.inherit_calendar && gantt.isTaskExists(taskObject.parent)){\n\t\t\t// GS-1579  group mode overrides tree hierarchy, iterate using `.parent` property, instead of using eachParent iterator\n\t\t\tvar currentTask = taskObject;\n\t\t\twhile(gantt.isTaskExists(currentTask.parent)){\n\t\t\t\tcurrentTask = gantt.getTask(currentTask.parent);\n\t\t\t\tif(gantt.isSummaryTask(currentTask)){\n\t\t\t\t\tcalendar = this._getOwnCalendar(currentTask);\n\t\t\t\t\tif(calendar){\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(groupMode && !calendar){\n\t\t\t\t// if group mode and inherit_calendars is enabled - preserve previously applied parent calendar\n\t\t\t\t// we may need it when groupBy parses grouped data, old parent may be not loaded yet\n\t\t\t\tif(task.$effective_calendar){\n\t\t\t\t\tcalendar = this.getCalendar(task.$effective_calendar);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn calendar || this.getCalendar();\n\t},\n\n\taddCalendar: function(calendar) { // puts new calendar to Global Storage - gantt.calendarManager._calendars {}\n\t\tif (!(this.isCalendar(calendar))) {\n\t\t\tvar id = calendar.id;\n\t\t\tcalendar = this.createCalendar(calendar);\n\t\t\tcalendar.id = id;\n\t\t}\n\n\t\t// validate/check if empty calendar\n\t\tif (!calendar._tryChangeCalendarSettings(function () {\n\t\t\t})) {\n\n\t\t\tthis.$gantt.callEvent(\"onCalendarError\", [{message: \"Invalid calendar settings, no worktime available\"}, calendar]);\n\t\t\treturn null;\n\t\t} else {\n\t\t\tvar config = this.$gantt.config;\n\n\t\t\tcalendar.id = calendar.id || utils.uid();\n\t\t\tthis._calendars[calendar.id] = calendar;\n\t\t\tif (!config.worktimes)\n\t\t\t\tconfig.worktimes = {};\n\t\t\tconfig.worktimes[calendar.id] = calendar.getConfig();\n\t\t\treturn calendar.id;\n\t\t}\n\t},\n\n\tdeleteCalendar: function (calendar) {\n\t\tvar config = this.$gantt.config;\n\t\tif (!calendar) return false;\n\t\tif (this._calendars[calendar]) {\n\t\t\tdelete this._calendars[calendar];\n\t\t\tif (config.worktimes && config.worktimes[calendar])\n\t\t\t\tdelete config.worktimes[calendar];\n\t\t\treturn true;\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t},\n\n\trestoreConfigCalendars: function (configs) {\n\t\tfor (var i in configs) {\n\t\t\tif (this._calendars[i])\n\t\t\t\tcontinue;\n\n\t\t\tvar settings = configs[i];\n\t\t\tvar calendar = this.createCalendar(settings);\n\t\t\tcalendar.id = i;\n\t\t\tthis.addCalendar(calendar);\n\t\t}\n\t},\n\n\tdefaults: {\n\t\tglobal: {\n\t\t\tid: \"global\",\n\t\t\tworktime: {\n\t\t\t\thours: [8, 12, 13, 17],\n\t\t\t\tdays: [0, 1, 1, 1, 1, 1, 0]\n\t\t\t}\n\t\t},\n\t\tfulltime: {\n\t\t\tid: \"fulltime\",\n\t\t\tworktime: {\n\t\t\t\thours: [0, 24],\n\t\t\t\tdays: [1, 1, 1, 1, 1, 1, 1]\n\t\t\t}\n\t\t}\n\t},\n\n\tcreateDefaultCalendars: function () {\n\t\tvar config = this.$gantt.config;\n\t\tthis.restoreConfigCalendars(this.defaults);\n\t\tthis.restoreConfigCalendars(config.worktimes);\n\t},\n\n\tisCalendar: function(possibleCalendar) {\n\t\t// because we don't have any way to check without dependency to CalendarWorkTimeStrategy\n\t\tvar props = [\n\t\t\tpossibleCalendar.isWorkTime,\n\t\t\tpossibleCalendar.setWorkTime,\n\t\t\tpossibleCalendar.getWorkHours,\n\t\t\tpossibleCalendar.unsetWorkTime,\n\t\t\tpossibleCalendar.getClosestWorkTime,\n\t\t\tpossibleCalendar.calculateDuration,\n\t\t\tpossibleCalendar.hasDuration,\n\t\t\tpossibleCalendar.calculateEndDate\n\t\t];\n\t\treturn props.every(function(entry) {\n\t\t\treturn entry instanceof Function;\n\t\t});\n\t}\n};\n\nexport default CalendarManager;","export default function() {\n\tfunction getResourcesCalendarKey(resourceAssignments){\n\t\treturn resourceAssignments.map(function(res){\n\t\t\tif(res && res.resource_id){\n\t\t\t\treturn res.resource_id;\n\t\t\t} else {\n\t\t\t\treturn res;\n\t\t\t}\n\t\t}).sort().join(\"-\");\n\t}\n\n\tvar dynamicCalendars = {};\n\n\tfunction mergeResourceCalendars(resourceAssignments, manager){\n\t\treturn manager.mergeCalendars(resourceAssignments.map(function(assignment){\n\t\t\tvar resourceId = (assignment && assignment.resource_id) ? assignment.resource_id : assignment;\n\t\t\treturn manager.getResourceCalendar(resourceId);\n\t\t}));\n\t}\n\tfunction getCalendarIdFromMultipleResources(resourceAssignments, manager){\n\t\tvar key = getResourcesCalendarKey(resourceAssignments);\n\t\tif(!resourceAssignments.length){\n\t\t\treturn null;\n\t\t}else if(resourceAssignments.length === 1){\n\t\t\treturn manager.getResourceCalendar(key).id;\n\t\t}else if (dynamicCalendars[key]){\n\t\t\treturn dynamicCalendars[key].id;\n\t\t} else {\n\t\t\tvar tempCalendar = mergeResourceCalendars(resourceAssignments, manager);\n\n\t\t\tdynamicCalendars[key] = tempCalendar;\n\t\t\treturn manager.addCalendar(tempCalendar);\n\t\t}\n\t}\n\n\treturn {\n\t\tgetCalendarIdFromMultipleResources: getCalendarIdFromMultipleResources\n\t};\n};","function CalendarDisabledTimeStrategy(gantt, argumentsHelper){\n\tthis.argumentsHelper = argumentsHelper;\n\tthis.$gantt = gantt;\n}\n\nCalendarDisabledTimeStrategy.prototype = {\n\tgetWorkHours: function () {\n\t\treturn [0, 24];\n\t},\n\tsetWorkTime: function () {\n\t\treturn true;\n\t},\n\tunsetWorkTime: function () {\n\t\treturn true;\n\t},\n\tisWorkTime: function () {\n\t\treturn true;\n\t},\n\tgetClosestWorkTime: function (config) {\n\t\tvar config = this.argumentsHelper.getClosestWorkTimeArguments.apply(this.argumentsHelper, arguments);\n\t\treturn config.date;\n\t},\n\n\tcalculateDuration: function () {\n\t\tvar config = this.argumentsHelper.getDurationArguments.apply(this.argumentsHelper, arguments);\n\t\tvar from = config.start_date,\n\t\t\tto = config.end_date,\n\t\t\tunit = config.unit,\n\t\t\tstep = config.step;\n\n\t\treturn this._calculateDuration(from, to, unit, step);\n\t},\n\t_calculateDuration: function (start, end, unit, step) {\n\t\tvar dateHelper = this.$gantt.date;\n\t\tvar fixedUnits = {\n\t\t\t\"week\": 1000 * 60 * 60 * 24 * 7,\n\t\t\t\"day\": 1000 * 60 * 60 * 24,\n\t\t\t\"hour\": 1000 * 60 * 60,\n\t\t\t\"minute\": 1000 * 60\n\t\t};\n\n\t\tvar res = 0;\n\t\tif (fixedUnits[unit]) {\n\t\t\tres = Math.round((end - start) / (step * fixedUnits[unit]));\n\t\t} else {\n\t\t\tvar from = new Date(start),\n\t\t\t\tto = new Date(end);\n\t\t\twhile (from.valueOf() < to.valueOf()) {\n\t\t\t\tres += 1;\n\t\t\t\tfrom = dateHelper.add(from, step, unit);\n\t\t\t}\n\n\t\t\tif (from.valueOf() != end.valueOf()) {\n\t\t\t\tres += (to - from) / (dateHelper.add(from, step, unit) - from);\n\t\t\t}\n\t\t}\n\n\t\treturn Math.round(res);\n\t},\n\n\thasDuration: function () {\n\t\tvar config = this.argumentsHelper.getDurationArguments.apply(this.argumentsHelper, arguments);\n\t\tvar from = config.start_date,\n\t\t\tto = config.end_date,\n\t\t\tunit = config.unit;\n\n\t\tif (!unit) {\n\t\t\treturn false;\n\t\t}\n\t\tfrom = new Date(from);\n\t\tto = new Date(to);\n\n\t\treturn (from.valueOf() < to.valueOf());\n\t},\n\n\thasWorkTime: function() {\n\t\treturn true;\n\t},\n\n\tequals: function(calendar) {\n\t\tif(!(calendar instanceof CalendarDisabledTimeStrategy)){\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t},\n\n\tcalculateEndDate: function () {\n\t\tvar config = this.argumentsHelper.calculateEndDateArguments.apply(this.argumentsHelper, arguments);\n\n\t\tvar start = config.start_date,\n\t\t\tduration = config.duration,\n\t\t\tunit = config.unit,\n\t\t\tstep = config.step;\n\n\t\treturn this.$gantt.date.add(start, step * duration, unit);\n\t}\n};\n\nexport default CalendarDisabledTimeStrategy;","import createArgumentsHelper from \"./calendar_arguments_helper\";\nimport NoWorkTimeCalendar from \"./strategy/no_work_time\";\n\nfunction TimeCalculator(calendarManager){\n\n\tthis.$gantt = calendarManager.$gantt;\n\tthis.argumentsHelper = createArgumentsHelper(this.$gantt);\n\tthis.calendarManager = calendarManager;\n\tthis.$disabledCalendar = new NoWorkTimeCalendar(this.$gantt, this.argumentsHelper);\n}\n\nTimeCalculator.prototype = {\n\t_getCalendar: function (config) {\n\t\tvar calendar;\n\t\tif (!this.$gantt.config.work_time) {\n\t\t\tcalendar = this.$disabledCalendar;\n\t\t} else {\n\t\t\tvar manager = this.calendarManager;\n\t\t\tif (config.task) {\n\t\t\t\tcalendar = manager.getTaskCalendar(config.task);\n\t\t\t} else if (config.id) {\n\t\t\t\tcalendar = manager.getTaskCalendar(config);\n\t\t\t} else if (config.calendar) {\n\t\t\t\tcalendar = config.calendar;\n\t\t\t}\n\t\t\tif (!calendar) {\n\t\t\t\tcalendar = manager.getTaskCalendar();\n\t\t\t}\n\t\t}\n\t\treturn calendar;\n\t},\n\n\tgetWorkHours: function (config) {\n\t\tconfig = this.argumentsHelper.getWorkHoursArguments.apply(this.argumentsHelper, arguments);\n\n\t\tvar calendar = this._getCalendar(config);\n\n\t\treturn calendar.getWorkHours(config.date);\n\t},\n\n\tsetWorkTime: function (config, calendar) {\n\t\tconfig = this.argumentsHelper.setWorkTimeArguments.apply(this.argumentsHelper, arguments);\n\n\t\tif (!calendar)\n\t\t\tcalendar = this.calendarManager.getCalendar(); // Global\n\t\treturn calendar.setWorkTime(config);\n\t},\n\n\tunsetWorkTime: function (config, calendar) {\n\t\tconfig = this.argumentsHelper.unsetWorkTimeArguments.apply(this.argumentsHelper, arguments);\n\n\t\tif (!calendar)\n\t\t\tcalendar = this.calendarManager.getCalendar(); // Global\n\t\treturn calendar.unsetWorkTime(config);\n\t},\n\tisWorkTime: function (date, unit, task, calendar) {\n\t\tvar config = this.argumentsHelper.isWorkTimeArguments.apply(this.argumentsHelper, arguments);\n\n\t\tcalendar = this._getCalendar(config);\n\t\treturn calendar.isWorkTime(config);\n\t},\n\tgetClosestWorkTime: function (config) {\n\t\tconfig = this.argumentsHelper.getClosestWorkTimeArguments.apply(this.argumentsHelper, arguments);\n\n\t\tvar calendar = this._getCalendar(config);\n\n\t\treturn calendar.getClosestWorkTime(config);\n\t},\n\n\tcalculateDuration: function () { // start_date_date, end_date, task\n\t\tvar config = this.argumentsHelper.getDurationArguments.apply(this.argumentsHelper, arguments);\n\n\n\t\tvar calendar = this._getCalendar(config);\n\t\treturn calendar.calculateDuration(config);\n\t},\n\thasDuration: function () {\n\t\tvar config = this.argumentsHelper.hasDurationArguments.apply(this.argumentsHelper, arguments);\n\n\t\tvar calendar = this._getCalendar(config);\n\n\t\treturn calendar.hasDuration(config);\n\t},\n\tcalculateEndDate: function (config) { // start_date, duration, unit, task\n\t\tvar config = this.argumentsHelper.calculateEndDateArguments.apply(this.argumentsHelper, arguments);\n\n\t\tvar calendar = this._getCalendar(config);\n\t\treturn calendar.calculateEndDate(config);\n\t}\n};\n\nexport default TimeCalculator;\n\n","// TODO: rework public api for date methods\nimport * as utils from \"../../utils/utils\";\n\nvar createWorkTimeFacade = function(calendarManager, timeCalculator){\n\treturn {\n\t\tgetWorkHours: function (date) {\n\t\t\treturn timeCalculator.getWorkHours(date);\n\t\t},\n\n\t\tsetWorkTime: function (config) {\n\t\t\treturn timeCalculator.setWorkTime(config);\n\t\t},\n\n\t\tunsetWorkTime: function (config) {\n\t\t\ttimeCalculator.unsetWorkTime(config);\n\t\t},\n\n\t\tisWorkTime: function (date, unit, task) {\n\t\t\treturn timeCalculator.isWorkTime(date, unit, task);\n\t\t},\n\n\t\tgetClosestWorkTime: function (config) {\n\t\t\treturn timeCalculator.getClosestWorkTime(config);\n\t\t},\n\n\t\tcalculateDuration: function (start_date, end_date, task) {\n\t\t\treturn timeCalculator.calculateDuration(start_date, end_date, task);\n\t\t},\n\t\t_hasDuration: function (start_date, end_date, task) {\n\t\t\treturn timeCalculator.hasDuration(start_date, end_date, task);\n\t\t},\n\n\t\tcalculateEndDate: function (start, duration, unit, task) {\n\t\t\treturn timeCalculator.calculateEndDate(start, duration, unit, task);\n\t\t},\n\n\t\tmergeCalendars: utils.bind(calendarManager.mergeCalendars, calendarManager),\n\t\tcreateCalendar: utils.bind(calendarManager.createCalendar, calendarManager),\n\t\taddCalendar: utils.bind(calendarManager.addCalendar, calendarManager),\n\t\tgetCalendar: utils.bind(calendarManager.getCalendar, calendarManager),\n\t\tgetCalendars: utils.bind(calendarManager.getCalendars, calendarManager),\n\t\tgetResourceCalendar: utils.bind(calendarManager.getResourceCalendar, calendarManager),\n\t\tgetTaskCalendar: utils.bind(calendarManager.getTaskCalendar, calendarManager),\n\t\tdeleteCalendar: utils.bind(calendarManager.deleteCalendar, calendarManager)\n\t};\n};\n\n\nexport default { create: createWorkTimeFacade };","import * as helpers from \"../utils/helpers\";\n\nexport default function(gantt) {\n\n\tgantt.isUnscheduledTask = function (task) {\n\t\tgantt.assert(task && task instanceof Object, \"Invalid argument <b>task</b>=\"+task+\" of gantt.isUnscheduledTask. Task object was expected\");\n\t\treturn (!!task.unscheduled || !task.start_date);\n\t};\n\n\tgantt._isAllowedUnscheduledTask = function (task) {\n\t\treturn !!(task.unscheduled && gantt.config.show_unscheduled);\n\t};\n\n\tgantt._isTaskInTimelineLimits = function(task) {\n\t\tvar taskStart = task.start_date ? task.start_date.valueOf() : null;\n\t\tvar taskEnd = task.end_date ? task.end_date.valueOf() : null;\n\t\treturn !!(taskStart && taskEnd && taskStart <= this._max_date.valueOf() && taskEnd >= this._min_date.valueOf());\n\t};\n\tgantt.isTaskVisible = function (id) {\n\t\tif (!this.isTaskExists(id)) {\n\t\t\treturn false;\n\t\t}\n\n\t\tvar task = this.getTask(id);\n\t\tif (!(this._isAllowedUnscheduledTask(task) || this._isTaskInTimelineLimits(task))) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn !!(this.getGlobalTaskIndex(id) >= 0);\n\t};\n\n\tgantt._getProjectEnd = function() {\n\t\tif(gantt.config.project_end){\n\t\t\treturn gantt.config.project_end;\n\t\t}else{\n\t\t\tvar tasks = gantt.getTaskByTime();\n\t\t\ttasks = tasks.sort(function (a, b) {\n\t\t\t\treturn +a.end_date > +b.end_date ? 1 : -1;\n\t\t\t});\n\t\t\treturn tasks.length ? tasks[tasks.length - 1].end_date : null;\n\t\t}\n\t};\n\tgantt._getProjectStart = function() {\n\t\tif (gantt.config.project_start) {\n\t\t\treturn gantt.config.project_start;\n\t\t}\n\n\t\t// use timeline start if project start is not specified\n\t\tif (gantt.config.start_date) {\n\t\t\treturn gantt.config.start_date;\n\t\t}\n\t\tif (gantt.getState().min_date) {\n\t\t\treturn gantt.getState().min_date;\n\t\t}\n\n\t\t// earliest task start if neither project start nor timeline are specified\n\t\tvar tasks = gantt.getTaskByTime();\n\t\ttasks = tasks.sort(function (a, b) {\n\t\t\treturn +a.start_date > +b.start_date ? 1 : -1;\n\t\t});\n\t\treturn tasks.length ? tasks[0].start_date : null;\n\t};\n\n\tvar getDefaultTaskDate = function (item, parent_id) {\n\t\tvar parentExists = parent_id && parent_id != gantt.config.root_id && gantt.isTaskExists(parent_id);\n\t\tvar parent = parentExists ? gantt.getTask(parent_id) : false,\n\t\t\tstartDate = null;\n\t\tif (parent) {\n\t\t\tif(gantt._getAutoSchedulingConfig().schedule_from_end){\n\t\t\t\tstartDate = gantt.calculateEndDate({\n\t\t\t\t\tstart_date: parent.end_date,\n\t\t\t\t\tduration: - gantt.config.duration_step,\n\t\t\t\t\ttask:item\n\t\t\t\t});\n\t\t\t}else{\n\t\t\t\tif(!parent.start_date){\n\t\t\t\t\treturn getDefaultTaskDate(parent, gantt.getParent(parent));\n\t\t\t\t}\n\t\t\t\tstartDate = parent.start_date;\n\t\t\t}\n\n\t\t} else if(gantt._getAutoSchedulingConfig().schedule_from_end) {\n\t\t\tstartDate = gantt.calculateEndDate({\n\t\t\t\tstart_date: gantt._getProjectEnd(),\n\t\t\t\tduration: - gantt.config.duration_step,\n\t\t\t\ttask:item\n\t\t\t});\n\t\t} else {\n\t\t\tconst first = gantt.getTaskByIndex(0);\n\t\t\tconst minDate = gantt.config.start_date || gantt.getState().min_date;\n\n\t\t\tif (first){\n\t\t\t\tif (first.start_date){\n\t\t\t\t\tstartDate = first.start_date;\n\t\t\t\t}\n\t\t\t\telse if (first.end_date){\n\t\t\t\t\tstartDate = gantt.calculateEndDate({\n\t\t\t\t\t\tstart_date: first.end_date,\n\t\t\t\t\t\tduration: -gantt.config.duration_step,\n\t\t\t\t\t\ttask:item\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tstartDate = minDate;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tstartDate = minDate;\n\t\t\t}\n\t\t}\n\t\tgantt.assert(startDate, \"Invalid dates\");\n\t\treturn new Date(startDate);\n\t};\n\n\tgantt._set_default_task_timing = function (task) {\n\t\ttask.start_date = task.start_date || getDefaultTaskDate(task, gantt.getParent(task));\n\t\ttask.duration = task.duration || gantt.config.duration_step;\n\t\ttask.end_date = task.end_date || gantt.calculateEndDate(task);\n\t};\n\n\tgantt.createTask = function (item, parent, index) {\n\t\titem = item || {};\n\n\t\tif (!gantt.defined(item.id))\n\t\t\titem.id = gantt.uid();\n\n\t\tif (!item.start_date) {\n\t\t\titem.start_date = getDefaultTaskDate(item, parent);\n\t\t}\n\t\tif (item.text === undefined) {\n\t\t\titem.text = gantt.locale.labels.new_task;\n\t\t}\n\t\tif (item.duration === undefined) {\n\t\t\titem.duration = 1;\n\t\t}\n\n\t\tif (this.isTaskExists(parent)) {\n\t\t\tthis.setParent(item, parent, true);\n\t\t\tvar parentObj = this.getTask(parent);\n\t\t\tparentObj.$open = true;\n\t\t\t// GS-1583. Save the $open state to the Undo Stack\n\t\t\tif (!this.config.details_on_create){\n\t\t\t\tthis.callEvent(\"onAfterParentExpand\", [parent, parentObj]);\n\t\t\t}\n\t\t}\n\n\t\tif (!this.callEvent(\"onTaskCreated\", [item])) {\n\t\t\treturn null;\n\t\t}\n\t\tif (this.config.details_on_create) {\n\t\t\t//GS-761: assert unique ID\n\t\t\tif (gantt.isTaskExists(item.id)){\n\t\t\t\tvar task = gantt.getTask(item.id);\n\t\t\t\tif (task.$index != item.$index) {\n\t\t\t\t\t// Someone may try to mistakenly add a task with the same ID, and most likely\n\t\t\t\t\t// use the string format for the dates. Gantt shouldn't break in this scenario\n\t\t\t\t\tif (item.start_date && typeof item.start_date === \"string\"){\n\t\t\t\t\t\titem.start_date = this.date.parseDate(item.start_date, \"parse_date\");\n\t\t\t\t\t}\n\t\t\t\t\tif (item.end_date && typeof item.end_date === \"string\"){\n\t\t\t\t\t\titem.end_date = this.date.parseDate(item.end_date, \"parse_date\");\n\t\t\t\t\t}\n\t\t\t\t\tthis.$data.tasksStore.updateItem(item.id, item);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\titem.$new = true;\n\t\t\t\tthis.silent(function(){\n\t\t\t\t\tgantt.$data.tasksStore.addItem(item, index);\n\t\t\t\t});\n\t\t\t}\n\t\t\tthis.selectTask(item.id);\n\t\t\tthis.refreshData();\n\t\t\tthis.showLightbox(item.id);\n\t\t} else {\n\t\t\tif (this.addTask(item, parent, index)) {\n\t\t\t\tthis.showTask(item.id);\n\t\t\t\tthis.selectTask(item.id);\n\t\t\t}\n\t\t}\n\t\treturn item.id;\n\t};\n\n\tgantt._update_flags = function (oldid, newid) {\n\t\t//  TODO: need a proper way to update all possible flags\n\t\tvar store = gantt.$data.tasksStore;\n\t\tif (oldid === undefined) {\n\t\t\tthis._lightbox_id = null;\n\n\t\t\tstore.silent(function(){\n\t\t\t\tstore.unselect();\n\t\t\t});\n\t\t\t// GS-1522. If we have multiselect, unselect all previously selected tasks\n\t\t\tif (this.getSelectedTasks) {\n\t\t\t\tthis._multiselect.reset();\n\t\t\t}\n\n\t\t\tif (this._tasks_dnd && this._tasks_dnd.drag) {\n\t\t\t\tthis._tasks_dnd.drag.id = null;\n\t\t\t}\n\t\t} else {\n\t\t\tif (this._lightbox_id == oldid)\n\t\t\t\tthis._lightbox_id = newid;\n\n\t\t\t// TODO: probably can be removed\n\t\t\tif (store.getSelectedId() == oldid) {\n\t\t\t\tstore.silent(function(){\n\t\t\t\t\tstore.unselect(oldid);\n\t\t\t\t\tstore.select(newid);\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (this._tasks_dnd && this._tasks_dnd.drag && this._tasks_dnd.drag.id == oldid) {\n\t\t\t\tthis._tasks_dnd.drag.id = newid;\n\t\t\t}\n\t\t}\n\t};\n\n\tvar getTaskTimingMode = function (task, force) {\n\t\tvar task_type = gantt.getTaskType(task.type);\n\n\t\tvar state = {\n\t\t\ttype: task_type,\n\t\t\t$no_start: false,\n\t\t\t$no_end: false,\n\t\t\tscheduled_summary: false\n\t\t};\n\n\t\tif(task_type === gantt.config.types.project && task.auto_scheduling === false){\n\t\t\tstate.scheduled_summary = true;\n\t\t}\n\n\t\tif (!force && task_type == task.$rendered_type) {\n\t\t\tstate.$no_start = task.$no_start;\n\t\t\tstate.$no_end = task.$no_end;\n\t\t\treturn state;\n\t\t}\n\n\t\tif (task_type == gantt.config.types.project) {\n\t\t\t//project duration is always defined by children duration\n\t\t\tstate.$no_end = state.$no_start = true;\n\t\t} else if (task_type != gantt.config.types.milestone) {\n\t\t\t//tasks can have fixed duration, children duration(as projects), or one date fixed, and other defined by nested items\n\t\t\tstate.$no_end = !(task.end_date || task.duration);\n\t\t\tstate.$no_start = !task.start_date;\n\n\t\t\tif (gantt._isAllowedUnscheduledTask(task)) {\n\t\t\t\tstate.$no_end = state.$no_start = false;\n\t\t\t}\n\t\t}\n\n\t\treturn state;\n\t};\n\n\tgantt._init_task_timing = function (task) {\n\t\tvar task_mode = getTaskTimingMode(task, true);\n\n\t\tvar dirty = task.$rendered_type != task_mode.type;\n\n\t\tvar task_type = task_mode.type;\n\n\t\tif (dirty) {\n\t\t\ttask.$no_start = task_mode.$no_start;\n\t\t\ttask.$no_end = task_mode.$no_end;\n\t\t\ttask.$rendered_type = task_mode.type;\n\t\t}\n\n\t\tif (dirty && task_type != this.config.types.milestone) {\n\t\t\tif (task_type == this.config.types.project) {\n\t\t\t\t//project duration is always defined by children duration\n\t\t\t\tthis._set_default_task_timing(task);\n\t\t\t\ttask.$calculate_duration = false;// do not recalculate duration below\n\t\t\t}\n\t\t}\n\n\t\tif (task_type == this.config.types.milestone) {\n\t\t\ttask.end_date = task.start_date;\n\t\t}\n\t\tif (task.start_date && task.end_date && task.$calculate_duration !== false) {\n\t\t\ttask.duration = this.calculateDuration(task);\n\t\t}\n\n\t\tif(!task.$calculate_duration){\n\t\t\ttask.$calculate_duration = true;\n\t\t}\n\n\t\tif (!task.end_date) {\n\t\t\ttask.end_date = task.start_date;\n\t\t}\n\n\t\ttask.duration = task.duration || 0;\n\t\t// GS-1145. We should let tasks to have 0 duration if user wants it\n\t\tif (this.config.min_duration === 0 && task.duration === 0){\n\t\t\ttask.$no_end = false;\n\t\t\t//GS-2813: special case for project that has 0 duration with milestone child\n\t\t\tif(task.type === gantt.config.types.project && gantt.hasChild(task.id)){\n\t\t\t\ttask.$no_end = true;\n\t\t\t}\n\t\t}\n\n\t\t// work calendar of task has changed\n\t\tvar effectiveCalendar = this.getTaskCalendar(task);\n\t\tif(task.$effective_calendar && task.$effective_calendar !== effectiveCalendar.id){\n\t\t\tupdateTaskTiming(task);\n\t\t\tif(this.config.inherit_calendar && this.isSummaryTask(task)){\n\t\t\t\tthis.eachTask(function(child){\n\t\t\t\t\tupdateTaskTiming(child);\n\t\t\t\t}, task.id);\n\t\t\t}\n\t\t}\n\n\t\ttask.$effective_calendar = effectiveCalendar.id;\n\t};\n\n\tfunction updateTaskTiming(task) {\n\t\ttask.$effective_calendar = gantt.getTaskCalendar(task).id;\n\t\ttask.start_date = gantt.getClosestWorkTime({\n\t\t\tdir: \"future\",\n\t\t\tdate: task.start_date,\n\t\t\tunit: gantt.config.duration_unit,\n\t\t\ttask: task\n\t\t});\n\t\ttask.end_date = gantt.calculateEndDate(task);\n\t}\n\n\tgantt.isSummaryTask = function (task) {\n\t\tgantt.assert(task && task instanceof Object, \"Invalid argument <b>task</b>=\"+task+\" of gantt.isSummaryTask. Task object was expected\");\n\n\t\tvar mode = getTaskTimingMode(task);\n\n\t\treturn !!(mode.$no_end || mode.$no_start);\n\t};\n\n// downward calculation of project duration\n\tgantt.resetProjectDates = function (task) {\n\t\tvar taskMode = getTaskTimingMode(task);\n\t\tif (taskMode.$no_end || taskMode.$no_start) {\n\t\t\tvar info = getSubtaskInfo(task.id);\n\t\t\tassignProjectDates.call(this, task, taskMode, info.start_date, info.end_date);\n\t\t\ttask.$rollup = info.rollup;\n\t\t\ttask.$inlineSplit = info.splitItems;\n\t\t}\n\t};\n\n\tfunction assignProjectDates(task, taskTiming, from, to) {\n\n\t\tconst summaryDateFields = {\n\t\t\tstart: \"start_date\",\n\t\t\tend: \"end_date\"\n\t\t};\n\t\tconst manuallyScheduledSummaryDateFields = {\n\t\t\tstart: \"$auto_start_date\",\n\t\t\tend: \"$auto_end_date\"\n\t\t};\n\n\t\tlet dateFields;\n\t\tif(task.type === gantt.config.types.project && task.auto_scheduling === false){\n\t\t\tdateFields = manuallyScheduledSummaryDateFields;\n\t\t}else{\n\t\t\tdateFields = summaryDateFields;\n\t\t}\n\n\t\tif (taskTiming.$no_start) {\n\t\t\tif (from) {\n\t\t\t\ttask[dateFields.start] = new Date(from);\n\t\t\t} else {\n\t\t\t\ttask[dateFields.start] = getDefaultTaskDate(task, this.getParent(task));\n\t\t\t}\n\t\t}\n\n\t\tif (taskTiming.$no_end) {\n\t\t\tif (to) {\n\t\t\t\ttask[dateFields.end] = new Date(to);\n\t\t\t} else {\n\t\t\t\ttask[dateFields.end] = this.calculateEndDate({\n\t\t\t\t\tstart_date: task[dateFields.start],\n\t\t\t\t\tduration: this.config.duration_step,\n\t\t\t\t\ttask: task\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\tif (taskTiming.$no_start || taskTiming.$no_end) {\n\t\t\tthis._init_task_timing(task);\n\t\t}\n\t}\n\n\tgantt.getSubtaskDuration = function (taskId) {\n\t\tvar res = 0,\n\t\t\troot = taskId !== undefined ? taskId : gantt.config.root_id;\n\n\t\tthis.eachTask(function (child) {\n\t\t\tif (this.getTaskType(child.type) == gantt.config.types.project || this.isUnscheduledTask(child))\n\t\t\t\treturn;\n\n\t\t\tres += child.duration;\n\t\t}, root);\n\n\t\treturn res;\n\t};\n\n\tfunction getSubtaskInfo (taskId){\n\t\tlet min = null;\n\t\tlet max = null;\n\t\tlet root = taskId !== undefined ? taskId : gantt.config.root_id;\n\t\tconst rollup = [];\n\t\tconst inlineSplit = [];\n\n\t\tlet rootTask = null;\n\t\tif(gantt.isTaskExists(root)){\n\t\t\trootTask = gantt.getTask(root);\n\t\t}\n\n\t\tgantt.eachTask(function (child) {\n\t\t\tconst isScheduledSummary = (gantt.getTaskType(child.type) == gantt.config.types.project && (child.auto_scheduling === false));\n\t\t\tif ((gantt.getTaskType(child.type) == gantt.config.types.project && !isScheduledSummary) || gantt.isUnscheduledTask(child))\n\t\t\t\treturn;\n\n\t\t\tif(child.rollup){\n\t\t\t\trollup.push(child.id);\n\t\t\t}\n\n\t\t\tif ((child.start_date && (!child.$no_start || isScheduledSummary)) && (!min || min > child.start_date.valueOf()))\n\t\t\t\tmin = child.start_date.valueOf();\n\t\t\tif ((child.end_date && (!child.$no_end || isScheduledSummary)) && (!max || max < child.end_date.valueOf()))\n\t\t\t\tmax = child.end_date.valueOf();\n\n\n\t\t\tif(rootTask && rootTask.render == \"split\"){\n\t\t\t\tif(child.split_placement === \"inline\"){\n\t\t\t\t\tinlineSplit.push(child);\n\t\t\t\t}else if(child.split_placement !== \"subrow\" && (!rootTask.$open || !gantt.config.open_split_tasks)){\n\t\t\t\t\tinlineSplit.push(child);\n\t\t\t\t}\n\t\t\t}\n\t\t}, root);\n\n\t\treturn {\n\t\t\tstart_date: min ? new Date(min) : null,\n\t\t\tend_date: max ? new Date(max) : null,\n\t\t\trollup: rollup,\n\t\t\tsplitItems: inlineSplit\n\t\t};\n\t}\n\n\tgantt.getSubtaskDates = function (task_id) {\n\t\tvar info = getSubtaskInfo(task_id);\n\t\treturn {\n\t\t\tstart_date: info.start_date,\n\t\t\tend_date: info.end_date\n\t\t};\n\t};\n\n\n// upward calculation of project duration\n\tgantt._update_parents = function (taskId, silent, updateAll) {\n\t\tif (!taskId) return;\n\n\t\tvar task = this.getTask(taskId);\n\t\tif(task.rollup){\n\t\t\tupdateAll = true;\n\t\t}\n\t\tvar pid = this.getParent(task);\n\n\t\tvar taskTiming = getTaskTimingMode(task);\n\n\t\tvar has_changed = true;\n\t\t// GS-761 the dates check is necessary for adding empty tasks: gantt.addTask({id:\"2\"})\n\t\tif (updateAll || (task.start_date && task.end_date && (taskTiming.$no_start || taskTiming.$no_end))) {\n\n\t\t\tconst startDateField = task.$auto_start_date ? \"$auto_start_date\" : \"start_date\";\n\t\t\tconst endDateField = task.$auto_end_date ? \"$auto_end_date\" : \"end_date\";\n\n\t\t\tvar oldStart = task[startDateField].valueOf(),\n\t\t\t\toldEnd = task[endDateField].valueOf();\n\n\t\t\tgantt.resetProjectDates(task);\n\n\t\t\t// not refresh parent projects if dates hasn't changed\n\t\t\tif (!updateAll && oldStart == task[startDateField].valueOf() && oldEnd == task[endDateField].valueOf()) {\n\t\t\t\thas_changed = false;\n\t\t\t}\n\n\t\t\tif (has_changed && !silent) {\n\t\t\t\tthis.refreshTask(task.id, true);\n\t\t\t}\n\n\t\t\tif(taskTiming.scheduled_summary){\n\t\t\t\thas_changed = true;//recalculate upwards from scheduled summaries\n\t\t\t}\n\t\t}\n\n\n\t\tif (has_changed && pid && this.isTaskExists(pid)) {\n\t\t\tthis._update_parents(pid, silent, updateAll);\n\t\t}\n\t};\n\n\tgantt.roundDate = function (config) {\n\t\tvar scale = gantt.getScale();\n\n\t\tif (helpers.isDate(config)) {\n\t\t\tconfig = {\n\t\t\t\tdate: config,\n\t\t\t\tunit: scale ? scale.unit : gantt.config.duration_unit,\n\t\t\t\tstep: scale ?  scale.step : gantt.config.duration_step\n\t\t\t};\n\t\t}\n\t\tvar date = config.date,\n\t\t\tsteps = config.step,\n\t\t\tunit = config.unit;\n\n\t\tif(!scale){\n\t\t\treturn date;\n\t\t}\n\n\t\tvar upper, lower, colIndex;\n\t\tif (unit == scale.unit && steps == scale.step &&\n\t\t\t+date >= +scale.min_date && +date <= +scale.max_date) {\n\t\t\t//find date in time scale config\n\t\t\tcolIndex = Math.floor(gantt.columnIndexByDate(date));\n\n\t\t\tif (!scale.trace_x[colIndex]) {\n\t\t\t\tcolIndex -= 1;// end of time scale\n\t\t\t\tif(scale.rtl){\n\t\t\t\t\tcolIndex = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t\tlower = new Date(scale.trace_x[colIndex]);\n\t\t\tupper = gantt.date.add(lower, steps, unit);\n\t\t} else {\n\t\t\tcolIndex = Math.floor(gantt.columnIndexByDate(date));\n\n\t\t\tupper = gantt.date[unit + \"_start\"](new Date(scale.min_date));\n\t\t\tif (scale.trace_x[colIndex]) {\n\t\t\t\tupper = gantt.date[unit + \"_start\"](scale.trace_x[colIndex]);// end of time scale\n\t\t\t}\n\n\t\t\twhile (+upper < +date) {\n\t\t\t\tupper = gantt.date[unit + \"_start\"](gantt.date.add(upper, steps, unit));\n\n\t\t\t\tvar tzOffset = upper.getTimezoneOffset();\n\n\t\t\t\tupper = gantt._correct_dst_change(upper, tzOffset, upper, unit);\n\t\t\t\tif (gantt.date[unit + '_start'])\n\t\t\t\t\tupper = gantt.date[unit + '_start'](upper);\n\t\t\t}\n\n\t\t\tlower = gantt.date.add(upper, -1 * steps, unit);\n\n\t\t}\n\t\tif (config.dir && config.dir == 'future')\n\t\t\treturn upper;\n\t\tif (config.dir && config.dir == 'past')\n\t\t\treturn lower;\n\n\t\tif (Math.abs(date - lower) < Math.abs(upper - date)) {\n\t\t\treturn lower;\n\t\t} else {\n\t\t\treturn upper;\n\t\t}\n\n\t};\n\n\tgantt.correctTaskWorkTime = function (task) {\n\t\tif (gantt.config.work_time && gantt.config.correct_work_time) {\n\t\t\tif (!this.isWorkTime(task.start_date, undefined, task)) {\n\t\t\t\ttask.start_date = this.getClosestWorkTime({date: task.start_date, dir: 'future', task: task});\n\t\t\t\ttask.end_date = this.calculateEndDate(task);\n\t\t\t} else if (!this.isWorkTime(new Date(+task.end_date - 1), undefined, task)) {\n\t\t\t\ttask.end_date = this.calculateEndDate(task);\n\t\t\t}\n\t\t}\n\t};\n\n\tgantt.attachEvent(\"onBeforeTaskUpdate\", function (id, task) {\n\t\tgantt._init_task_timing(task);\n\t\treturn true;\n\t});\n\tgantt.attachEvent(\"onBeforeTaskAdd\", function (id, task) {\n\t\tgantt._init_task_timing(task);\n\t\treturn true;\n\t});\n\n\tgantt.attachEvent(\"onAfterTaskMove\", function (id, parent, tindex) {\n\t\tgantt._init_task_timing(gantt.getTask(id));\n\t\treturn true;\n\t});\n\n};","function addResizeListener(gantt){\n\tvar containerStyles = window.getComputedStyle(gantt.$root);\n\tif(containerStyles.getPropertyValue(\"position\") == \"static\"){\n\t\tgantt.$root.style.position = \"relative\";\n\t}\n\n\tvar resizeWatcher = document.createElement('iframe');\n\tresizeWatcher.className = \"gantt_container_resize_watcher\";\n\tresizeWatcher.tabIndex = -1;\n\tif(gantt.config.wai_aria_attributes){\n\t\tresizeWatcher.setAttribute(\"role\", \"none\");\n\t\tresizeWatcher.setAttribute(\"aria-hidden\", true);\n\t}\n\n\tif (gantt.env.isSalesforce){\n\t\tgantt.config.container_resize_method = \"timeout\";\n\t}\n\n\t// in some environments (namely, in SalesForce) iframe.contentWindow is not available\n\tgantt.$root.appendChild(resizeWatcher);\n\tif (resizeWatcher.contentWindow) {\n\t\tlistenWindowResize(gantt, resizeWatcher.contentWindow);\n\t} else {\n\t\t// if so - ditch the iframe and fallback to listening the main window resize\n\t\tgantt.$root.removeChild(resizeWatcher);\n\t\tlistenWindowResize(gantt, window);\n\t}\n}\n\nfunction listenWindowResize(gantt, window){\n\tvar resizeTimeout = gantt.config.container_resize_timeout || 20;\n\tvar resizeDelay;\n\tlet previousSize = getContainerSize(gantt);\n\n\tif (gantt.config.container_resize_method == \"timeout\"){\n\t\tlowlevelResizeWatcher();\n\t}\n\telse {\n\t\ttry {\n\t\t\tgantt.event(window, \"resize\", function () {\n\t\t\t\tif (gantt.$scrollbarRepaint) {\n\t\t\t\t\tgantt.$scrollbarRepaint = null;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// GS-2140. Don't repaint Gantt if it has the same sizes\n\t\t\t\t\tlet currentSize = getContainerSize(gantt);\n\t\t\t\t\tif (previousSize.x == currentSize.x && previousSize.y == currentSize.y){\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tpreviousSize = currentSize;\n\t\t\t\t\trepaintGantt();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\tcatch (e) {\n\t\t\tlowlevelResizeWatcher();\n\t\t}\n\t}\n\n\tfunction repaintGantt(){\n\t\tclearTimeout(resizeDelay);\n\t\tresizeDelay = setTimeout(function(){\n\t\t\tif(!gantt.$destroyed){\n\t\t\t\tgantt.render();\n\t\t\t}\n\t\t}, resizeTimeout);\n\t}\n\n\tvar previousHeight = gantt.$root.offsetHeight;\n\tvar previousWidth = gantt.$root.offsetWidth;\t\n\n\tfunction lowlevelResizeWatcher(){\n\t\tif (gantt.$root.offsetHeight != previousHeight ||\n\t\t\t\tgantt.$root.offsetWidth != previousWidth){\n\t\t\t\trepaintGantt();\n\t\t}\n\n\t\tpreviousHeight = gantt.$root.offsetHeight;\n\t\tpreviousWidth = gantt.$root.offsetWidth;\n\n\t\tsetTimeout(lowlevelResizeWatcher, resizeTimeout);\n\t}\n}\n\nfunction getContainerSize(gantt){\n\treturn {\n\t\tx: gantt.$root.offsetWidth,\n\t\ty: gantt.$root.offsetHeight\n\t};\n}\n\nexport default addResizeListener;","import * as domHelpers from \"./ui/utils/dom_helpers\";\nimport * as helpers from \"../utils/helpers\";\nimport isHeadless from \"../utils/is_headless\";\nimport addResizeListener from \"./ui/resize_listener\";\nimport calculateScaleRange from \"./gantt_data_range\";\nimport assert from \"./common/assert\";\n\nexport default function(gantt){\n\t\n\n\tgantt.assert = assert(gantt);\n\n\tfunction isHTMLElement(node){\n\t\ttry {\n\t\t\tnode.cloneNode(false);\n\t\t}\n\t\tcatch (e){\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\n\t}\n\n\tvar invalidContainerMessage = \"Invalid value of the first argument of `gantt.init`. Supported values: HTMLElement, String (element id).\" +\n\t\"This error means that either invalid object is passed into `gantt.init` or that the element with the specified ID doesn't exist on the page when `gantt.init` is called.\";\n\n\tfunction validateNode(node){\n\t\tif (!node || (typeof node == 'string' && document.getElementById(node))) return true;\n\t\tif (isHTMLElement(node)) return true;\n\n\t\tgantt.assert(false, invalidContainerMessage);\n\t\tthrow new Error(invalidContainerMessage);\n\t}\n\n//initial initialization\n\tgantt.init = function(node, from, to){\n\t\tif (gantt.env.isNode) { \n\t\t\tnode = null; // for the nodejs version\n\t\t} else {\n\t\t\tvalidateNode(node); // for the web version\n\t\t}\n\n\t\tif(from && to){\n\t\t\tthis.config.start_date = this._min_date = new Date(from);\n\t\t\tthis.config.end_date = this._max_date = new Date(to);\n\t\t}\n\t\tthis.date.init();\n\n\t\t//can be called only once\n\t\tthis.init = function(node){\n\t\t\tif (gantt.env.isNode) { \n\t\t\t\tnode = null; // for the nodejs version\n\t\t\t} else {\n\t\t\t\tvalidateNode(node); // for the web version\n\t\t\t}\n\n\t\t\tif (this.$container && this.$container.parentNode){\n\t\t\t\tthis.$container.parentNode.removeChild(this.$container);\n\t\t\t\tthis.$container = null;\n\t\t\t}\n\n\t\t\tif(this.$layout){\n\t\t\t\tthis.$layout.clear();\n\t\t\t}\n\t\t\tthis._reinit(node);\n\t\t};\n\t\tthis._reinit(node);\n\t};\n\n\tgantt._quickRefresh = function(code){\n\t\tvar stores = this._getDatastores.call(this);\n\t\tfor(var i = 0; i < stores.length; i++){\n\t\t\tstores[i]._quick_refresh = true;\n\t\t}\n\n\t\tcode();\n\n\t\tfor(var i = 0; i < stores.length; i++){\n\t\t\tstores[i]._quick_refresh = false;\n\t\t}\n\t};\n\n\tvar dropLayout = (function dropLayout(){\n\t\tif(this._clearTaskLayers){\n\t\t\tthis._clearTaskLayers();\n\t\t}\n\n\t\tif(this._clearLinkLayers){\n\t\t\tthis._clearLinkLayers();\n\t\t}\n\n\t\tif(this.$layout){\n\t\t\tthis.$layout.destructor();\n\t\t\tthis.$layout = null;\n\t\t\tthis.$ui.reset();\n\t\t}\n\t}).bind(gantt);\n\n\tvar rebuildLayout = (function rebuildLayout(){\n\t\tif(isHeadless(gantt)){\n\t\t\treturn;\n\t\t}\n\n\t\tthis.$root.innerHTML = \"\";\n\n\t\tthis.$root.gantt = this;\n\t\tcalculateScaleRange(this);\n\t\tthis.config.layout.id = \"main\";\n\t\tthis.$layout = this.$ui.createView(\"layout\", this.$root, this.config.layout);\n\n\t\tthis.$layout.attachEvent(\"onBeforeResize\", function(){\n\t\t\tvar storeNames = gantt.$services.getService(\"datastores\");\n\t\t\tfor(var i = 0; i < storeNames.length; i++){\n\t\t\t\tgantt.getDatastore(storeNames[i]).filter();\n\t\t\t\tif (gantt.$data.tasksStore._skipTaskRecalculation){\n\t\t\t\t\t// do not repaint items, they will be repainted later in the onStoreUpdate event\n\t\t\t\t\tif (gantt.$data.tasksStore._skipTaskRecalculation != \"lightbox\"){\n\t\t\t\t\t\tgantt.$data.tasksStore._skipTaskRecalculation = false;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t} else {\n\t\t\t\t\tgantt.getDatastore(storeNames[i]).callEvent(\"onBeforeRefreshAll\", []);\t\t\t\t\t\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tthis.$layout.attachEvent(\"onResize\", function(){\n\t\t\tgantt._quickRefresh(function(){\n\t\t\t\tgantt.refreshData();\n\t\t\t});\n\t\t});\n\n\t\tthis.callEvent(\"onGanttLayoutReady\", []);\n\t\tthis.$layout.render();\n\n\t\tthis.$container = this.$layout.$container.firstChild;\n\n\t\taddResizeListener(this);\n\t}).bind(gantt);\n\n\tgantt.resetLayout = function(){\n\t\tdropLayout();\n\t\trebuildLayout();\n\t\tthis.render();\n\t};\n\n\tgantt._reinit = function(node){\n\t\tthis.callEvent(\"onBeforeGanttReady\", []);\n\t\tthis._update_flags();\n\n\t\tvar config = this.$services.getService(\"templateLoader\");\n\t\tconfig.initTemplates(this);\n\n\t\tdropLayout();\n\n\t\tthis.$root = null;\n\t\tif(node){\n\t\t\tthis.$root = domHelpers.toNode(node);\n\t\t\trebuildLayout();\n\t\t\tthis.$mouseEvents.reset(this.$root);\n\t\t\taddMinimalSizes(gantt);\n\t\t}\n\n\t\tthis.callEvent(\"onTemplatesReady\",[]);\n\n\t\tthis.callEvent(\"onGanttReady\", []);\n\n\t\tthis.render();\n\t};\n\n\tfunction addMinimalSizes(gantt) {\n\t\tif (gantt.$container && !gantt.config.autosize) {\n\t\t\tif (gantt.$root.offsetHeight < 50) {\n\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\tconsole.warn(`The Gantt container has a small height, so you cannot see its content. If it is not intended, you need to set the 'height' style rule to the container:\nhttps://docs.dhtmlx.com/gantt/faq.html#theganttchartisntrenderedcorrectly`);\n\t\t\t}\n\t\t}\n\t}\n\n\tgantt.$click={\n\t\tbuttons:{\n\t\t\t\"edit\": function(id) {\n\t\t\t\tif (gantt.isReadonly(gantt.getTask(id))) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tgantt.showLightbox(id);\n\t\t\t},\n\t\t\t\"delete\": function(id) {\n\t\t\t\tvar task = gantt.getTask(id);\n\t\t\t\tif (gantt.isReadonly(task)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar question = gantt.locale.labels.confirm_deleting;\n\t\t\t\tvar title = gantt.locale.labels.confirm_deleting_title;\n\n\t\t\t\tgantt._delete_task_confirm({\n\t\t\t\t\ttask: task,\n\t\t\t\t\tmessage: question,\n\t\t\t\t\ttitle: title,\n\t\t\t\t\tcallback: function(){\n\t\t\t\t\t\tif(!gantt.isTaskExists(id)){\n\t\t\t\t\t\t\tgantt.hideLightbox();\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif(task.$new){\n\t\t\t\t\t\t\t// GS-2170. Do not recalculate the indexes and dates of other tasks\n\t\t\t\t\t\t\t// as they will be recalculated in the `refreshData`\n\t\t\t\t\t\t\tgantt.$data.tasksStore._skipTaskRecalculation = \"lightbox\";\n\t\t\t\t\t\t\tgantt.silent(function(){\n\t\t\t\t\t\t\t\tgantt.deleteTask(id, true);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tgantt.$data.tasksStore._skipTaskRecalculation = false;\n\t\t\t\t\t\t\tgantt.refreshData();\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tgantt.$data.tasksStore._skipTaskRecalculation = true;\n\t\t\t\t\t\t\tgantt.deleteTask(id);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tgantt.hideLightbox();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t};\n\n//renders self\n\tgantt.render = function(){\n\t\tthis.callEvent(\"onBeforeGanttRender\", []);\n\n\t\tvar visibleDate;\n\t\tif(!isHeadless(gantt)){\n\t\t\tif (!this.config.sort && this._sort) {\n\t\t\t\tthis._sort = undefined;\n\t\t\t}\n\n\t\t\tif(this.$root){\n\t\t\t\tif(this.config.rtl){\n\t\t\t\t\tthis.$root.classList.add(\"gantt_rtl\");\n\t\t\t\t\tthis.$root.firstChild.classList.add(\"gantt_rtl\"); // GS-1499\n\t\t\t\t}else{\n\t\t\t\t\tthis.$root.classList.remove(\"gantt_rtl\");\n\t\t\t\t\tthis.$root.firstChild.classList.remove(\"gantt_rtl\"); // GS-1499\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar pos = this.getScrollState();\n\t\t\tvar posX = pos ? pos.x : 0;\n\t\t\tif(this._getHorizontalScrollbar()){\n\t\t\t\tvar scrollbar = this._getHorizontalScrollbar();\n\t\t\t\tposX = scrollbar.$config.codeScrollLeft || posX || 0;\n\t\t\t}\n\n\n\t\t\tvisibleDate = null;\n\t\t\tif(posX){\n\t\t\t\tvisibleDate = gantt.dateFromPos(posX + this.config.task_scroll_offset);\n\t\t\t}\n\t\t}\n\n\t\tcalculateScaleRange(this);\n\n\t\tif(!isHeadless(gantt)){\n\t\t\tthis.$layout.$config.autosize = this.config.autosize;\n\t\t\tvar preserveScroll = this.config.preserve_scroll;\n\t\t\tthis.config.preserve_scroll = false; // prevent scrolling from layout resize, scroll will be called here later on\n\t\t\tthis.$layout.resize();\n\t\t\tthis.config.preserve_scroll = preserveScroll;\n\n\t\t\tif(this.config.preserve_scroll && pos){\n\t\t\t\t// GS-1640: We need pos.y, otherwise part of the timeline won't be rendered if the scrollbar disappeared\n\t\t\t\t// GS-2945: don't need to scroll if the zoom ext was initialized cause it will be scrolled in zoom\n\t\t\t\tconst zoom = gantt.ext.zoom._initialized;  \n\t\t\t\tif ((posX || pos.y) && !zoom) {\n\t\t\t\t\tvar new_pos = gantt.getScrollState();\n\t\t\t\t\tvar new_date = gantt.dateFromPos(new_pos.x);\n\t\t\t\t\tif(!(+visibleDate == +new_date && new_pos.y == pos.y)){\n\t\t\t\t\t\tvar posX = null;\n\t\t\t\t\t\tvar posY = null;\n\t\t\t\t\t\tif(visibleDate){\n\t\t\t\t\t\t\tvar posX = Math.max(gantt.posFromDate(visibleDate) - gantt.config.task_scroll_offset, 0);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(pos.y){\n\t\t\t\t\t\t\tposY = pos.y;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tgantt.scrollTo(posX, posY);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// GS-1640: We need to reset the scroll position for the grid if the scrollbar disappeared and\n\t\t\t\t// the grid and timeline have different scrollbars\n\t\t\t\t// GS-2718: if we have resources and two verticall scrollbars for tasks timeline and resource timeline\n\t\t\t\t// we don't get the scroll state of the resource timeline\n\t\t\t\tconst scrollbarsInfo = this.$layout.getScrollbarsInfo();\n\t\t\t\tscrollbarsInfo.forEach((scroll_info) => {\n\t\t\t\t\tconst scroll = gantt.$ui.getView(scroll_info.id);\n\t\t\t\t\tconst scrollbarNodeVisible = gantt.utils.dom.isChildOf(scroll.$view, gantt.$container);\n\t\t\t\t\tscroll_info.boundViews.forEach((viewName) => {\n\t\t\t\t\t\tconst view = gantt.$ui.getView(viewName);\n\t\t\t\t\t\tif(scroll_info.y && scroll_info.y != pos.y){\n\t\t\t\t\t\t\tif(view && !scrollbarNodeVisible){\n\t\t\t\t\t\t\t\tview.scrollTo(undefined, 0);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//GS-2586: take into account the horizontal scroll of the resource timeline\n\t\t\t\t\t\tif(scroll_info.x_pos && scroll_info.x_pos != pos.x){\n\t\t\t\t\t\t\tif(view && scrollbarNodeVisible){\n\t\t\t\t\t\t\t\tview.scrollTo(scroll_info.x_pos, undefined);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\n\t\t}else{\n\t\t\tgantt.refreshData();\n\t\t}\n\t\tthis.callEvent(\"onGanttRender\", []);\n\t};\n\n\t//TODO: add layout.resize method that wouldn't trigger data repaint\n\tgantt.setSizes = gantt.render;\n\n\n\tgantt.getTaskRowNode = function(id) {\n\t\tvar els = this.$grid_data.childNodes;\n\t\tvar attribute = this.config.task_attribute;\n\t\tfor (var i = 0; i < els.length; i++) {\n\t\t\tif (els[i].getAttribute) {\n\t\t\t\tvar value = els[i].getAttribute(attribute);\n\t\t\t\tif (value == id) return els[i];\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t};\n\n\tgantt.changeLightboxType = function(type){\n\t\tif(this.getLightboxType() == type)\n\t\t\treturn true;\n\t\tgantt._silent_redraw_lightbox(type);\n\t};\n\n\tgantt._get_link_type = function (from_start, to_start) {\n\t\tvar type = null;\n\t\tif (from_start && to_start) {\n\t\t\ttype = gantt.config.links.start_to_start;\n\t\t} else if (!from_start && to_start) {\n\t\t\ttype = gantt.config.links.finish_to_start;\n\t\t} else if (!from_start && !to_start) {\n\t\t\ttype = gantt.config.links.finish_to_finish;\n\t\t} else if (from_start && !to_start) {\n\t\t\ttype = gantt.config.links.start_to_finish;\n\t\t}\n\t\treturn type;\n\t};\n\n\tgantt.isLinkAllowed = function (from, to, from_start, to_start) {\n\t\tvar link = null;\n\t\tif (typeof(from) == \"object\") {\n\t\t\tlink = from;\n\t\t} else {\n\t\t\tlink = {source: from, target: to, type: this._get_link_type(from_start, to_start)};\n\t\t}\n\n\t\tif (!link) return false;\n\t\tif (!(link.source && link.target && link.type)) return false;\n\t\tif (link.source == link.target) return false;\n\n\t\tvar res = true;\n\t\t//any custom rules\n\t\tif (this.checkEvent(\"onLinkValidation\"))\n\t\t\tres = this.callEvent(\"onLinkValidation\", [link]);\n\n\t\treturn res;\n\t};\n\n\n\tgantt._correct_dst_change = function(date, prevOffset, step, unit){\n\t\tvar time_unit = helpers.getSecondsInUnit(unit) * step;\n\t\tif(time_unit > 60*60 && time_unit < 60*60*24){\n\t\t\t//correct dst change only if current unit is more than one hour and less than day (days have own checking), e.g. 12h\n\t\t\tvar offsetChanged = date.getTimezoneOffset() - prevOffset;\n\t\t\tif(offsetChanged){\n\t\t\t\tdate = gantt.date.add(date, offsetChanged, \"minute\");\n\t\t\t}\n\t\t}\n\t\treturn date;\n\t};\n\n\tgantt.isSplitTask = function(task){\n\t\tgantt.assert(task && task instanceof Object, \"Invalid argument <b>task</b>=\"+task+\" of gantt.isSplitTask. Task object was expected\");\n\t\treturn this.$data.tasksStore._isSplitItem(task);\n\t};\n\n\tgantt._is_icon_open_click = function(e) {\n\t\tif (!e)\n\t\t\treturn false;\n\t\tvar target = e.target || e.srcElement;\n\t\tif (!(target && target.className))\n\t\t\treturn false;\n\t\tvar className = domHelpers.getClassName(target);\n\t\tif (className.indexOf(\"gantt_tree_icon\") !== -1 && (className.indexOf(\"gantt_close\") !== -1 || className.indexOf(\"gantt_open\") !== -1))\n\t\t\treturn true;\n\t\treturn false;\n\t};\n\n};","/*\n \tasserts will be removed in final code, so you can place them anythere\n\twithout caring about performance impacts\n*/\n\nexport default function(gantt){\n\treturn function assert(check, message){\n\t\tif (!check){\n\t\t\tif(gantt.config.show_errors && gantt.callEvent(\"onError\",[message]) !== false) {\n\t\t\t\tif (gantt.message) {\n\t\t\t\t\tgantt.message({type: \"error\", text: message, expire: -1});\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// eslint-disable-next-line\n\t\t\t\t\tconsole.log(message);\n\t\t\t\t}\n\n\t\t\t\t// eslint-disable-next-line no-debugger\n\t\t\t\tdebugger;\n\t\t\t}\n\t\t}\n\t};\n};","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\" \", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \" \", \" \", \" \"],\n\t\tmonth_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n\t\tday_full: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n\t\tday_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"]\n\t},\n\tlabels: {\n\t\tnew_task: \" \",\n\t\ticon_save: \"\",\n\t\ticon_cancel: \"\",\n\t\ticon_details: \"\",\n\t\ticon_edit: \"\",\n\t\ticon_delete: \"\",\n\t\tconfirm_closing: \"  ,   \", // Your changes will be lost, are your sure ?\n\t\tconfirm_deleting: \"       \",\n\t\tsection_description: \"\",\n\t\tsection_time: \" \",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"\", \"\", \"\", \"\", \"Ma\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n\t\tmonth_short: [\"\", \"\", \"\", \"\", \"Ma\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n\t\tday_full: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n\t\tday_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"]\n\t},\n\tlabels: {\n\t\tnew_task: \" \",\n\t\ticon_save: \"\",\n\t\ticon_cancel: \"\",\n\t\ticon_details: \"\",\n\t\ticon_edit: \"\",\n\t\ticon_delete: \"\",\n\t\tconfirm_closing: \"\", //    , ?\n\t\tconfirm_deleting: \"   , ?\",\n\t\tsection_description: \"\",\n\t\tsection_time: \" \",\n\t\tsection_type: \"\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"\",\n\t\tcolumn_text: \"\",\n\t\tcolumn_start_date: \"\",\n\t\tcolumn_duration: \"\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"\",\n\t\tconfirm_link_deleting: \" \",\n\t\tlink_start: \"()\",\n\t\tlink_end: \"()\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"ii\",\n\t\thours: \"i\",\n\t\tdays: \"\",\n\t\tweeks: \"\",\n\t\tmonths: \"\",\n\t\tyears: \"\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","/*\n @Traducido por Vicente Adria Bohigues - vicenteadria@hotmail.com\n */\n\nconst locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Gener\", \"Febrer\", \"Mar\", \"Abril\", \"Maig\", \"Juny\", \"Juliol\", \"Agost\", \"Setembre\", \"Octubre\", \"Novembre\", \"Desembre\"],\n\t\tmonth_short: [\"Gen\", \"Feb\", \"Mar\", \"Abr\", \"Mai\", \"Jun\", \"Jul\", \"Ago\", \"Set\", \"Oct\", \"Nov\", \"Des\"],\n\t\tday_full: [\"Diumenge\", \"Dilluns\", \"Dimarts\", \"Dimecres\", \"Dijous\", \"Divendres\", \"Dissabte\"],\n\t\tday_short: [\"Dg\", \"Dl\", \"Dm\", \"Dc\", \"Dj\", \"Dv\", \"Ds\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Nova tasca\",\n\t\ticon_save: \"Guardar\",\n\t\ticon_cancel: \"Cancellar\",\n\t\ticon_details: \"Detalls\",\n\t\ticon_edit: \"Editar\",\n\t\ticon_delete: \"Esborrar\",\n\t\tconfirm_closing: \"\", // \"Els seus canvis es perdrn, continuar ?\"\n\t\tconfirm_deleting: \"L'esdeveniment s'esborrar definitivament, continuar ?\",\n\t\tsection_description: \"Descripci\",\n\t\tsection_time: \"Periode de temps\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Cancellar\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","/*\nTranslation by FreezeSoul\n\nUpdate 26/10/2015:\nTranslation of new labels by zwh8800\n https://github.com/DHTMLX/gantt/pull/7\n\n*/\n\nconst locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n\t\tmonth_short: [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"11\", \"12\"],\n\t\tday_full: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n\t\tday_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"\",\n\t\ticon_save: \"\",\n\t\ticon_cancel: \"\",\n\t\ticon_details: \"\",\n\t\ticon_edit: \"\",\n\t\ticon_delete: \"\",\n\t\tconfirm_closing: \"!\", // Your changes will be lost, are your sure?\n\t\tconfirm_deleting: \"?\",\n\t\tsection_description: \"\",\n\t\tsection_time: \"\",\n\t\tsection_type: \"\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"\",\n\t\tcolumn_text: \"\",\n\t\tcolumn_start_date: \"\",\n\t\tcolumn_duration: \"\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\n\t\tlink: \"\",\n\t\tconfirm_link_deleting: \"\",\n\t\tlink_start: \" ()\",\n\t\tlink_end: \" ()\",\n\n\t\ttype_task: \"\",\n\t\ttype_project: \"\",\n\t\ttype_milestone: \"\",\n\n\t\tminutes: \"\",\n\t\thours: \"\",\n\t\tdays: \"\",\n\t\tweeks: \"\",\n\t\tmonths: \"\",\n\t\tyears: \"\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Leden\", \"nor\", \"Bezen\", \"Duben\", \"Kvten\", \"erven\", \"ervenec\", \"Srpen\", \"Z\", \"jen\", \"Listopad\", \"Prosinec\"],\n\t\tmonth_short: [\"Led\", \"n\", \"Be\", \"Dub\", \"Kv\", \"er\", \"ec\", \"Srp\", \"Z\", \"j\", \"List\", \"Pro\"],\n\t\tday_full: [\"Nedle\", \"Pondl\", \"ter\", \"Steda\", \"tvrtek\", \"Ptek\", \"Sobota\"],\n\t\tday_short: [\"Ne\", \"Po\", \"t\", \"St\", \"t\", \"P\", \"So\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Nov prce\",\n\t\ticon_save: \"Uloit\",\n\t\ticon_cancel: \"Zpt\",\n\t\ticon_details: \"Detail\",\n\t\ticon_edit: \"Edituj\",\n\t\ticon_delete: \"Smazat\",\n\t\tconfirm_closing: \"\", // Vae zmny budou ztraceny, opravdu ?\n\t\tconfirm_deleting: \"Udlost bude trvale smazna, opravdu?\",\n\t\tsection_description: \"Poznmky\",\n\t\tsection_time: \"Doba platnosti\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Zpt\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Januar\", \"Februar\", \"Marts\", \"April\", \"Maj\", \"Juni\", \"Juli\", \"August\", \"September\", \"Oktober\", \"November\", \"December\"],\n\t\tmonth_short: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"Maj\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Okt\", \"Nov\", \"Dec\"],\n\t\tday_full: [\"Sndag\", \"Mandag\", \"Tirsdag\", \"Onsdag\", \"Torsdag\", \"Fredag\", \"Lrdag\"],\n\t\tday_short: [\"Sn\", \"Man\", \"Tir\", \"Ons\", \"Tor\", \"Fre\", \"Lr\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Ny opgave\",\n\t\ticon_save: \"Gem\",\n\t\ticon_cancel: \"Fortryd\",\n\t\ticon_details: \"Detaljer\",\n\t\ticon_edit: \"Tilret\",\n\t\ticon_delete: \"Slet\",\n\t\tconfirm_closing: \"Dine rettelser vil g tabt.. Er dy sikker?\", // Your changes will be lost, are your sure ?\n\t\tconfirm_deleting: \"Bigivenheden vil blive slettet permanent. Er du sikker?\",\n\t\tsection_description: \"Beskrivelse\",\n\t\tsection_time: \"Tidsperiode\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Fortryd\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\" Januar\", \" Februar\", \" Mrz \", \" April\", \" Mai\", \" Juni\", \" Juli\", \" August\", \" September \", \" Oktober\", \" November \", \" Dezember\"],\n\t\tmonth_short: [\"Jan\", \"Feb\", \"Mr\", \"Apr\", \"Mai\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Okt\", \"Nov\", \"Dez\"],\n\t\tday_full: [\"Sonntag\", \"Montag\", \"Dienstag\", \" Mittwoch\", \" Donnerstag\", \"Freitag\", \"Samstag\"],\n\t\tday_short: [\"So\", \"Mo\", \"Di\", \"Mi\", \"Do\", \"Fr\", \"Sa\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Neue Aufgabe\",\n\t\ticon_save: \"Speichern\",\n\t\ticon_cancel: \"Abbrechen\",\n\t\ticon_details: \"Details\",\n\t\ticon_edit: \"ndern\",\n\t\ticon_delete: \"Lschen\",\n\t\tconfirm_closing: \"\", // \"Ihre Vernderungen werden verloren sein, wollen Sie ergnzen? \"\n\t\tconfirm_deleting: \"Der Eintrag wird gelscht\",\n\t\tsection_description: \"Beschreibung\",\n\t\tsection_time: \"Zeitspanne\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"PSP\",\n\t\tcolumn_text: \"Task-Namen\",\n\t\tcolumn_start_date: \"Startzeit\",\n\t\tcolumn_duration: \"Dauer\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"werden gelscht\",\n\t\tlink_start: \"(starten)\",\n\t\tlink_end: \"(ende)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minuten\",\n\t\thours: \"Stunden\",\n\t\tdays: \"Tage\",\n\t\tweeks: \"Wochen\",\n\t\tmonths: \"Monate\",\n\t\tyears: \"Jahre\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Abbrechen\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Regel\",\n\t\tconstraint_type: \"Regel\",\n\t\tconstraint_date: \"Regel - Datum\",\n\t\tasap: \"So bald wie mglich\",\n\t\talap: \"So spt wie mglich\",\n\t\tsnet: \"Beginn nicht vor\",\n\t\tsnlt: \"Beginn nicht spter als\",\n\t\tfnet: \"Fertigstellung nicht vor\",\n\t\tfnlt: \"Fertigstellung nicht spter als\",\n\t\tmso: \"Muss beginnen am\",\n\t\tmfo: \"Muss fertig sein am\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n\t\tmonth_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n\t\tday_full: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n\t\tday_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"]\n\t},\n\tlabels: {\n\t\tnew_task: \" \",\n\t\ticon_save: \"\",\n\t\ticon_cancel: \"\",\n\t\ticon_details: \"\",\n\t\ticon_edit: \"\",\n\t\ticon_delete: \"\",\n\t\tconfirm_closing: \"\", // Your changes will be lost, are your sure ?\n\t\tconfirm_deleting: \"    .   ;\",\n\t\tsection_description: \"\",\n\t\tsection_time: \" \",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"],\n\t\tmonth_short: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"],\n\t\tday_full: [\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"],\n\t\tday_short: [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"New task\",\n\t\ticon_save: \"Save\",\n\t\ticon_cancel: \"Cancel\",\n\t\ticon_details: \"Details\",\n\t\ticon_edit: \"Edit\",\n\t\ticon_delete: \"Delete\",\n\t\tconfirm_closing: \"\",// Your changes will be lost, are you sure?\n\t\tconfirm_deleting: \"Task will be deleted permanently, are you sure?\",\n\t\tsection_description: \"Description\",\n\t\tsection_time: \"Time period\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\n\t\t/* grid columns */\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Cancel\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\t\t\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;","/*\n @Autor Manuel Fernandez Panzuela - www.mfernandez.es\n\n Update 30/10/2015:\n Translation of new labels by Jorge Macias\n https://disqus.com/by/disqus_bTuZk1voC7/\n */\n\nconst locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Enero\", \"Febrero\", \"Marzo\", \"Abril\", \"Mayo\", \"Junio\", \"Julio\", \"Agosto\", \"Septiembre\", \"Octubre\", \"Noviembre\", \"Diciembre\"],\n\t\tmonth_short: [\"Ene\", \"Feb\", \"Mar\", \"Abr\", \"May\", \"Jun\", \"Jul\", \"Ago\", \"Sep\", \"Oct\", \"Nov\", \"Dic\"],\n\t\tday_full: [\"Domingo\", \"Lunes\", \"Martes\", \"Mircoles\", \"Jueves\", \"Viernes\", \"Sbado\"],\n\t\tday_short: [\"Dom\", \"Lun\", \"Mar\", \"Mi\", \"Jue\", \"Vie\", \"Sb\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Nueva tarea\",\n\t\ticon_save: \"Guardar\",\n\t\ticon_cancel: \"Cancelar\",\n\t\ticon_details: \"Detalles\",\n\t\ticon_edit: \"Editar\",\n\t\ticon_delete: \"Eliminar\",\n\t\tconfirm_closing: \"\", // \"Sus cambios se perdern, continuar ?\"\n\t\tconfirm_deleting: \"El evento se borrar definitivamente, continuar?\",\n\t\tsection_description: \"Descripcin\",\n\t\tsection_time: \"Perodo\",\n\t\tsection_type: \"Tipo\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"EDT\",\n\t\tcolumn_text: \"Tarea\",\n\t\tcolumn_start_date: \"Inicio\",\n\t\tcolumn_duration: \"Duracin\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Enlace\",\n\t\tconfirm_link_deleting: \"ser borrada\",\n\t\tlink_start: \" (inicio)\",\n\t\tlink_end: \" (fin)\",\n\n\t\ttype_task: \"Tarea\",\n\t\ttype_project: \"Proyecto\",\n\t\ttype_milestone: \"Hito\",\n\n\n\t\tminutes: \"Minutos\",\n\t\thours: \"Horas\",\n\t\tdays: \"Das\",\n\t\tweeks: \"Semanas\",\n\t\tmonths: \"Meses\",\n\t\tyears: \"Aos\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Cancelar\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","/*\n dhtmlxGantt Persian (Farsi, fa_IR) locale by Mohammad Shokri http://slashsbin.com/\n */\n\nconst locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\n\t\t\t\"\",\n\t\t\t\"\",\n\t\t\t\"\",\n\t\t\t\"\",\n\t\t\t\"\",\n\t\t\t\"\",\n\t\t\t\"\",\n\t\t\t\"\",\n\t\t\t\"\",\n\t\t\t\"\",\n\t\t\t\"\",\n\t\t\t\"\"\n\t\t],\n\t\tmonth_short: [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"11\", \"12\"],\n\t\tday_full: [\n\t\t\t\"\",\n\t\t\t\"\",\n\t\t\t\"\",\n\t\t\t\"\",\n\t\t\t\"\",\n\t\t\t\"\",\n\t\t\t\"\"\n\t\t],\n\t\tday_short: [\n\t\t\t\"\",\n\t\t\t\"\",\n\t\t\t\"\",\n\t\t\t\"\",\n\t\t\t\"\",\n\t\t\t\"\",\n\t\t\t\"\"\n\t\t]\n\t},\n\tlabels: {\n\t\tnew_task: \" \",\n\t\ticon_save: \"\",\n\t\ticon_cancel: \"\",\n\t\ticon_details: \"\",\n\t\ticon_edit: \"\",\n\t\ticon_delete: \"\",\n\t\tconfirm_closing: \"       \",\n\t\tconfirm_deleting: \"         \",\n\t\tsection_description: \"\",\n\t\tsection_time: \" \",\n\t\tsection_type: \"\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"\",\n\t\tcolumn_start_date: \" \",\n\t\tcolumn_duration: \"\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"\",\n\t\tconfirm_link_deleting: \"  \",\n\t\tlink_start: \" ()\",\n\t\tlink_end: \" ()\",\n\n\t\ttype_task: \"\",\n\t\ttype_project: \"\",\n\t\ttype_milestone: \"\",\n\n\t\tminutes: \"\",\n\t\thours: \"\",\n\t\tdays: \"\",\n\t\tweeks: \"\",\n\t\tmonths: \"\",\n\t\tyears: \"\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"\",\n\t\tmessage_cancel: \"\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Tammikuu\", \"Helmikuu\", \"Maaliskuu\", \"Huhtikuu\", \"Toukokuu\", \"Kes&auml;kuu\", \"Hein&auml;kuu\", \"Elokuu\", \"Syyskuu\", \"Lokakuu\", \"Marraskuu\", \"Joulukuu\"],\n\t\tmonth_short: [\"Tam\", \"Hel\", \"Maa\", \"Huh\", \"Tou\", \"Kes\", \"Hei\", \"Elo\", \"Syy\", \"Lok\", \"Mar\", \"Jou\"],\n\t\tday_full: [\"Sunnuntai\", \"Maanantai\", \"Tiistai\", \"Keskiviikko\", \"Torstai\", \"Perjantai\", \"Lauantai\"],\n\t\tday_short: [\"Su\", \"Ma\", \"Ti\", \"Ke\", \"To\", \"Pe\", \"La\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Uusi tehtv\",\n\t\ticon_save: \"Tallenna\",\n\t\ticon_cancel: \"Peru\",\n\t\ticon_details: \"Tiedot\",\n\t\ticon_edit: \"Muokkaa\",\n\t\ticon_delete: \"Poista\",\n\t\tconfirm_closing: \"\", // Your changes will be lost, are your sure ?\n\t\tconfirm_deleting: \"Haluatko varmasti poistaa tapahtuman?\",\n\t\tsection_description: \"Kuvaus\",\n\t\tsection_time: \"Aikajakso\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Peru\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Janvier\", \"Fvrier\", \"Mars\", \"Avril\", \"Mai\", \"Juin\", \"Juillet\", \"Aot\", \"Septembre\", \"Octobre\", \"Novembre\", \"Dcembre\"],\n\t\tmonth_short: [\"Jan\", \"Fv\", \"Mar\", \"Avr\", \"Mai\", \"Juin\", \"Juil\", \"Ao\", \"Sep\", \"Oct\", \"Nov\", \"Dc\"],\n\t\tday_full: [\"Dimanche\", \"Lundi\", \"Mardi\", \"Mercredi\", \"Jeudi\", \"Vendredi\", \"Samedi\"],\n\t\tday_short: [\"Dim\", \"Lun\", \"Mar\", \"Mer\", \"Jeu\", \"Ven\", \"Sam\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Nouvelle tche\",\n\t\ticon_save: \"Enregistrer\",\n\t\ticon_cancel: \"Annuler\",\n\t\ticon_details: \"Dtails\",\n\t\ticon_edit: \"Modifier\",\n\t\ticon_delete: \"Effacer\",\n\t\tconfirm_closing: \"\",// Vos modifications seront perdus, tes-vous sr ?\n\t\tconfirm_deleting: \"L'vnement sera effac sans appel, tes-vous sr ?\",\n\n\t\tsection_description: \"Description\",\n\t\tsection_time: \"Priode\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"OTP\",\n\t\tcolumn_text: \"Nom de la tche\",\n\t\tcolumn_start_date: \"Date initiale\",\n\t\tcolumn_duration: \"Dure\",\n\t\tcolumn_add: \"\",\n\n\n\t\t/* link confirmation */\n\t\tlink: \"Le lien\",\n\t\tconfirm_link_deleting: \"sera supprim\",\n\t\tlink_start: \"(dbut)\",\n\t\tlink_end: \"(fin)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Heures\",\n\t\tdays: \"Jours\",\n\t\tweeks: \"Semaines\",\n\t\tmonths: \"Mois\",\n\t\tyears: \"Annes\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Annuler\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n\t\tmonth_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n\t\tday_full: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n\t\tday_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"]\n\t},\n\tlabels: {\n\t\tnew_task: \" \",\n\t\ticon_save: \"\",\n\t\ticon_cancel: \"\",\n\t\ticon_details: \"\",\n\t\ticon_edit: \"\",\n\t\ticon_delete: \"\",\n\t\tconfirm_closing: \"\", // Your changes will be lost, are your sure ?\n\t\tconfirm_deleting: \"  .?\",\n\t\tsection_description: \"\",\n\t\tsection_time: \"\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","/*\n  Translation by Davor\n http://docs.dhtmlx.com/gantt/desktop__localization.html#comment-2569116291\n */\n\nconst locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Sijeanj\", \"Veljaa\", \"Oujak\", \"Travanj\", \"Svibanj\", \"Lipanj\", \"Srpanj\", \"Kolovoz\", \"Rujan\", \"Listopad\", \"Studeni\", \"Prosinac\"],\n\t\tmonth_short: [\"Sij\", \"Velj\", \"Ou\", \"Tra\", \"Svi\", \"Lip\", \"Srp\", \"Kol\", \"Ruj\", \"Lis\", \"Stu\", \"Pro\"],\n\t\tday_full: [\"Nedjelja\", \"Ponedjeljak\", \"Utorak\", \"Srijeda\", \"etvrtak\", \"Petak\", \"Subota\"],\n\t\tday_short: [\"Ned\", \"Pon\", \"Uto\", \"Sri\", \"et\", \"Pet\", \"Sub\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Novi Zadatak\",\n\t\ticon_save: \"Spremi\",\n\t\ticon_cancel: \"Odustani\",\n\t\ticon_details: \"Detalji\",\n\t\ticon_edit: \"Izmjeni\",\n\t\ticon_delete: \"Obrii\",\n\t\tconfirm_closing: \"\",\n\t\tconfirm_deleting: \"Zadatak e biti trajno izbrisan, jeste li sigurni?\",\n\t\tsection_description: \"Opis\",\n\t\tsection_time: \"Vremenski Period\",\n\t\tsection_type: \"Tip\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\n\t\t/* grid columns */\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Naziv Zadatka\",\n\t\tcolumn_start_date: \"Poetno Vrijeme\",\n\t\tcolumn_duration: \"Trajanje\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Poveznica\",\n\t\tconfirm_link_deleting: \"e biti izbrisan\",\n\t\tlink_start: \" (poetak)\",\n\t\tlink_end: \" (kraj)\",\n\n\t\ttype_task: \"Zadatak\",\n\t\ttype_project: \"Projekt\",\n\t\ttype_milestone: \"Milestone\",\n\n\t\tminutes: \"Minute\",\n\t\thours: \"Sati\",\n\t\tdays: \"Dani\",\n\t\tweeks: \"Tjedni\",\n\t\tmonths: \"Mjeseci\",\n\t\tyears: \"Godine\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Odustani\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Janur\", \"Februr\", \"Mrcius\", \"prilis\", \"Mjus\", \"Jnius\", \"Jlius\", \"Augusztus\", \"Szeptember\", \"Oktber\", \"November\", \"December\"],\n\t\tmonth_short: [\"Jan\", \"Feb\", \"Mr\", \"pr\", \"Mj\", \"Jn\", \"Jl\", \"Aug\", \"Sep\", \"Okt\", \"Nov\", \"Dec\"],\n\t\tday_full: [\"Vasrnap\", \"Htf\", \"Kedd\", \"Szerda\", \"Cstrtk\", \"Pntek\", \"szombat\"],\n\t\tday_short: [\"Va\", \"H\", \"Ke\", \"Sze\", \"Cs\", \"P\", \"Szo\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"j feladat\",\n\t\ticon_save: \"Ments\",\n\t\ticon_cancel: \"Mgse\",\n\t\ticon_details: \"Rszletek\",\n\t\ticon_edit: \"Szerkeszts\",\n\t\ticon_delete: \"Trls\",\n\t\tconfirm_closing: \"\", // A vltozsok elvesznek, biztosan folytatja? \"\n\t\tconfirm_deleting: \"Az esemny trlve lesz, biztosan folytatja?\",\n\t\tsection_description: \"Lers\",\n\t\tsection_time: \"Idszak\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Mgse\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Januari\", \"Februari\", \"Maret\", \"April\", \"Mei\", \"Juni\", \"Juli\", \"Agustus\", \"September\", \"Oktober\", \"November\", \"Desember\"],\n\t\tmonth_short: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"Mei\", \"Jun\", \"Jul\", \"Ags\", \"Sep\", \"Okt\", \"Nov\", \"Des\"],\n\t\tday_full: [\"Minggu\", \"Senin\", \"Selasa\", \"Rabu\", \"Kamis\", \"Jumat\", \"Sabtu\"],\n\t\tday_short: [\"Ming\", \"Sen\", \"Sel\", \"Rab\", \"Kam\", \"Jum\", \"Sab\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Tugas baru\",\n\t\ticon_save: \"Simpan\",\n\t\ticon_cancel: \"Batal\",\n\t\ticon_details: \"Detail\",\n\t\ticon_edit: \"Edit\",\n\t\ticon_delete: \"Hapus\",\n\t\tconfirm_closing: \"\", /* Perubahan tidak akan disimpan ? */\n\t\tconfirm_deleting: \"Acara akan dihapus\",\n\t\tsection_description: \"Keterangan\",\n\t\tsection_time: \"Periode\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Batal\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","/*\n Update 29/12/2015:\n New labels translation by ARCANGELI CLAUDIO\n\n */\n\nconst locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Gennaio\", \"Febbraio\", \"Marzo\", \"Aprile\", \"Maggio\", \"Giugno\", \"Luglio\", \"Agosto\", \"Settembre\", \"Ottobre\", \"Novembre\", \"Dicembre\"],\n\t\tmonth_short: [\"Gen\", \"Feb\", \"Mar\", \"Apr\", \"Mag\", \"Giu\", \"Lug\", \"Ago\", \"Set\", \"Ott\", \"Nov\", \"Dic\"],\n\t\tday_full: [\"Domenica\", \"Luned\", \"Marted\", \"Mercoled\", \"Gioved\", \"Venerd\", \"Sabato\"],\n\t\tday_short: [\"Dom\", \"Lun\", \"Mar\", \"Mer\", \"Gio\", \"Ven\", \"Sab\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Nuovo compito\",\n\t\ticon_save: \"Salva\",\n\t\ticon_cancel: \"Chiudi\",\n\t\ticon_details: \"Dettagli\",\n\t\ticon_edit: \"Modifica\",\n\t\ticon_delete: \"Elimina\",\n\t\tconfirm_closing: \"\",// \"Sei sicuro di confermare la chiusura?\",\n\t\tconfirm_deleting: \"Sei sicuro di confermare l'eliminazione?\",\n\t\tsection_description: \"Descrizione\",\n\t\tsection_time: \"Periodo di tempo\",\n\t\tsection_type: \"Tipo\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Nome Attivit\",\n\t\tcolumn_start_date: \"Inizio\",\n\t\tcolumn_duration: \"Durata\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"sar eliminato\",\n\t\tlink_start: \" (inizio)\",\n\t\tlink_end: \" (fine)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minuti\",\n\t\thours: \"Ore\",\n\t\tdays: \"Giorni\",\n\t\tweeks: \"Settimane\",\n\t\tmonths: \"Mesi\",\n\t\tyears: \"Anni\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Chiudi\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","/*\n Translation by Genexus Japan Inc.\n */\n\nconst locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"11\", \"12\"],\n\t\tmonth_short: [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"11\", \"12\"],\n\t\tday_full: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n\t\tday_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"\",\n\t\ticon_save: \"\",\n\t\ticon_cancel: \"\",\n\t\ticon_details: \"\",\n\t\ticon_edit: \"\",\n\t\ticon_delete: \"\",\n\t\tconfirm_closing: \"\", // \n\t\tconfirm_deleting: \"\",\n\t\tsection_description: \"\",\n\t\tsection_time: \"\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","/*\n\tTranslated by cjkim@dbvalley.com\n*/\n\nconst locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"11\", \"12\"],\n\t\tmonth_short: [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"11\", \"12\"],\n\t\tday_full: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n\t\tday_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"]\n\t},\n\tlabels: {\n\t\tnew_task: \" \",\n\t\ticon_save: \"\",\n\t\ticon_cancel: \"\",\n\t\ticon_details: \" \",\n\t\ticon_edit: \"\",\n\t\ticon_delete: \"\",\n\t\tconfirm_closing: \"\",\n\t\tconfirm_deleting: \" ?\",\n\t\tsection_description: \"\",\n\t\tsection_time: \"\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"\",\n\t\tcolumn_start_date: \"\",\n\t\tcolumn_duration: \"\",\n\t\tcolumn_add: \"\",\n\t\tlink: \"\",\n\t\tconfirm_link_deleting: \" ?\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\t\ttype_task: \"\",\n\t\ttype_project: \"\",\n\t\ttype_milestone: \"\",\n\t\tminutes: \"\",\n\t\thours: \"\",\n\t\tdays: \"\",\n\t\tweeks: \"\",\n\t\tmonths: \"\",\n\t\tyears: \"\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","export default class LocaleManager{\n\tprivate _locales:{[key:string]: IGanttLocale };\n\n\tconstructor(config: {[key:string]: IGanttLocale }){\n\t\tthis._locales = {};\n\t\tfor(const i in config){\n\t\t\tthis._locales[i] = config[i];\n\t\t}\n\t}\n\n\taddLocale = (name: string, locale: IGanttLocale) => {\n\t\tthis._locales[name] = locale;\n\t};\n\n\tgetLocale = (name: string): IGanttLocale => {\n\t\treturn this._locales[name];\n\t};\n}","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Januar\", \"Februar\", \"Mars\", \"April\", \"Mai\", \"Juni\", \"Juli\", \"August\", \"September\", \"Oktober\", \"November\", \"Desember\"],\n\t\tmonth_short: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"Mai\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Okt\", \"Nov\", \"Des\"],\n\t\tday_full: [\"Sndag\", \"Mandag\", \"Tirsdag\", \"Onsdag\", \"Torsdag\", \"Fredag\", \"Lrdag\"],\n\t\tday_short: [\"Sn\", \"Mon\", \"Tir\", \"Ons\", \"Tor\", \"Fre\", \"Lr\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Ny oppgave\",\n\t\ticon_save: \"Lagre\",\n\t\ticon_cancel: \"Avbryt\",\n\t\ticon_details: \"Detaljer\",\n\t\ticon_edit: \"Rediger\",\n\t\ticon_delete: \"Slett\",\n\t\tconfirm_closing: \"\", // Your changes will be lost, are your sure ?\n\t\tconfirm_deleting: \"Hendelsen vil bli slettet permanent. Er du sikker?\",\n\t\tsection_description: \"Beskrivelse\",\n\t\tsection_time: \"Tidsperiode\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Avbryt\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Januari\", \"Februari\", \"Maart\", \"April\", \"Mei\", \"Juni\", \"Juli\", \"Augustus\", \"September\", \"Oktober\", \"November\", \"December\"],\n\t\tmonth_short: [\"Jan\", \"Feb\", \"mrt\", \"Apr\", \"Mei\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Okt\", \"Nov\", \"Dec\"],\n\t\tday_full: [\"Zondag\", \"Maandag\", \"Dinsdag\", \"Woensdag\", \"Donderdag\", \"Vrijdag\", \"Zaterdag\"],\n\t\tday_short: [\"Zo\", \"Ma\", \"Di\", \"Wo\", \"Do\", \"Vr\", \"Za\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Nieuwe taak\",\n\t\ticon_save: \"Opslaan\",\n\t\ticon_cancel: \"Annuleren\",\n\t\ticon_details: \"Details\",\n\t\ticon_edit: \"Bewerken\",\n\t\ticon_delete: \"Verwijderen\",\n\t\tconfirm_closing: \"\", // Your changes will be lost, are your sure ?\n\t\tconfirm_deleting: \"Item zal permanent worden verwijderd, doorgaan?\",\n\t\tsection_description: \"Beschrijving\",\n\t\tsection_time: \"Tijd periode\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Taak omschrijving\",\n\t\tcolumn_start_date: \"Startdatum\",\n\t\tcolumn_duration: \"Duur\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Koppeling\",\n\t\tconfirm_link_deleting: \"zal worden verwijderd\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (eind)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"minuten\",\n\t\thours: \"uren\",\n\t\tdays: \"dagen\",\n\t\tweeks: \"weken\",\n\t\tmonths: \"maanden\",\n\t\tyears: \"jaren\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Annuleren\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Januar\", \"Februar\", \"Mars\", \"April\", \"Mai\", \"Juni\", \"Juli\", \"August\", \"September\", \"Oktober\", \"November\", \"Desember\"],\n\t\tmonth_short: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"Mai\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Okt\", \"Nov\", \"Des\"],\n\t\tday_full: [\"Sndag\", \"Mandag\", \"Tirsdag\", \"Onsdag\", \"Torsdag\", \"Fredag\", \"Lrdag\"],\n\t\tday_short: [\"Sn\", \"Man\", \"Tir\", \"Ons\", \"Tor\", \"Fre\", \"Lr\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Ny oppgave\",\n\t\ticon_save: \"Lagre\",\n\t\ticon_cancel: \"Avbryt\",\n\t\ticon_details: \"Detaljer\",\n\t\ticon_edit: \"Endre\",\n\t\ticon_delete: \"Slett\",\n\t\tconfirm_closing: \"Endringer blir ikke lagret, er du sikker?\", // Endringer blir ikke lagret, er du sikker?\n\t\tconfirm_deleting: \"Oppfringen vil bli slettet, er du sikker?\",\n\t\tsection_description: \"Beskrivelse\",\n\t\tsection_time: \"Tidsperiode\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Avbryt\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Stycze\", \"Luty\", \"Marzec\", \"Kwiecie\", \"Maj\", \"Czerwiec\", \"Lipiec\", \"Sierpie\", \"Wrzesie\", \"Padziernik\", \"Listopad\", \"Grudzie\"],\n\t\tmonth_short: [\"Sty\", \"Lut\", \"Mar\", \"Kwi\", \"Maj\", \"Cze\", \"Lip\", \"Sie\", \"Wrz\", \"Pa\", \"Lis\", \"Gru\"],\n\t\tday_full: [\"Niedziela\", \"Poniedziaek\", \"Wtorek\", \"roda\", \"Czwartek\", \"Pitek\", \"Sobota\"],\n\t\tday_short: [\"Nie\", \"Pon\", \"Wto\", \"ro\", \"Czw\", \"Pi\", \"Sob\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Nowe zadanie\",\n\t\ticon_save: \"Zapisz\",\n\t\ticon_cancel: \"Anuluj\",\n\t\ticon_details: \"Szczegy\",\n\t\ticon_edit: \"Edytuj\",\n\t\ticon_delete: \"Usu\",\n\t\tconfirm_closing: \"\", // Zmiany zostan usunite, jeste pewien?\n\t\tconfirm_deleting: \"Zdarzenie zostanie usunite na zawsze, kontynuowa?\",\n\t\tsection_description: \"Opis\",\n\t\tsection_time: \"Okres czasu\",\n\t\tsection_type: \"Typ\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Nazwa zadania\",\n\t\tcolumn_start_date: \"Pocztek\",\n\t\tcolumn_duration: \"Czas trwania\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"zostanie usunity\",\n\t\tlink_start: \" (pocztek)\",\n\t\tlink_end: \" (koniec)\",\n\n\t\ttype_task: \"Zadanie\",\n\t\ttype_project: \"Projekt\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minuty\",\n\t\thours: \"Godziny\",\n\t\tdays: \"Dni\",\n\t\tweeks: \"Tydzie\",\n\t\tmonths: \"Miesice\",\n\t\tyears: \"Lata\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Anuluj\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","/*\n\n TRANSLATION BY MATTHEUS PIROVANI RORIZ GONALVES\n\n mattheusroriz@hotmail.com / mattheus.pirovani@gmail.com /\n\n www.atrixian.com.br\n\n\n Updated by Jorge Albernaz Martins\n\n jorgefox@hotmail.com\n\n www.redfox.inf.br\n\n JorgeFox\n\n*/\n\nconst locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Janeiro\", \"Fevereiro\", \"Maro\", \"Abril\", \"Maio\", \"Junho\", \"Julho\", \"Agosto\", \"Setembro\", \"Outubro\", \"Novembro\", \"Dezembro\"],\n\t\tmonth_short: [\"Jan\", \"Fev\", \"Mar\", \"Abr\", \"Mai\", \"Jun\", \"Jul\", \"Ago\", \"Set\", \"Out\", \"Nov\", \"Dez\"],\n\t\tday_full: [\"Domingo\", \"Segunda\", \"Tera\", \"Quarta\", \"Quinta\", \"Sexta\", \"Sbado\"],\n\t\tday_short: [\"Dom\", \"Seg\", \"Ter\", \"Qua\", \"Qui\", \"Sex\", \"Sab\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Nova tarefa\",\n\t\ticon_save: \"Salvar\",\n\t\ticon_cancel: \"Cancelar\",\n\t\ticon_details: \"Detalhes\",\n\t\ticon_edit: \"Editar\",\n\t\ticon_delete: \"Excluir\",\n\t\tconfirm_closing: \"\",// Suas alteraes sero perdidas, confirme?\n\t\tconfirm_deleting: \"As tarefas sero excluidas permanentemente, confirme?\",\n\t\tsection_description: \"Descrio\",\n\t\tsection_time: \"Perodo\",\n\t\tsection_type: \"Tipo\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"EAP\",\n\t\tcolumn_text: \"Nome tarefa\",\n\t\tcolumn_start_date: \"Data incio\",\n\t\tcolumn_duration: \"Durao\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"Ser excludo!\",\n\t\tlink_start: \" (incio)\",\n\t\tlink_end: \" (fim)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Projeto\",\n\t\ttype_milestone: \"Marco\",\n\n\n\t\tminutes: \"Minutos\",\n\t\thours: \"Horas\",\n\t\tdays: \"Dias\",\n\t\tweeks: \"Semanas\",\n\t\tmonths: \"Meses\",\n\t\tyears: \"Anos\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Cancelar\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Restrio\",\n\t\tconstraint_type: \"Tipo Restrio\",\n\t\tconstraint_date: \"Data restrio\",\n\t\tasap: \"Mais breve possvel\",\n\t\talap: \"Mais tarde possvel\",\n\t\tsnet: \"No comear antes de\",\n\t\tsnlt: \"No comear depois de\",\n\t\tfnet: \"No terminar antes de\",\n\t\tfnlt: \"No terminar depois de\",\n\t\tmso: \"Precisa comear em\",\n\t\tmfo: \"Precisa terminar em\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","/*\n\tTraducere de Ovidiu Lixandru: http://www.madball.ro\n */\n\nconst locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Ianuarie\", \"Februarie\", \"Martie\", \"Aprilie\", \"Mai\", \"Iunie\", \"Iulie\", \"August\", \"Septembrie\", \"Octombrie\", \"November\", \"December\"],\n\t\tmonth_short: [\"Ian\", \"Feb\", \"Mar\", \"Apr\", \"Mai\", \"Iun\", \"Iul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"],\n\t\tday_full: [\"Duminica\", \"Luni\", \"Marti\", \"Miercuri\", \"Joi\", \"Vineri\", \"Sambata\"],\n\t\tday_short: [\"Du\", \"Lu\", \"Ma\", \"Mi\", \"Jo\", \"Vi\", \"Sa\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Sarcina noua\",\n\t\ticon_save: \"Salveaza\",\n\t\ticon_cancel: \"Anuleaza\",\n\t\ticon_details: \"Detalii\",\n\t\ticon_edit: \"Editeaza\",\n\t\ticon_delete: \"Sterge\",\n\t\tconfirm_closing: \"Schimbarile nu vor fi salvate, esti sigur?\",// Your changes will be lost, are your sure ?\n\t\tconfirm_deleting: \"Evenimentul va fi sters permanent, esti sigur?\",\n\t\tsection_description: \"Descriere\",\n\t\tsection_time: \"Interval\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Anuleaza\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"\", \"\", \"\", \"\", \"Ma\", \"\", \"\", \"\", \"\", \"O\", \"\", \"\"],\n\t\tmonth_short: [\"\", \"\", \"Ma\", \"A\", \"Ma\", \"\", \"\", \"A\", \"\", \"\", \"\", \"\"],\n\t\tday_full: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n\t\tday_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"]\n\t},\n\tlabels: {\n\t\tnew_task: \" \",\n\t\ticon_save: \"\",\n\t\ticon_cancel: \"\",\n\t\ticon_details: \"\",\n\t\ticon_edit: \"\",\n\t\ticon_delete: \"\",\n\t\tconfirm_closing: \"\", //    , ?\n\t\tconfirm_deleting: \"   , ?\",\n\t\tsection_description: \"\",\n\t\tsection_time: \" \",\n\t\tsection_type: \"\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"\",\n\t\tcolumn_text: \"\",\n\t\tcolumn_start_date: \"\",\n\t\tcolumn_duration: \"\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"\",\n\t\tconfirm_link_deleting: \" \",\n\t\tlink_start: \" ()\",\n\t\tlink_end: \" ()\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"\",\n\t\thours: \"\",\n\t\tdays: \"\",\n\t\tweeks: \"\",\n\t\tmonths: \"\",\n\t\tyears: \"\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Januar\", \"Februar\", \"Marec\", \"April\", \"Maj\", \"Junij\", \"Julij\", \"Avgust\", \"September\", \"Oktober\", \"November\", \"December\"],\n\t\tmonth_short: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"Maj\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Okt\", \"Nov\", \"Dec\"],\n\t\tday_full: [\"Nedelja\", \"Ponedeljek\", \"Torek\", \"Sreda\", \"etrtek\", \"Petek\", \"Sobota\"],\n\t\tday_short: [\"Ned\", \"Pon\", \"Tor\", \"Sre\", \"et\", \"Pet\", \"Sob\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Nova naloga\",\n\t\ticon_save: \"Shrani\",\n\t\ticon_cancel: \"Preklii\",\n\t\ticon_details: \"Podrobnosti\",\n\t\ticon_edit: \"Uredi\",\n\t\ticon_delete: \"Izbrii\",\n\t\tconfirm_closing: \"\", // Spremembe ne bodo shranjene. elite nadaljevati ?\n\t\tconfirm_deleting: \"Dogodek bo izbrisan. elite nadaljevati?\",\n\t\tsection_description: \"Opis\",\n\t\tsection_time: \"asovni okvir\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Preklii\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Janur\", \"Februr\", \"Marec\", \"Aprl\", \"Mj\", \"Jn\", \"Jl\", \"August\", \"September\", \"Oktber\", \"November\", \"December\"],\n\t\tmonth_short: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"Mj\", \"Jn\", \"Jl\", \"Aug\", \"Sept\", \"Okt\", \"Nov\", \"Dec\"],\n\t\tday_full: [\"Nedea\", \"Pondelok\", \"Utorok\", \"Streda\", \"tvrtok\", \"Piatok\", \"Sobota\"],\n\t\tday_short: [\"Ne\", \"Po\", \"Ut\", \"St\", \"t\", \"Pi\", \"So\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Nov loha\",\n\t\ticon_save: \"Uloi\",\n\t\ticon_cancel: \"Sp\",\n\t\ticon_details: \"Detail\",\n\t\ticon_edit: \"Edituj\",\n\t\ticon_delete: \"Zmaza\",\n\t\tconfirm_closing: \"Vae zmeny nebud uloen. Skutone?\", // Vae zmny budou ztraceny, opravdu ?\n\t\tconfirm_deleting: \"Udalos bude natrvalo vymazan. Skutone?\",\n\t\tsection_description: \"Poznmky\",\n\t\tsection_time: \"Doba platnosti\",\n\t\tsection_type: \"Type\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Sp\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","/*\n\tTranslation by Peter Eriksson\n */\nconst locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Januari\", \"Februari\", \"Mars\", \"April\", \"Maj\", \"Juni\", \"Juli\", \"Augusti\", \"September\", \"Oktober\", \"November\", \"December\"],\n\t\tmonth_short: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"Maj\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Okt\", \"Nov\", \"Dec\"],\n\t\tday_full: [\"Sndag\", \"Mndag\", \"Tisdag\", \"Onsdag\", \"Torsdag\", \"Fredag\", \"Lrdag\"],\n\t\tday_short: [\"Sn\", \"Mn\", \"Tis\", \"Ons\", \"Tor\", \"Fre\", \"Lr\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Ny uppgift\",\n\t\ticon_save: \"Spara\",\n\t\ticon_cancel: \"Avbryt\",\n\t\ticon_details: \"Detajer\",\n\t\ticon_edit: \"ndra\",\n\t\ticon_delete: \"Ta bort\",\n\t\tconfirm_closing: \"\",\n\t\tconfirm_deleting: \"r du sker p att du vill ta bort hndelsen permanent?\",\n\t\tsection_description: \"Beskrivning\",\n\t\tsection_time: \"Tid\",\n\t\tsection_type: \"Typ\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Uppgiftsnamn\",\n\t\tcolumn_start_date: \"Starttid\",\n\t\tcolumn_duration: \"Varaktighet\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\n\t\tlink: \"Lnk\",\n\t\tconfirm_link_deleting: \"kommer tas bort\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (slut)\",\n\t\ttype_task: \"Uppgift\",\n\t\ttype_project: \"Projekt\",\n\t\ttype_milestone: \"Milstolpe\",\n\n\t\tminutes: \"Minuter\",\n\t\thours: \"Timmar\",\n\t\tdays: \"Dagar\",\n\t\tweeks: \"Veckor\",\n\t\tmonths: \"Mnader\",\n\t\tyears: \"r\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"Avbryt\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","/*\n * updated by @levkar at https://github.com/DHTMLX/gantt/pull/10\n */\nconst locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"Ocak\", \"ubat\", \"Mart\", \"Nisan\", \"Mays\", \"Haziran\", \"Temmuz\", \"Austos\", \"Eyll\", \"Ekim\", \"Kasm\", \"Aralk\"],\n\t\tmonth_short: [\"Oca\", \"ub\", \"Mar\", \"Nis\", \"May\", \"Haz\", \"Tem\", \"Au\", \"Eyl\", \"Eki\", \"Kas\", \"Ara\"],\n\t\tday_full: [\"Pazar\", \"Pazartesi\", \"Sal\", \"aramba\", \"Perembe\", \"Cuma\", \"Cumartesi\"],\n\t\tday_short: [\"Paz\", \"Pzt\", \"Sal\", \"ar\", \"Per\", \"Cum\", \"Cmt\"]\n\t},\n\tlabels: {\n\t\tnew_task: \"Yeni grev\",\n\t\ticon_save: \"Kaydet\",\n\t\ticon_cancel: \"ptal\",\n\t\ticon_details: \"Detaylar\",\n\t\ticon_edit: \"Dzenle\",\n\t\ticon_delete: \"Sil\",\n\t\tconfirm_closing: \"\", // Your changes will be lost, are your sure ?\n\t\tconfirm_deleting: \"Grev silinecek, emin misiniz?\",\n\t\tsection_description: \"Aklama\",\n\t\tsection_time: \"Zaman Aral\",\n\t\tsection_type: \"Tip\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Grev Ad\",\n\t\tcolumn_start_date: \"Balang\",\n\t\tcolumn_duration: \"Sre\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Balant\",\n\t\tconfirm_link_deleting: \"silinecek\",\n\t\tlink_start: \" (balang)\",\n\t\tlink_end: \" (biti)\",\n\n\t\ttype_task: \"Grev\",\n\t\ttype_project: \"Proje\",\n\t\ttype_milestone: \"Kilometreta\",\n\n\n\t\tminutes: \"Dakika\",\n\t\thours: \"Saat\",\n\t\tdays: \"Gn\",\n\t\tweeks: \"Hafta\",\n\t\tmonths: \"Ay\",\n\t\tyears: \"Yl\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"ptal\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","const locale: IGanttLocale = {\n\tdate: {\n\t\tmonth_full: [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n\t\tmonth_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\", \"\"],\n\t\tday_full: [\"\", \"\", \"\", \"\", \"\", \"'\", \"\"],\n\t\tday_short: [\"\", \"\", \"\", \"\", \"\", \"\", \"\"]\n\t},\n\tlabels: {\n\t\tnew_task: \" \",\n\t\ticon_save: \"\",\n\t\ticon_cancel: \"\",\n\t\ticon_details: \"\",\n\t\ticon_edit: \"\",\n\t\ticon_delete: \"\",\n\t\tconfirm_closing: \"\", //   .   ?\n\t\tconfirm_deleting: \"  .  ?\",\n\t\tsection_description: \"\",\n\t\tsection_time: \" \",\n\t\tsection_type: \"\",\n\t\tsection_deadline: \"Deadline\",\n\t\tsection_baselines: \"Baselines\",\n\t\tsection_new_resources: \"Resources\",\n\t\t/* grid columns */\n\n\t\tcolumn_wbs: \"WBS\",\n\t\tcolumn_text: \"Task name\",\n\t\tcolumn_start_date: \"Start time\",\n\t\tcolumn_duration: \"Duration\",\n\t\tcolumn_add: \"\",\n\n\t\t/* link confirmation */\n\t\tlink: \"Link\",\n\t\tconfirm_link_deleting: \"will be deleted\",\n\t\tlink_start: \" (start)\",\n\t\tlink_end: \" (end)\",\n\n\t\ttype_task: \"Task\",\n\t\ttype_project: \"Project\",\n\t\ttype_milestone: \"Milestone\",\n\n\n\t\tminutes: \"Minutes\",\n\t\thours: \"Hours\",\n\t\tdays: \"Days\",\n\t\tweeks: \"Week\",\n\t\tmonths: \"Months\",\n\t\tyears: \"Years\",\n\n\t\t/* message popup */\n\t\tmessage_ok: \"OK\",\n\t\tmessage_cancel: \"\",\n\n\t\t/* constraints */\n\t\tsection_constraint: \"Constraint\",\n\t\tconstraint_type: \"Constraint type\",\n\t\tconstraint_date: \"Constraint date\",\n\t\tasap: \"As Soon As Possible\",\n\t\talap: \"As Late As Possible\",\n\t\tsnet: \"Start No Earlier Than\",\n\t\tsnlt: \"Start No Later Than\",\n\t\tfnet: \"Finish No Earlier Than\",\n\t\tfnlt: \"Finish No Later Than\",\n\t\tmso: \"Must Start On\",\n\t\tmfo: \"Must Finish On\",\n\n\t\t/* resource control */\n\t\tresources_add_button: \"Add Assignment\",\n\t\tresources_filter_placeholder: \"Search...\",\n\t\tresources_filter_label: \"hide empty\",\n\t\tresources_section_placeholder: \"Nothing assigned yet. Click 'Add Assignment' to assign resources.\",\n\n\t\t/* empty state screen */\n\t\tempty_state_text_link: \"Click here\",\n\t\tempty_state_text_description: \"to create your first task\",\n\n\t\t/* baselines control */\n\t\tbaselines_section_placeholder: \"Start adding a new baseline\",\n\t\tbaselines_add_button: \"Add Baseline\",\n\t\tbaselines_remove_button: \"Remove\",\n\t\tbaselines_remove_all_button: \"Remove All\",\n\n\t\t/* deadline control */\n\t\tdeadline_enable_button: \"Set\",\n\t\tdeadline_disable_button: \"Remove\"\n\t}\n};\n\nexport default locale;\n","import * as utils from \"../utils/utils\";\nimport constants from \"../constants\";\nimport ExtensionManager from \"../ext/extension_manager\";\n\nimport services from \"../core/common/services\";\nimport config from \"../core/common/config\";\nimport ajax from \"../core/common/ajax\";\nimport date from \"../core/common/date\";\nimport {remoteEvents} from \"../core/remote/remote_events\";\n\nimport DnD from \"../core/common/dnd\";\nimport templates from \"../core/common/templates\";\nimport eventable from \"../utils/eventable\";\n\nimport StateService from \"../core/common/state\";\n\nimport Promise from \"../utils/promise\";\nimport env from \"../utils/env\";\nimport datastoreHooks from \"../core/datastore/datastore_hooks\";\nimport DataProcessor from \"../core/dataprocessor\";\n\nimport plugins from \"../core/plugins\";\n\nimport grid_column_api from \"../core/grid_column_api\";\nimport tasks from \"../core/tasks\";\nimport parsing from \"../core/loading/parsing\";\nimport work_time from \"../core/worktime/work_time\";\nimport data from \"../core/data\";\n\nimport void_script_second from \"../publish_helpers/void_script_second\";\n\nimport data_task_types from \"../core/data_task_types\";\nimport cached_functions from \"../core/cached_functions\";\n\nimport gantt_core from \"../core/gantt_core\";\nimport destructor from \"../core/destructor\";\nimport void_script_third from \"../publish_helpers/void_script_third\";\n\nimport i18nFactory from \"../locale\";\n\nfunction DHXGantt(){\n\tthis.constants = constants;\n\tthis.version = VERSION;\n\tthis.license = LICENSE;\n\tthis.templates = {};\n\tthis.ext = {};\n\tthis.keys = {\n\t\tedit_save: this.constants.KEY_CODES.ENTER,\n\t\tedit_cancel: this.constants.KEY_CODES.ESC\n\t};\n}\n\nexport default function(supportedExtensions) {\n\t// use a named constructor to make gantt instance discoverable in heap snapshots\n\tvar gantt = new DHXGantt();\n\n\tvar extensionManager = new ExtensionManager(supportedExtensions);\n\tvar activePlugins = {};\n\tgantt.plugins = function(config){\n\t\tfor(var i in config){\n\t\t\tif(config[i] && !activePlugins[i]){\n\t\t\t\tvar plugin = extensionManager.getExtension(i);\n\t\t\t\tif(plugin){\n\t\t\t\t\tplugin(gantt);\n\t\t\t\t\tactivePlugins[i] = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn activePlugins;\n\t};\n\n\tgantt.$services = services();\n\tgantt.config = config();\n\tgantt.ajax =  ajax(gantt);\n\tgantt.date = date(gantt);\n\tgantt.RemoteEvents = remoteEvents;\n\n\tvar dnd = DnD(gantt);\n\tgantt.$services.setService(\"dnd\", function(){return dnd;});\n\n\tvar templatesLoader = templates(gantt);\n\tgantt.$services.setService(\"templateLoader\", function () {\n\t\treturn templatesLoader;\n\t});\n\n\teventable(gantt);\n\n\t\n\tvar stateService = new StateService();\n\n\tstateService.registerProvider(\"global\", function () {\n\t\tvar res = {\n\t\t\tmin_date: gantt._min_date,\n\t\t\tmax_date: gantt._max_date,\n\t\t\tselected_task: null\n\t\t};\n\n\t\t// do not throw error if getState called from non-initialized gantt\n\t\tif(gantt.$data && gantt.$data.tasksStore){\n\t\t\tres.selected_task = gantt.$data.tasksStore.getSelectedId();\n\t\t}\n\t\treturn res;\n\t});\n\tgantt.getState = stateService.getState;\n\tgantt.$services.setService(\"state\", function () {\n\t\treturn stateService;\n\t});\n\n\tutils.mixin(gantt, utils);\n\n\tgantt.Promise = Promise;\n\tgantt.env = env;\n\n\tdatastoreHooks(gantt);\n\n\tgantt.dataProcessor = DataProcessor.DEPRECATED_api;\n\tgantt.createDataProcessor = DataProcessor.createDataProcessor;\n\n\tplugins(gantt);\n\n\tgrid_column_api(gantt);\n\ttasks(gantt);\n\tparsing(gantt);\n\twork_time(gantt);\n\tdata(gantt);\n\n\tvoid_script_second(gantt);\n\n\tdata_task_types(gantt);\n\tcached_functions(gantt);\n\n\tgantt_core(gantt);\n\tdestructor(gantt);\n\tvoid_script_third(gantt);\n\n\tvar i18n = i18nFactory();\n\tgantt.i18n = {\n\t\taddLocale: i18n.addLocale,\n\t\tsetLocale: function(locale){\n\t\t\tif(typeof locale === \"string\"){\n\t\t\t\tvar localeObject = i18n.getLocale(locale);\n\t\t\t\tif(!localeObject){\n\t\t\t\t\tlocaleObject = i18n.getLocale(\"en\");\n\t\t\t\t}\n\n\t\t\t\tgantt.locale = localeObject;\n\t\t\t}else if(locale){\n\t\t\t\tif(!gantt.locale){\n\t\t\t\t\tgantt.locale = locale;\n\t\t\t\t}else{\n\t\t\t\t\tfor(var i in locale){\n\t\t\t\t\t\tif(locale[i] && typeof locale[i] === \"object\"){\n\t\t\t\t\t\t\tif(!gantt.locale[i]){\n\t\t\t\t\t\t\t\tgantt.locale[i] = {};\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tgantt.mixin(gantt.locale[i], locale[i], true);\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tgantt.locale[i] = locale[i];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst labels = gantt.locale.labels;\n\t\t\tlabels.gantt_save_btn = labels.gantt_save_btn || labels.icon_save;\n\t\t\tlabels.gantt_cancel_btn = labels.gantt_cancel_btn || labels.icon_cancel;\n\t\t\tlabels.gantt_delete_btn = labels.gantt_delete_btn || labels.icon_delete;\n\t\t},\n\t\tgetLocale: i18n.getLocale\n\t};\n\tgantt.i18n.setLocale(\"en\");\n\treturn gantt;\n};","export default function(){\n\tvar services = {};\n\tfunction register (name, getter){\n\t\tservices[name] = getter;\n\t}\n\n\tfunction getService(name){\n\t\tif(!services[name]){\n\t\t\treturn null;\n\t\t}\n\t\treturn services[name]();\n\t}\n\n\tfunction dropService(name) {\n\t\tif (services[name]) {\n\t\t\tdelete services[name];\n\t\t}\n\t}\n\n\tvar servicesEnum = {};\n\n\treturn {\n\t\tservices: servicesEnum,\n\t\tsetService: register,\n\t\tgetService: getService,\n\t\tdropService: dropService,\n\t\tdestructor: function(){\n\t\t\tfor(var i in services){\n\t\t\t\tif(services[i]){\n\t\t\t\t\tvar service = services[i];\n\t\t\t\t\tif(service && service.destructor){\n\t\t\t\t\t\tservice.destructor();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tservices = null;\n\t\t}\n\t};\n};\n","type DurationUnits = \"minute\" | \"hour\" | \"day\" | \"week\" | \"month\" | \"year\";\ntype Align = \"left\" | \"center\" | \"right\";\ntype SectionType = \"textarea\"\n\t\t\t\t\t| \"time\"\n\t\t\t\t\t| \"duration\"\n\t\t\t\t\t| \"select\"\n\t\t\t\t\t| \"typeselect\"\n\t\t\t\t\t| \"parent\"\n\t\t\t\t\t| \"template\"\n\t\t\t\t\t| \"checkbox\"\n\t\t\t\t\t| \"radio\"\n\t\t\t\t\t| \"resources\"\n\t\t\t\t\t| \"constraint\";\n\ntype LightboxSection = Array<ILightboxSection\n\t| ILightboxTimeAndDurationSection\n\t| ILightboxInputControl\n\t| ILightboxSelectControl\n\t| ILightboxParentControl\n\t| ILightboxTypeselectControl>;\n\ntype LayoutView = \"grid\"\n\t| \"timeline\"\n\t| \"resizer\"\n\t| \"scrollbar\"\n\t| \"resourceGrid\"\n\t| \"resourceTimeline\";\n\ninterface IColumnItem {\n\tname: string;\n\tlabel?: string;\n\ttree?: boolean;\n\talign?: Align;\n\thide?: boolean;\n\tmax_width?: number;\n\tmin_width?: number;\n\tresize?: boolean;\n\ttemplate?: (obj: any) => string;\n\twidth?: number | \"*\";\n}\n\nexport type TModifierKeys = \"metaKey\" | \"ctrlKey\" | \"altKey\" | \"shiftKey\" | false | undefined;\n\nexport interface IScale {\n\tcss?: () => string;\n\tdate?: string;\n\tstep: number;\n\ttemplate?: (date: Date) => string;\n\tunit: DurationUnits;\n}\n\ninterface ILightboxSection {\n\tname: string;\n\tmap_to: string;\n\ttype: SectionType;\n\theight?: number;\n\tfocus?: boolean;\n}\n\ninterface ILightboxTimeAndDurationSection extends ILightboxSection {\n\treadonly: boolean;\n\tyear_range: number[] | number;\n\tsingle_date: boolean;\n\ttime_format: string;\n}\n\ninterface ILightboxInputControl extends ILightboxSection {\n\tdefault_value?: any;\n\toptions?: Array<{key: string, label: string}>;\n}\n\ninterface ILightboxSelectControl extends ILightboxInputControl {\n\tonchange: () => boolean | undefined;\n}\n\ninterface ILightboxParentControl extends ILightboxSection {\n\tallow_root: boolean;\n\troot_label: string;\n\tsort?: (a: any, b: any) => -1 | 0 | 1;\n\tfilter?: (task: string | number | object) => boolean;\n\ttemplate?: (start: Date, end: Date, ev: object) => string;\n}\n\ninterface ILightboxTypeselectControl extends ILightboxSection {\n\tfilter?: (typeName: string) => boolean;\n}\n\n\ninterface ILayoutScrollbar {\n\tview: \"scrollbar\";\n\tscroll?: \"x\" | \"y\";\n\tid: string;\n\theight?: number;\n\twidth?: number;\n}\n\ninterface ILayoutView {\n\tview: LayoutView;\n\tid?: string;\n\tscrollX?: string;\n\tscrollY?: string;\n\tconfig?: object;\n}\n\ninterface ILayoutGrid extends ILayoutView {\n\tview: \"grid\";\n\tbind?: string;\n}\n\ninterface ILayoutTimeline extends ILayoutView {\n\tview: \"timeline\";\n\tbindLinks?: string;\n\tlayers?: any[];\n}\n\ninterface ILayoutResizer {\n\tview?: undefined;\n\tresizer: boolean;\n\twidth: number;\n}\n\ninterface ILayoutResourceGrid extends ILayoutView {\n\tview: \"resourceGrid\";\n\twidth: number;\n\tgroup: \"string\";\n}\n\ninterface ILayoutResourceTimeline extends ILayoutView {\n\tview: \"resourceTimeline\";\n\twidth: number;\n\tgroup: \"string\";\n}\n\ninterface ILayoutHtml {\n\thtml: string;\n\tcss: string;\n\twidth: number;\n}\n\ntype LayoutRow = ILayoutGrid\n\t| ILayoutTimeline\n\t| ILayoutResizer\n\t| ILayoutResourceGrid\n\t| ILayoutResourceTimeline\n\t| ILayoutHtml\n\t| ILayoutScrollbar\n\t| { cols: LayoutCol[] };\n\ntype LayoutCol = ILayoutGrid\n\t| ILayoutTimeline\n\t| ILayoutResizer\n\t| ILayoutResourceGrid\n\t| ILayoutResourceTimeline\n\t| ILayoutHtml\n\t| ILayoutScrollbar\n\t| { rows: LayoutRow[] };\n\ninterface ILayout {\n\tcss: string;\n\trows?: LayoutRow[];\n\tcols?: LayoutCol[];\n}\n\ntype TCsp = boolean | \"auto\";\n\ninterface IResourceConfig {\n\tdataprocessor_assignments?: boolean;\n\tdataprocessor_resources?: boolean;\n\teditable_resource_diagram?: boolean;\n\tresource_store?: {\n\t\ttype?: \"treeDataStore\"|\"dataStore\"|string;\n\t\tfetchTasks?: boolean;\n\t\tinitItem?: (item: any) => any;\n\t};\n\tlightbox_resources?: (resources: any[]) => any[];\n\n}\n\ninterface IGanttConfig {\n\tlayout: ILayout;\n\tlinks: {\n\t\tfinish_to_start: \"0\";\n\t\tstart_to_start: \"1\";\n\t\tfinish_to_finish: \"2\";\n\t\tstart_to_finish: \"3\";\n\t};\n\ttypes: {\n\t\ttask: string;\n\t\tproject: string;\n\t\tmilestone: string;\n\t};\n\tauto_types: boolean;\n\tduration_unit: DurationUnits;\n\twork_time: boolean;\n\tcorrect_work_time: boolean;\n\tdeadlines: boolean;\n\tskip_off_time: boolean;\n\tcascade_delete: boolean;\n\tautosize: boolean | string;\n\tautoscroll: boolean;\n\tshow_links: boolean;\n\tshow_task_cells: boolean;\n\tautosize_min_width: number;\n\tautoscroll_speed: number;\n\tdeepcopy_on_parse: boolean;\n\tstatic_background: boolean;\n\tstatic_background_cells: boolean;\n\tbranch_loading: boolean;\n\tbranch_loading_property: string;\n\tshow_loading: boolean;\n\tshow_chart: boolean;\n\tshow_grid: boolean;\n\tmin_duration: number;\n\tdate_format: string; // use instead xml_date\n\txml_date?: string; // deprecated\n\tstart_on_monday: boolean;\n\tserver_utc: boolean;\n\tshow_progress: boolean;\n\tfit_tasks: boolean;\n\tselect_task: boolean;\n\tscroll_on_click: boolean;\n\tsmart_rendering: boolean;\n\tpreserve_scroll: boolean;\n\treadonly: boolean;\n\tcontainer_resize_timeout: number;\n\n\t/*grid */\n\tdate_grid: string;\n\n\tdrag_links: boolean;\n\tdrag_progress: boolean;\n\tdrag_resize: boolean;\n\tdrag_project: boolean;\n\tdrag_move: boolean;\n\tdrag_mode: {\n\t\tresize: \"resize\",\n\t\tprogress: \"progress\",\n\t\tmove: \"move\",\n\t\tignore: \"ignore\"\n\t};\n\tround_dnd_dates: boolean;\n\tlink_wrapper_width: number;\n\troot_id: string | number;\n\n\tlink_arrow_size:number;\n\n\tautofit: boolean;\n\tcolumns: IColumnItem[];\n\n\t/* scale*/\n\tscales: IScale[];\n\n\tscale_offset_minimal: boolean;\n\n\tinherit_scale_class: boolean;\n\n\n\ttime_step: number;\n\tduration_step: number;\n\n\n\ttask_date: string;\n\ttime_picker: string;\n\ttask_attribute: string;\n\tlink_attribute: string;\n\tlayer_attribute: string;\n\tbuttons_left: string[];\n\t_migrate_buttons: {\n\t\tdhx_save_btn: \"gantt_save_btn\",\n\t\tdhx_cancel_btn: \"gantt_cancel_btn\",\n\t\tdhx_delete_btn: \"gantt_delete_btn\"\n\t};\n\n\tbuttons_right: string[];\n\n\n\tlightbox: {\n\t\tsections?: LightboxSection,\n\t\tproject_sections?: LightboxSection,\n\t\tmilestone_sections?: LightboxSection\n\t};\n\tdrag_lightbox: boolean;\n\tsort: boolean;\n\tdetails_on_create: boolean;\n\tdetails_on_dblclick: boolean;\n\tinitial_scroll: boolean;\n\ttask_scroll_offset: number;\n\n\torder_branch: boolean;\n\torder_branch_free: boolean;\n\n\t// task_height is deprecated, use 'bar_height` instead\n\ttask_height: number | \"full\" | undefined;\n\tbar_height: number | \"full\";\n\tmin_column_width: number;\n\tbar_height_padding: number,\n\trow_height: number,\n\n\t// min width for grid column (when resizing)\n\tmin_grid_column_width: number;\n\t// name of the attribute with column index for resize element\n\tgrid_resizer_column_attribute: string;\n\t// name of the attribute with column index for resize element\n\t// grid_resizer_attribute: string; // usage of this parameter is not found\n\n\t// grid width can be increased after the column has been resized\n\tkeep_grid_width: boolean;\n\n\t// grid width can be adjusted\n\tgrid_resize: boolean;\n\tgrid_elastic_columns: boolean;\n\tshow_tasks_outside_timescale: boolean;\n\tshow_unscheduled: boolean;\n\treadonly_property: string;\n\teditable_property: string;\n\tcalendar_property: string;\n\tresource_calendars: object;\n\tdynamic_resource_calendars: boolean;\n\tinherit_calendar: boolean;\n\ttype_renderers: object;\n\n\tresize_rows: boolean;\n\t// name of the attribute with row index for resize element\n\ttask_grid_row_resizer_attribute: string;\n\t// min height for row (when resizing)\n\tmin_task_grid_row_height: number;\n\n\topen_tree_initially: boolean;\n\toptimize_render: boolean;\n\tprevent_default_scroll: boolean;\n\tshow_errors: boolean;\n\twai_aria_attributes: boolean;\n\tsmart_scales: boolean;\n\trtl: boolean;\n\tplaceholder_task: boolean | object;\n\thorizontal_scroll_key: TModifierKeys;\n\tdrag_timeline: {\n\t\tuseKey: TModifierKeys;\n\t\tignore: string;\n\t\trender?: boolean;\n\t};\n\tdrag_multiple: boolean;\n\tcsp: TCsp;\n\n\tresources?: IResourceConfig;\n\n\tauto_scheduling: object;\n}\n\nexport default () => {\n\tconst result: IGanttConfig = {\n\t\tlayout: {\n\t\t\tcss: \"gantt_container\",\n\t\t\trows: [\n\t\t\t\t{\n\t\t\t\t\tcols: [\n\t\t\t\t\t\t{view: \"grid\", scrollX: \"scrollHor\", scrollY: \"scrollVer\"},\n\t\t\t\t\t\t{resizer: true, width: 1},\n\t\t\t\t\t\t{view: \"timeline\", scrollX: \"scrollHor\", scrollY: \"scrollVer\"},\n\t\t\t\t\t\t{view: \"scrollbar\", id: \"scrollVer\"}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{view: \"scrollbar\", id: \"scrollHor\", height: 20}\n\t\t\t]\n\t\t},\n\t\tlinks: {\n\t\t\tfinish_to_start: \"0\",\n\t\t\tstart_to_start: \"1\",\n\t\t\tfinish_to_finish: \"2\",\n\t\t\tstart_to_finish: \"3\"\n\t\t},\n\t\ttypes: {\n\t\t\ttask: \"task\",\n\t\t\tproject: \"project\",\n\t\t\tmilestone: \"milestone\"\n\t\t},\n\t\tauto_types: false,\n\t\tduration_unit: \"day\",\n\t\twork_time: false,\n\t\tcorrect_work_time: false,\n\t\tskip_off_time: false,\n\n\t\tcascade_delete: true,\n\n\t\tautosize: false,\n\t\tautosize_min_width: 0,\n\t\tautoscroll: true,\n\t\tautoscroll_speed: 30,\n\t\tdeepcopy_on_parse: false,\n\t\tshow_links: true,\n\t\tshow_task_cells: true,\n\t\t// replace backgroung of the task area with a canvas img\n\t\tstatic_background: false,\n\t\tstatic_background_cells: true,\n\t\tbranch_loading: false,\n\t\tbranch_loading_property: \"$has_child\",\n\t\tshow_loading: false,\n\t\tshow_chart: true,\n\t\tshow_grid: true,\n\t\tmin_duration: 60 * 60 * 1000,\n\t\tdate_format: \"%d-%m-%Y %H:%i\", // use instead xml_date\n\t\txml_date: undefined, // \"%d-%m-%Y %H:%i\", // deprecated\n\t\tstart_on_monday: true,\n\t\tserver_utc: false,\n\t\tshow_progress: true,\n\t\tfit_tasks: false,\n\t\tselect_task: true,\n\t\tscroll_on_click: true,\n\t\tsmart_rendering: true,\n\t\tpreserve_scroll: true,\n\t\treadonly: false,\n\t\tcontainer_resize_timeout: 20,\n\t\tdeadlines: true,\n\n\t\t/*grid */\n\t\tdate_grid: \"%Y-%m-%d\",\n\n\t\tdrag_links: true,\n\t\tdrag_progress: true,\n\t\tdrag_resize: true,\n\t\tdrag_project: false,\n\t\tdrag_move: true,\n\t\tdrag_mode: {\n\t\t\tresize: \"resize\",\n\t\t\tprogress: \"progress\",\n\t\t\tmove: \"move\",\n\t\t\tignore: \"ignore\"\n\t\t},\n\t\tround_dnd_dates: true,\n\t\tlink_wrapper_width: 20,\n\t\tlink_arrow_size:12,\n\t\troot_id: 0,\n\n\t\tautofit: false, // grid column automatic fit grid_width config\n\t\tcolumns: [\n\t\t\t{name: \"text\", tree: true, width: \"*\", resize: true},\n\t\t\t{name: \"start_date\", align: \"center\", resize: true},\n\t\t\t{name: \"duration\", align: \"center\"},\n\t\t\t{name: \"add\", width: 44}\n\t\t],\n\n\t\t/*scale*/\n\n\t\tscale_offset_minimal: true,\n\t\tinherit_scale_class: false,\n\n\t\tscales: [\n\t\t\t{\n\t\t\t\tunit: \"day\",\n\t\t\t\tstep: 1,\n\t\t\t\tdate: \"%d %M\"\n\t\t\t}\n\t\t],\n\n\t\ttime_step: 60,\n\t\tduration_step: 1,\n\t\ttask_date: \"%d %F %Y\",\n\t\ttime_picker: \"%H:%i\",\n\t\ttask_attribute: \"data-task-id\",\n\t\tlink_attribute: \"data-link-id\",\n\t\tlayer_attribute: \"data-layer\",\n\t\tbuttons_left: [\n\t\t\t\"gantt_save_btn\",\n\t\t\t\"gantt_cancel_btn\"\n\t\t],\n\t\t_migrate_buttons: {\n\t\t\tdhx_save_btn: \"gantt_save_btn\",\n\t\t\tdhx_cancel_btn: \"gantt_cancel_btn\",\n\t\t\tdhx_delete_btn: \"gantt_delete_btn\"\n\t\t},\n\t\tbuttons_right: [\n\t\t\t\"gantt_delete_btn\"\n\t\t],\n\t\tlightbox: {\n\t\t\tsections: [\n\t\t\t\t{name: \"description\", height: 70, map_to: \"text\", type: \"textarea\", focus: true},\n\t\t\t\t{name: \"time\", type: \"duration\", map_to: \"auto\"}\n\t\t\t],\n\t\t\tproject_sections: [\n\t\t\t\t{name: \"description\", height: 70, map_to: \"text\", type: \"textarea\", focus: true},\n\t\t\t\t{name: \"type\", type: \"typeselect\", map_to: \"type\"},\n\t\t\t\t{name: \"time\", type: \"duration\", readonly: true, map_to: \"auto\"}\n\t\t\t],\n\t\t\tmilestone_sections: [\n\t\t\t\t{name: \"description\", height: 70, map_to: \"text\", type: \"textarea\", focus: true},\n\t\t\t\t{name: \"type\", type: \"typeselect\", map_to: \"type\"},\n\t\t\t\t{name: \"time\", type: \"duration\", single_date: true, map_to: \"auto\"}\n\t\t\t]\n\t\t},\n\t\tdrag_lightbox: true,\n\t\tsort: false,\n\t\tdetails_on_create: true,\n\t\tdetails_on_dblclick: true,\n\t\tinitial_scroll: true,\n\t\ttask_scroll_offset: 100,\n\n\t\torder_branch: false,\n\t\torder_branch_free: false,\n\n\t\t// task height is deprecated, use 'bar_height' instead\n\t\ttask_height: undefined,// number px of 'full' for row height\n\t\tbar_height: \"full\",\n\t\tbar_height_padding:9,\n\t\tmin_column_width: 70,\n\n\t\t// min width for grid column (when resizing)\n\t\tmin_grid_column_width: 70,\n\t\t// name of the attribute with column index for resize element\n\t\tgrid_resizer_column_attribute: \"data-column-index\",\n\t\t// name of the attribute with column index for resize element\n\t\t// grid_resizer_attribute: \"grid_resizer\", // - usage of this parameter is not found in code\n\n\t\t// grid width can be increased after the column has been resized\n\t\tkeep_grid_width: false,\n\n\t\t// grid width can be adjusted\n\t\tgrid_resize: false,\n\t\tgrid_elastic_columns: false,\n\t\tshow_tasks_outside_timescale: false,\n\t\tshow_unscheduled: true,\n\n\t\tresize_rows: false,\n\t\t// name of the attribute with row index for resize element\n\t\ttask_grid_row_resizer_attribute: \"data-row-index\",\n\t\t// min height for row (when resizing)\n\t\tmin_task_grid_row_height: 30,\n\t\trow_height: 36,\n\n\t\t//\n\t\treadonly_property: \"readonly\",\n\t\teditable_property: \"editable\",\n\t\tcalendar_property: \"calendar_id\",\n\t\tresource_calendars: {},\n\t\tdynamic_resource_calendars: false,\n\t\tinherit_calendar: false,\n\t\ttype_renderers: {},\n\n\t\topen_tree_initially: false,\n\t\toptimize_render: true,\n\t\tprevent_default_scroll: false,\n\t\tshow_errors: true,\n\t\twai_aria_attributes: true,\n\t\tsmart_scales: true,\n\t\trtl:false,\n\t\tplaceholder_task: false,\n\t\thorizontal_scroll_key: \"shiftKey\",\n\t\tdrag_timeline: {\n\t\t\tuseKey: undefined,\n\t\t\tignore: \".gantt_task_line, .gantt_task_link\",\n\t\t\trender: false\n\t\t},\n\t\tdrag_multiple: true,\n\t\tcsp: \"auto\",\n\t\tauto_scheduling: {}\n\t};\n\treturn result;\n};\n","import eventable from \"../../utils/eventable\";\nimport * as utils from \"../../utils/utils\";\nimport timeout from \"../../utils/timeout\";\nimport global from \"../../utils/global\";\nimport * as domHelpers from \"../ui/utils/dom_helpers\";\n\nexport default function(gantt){\n\n\tfunction copyDomEvent(e){\n\t\treturn {\n\t\t\ttarget: e.target || e.srcElement,\n\t\t\tpageX: e.pageX,\n\t\t\tpageY: e.pageY,\n\t\t\tclientX: e.clientX,\n\t\t\tclientY: e.clientY,\n\t\t\tmetaKey: e.metaKey,\n\t\t\tshiftKey: e.shiftKey,\n\t\t\tctrlKey: e.ctrlKey,\n\t\t\taltKey: e.altKey\n\t\t};\n\t}\n\n\tfunction DnD(obj, config) {\n\t\tthis._obj = obj;\n\t\tthis._settings = config || {};\n\t\teventable(this);\n\n\t\tvar inputMethods = this.getInputMethods();\n\n\t\tthis._drag_start_timer = null;\n\t\tgantt.attachEvent(\"onGanttScroll\", utils.bind(function (left, top) {\n\t\t\tthis.clearDragTimer();\n\t\t}, this));\n\n\t\tvar lastDown = 0;\n\t\tvar eventParams = {passive: false};\n\t\tfor(var i = 0; i < inputMethods.length; i++){\n\t\t\t(utils.bind(function(input){\n\n\t\t\t\tgantt.event(obj, input.down, utils.bind(function (e) {\n\t\t\t\t\tif(!input.accessor(e)){\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (typeof e.button !== 'undefined' && e.button !== 0) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif(config.preventDefault && config.selector && domHelpers.closest(e.target, config.selector)){\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t}\n\n\t\t\t\t\tif (gantt.config.touch && e.timeStamp && e.timeStamp - lastDown < 300) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis._settings.original_target = copyDomEvent(e);\n\n\t\t\t\t\tthis._settings.original_element_sizes = {\n\t\t\t\t\t\t...domHelpers.getRelativeEventPosition(e, domHelpers.getClosestSizedElement(obj)), \n\t\t\t\t\t\twidth: e.target.offsetWidth,\n\t\t\t\t\t\theight: e.target.offsetHeight\n\t\t\t\t\t};\n\n\t\t\t\t\tif (gantt.config.touch) {\n\t\t\t\t\t\tthis.clearDragTimer();\n\t\t\t\t\t\tthis._drag_start_timer = setTimeout(utils.bind(function () {\n\t\t\t\t\t\t\tif(gantt.getState().lightbox){\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis.dragStart(obj, e, input);\n\t\t\t\t\t\t}, this), gantt.config.touch_drag);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tthis.dragStart(obj, e, input);\n\t\t\t\t\t}\n\t\t\t\t}, this), eventParams);\n\t\t\t\tvar eventElement = document.body;\n\t\t\t\tgantt.event(eventElement, input.up, utils.bind(function (e) {\n\t\t\t\t\tif(!input.accessor(e)){\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tthis.clearDragTimer();\n\t\t\t\t}, this), eventParams);\n\n\t\t\t}, this))(inputMethods[i]);\n\t\t}\n\t}\n\n\tDnD.prototype = {\n\t\ttraceDragEvents: function (domElement, inputMethod) {\n\t\t\tvar mousemove = utils.bind(function (e) {\n\t\t\t\treturn this.dragMove(domElement, e, inputMethod.accessor);\n\t\t\t}, this);\n\t\t\tutils.bind(function (e) {\n\t\t\t\treturn this.dragScroll(domElement, e);\n\t\t\t}, this);\n\n\t\t\tvar limited_mousemove = utils.bind(function (e) {\n\t\t\t\tif (this.config.started && utils.defined(this.config.updates_per_second)) {\n\t\t\t\t\tif (!timeout(this, this.config.updates_per_second))\n\t\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tvar dndActive = mousemove(e);\n\n\t\t\t\tif (dndActive) {\n\t\t\t\t\ttry{\n\t\t\t\t\t\tif (e && e.preventDefault && e.cancelable){//e.cancelable condition - because navigator.vibrate is blocked by Chrome\n\t\t\t\t\t\t\te.preventDefault();//Cancel default action on DND\n\t\t\t\t\t\t} //Cancel default action on DND\n\t\t\t\t\t}catch (e){\n\t\t\t\t\t\t// just suppress the exception, nothing needed to be done here\n\t\t\t\t\t}\n\n\t\t\t\t\t//e.cancelBubble = true;\n\t\t\t\t}\n\n\t\t\t\treturn dndActive;\n\t\t\t}, this);\n\t\t\tvar eventElement = domHelpers.getRootNode(gantt.$root);\n\t\t\tvar mousemoveContainer = this.config.mousemoveContainer || domHelpers.getRootNode(gantt.$root);\n\n\t\t\tvar eventParams = {passive: false};\n\t\t\tvar mouseup = utils.bind(function (e) {\n\t\t\t\tgantt.eventRemove(mousemoveContainer, inputMethod.move, limited_mousemove);\n\t\t\t\tgantt.eventRemove(eventElement, inputMethod.up, mouseup, eventParams);\n\t\t\t\treturn this.dragEnd(domElement);\n\t\t\t}, this);\n\n\t\t\tgantt.event(mousemoveContainer, inputMethod.move, limited_mousemove, eventParams);\n\t\t\tgantt.event(eventElement, inputMethod.up, mouseup, eventParams);\n\t\t},\n\t\tcheckPositionChange: function (pos) {\n\t\t\tvar diff_x = pos.x - this.config.pos.x;\n\t\t\tvar diff_y = pos.y - this.config.pos.y;\n\t\t\tvar distance = Math.sqrt(Math.pow(Math.abs(diff_x), 2) + Math.pow(Math.abs(diff_y), 2));\n\n\t\t\tif (distance > this.config.sensitivity) {\n\t\t\t\treturn true;\n\t\t\t} else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\tinitDnDMarker: function () {\n\t\t\t// create dnd placeholder and put it in dom\n\t\t\tvar marker = this.config.marker = document.createElement(\"div\");\n\t\t\tmarker.className = \"gantt_drag_marker\";\n\t\t\t// GS-1333: don't show any message when we resize grid columns\n\t\t\tmarker.innerHTML = \"\";\n\t\t\tdocument.body.appendChild(marker);\n\t\t},\n\t\tbackupEventTarget: function (domEvent, getEvent) {\n\t\t\tif (!gantt.config.touch) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// keep original event target in DOM in order to keep dnd on touchmove event\n\t\t\tvar e = getEvent(domEvent);\n\n\t\t\tvar el = e.target || e.srcElement;\n\t\t\tvar copy = el.cloneNode(true);\n\t\t\t//this.config.target.target = copy;\n\t\t\tthis.config.original_target = copyDomEvent(e);\n\t\t\tthis.config.original_target.target = copy;\n\t\t\tthis.config.backup_element = el;\n\t\t\tel.parentNode.appendChild(copy);\n\n\t\t\tel.style.display = \"none\";\n\t\t\tvar mousemoveContainer = this.config.mousemoveContainer || document.body;\n\t\t\tmousemoveContainer.appendChild(el);\n\t\t},\n\t\tgetInputMethods: function () {\n\t\t\t// bind actions to browser events\n\t\t\tvar inputMethods = [];\n\n\t\t\tinputMethods.push({\n\t\t\t\t\"move\": \"mousemove\",\n\t\t\t\t\"down\": \"mousedown\",\n\t\t\t\t\"up\": \"mouseup\",\n\t\t\t\t\"accessor\": function (e) {\n\t\t\t\t\treturn e;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (gantt.config.touch) {\n\t\t\t\tconst touchEventsSupported = !gantt.env.isIE || !!global.maxTouchPoints;\n\n\t\t\t\tif(touchEventsSupported){\n\t\t\t\t\tinputMethods.push({\n\t\t\t\t\t\t\"move\": \"touchmove\",\n\t\t\t\t\t\t\"down\": \"touchstart\",\n\t\t\t\t\t\t\"up\": \"touchend\",\n\t\t\t\t\t\t\"accessor\": function (ev) {\n\t\t\t\t\t\t\tif (ev.touches && ev.touches.length > 1) return null;\n\t\t\t\t\t\t\tif (ev.touches[0])\n\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\ttarget: document.elementFromPoint(ev.touches[0].clientX, ev.touches[0].clientY),\n\t\t\t\t\t\t\t\t\tpageX: ev.touches[0].pageX,\n\t\t\t\t\t\t\t\t\tpageY: ev.touches[0].pageY,\n\t\t\t\t\t\t\t\t\tclientX: ev.touches[0].clientX,\n\t\t\t\t\t\t\t\t\tclientY: ev.touches[0].clientY\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\treturn ev;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}else if(global.PointerEvent){\n\t\t\t\t\tinputMethods.push({\n\t\t\t\t\t\t\"move\": \"pointermove\",\n\t\t\t\t\t\t\"down\": \"pointerdown\",\n\t\t\t\t\t\t\"up\": \"pointerup\",\n\t\t\t\t\t\t\"accessor\": function (ev) {\n\t\t\t\t\t\t\tif (ev.pointerType == \"mouse\") return null;\n\t\t\t\t\t\t\treturn ev;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn inputMethods;\n\t\t},\n\t\tclearDragTimer: function () {\n\t\t\tif (this._drag_start_timer) {\n\t\t\t\tclearTimeout(this._drag_start_timer);\n\t\t\t\tthis._drag_start_timer = null;\n\t\t\t}\n\t\t},\n\t\tdragStart: function (obj, e, inputMethod) {\n\t\t\tif (this.config && this.config.started) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.config = {\n\t\t\t\tobj: obj,\n\t\t\t\tmarker: null,\n\t\t\t\tstarted: false,\n\t\t\t\tpos: this.getPosition(e),\n\t\t\t\tsensitivity: 4\n\t\t\t};\n\t\t\tif (this._settings)\n\t\t\t\tutils.mixin(this.config, this._settings, true);\n\n\n\t\t\tthis.traceDragEvents(obj, inputMethod);\n\n\t\t\tgantt._prevent_touch_scroll = true;\n\t\t\t// GS-2664. Prevent grid scroll only if we can reorder rows\n\t\t\tif (e.target.closest(\".gantt_row\") && !gantt.config.order_branch){\n\t\t\t\tgantt._prevent_touch_scroll = false;\n\t\t\t}\n\t\t\tdocument.body.classList.add(\"gantt_noselect\");\n\n\t\t\tif (gantt.config.touch) {\n\t\t\t\tthis.dragMove(obj, e, inputMethod.accessor);\n\t\t\t}\n\n\t\t},\n\t\tdragMove: function (obj, e, getEvent) {\n\t\t\tvar source = getEvent(e);\n\t\t\tif (!source) return false;\n\n\t\t\tif (!this.config.marker && !this.config.started) {\n\t\t\t\tvar pos = this.getPosition(source);\n\n\t\t\t\tif (gantt.config.touch || this.checkPositionChange(pos)) {\n\t\t\t\t\t// real drag starts here,\n\t\t\t\t\t// when user moves mouse at first time after onmousedown\n\t\t\t\t\tthis.config.started = true;\n\t\t\t\t\tthis.config.ignore = false;\n\t\t\t\t\tgantt._touch_drag = true;\n\t\t\t\t\tif (this.callEvent(\"onBeforeDragStart\", [obj, this.config.original_target]) === false) {\n\t\t\t\t\t\tthis.config.ignore = true;\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\tthis.backupEventTarget(e, getEvent);\n\t\t\t\t\tthis.initDnDMarker();\n\t\t\t\t\tgantt._touch_feedback();\n\t\t\t\t\tthis.callEvent(\"onAfterDragStart\", [obj, this.config.original_target]);\n\t\t\t\t} else {\n\t\t\t\t\tthis.config.ignore = true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (!this.config.ignore) {\n\t\t\t\t// GS-1279 Gantt crashes on Mobile Firefox after starting to create a link and moving finger outisde the page.\n\t\t\t\tif (e.targetTouches && !source.target) return;\n\t\t\t\t\n\t\t\t\tsource.pos = this.getPosition(source);\n\t\t\t\tthis.config.marker.style.left = source.pos.x + \"px\";\n\t\t\t\tthis.config.marker.style.top = source.pos.y + \"px\";\n\t\t\t\tthis.callEvent(\"onDragMove\", [obj, source]);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn false;\n\t\t},\n\n\t\tdragEnd: function (obj) {\n\t\t\tvar target = this.config.backup_element;\n\t\t\tif (target && target.parentNode) {\n\t\t\t\ttarget.parentNode.removeChild(target);\n\t\t\t}\n\t\t\tgantt._prevent_touch_scroll = false;\n\t\t\tif (this.config.marker) {\n\t\t\t\tthis.config.marker.parentNode.removeChild(this.config.marker);\n\t\t\t\tthis.config.marker = null;\n\n\t\t\t\tthis.callEvent(\"onDragEnd\", []);\n\t\t\t}\n\t\t\tthis.config.started = false;\n\t\t\tgantt._touch_drag = false;\n\t\t\tdocument.body.classList.remove(\"gantt_noselect\");\n\t\t},\n\n\t\tgetPosition: function (e) {\n\t\t\tvar x = 0, y = 0;\n\t\t\tif (e.pageX || e.pageY) {\n\t\t\t\tx = e.pageX;\n\t\t\t\ty = e.pageY;\n\t\t\t} else if (e.clientX || e.clientY) {\n\t\t\t\tx = e.clientX + document.body.scrollLeft + document.documentElement.scrollLeft;\n\t\t\t\ty = e.clientY + document.body.scrollTop + document.documentElement.scrollTop;\n\t\t\t}\n\t\t\treturn {x: x, y: y};\n\t\t}\n\t};\n\n\treturn DnD;\n};\n","export default function(gantt) {\n\n\tvar regTemplates = {};\n\n\tfunction initTemplate(name, initial, template_name) {\n\t\ttemplate_name = template_name || name;\n\t\tvar config = gantt.config,\n\t\t\ttemplates = gantt.templates;\n\n\t\tif (gantt.config[name] && regTemplates[template_name] != config[name]) {\n\t\t\tif (!(initial && templates[template_name])) {\n\t\t\t\ttemplates[template_name] = gantt.date.date_to_str(config[name]);\n\t\t\t\tregTemplates[template_name] = config[name];\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction initTemplates() {\n\t\tvar date = gantt.date;\n\n\t\t//build configuration based templates\n\t\tvar d = date.date_to_str;\n\t\tvar c = gantt.config;\n\t\tvar format_date = d(c.xml_date || c.date_format, c.server_utc);\n\t\tvar parse_date = date.str_to_date(c.xml_date || c.date_format, c.server_utc);\n\n\t\tinitTemplate(\"date_scale\", true, undefined, gantt.config, gantt.templates);\n\t\tinitTemplate(\"date_grid\", true, \"grid_date_format\", gantt.config, gantt.templates);\n\t\tinitTemplate(\"task_date\", true, undefined, gantt.config, gantt.templates);\n\n\t\tgantt.mixin(gantt.templates, {\n\t\t\txml_format: undefined, // deprecated\n\t\t\tformat_date: format_date,\n\n\t\t\txml_date: undefined, // deprecated\n\t\t\tparse_date: parse_date,\n\n\t\t\tprogress_text: function (start, end, task) {\n\t\t\t\treturn \"\";\n\t\t\t},\n\t\t\tgrid_header_class: function (column, config) {\n\t\t\t\treturn \"\";\n\t\t\t},\n\n\t\t\ttask_text: function (start, end, task) {\n\t\t\t\treturn task.text;\n\t\t\t},\n\t\t\ttask_class: function (start, end, task) {\n\t\t\t\treturn \"\";\n\t\t\t},\n\t\t\ttask_end_date: function (date) {\n\t\t\t\treturn gantt.templates.task_date(date);\n\t\t\t},\n\t\t\tgrid_row_class: function (start, end, task) {\n\t\t\t\treturn \"\";\n\t\t\t},\n\t\t\ttask_row_class: function (start, end, task) {\n\t\t\t\treturn \"\";\n\t\t\t},\n\t\t\ttimeline_cell_class: function (item, date) {\n\t\t\t\treturn \"\";\n\t\t\t},\n\t\t\ttimeline_cell_content: function (item, date) {\n\t\t\t\treturn \"\";\n\t\t\t},\n\t\t\tscale_cell_class: function (date) {\n\t\t\t\treturn \"\";\n\t\t\t},\n\t\t\tscale_row_class: function (date) {\n\t\t\t\treturn \"\";\n\t\t\t},\n\n\t\t\tgrid_indent: function (item) {\n\t\t\t\treturn \"<div class='gantt_tree_indent'></div>\";\n\t\t\t},\n\t\t\tgrid_folder: function (item) {\n\t\t\t\treturn \"<div class='gantt_tree_icon gantt_folder_\" + (item.$open ? \"open\" : \"closed\") + \"'></div>\";\n\t\t\t},\n\t\t\tgrid_file: function (item) {\n\t\t\t\treturn \"<div class='gantt_tree_icon gantt_file'></div>\";\n\t\t\t},\n\t\t\tgrid_open: function (item) {\n\t\t\t\treturn \"<div class='gantt_tree_icon gantt_\" + (item.$open ? \"close\" : \"open\") + \"'></div>\";\n\t\t\t},\n\t\t\tgrid_blank: function (item) {\n\t\t\t\treturn \"<div class='gantt_tree_icon gantt_blank'></div>\";\n\t\t\t},\n\t\t\tdate_grid: function (date, item, column) {\n\t\t\t\tif (item && gantt.isUnscheduledTask(item) && gantt.config.show_unscheduled) {\n\t\t\t\t\treturn gantt.templates.task_unscheduled_time(item);\n\t\t\t\t} else {\n\t\t\t\t\treturn gantt.templates.grid_date_format(date, column);\n\t\t\t\t}\n\t\t\t},\n\n\t\t\ttask_time: function (start, end, ev) {\n\t\t\t\tif (gantt.isUnscheduledTask(ev) && gantt.config.show_unscheduled) {\n\t\t\t\t\treturn gantt.templates.task_unscheduled_time(ev);\n\t\t\t\t} else {\n\t\t\t\t\treturn gantt.templates.task_date(start) + \" - \" + gantt.templates.task_end_date(end);\n\t\t\t\t}\n\t\t\t},\n\n\t\t\ttask_unscheduled_time: function (task) {\n\t\t\t\treturn \"\";\n\t\t\t},\n\n\t\t\ttime_picker: d(c.time_picker),\n\t\t\tlink_class: function (link) {\n\t\t\t\treturn \"\";\n\t\t\t},\n\t\t\tlink_description: function (link) {\n\t\t\t\tvar from = gantt.getTask(link.source),\n\t\t\t\t\tto = gantt.getTask(link.target);\n\n\t\t\t\treturn \"<b>\" + from.text + \"</b> &ndash;  <b>\" + to.text + \"</b>\";\n\t\t\t},\n\n\t\t\tdrag_link: function (from, from_start, to, to_start) {\n\t\t\t\tfrom = gantt.getTask(from);\n\t\t\t\tvar labels = gantt.locale.labels;\n\n\t\t\t\tvar text = \"<b>\" + from.text + \"</b> \" + (from_start ? labels.link_start : labels.link_end) + \"<br/>\";\n\t\t\t\tif (to) {\n\t\t\t\t\tto = gantt.getTask(to);\n\t\t\t\t\ttext += \"<b> \" + to.text + \"</b> \" + (to_start ? labels.link_start : labels.link_end) + \"<br/>\";\n\t\t\t\t}\n\t\t\t\treturn text;\n\t\t\t},\n\t\t\tdrag_link_class: function (from, from_start, to, to_start) {\n\t\t\t\tvar add = \"\";\n\n\t\t\t\tif (from && to) {\n\t\t\t\t\tvar allowed = gantt.isLinkAllowed(from, to, from_start, to_start);\n\t\t\t\t\tadd = \" \" + (allowed ? \"gantt_link_allow\" : \"gantt_link_deny\");\n\t\t\t\t}\n\n\t\t\t\treturn \"gantt_link_tooltip\" + add;\n\t\t\t},\n\n\t\t\t/* used for aria-labels of bar elements and for tooltip.js */\n\t\t\ttooltip_date_format: date.date_to_str(\"%Y-%m-%d\"),\n\t\t\ttooltip_text: function (start, end, event) {\n\t\t\t\treturn `<div>Task: ${event.text}</div>\n\t\t\t\t<div>Start date: ${gantt.templates.tooltip_date_format(start)}</div>\n\t\t\t\t<div>End date: ${gantt.templates.tooltip_date_format(end)}</div>`;\n\t\t\t},\n\t\t\tbaseline_text: function (task, baseline, index) {\n\t\t\t\treturn \"\";\n\t\t\t}\n\t\t});\n\t}\n\n\treturn {\n\t\tinitTemplates: initTemplates,\n\t\tinitTemplate: initTemplate\n\t};\n\n};","import * as utils from \"../../utils/utils\";\nimport facadeFactory from \"./../facades/datastore\";\nimport calculateScaleRange from \"../gantt_data_range\";\nimport isPlaceholderTask from \"../../utils/placeholder_task\";\n\nimport treeHelper from \"../../utils/task_tree_helpers\";\n\nfunction initDataStores(gantt){\n\n\tvar facade = facadeFactory.create();\n\tutils.mixin(gantt, facade);\n\tvar tasksStore = gantt.createDatastore({\n\t\tname: \"task\",\n\t\ttype: \"treeDatastore\",\n\t\trootId: function() { return gantt.config.root_id; },\n\t\tinitItem: utils.bind(_init_task, gantt),\n\t\tgetConfig: function() { return gantt.config; }\n\t});\n\n\tvar linksStore = gantt.createDatastore({\n\t\tname: \"link\",\n\t\tinitItem: utils.bind(_init_link, gantt)\n\t});\n\n\tgantt.attachEvent(\"onDestroy\", function(){\n\t\ttasksStore.destructor();\n\t\tlinksStore.destructor();\n\t});\n\n\tgantt.attachEvent(\"onLinkValidation\", function(link){\n\t\tif(gantt.isLinkExists(link.id) || link.id === \"predecessor_generated\"){\n\t\t\t// link was already added into gantt\n\t\t\treturn true;\n\t\t}\n\t\tvar source = gantt.getTask(link.source);\n\t\tvar taskLinks = source.$source;\n\t\tfor (var i = 0; i < taskLinks.length; i++) {\n\t\t\tvar existingLink = gantt.getLink(taskLinks[i]);\n\n\t\t\tvar sourceMatch = link.source == existingLink.source;\n\t\t\tvar targetMatch = link.target == existingLink.target;\n\t\t\tvar typeMatch = link.type == existingLink.type;\n\n\t\t\t// prevent creating duplicated links from the UI\n\t\t\tif (sourceMatch && targetMatch && typeMatch) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t});\n\n\ttasksStore.attachEvent(\"onBeforeRefreshAll\", function(){\n\n\t\t// GS-2170 do not recalculate indexes and dates as the event will be called later in the onStoreUpdate event\n\t\tif (tasksStore._skipTaskRecalculation){\n\t\t\treturn;\n\t\t}\n\n\t\tvar order = tasksStore.getVisibleItems();\n\n\t\tfor(var i=0; i < order.length; i++){\n\t\t\tvar item = order[i];\n\t\t\titem.$index = i;\n\t\t\titem.$local_index = gantt.getTaskIndex(item.id);\n\t\t\tgantt.resetProjectDates(item);\n\t\t}\n\n\t});\n\n\ttasksStore.attachEvent(\"onFilterItem\", function(id, task) {\n\t\tif (gantt.config.show_tasks_outside_timescale) {\n\t\t\treturn true;\n\t\t}\n\t\tvar min = null, max = null;\n\t\tif (gantt.config.start_date && gantt.config.end_date) {\n\t\t\tif (gantt._isAllowedUnscheduledTask(task)) return true;\n\t\t\tmin = gantt.config.start_date.valueOf();\n\t\t\tmax = gantt.config.end_date.valueOf();\n\n\t\t\tif (+task.start_date > max || +task.end_date < +min)\n\t\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t});\n\n\ttasksStore.attachEvent(\"onIdChange\", function(oldId, newId){\n\t\tgantt._update_flags(oldId, newId);\n\n\t\tvar changedTask = gantt.getTask(newId);\n\t\tif(!tasksStore.isSilent()){\n\t\t\tif(changedTask.$split_subtask || changedTask.rollup){\n\t\t\t\tgantt.eachParent(function(parent){\n\t\t\t\t\tgantt.refreshTask(parent.id);\n\t\t\t\t}, newId);\n\t\t\t}\n\t\t}\n\t});\n\n\ttasksStore.attachEvent(\"onAfterUpdate\", function(id){\n\t\tgantt._update_parents(id);\n\t\tif(gantt.getState(\"batchUpdate\").batch_update){\n\t\t\treturn true;\n\t\t}\n\n\t\tvar task = tasksStore.getItem(id);\n\t\tif (!task.$source) task.$source = [];\n\t\tfor (var i = 0; i < task.$source.length; i++) {\n\t\t\tlinksStore.refresh(task.$source[i]);\n\t\t}\n\t\tif (!task.$target) task.$target = [];\n\t\tfor (var i = 0; i < task.$target.length; i++) {\n\t\t\tlinksStore.refresh(task.$target[i]);\n\t\t}\n\t});\n\n\ttasksStore.attachEvent(\"onBeforeItemMove\", function(sid, parent, tindex){\n\t\t// GS-125. Don't allow users to move the placeholder task\n\t\tif (isPlaceholderTask(sid, gantt, tasksStore)){\n\t\t\t//eslint-disable-next-line\n\t\t\tconsole.log(\"The placeholder task cannot be moved to another position.\");\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t});\n\n\ttasksStore.attachEvent(\"onAfterItemMove\", function(sid, parent, tindex){\n\t\tvar source = gantt.getTask(sid);\n\n\t\tif(this.getNextSibling(sid) !== null){\n\t\t\tsource.$drop_target = this.getNextSibling(sid);\n\t\t} else if(this.getPrevSibling(sid) !== null){\n\t\t\tsource.$drop_target = \"next:\" + this.getPrevSibling(sid);\n\t\t}else{\n\t\t\tsource.$drop_target = \"next:null\";\n\t\t}\n\n\t});\n\n\ttasksStore.attachEvent(\"onStoreUpdated\", function(id, item, action){\n\t\tif(action == \"delete\"){\n\t\t\tgantt._update_flags(id, null);\n\t\t}\n\n\t\tvar state = gantt.$services.getService(\"state\");\n\t\tif(state.getState(\"batchUpdate\").batch_update){\n\t\t\treturn;\n\t\t}\n\n\t\tif(gantt.config.fit_tasks && action !== \"paint\"){\n\t\t\tvar oldState = gantt.getState();\n\t\t\tcalculateScaleRange(gantt);\n\t\t\tvar newState = gantt.getState();\n\n\t\t\t//this._init_tasks_range();\n\t\t\tif (+oldState.min_date != +newState.min_date || +oldState.max_date != +newState.max_date) {\n\t\t\t\tgantt.render();\n\n\t\t\t\tgantt.callEvent(\"onScaleAdjusted\", []);\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t}\n\n\t\tif(action == \"add\" || action == \"move\" || action == \"delete\"){\n\t\t\tif(gantt.$layout){\n\t\t\t\t// GS-2170. Do not recalculate the indexes and dates of other tasks in the\n\t\t\t\t// onBeforeResize layout event, but do it later. If lightbox is opened, it will\n\t\t\t\t// trigger the refreshData, so the indexes and dates will be recalculated there\n\t\t\t\tif (this.$config.name == \"task\" && (action == \"add\" || action == \"delete\")){\n\t\t\t\t\tif (this._skipTaskRecalculation != \"lightbox\"){\n\t\t\t\t\t\tthis._skipTaskRecalculation = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tgantt.$layout.resize();\n\t\t\t}\n\n\t\t}else if(!id){\n\t\t\tlinksStore.refresh();\n\t\t}\n\n\t});\n\n\tlinksStore.attachEvent(\"onAfterAdd\", function(id, link){\n\t\tlinksStore.sync_link(link);\n\t});\n\tlinksStore.attachEvent(\"onAfterUpdate\", function(id, link){\n\t\tsync_links();\n\t});\n\tlinksStore.attachEvent(\"onAfterDelete\", function(id, link){\n\t\tsync_link_delete(link);\n\t});\n\tlinksStore.attachEvent(\"onAfterSilentDelete\", function(id, link){\n\t\tsync_link_delete(link);\n\t});\n\tlinksStore.attachEvent(\"onBeforeIdChange\", function(oldId, newId){\n\t\tsync_link_delete(gantt.mixin({id:oldId}, gantt.$data.linksStore.getItem(newId)));\n\t\tlinksStore.sync_link(gantt.$data.linksStore.getItem(newId));\n\t});\n\n\tfunction checkLinkedTaskVisibility(taskId){\n\t\tvar isVisible = gantt.isTaskVisible(taskId);\n\t\tif(!isVisible && gantt.isTaskExists(taskId)){\n\t\t\tvar parent = gantt.getParent(taskId);\n\t\t\tif(gantt.isTaskExists(parent) && gantt.isTaskVisible(parent)){\n\t\t\t\tparent = gantt.getTask(parent);\n\t\t\t\tif(gantt.isSplitTask(parent)){\n\t\t\t\t\tisVisible = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn isVisible;\n\t}\n\n\tlinksStore.attachEvent(\"onFilterItem\", function(id, link){\n\t\tif (!gantt.config.show_links) {\n\t\t\treturn false;\n\t\t}\n\n\t\tvar sourceVisible = checkLinkedTaskVisibility(link.source);\n\t\tvar targetVisible = checkLinkedTaskVisibility(link.target);\n\n\t\tif (!(sourceVisible && targetVisible) ||\n\t\t\tgantt._isAllowedUnscheduledTask(gantt.getTask(link.source)) || gantt._isAllowedUnscheduledTask(gantt.getTask(link.target)))\n\t\t\treturn false;\n\n\t\treturn gantt.callEvent(\"onBeforeLinkDisplay\", [id, link]);\n\t});\n\n\n\t(function(){\n\t\t// delete all connected links after task is deleted\n\t\tvar deletedLinks = {};\n\n\t\tgantt.attachEvent(\"onBeforeTaskDelete\", function(id, item){\n\t\t\tdeletedLinks[id] = treeHelper.getSubtreeLinks(gantt, id);\n\t\t\treturn true;\n\t\t});\n\n\t\tgantt.attachEvent(\"onAfterTaskDelete\", function(id, item) {\n\t\t\tif(deletedLinks[id]){\n\t\t\t\tgantt.$data.linksStore.silent(function(){\n\t\t\t\t\tfor(var i in deletedLinks[id]){\n\t\t\t\t\t\tif (gantt.isLinkExists(i)){\n\t\t\t\t\t\t\tgantt.$data.linksStore.removeItem(i);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tsync_link_delete(deletedLinks[id][i]);\n\t\t\t\t\t}\n\n\t\t\t\t\tdeletedLinks[id] = null;\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t})();\n\n\tgantt.attachEvent(\"onAfterLinkDelete\", function(id, link) {\n\t\t// GS-1786. Repaint tasks only if they are loaded\n\t\tif(gantt.isTaskExists(link.source)){\n\t\t\tgantt.refreshTask(link.source);\n\t\t}\n\t\tif(gantt.isTaskExists(link.target)){\n\t\t\tgantt.refreshTask(link.target);\n\t\t}\n\t});\n\n\tgantt.attachEvent(\"onParse\", sync_links);\n\n\tmapEvents({\n\t\tsource: linksStore,\n\t\ttarget: gantt,\n\t\tevents:{\n\t\t\t\"onItemLoading\":\"onLinkLoading\",\n\t\t\t\"onBeforeAdd\":\"onBeforeLinkAdd\",\n\t\t\t\"onAfterAdd\":\"onAfterLinkAdd\",\n\t\t\t\"onBeforeUpdate\":\"onBeforeLinkUpdate\",\n\t\t\t\"onAfterUpdate\":\"onAfterLinkUpdate\",\n\t\t\t\"onBeforeDelete\":\"onBeforeLinkDelete\",\n\t\t\t\"onAfterDelete\":\"onAfterLinkDelete\",\n\t\t\t\"onIdChange\":\"onLinkIdChange\"\n\t\t}\n\t});\n\n\tmapEvents({\n\t\tsource: tasksStore,\n\t\ttarget: gantt,\n\t\tevents:{\n\t\t\t\"onItemLoading\":\"onTaskLoading\",\n\t\t\t\"onBeforeAdd\":\"onBeforeTaskAdd\",\n\t\t\t\"onAfterAdd\":\"onAfterTaskAdd\",\n\t\t\t\"onBeforeUpdate\":\"onBeforeTaskUpdate\",\n\t\t\t\"onAfterUpdate\":\"onAfterTaskUpdate\",\n\t\t\t\"onBeforeDelete\":\"onBeforeTaskDelete\",\n\t\t\t\"onAfterDelete\":\"onAfterTaskDelete\",\n\t\t\t\"onIdChange\":\"onTaskIdChange\",\n\t\t\t\"onBeforeItemMove\":\"onBeforeTaskMove\",\n\t\t\t\"onAfterItemMove\":\"onAfterTaskMove\",\n\t\t\t\"onFilterItem\":\"onBeforeTaskDisplay\",\n\t\t\t\"onItemOpen\":\"onTaskOpened\",\n\t\t\t\"onItemClose\":\"onTaskClosed\",\n\t\t\t\"onBeforeSelect\":\"onBeforeTaskSelected\",\n\t\t\t\"onAfterSelect\":\"onTaskSelected\",\n\t\t\t\"onAfterUnselect\":\"onTaskUnselected\"\n\t\t}\n\t});\n\n\tgantt.$data = {\n\t\ttasksStore: tasksStore,\n\t\tlinksStore: linksStore\n\t};\n\n\tlinksStore.sync_link = function(link) {\n\t\tif(gantt.isTaskExists(link.source)){\n\t\t\tvar sourceTask = gantt.getTask(link.source);\n\t\t\tsourceTask.$source = sourceTask.$source || [];\n\t\t\tif (noDuplicateIds(link.id, sourceTask.$source)){\n\t\t\t\tsourceTask.$source.push(link.id);\n\t\t\t}\n\t\t}\n\t\tif(gantt.isTaskExists(link.target)){\n\t\t\tvar targetTask = gantt.getTask(link.target);\n\t\t\ttargetTask.$target = targetTask.$target || [];\n\t\t\tif (noDuplicateIds(link.id, targetTask.$target)){\n\t\t\t\ttargetTask.$target.push(link.id);\n\t\t\t}\n\t\t}\n\t};\n\t// GS-2085. Don't add duplicate link IDs\n\tfunction noDuplicateIds(id, array){\n\t\treturn array.indexOf(String(id)) === -1 && array.indexOf(Number(id)) === -1;\n\t}\n\n\tfunction sync_link_delete(link){\n\t\tif(gantt.isTaskExists(link.source)){\n\t\t\tvar sourceTask = gantt.getTask(link.source);\n\t\t\tfor(var i = 0; i < sourceTask.$source.length; i++){\n\t\t\t\tif(sourceTask.$source[i] == link.id){\n\t\t\t\t\tsourceTask.$source.splice(i, 1);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif(gantt.isTaskExists(link.target)){\n\t\t\tvar targetTask = gantt.getTask(link.target);\n\t\t\tfor(var i = 0; i < targetTask.$target.length; i++){\n\t\t\t\tif(targetTask.$target[i] == link.id){\n\t\t\t\t\ttargetTask.$target.splice(i, 1);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction sync_links() {\n\t\tvar task = null;\n\t\tvar tasks = gantt.$data.tasksStore.getItems();\n\n\t\tfor(var i = 0, len = tasks.length; i < len; i++){\n\t\t\ttask = tasks[i];\n\t\t\ttask.$source = [];\n\t\t\ttask.$target = [];\n\t\t}\n\n\t\tvar links = gantt.$data.linksStore.getItems();\n\t\tfor (var i = 0, len = links.length; i < len; i++) {\n\n\t\t\tvar link = links[i];\n\t\t\tlinksStore.sync_link(link);\n\t\t}\n\t}\n\n\tfunction mapEvents(conf){\n\t\tvar mapFrom = conf.source;\n\t\tvar mapTo = conf.target;\n\t\tfor(var i in conf.events){\n\t\t\t(function(sourceEvent, targetEvent){\n\t\t\t\tmapFrom.attachEvent(sourceEvent, function(){\n\t\t\t\t\treturn mapTo.callEvent(targetEvent, Array.prototype.slice.call(arguments));\n\t\t\t\t}, targetEvent);\n\t\t\t})(i, conf.events[i]);\n\t\t}\n\t}\n\n\tfunction _init_task(task) {\n\t\tif (!this.defined(task.id))\n\t\t\ttask.id = this.uid();\n\n\t\tif (task.start_date)\n\t\t\ttask.start_date = gantt.date.parseDate(task.start_date, \"parse_date\");\n\t\tif (task.end_date)\n\t\t\ttask.end_date = gantt.date.parseDate(task.end_date, \"parse_date\");\n\n\n\t\tvar duration = null;\n\t\tif (task.duration || task.duration === 0) {\n\t\t\ttask.duration = duration = task.duration * 1;\n\t\t}\n\n\t\tif (duration) {\n\t\t\tif (task.start_date && !task.end_date) {\n\t\t\t\ttask.end_date = this.calculateEndDate(task);\n\t\t\t} else if (!task.start_date && task.end_date) {\n\t\t\t\ttask.start_date = this.calculateEndDate({\n\t\t\t\t\tstart_date: task.end_date,\n\t\t\t\t\tduration: -task.duration,\n\t\t\t\t\ttask: task\n\t\t\t\t});\n\t\t\t}\n\t\t\t//task.$calculate_duration = false;\n\t\t}\n\n\t\tif (gantt.config.deadlines !== false && task.deadline){\n\t\t\ttask.deadline = gantt.date.parseDate(task.deadline, \"parse_date\");\n\t\t}\n\n\t\ttask.progress = Number(task.progress) || 0;\n\n\t\tif (this._isAllowedUnscheduledTask(task)) {\n\t\t\tthis._set_default_task_timing(task);\n\t\t}\n\t\tthis._init_task_timing(task);\n\t\tif (task.start_date && task.end_date)\n\t\t\tthis.correctTaskWorkTime(task);\n\n\t\ttask.$source = [];\n\t\ttask.$target = [];\n\n\t\tvar originalTask = this.$data.tasksStore.getItem(task.id);\n\t\tif (originalTask && !utils.defined(task.open)) {\n\t\t\t// if a task with the same id is already in the gantt and the new object doesn't specify the `open` state -\n\t\t\t// restore the `open` state we already have in the chart\n\t\t\ttask.$open = originalTask.$open;\n\t\t}\n\n\t\tif (task.parent === undefined) {\n\t\t\ttask.parent = this.config.root_id;\n\t\t}\n\t\tif(task.open){\n\t\t\ttask.$open = true;\n\t\t}\n\t\treturn task;\n\t}\n\n\tfunction _init_link(link) {\n\t\tif (!this.defined(link.id))\n\t\t\tlink.id = this.uid();\n\t\treturn link;\n\t}\n}\n\n\nexport default initDataStores;\n","import batch_update from \"./batch_update\";\nimport wbs from \"./wbs\";\nimport resources from \"./resources\";\nimport resource_assignments from \"./resource_assignments\";\nimport new_task_placeholder from \"./new_task_placeholder\";\nimport auto_task_types from \"./auto_task_types\";\nimport formatters from \"./formatters\";\nimport empty_state_screen from \"./empty_state_screen\";\nimport baselines from \"./baselines\";\nimport remote_events from \"./remote_events/index\";\nimport auto_scheduling_config from \"./auto_scheduling_config\";\n\nexport default function(gantt){\n\tif(!gantt.ext){\n\t\tgantt.ext = {};\n\t}\n\n\tvar modules = [\n\t\tbatch_update,\n\t\twbs,\n\t\tresources,\n\t\tresource_assignments,\n\t\tnew_task_placeholder,\n\t\tauto_task_types,\n\t\tformatters,\n\t\tempty_state_screen,\n\t\tbaselines,\n\t\tremote_events\n\t];\n\n\tfor(var i = 0; i < modules.length; i++){\n\t\tif(modules[i])\n\t\t\tmodules[i](gantt);\n\t}\n\n\tconst { getAutoSchedulingConfig} = auto_scheduling_config(gantt);\n\tgantt._getAutoSchedulingConfig = getAutoSchedulingConfig;\n};","import Grid from \"./ui/grid/grid\";\nimport gridColumnApiGPL from \"./grid_column_api.gpl\";\n\nexport default function(gantt) {\n\tgridColumnApiGPL(gantt);\n\tGrid.prototype.getGridColumns = function () {\n\t\tvar config = this.$getConfig();\n\t\tvar columns = config.columns,\n\t\t\tvisibleColumns = [];\n\n\t\tfor (var i = 0; i < columns.length; i++) {\n\t\t\tif (!columns[i].hide)\n\t\t\t\tvisibleColumns.push(columns[i]);\n\t\t}\n\n\t\treturn visibleColumns;\n\t};\n};","export default function(gantt) {\n\tgantt.getGridColumn = function(name) {\n\t\tvar columns = gantt.config.columns;\n\n\t\tfor (var i = 0; i < columns.length; i++) {\n\t\t\tif (columns[i].name == name)\n\t\t\t\treturn columns[i];\n\t\t}\n\n\t\treturn null;\n\t};\n\n\tgantt.getGridColumns = function() {\n\t\treturn gantt.config.columns.slice();\n\t};\n};","export default function(gantt) {\n\tgantt.isReadonly = function (item) {\n\n\t\tif((typeof item == \"number\" || typeof item == \"string\") && gantt.isTaskExists(item)){\n\t\t\titem = gantt.getTask(item);\n\t\t}\n\t\tif (item && item[this.config.editable_property]) {\n\t\t\treturn false;\n\t\t} else {\n\t\t\treturn (item && item[this.config.readonly_property]) || this.config.readonly;\n\t\t}\n\t};\n};","import CalendarManager from \"./calendar_manager\";\nimport TimeCalculator from \"./time_calculator\";\nimport worktimeFacadeFactory from \"../facades/worktime_calendars\";\nimport * as utils from \"../../utils/utils\";\n\nexport default function (gantt) {\n\tvar manager = new CalendarManager(gantt),\n\ttimeCalculator = new TimeCalculator(manager);\n\tvar facade = worktimeFacadeFactory.create(manager, timeCalculator);\n\tutils.mixin(gantt, facade);\n};\n","export default function(gantt) {\n\tgantt.getTaskType = function (type) {\n\t\tvar checkType = type;\n\t\tif(type && typeof type == \"object\"){\n\t\t\tcheckType = type.type;\n\t\t}\n\n\t\tfor (var i in this.config.types) {\n\t\t\tif (this.config.types[i] == checkType) {\n\t\t\t\treturn checkType;\n\t\t\t}\n\t\t}\n\t\treturn gantt.config.types.task;\n\t};\n};","/*\n reuse results of functions that can be recalculated during rendering\n greatly increases the rendering speed when critical path enabled\n Sample - 94_dev/critical_path.html\n\n */\nexport default function(gantt){\n\ngantt._cached_functions = {\n\tcache: {},\n\tmode: false,\n\tcritical_path_mode: false,\n\twrap_methods : function(methods, object){\n\t\tif(object._prefetch_originals){\n\t\t\tfor(var i in object._prefetch_originals){\n\t\t\t\tobject[i] = object._prefetch_originals[i];\n\t\t\t}\n\t\t}\n\t\tobject._prefetch_originals = {};\n\t\tfor(var i = 0; i < methods.length; i++)\n\t\t\tthis.prefetch(methods[i], object);\n\n\t},\n\tprefetch : function(methodname, host){\n\t\tvar original = host[methodname];\n\t\tif(original){\n\t\t\tvar optimizer = this;\n\n\t\t\thost._prefetch_originals[methodname] = original;\n\t\t\thost[methodname] = function get_prefetched_value(){\n\n\t\t\t\tvar argumentsArray = new Array(arguments.length);\n\t\t\t\tfor (var i = 0, l = arguments.length; i < l; i++) {\n\t\t\t\t\targumentsArray[i] = arguments[i];\n\t\t\t\t}\n\n\t\t\t\tif(optimizer.active){\n\t\t\t\t\tvar args = optimizer.get_arguments_hash(Array.prototype.slice.call(argumentsArray));\n\t\t\t\t\tif(!optimizer.cache[methodname]){\n\t\t\t\t\t\toptimizer.cache[methodname] = {};\n\t\t\t\t\t}\n\n\t\t\t\t\tvar cached_values = optimizer.cache[methodname];\n\n\t\t\t\t\tif(optimizer.has_cached_value(cached_values, args)){\n\t\t\t\t\t\treturn optimizer.get_cached_value(cached_values, args);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tvar value = original.apply(this, argumentsArray);\n\t\t\t\t\t\toptimizer.cache_value(cached_values, args, value);\n\t\t\t\t\t\treturn value;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn original.apply(this, argumentsArray);\n\t\t\t};\n\t\t}\n\t\treturn original;\n\t},\n\tcache_value: function(cache, arguments_hash, value){\n\t\tif(this.is_date(value))\n\t\t\tvalue = new Date(value);\n\t\tcache[arguments_hash] = value;\n\t},\n\thas_cached_value: function(cache, arguments_hash){\n\t\treturn cache.hasOwnProperty(arguments_hash);\n\t},\n\tget_cached_value: function(cache, arguments_hash){\n\t\tvar data = cache[arguments_hash];\n\n\t\t//for cached dates - return copy\n\t\tif(this.is_date(data)){\n\t\t\tdata = new Date(data);\n\t\t}\n\t\treturn data;\n\t},\n\tis_date: function(value){\n\t\treturn (value && value.getUTCDate);\n\t},\n\tget_arguments_hash:function(args){\n\t\tvar values = [];\n\t\tfor(var i = 0; i < args.length; i++){\n\t\t\tvalues.push(this.stringify_argument(args[i]));\n\t\t}\n\t\treturn \"(\" + values.join(\";\") + \")\";\n\t},\n\tstringify_argument: function(value){\n\t\t//expecting task or link, or any other data entries, dates and primitive values\n\t\tvar ret = \"\";\n\t\tif(value.id){\n\t\t\tret = value.id;\n\t\t}else if(this.is_date(value)){\n\t\t\tret = value.valueOf();\n\t\t}else{\n\t\t\tret = value;\n\t\t}\n\t\treturn ret + \"\";\n\t},\n\tactivate: function(){\n\t\tthis.clear();\n\t\tthis.active = true;\n\t},\n\tdeactivate: function(){\n\t\tthis.clear();\n\t\tthis.active = false;\n\t},\n\tclear: function(){\n\t\tthis.cache = {};\n\t},\n\n\tsetup: function(gantt){\n\t\tvar override_gantt = [];\n\n\t\tvar gantt_methods  = [\n\t\t\t'_isProjectEnd',\n\t\t\t'_getProjectEnd',\n\t\t\t'_getSlack'\n\t\t];\n\n\n\n\t\tif(this.mode == 'auto'){\n\t\t\tif(gantt.config.highlight_critical_path){\n\t\t\t\toverride_gantt = gantt_methods;\n\t\t\t}\n\t\t}else if(this.mode === true){\n\t\t\toverride_gantt = gantt_methods;\n\t\t}\n\n\t\tthis.wrap_methods(override_gantt, gantt);\n\n\t},\n\tupdate_if_changed: function(gantt){\n\t\tvar changed = (this.critical_path_mode != gantt.config.highlight_critical_path ||\n\t\t\t\t\t\tthis.mode !== gantt.config.optimize_render);\n\t\tif(changed){\n\t\t\tthis.critical_path_mode = gantt.config.highlight_critical_path;\n\t\t\tthis.mode = gantt.config.optimize_render;\n\t\t\tthis.setup(gantt);\n\t\t}\n\t}\n};\n\nfunction activate(){\n\tgantt._cached_functions.update_if_changed(gantt);\n\tif(!gantt._cached_functions.active){\n\t\tgantt._cached_functions.activate();\n\t}\n\treturn true;\n}\ngantt.attachEvent(\"onBeforeGanttRender\", activate);\ngantt.attachEvent(\"onBeforeDataRender\", activate);\ngantt.attachEvent(\"onBeforeSmartRender\",  function(){\n\tactivate();\n});\ngantt.attachEvent(\"onBeforeParse\", activate);\ngantt.attachEvent(\"onDataRender\", function(){\n\tgantt._cached_functions.deactivate();\n});\nvar deactivTimeout = null;\ngantt.attachEvent(\"onSmartRender\", function(){\n\tif(deactivTimeout)\n\t\tclearTimeout(deactivTimeout);\n\tdeactivTimeout = setTimeout(function(){\n\t\tgantt._cached_functions.deactivate();\n\t}, 1000);\n});\n\ngantt.attachEvent(\"onBeforeGanttReady\", function(){\n\tgantt._cached_functions.update_if_changed(gantt);\n\treturn true;\n});\n\n};","function extend(gantt){\n\n\tgantt.destructor = function(){\n\t\tthis.clearAll();\n\t\tthis.callEvent(\"onDestroy\", []);\n\n\t\tthis._getDatastores().forEach(function(store){\n\t\t\tstore.destructor();\n\t\t});\n\n\t\tif(this.$root){\n\t\t\tdelete this.$root.gantt;\n\t\t}\n\n\t\tif(this._eventRemoveAll){\n\t\t\tthis._eventRemoveAll();\n\t\t}\n\n\t\tif(this.$layout){\n\t\t\tthis.$layout.destructor();\n\t\t}\n\n\t\tif(this.resetLightbox){\n\t\t\tthis.resetLightbox();\n\t\t}\n\n\t\t// GS-99. Call this here to detach the events\n\t\tif (this.ext.inlineEditors && this.ext.inlineEditors.destructor) {\n\t\t\tthis.ext.inlineEditors.destructor();\n\t\t}\n\n\t\tif(this._dp && this._dp.destructor){\n\t\t\tthis._dp.destructor();\n\t\t}\n\t\tthis.$services.destructor();\n\n\t\t// detachAllEvents should be called last, because in components may be attached events\n\t\tthis.detachAllEvents();\n\n\t\tfor(var i in this){\n\t\t\tif(i.indexOf(\"$\") === 0){\n\t\t\t\tdelete this[i];\n\t\t\t}\n\t\t}\n\t\tthis.$destroyed = true;\n\t};\n}\n\nexport default extend;\n","import ar from \"./locale_ar\";\nimport be from \"./locale_be\";\nimport ca from \"./locale_ca\";\nimport cn from \"./locale_cn\";\nimport cs from \"./locale_cs\";\nimport da from \"./locale_da\";\nimport de from \"./locale_de\";\nimport el from \"./locale_el\";\nimport en from \"./locale_en\";\nimport es from \"./locale_es\";\nimport fa from \"./locale_fa\";\nimport fi from \"./locale_fi\";\nimport fr from \"./locale_fr\";\nimport he from \"./locale_he\";\nimport hr from \"./locale_hr\";\nimport hu from \"./locale_hu\";\nimport id from \"./locale_id\";\nimport it from \"./locale_it\";\nimport jp from \"./locale_jp\";\nimport kr from \"./locale_kr\";\n\nimport LocaleManager from \"./locale_manager\";\n\nimport nb from \"./locale_nb\";\nimport nl from \"./locale_nl\";\nimport no from \"./locale_no\";\nimport pl from \"./locale_pl\";\nimport pt from \"./locale_pt\";\nimport ro from \"./locale_ro\";\nimport ru from \"./locale_ru\";\nimport si from \"./locale_si\";\nimport sk from \"./locale_sk\";\nimport sv from \"./locale_sv\";\nimport tr from \"./locale_tr\";\nimport ua from \"./locale_ua\";\n\nexport default function(){\n\treturn new LocaleManager({\n\t\ten,\n\t\tar,\n\t\tbe,\n\t\tca,\n\t\tcn,\n\t\tcs,\n\t\tda,\n\t\tde,\n\t\tel,\n\t\tes,\n\t\tfa,\n\t\tfi,\n\t\tfr,\n\t\the,\n\t\thr,\n\t\thu,\n\t\tid,\n\t\tit,\n\t\tjp,\n\t\tkr,\n\t\tnb,\n\t\tnl,\n\t\tno,\n\t\tpl,\n\t\tpt,\n\t\tro,\n\t\tru,\n\t\tsi,\n\t\tsk,\n\t\tsv,\n\t\ttr,\n\t\tua\n\t});\n}","import * as utils from \"../../utils/utils\";\nimport * as domHelpers from \"./utils/dom_helpers\";\n\nexport default function(gantt) {\n\n\tvar boxAttribute = \"data-dhxbox\";\n\n\tvar _dhx_msg_cfg = null;\n\n\tfunction callback(config, result) {\n\t\tvar usercall = config.callback;\n\t\tmodalBox.hide(config.box);\n\n\t\t_dhx_msg_cfg = config.box = null;\n\t\tif (usercall)\n\t\t\tusercall(result);\n\t}\n\n\tfunction modal_key(event) {\n\t\tif (_dhx_msg_cfg) {\n\n\t\t\tvar code = event.which || event.keyCode;\n\t\t\tvar preventDefault = false;\n\n\t\t\tif (messageBox.keyboard) {\n\t\t\t\tif (code == 13 || code == 32) {\n\t\t\t\t\t// default behavior is to confirm/submit popup on space/enter\n\t\t\t\t\t// if browser focus is set on button element - do button click instead of default behavior\n\t\t\t\t\tvar target = event.target || event.srcElement;\n\t\t\t\t\tif (domHelpers.getClassName(target).indexOf(\"gantt_popup_button\") > -1 && target.click) {\n\t\t\t\t\t\ttarget.click();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcallback(_dhx_msg_cfg, true);\n\t\t\t\t\t\tpreventDefault = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (code == 27) {\n\t\t\t\t\tcallback(_dhx_msg_cfg, false);\n\t\t\t\t\tpreventDefault = true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (preventDefault) {\n\t\t\t\tif (event.preventDefault){\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t}\n\t\t\t\treturn !(event.cancelBubble = true);\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t}\n\tvar eventElement = domHelpers.getRootNode(gantt.$root) || document;\n\tgantt.event(eventElement, \"keydown\", modal_key, true);\n\n\tfunction modality(mode) {\n\t\tif (!modality.cover) {\n\t\t\tmodality.cover = document.createElement(\"div\");\n\t\t\t//necessary for IE only\n\t\t\tmodality.cover.onkeydown = modal_key;\n\t\t\tmodality.cover.className = \"dhx_modal_cover\";\n\t\t\tdocument.body.appendChild(modality.cover);\n\t\t}\n\n\t\tmodality.cover.style.display = mode ? \"inline-block\" : \"none\";\n\t}\n\n\tfunction button(text, className, result) {\n\t\tvar buttonAriaAttrs = gantt._waiAria.messageButtonAttrString(text);\n\t\tvar name = className.toLowerCase().replace(/ /g, \"_\");\n\t\tvar button_css = \"gantt_\" + name + \"_button\";\n\t\treturn \"<div \" + buttonAriaAttrs + \" class='gantt_popup_button \" + button_css + \"' data-result='\" + result + \"' result='\" + result + \"' ><div>\" + text + \"</div></div>\";\n\t}\n\n\tfunction info(text) {\n\t\tif (!messageBox.area) {\n\t\t\tmessageBox.area = document.createElement(\"div\");\n\t\t\tmessageBox.area.className = \"gantt_message_area\";\n\t\t\tmessageBox.area.style[messageBox.position] = \"5px\";\n\t\t}\n\t\tif (!domHelpers.isChildOf(messageBox.area, document.body)){\n\t\t\tdocument.body.appendChild(messageBox.area);\n\t\t}\n\n\t\tmessageBox.hide(text.id);\n\t\tvar message = document.createElement(\"div\");\n\t\tmessage.innerHTML = \"<div>\" + text.text + \"</div>\";\n\t\tmessage.className = \"gantt-info gantt-\" + text.type;\n\t\tmessage.onclick = function () {\n\t\t\tmessageBox.hide(text.id);\n\t\t\ttext = null;\n\t\t};\n\n\t\tgantt._waiAria.messageInfoAttr(message);\n\n\t\tif (messageBox.position == \"bottom\" && messageBox.area.firstChild)\n\t\t\tmessageBox.area.insertBefore(message, messageBox.area.firstChild);\n\t\telse\n\t\t\tmessageBox.area.appendChild(message);\n\n\t\tif (text.expire > 0)\n\t\t\tmessageBox.timers[text.id] = window.setTimeout(function () {\n\t\t\t\t// GS-1213: We need that when Gantt is destroyed\n\t\t\t\tif (messageBox) messageBox.hide(text.id);\n\t\t\t}, text.expire);\n\n\t\tmessageBox.pull[text.id] = message;\n\t\tmessage = null;\n\n\t\treturn text.id;\n\t}\n\n\tfunction getFirstDefined() {\n\t\tvar values = [].slice.apply(arguments, [0]);\n\n\t\tfor (var i = 0; i < values.length; i++) {\n\t\t\tif (values[i]) {\n\t\t\t\treturn values[i];\n\t\t\t}\n\t\t}\n\n\t}\n\n\tfunction _boxStructure(config, ok, cancel) {\n\t\tvar box = document.createElement(\"div\");\n\n\t\tvar contentId = utils.uid();\n\t\tgantt._waiAria.messageModalAttr(box, contentId);\n\n\n\t\tbox.className = \" gantt_modal_box gantt-\" + config.type;\n\t\tbox.setAttribute(boxAttribute, 1);\n\n\t\tvar inner = '';\n\n\t\tif (config.width)\n\t\t\tbox.style.width = config.width;\n\t\tif (config.height)\n\t\t\tbox.style.height = config.height;\n\t\tif (config.title)\n\t\t\tinner += '<div class=\"gantt_popup_title\">' + config.title + '</div>';\n\t\tinner += '<div class=\"gantt_popup_text\" id=\"' + contentId + '\"><span>' + (config.content ? '' : config.text) + '</span></div><div  class=\"gantt_popup_controls\">';\n\t\tif (ok)\n\t\t\tinner += button(getFirstDefined(config.ok, gantt.locale.labels.message_ok, \"OK\"), \"ok\", true);\n\t\tif (cancel)\n\t\t\tinner += button(getFirstDefined(config.cancel, gantt.locale.labels.message_cancel, \"Cancel\"), \"cancel\", false);\n\n\t\tif (config.buttons) {\n\t\t\tfor (var i = 0; i < config.buttons.length; i++) {\n\t\t\t\tvar btn = config.buttons[i];\n\t\t\t\tif (typeof btn == \"object\") {\n\t\t\t\t\t// Support { label:\"Save\", css:\"main_button\", value:\"save\" }\n\t\t\t\t\tvar label = btn.label;\n\t\t\t\t\tvar css = btn.css || (\"gantt_\" + btn.label.toLowerCase() + \"_button\");\n\t\t\t\t\tvar value = btn.value || i;\n\t\t\t\t\tinner += button(label, css, value);\n\t\t\t\t} else {\n\t\t\t\t\tinner += button(btn, btn, i);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tinner += '</div>';\n\t\tbox.innerHTML = inner;\n\n\t\tif (config.content) {\n\t\t\tvar node = config.content;\n\t\t\tif (typeof node == \"string\")\n\t\t\t\tnode = document.getElementById(node);\n\t\t\tif (node.style.display == 'none')\n\t\t\t\tnode.style.display = \"\";\n\t\t\tbox.childNodes[config.title ? 1 : 0].appendChild(node);\n\t\t}\n\n\t\tbox.onclick = function (event) {\n\t\t\tvar source = event.target || event.srcElement;\n\t\t\tif (!source.className) source = source.parentNode;\n\t\t\tif (domHelpers.closest(source, \".gantt_popup_button\")) {\n\t\t\t\tvar result = source.getAttribute(\"data-result\");\n\t\t\t\tresult = (result == \"true\") || (result == \"false\" ? false : result);\n\t\t\t\tcallback(config, result);\n\t\t\t}\n\t\t};\n\t\tconfig.box = box;\n\t\tif (ok || cancel)\n\t\t\t_dhx_msg_cfg = config;\n\n\t\treturn box;\n\t}\n\n\tfunction _createBox(config, ok, cancel) {\n\t\tvar box = config.tagName ? config : _boxStructure(config, ok, cancel);\n\n\t\tif (!config.hidden)\n\t\t\tmodality(true);\n\t\tdocument.body.appendChild(box);\n\t\tvar x = Math.abs(Math.floor(((window.innerWidth || document.documentElement.offsetWidth) - box.offsetWidth) / 2));\n\t\tvar y = Math.abs(Math.floor(((window.innerHeight || document.documentElement.offsetHeight) - box.offsetHeight) / 2));\n\t\tif (config.position == \"top\")\n\t\t\tbox.style.top = \"-3px\";\n\t\telse\n\t\t\tbox.style.top = y + 'px';\n\t\tbox.style.left = x + 'px';\n\t\t//necessary for IE only\n\t\tbox.onkeydown = modal_key;\n\n\t\tmodalBox.focus(box);\n\n\t\tif (config.hidden)\n\t\t\tmodalBox.hide(box);\n\n\t\tgantt.callEvent(\"onMessagePopup\", [box]);\n\t\treturn box;\n\t}\n\n\tfunction alertPopup(config) {\n\t\treturn _createBox(config, true, false);\n\t}\n\n\tfunction confirmPopup(config) {\n\t\treturn _createBox(config, true, true);\n\t}\n\n\tfunction boxPopup(config) {\n\t\treturn _createBox(config);\n\t}\n\n\tfunction box_params(text, type, callback) {\n\t\tif (typeof text != \"object\") {\n\t\t\tif (typeof type == \"function\") {\n\t\t\t\tcallback = type;\n\t\t\t\ttype = \"\";\n\t\t\t}\n\t\t\ttext = {text: text, type: type, callback: callback};\n\t\t}\n\t\treturn text;\n\t}\n\n\tfunction params(text, type, expire, id) {\n\t\tif (typeof text != \"object\")\n\t\t\ttext = {text: text, type: type, expire: expire, id: id};\n\t\ttext.id = text.id || utils.uid();\n\t\ttext.expire = text.expire || messageBox.expire;\n\t\treturn text;\n\t}\n\n\tvar alertBox = function () {\n\t\tvar text = box_params.apply(this, arguments);\n\t\ttext.type = text.type || \"confirm\";\n\t\treturn alertPopup(text);\n\t};\n\tvar confirmBox = function () {\n\t\tvar text = box_params.apply(this, arguments);\n\t\ttext.type = text.type || \"alert\";\n\t\treturn confirmPopup(text);\n\t};\n\tvar modalBox = function () {\n\t\tvar text = box_params.apply(this, arguments);\n\t\ttext.type = text.type || \"alert\";\n\t\treturn boxPopup(text);\n\t};\n\tmodalBox.hide = function (node) {\n\t\twhile (node && node.getAttribute && !node.getAttribute(boxAttribute))\n\t\t\tnode = node.parentNode;\n\t\tif (node) {\n\t\t\tnode.parentNode.removeChild(node);\n\t\t\tmodality(false);\n\n\t\t\tgantt.callEvent(\"onAfterMessagePopup\", [node]);\n\t\t}\n\t};\n\n\tmodalBox.focus = function (node) {\n\t\tsetTimeout(function () {\n\t\t\tvar focusable = domHelpers.getFocusableNodes(node);\n\t\t\tif (focusable.length) {\n\t\t\t\tif (focusable[0].focus) focusable[0].focus();\n\t\t\t}\n\t\t}, 1);\n\t};\n\n\tvar messageBox = function (text, type, expire, id) {\n\t\ttext = params.apply(this, arguments);\n\t\ttext.type = text.type || \"info\";\n\n\t\tvar subtype = text.type.split(\"-\")[0];\n\t\tswitch (subtype) {\n\t\t\tcase \"alert\":\n\t\t\t\treturn alertPopup(text);\n\t\t\tcase \"confirm\":\n\t\t\t\treturn confirmPopup(text);\n\t\t\tcase \"modalbox\":\n\t\t\t\treturn boxPopup(text);\n\t\t\tdefault:\n\t\t\t\treturn info(text);\n\t\t}\n\t};\n\n\tmessageBox.seed = (new Date()).valueOf();\n\tmessageBox.uid = utils.uid;\n\tmessageBox.expire = 4000;\n\tmessageBox.keyboard = true;\n\tmessageBox.position = \"top\";\n\tmessageBox.pull = {};\n\tmessageBox.timers = {};\n\n\tmessageBox.hideAll = function () {\n\t\tfor (var key in messageBox.pull)\n\t\t\tmessageBox.hide(key);\n\t};\n\tmessageBox.hide = function (id) {\n\t\tvar obj = messageBox.pull[id];\n\t\tif (obj && obj.parentNode) {\n\t\t\twindow.setTimeout(function () {\n\t\t\t\tobj.parentNode.removeChild(obj);\n\t\t\t\tobj = null;\n\t\t\t}, 2000);\n\t\t\tobj.className += \" hidden\";\n\n\t\t\tif (messageBox.timers[id])\n\t\t\t\twindow.clearTimeout(messageBox.timers[id]);\n\t\t\tdelete messageBox.pull[id];\n\t\t}\n\t};\n\n\tvar popups = [];\n\tgantt.attachEvent(\"onMessagePopup\", function(box){\n\t\tpopups.push(box);\n\t});\n\tgantt.attachEvent(\"onAfterMessagePopup\", function(box){\n\t\tfor(var i = 0; i < popups.length; i++){\n\t\t\tif(popups[i] === box){\n\t\t\t\tpopups.splice(i, 1);\n\t\t\t\ti--;\n\t\t\t}\n\t\t}\n\t});\n\n\tgantt.attachEvent(\"onDestroy\", function(){\n\t\tif(modality.cover && modality.cover.parentNode){\n\t\t\tmodality.cover.parentNode.removeChild(modality.cover);\n\t\t}\n\n\t\tfor(var i = 0; i < popups.length; i++){\n\t\t\tif(popups[i].parentNode){\n\t\t\t\tpopups[i].parentNode.removeChild(popups[i]);\n\t\t\t}\n\t\t}\n\t\tpopups = null;\n\n\t\tif(messageBox.area && messageBox.area.parentNode){\n\t\t\tmessageBox.area.parentNode.removeChild(messageBox.area);\n\t\t}\n\t\tmessageBox = null;\n\t});\n\n\treturn {\n\t\talert: alertBox,\n\t\tconfirm: confirmBox,\n\t\tmessage: messageBox,\n\t\tmodalbox: modalBox\n\t};\n};","import * as utils from \"../../utils/utils\";\n\nfunction extendSettings (store, parentSettings){\n\tvar own = this.$config[store];\n\n\tif(own){\n\t\tif(!own.$extendedConfig){\n\t\t\town.$extendedConfig = true;\n\t\t\tObject.setPrototypeOf(own, parentSettings);\n\t\t}\n\t\treturn own;\n\t}else{\n\t\treturn parentSettings;\n\t}\n}\n\nvar configurable = function(parentView){\n\tvar parentConfig,\n\t\tparentTemplates;\n\n\treturn {\n\t\t$getConfig: function(){\n\t\t\tif(!parentConfig){\n\t\t\t\tparentConfig = parentView ? parentView.$getConfig() : this.$gantt.config;\n\t\t\t}\n\t\t\tif(!this.$config.config){\n\t\t\t\treturn parentConfig;\n\t\t\t}else{\n\t\t\t\treturn extendSettings.call(this, \"config\", parentConfig);\n\t\t\t}\n\t\t},\n\t\t$getTemplates: function(){\n\t\t\tif(!parentTemplates){\n\t\t\t\tparentTemplates = parentView ? parentView.$getTemplates() : this.$gantt.templates;\n\t\t\t}\n\t\t\tif(!this.$config.templates){\n\t\t\t\treturn parentTemplates;\n\t\t\t}else{\n\t\t\t\treturn extendSettings.call(this, \"templates\", parentTemplates);\n\t\t\t}\n\t\t}\n\t};\n};\n\nexport default function(obj, parent){\n\tutils.mixin(obj, configurable(parent));\n};","import * as utils from \"../../utils/utils\";\nimport configurable from \"./configurable\";\n\nvar uiFactory = function createFactory(gantt){\n\tvar views = {};\n\n\tfunction ui(cell, parentView) {\n\t\tvar content;\n\t\tvar view = \"cell\";\n\t\tif (cell.view){\n\t\t\tview = \"viewcell\";\n\t\t}else if (cell.resizer) {\n\t\t\tview = \"resizer\";\n\t\t}\n\t\telse if (cell.rows || cell.cols) {\n\t\t\tview = \"layout\";\n\t\t}\n\t\telse if (cell.views) {\n\t\t\tview = \"multiview\";\n\t\t}\n\n\t\tcontent = createView.call(this, view, null, cell, parentView);\n\t\treturn content;\n\t}\n\t\n\tvar createdViews = {};\n\n\tfunction createView(name, parent, config, parentView) {\n\t\tvar creator = views[name];\n\n\t\tif(!creator || !creator.create)\n\t\t\treturn false;\n\n\t\tif(name == \"resizer\" && !config.mode){\n\t\t\tif(parentView.$config.cols){\n\t\t\t\tconfig.mode = \"x\";\n\t\t\t}else{\n\t\t\t\tconfig.mode = \"y\";\n\t\t\t}\n\t\t}\n\n\t\tif(name == \"viewcell\" && config.view == \"scrollbar\" && !config.scroll){\n\t\t\tif(parentView.$config.cols){\n\t\t\t\tconfig.scroll = \"y\";\n\t\t\t}else{\n\t\t\t\tconfig.scroll = \"x\";\n\t\t\t}\n\t\t}\n\n\t\tvar config = utils.copy(config);\n\n\t\tif(!config.id && !createdViews[config.view]){\n\t\t\tconfig.id = config.view;\n\t\t}\n\n\t\tif(config.id && !config.css){\n\t\t\tconfig.css = config.id+\"_cell\";\n\t\t}\n\n\t\tvar view = new creator.create(parent, config, this, gantt);\n\n\t\tif(creator.configure){\n\t\t\tcreator.configure(view);\n\t\t}\n\n\t\tconfigurable(view, parentView);\n\t\tif(!view.$id){\n\t\t\tview.$id = config.id || gantt.uid();\n\t\t}\n\n\t\tif(!view.$parent && typeof parent == \"object\"){\n\t\t\tview.$parent = parent;\n\t\t}\n\t\tif(!view.$config){\n\t\t\tview.$config = config;\n\t\t}\n\n\t\tif(createdViews[view.$id]){\n\t\t\tview.$id = gantt.uid();\n\t\t}\n\n\t\tcreatedViews[view.$id] = view;\n\n\t\treturn view;\n\t}\n\n\tfunction reset(){\n\t\tcreatedViews = {};\n\t}\n\n\tfunction register(name, viewConstructor, configure){\n\t\tviews[name] = {create: viewConstructor, configure: configure};\n\t}\n\n\tfunction getView(id){\n\t\treturn createdViews[id];\n\t}\n\n\tvar factory = {\n\t\tinitUI:ui,\n\t\treset: reset,\n\t\tregisterView: register,\n\t\tcreateView: createView,\n\t\tgetView: getView\n\t};\n\n\treturn factory;\n};\n\nexport default {\n\tcreateFactory: uiFactory\n};\n\n","import * as domHelpers from \"./utils/dom_helpers\";\n\nvar createMouseHandler = (function(domHelpers) {\n\treturn function (gantt) {\n\t\tvar eventHandlers = {\n\t\t\t\"click\": {},\n\t\t\t\"doubleclick\": {},\n\t\t\t\"contextMenu\": {}\n\t\t};\n\n\t\tfunction addEventTarget(event, className, handler, root) {\n\t\t\tif(!eventHandlers[event][className]){\n\t\t\t\teventHandlers[event][className] = [];\n\t\t\t}\n\n\t\t\teventHandlers[event][className].push({\n\t\t\t\thandler: handler,\n\t\t\t\troot: root\n\t\t\t});\n\t\t}\n\n\t\tfunction callHandler(eventName, className, root, args) {\n\t\t\tvar handlers = eventHandlers[eventName][className];\n\t\t\tif(handlers){\n\t\t\t\tfor(var i = 0; i < handlers.length; i++){\n\t\t\t\t\tif(!(root || handlers[i].root) || handlers[i].root === root){\n\t\t\t\t\t\thandlers[i].handler.apply(this, args);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfunction onClick(e) {\n\t\t\te = e || window.event;\n\t\t\tvar id = gantt.locate(e);\n\n\t\t\tvar handlers = findEventHandlers(e, eventHandlers.click);\n\t\t\tvar res = true;\n\t\t\tif (id !== null) {\n\t\t\t\tres = !gantt.checkEvent(\"onTaskClick\") || gantt.callEvent(\"onTaskClick\", [id, e]);\n\t\t\t} else {\n\t\t\t\tgantt.callEvent(\"onEmptyClick\", [e]);\n\t\t\t}\n\n\t\t\tif (res) {\n\t\t\t\tvar default_action = callEventHandlers(handlers, e, id);\n\t\t\t\tif (!default_action)\n\t\t\t\t\treturn;\n\n\t\t\t\t// GS-1025: if we don't do that, the dropdown or date select will be closed for unselected tasks\n\t\t\t\t// GS-1078: or for the built-in select inline editor\n\t\t\t\tswitch(e.target.nodeName) {\n\t\t\t\t\tcase \"SELECT\":\n\t\t\t\t\tcase 'INPUT':\n\t\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t//allow task selection when the multiselect plugin is not enabled\n\t\t\t\tif (id && gantt.getTask(id) && !gantt._multiselect && gantt.config.select_task) {\n\t\t\t\t\tgantt.selectTask(id);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfunction onContextMenu(e) {\n\t\t\te = e || window.event;\n\t\t\tvar src = e.target || e.srcElement,\n\t\t\t\ttaskId = gantt.locate(src),\n\t\t\t\tlinkId = gantt.locate(src, gantt.config.link_attribute);\n\n\t\t\tvar res = !gantt.checkEvent(\"onContextMenu\") || gantt.callEvent(\"onContextMenu\", [taskId, linkId, e]);\n\t\t\tif (!res) {\n\t\t\t\tif (e.preventDefault)\n\t\t\t\t\te.preventDefault();\n\t\t\t\telse\n\t\t\t\t\te.returnValue = false;\n\t\t\t}\n\t\t\treturn res;\n\t\t}\n\n\t\tfunction findEventHandlers(e, hash){\n\t\t\tvar trg = e.target || e.srcElement;\n\t\t\tvar handlers = [];\n\t\t\twhile (trg) {\n\t\t\t\tvar css = domHelpers.getClassName(trg);\n\t\t\t\tif (css) {\n\t\t\t\t\tcss = css.split(\" \");\n\t\t\t\t\tfor (var i = 0; i < css.length; i++) {\n\t\t\t\t\t\tif (!css[i]) continue;\n\t\t\t\t\t\tif (hash[css[i]]) {\n\t\t\t\t\t\t\tvar delegateHandlers = hash[css[i]];\n\n\t\t\t\t\t\t\tfor(var h = 0; h < delegateHandlers.length; h++){\n\t\t\t\t\t\t\t\tif(delegateHandlers[h].root){\n\t\t\t\t\t\t\t\t\tif(!domHelpers.isChildOf(trg, delegateHandlers[h].root)){\n\t\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\thandlers.push(delegateHandlers[h].handler);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\ttrg = trg.parentNode;\n\t\t\t}\n\t\t\treturn handlers;\n\t\t}\n\n\t\tfunction callEventHandlers(handlers, e, id){\n\t\t\tvar res = true;\n\n\t\t\tfor(var i = 0; i < handlers.length; i++){\n\t\t\t\tvar handlerResult =  handlers[i].call(gantt, e, id, e.target || e.srcElement);\n\t\t\t\tres = res && !(typeof handlerResult != \"undefined\" && handlerResult !== true);\n\t\t\t}\n\n\t\t\treturn res;\n\t\t}\n\n\n\t\tfunction onDoubleClick(e) {\n\t\t\te = e || window.event;\n\t\t\tvar id = gantt.locate(e);\n\n\t\t\tvar handlers = findEventHandlers(e, eventHandlers.doubleclick);\n\t\t\t// when doubleclick fired not on task, id === null\n\t\t\tvar res = !gantt.checkEvent(\"onTaskDblClick\") || id === null || gantt.callEvent(\"onTaskDblClick\", [id, e]);\n\t\t\tif (res) {\n\t\t\t\tvar default_action = callEventHandlers(handlers, e, id);\n\t\t\t\tif (!default_action)\n\t\t\t\t\treturn;\n\n\t\t\t\tif (id !== null && gantt.getTask(id)) {\n\t\t\t\t\tif (res && gantt.config.details_on_dblclick && !gantt.isReadonly(id)) {\n\t\t\t\t\t\tgantt.showLightbox(id);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfunction onMouseMove(e) {\n\t\t\tif (gantt.checkEvent(\"onMouseMove\")) {\n\t\t\t\tvar id = gantt.locate(e);\n\t\t\t\tgantt._last_move_event = e;\n\t\t\t\tgantt.callEvent(\"onMouseMove\", [id, e]);\n\t\t\t}\n\t\t}\n\n\t\tfunction detach(eventName, className, handler, root) {\n\t\t\tif (eventHandlers[eventName] && eventHandlers[eventName][className]) {\n\t\t\t\tvar handlers = eventHandlers[eventName];\n\t\t\t\tvar elementHandlers = handlers[className];\n\t\t\t\tfor(var i = 0; i < elementHandlers.length; i++){\n\t\t\t\t\tif(elementHandlers[i].root == root){\n\t\t\t\t\t\telementHandlers.splice(i, 1);\n\t\t\t\t\t\ti--;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!elementHandlers.length){\n\t\t\t\t\tdelete handlers[className];\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\n\t\tvar domEvents = gantt._createDomEventScope();\n\n\t\tfunction reset(node){\n\n\t\t\tdomEvents.detachAll();\n\n\t\t\tif(node){\n\t\t\t\tdomEvents.attach(node, \"click\", onClick);\n\t\t\t\tdomEvents.attach(node, \"dblclick\", onDoubleClick);\n\t\t\t\tdomEvents.attach(node, \"mousemove\", onMouseMove);\n\t\t\t\tdomEvents.attach(node, \"contextmenu\", onContextMenu);\n\t\t\t}\n\t\t}\n\n\n\n\t\treturn {\n\t\t\treset: reset,\n\t\t\tglobal: function(event, classname, handler){\n\t\t\t\taddEventTarget(event, classname, handler, null);\n\t\t\t},\n\t\t\tdelegate: addEventTarget,\n\t\t\tdetach: detach,\n\t\t\tcallHandler: callHandler,\n\t\t\tonDoubleClick: onDoubleClick,\n\t\t\tonMouseMove: onMouseMove,\n\t\t\tonContextMenu: onContextMenu,\n\t\t\tonClick: onClick,\n\t\t\tdestructor: function(){\n\t\t\t\treset();\n\t\t\t\teventHandlers = null;\n\t\t\t\tdomEvents = null;\n\t\t\t}\n\n\t\t};\n\t};\n\n})(domHelpers);\n\n\nexport default {\n\tinit:createMouseHandler\n};","export default function(viewport, box, gantt){\n\tif(!box){\n\t\treturn false;\n\t}\n\n\tif(box.left > viewport.x_end || box.left + box.width < viewport.x){\n\t\treturn false;\n\t}\n\n\tif(box.top > viewport.y_end || box.top + box.height < viewport.y){\n\t\treturn false;\n\t}\n\t\n\treturn true;\n};","export default function(gantt){\n\treturn gantt.config.smart_rendering && gantt._smart_render;\n};","export default function(item, view, config){\n\treturn {\n\t\ttop: view.getItemTop(item.id),\n\t\theight: view.getItemHeight(item.id),\n\t\tleft: 0,\n\t\tright: Infinity\n\t};\n};","export default function getVisibleTasksRange(gantt, view, config, datastore, viewport){\n\tvar buffer = 1;\n\tvar start = view.getItemIndexByTopPosition(viewport.y) || 0;\n\tvar end = view.getItemIndexByTopPosition(viewport.y_end) || datastore.count();\n\tvar indexStart = Math.max(0, start - buffer);\n\tvar indexEnd =  Math.min(datastore.count(), end + buffer);\n\t// GS-2481 and GS-1715, need to take into account selected task when using keyboard shortcuts and when the inline editor is opened \n\tconst extraTasksIds= [];\n\tif (gantt.config.keyboard_navigation && gantt.getSelectedId()) {\n\t\tlet task = gantt.getTask(gantt.getSelectedId());\n\t\t// GS-2661 and GS-2835: The selected task shouldn't be a split child \n\t\t// and its parent shouldn't be collapsed\n\t\tif(task.$expanded_branch && !task.$split_subtask) {\n\t\t\textraTasksIds.push(gantt.getSelectedId());\n\t\t}\n\t}\n\tif (gantt.$ui.getView(\"grid\") && gantt.ext.inlineEditors && gantt.ext.inlineEditors.getState().id) {\n\t\tlet inlineEditorId = gantt.ext.inlineEditors.getState().id;\n\t\tif (datastore.exists(inlineEditorId)){\n\t\t\textraTasksIds.push(inlineEditorId);\n\t\t}\n\t}\n\treturn {\n\t\tstart: indexStart,\n\t\tend: indexEnd,\n\t\tids: extraTasksIds \n\t};\n};","import genericViewPortChecker from \"./viewport/is_in_viewport\";\nimport isLegacyRender from \"./is_legacy_smart_render\";\nimport basicGetRectangle from \"./viewport/get_grid_row_rectangle\";\nimport basicGetRange from \"./viewport/get_visible_bars_range\";\nvar rendererFactory = function(gantt){\n\n\t//hash of dom elements is needed to redraw single bar/link\n\tvar task_area_pulls = {},\n\t\ttask_area_renderers = {};\n\n\tfunction getView(layer){\n\t\tvar view = null;\n\t\tif (typeof layer.view === \"string\") {\n\t\t\tview = gantt.$ui.getView(layer.view);\n\t\t} else if (layer.view) {\n\t\t\tview = layer.view;\n\t\t}\n\t\treturn view;\n\t}\n\n\tfunction getRenderer(id, layer, node) {\n\t\t\n\t\tif (task_area_renderers[id])\n\t\t\treturn task_area_renderers[id];\n\n\t\tif (!layer.renderer)\n\t\t\tgantt.assert(false, \"Invalid renderer call\");\n\n\t\tvar renderMethod = null;\n\t\tvar updateMethod = null;\n\t\tvar getRectangle = null;\n\t\tvar renderCallbackMethod = null;\n\t\tvar specializedViewPortChecker = null;\n\n\t\tif(typeof layer.renderer === \"function\"){\n\t\t\trenderMethod = layer.renderer;\n\t\t\tgetRectangle = basicGetRectangle;\n\t\t}else{\n\t\t\trenderMethod = layer.renderer.render;\n\t\t\tupdateMethod = layer.renderer.update;\n\t\t\trenderCallbackMethod = layer.renderer.onrender;\n\t\t\t\n\t\t\tif(layer.renderer.isInViewPort){\n\t\t\t\tspecializedViewPortChecker = layer.renderer.isInViewPort;\n\t\t\t}else{\n\t\t\t\tgetRectangle = layer.renderer.getRectangle;\n\t\t\t}\n\n\t\t\tif (!getRectangle && getRectangle !== null) {\n\t\t\t\tgetRectangle = basicGetRectangle;\n\t\t\t}\n\t\t}\n\n\t\tvar filter = layer.filter;\n\n\t\tif (node)\n\t\t\tnode.setAttribute(gantt.config.layer_attribute, true);\n\n\t\ttask_area_renderers[id] = {\n\t\t\trender_item: function (item, container, viewPort, layerView, viewConfig) {\n\t\t\t\tcontainer = container || node;\n\t\t\t\tif (filter) {\n\t\t\t\t\tif (!filter(item)) {\n\t\t\t\t\t\tthis.remove_item(item.id);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tvar view = layerView || getView(layer);\n\t\t\t\tvar config = viewConfig || (view ? view.$getConfig() : null);\n\t\t\t\tvar rendererViewPort = viewPort;\n\t\t\t\tif(!rendererViewPort && config && config.smart_rendering){\n\t\t\t\t\trendererViewPort = view.getViewPort();\n\t\t\t\t}\n\n\t\t\t\tvar dom = null;\n\t\t\t\tif(!isLegacyRender(gantt) && (getRectangle || specializedViewPortChecker) && rendererViewPort){\n\t\t\t\t\tvar isVisible = false;\n\t\t\t\t\tif(specializedViewPortChecker){\n\t\t\t\t\t\tisVisible = specializedViewPortChecker(item, rendererViewPort, view, config, gantt);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tisVisible = genericViewPortChecker(rendererViewPort, getRectangle(item, view, config, gantt), gantt);\n\t\t\t\t\t}\n\t\t\t\t\tif(isVisible){\n\t\t\t\t\t\tdom = renderMethod.call(gantt, item, view, config, rendererViewPort);\n\t\t\t\t\t}\n\t\t\t\t}else{\n\t\t\t\t\tdom = renderMethod.call(gantt, item, view, config, rendererViewPort);\n\t\t\t\t}\n\t\t\t\tthis.append(item, dom, container);\n\n\t\t\t\tvar useBuffer = container.nodeType == 11;//DocumentFragment\n\t\t\t\tif(renderCallbackMethod && !useBuffer && dom) {\n\t\t\t\t\trenderCallbackMethod.call(gantt, item, dom, view);\n\t\t\t\t} \n\t\t\t},\n\n\t\t\tclear: function (container) {\n\n\t\t\t\tthis.rendered = task_area_pulls[id] = {};\n\t\t\t\tif(!layer.append)\n\t\t\t\t\tthis.clear_container(container);\n\t\t\t},\n\t\t\tclear_container: function (container) {\n\t\t\t\tcontainer = container || node;\n\t\t\t\tif (container){\n\t\t\t\t\tcontainer.innerHTML = \"\";\n\t\t\t\t}\n\t\t\t},\n\t\t\tget_visible_range: function(datastore){\n\t\t\t\tvar view = getView(layer);\n\t\t\t\tvar viewport;\n\t\t\t\tvar viewConfig = view ? view.$getConfig() : null;\n\t\t\t\tif(viewConfig && viewConfig.smart_rendering){\n\t\t\t\t\tviewport = view.getViewPort();\n\t\t\t\t}\n\n\t\t\t\tvar range;\n\t\t\t\tif(view && viewport){\n\t\t\t\t\tif(typeof layer.renderer === \"function\"){\n\t\t\t\t\t\trange = basicGetRange(gantt, view, viewConfig, datastore, viewport);\n\t\t\t\t\t}else if(layer.renderer && layer.renderer.getVisibleRange){\n\t\t\t\t\t\trange = layer.renderer.getVisibleRange(gantt, view, viewConfig, datastore, viewport);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(!range){\n\t\t\t\t\trange = {\n\t\t\t\t\t\tstart: 0,\n\t\t\t\t\t\tend: datastore.count()\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\treturn range;\n\t\t\t},\n\t\t\tprepare_data: function(items){\n\t\t\t\tif(layer.renderer && layer.renderer.prepareData){\n\t\t\t\t\treturn layer.renderer.prepareData(items, gantt, layer);\n\t\t\t\t}\n\t\t\t},\n\t\t\trender_items: function (items, container) {\n\t\t\t\tcontainer = container || node;\n\n\t\t\t\tvar buffer = document.createDocumentFragment();\n\t\t\t\tthis.clear(container);\n\n\t\t\t\tvar viewPort = null;\n\t\t\t\tvar view = getView(layer);\n\t\t\t\tvar viewConfig = view ? view.$getConfig() : null;\n\t\t\t\tif(viewConfig && viewConfig.smart_rendering){\n\t\t\t\t\tviewPort = view.getViewPort();\n\t\t\t\t}\n\n\t\t\t\tfor (var i = 0, vis = items.length; i < vis; i++) {\n\t\t\t\t\tthis.render_item(items[i], buffer, viewPort, view, viewConfig);\n\t\t\t\t}\n\n\t\t\t\tcontainer.appendChild(buffer, container);\n\n\t\t\t\tvar itemsSearch = {};\n\t\t\t\titems.forEach(function(item){\n\t\t\t\t\titemsSearch[item.id] = item;\n\t\t\t\t});\n\t\t\t\tvar renderedItems = {};\n\t\t\t\tif (renderCallbackMethod) {\n\t\t\t\t\tvar newElements = {};\n\t\t\t\t\tfor(var i in this.rendered) {\n\t\t\t\t\t\tif(!renderedItems[i]){\n\t\t\t\t\t\t\tnewElements[i] = this.rendered[i];\n\t\t\t\t\t\t\trenderCallbackMethod.call(gantt, itemsSearch[i], this.rendered[i], view);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t},\n\t\t\tupdate_items: function (items, container) {\n\t\t\t\tvar view = getView(layer);\n\t\t\t\tvar viewConfig = view ? view.$getConfig() : null;\n\t\t\t\tif(!view || !view.$getConfig().smart_rendering || isLegacyRender(gantt)){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif(!this.rendered){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif(!(getRectangle || specializedViewPortChecker)){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tcontainer = container || node;\n\n\t\t\t\tvar buffer = document.createDocumentFragment();\n\n\t\t\t\tvar viewPort = null;\n\t\t\t\tif(view){\n\t\t\t\t\tviewPort = view.getViewPort();\n\t\t\t\t}\n\n\t\t\t\tvar itemsSearch = {};\n\t\t\t\titems.forEach(function(item){\n\t\t\t\t\titemsSearch[item.id] = item;\n\t\t\t\t});\n\t\t\t\tvar renderedItems = {};\n\n\t\t\t\tvar nodesToRemove = {};\n\t\t\t\tfor(var i in this.rendered){\n\t\t\t\t\tnodesToRemove[i] = true;\n\t\t\t\t\trenderedItems[i] = true;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tvar renderCalledFor = {};\n\t\t\t\tfor (var i = 0, vis = items.length; i < vis; i++) {\n\t\t\t\t\tvar item = items[i];\n\t\t\t\t\tvar itemNode = this.rendered[item.id];\n\t\t\t\t\tnodesToRemove[item.id] = false;\n\t\t\t\t\tif (itemNode && itemNode.parentNode) {\n\t\t\t\t\t\tvar isVisible = false;\n\t\t\t\t\t\tif(specializedViewPortChecker){\n\t\t\t\t\t\t\tisVisible = specializedViewPortChecker(item, viewPort, view, viewConfig, gantt);\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tisVisible = genericViewPortChecker(viewPort, getRectangle(item, view, viewConfig, gantt), gantt);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!isVisible) {\n\t\t\t\t\t\t\tnodesToRemove[item.id] = true;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif(updateMethod){\n\t\t\t\t\t\t\t\tupdateMethod.call(gantt, item, itemNode, view, viewConfig, viewPort);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis.restore(item, buffer);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\trenderCalledFor[items[i].id] = true;\n\t\t\t\t\t\tthis.render_item(items[i], buffer, viewPort, view, viewConfig);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfor(var i in nodesToRemove){\n\t\t\t\t\tif(nodesToRemove[i]){\n\t\t\t\t\t\tthis.hide(i);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(buffer.childNodes.length){\n\t\t\t\t\tcontainer.appendChild(buffer, container);\n\t\t\t\t}\n\n\t\t\t\tif (renderCallbackMethod) {\n\t\t\t\t\tvar newElements = {};\n\t\t\t\t\tfor(var i in this.rendered) {\n\t\t\t\t\t\tif(!renderedItems[i] || renderCalledFor[i]){\n\t\t\t\t\t\t\tnewElements[i] = this.rendered[i];\n\t\t\t\t\t\t\trenderCallbackMethod.call(gantt, itemsSearch[i], this.rendered[i], view);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t},\n\t\t\tappend: function (item, node, container) {\n\t\t\t\tif(!this.rendered){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!node) {\n\t\t\t\t\tif (this.rendered[item.id]) {\n\t\t\t\t\t\tthis.remove_item(item.id);\n\t\t\t\t\t}\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (this.rendered[item.id] && this.rendered[item.id].parentNode) {\n\t\t\t\t\tthis.replace_item(item.id, node);\n\t\t\t\t} else {\n\t\t\t\t\tcontainer.appendChild(node);\n\t\t\t\t}\n\t\t\t\tthis.rendered[item.id] = node;\n\t\t\t},\n\t\t\treplace_item: function (item_id, newNode) {\n\t\t\t\tvar item = this.rendered[item_id];\n\t\t\t\tif (item && item.parentNode) {\n\t\t\t\t\titem.parentNode.replaceChild(newNode, item);\n\n\t\t\t\t}\n\t\t\t\tthis.rendered[item_id] = newNode;\n\t\t\t},\n\t\t\tremove_item: function (item_id) {\n\t\t\t\tthis.hide(item_id);\n\t\t\t\tdelete this.rendered[item_id];\n\t\t\t},\n\t\t\thide: function (item_id) {\n\t\t\t\tvar item = this.rendered[item_id];\n\t\t\t\tif (item && item.parentNode) {\n\t\t\t\t\titem.parentNode.removeChild(item);\n\t\t\t\t}\n\t\t\t\tdelete this.rendered[item_id];\n\t\t\t},\n\t\t\trestore: function (item, container) {\n\t\t\t\tvar dom = this.rendered[item.id];\n\t\t\t\tif (dom) {\n\t\t\t\t\tif (!dom.parentNode) {\n\t\t\t\t\t\tthis.append(item, dom, container || node);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthis.render_item(item, container || node);\n\t\t\t\t}\n\t\t\t},\n\t\t\tchange_id: function (oldid, newid) {\n\t\t\t\tthis.rendered[newid] = this.rendered[oldid];\n\t\t\t\tdelete this.rendered[oldid];\n\t\t\t},\n\t\t\trendered: task_area_pulls[id],\n\t\t\tnode: node,\n\t\t\tdestructor: function () {\n\t\t\t\tthis.clear();\n\t\t\t\tdelete task_area_renderers[id];\n\t\t\t\tdelete task_area_pulls[id];\n\t\t\t}\n\t\t};\n\n\t\treturn task_area_renderers[id];\n\t}\n\n\n\tfunction clearRenderers() {\n\t\tfor (var i in task_area_renderers) {\n\t\t\tgetRenderer(i).destructor();\n\t\t}\n\t}\n\n\treturn {\n\t\tgetRenderer: getRenderer,\n\t\tclearRenderers: clearRenderers\n\t};\n\n};\n\nexport default rendererFactory;","import renderFactoryProvider from \"./render_factory\";\nimport * as utils from \"../../../utils/utils\";\nimport * as domHelpers from \"../utils/dom_helpers\";\nimport isLegacyRender from \"./is_legacy_smart_render\";\n\nvar layerFactory = function(gantt){\n\n\tvar renderFactory = renderFactoryProvider(gantt);\n\treturn {\n\tcreateGroup: function (getContainer, relativeRoot, defaultFilters, initLayer) {\n\n\t\tvar renderGroup = {\n\t\t\ttempCollection: [],\n\t\t\trenderers: {},\n\t\t\tcontainer: getContainer,\n\t\t\tfilters: [],\n\t\t\tgetLayers: function () {\n\t\t\t\tthis._add();// add pending layers\n\n\t\t\t\tvar res = [];\n\t\t\t\tfor (var i in this.renderers) {\n\t\t\t\t\tres.push(this.renderers[i]);\n\t\t\t\t}\n\t\t\t\treturn res;\n\t\t\t},\n\t\t\tgetLayer: function (id) {\n\t\t\t\treturn this.renderers[id];\n\t\t\t},\n\t\t\t_add: function (layer) {\n\t\t\t\tif (layer) {\n\t\t\t\t\tlayer.id = layer.id || utils.uid();\n\t\t\t\t\tthis.tempCollection.push(layer);\n\t\t\t\t}\n\n\t\t\t\tconst container = this.container();\n\t\t\t\tconst pending = this.tempCollection;\n\t\t\t\tfor (let i = 0; i < pending.length; i++) {\n\t\t\t\t\tlayer = pending[i];\n\t\t\t\t\t// GS-2803: in case of Salesforce domHelpers.isChildOf check with document.body doesn't work\n\t\t\t\t\t// instead we check it with isConnected property\n\t\t\t\t\tif (!this.container() && !(layer && layer.container && layer.container.isConnected)) continue;\n\n\t\t\t\t\tlet node = layer.container,\n\t\t\t\t\t\tid = layer.id,\n\t\t\t\t\t\ttopmost = layer.topmost;\n\t\t\t\t\tif (!node.parentNode) {\n\t\t\t\t\t\t//insert on top or below the tasks\n\t\t\t\t\t\tif (topmost) {\n\t\t\t\t\t\t\tcontainer.appendChild(node);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tlet rel = relativeRoot ? relativeRoot() : container.firstChild;\n\t\t\t\t\t\t\t// GS-1274: if we don't add the second check, Gantt stops working if\n\t\t\t\t\t\t\t// we add the task layer without the timeline and switch to a layout with the timeline\n\t\t\t\t\t\t\tif (rel && rel.parentNode == container)\n\t\t\t\t\t\t\t\tcontainer.insertBefore(node, rel);\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\tcontainer.appendChild(node);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis.renderers[id] = renderFactory.getRenderer(\n\t\t\t\t\t\tid,\n\t\t\t\t\t\tlayer,\n\t\t\t\t\t\tnode\n\t\t\t\t\t);\n\n\t\t\t\t\tif (initLayer) {\n\t\t\t\t\t\tinitLayer(layer, gantt);\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.tempCollection.splice(i, 1);\n\t\t\t\t\ti--;\n\t\t\t\t}\n\t\t\t},\n\t\t\taddLayer: function (config) {\n\t\t\t\tif(config){\n\t\t\t\t\tif(typeof config == \"function\"){\n\t\t\t\t\t\tconfig = {renderer: config};\n\t\t\t\t\t}\n\n\t\t\t\t\tif(config.filter === undefined){\n\t\t\t\t\t\tconfig.filter = mergeFilters(defaultFilters || []);\n\t\t\t\t\t}else if(config.filter instanceof Array){\n\t\t\t\t\t\tconfig.filter.push(defaultFilters);\n\t\t\t\t\t\tconfig.filter = mergeFilters(config.filter);\n\t\t\t\t\t}\n\n\t\t\t\t\tif(!config.container){\n\t\t\t\t\t\tconfig.container = document.createElement(\"div\");\n\t\t\t\t\t}\n\t\t\t\t\tvar self = this;\n\t\t\t\t\tconfig.requestUpdate = function(){\n\t\t\t\t\t\tif(gantt.config.smart_rendering && !isLegacyRender(gantt)){\n\t\t\t\t\t\t\tif(self.renderers[config.id]){\n\t\t\t\t\t\t\t\tself.onUpdateRequest(self.renderers[config.id]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tthis._add(config);\n\t\t\t\treturn (config ? config.id : undefined);\n\t\t\t},\n\t\t\tonUpdateRequest: function(layer){\n\n\t\t\t},\n\n\t\t\teachLayer: function(code){\n\t\t\t\tfor (var i in this.renderers) {\n\t\t\t\t\tcode(this.renderers[i]);\n\t\t\t\t}\n\t\t\t},\n\t\t\tremoveLayer: function (id) {\n\t\t\t\tif(!this.renderers[id])\n\t\t\t\t\treturn;\n\t\t\t\tthis.renderers[id].destructor();\n\t\t\t\tdelete this.renderers[id];\n\t\t\t},\n\t\t\tclear: function () {\n\t\t\t\tfor (var i in this.renderers) {\n\t\t\t\t\tthis.renderers[i].destructor();\n\t\t\t\t}\n\t\t\t\tthis.renderers = {};\n\t\t\t}//,\n\t\t\t//prepareConfig: prepareConfig\n\t\t};\n\n\t\tgantt.attachEvent(\"onDestroy\", function(){\n\t\t\trenderGroup.clear();\n\t\t\trenderGroup = null;\n\t\t});\n\n\t\treturn renderGroup;\n\t}\n};};\n\n\nfunction mergeFilters(filter_methods){\n\tif(!(filter_methods instanceof Array)){\n\t\tfilter_methods = Array.prototype.slice.call(arguments, 0);\n\t}\n\n\treturn function(obj){\n\t\tvar res = true;\n\t\tfor(var i = 0, len = filter_methods.length; i < len; i++){\n\t\t\tvar filter_method = filter_methods[i];\n\t\t\tif(filter_method){\n\t\t\t\tres = res && (filter_method(obj.id, obj) !== false);\n\t\t\t}\n\t\t}\n\n\t\treturn res;\n\t};\n}\n\n\nexport default layerFactory;\n","export default function(item, view, config){\n\tif(!item.start_date || !item.end_date){\n\t\treturn null;\n\t}\n\tvar padding = 200;\n\tvar startCoord = view.posFromDate(item.start_date, view._getPositioningContext ? view._getPositioningContext(item) : null);\n\tvar endCoord = view.posFromDate(item.end_date, view._getPositioningContext ? view._getPositioningContext(item) : null);\n\tvar left = Math.min(startCoord, endCoord) - padding;\n\tvar right = Math.max(startCoord, endCoord) + padding;\n\treturn {\n\t\ttop: view.getItemTop(item.id),\n\t\theight: view.getItemHeight(item.id),\n\t\tleft: left,\n\t\twidth: right - left\n\t};\n};","import getLinkRectangle from \"../get_link_rectangle\";\n\nexport default function(){\n\tvar coordinates = [];\n\tvar calculated = false;\n\n\tfunction clearCache(){\n\t\tcoordinates = [];\n\t\tcalculated = false;\n\t}\n\n\tfunction buildCache(datastore, view, gantt){\n\t\tvar config = view.$getConfig();\n\t\tvar visibleItems = datastore.getVisibleItems();\n\t\t//datastore.eachItem(function(link){\n\t\tvisibleItems.forEach(function(link){\n\t\t\tvar rec = getLinkRectangle(link, view, config, gantt);\n\t\t\tif(!rec){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tcoordinates.push({id: link.id, rec: rec});\n\t\t});\n\n\t\tcoordinates.sort(function(a, b){\n\t\t\tif(a.rec.right < b.rec.right){\n\t\t\t\treturn -1;\n\t\t\t}else {\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t});\n\n\t\tcalculated = true;\n\t}\n\n\tvar initialized = false;\n\tfunction init(datastore){\n\t\tif(initialized){\n\t\t\treturn;\n\t\t}\n\t\tinitialized = true;\n\t\tdatastore.attachEvent(\"onPreFilter\", clearCache);\n\t\tdatastore.attachEvent(\"onStoreUpdated\", clearCache);\n\t\tdatastore.attachEvent(\"onClearAll\", clearCache);\n\t\tdatastore.attachEvent(\"onBeforeStoreUpdate\", clearCache);\n\t}\n\n\treturn function getVisibleLinksRange(gantt, view, config, datastore, viewport){\n\t\tinit(datastore);\n\t\tif(!calculated){\n\t\t\tbuildCache(datastore, view, gantt);\n\t\t}\n\n\t\tvar visibleBoxes = [];\n\t\tfor(var i = 0; i < coordinates.length; i++){\n\t\t\tvar item = coordinates[i];\n\t\t\tvar box = item.rec;\n\t\t\tif(box.right < viewport.x){\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif(box.left < viewport.x_end && box.right > viewport.x && box.top < viewport.y_end && box.bottom > viewport.y){\n\t\t\t\tvisibleBoxes.push(item.id);\n\t\t\t}\n\t\t}\n\t\t\n\t\treturn {\n\t\t\tids: visibleBoxes\n\t\t};\n\t};\n};","\n\nimport barRectangle from \"./get_bar_rectangle\";\n\nexport default function getLinkBox(item, view, config, gantt){\n\tif(!gantt.isTaskExists(item.source)){\n\t\treturn null;\n\t}\n\n\tif(!gantt.isTaskExists(item.target)){\n\t\treturn null;\n\t}\n\tvar sourceBox = barRectangle(gantt.getTask(item.source), view, gantt);\n\tvar targetBox = barRectangle(gantt.getTask(item.target), view, gantt);\n\n\tif(!sourceBox || !targetBox){\n\t\treturn null;\n\t}\n\n\tvar padding = 100;\n\tvar left = Math.min(sourceBox.left, targetBox.left) - padding;\n\tvar right = Math.max(sourceBox.left + sourceBox.width, targetBox.left + targetBox.width) + padding;\n\tvar top = Math.min(sourceBox.top, targetBox.top) - padding;\n\tvar bottom = Math.max(sourceBox.top + sourceBox.height, targetBox.top + targetBox.height) + padding;\n\n\treturn {\n\t\ttop: top,\n\t\theight: bottom - top,\n\t\tbottom,\n\t\tleft: left,\n\t\twidth: right - left,\n\t\tright\n\t};\n};\n","\n// optimized checker for links smart rendering\n\n// first check the vertical position since it's easier to calculate\n\nexport default function isLinkInViewPort(item, viewport, view, config, gantt){\n\tvar source = view.$gantt.getTask(item.source);\n\tvar target = view.$gantt.getTask(item.target);\n\t// check vertical visibility first since it's a lighter check\n\tvar sourceTop = view.getItemTop(source.id);\n\tvar sourceHeight = view.getItemHeight(source.id);\n\n\tvar targetTop = view.getItemTop(target.id);\n\tvar targetHeight = view.getItemHeight(target.id);\n\n\tif(viewport.y > sourceTop + sourceHeight &&\n\t\tviewport.y > targetTop + targetHeight){\n\t\treturn false;\n\t}\n\n\tif(viewport.y_end < targetTop &&\n\t\tviewport.y_end < sourceTop){\n\t\treturn false;\n\t}\n\n\tvar padding = 100;\n\tvar sourceLeft = view.posFromDate(source.start_date, view._getPositioningContext ? view._getPositioningContext(item) : null);\n\tvar sourceRight = view.posFromDate(source.end_date, view._getPositioningContext ? view._getPositioningContext(item) : null);\n\tvar targetLeft = view.posFromDate(target.start_date, view._getPositioningContext ? view._getPositioningContext(item) : null);\n\tvar targetRight = view.posFromDate(target.end_date, view._getPositioningContext ? view._getPositioningContext(item) : null);\n\n\tif(sourceLeft > sourceRight){\n\t\t// rtl\n\t\tvar tmp = sourceRight;\n\t\tsourceRight = sourceLeft;\n\t\tsourceLeft = tmp;\n\t}\n\tif(targetLeft > targetRight){\n\t\t// rtl\n\t\tvar tmp = targetRight;\n\t\ttargetRight = targetLeft;\n\t\ttargetLeft = tmp;\n\t}\n\tsourceLeft += -padding; // add buffer for custom elements\n\tsourceRight += padding;\n\ttargetLeft += -padding; // add buffer for custom elements\n\ttargetRight += padding;\n\n\tif(viewport.x > sourceRight &&\n\t\tviewport.x > targetRight){\n\t\treturn false;\n\t}\n\n\tif(viewport.x_end < sourceLeft &&\n\t\tviewport.x_end < targetLeft){\n\t\treturn false;\n\t}\n\treturn true;\n};\n","import createLayerFactory from \"./render/layer_engine\";\n\nimport getVisibleTaskRange from \"./render/viewport/get_visible_bars_range\";\nimport getVisibleLinksRangeFactory from \"./render/viewport/factory/get_visible_link_range\";\n\nimport isLinkInViewport from \"./render/viewport/is_link_in_viewport\";\n\nfunction initLayer(layer, gantt){\n\tif(!layer.view){\n\t\treturn;\n\t}\n\n\tvar view = layer.view;\n\tif(typeof view === \"string\"){\n\t\tview = gantt.$ui.getView(view);\n\t}\n\n\tif(view && view.attachEvent){\n\t\tview.attachEvent(\"onScroll\", function(){\n\t\t\tvar state = gantt.$services.getService(\"state\");\n\t\t\t// don't repaint if we're inside batchUpdate, a complete repaint will be called afterwards\n\t\t\tif(!state.getState(\"batchUpdate\").batch_update && !view.$config.$skipSmartRenderOnScroll){\n\t\t\t\tif(layer.requestUpdate){\n\t\t\t\t\tlayer.requestUpdate();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n}\n\nvar createLayerEngine = function(gantt){\n\tvar factory = createLayerFactory(gantt);\n\treturn {\n\t\tgetDataRender: function(name){\n\t\t\treturn gantt.$services.getService(\"layer:\" + name) || null;\n\t\t},\n\t\tcreateDataRender: function(config){\n\t\t\tvar name = config.name,\n\t\t\t\tdefaultContainer = config.defaultContainer,\n\t\t\t\tpreviusSiblingContainer = config.defaultContainerSibling;\n\n\t\t\tvar layers = factory.createGroup(\n\t\t\t\tdefaultContainer,\n\t\t\t\tpreviusSiblingContainer,\n\t\t\t\tfunction(itemId, item){\n\t\t\t\t\tif(layers.filters){\n\t\t\t\t\t\tfor(var i = 0; i < layers.filters.length; i++){\n\t\t\t\t\t\t\tif(layers.filters[i](itemId, item) === false){\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}else{\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tinitLayer\n\t\t\t);\n\n\t\t\tgantt.$services.setService(\"layer:\" + name, function(){\n\t\t\t\treturn layers;\n\t\t\t});\n\n\t\t\tgantt.attachEvent(\"onGanttReady\", function () {\n\t\t\t\tlayers.addLayer();// init layers on start\n\t\t\t});\n\n\t\t\treturn layers;\n\t\t},\n\t\tinit: function(){\n\t\t\tvar taskLayers = this.createDataRender({\n\t\t\t\tname: \"task\",\n\t\t\t\tdefaultContainer: function(){\n\t\t\t\t\tif(gantt.$task_data){\n\t\t\t\t\t\treturn gantt.$task_data;\n\t\t\t\t\t}else if(gantt.$ui.getView(\"timeline\")){\n\t\t\t\t\t\treturn gantt.$ui.getView(\"timeline\").$task_data;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tdefaultContainerSibling: function(){\n\t\t\t\t\tif(gantt.$task_links){\n\t\t\t\t\t\treturn gantt.$task_links;\n\t\t\t\t\t}else if(gantt.$ui.getView(\"timeline\")){\n\t\t\t\t\t\treturn gantt.$ui.getView(\"timeline\").$task_links;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tfilter: function(item){\n\n\t\t\t\t}\n\t\t\t}, gantt);\n\n\t\t\tvar linkLayers = this.createDataRender({\n\t\t\t\tname: \"link\",\n\t\t\t\tdefaultContainer: function(){\n\t\t\t\t\tif(gantt.$task_data){\n\t\t\t\t\t\treturn gantt.$task_data;\n\t\t\t\t\t}else if(gantt.$ui.getView(\"timeline\")){\n\t\t\t\t\t\treturn gantt.$ui.getView(\"timeline\").$task_data;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}, gantt);\n\n\t\t\treturn {\n\t\t\t\taddTaskLayer: function(config){\n\t\t\t\t\tconst rangeFunction = getVisibleTaskRange;\n\t\t\t\t\tif(typeof config === \"function\"){\n\t\t\t\t\t\tconfig = {\n\t\t\t\t\t\t\trenderer: {\n\t\t\t\t\t\t\t\trender: config,\n\t\t\t\t\t\t\t\tgetVisibleRange: rangeFunction\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\t}else{\n\t\t\t\t\t\tif(config.renderer && !config.renderer.getVisibleRange){\n\t\t\t\t\t\t\tconfig.renderer.getVisibleRange = rangeFunction;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tconfig.view = \"timeline\";\n\n\t\t\t\t\treturn taskLayers.addLayer(config);\n\t\t\t\t},\n\n\t\t\t\t_getTaskLayers: function(){\n\t\t\t\t\treturn taskLayers.getLayers();\n\t\t\t\t},\n\t\t\t\tremoveTaskLayer: function(id){\n\t\t\t\t\ttaskLayers.removeLayer(id);\n\t\t\t\t},\n\n\t\t\t\t_clearTaskLayers: function(){\n\t\t\t\t\ttaskLayers.clear();\n\t\t\t\t},\n\t\t\t\taddLinkLayer: function(config){\n\t\t\t\t\tconst rangeFunction = getVisibleLinksRangeFactory();\n\t\t\t\t\tif(typeof config === \"function\"){\n\t\t\t\t\t\tconfig = {\n\t\t\t\t\t\t\trenderer: {\n\t\t\t\t\t\t\t\trender: config,\n\t\t\t\t\t\t\t\tgetVisibleRange: rangeFunction\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\t}else{\n\t\t\t\t\t\tif(config.renderer && !config.renderer.getVisibleRange){\n\t\t\t\t\t\t\tconfig.renderer.getVisibleRange = rangeFunction;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tconfig.view = \"timeline\";\n\t\t\t\t\tif(config && config.renderer){\n\t\t\t\t\t\tif(!config.renderer.getRectangle && !config.renderer.isInViewPort){\n\t\t\t\t\t\t\tconfig.renderer.isInViewPort = isLinkInViewport;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn linkLayers.addLayer(config);\n\t\t\t\t},\n\n\t\t\t\t_getLinkLayers: function(){\n\t\t\t\t\treturn linkLayers.getLayers();\n\t\t\t\t},\n\t\t\t\tremoveLinkLayer: function(id){\n\t\t\t\t\tlinkLayers.removeLayer(id);\n\t\t\t\t},\n\n\t\t\t\t_clearLinkLayers: function(){\n\t\t\t\t\tlinkLayers.clear();\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t};\n};\n\nexport default createLayerEngine;","import * as utils from \"../../../utils/utils\";\nimport eventable from \"../../../utils/eventable\";\nimport * as domHelpers from \"../utils/dom_helpers\";\n\nvar Cell = (function () {\n\t\"use strict\";\n\n\tfunction Cell(parent, config, factory, gantt) {\n\t\tif (parent) {\n\t\t\tthis.$container = domHelpers.toNode(parent);\n\t\t\tthis.$parent = parent;\n\t\t}\n\t\t// save config\n\t\tthis.$config = utils.mixin(config, {\n\t\t\theaderHeight: 33\n\t\t});\n\t\tthis.$gantt = gantt;\n\t\tthis.$domEvents = gantt._createDomEventScope();\n\t\t// set id\n\t\tthis.$id = config.id || \"c\" + utils.uid();\n\n\t\tthis.$name = \"cell\";\n\t\tthis.$factory = factory;\n\t\tthis.$externalComponent = null;\n\n\t\teventable(this);\n\n\t}\n\n\tCell.prototype.destructor = function () {\n\t\tthis.$parent = this.$container = this.$view = null;\n\t\tvar mouse = this.$gantt.$services.getService(\"mouseEvents\");\n\t\tmouse.detach(\"click\", \"gantt_header_arrow\", this._headerClickHandler);\n\t\tthis.$domEvents.detachAll();\n\t\tthis.callEvent(\"onDestroy\", []);\n\t\tthis.detachAllEvents();\n\t};\n\tCell.prototype.cell = function (id) {\n\t\treturn null;\n\t};\n\n\tCell.prototype.scrollTo = function(left, top){\n\n\t\t//GS-333 Add a way to scroll the HTML views:\n\t\tvar cell = this.$view;\n\t\tif (this.$config.html) cell = this.$view.firstChild;\n\n\t\tif (left*1 == left){\n\t\t\tcell.scrollLeft = left;\n\t\t}\n\t\tif(top*1 == top){\n\t\t\tcell.scrollTop = top;\n\t\t}\n\t};\n\n\tCell.prototype.clear = function(){\n\t\tthis.getNode().innerHTML = \"\";\n\t\tthis.getNode().className = \"gantt_layout_content\";\n\t\tthis.getNode().style.padding = \"0\";\n\t};\n\n\tCell.prototype.resize = function (final) {\n\t\tif (this.$parent) {\n\t\t\treturn this.$parent.resize(final);\n\t\t}\n\n\t\tif(final === false){\n\t\t\tthis.$preResize = true;\n\t\t}\n\n\t\tvar topCont = this.$container;\n\t\tvar x = topCont.offsetWidth;\n\t\tvar y = topCont.offsetHeight;\n\t\tvar topSize = this.getSize();\n\t\tif (topCont === document.body) {\n\t\t\tx = document.body.offsetWidth;\n\t\t\ty = document.body.offsetHeight;\n\t\t}\n\t\tif (x < topSize.minWidth) {\n\t\t\tx = topSize.minWidth;\n\t\t}\n\t\tif (x > topSize.maxWidth) {\n\t\t\tx = topSize.maxWidth;\n\t\t}\n\t\tif (y < topSize.minHeight) {\n\t\t\ty = topSize.minHeight;\n\t\t}\n\t\tif (y > topSize.maxHeight) {\n\t\t\ty = topSize.maxHeight;\n\t\t}\n\t\tthis.setSize(x, y);\n\n\t\tif(!this.$preResize){\n\t\t//\tself.callEvent(\"onResize\", [x, y]);\n\t\t}\n\t\tthis.$preResize = false;\n\t};\n\n\tCell.prototype.hide = function () {\n\t\tthis._hide(true);\n\t\tthis.resize();\n\t};\n\tCell.prototype.show = function (force) {\n\t\tthis._hide(false);\n\t\tif (force && this.$parent) {\n\t\t\tthis.$parent.show();\n\t\t}\n\t\tthis.resize();\n\t};\n\tCell.prototype._hide = function (mode) {\n\t\tif (mode === true && this.$view.parentNode) {\n\t\t\tthis.$view.parentNode.removeChild(this.$view);\n\t\t}\n\t\telse if (mode === false && !this.$view.parentNode) {\n\t\t\tvar index = this.$parent.cellIndex(this.$id);\n\t\t\tthis.$parent.moveView(this, index);\n\t\t}\n\t\tthis.$config.hidden = mode;\n\t};\n\tCell.prototype.$toHTML = function (content, css) {\n\t\tif (content === void 0) { content = \"\"; }\n\t\tcss = [(css || \"\"), (this.$config.css || \"\")].join(\" \");\n\t\tvar obj = this.$config;\n\t\tvar header = \"\";\n\t\tif (obj.raw) {\n\t\t\tcontent = typeof obj.raw === \"string\" ? obj.raw : \"\";\n\t\t}\n\t\telse {\n\t\t\tif (!content) {\n\t\t\t\tlet renderedElement = null;\n\t\t\t\tif(typeof obj.html === \"function\"){\n\t\t\t\t\trenderedElement = obj.html();\n\t\t\t\t}else{\n\t\t\t\t\trenderedElement = obj.html;\n\t\t\t\t}\n\n\t\t\t\tif(this.$gantt.config.external_render && this.$gantt.config.external_render.isElement(renderedElement)){\n\t\t\t\t\tthis.$externalComponent = renderedElement;\n\t\t\t\t\trenderedElement = null;\n\t\t\t\t}\n\n\t\t\t\tcontent = \"<div class='gantt_layout_content' \"+(css ? \" class='\"+css+\"' \" : \"\")+\" >\" + (renderedElement || \"\") + \"</div>\";\n\t\t\t}\n\t\t\tif (obj.header) {\n\t\t\t\tvar collapseIcon = obj.canCollapse ? \"<div class='gantt_layout_header_arrow'></div>\" : \"\";\n\t\t\t\theader = \"<div class='gantt_layout_header'>\" + collapseIcon + \"<div class='gantt_layout_header_content'>\" + obj.header + \"</div></div>\";\n\t\t\t}\n\t\t}\n\t\treturn \"<div class='gantt_layout_cell \" + css + \"' data-cell-id='\" + this.$id + \"'>\" + header + content + \"</div>\";\n\t};\n\tCell.prototype.$fill = function (node, parent) {\n\t\tthis.$view = node;\n\t\tthis.$parent = parent;\n\t\tthis.init();\n\t};\n\tCell.prototype.getNode = function () {\n\t\treturn (this.$view.querySelector(\"gantt_layout_cell\") || this.$view);\n\t};\n\tCell.prototype.init = function () {\n\t\t// [NOT-GOOD] code is executed for each component, while it still has only one handler, it is no good\n\n\t\tvar self = this;\n\n\t\tthis._headerClickHandler = function(e){\n\t\t\tvar cellId = domHelpers.locateAttribute(e, \"data-cell-id\");\n\t\t\tif(cellId == self.$id){\n\t\t\t\tself.toggle();\n\t\t\t}\n\t\t};\n\n\t\tvar mouse = this.$gantt.$services.getService(\"mouseEvents\");\n\t\tmouse.delegate(\"click\", \"gantt_header_arrow\", this._headerClickHandler);\n\n\t\tthis.callEvent(\"onReady\", []);\n\t};\n\tCell.prototype.toggle = function () {\n\t\tthis.$config.collapsed = !this.$config.collapsed;\n\t\tthis.resize();\n\t};\n\tCell.prototype.getSize = function () {\n\t\tvar size = {\n\t\t\theight: this.$config.height || 0,\n\t\t\twidth: this.$config.width || 0,\n\t\t\tgravity: this.$config.gravity || 1,\n\t\t\tminHeight: this.$config.minHeight || 0,\n\t\t\tminWidth: this.$config.minWidth || 0,\n\t\t\tmaxHeight: this.$config.maxHeight || 100000000000,\n\t\t\tmaxWidth: this.$config.maxWidth || 100000000000\n\t\t};\n\t\tif (this.$config.collapsed) {\n\t\t\tvar mode = this.$config.mode === \"x\";\n\t\t\tsize[mode ? \"width\" : \"height\"] = size[mode ? \"maxWidth\" : \"maxHeight\"] = this.$config.headerHeight;\n\t\t}\n\t\treturn size;\n\t};\n\n\tCell.prototype.getContentSize = function(){\n\n\t\tvar width = this.$lastSize.contentX;\n\t\tif(width !== width*1){\n\t\t\twidth = this.$lastSize.width;\n\t\t}\n\n\t\tvar height = this.$lastSize.contentY;\n\t\tif(height !== height*1){\n\t\t\theight = this.$lastSize.height;\n\t\t}\n\n\t\treturn {\n\t\t\twidth: width,\n\t\t\theight: height\n\t\t};\n\t};\n\n\tCell.prototype._getBorderSizes = function(){\n\t\tvar borders = {\n\t\t\ttop: 0,\n\t\t\tright: 0,\n\t\t\tbottom: 0,\n\t\t\tleft: 0,\n\t\t\thorizontal: 0,\n\t\t\tvertical: 0\n\t\t};\n\t\tif(this._currentBorders){\n\t\t\tif(this._currentBorders[this._borders.left]){\n\t\t\t\tborders.left = 1;\n\t\t\t\tborders.horizontal++;\n\t\t\t}\n\n\t\t\tif(this._currentBorders[this._borders.right]){\n\t\t\t\tborders.right = 1;\n\t\t\t\tborders.horizontal++;\n\t\t\t}\n\n\t\t\tif(this._currentBorders[this._borders.top]){\n\t\t\t\tborders.top = 1;\n\t\t\t\tborders.vertical++;\n\t\t\t}\n\n\t\t\tif(this._currentBorders[this._borders.bottom]){\n\t\t\t\tborders.bottom = 1;\n\t\t\t\tborders.vertical++;\n\t\t\t}\n\t\t}\n\n\t\treturn borders;\n\n\t};\n\n\tCell.prototype.setSize = function (x, y) {\n\t\tthis.$view.style.width = x + \"px\";\n\t\tthis.$view.style.height = y + \"px\";\n\n\t\tvar borders = this._getBorderSizes();\n\t\tvar contentY = y - borders.vertical;\n\t\tvar contentX = x - borders.horizontal;\n\n\t\tthis.$lastSize = { x: x, y: y, contentX: contentX, contentY: contentY };\n\t\tif (this.$config.header) {\n\t\t\tthis._sizeHeader();\n\t\t}else{\n\t\t\tthis._sizeContent();\n\t\t}\n\t};\n\n\tCell.prototype._borders = {\n\t\t\"left\":\"gantt_layout_cell_border_left\",\n\t\t\"right\":\"gantt_layout_cell_border_right\",\n\t\t\"top\":\"gantt_layout_cell_border_top\",\n\t\t\"bottom\":\"gantt_layout_cell_border_bottom\"\n\t};\n\n\tCell.prototype._setBorders = function(css, view){\n\t\tif(!view) {\n\t\t\tview = this;\n\t\t}\n\t\tvar node = view.$view;\n\n\t\tfor( var i in this._borders){\n\t\t\tdomHelpers.removeClassName(node, this._borders[i]);\n\t\t}\n\n\t\tif(typeof css == \"string\"){\n\t\t\tcss = [css];\n\t\t}\n\n\t\tvar cssHash = {};\n\n\t\tfor(var i = 0; i < css.length; i++){\n\t\t\tdomHelpers.addClassName(node, css[i]);\n\t\t\tcssHash[css[i]] = true;\n\t\t}\n\n\t\tview._currentBorders = cssHash;\n\t};\n\n\n\tCell.prototype._sizeContent = function(){\n\t\tvar content = this.$view.childNodes[0];\n\t\tif(content && content.className == \"gantt_layout_content\"){\n\t\t\tcontent.style.height = this.$lastSize.contentY + \"px\";\n\t\t}\n\t};\n\n\tCell.prototype._sizeHeader = function () {\n\t\tvar size = this.$lastSize;\n\t\tsize.contentY -= this.$config.headerHeight;\n\t\tvar header = this.$view.childNodes[0];\n\t\tvar content = this.$view.childNodes[1];\n\t\tvar xLayout = this.$config.mode === \"x\";\n\t\tif (this.$config.collapsed) {\n\t\t\tcontent.style.display = \"none\";\n\t\t\tif (xLayout) {\n\t\t\t\theader.className = \"gantt_layout_header collapsed_x\";\n\t\t\t\theader.style.width = size.y + \"px\";\n\t\t\t\tvar d = Math.floor(size.y / 2 - size.x / 2);\n\t\t\t\theader.style.transform = \"rotate(90deg) translate(\" + d + \"px, \" + d + \"px)\";\n\t\t\t\tcontent.style.display = \"none\";\n\t\t\t}\n\t\t\telse {\n\t\t\t\theader.className = \"gantt_layout_header collapsed_y\";\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tif (xLayout) {\n\t\t\t\theader.className = \"gantt_layout_header\";\n\t\t\t}\n\t\t\telse {\n\t\t\t\theader.className = \"gantt_layout_header vertical\";\n\t\t\t}\n\t\t\theader.style.width = 'auto';\n\t\t\theader.style.transform = '';\n\t\t\tcontent.style.display = \"\";\n\t\t\tcontent.style.height = size.contentY + \"px\";\n\t\t}\n\t\theader.style.height = this.$config.headerHeight + \"px\";\n\t};\n\treturn Cell;\n}());\n\nexport default Cell;\n","export default function (d, b) {\n\tfor (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n\tfunction __() { this.constructor = d; }\n\td.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};","import __extends from \"../../../utils/extends\";\nimport * as domHelpers from \"../utils/dom_helpers\";\nimport Cell from \"./cell\";\n\nvar Layout = (function (_super) {\n\t\"use strict\";\n\n\t__extends(Layout, _super);\n\tfunction Layout(parent, config, factory) {\n\t\tvar _this = _super.apply(this, arguments) || this;\n\n\t\tif(parent)\n\t\t\t_this.$root = true;\n\n\t\t_this._parseConfig(config);\n\t\t_this.$name = \"layout\";\n\t\treturn _this;\n\t}\n\n\tLayout.prototype.destructor = function () {\n\t\tif (this.$container && this.$view) {\n\t\t\tdomHelpers.removeNode(this.$view);\n\t\t}\n\n\t\tfor (var i = 0; i < this.$cells.length; i++) {\n\t\t\tvar child = this.$cells[i];\n\t\t\tchild.destructor();\n\t\t}\n\t\tthis.$cells = [];\n\n\t\t_super.prototype.destructor.call(this);\n\t};\n\n\tLayout.prototype._resizeScrollbars = function(autosize, scrollbars){\n\t\tvar scrollChanged = false;\n\t\tvar visibleScrollbars = [],\n\t\t\thiddenScrollbars = [];\n\n\t\tconst scrollbarsToHide = [];\n\n\t\tfunction showScrollbar(scrollbar){\n\t\t\tscrollbar.$parent.show();\n\t\t\tscrollChanged = true;\n\t\t\tvisibleScrollbars.push(scrollbar);\n\t\t}\n\t\tfunction hideScrollbar(scrollbar){\n\t\t\tscrollbar.$parent.hide();\n\t\t\tscrollChanged = true;\n\t\t\thiddenScrollbars.push(scrollbar);\n\t\t}\n\n\t\tvar scrollbar;\n\t\tfor(var i = 0; i < scrollbars.length; i++){\n\t\t\tscrollbar = scrollbars[i];\n\n\t\t\tif(autosize[scrollbar.$config.scroll]) {\n\t\t\t\thideScrollbar(scrollbar);\n\t\t\t}else if(scrollbar.shouldHide()){\n\t\t\t\t//hideScrollbar(scrollbar);\n\t\t\t\tscrollbarsToHide.push(scrollbar);\n\t\t\t}else if(scrollbar.shouldShow()){\n\t\t\t\tshowScrollbar(scrollbar);\n\t\t\t}else{\n\t\t\t\tif(scrollbar.isVisible()){\n\t\t\t\t\tvisibleScrollbars.push(scrollbar);\n\t\t\t\t}else{\n\t\t\t\t\thiddenScrollbars.push(scrollbar);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tvar visibleGroups = {};\n\t\tfor(var i = 0; i < visibleScrollbars.length; i++){\n\t\t\tif(visibleScrollbars[i].$config.group){\n\t\t\t\tvisibleGroups[visibleScrollbars[i].$config.group] = true;\n\t\t\t}\n\t\t}\n\n\t\t// GS-2220\n\t\tscrollbarsToHide.forEach(function(scrollbar){\n\t\t\tif(!(scrollbar.$config.group && visibleGroups[scrollbar.$config.group])){\n\t\t\t\thideScrollbar(scrollbar);\n\t\t\t}\n\t\t});\n\n\t\tfor(var i = 0; i < hiddenScrollbars.length; i++){\n\t\t\tscrollbar = hiddenScrollbars[i];\n\n\t\t\tif(scrollbar.$config.group && visibleGroups[scrollbar.$config.group]){\n\t\t\t\tshowScrollbar(scrollbar);\n\t\t\t\t// GS-707 If the scrollbar was hidden then showed, the container resize shouldn't happen because of that\n\t\t\t\tfor(var j = 0; j < visibleScrollbars.length; j++){\n\t\t\t\t\tif(visibleScrollbars[j] == scrollbar){\n\t\t\t\t\t\tthis.$gantt.$scrollbarRepaint = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn scrollChanged;\n\t};\n\n\tLayout.prototype.getScrollbarsInfo = function(){\n\t\tconst scrollbars = this.getCellsByType(\"scroller\");\n\t\tconst scrollbarsInfo = [];\n\t\tscrollbars.forEach(scrollbar => {\n\t\t\tlet obj = {};\n\t\t\tconst {visible, direction, size, scrollSize, position} = scrollbar.getScrollState();\n\t\t\tlet linkedViews = scrollbar._getLinkedViews();\n\t\t\tlet boundViews = linkedViews.map(view => view.$config.id);\n\n\t\t\tobj.id = scrollbar.$id;\n\t\t\tobj.visible = visible;\n\t\t\tobj.boundViews = boundViews;\n\t\t\tif(direction === \"x\"){\n\t\t\t\tobj.x = size;\n\t\t\t\tobj.x_inner = scrollSize;\n\t\t\t\tobj.x_pos = position || 0;\n\t\t\t} else {\n\t\t\t\tobj.y = size;\n\t\t\t\tobj.y_inner = scrollSize;\n\t\t\t\tobj.y_pos = position || 0;\n\t\t\t}\n\t\t\tscrollbarsInfo.push(obj);\n\t\t});\n\t\treturn scrollbarsInfo;\n\t};\n\n\tLayout.prototype._syncCellSizes = function(groupName, newSize){\n\t\tif(!groupName)\n\t\t\treturn;\n\n\t\tvar groups = {};\n\n\t\tthis._eachChild(function(cell){\n\t\t\tif(cell.$config.group && cell.$name != \"scrollbar\" && cell.$name != \"resizer\"){\n\t\t\t\tif(!groups[cell.$config.group]){\n\t\t\t\t\tgroups[cell.$config.group] = [];\n\t\t\t\t}\n\t\t\t\tgroups[cell.$config.group].push(cell);\n\t\t\t}\n\t\t});\n\n\t\tif(groups[groupName]){\n\t\t\tthis._syncGroupSize(groups[groupName], newSize);\n\t\t}\n\t\treturn groups[groupName];\n\t};\n\n\tLayout.prototype._syncGroupSize = function(cells, newSize){\n\t\tif(!cells.length) return;\n\n\t\tvar property = cells[0].$parent._xLayout ? \"width\" : \"height\";\n\t\tvar direction = cells[0].$parent.getNextSibling(cells[0].$id) ? 1 : -1;\n\n\t\tvar newSizeValue = newSize.value;\n\t\tvar isGravity = newSize.isGravity;\n\t\tfor(var i = 0; i < cells.length; i++){\n\t\t\tvar ownSize = cells[i].getSize();\n\n\t\t\tvar resizeSibling = direction > 0 ? cells[i].$parent.getNextSibling(cells[i].$id) : cells[i].$parent.getPrevSibling(cells[i].$id);\n\t\t\tif(resizeSibling.$name == \"resizer\"){\n\t\t\t\tresizeSibling = direction > 0 ? resizeSibling.$parent.getNextSibling(resizeSibling.$id) : resizeSibling.$parent.getPrevSibling(resizeSibling.$id);\n\t\t\t}\n\t\t\tvar siblingSize = resizeSibling.getSize();\n\n\t\t\tif(!isGravity) {\n\t\t\t\tif(resizeSibling[property]){\n\t\t\t\t\tvar totalGravity = ownSize.gravity + siblingSize.gravity;\n\t\t\t\t\tvar totalSize = ownSize[property] + siblingSize[property];\n\t\t\t\t\tvar k = totalGravity / totalSize;\n\t\t\t\t\tcells[i].$config.gravity = k * newSizeValue;\n\n\t\t\t\t\tresizeSibling.$config[property] = totalSize - newSizeValue;\n\t\t\t\t\tresizeSibling.$config.gravity = totalGravity - k * newSizeValue;\n\t\t\t\t}else{\n\t\t\t\t\tcells[i].$config[property] = newSizeValue;\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tcells[i].$config.gravity = newSizeValue;\n\t\t\t}\n\n\t\t\tvar mainGrid = this.$gantt.$ui.getView(\"grid\");\n\t\t\tif(mainGrid && cells[i].$content === mainGrid && !mainGrid.$config.scrollable && !isGravity){\n\t\t\t\tthis.$gantt.config.grid_width = newSizeValue;\n\t\t\t}\n\t\t}\n\t};\n\n\tLayout.prototype.resize = function(startStage){\n\t\tvar mainCall = false;\n\t\tif(this.$root && !this._resizeInProgress){\n\t\t\tthis.callEvent(\"onBeforeResize\", []);\n\t\t\tmainCall = true;\n\t\t\tthis._resizeInProgress = true;\n\t\t}\n\n\t\t_super.prototype.resize.call(this, true);\n\t\t_super.prototype.resize.call(this, false);\n\n\t\tif(mainCall){\n\n\t\t\tvar contentViews = [];\n\t\t\tcontentViews = contentViews.concat(this.getCellsByType(\"viewCell\"));\n\t\t\tcontentViews = contentViews.concat(this.getCellsByType(\"viewLayout\"));\n\t\t\tcontentViews = contentViews.concat(this.getCellsByType(\"hostCell\"));\n\n\t\t\tvar scrollbars = this.getCellsByType(\"scroller\");\n\n\t\t\tfor(var i = 0; i < contentViews.length; i++){\n\t\t\t\tif(!contentViews[i].$config.hidden)\n\t\t\t\t\tcontentViews[i].setContentSize();\n\t\t\t}\n\n\t\t\tvar autosize = this._getAutosizeMode(this.$config.autosize);\n\n\t/* // possible to rollback set content size when autisize is disabled, not sure if need to\n\t\t\tcontentViews.forEach(function(view){\n\t\t\t\tconst parent = view.$parent;\n\t\t\t\tif(!autosize.x){\n\t\t\t\t\tif(parent.$config.$originalWidthStored){\n\t\t\t\t\t\tparent.$config.$originalWidthStored = false;\n\t\t\t\t\t\tparent.$config.width = parent.$config.$originalWidth;\n\t\t\t\t\t\tparent.$config.$originalWidth = undefined;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif(!autosize.y){\n\t\t\t\t\tif(parent.$config.$originalHeightStored){\n\t\t\t\t\t\tparent.$config.$originalHeightStored = false;\n\t\t\t\t\t\tparent.$config.height = parent.$config.$originalHeight;\n\t\t\t\t\t\tparent.$config.$originalHeight = undefined;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});*/\n\t\t\t\n\t\t\tvar scrollChanged = this._resizeScrollbars(autosize, scrollbars);\n\n\t\t\tif(this.$config.autosize){\n\t\t\t\tthis.autosize(this.$config.autosize);\n\t\t\t\tcontentViews.forEach(function(view){\n\t\t\t\t\tconst parent = view.$parent;\n\t\t\t\t\tconst sizes = parent.getContentSize(autosize);\n\t\t\t\t\tif(autosize.x){\n\t\t\t\t\t\tif(!parent.$config.$originalWidthStored){\n\t\t\t\t\t\t\tparent.$config.$originalWidthStored = true;\n\t\t\t\t\t\t\tparent.$config.$originalWidth = parent.$config.width;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tparent.$config.width = sizes.width;\n\t\t\t\t\t}\n\t\t\t\t\tif(autosize.y){\n\t\t\t\t\t\tif(!parent.$config.$originalHeightStored){\n\t\t\t\t\t\t\tparent.$config.$originalHeightStored = true;\n\t\t\t\t\t\t\tparent.$config.$originalHeight = parent.$config.height;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tparent.$config.height = sizes.height;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tscrollChanged = true;\n\t\t\t}\n\n\t\t\tif(scrollChanged){\n\t\t\t\tthis.resize();\n\t\t\t\tfor(var i = 0; i < contentViews.length; i++){\n\t\t\t\t\tif(!contentViews[i].$config.hidden)\n\t\t\t\t\t\tcontentViews[i].setContentSize();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.callEvent(\"onResize\", []);\n\t\t}\n\t\tif(mainCall){\n\t\t\tthis._resizeInProgress = false;\n\t\t}\n\t};\n\n\tLayout.prototype._eachChild = function(code, cell){\n\t\tcell = cell || this;\n\t\tcode(cell);\n\t\tif(cell.$cells){\n\t\t\tfor(var i = 0; i < cell.$cells.length; i++){\n\t\t\t\tthis._eachChild(code, cell.$cells[i]);\n\t\t\t}\n\t\t}\n\t};\n\n\tLayout.prototype.isChild = function(view){\n\t\tvar res = false;\n\t\tthis._eachChild(function(child){\n\t\t\tif(child === view || child.$content === view){\n\t\t\t\tres = true;\n\t\t\t}\n\t\t});\n\t\treturn res;\n\t};\n\n\tLayout.prototype.getCellsByType = function(type){\n\t\tvar res = [];\n\t\tif(type === this.$name){\n\t\t\tres.push(this);\n\t\t}\n\n\t\tif(this.$content && this.$content.$name == type){\n\t\t\tres.push(this.$content);\n\t\t}\n\n\t\tif(this.$cells){\n\t\t\tfor(var i = 0; i < this.$cells.length; i++){\n\t\t\t\tvar children = Layout.prototype.getCellsByType.call(this.$cells[i], type);\n\t\t\t\tif(children.length){\n\t\t\t\t\tres.push.apply(res, children);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn res;\n\t};\n\n\tLayout.prototype.getNextSibling = function(cellId){\n\t\tvar index = this.cellIndex(cellId);\n\t\tif(index >= 0 && this.$cells[index + 1]){\n\t\t\treturn this.$cells[index + 1];\n\t\t}else{\n\t\t\treturn null;\n\t\t}\n\t};\n\n\tLayout.prototype.getPrevSibling = function(cellId){\n\t\tvar index = this.cellIndex(cellId);\n\t\tif(index >= 0 && this.$cells[index - 1]){\n\t\t\treturn this.$cells[index - 1];\n\t\t}else{\n\t\t\treturn null;\n\t\t}\n\t};\n\n\n\tLayout.prototype.cell = function (id) {\n\t\tfor (var i = 0; i < this.$cells.length; i++) {\n\t\t\tvar child = this.$cells[i];\n\t\t\tif (child.$id === id) {\n\t\t\t\treturn child;\n\t\t\t}\n\t\t\tvar sub = child.cell(id);\n\t\t\tif (sub) {\n\t\t\t\treturn sub;\n\t\t\t}\n\t\t}\n\t};\n\tLayout.prototype.cellIndex = function (id) {\n\t\tfor (var i = 0; i < this.$cells.length; i++) {\n\t\t\tif (this.$cells[i].$id === id) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\t\treturn -1;\n\t};\n\tLayout.prototype.moveView = function (view, ind) {\n\t\tif (this.$cells[ind] !== view) {\n\t\t\treturn window.alert(\"Not implemented\");\n\t\t}\n\t\telse {\n\t\t\tind += this.$config.header ? 1 : 0;\n\t\t\tvar node = this.$view;\n\t\t\tif (ind >= node.childNodes.length) {\n\t\t\t\tnode.appendChild(view.$view);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tnode.insertBefore(view.$view, node.childNodes[ind]);\n\t\t\t}\n\t\t}\n\t};\n\tLayout.prototype._parseConfig = function (config) {\n\t\tthis.$cells = [];\n\t\tthis._xLayout = !config.rows;\n\t\tvar cells = config.rows || config.cols || config.views;\n\t\tfor (var i = 0; i < cells.length; i++) {\n\t\t\tvar cell = cells[i];\n\t\t\tcell.mode = this._xLayout ? \"x\" : \"y\";\n\t\t\tvar $content = this.$factory.initUI(cell, this);\n\t\t\tif(!$content){\n\t\t\t\tcells.splice(i, 1);\n\t\t\t\ti--;\n\t\t\t}else{\n\t\t\t\t$content.$parent = this;\n\t\t\t\tthis.$cells.push($content);\n\t\t\t}\n\t\t}\n\t};\n\tLayout.prototype.getCells = function () {\n\t\treturn this.$cells;\n\t};\n\tLayout.prototype.render = function () {\n\t\tvar view = domHelpers.insertNode(this.$container, this.$toHTML());\n\n\t\tthis.$fill(view, null);\n\n\t\tconst gantt = this.$gantt;\n\t\tthis._eachChild((cell) => {\n\t\t\tif(cell.$externalComponent){\n\t\t\t\tgantt.config.external_render.renderElement(\n\t\t\t\t\tcell.$externalComponent, \n\t\t\t\t\tcell.$view.querySelector(\".gantt_layout_content\")\n\t\t\t\t);\n\t\t\t\tcell.$externalComponent = null;\n\t\t\t}\n\t\t});\n\t\tthis.callEvent(\"onReady\", []);\n\t\tthis.resize();\n\n\t\t// do simple repaint after the first call\n\t\tthis.render = this.resize;\n\t};\n\tLayout.prototype.$fill = function (node, parent) {\n\t\tthis.$view = node;\n\t\tthis.$parent = parent;\n\t\tvar cells = domHelpers.getChildNodes(node, \"gantt_layout_cell\");\n\t\tfor (var i = cells.length - 1; i >= 0; i--) {\n\t\t\tvar sub = this.$cells[i];\n\t\t\tsub.$fill(cells[i], this);\n\t\t\t// initially hidden cell\n\t\t\tif (sub.$config.hidden) {\n\t\t\t\tsub.$view.parentNode.removeChild(sub.$view);\n\t\t\t}\n\t\t}\n\t};\n\tLayout.prototype.$toHTML = function () {\n\t\tvar mode = this._xLayout ? \"x\" : \"y\";\n\t\tvar html = [];\n\t\tfor (var i = 0; i < this.$cells.length; i++) {\n\t\t\thtml.push(this.$cells[i].$toHTML());\n\t\t}\n\t\treturn _super.prototype.$toHTML.call(this, html.join(\"\"), (this.$root ? \"gantt_layout_root \" : \"\") + \"gantt_layout gantt_layout_\" + mode);\n\t};\n\n\tLayout.prototype.getContentSize = function(mode){\n\t\tvar contentWidth = 0,\n\t\t\tcontentHeight = 0;\n\n\t\tvar cellSize, cell, borders;\n\t\tfor (var i = 0; i < this.$cells.length; i++) {\n\t\t\tcell = this.$cells[i];\n\t\t\tif(cell.$config.hidden)\n\t\t\t\tcontinue;\n\n\t\t\tcellSize = cell.getContentSize(mode);\n\n\t\t\tif(cell.$config.view === \"scrollbar\" && mode[cell.$config.scroll]){\n\t\t\t\tcellSize.height = 0;\n\t\t\t\tcellSize.width = 0;\n\t\t\t}\n\n\t\t\tif(cell.$config.resizer){\n\t\t\t\tif(this._xLayout){\n\t\t\t\t\tcellSize.height = 0;\n\t\t\t\t}else{\n\t\t\t\t\tcellSize.width = 0;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tborders = cell._getBorderSizes();\n\n\t\t\tif(this._xLayout){\n\t\t\t\tcontentWidth += (cellSize.width + borders.horizontal);\n\t\t\t\tcontentHeight = Math.max(contentHeight, (cellSize.height + borders.vertical));\n\t\t\t}else{\n\t\t\t\tcontentWidth = Math.max(contentWidth, cellSize.width + borders.horizontal);\n\t\t\t\tcontentHeight += cellSize.height + borders.vertical;\n\t\t\t}\n\t\t}\n\n\t\tborders = this._getBorderSizes();\n\t\tcontentWidth += borders.horizontal;\n\t\tcontentHeight += borders.vertical;\n\n\t\t// GS-149 & GS-150: By default this code only increases the container sizes, because of that, the cell sizes\n\t\t// are also increased. Keep this code here in the case if something goes wrong\n\t\t/*\n\t\tif(this.$root){\n\t\t\tcontentWidth += 1;\n\t\t\tcontentHeight += 1;\n\t\t}\n\t\t*/\n\t\treturn {\n\t\t\twidth: contentWidth,\n\t\t\theight: contentHeight\n\t\t};\n\t};\n\n\tLayout.prototype._cleanElSize = function(value){\n\t\treturn ((value || \"\").toString().replace(\"px\", \"\") * 1 || 0);\n\t};\n\tLayout.prototype._getBoxStyles = function(div){\n\t\tvar computed = null;\n\t\tif(window.getComputedStyle){\n\t\t\tcomputed = window.getComputedStyle(div, null);\n\t\t}else{\n\t\t\t//IE with elem.currentStyle does not calculate sizes from %, so will use the default approach\n\t\t\tcomputed = {\n\t\t\t\t\"width\":div.clientWidth,\n\t\t\t\t\"height\":div.clientHeight\n\t\t\t};\n\t\t}\n\t\tvar properties = [\n\t\t\t\"width\",\n\t\t\t\"height\",\n\n\t\t\t\"paddingTop\",\n\t\t\t\"paddingBottom\",\n\t\t\t\"paddingLeft\",\n\t\t\t\"paddingRight\",\n\n\t\t\t\"borderLeftWidth\",\n\t\t\t\"borderRightWidth\",\n\t\t\t\"borderTopWidth\",\n\t\t\t\"borderBottomWidth\"\n\t\t];\n\t\tvar styles = {\n\t\t\tboxSizing:(computed.boxSizing == \"border-box\")\n\t\t};\n\n\t\tif(computed.MozBoxSizing){\n\t\t\tstyles.boxSizing = (computed.MozBoxSizing == \"border-box\");\n\t\t}\n\t\tfor(var i =0; i < properties.length; i++){\n\t\t\tstyles[properties[i]] = computed[properties[i]] ? this._cleanElSize(computed[properties[i]]) : 0;\n\t\t}\n\n\n\t\tvar box = {\n\t\t\thorPaddings : (styles.paddingLeft + styles.paddingRight + styles.borderLeftWidth + styles.borderRightWidth),\n\t\t\tvertPaddings : (styles.paddingTop + styles.paddingBottom + styles.borderTopWidth + styles.borderBottomWidth),\n\t\t\tborderBox: styles.boxSizing,\n\t\t\tinnerWidth : styles.width,\n\t\t\tinnerHeight : styles.height,\n\t\t\touterWidth : styles.width,\n\t\t\touterHeight : styles.height\n\t\t};\n\n\n\t\tif(box.borderBox){\n\t\t\tbox.innerWidth -= box.horPaddings;\n\t\t\tbox.innerHeight -= box.vertPaddings;\n\t\t}else{\n\t\t\tbox.outerWidth += box.horPaddings;\n\t\t\tbox.outerHeight += box.vertPaddings;\n\t\t}\n\n\t\treturn box;\n\t};\n\n\tLayout.prototype._getAutosizeMode = function(config){\n\t\tvar res = {x:false, y:false};\n\t\tif(config === \"xy\"){\n\t\t\tres.x = res.y = true;\n\t\t}else if(config === \"y\" || config === true){\n\t\t\tres.y = true;\n\t\t}else if(config === \"x\"){\n\t\t\tres.x = true;\n\t\t}\n\t\treturn res;\n\t};\n\n\tLayout.prototype.autosize = function(mode) {\n\t\tvar res = this._getAutosizeMode(mode);\n\t\tvar boxSizes = this._getBoxStyles(this.$container);\n\t\tvar contentSizes = this.getContentSize(mode);\n\n\t\tvar node = this.$container;\n\t\tif(res.x){\n\t\t\tif(boxSizes.borderBox){\n\t\t\t\tcontentSizes.width += boxSizes.horPaddings;\n\t\t\t}\n\t\t\tnode.style.width = contentSizes.width + \"px\";\n\t\t}\n\t\tif(res.y){\n\t\t\tif(boxSizes.borderBox){\n\t\t\t\tcontentSizes.height += boxSizes.vertPaddings;\n\t\t\t}\n\t\t\tnode.style.height = contentSizes.height + \"px\";\n\t\t}\n\t};\n\n\tLayout.prototype.getSize = function () {\n\t\tthis._sizes = [];\n\t\tvar width = 0;\n\t\tvar minWidth = 0;\n\t\tvar maxWidth = 100000000000;\n\t\tvar height = 0;\n\t\tvar maxHeight = 100000000000;\n\t\tvar minHeight = 0;\n\n\t\tfor (var i = 0; i < this.$cells.length; i++) {\n\n\t\t\tvar size = this._sizes[i] = this.$cells[i].getSize();\n\t\t\tif (this.$cells[i].$config.hidden) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (this._xLayout) {\n\t\t\t\tif (!size.width && size.minWidth) {\n\t\t\t\t\twidth += size.minWidth;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\twidth += size.width;\n\t\t\t\t}\n\t\t\t\tmaxWidth += size.maxWidth;\n\t\t\t\tminWidth += size.minWidth;\n\t\t\t\theight = Math.max(height, size.height);\n\t\t\t\tmaxHeight = Math.min(maxHeight, size.maxHeight); // min of maxHeight\n\t\t\t\tminHeight = Math.max(minHeight, size.minHeight); // max of minHeight\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (!size.height && size.minHeight) {\n\t\t\t\t\theight += size.minHeight;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\theight += size.height;\n\t\t\t\t}\n\t\t\t\tmaxHeight += size.maxHeight;\n\t\t\t\tminHeight += size.minHeight;\n\t\t\t\twidth = Math.max(width, size.width);\n\t\t\t\tmaxWidth = Math.min(maxWidth, size.maxWidth); // min of maxWidth\n\t\t\t\tminWidth = Math.max(minWidth, size.minWidth); // max of minWidth\n\t\t\t}\n\t\t}\n\t\tvar self = _super.prototype.getSize.call(this);\n\t\t// maxWidth\n\t\tif (self.maxWidth >= 100000) {\n\t\t\tself.maxWidth = maxWidth;\n\t\t}\n\t\t// maxHeight\n\t\tif (self.maxHeight >= 100000) {\n\t\t\tself.maxHeight = maxHeight;\n\t\t}\n\t\t// minWidth\n\t\tself.minWidth = self.minWidth !== self.minWidth ? 0 : self.minWidth;// || self.width || Math.max(minWidth, width);\n\t\t// minHeight\n\t\tself.minHeight = self.minHeight !== self.minHeight ? 0 : self.minHeight;//self.minHeight || self.height || Math.max(minHeight, height);\n\t\t// sizes with paddings and margins\n\t\tif (this._xLayout) {\n\t\t\tself.minWidth += this.$config.margin * (this.$cells.length) || 0;\n\t\t\tself.minWidth += this.$config.padding * 2 || 0;\n\t\t\tself.minHeight += (this.$config.padding * 2) || 0;\n\t\t}\n\t\telse {\n\t\t\tself.minHeight += this.$config.margin * (this.$cells.length) || 0;\n\t\t\tself.minHeight += (this.$config.padding * 2) || 0;\n\t\t}\n\t\t\n\t\treturn self;\n\t};\n\t// calc total gravity and free space\n\tLayout.prototype._calcFreeSpace = function (s, cell, xLayout) {\n\t\tvar min = xLayout ? cell.minWidth : cell.minHeight;\n\t\tvar max = xLayout ? cell.maxWidth : cell.maxWidth;\n\t\tvar side = s;\n\t\tif (!side) {\n\t\t\tside = Math.floor(this._free / this._gravity * cell.gravity);\n\t\t\tif (side > max) {\n\t\t\t\tside = max;\n\t\t\t\tthis._free -= side;\n\t\t\t\tthis._gravity -= cell.gravity;\n\t\t\t}\n\t\t\tif (side < min) {\n\t\t\t\tside = min;\n\t\t\t\tthis._free -= side;\n\t\t\t\tthis._gravity -= cell.gravity;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tif (side > max) {\n\t\t\t\tside = max;\n\t\t\t}\n\t\t\tif (side < min) {\n\t\t\t\tside = min;\n\t\t\t}\n\t\t\tthis._free -= side;\n\t\t}\n\t\treturn side;\n\t};\n\tLayout.prototype._calcSize = function (s, size, xLayout) {\n\t\tvar side = s;\n\t\tvar min = xLayout ? size.minWidth : size.minHeight;\n\t\tvar max = xLayout ? size.maxWidth : size.maxHeight;\n\t\tif (!side) {\n\t\t\tside = Math.floor(this._free / this._gravity * size.gravity);\n\t\t}\n\t\tif (side > max) {\n\t\t\tside = max;\n\t\t}\n\t\tif (side < min) {\n\t\t\tside = min;\n\t\t}\n\t\treturn side;\n\t};\n\n\tLayout.prototype._configureBorders = function(){\n\t\tif(this.$root){\n\t\t\tthis._setBorders([\n\t\t\t\tthis._borders.left,\n\t\t\t\tthis._borders.top,\n\t\t\t\tthis._borders.right,\n\t\t\t\tthis._borders.bottom\n\t\t\t],\n\t\t\tthis);\n\t\t}\n\n\t\tvar borderClass = this._xLayout ? this._borders.right : this._borders.bottom;\n\n\t\tvar cells = this.$cells;\n\n\t\tvar lastVisibleIndex = cells.length - 1;\n\t\tfor(var i = lastVisibleIndex; i >= 0; i--){\n\t\t\tif (!cells[i].$config.hidden) {\n\t\t\t\tlastVisibleIndex = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tfor (var i = 0; i < cells.length; i++) {\n\t\t\tif (cells[i].$config.hidden) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tvar lastCell = i >= lastVisibleIndex;\n\t\t\tvar borderColorClass = \"\";\n\t\t\tif(!lastCell && cells[i + 1]){\n\t\t\t\tif(cells[i + 1].$config.view == \"scrollbar\"){\n\t\t\t\t\tif(this._xLayout){\n\t\t\t\t\t\tlastCell = true;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tborderColorClass = \"gantt_layout_cell_border_transparent\";\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t}\n\n\n\t\t\tthis._setBorders(lastCell ? [] : [borderClass, borderColorClass], cells[i]);\n\t\t}\n\t};\n\n\tLayout.prototype._updateCellVisibility = function(){\n\t\tvar oldVisibleCells = this._visibleCells || {};\n\t\tvar firstCall = !this._visibleCells;\n\t\tvar visibleCells = {};\n\t\tvar cell = null;\n\t\tvar parentVisibility = [];\n\t\tfor (var i = 0; i < this._sizes.length; i++) {\n\t\t\tcell = this.$cells[i];\n\t\t\tif (cell.$config.hide_empty){\n\t\t\t\tparentVisibility.push(cell);\n\t\t\t}\n\n\t\t\tif (!firstCall && cell.$config.hidden && oldVisibleCells[cell.$id]) {\n\t\t\t\tcell._hide(true);\n\t\t\t}else if(!cell.$config.hidden && !oldVisibleCells[cell.$id]){\n\t\t\t\tcell._hide(false);\n\t\t\t}\n\n\t\t\tif(!cell.$config.hidden){\n\t\t\t\tvisibleCells[cell.$id] = true;\n\t\t\t}\n\t\t}\n\t\tthis._visibleCells = visibleCells;\n\n\t\t// GS-27. A way to hide the whole cell if all its children are hidden\n\t\tfor (var i = 0; i < parentVisibility.length; i++) {\n\t\t\tvar cell = parentVisibility[i];\n\t\t\tvar children = cell.$cells;\n\t\t\tvar hideCell = true;\n\t\t\tchildren.forEach(function(child){\n\t\t\t\tif (!child.$config.hidden && !child.$config.resizer){\n\t\t\t\t\thideCell = false;\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\tcell.$config.hidden = hideCell;\n\t\t}\n\t};\n\n\tLayout.prototype.setSize = function (x, y) {\n\t\tthis._configureBorders();\n\t\t_super.prototype.setSize.call(this, x, y);\n\t\ty = this.$lastSize.contentY;\n\t\tx = this.$lastSize.contentX;\n\n\t\tvar padding = (this.$config.padding || 0);\n\t\tthis.$view.style.padding = padding + \"px\";\n\t\tthis._gravity = 0;\n\t\tthis._free = this._xLayout ? x : y;\n\t\tthis._free -= padding * 2;\n\t\t// calc all gravity\n\n\t\tvar cell,\n\t\t\tsize;\n\n\t\tthis._updateCellVisibility();\n\n\t\tfor (var i = 0; i < this._sizes.length; i++) {\n\t\t\tcell = this.$cells[i];\n\n\t\t\tif (cell.$config.hidden) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tvar margin = (this.$config.margin || 0);\n\t\t\tif(cell.$name == \"resizer\" && !margin){\n\t\t\t\tmargin = -1;\n\t\t\t}\n\n\t\t\t// set margins to child cell\n\t\t\tvar cellView = cell.$view;\n\n\t\t\tvar marginSide = this._xLayout ? \"marginRight\" : \"marginBottom\";\n\t\t\tif (i !== this.$cells.length - 1) {\n\t\t\t\tcellView.style[marginSide] = margin + \"px\";\n\t\t\t\tthis._free -= margin; // calc free space without margin\n\t\t\t}\n\t\t\tsize = this._sizes[i];\n\t\t\tif (this._xLayout) {\n\t\t\t\tif (!size.width) {\n\t\t\t\t\tthis._gravity += size.gravity;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (!size.height) {\n\t\t\t\t\tthis._gravity += size.gravity;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor (var i = 0; i < this._sizes.length; i++) {\n\t\t\tcell = this.$cells[i];\n\n\t\t\tif (cell.$config.hidden) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tsize = this._sizes[i];\n\t\t\tvar width = size.width;\n\t\t\tvar height = size.height;\n\t\t\tif (this._xLayout) {\n\t\t\t\tthis._calcFreeSpace(width, size, true);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis._calcFreeSpace(height, size, false);\n\t\t\t}\n\t\t}\n\t\tfor (var i = 0; i < this.$cells.length; i++) {\n\t\t\tcell = this.$cells[i];\n\n\t\t\tif (cell.$config.hidden) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tsize = this._sizes[i];\n\t\t\tvar dx = void 0;\n\t\t\tvar dy = void 0;\n\t\t\tif (this._xLayout) {\n\t\t\t\tdx = this._calcSize(size.width, size, true);\n\t\t\t\tdy = y - padding * 2; // layout height without paddings\n\t\t\t}\n\t\t\telse {\n\t\t\t\tdx = x - padding * 2; // layout width without paddings\n\t\t\t\tdy = this._calcSize(size.height, size, false);\n\t\t\t}\n\n\t\t\tcell.setSize(dx, dy);\n\t\t}\n\n\t};\n\n\treturn Layout;\n}(Cell));\n\nexport default Layout;","import __extends from \"../../../utils/extends\";\nimport Layout from \"./layout\";\nimport Cell from \"./cell\";\n\nvar ViewLayout = (function (_super) {\n\t\"use strict\";\n\n\t__extends(ViewLayout, _super);\n\tfunction ViewLayout(parent, config, factory) {\n\t\tvar _this = _super.apply(this, arguments) || this;\n\t\tfor (var i = 0; i < _this.$cells.length; i++) {\n\t\t\t_this.$cells[i].$config.hidden = (i !== 0);\n\t\t}\n\t\t_this.$cell = _this.$cells[0];\n\t\t_this.$name = \"viewLayout\";\n\n\t\treturn _this;\n\t}\n\tViewLayout.prototype.cell = function (id) {\n\t\tvar cell = _super.prototype.cell.call(this, id);\n\t\tif (!cell.$view) {\n\t\t\tthis.$fill(null, this);\n\t\t}\n\t\treturn cell;\n\t};\n\tViewLayout.prototype.moveView = function (view) {\n\t\tvar body = this.$view;\n\t\tif (this.$cell) {\n\t\t\tthis.$cell.$config.hidden = true;\n\t\t\tbody.removeChild(this.$cell.$view);\n\t\t}\n\t\tthis.$cell = view;\n\t\tbody.appendChild(view.$view);\n\t};\n\tViewLayout.prototype.setSize = function (x, y) {\n\t\tCell.prototype.setSize.call(this, x, y);\n\t};\n\n\tViewLayout.prototype.setContentSize = function(){\n\t\tvar size = this.$lastSize;\n\t\tthis.$cell.setSize(size.contentX, size.contentY);\n\t};\n\n\tViewLayout.prototype.getSize = function () {\n\t\tvar sizes = _super.prototype.getSize.call(this);\n\t\tif (this.$cell) {\n\t\t\tvar cellSize = this.$cell.getSize();\n\t\t\tif (this.$config.byMaxSize) {\n\t\t\t\tfor (var i = 0; i < this.$cells.length; i++) {\n\t\t\t\t\tvar otherCell = this.$cells[i].getSize();\n\t\t\t\t\tfor (var cell in cellSize) {\n\t\t\t\t\t\tcellSize[cell] = Math.max(cellSize[cell], otherCell[cell]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (var size in sizes) {\n\t\t\t\tsizes[size] = sizes[size] || cellSize[size];\n\t\t\t}\n\t\t\tsizes.gravity = Math.max(sizes.gravity, cellSize.gravity);\n\t\t}\n\t\treturn sizes;\n\t};\n\treturn ViewLayout;\n}(Layout));\n\nexport default ViewLayout;","import __extends from \"../../../utils/extends\";\nimport * as utils from \"../../../utils/utils\";\nimport Cell from \"./cell\";\n\nvar ViewCell = (function (_super) {\n\t\"use strict\";\n\n\t__extends(ViewCell, _super);\n\tfunction ViewCell(parent, config, factory) {\n\n\t\tvar _this = _super.apply(this, arguments) || this;\n\n\t\tif(config.view){\n\t\t\tif(config.id){\n\t\t\t\t// pass id to the nested view\n\t\t\t\tthis.$id = utils.uid();\n\t\t\t}\n\t\t\tvar childConfig = utils.copy(config);\n\t\t\tdelete childConfig.config;\n\t\t\tdelete childConfig.templates;\n\n\t\t\tthis.$content = this.$factory.createView(config.view, this, childConfig, this);\n\t\t\tif(!this.$content)\n\t\t\t\treturn false;\n\t\t}\n\n\t\t_this.$name = \"viewCell\";\n\t\treturn _this;\n\t}\n\n\tViewCell.prototype.destructor = function(){\n\t\tthis.clear();\n\t\t_super.prototype.destructor.call(this);\n\t};\n\n\tViewCell.prototype.clear = function(){\n\n\t\tthis.$initialized = false;\n\n\t\t// call destructor\n\t\tif (this.$content){\n\t\t\tvar method = this.$content.unload || this.$content.destructor;\n\t\t\tif (method){\n\t\t\t\tmethod.call(this.$content);\n\t\t\t}\n\t\t}\n\n\t\t_super.prototype.clear.call(this);\n\n\t};\n\n\tViewCell.prototype.scrollTo = function(left, top){\n\n\t\tif(this.$content && this.$content.scrollTo){\n\t\t\tthis.$content.scrollTo(left, top);\n\t\t}else{\n\t\t\t_super.prototype.scrollTo.call(this, left, top);\n\t\t}\n\t};\n\n\tViewCell.prototype._setContentSize = function(x, y){\n\t\tvar borders = this._getBorderSizes();\n\t\tif(typeof x === \"number\"){\n\t\t\tvar outerX = x + borders.horizontal;\n\t\t\tthis.$config.width = outerX;\n\t\t}\n\t\tif(typeof y === \"number\"){\n\t\t\tvar outerY = y + borders.vertical;\n\t\t\tthis.$config.height = outerY;\n\t\t}\n\t};\n\n\tViewCell.prototype.setSize = function(x, y){\n\t\t_super.prototype.setSize.call(this, x, y);\n\n\t\tif(!this.$preResize && this.$content) {\n\t\t\tif (!this.$initialized) {\n\t\t\t\tthis.$initialized = true;\n\t\t\t\tvar header = this.$view.childNodes[0];\n\t\t\t\tvar content = this.$view.childNodes[1];\n\t\t\t\tif(!content) content = header;\n\n\t\t\t\t/*if(this.$content.$config){\n\t\t\t\t\tthis.$content.$config.width = this.$lastSize.contentX;\n\t\t\t\t\tthis.$content.$config.height = this.$lastSize.contentY;\n\t\t\t\t}*/\n\t\t\t\tthis.$content.init(content);\n\t\t\t}\n\t\t}\n\t};\n\n\tViewCell.prototype.setContentSize = function(){\n\t\tif(!this.$preResize && this.$content) {\n\t\t\tif (this.$initialized) {\n\t\t\t\tthis.$content.setSize(this.$lastSize.contentX, this.$lastSize.contentY);\n\t\t\t}\n\t\t}\n\t};\n\n\n\tViewCell.prototype.getContentSize = function(){\n\t\tvar size = _super.prototype.getContentSize.call(this);\n\n\t\tif(this.$content && this.$initialized){\n\t\t\tvar childSize = this.$content.getSize();\n\t\t\tsize.width = childSize.contentX === undefined ? childSize.width : childSize.contentX;\n\t\t\tsize.height = childSize.contentY === undefined ? childSize.height : childSize.contentY;\n\t\t}\n\n\t\tvar borders = this._getBorderSizes();\n\t\tsize.width += borders.horizontal;\n\t\tsize.height += borders.vertical;\n\n\t\treturn size;\n\t};\n\n\treturn ViewCell;\n}(Cell));\n\nexport default ViewCell;","import __extends from \"../../../utils/extends\";\nimport * as domHelpers from \"../utils/dom_helpers\";\nimport * as utils from \"../../../utils/utils\";\nimport Cell from \"./cell\";\n\nvar ResizerCell = (function (_super) {\n\t\"use strict\";\n\n\t__extends(ResizerCell, _super);\n\tfunction ResizerCell(parent, config, factory) {\n\t\tvar _this = _super.apply(this, arguments) || this;\n\n\t\tvar startBackSize, startFrontSize;\n\n\t\tfunction getPageCoordinates(e){\n\t\t\tvar x = e.pageX;\n\t\t\tvar y = e.pageY;\n\n\t\t\tif (e.touches){\n\t\t\t\tx =  e.touches[0].pageX;\n\t\t\t\ty =  e.touches[0].pageY;\n\t\t\t}\n\n\t\t\treturn {x:x,y:y};\n\t\t}\n\n\t\t_this._moveHandler = function (e) {\n\t\t\t_this._moveResizer(_this._resizer, getPageCoordinates(e).x, getPageCoordinates(e).y);\n\t\t};\n\t\t_this._upHandler = function (e) {\n\t\t\tvar newSizes = _this._getNewSizes();\n\t\t\tif(_this.callEvent(\"onResizeEnd\", [startBackSize, startFrontSize, newSizes ? newSizes.back : 0, newSizes ? newSizes.front : 0]) !== false){\n\t\t\t\t_this._setSizes();\n\t\t\t}\n\n\t\t\t_this._setBackground(false);\n\t\t\t_this._clearResizer();\n\t\t\t_this._clearListeneres();\n\n\t\t\tif (e.touches) _this.$gantt._prevent_touch_scroll = false;\n\t\t};\n\n\t\t_this._clearListeneres = function(){\n\t\t\tthis.$domEvents.detach(document, \"mouseup\", _this._upHandler);\n\t\t\tthis.$domEvents.detach(document, \"mousemove\", _this._moveHandler);\n\t\t\tthis.$domEvents.detach(document, \"mousemove\", _this._startOnMove);\n\t\t\tthis.$domEvents.detach(document, \"mouseup\", _this._cancelDND);\n\n\t\t\tthis.$domEvents.detach(document, \"touchend\", _this._upHandler);\n\t\t\tthis.$domEvents.detach(document, \"touchmove\", _this._startOnMove);\n\t\t\tthis.$domEvents.detach(document, \"touchstart\", _this._downHandler);\n\t\t};\n\n\t\t_this._callStartDNDEvent = function(){\n\t\t\tif (this._xMode) {\n\t\t\t\tstartBackSize = this._behind.$config.width || this._behind.$view.offsetWidth;\n\t\t\t\tstartFrontSize = this._front.$config.width || this._front.$view.offsetWidth;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tstartBackSize = this._behind.$config.height || this._behind.$view.offsetHeight;\n\t\t\t\tstartFrontSize = this._front.$config.height || this._front.$view.offsetHeight;\n\t\t\t}\n\n\t\t\tif(_this.callEvent(\"onResizeStart\", [startBackSize, startFrontSize]) === false){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t};\n\n\t\t_this._startDND = function(e){\n\t\t\tvar res = this._callStartDNDEvent();\n\t\t\tif(res === false){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar stop = false;\n\t\t\tthis._eachGroupItem(function(resizer){\n\t\t\t\tresizer._getSiblings();\n\t\t\t\tif(resizer._callStartDNDEvent() === false){\n\t\t\t\t\tstop = true;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif(stop){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t_this._moveHandler(e);\n\n\t\t\t_this.$domEvents.attach(document, \"mousemove\", _this._moveHandler);\n\t\t\t_this.$domEvents.attach(document, \"mouseup\", _this._upHandler);\n\t\t};\n\n\t\t_this._cancelDND = function(){\n\t\t\t_this._setBackground(false);\n\t\t\t_this._clearResizer();\n\t\t\t_this._clearListeneres();\n\t\t};\n\n\t\t_this._startOnMove = function(e){\n\t\t\t// don't scroll the timeline on touch devices\n\t\t\tif (e.touches){\n\t\t\t\t_this.$gantt._touch_drag = true;\n\t\t\t\t// GS-45. Don't scroll the timeline while dragging something on touch devices (e.g. resizer)\n\t\t\t\t_this.$gantt._prevent_touch_scroll = true;\n\t\t\t}\n\n\t\t\tif(_this._isPosChanged(e)){\n\t\t\t\t_this._clearListeneres();\n\t\t\t\t_this._startDND(e);\n\t\t\t}\n\t\t};\n\n\t\t_this._downHandler = function (e) {\n\t\t\t_this._getSiblings();\n\n\t\t\tif (_this._behind.$config.collapsed || _this._front.$config.collapsed) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t_this._setBackground(true);\n\t\t\t_this._resizer = _this._setResizer();\n\n\t\t\t_this._positions = {\n\t\t\t\tx: getPageCoordinates(e).x,\n\t\t\t\ty: getPageCoordinates(e).y,\n\t\t\t\ttimestamp: Date.now()\n\t\t\t};\n\n\t\t\t_this.$domEvents.attach(document, \"mousemove\", _this._startOnMove);\n\t\t\t_this.$domEvents.attach(document, \"mouseup\", _this._cancelDND);\n\t\t};\n\t\t_this.$name = \"resizer\";\n\t\treturn _this;\n\t}\n\tResizerCell.prototype.init = function () {\n\t\tvar _this = this;\n\t\t_super.prototype.init.call(this);\n\t\tthis._xMode = this.$config.mode === \"x\";\n\t\tif (this._xMode && !this.$config.width) {\n\t\t\tthis.$config.width = this.$config.minWidth = 1;\n\t\t}\n\t\telse if (!this._xMode && !this.$config.height) {\n\t\t\tthis.$config.height = this.$config.minHeight = 1;\n\t\t}\n\n\t\tthis.$config.margin = -1;\n\n\t\tthis.$domEvents.attach(this.$view, \"mousedown\", _this._downHandler);\n\n\t\tthis.$domEvents.attach(this.$view, \"touchstart\", _this._downHandler);\n\t\tthis.$domEvents.attach(this.$view, \"touchmove\",  _this._startOnMove);\n\t\tthis.$domEvents.attach(this.$view, \"touchend\",  _this._upHandler);\n\t};\n\tResizerCell.prototype.$toHTML = function () {\n\t\tvar mode = this.$config.mode;\n\t\tvar css = this.$config.css || \"\";\n\t\treturn \"<div class='gantt_layout_cell gantt_resizer gantt_resizer_\"+mode+\"'><div class='gantt_layout_content gantt_resizer_\" + mode + (css ? (\" \" + css) : \"\") + \"'></div></div>\";\n\t};\n\n\tResizerCell.prototype._clearResizer = function(){\n\t\tif(this._resizer){\n\t\t\tif(this._resizer.parentNode){\n\t\t\t\tthis._resizer.parentNode.removeChild(this._resizer);\n\t\t\t}\n\t\t\tthis._resizer = null;\n\t\t}\n\t};\n\n\tResizerCell.prototype._isPosChanged = function(e){\n\t\tif(!this._positions){\n\t\t\treturn false;\n\t\t}\n\n\t\tif(Math.abs(this._positions.x - e.pageX) > 3 || Math.abs(this._positions.y - e.pageY) > 3){\n\t\t\treturn true;\n\t\t}\n\n\t\tif(Date.now() - this._positions.timestamp > 300){\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t};\n\n\tResizerCell.prototype._getSiblings = function () {\n\t\tvar cells = this.$parent.getCells();\n\n\t\tif(this.$config.prev){\n\t\t\tthis._behind = this.$factory.getView(this.$config.prev);\n\t\t\tif(!(this._behind instanceof Cell)){\n\t\t\t\tthis._behind = this._behind.$parent;\n\t\t\t}\n\t\t}\n\t\tif(this.$config.next){\n\t\t\tthis._front = this.$factory.getView(this.$config.next);\n\t\t\tif(!(this._front instanceof Cell)){\n\t\t\t\tthis._front = this._behind.$parent;\n\t\t\t}\n\t\t}\n\n\t\tfor (var i = 0; i < cells.length; i++) {\n\t\t\tif (this === cells[i]) {\n\t\t\t\tif(!this._behind)\n\t\t\t\t\tthis._behind = cells[i - 1];\n\t\t\t\tif(!this._front)\n\t\t\t\t\tthis._front = cells[i + 1];\n\t\t\t}\n\t\t}\n\t};\n\tResizerCell.prototype._setBackground = function (state) {\n\t\tvar classes = \"gantt_resizing\";\n\t\tif (!state) {\n\t\t\tdomHelpers.removeClassName(this._behind.$view, classes);\n\t\t\tdomHelpers.removeClassName(this._front.$view, classes);\n\t\t\tdocument.body.classList.remove(\"gantt_noselect\");\n\t\t\treturn;\n\t\t}\n\t\tdomHelpers.addClassName(this._behind.$view, classes, true);\n\t\tdomHelpers.addClassName(this._front.$view, classes, true);\n\t\tdocument.body.classList.add(\"gantt_noselect\");\n\t};\n\tResizerCell.prototype._setResizer = function () {\n\t\tvar resizer = document.createElement(\"div\");\n\t\tresizer.className = \"gantt_resizer_stick\";\n\t\tthis.$view.appendChild(resizer);\n\t\tthis.$view.style.overflow = \"visible\";\n\t\tresizer.style.height = this.$view.style.height;\n\t\treturn resizer;\n\t};\n\n\tResizerCell.prototype._getDirection = function(x, y){\n\t\tvar shift;\n\t\tif (this._xMode) {\n\t\t\tshift = x - this._positions.x;\n\t\t}else{\n\t\t\tshift = y - this._positions.y;\n\t\t}\n\t\treturn shift ? shift < 0 ? -1 : 1 : 0;\n\t};\n\n\tResizerCell.prototype._getResizePosition = function(x, y){\n\t\tvar size;\n\t\tvar behindSide;\n\t\tvar behindMin;\n\t\tvar frontSide;\n\t\tvar frontMin;\n\t\tif (this._xMode) {\n\t\t\tsize = x - this._positions.x;\n\t\t\tbehindSide = this._behind.$config.width || this._behind.$view.offsetWidth;\n\t\t\tfrontSide = this._front.$config.width || this._front.$view.offsetWidth;\n\t\t\tbehindMin = this._behind.$config.minWidth;\n\t\t\tfrontMin = this._front.$config.minWidth;\n\t\t}\n\t\telse {\n\t\t\tsize = y - this._positions.y;\n\t\t\tbehindSide = this._behind.$config.height || this._behind.$view.offsetHeight;\n\t\t\tfrontSide = this._front.$config.height || this._front.$view.offsetHeight;\n\t\t\tbehindMin = this._front.$config.minHeight;\n\t\t\tfrontMin = this._front.$config.minHeight;\n\t\t}\n\t\tvar direction = this._getDirection(x, y);\n\t\tvar newBehindSide,\n\t\t\tnewFrontSide;\n\n\t\tif (direction === -1) {\n\t\t\tnewFrontSide = frontSide - size;\n\t\t\tnewBehindSide = behindSide - Math.abs(size);\n\n\t\t\tif (frontSide - size > this._front.$config.maxWidth) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (Math.abs(size) >= behindSide) {\n\t\t\t\tsize = -Math.abs(behindSide - 2);\n\t\t\t}\n\t\t\t// if min width\n\t\t\tif (behindSide - Math.abs(size) <= behindMin) {\n\t\t\t\t//this._resizer.style.background = \"red\";\n\t\t\t\tsize = -Math.abs(behindSide - behindMin);\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tnewFrontSide = frontSide - Math.abs(size);\n\t\t\tnewBehindSide = behindSide + size;\n\n\t\t\tif (behindSide + size > this._behind.$config.maxWidth) {\n\t\t\t\tsize = this._behind.$config.maxWidth - behindSide;\n\t\t\t\t// return;\n\t\t\t}\n\t\t\tif (Math.abs(size) >= frontSide) {\n\t\t\t\tsize = frontSide - 2;\n\t\t\t}\n\t\t\t// if min width\n\t\t\tif (frontSide - Math.abs(size) <= frontMin) {\n\t\t\t\tsize = Math.abs(frontSide - frontMin);\n\t\t\t}\n\t\t}\n\n\t\tif (direction === -1) {\n\t\t\tnewFrontSide = frontSide - size;\n\t\t\tnewBehindSide = behindSide - Math.abs(size);\n\t\t} else {\n\t\t\tnewFrontSide = frontSide - Math.abs(size);\n\t\t\tnewBehindSide = behindSide + size;\n\t\t}\n\n\t\treturn {\n\t\t\tsize: size,\n\t\t\tnewFrontSide: newFrontSide,\n\t\t\tnewBehindSide: newBehindSide\n\t\t};\n\t};\n\n\tResizerCell.prototype._getGroupName = function(){\n\t\tthis._getSiblings();\n\t\treturn this._front.$config.group || this._behind.$config.group;\n\t};\n\n\tResizerCell.prototype._eachGroupItem = function(callback, master){\n\t\tvar layout = this.$factory.getView(\"main\");\n\n\t\tvar group = this._getGroupName();\n\n\t\tvar resizers = layout.getCellsByType(\"resizer\");\n\t\tfor(var i = 0; i < resizers.length; i++) {\n\t\t\tif (resizers[i]._getGroupName() == group && resizers[i] != this) {\n\t\t\t\tcallback.call(master || this, resizers[i]);\n\t\t\t}\n\t\t}\n\t};\n\n\tResizerCell.prototype._getGroupResizePosition = function(x, y){\n\t\tvar sizes = this._getResizePosition(x, y);\n\n\t\tif(!this._getGroupName()){\n\t\t\treturn sizes;\n\t\t}\n\n\t\tvar positions = [sizes];\n\n\t\tthis._eachGroupItem(function(resizer){\n\t\t\tresizer._getSiblings();\n\t\t\tvar pos = utils.copy(this._positions);\n\t\t\tif(this._xMode){\n\t\t\t\tpos.x += (resizer._behind.$config.width - this._behind.$config.width);\n\t\t\t}else{\n\t\t\t\tpos.y += (resizer._behind.$config.height - this._behind.$config.height);\n\t\t\t}\n\t\t\tresizer._positions = pos;\n\t\t\tpositions.push(resizer._getResizePosition(x, y));\n\t\t});\n\n\t\tvar minMax;\n\t\tfor(var i =0; i < positions.length; i++){\n\t\t\tif(!positions[i]) return;\n\t\t\tif(minMax === undefined){\n\t\t\t\tminMax = positions[i];\n\t\t\t}else if(positions[i].newBehindSide > minMax.newBehindSide){\n\t\t\t\tminMax = positions[i];\n\t\t\t}\n\t\t}\n\n\t/*\tif(minMax != sizes){\n\t\t\tminMax.size = minMax.size;\n\t\t}*/\n\n\t\treturn minMax;\n\t};\n\n\tResizerCell.prototype._moveResizer = function (av, x, y) {\n\t\tif (x === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar sizes = this._getGroupResizePosition(x, y);\n\t\tif(!sizes)\n\t\t\treturn;\n\n\t\tif (Math.abs(sizes.size) === 1) {\n\t\t\treturn;\n\t\t}\n\t\tif (this._xMode) {\n\t\t\tav.style.left = sizes.size + 'px';\n\t\t\tthis._positions.nextX = sizes.size || 0;\n\t\t}\n\t\telse {\n\t\t\tav.style.top = sizes.size + 'px';\n\t\t\tthis._positions.nextY = sizes.size || 0;\n\t\t}\n\n\t\tthis.callEvent(\"onResize\", [sizes.newBehindSide, sizes.newFrontSide]);\n\t};\n\tResizerCell.prototype._setGravity = function (cell) {\n\t\tvar size = this._xMode ? \"offsetWidth\" : \"offsetHeight\";\n\t\tvar position = this._xMode ? this._positions.nextX : this._positions.nextY;\n\t\tvar frontSize = this._front.$view[size];\n\t\tvar behindSize = this._behind.$view[size];\n\t\tvar frontG = this._front.getSize().gravity;\n\t\tvar behindG = this._behind.getSize().gravity;\n\t\tvar newFrontG = (frontSize - position) / frontSize * frontG;\n\t\tvar newBehindG = (behindSize + position) / behindSize * behindG;\n\t\tif (cell !== \"front\") {\n\t\t\tthis._front.$config.gravity = newFrontG;\n\t\t}\n\t\tif (cell !== \"behind\") {\n\t\t\tthis._behind.$config.gravity = newBehindG;\n\t\t}\n\t};\n\n/*\tResizerCell.prototype.setSize = function(){\n\t\t_super.apply(this, arguments)\n\t};*/\n\n\tResizerCell.prototype._getNewSizes = function(){\n\t\tvar behindSize, frontSize, position;\n\n\t\tif(this._xMode){\n\t\t\tbehindSize = this._behind.$config.width;\n\t\t\tfrontSize = this._front.$config.width;\n\t\t\tposition = this._positions.nextX;\n\t\t}else{\n\t\t\tbehindSize = this._behind.$config.height;\n\t\t\tfrontSize = this._front.$config.height;\n\t\t\tposition = this._positions.nextY;\n\t\t}\n\n\t\tif(!frontSize && !behindSize){\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\tfront: frontSize ? ((frontSize - position) || 1) : 0,\n\t\t\tback: behindSize ? ((behindSize + position) || 1) : 0\n\t\t};\n\t};\n\n\tResizerCell.prototype._assignNewSizes = function(newSizes){\n\t\tthis._getSiblings();\n\t\tvar side = this._xMode ? 'width' : 'height';\n\n\t\t// if only gravity cells\n\t\tif (!newSizes) {\n\t\t\tthis._setGravity();\n\t\t}\n\t\telse {\n\t\t\tif (!newSizes.front) {\n\t\t\t\tthis._setGravity(\"behind\");\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis._front.$config[side] = newSizes.front;\n\t\t\t}\n\t\t\tif (!newSizes.back) {\n\t\t\t\tthis._setGravity(\"front\");\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis._behind.$config[side] = newSizes.back;\n\t\t\t}\n\t\t}\n\n\t};\n\n\tResizerCell.prototype._setSizes = function () {\n\t\tif (this._resizer) {\n\t\t\tthis.$view.removeChild(this._resizer);\n\t\t}\n\t\tvar newSizes = this._getNewSizes();\n\n\t\tif (this._positions.nextX || this._positions.nextY) {\n\t\t\tthis._assignNewSizes(newSizes);\n\n\t\t\tvar side = this._xMode ? 'width' : 'height';\n\t\t\tvar resizeValue;\n\t\t\tif(!newSizes || !newSizes.front){\n\t\t\t\tif(this._front.$config.group){\n\t\t\t\t\tresizeValue = {\n\t\t\t\t\t\tvalue: this._front.$config.gravity,\n\t\t\t\t\t\tisGravity: true\n\t\t\t\t\t};\n\t\t\t\t\tthis.$gantt.$layout._syncCellSizes(this._front.$config.group, resizeValue);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(!newSizes || !newSizes.back){\n\t\t\t\tif(this._behind.$config.group){\n\t\t\t\t\tresizeValue = {\n\t\t\t\t\t\tvalue: this._behind.$config.gravity,\n\t\t\t\t\t\tisGravity: true\n\t\t\t\t\t};\n\t\t\t\t\tthis.$gantt.$layout._syncCellSizes(this._behind.$config.group, resizeValue);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(newSizes){\n\t\t\t\tif(newSizes.front){\n\t\t\t\t\tif(this._front.$config.group){\n\t\t\t\t\t\tresizeValue = {\n\t\t\t\t\t\t\tvalue: this._front.$config[side],\n\t\t\t\t\t\t\tisGravity: false\n\t\t\t\t\t\t};\n\t\t\t\t\t\tthis.$gantt.$layout._syncCellSizes(this._front.$config.group, resizeValue);\n\t\t\t\t\t}\n\t\t\t\t} else if(newSizes.back){\n\t\t\t\t\tif(this._behind.$config.group){\n\t\t\t\t\t\tresizeValue = {\n\t\t\t\t\t\t\tvalue: this._behind.$config[side],\n\t\t\t\t\t\t\tisGravity: false\n\t\t\t\t\t\t};\n\t\t\t\t\t\tthis.$gantt.$layout._syncCellSizes(this._behind.$config.group, resizeValue);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(this._getGroupName()){\n\t\t\t\tthis.$factory.getView(\"main\").resize();\n\t\t\t}else{\n\t\t\t\tthis.$parent.resize();\n\t\t\t}\n\n\t\t}\n\t};\n\treturn ResizerCell;\n}(Cell));\n\nexport default ResizerCell;","import __extends from \"../../../utils/extends\";\nimport * as domHelpers from \"../utils/dom_helpers\";\nimport * as utils from \"../../../utils/utils\";\nimport env from \"../../../utils/env\";\nimport Cell from \"./cell\";\n\nvar ScrollbarCell = (function (_super) {\n\t\"use strict\";\n\n\tvar SCROLL_MODIFIER_KEYS = [\"altKey\", \"shiftKey\", \"metaKey\"]; // it's no way to disable ctrl+wheel\n\t__extends(ScrollbarCell, _super);\n\tfunction ScrollbarCell(parent, config, factory, gantt) {\n\n\t\tvar _this = _super.apply(this, arguments) || this;\n\t\tthis.$config = utils.mixin(config, {scroll: \"x\"});\n\t\t_this._scrollHorizontalHandler = utils.bind(_this._scrollHorizontalHandler, _this);\n\t\t_this._scrollVerticalHandler = utils.bind(_this._scrollVerticalHandler, _this);\n\t\t_this._outerScrollVerticalHandler = utils.bind(_this._outerScrollVerticalHandler, _this);\n\t\t_this._outerScrollHorizontalHandler = utils.bind(_this._outerScrollHorizontalHandler, _this);\n\t\t_this._mouseWheelHandler = utils.bind(_this._mouseWheelHandler, _this);\n\n\t\tthis.$config.hidden = true;\n\t\tvar size = gantt.config.scroll_size;\n\n\t\tif(gantt.env.isIE){\n\t\t\t// full element height/width must be bigger than just a browser scrollbar,\n\t\t\t// otherwise the scrollbar element won't be scrolled on click\n\t\t\tsize += 1;\n\t\t}\n\n\t\tif(this._isHorizontal()){\n\t\t\t_this.$config.height = size;\n\t\t\t_this.$parent.$config.height = size;\n\t\t}else{\n\t\t\t_this.$config.width = size;\n\t\t\t_this.$parent.$config.width = size;\n\t\t}\n\n\t\tthis.$config.scrollPosition = 0;\n\n\t\t_this.$name = \"scroller\";\n\t\treturn _this;\n\t}\n\n\tScrollbarCell.prototype.init = function(container){\n\t\tcontainer.innerHTML = this.$toHTML();\n\t\tthis.$view = container.firstChild;\n\n\t\tif(!this.$view){\n\t\t\tthis.init();\n\t\t}\n\t\tif(this._isVertical()){\n\t\t\tthis._initVertical();\n\t\t}else{\n\t\t\tthis._initHorizontal();\n\t\t}\n\t\tthis._initMouseWheel();\n\t\tthis._initLinkedViews();\n\t};\n\n\tScrollbarCell.prototype.$toHTML = function () {\n\t\tvar className = this._isHorizontal() ? \"gantt_hor_scroll\" : \"gantt_ver_scroll\";\n\t\treturn \"<div class='gantt_layout_cell \"+className+\"'><div style='\"+(this._isHorizontal() ? \"width:2000px\" : \"height:2000px\")+\"'></div></div>\";\n\t};\n\n\tScrollbarCell.prototype._getRootParent = function(){\n\t\tvar parent = this.$parent;\n\t\twhile(parent && parent.$parent){\n\t\t\tparent = parent.$parent;\n\t\t}\n\t\tif(parent){\n\t\t\treturn parent;\n\t\t}\n\t};\n\n\n\tfunction eachCell(root, res){\n\t\tres.push(root);\n\t\tif(root.$cells){\n\t\t\tfor(var i = 0; i < root.$cells.length; i++){\n\t\t\t\teachCell(root.$cells[i], res);\n\t\t\t}\n\t\t}\n\t}\n\tScrollbarCell.prototype._eachView = function(){\n\t\tvar res = [];\n\t\teachCell(this._getRootParent(), res);\n\t\treturn res;\n\t};\n\n\tScrollbarCell.prototype._getLinkedViews = function(){\n\t\tvar views = this._eachView();\n\t\tvar res = [];\n\t\tfor(var i = 0; i < views.length; i++){\n\t\t\tif(views[i].$config && ((this._isVertical() && views[i].$config.scrollY == this.$id) || (this._isHorizontal() && views[i].$config.scrollX == this.$id)) ){\n\t\t\t\tres.push(views[i]);\n\t\t\t}\n\t\t}\n\t\treturn res;\n\t};\n\n\n\tScrollbarCell.prototype._initHorizontal = function(){\n\t\tthis.$scroll_hor = this.$view;\n\t\tthis.$domEvents.attach(this.$view, \"scroll\", this._scrollHorizontalHandler);\n\n\t};\n\n\tScrollbarCell.prototype._initLinkedViews = function(){\n\t\tvar views = this._getLinkedViews();\n\t\tvar css = this._isVertical() ?\"gantt_layout_outer_scroll gantt_layout_outer_scroll_vertical\" : \"gantt_layout_outer_scroll gantt_layout_outer_scroll_horizontal\";\n\t\tfor(var i = 0; i < views.length; i++){\n\t\t\t//views[i].$config.css = [views[i].$config.css || \"\", css].join(\" \");\n\t\t\tdomHelpers.addClassName(views[i].$view || views[i].getNode(), css);\n\t\t}\n\t};\n\n\tScrollbarCell.prototype._initVertical = function(){\n\t\tthis.$scroll_ver = this.$view;\n\t\tthis.$domEvents.attach(this.$view, \"scroll\", this._scrollVerticalHandler);\n\t};\n\n\tScrollbarCell.prototype._updateLinkedViews = function(){\n\t};\n\n\tScrollbarCell.prototype._initMouseWheel = function(){\n\t\tvar ff = env.isFF;\n\t\tif (ff)\n\t\t\tthis.$domEvents.attach(this._getRootParent().$view, \"wheel\", this._mouseWheelHandler, {passive: false});\n\t\telse\n\t\t\tthis.$domEvents.attach(this._getRootParent().$view, \"mousewheel\", this._mouseWheelHandler, {passive: false});\n\t};\n\n\n\n\n\tScrollbarCell.prototype.scrollHorizontally = function(left){\n\t\tif(this._scrolling) return;\n\t\tthis._scrolling = true;\n\n\t\tthis.$scroll_hor.scrollLeft = left;\n\t\tthis.$config.codeScrollLeft = left;\n\t\tleft = this.$scroll_hor.scrollLeft;\n\n\t\tvar views = this._getLinkedViews();\n\t\tfor(var i = 0; i < views.length; i++){\n\t\t\tif(views[i].scrollTo){\n\t\t\t\tviews[i].scrollTo(left, undefined);\n\t\t\t}\n\t\t}\n\t\tvar oldSize = this.$config.scrollPosition;\n\t\tthis.$config.scrollPosition = left;\n\t\tthis.callEvent(\"onScroll\", [oldSize, left, this.$config.scroll]);\n\t\tthis._scrolling = false;\n\t};\n\tScrollbarCell.prototype.scrollVertically = function(top){\n\t\tif(this._scrolling) return;\n\t\tthis._scrolling = true;\n\n\t\tthis.$scroll_ver.scrollTop = top;\n\t\ttop = this.$scroll_ver.scrollTop;\n\n\t\tvar views = this._getLinkedViews();\n\n\t\tfor(var i = 0; i < views.length; i++){\n\t\t\tif(views[i].scrollTo){\n\t\t\t\tviews[i].scrollTo(undefined, top);\n\t\t\t}\n\t\t}\n\t\tvar oldSize = this.$config.scrollPosition;\n\t\tthis.$config.scrollPosition = top;\n\t\tthis.callEvent(\"onScroll\", [oldSize, top, this.$config.scroll]);\n\t\tthis._scrolling = false;\n\t};\n\n\tScrollbarCell.prototype._isVertical = function(){\n\t\treturn this.$config.scroll == \"y\";\n\t};\n\tScrollbarCell.prototype._isHorizontal = function(){\n\t\treturn this.$config.scroll == \"x\";\n\t};\n\tScrollbarCell.prototype._scrollHorizontalHandler = function (e) {\n\t\tif(this._isVertical() || this._scrolling){\n\t\t\treturn;\n\t\t}\n\n\t\t//in safari we can catch previous onscroll after setting new value from mouse-wheel event\n\t\t//set delay to prevent value drifiting\n\t\tif ((new Date()) - ( this._wheel_time || 0 ) < 100) return true;\n\t\t//if (this.$gantt._touch_scroll_active) return;\n\t\tvar left = this.$scroll_hor.scrollLeft;\n\n\t\tthis.scrollHorizontally(left);\n\n\t\tthis._oldLeft = this.$scroll_hor.scrollLeft;\n\t};\n\tScrollbarCell.prototype._outerScrollHorizontalHandler = function(e){\n\t\tif(this._isVertical()){\n\t\t\treturn;\n\t\t}\n\t};\n\n\tScrollbarCell.prototype.show = function(){\n\t\tthis.$parent.show();\n\t};\n\tScrollbarCell.prototype.hide = function(){\n\t\tthis.$parent.hide();\n\t};\n\n\tScrollbarCell.prototype._getScrollSize = function(){\n\t\tvar scrollSize = 0;\n\t\tvar outerSize = 0;\n\t\tvar isHorizontal = this._isHorizontal();\n\n\t\tvar linked = this._getLinkedViews();\n\t\tvar view;\n\t\tvar scrollProperty = isHorizontal ? \"scrollWidth\" : \"scrollHeight\",\n\t\t\tinnerSizeProperty = isHorizontal ? \"contentX\" : \"contentY\";\n\t\tvar outerProperty = isHorizontal ? \"x\" : \"y\";\n\t\tvar offset = this._getScrollOffset();\n\n\t\tfor(var i = 0; i < linked.length; i++){\n\t\t\tview = linked[i];\n\t\t\tif(!(view && view.$content && view.$content.getSize && !view.$config.hidden)) continue;\n\n\t\t\tvar sizes = view.$content.getSize();\n\t\t\tvar cellScrollSize;\n\t\t\tif(sizes.hasOwnProperty(scrollProperty)){\n\t\t\t\tcellScrollSize = sizes[scrollProperty];\n\t\t\t}else{\n\t\t\t\tcellScrollSize = sizes[innerSizeProperty];\n\t\t\t}\n\n\t\t\tif(offset){\n\t\t\t\t// precalculated vertical/horizontal offsets of scrollbar to emulate 4.x look\n\t\t\t\tif(sizes[innerSizeProperty] > sizes[outerProperty] && sizes[innerSizeProperty] > scrollSize && (cellScrollSize > (sizes[outerProperty] - offset + 2))){\n\t\t\t\t\tscrollSize = cellScrollSize + (isHorizontal ? 0 : 2);\n\t\t\t\t\touterSize = sizes[outerProperty];\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tvar nonScrollableSize = Math.max(sizes[innerSizeProperty] - cellScrollSize, 0);\n\t\t\t\tvar scrollableViewPortSize = Math.max(sizes[outerProperty] - nonScrollableSize, 0);\n\t\t\t\tcellScrollSize = cellScrollSize + nonScrollableSize;\n\n\t\t\t\tif(cellScrollSize > scrollableViewPortSize && (cellScrollSize > scrollSize) ){\n\t\t\t\t\t//|| (cellScrollSize === scrollSize && sizes[outerProperty] < outerSize) // same scroll width but smaller scrollable view port\n\n\t\t\t\t\tscrollSize = cellScrollSize;\n\t\t\t\t\touterSize = sizes[outerProperty];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\touterScroll: outerSize,\n\t\t\tinnerScroll: scrollSize\n\t\t};\n\t};\n\n\tScrollbarCell.prototype.scroll = function(position){\n\t\tif(this._isHorizontal()){\n\t\t\tthis.scrollHorizontally(position);\n\t\t}else{\n\t\t\tthis.scrollVertically(position);\n\t\t}\n\t};\n\n\tScrollbarCell.prototype.getScrollState = function(){\n\t\treturn {\n\t\t\tvisible: this.isVisible(),\n\t\t\tdirection: this.$config.scroll,\n\t\t\tsize: this.$config.outerSize,\n\t\t\tscrollSize: this.$config.scrollSize || 0,\n\t\t\tposition: this.$config.scrollPosition || 0\n\t\t};\n\t};\n\n\tScrollbarCell.prototype.setSize = function(width, height){\n\t\t_super.prototype.setSize.apply(this, arguments);\n\n\t\tvar scrollSizes = this._getScrollSize();\n\n\t\tvar ownSize = (this._isVertical() ? height : width) - this._getScrollOffset() + (this._isHorizontal() ? 1 : 0);\n\n\t\tif(scrollSizes.innerScroll && ownSize > scrollSizes.outerScroll){\n\t\t\tscrollSizes.innerScroll += (ownSize - scrollSizes.outerScroll);\n\t\t}\n\t\tthis.$config.scrollSize = scrollSizes.innerScroll;\n\n\t\tthis.$config.width = width;\n\t\tthis.$config.height = height;\n\t\tthis._setScrollSize(scrollSizes.innerScroll);\n\t};\n\n\tScrollbarCell.prototype.isVisible = function(){\n\t\treturn !!(this.$parent && this.$parent.$view.parentNode);\n\t};\n\n\tScrollbarCell.prototype.shouldShow = function(){\n\t\tvar scrollSizes = this._getScrollSize();\n\t\tif(!scrollSizes.innerScroll && (this.$parent && this.$parent.$view.parentNode)){\n\t\t\treturn false;\n\t\t}else if(scrollSizes.innerScroll && !(this.$parent && this.$parent.$view.parentNode)){\n\t\t\treturn true;\n\t\t}else{\n\t\t\treturn false;\n\t\t}\n\t};\n\n\tScrollbarCell.prototype.shouldHide = function(){\n\t\tvar scrollSizes = this._getScrollSize();\n\t\tif(!scrollSizes.innerScroll && (this.$parent && this.$parent.$view.parentNode)){\n\t\t\treturn true;\n\t\t}else{\n\t\t\treturn false;\n\t\t}\n\t};\n\n\n\tScrollbarCell.prototype.toggleVisibility = function(){\n\t\tif(this.shouldHide()){\n\t\t\tthis.hide();\n\t\t}else if(this.shouldShow()){\n\t\t\tthis.show();\n\t\t}\n\t};\n\n\tScrollbarCell.prototype._getScaleOffset = function(view){\n\t\tvar offset = 0;\n\t\tif(view && (view.$config.view == \"timeline\" || view.$config.view == \"grid\")){\n\t\t\toffset = view.$content.$getConfig().scale_height;\n\t\t}\n\t\treturn offset;\n\t};\n\n\tScrollbarCell.prototype._getScrollOffset = function(){\n\t\tvar offset = 0;\n\t\tif(this._isVertical()){\n\t\t\tvar parentLayout = this.$parent.$parent;\n\t\t\toffset = Math.max(\n\t\t\t\tthis._getScaleOffset(parentLayout.getPrevSibling(this.$parent.$id)),\n\t\t\t\tthis._getScaleOffset(parentLayout.getNextSibling(this.$parent.$id))\n\t\t\t\t);\n\t\t}else{\n\t\t\tvar linked = this._getLinkedViews();\n\n\t\t\tfor (var i = 0; i < linked.length; i++) {\n\t\t\t\tvar view = linked[i],\n\t\t\t\t\tvparent = view.$parent;\n\t\t\t\tvar cells = vparent.$cells;\n\n\t\t\t\tvar last = cells[cells.length - 1];\n\n\t\t\t\tif (last && last.$config.view == \"scrollbar\" && last.$config.hidden === false) {\n\t\t\t\t\toffset = last.$config.width;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\t\treturn offset || 0;\n\t};\n\n\tScrollbarCell.prototype._setScrollSize = function(size){\n\t\tvar property = this._isHorizontal() ? \"width\" : \"height\";\n\t\tvar scrollbar = this._isHorizontal() ? this.$scroll_hor : this.$scroll_ver;\n\n\t\tvar offset = this._getScrollOffset();\n\n\t\tvar node = scrollbar.firstChild;\n\n\t\tif(offset){\n\t\t\tif(this._isVertical()){\n\n\t\t\t\tthis.$config.outerSize = (this.$config.height - offset + 3);\n\t\t\t\tscrollbar.style.height = this.$config.outerSize + \"px\";\n\t\t\t\tscrollbar.style.top = (offset-1) + \"px\";\n\t\t\t\tdomHelpers.addClassName(scrollbar, this.$parent._borders.top);\n\t\t\t\tdomHelpers.addClassName(scrollbar.parentNode, \"gantt_task_vscroll\");\n\t\t\t}else{\n\t\t\t\tthis.$config.outerSize = (this.$config.width - offset + 1);\n\t\t\t\tscrollbar.style.width = this.$config.outerSize + \"px\";\n\t\t\t\t//domHelpers.addClassName(scrollbar, this.$parent._borders.right);\n\t\t\t}\n\t\t}else{\n\t\t\tscrollbar.style.top = \"auto\";\n\t\t\tdomHelpers.removeClassName(scrollbar, this.$parent._borders.top);\n\t\t\tdomHelpers.removeClassName(scrollbar.parentNode, \"gantt_task_vscroll\");\n\t\t\tthis.$config.outerSize = this.$config.height;\n\t\t}\n\n\t\tnode.style[property] = size + \"px\";\n\t};\n\n\tScrollbarCell.prototype._scrollVerticalHandler = function (e) {\n\t\tif(this._scrollHorizontalHandler() || this._scrolling){\n\t\t\treturn;\n\t\t}\n\n\t\t//if (this.$gantt._touch_scroll_active) return;\n\t\tvar top = this.$scroll_ver.scrollTop;\n\t\tvar prev = this._oldTop;\n\t\tif(top == prev) return;\n\n\t\tthis.scrollVertically(top);\n\n\t\tthis._oldTop = this.$scroll_ver.scrollTop;\n\n\t};\n\tScrollbarCell.prototype._outerScrollVerticalHandler = function(e){\n\t\tif(this._scrollHorizontalHandler()){\n\t\t\treturn;\n\t\t}\n\t};\n\n\tScrollbarCell.prototype._checkWheelTarget = function(targetNode){\n\t\tvar connectedViews = this._getLinkedViews().concat(this);\n\n\t\tfor(var i = 0; i < connectedViews.length; i++){\n\t\t\tvar node = connectedViews[i].$view;\n\t\t\tif(domHelpers.isChildOf(targetNode, node)){\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t};\n\n\tScrollbarCell.prototype._mouseWheelHandler = function(e){\n\t\tvar target = e.target || e.srcElement;\n\n\t\tif(!this._checkWheelTarget(target))\n\t\t\treturn;\n\n\t\tthis._wheel_time = new Date();\n\n\t\tvar res = {};\n\n\t\tvar wheelSpeed = {x: 1, y: 1};\n\t\tvar wheelSpeedConfig = this.$gantt.config.wheel_scroll_sensitivity;\n\n\t\tif (typeof wheelSpeedConfig == \"number\" && !!wheelSpeedConfig) {\n\t\t\twheelSpeed = {x: wheelSpeedConfig, y: wheelSpeedConfig};\n\t\t}\n\t\telse if (({}).toString.apply(wheelSpeedConfig) == \"[object Object]\") {\n\t\t\twheelSpeed = {x: wheelSpeedConfig.x, y: wheelSpeedConfig.y};\n\t\t}\n\n\t\tvar ff = env.isFF;\n\t\tvar deltaX = ff ? (e.deltaX) : e.wheelDeltaX;\n\t\tvar deltaY = ff ? (e.deltaY) : e.wheelDelta;\n\n\t\tvar multiplier = -20;\n\t\tif (ff) {\n\t\t\t// GS-1500. Firefox had many changes during the versions\n\t\t\tconst version = parseInt(navigator.userAgent.split(\"Firefox/\")[1]);\n\t\t\tif (version <= 87){\n\t\t\t\tif (e.deltaMode !== 0) {\n\t\t\t\t\tmultiplier = -40;\n\t\t\t\t} else {\n\t\t\t\t\tmultiplier = -10;\n\t\t\t\t}\n\t\t\t} else if (version <= 90){\n\t\t\t\tmultiplier = -3;\n\t\t\t} else if (version <= 96){\n\t\t\t\tmultiplier = -1.5;\n\t\t\t} else {\n\t\t\t\tmultiplier = -1;\n\t\t\t}\n\t\t}\n\n\t\tvar wx = ff ? (deltaX * multiplier * wheelSpeed.x) : deltaX * 2 * wheelSpeed.x;\n\t\tvar wy = ff ? (deltaY * multiplier * wheelSpeed.y) : deltaY * wheelSpeed.y;\n\n\t\tvar horizontalScrollModifier = this.$gantt.config.horizontal_scroll_key;\n\n\t\tif (horizontalScrollModifier !== false) {\n\t\t\tif (SCROLL_MODIFIER_KEYS.indexOf(horizontalScrollModifier) >= 0) {\n\t\t\t\tif(e[horizontalScrollModifier] && !(e.deltaX || e.wheelDeltaX)){\n\t\t\t\t\t// shift+mousewheel for horizontal scroll\n\t\t\t\t\twx = wy*2;\n\t\t\t\t\twy = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\n\t\tif (wx && Math.abs(wx) > Math.abs(wy)){\n\t\t\tif(this._isVertical()){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif(res.x) return true;//no horisontal scroll, must not block scrolling\n\t\t\tif(!this.$scroll_hor || !this.$scroll_hor.offsetWidth) return true;\n\n\t\t\tvar dir  = wx/-40;\n\t\t\tvar oldLeft = this._oldLeft;\n\t\t\tvar left = oldLeft+dir*30;\n\t\t\tthis.scrollHorizontally(left);\n\t\t\tthis.$scroll_hor.scrollLeft = left;\n\t\t\t// not block scroll if position hasn't changed\n\t\t\tif(oldLeft == this.$scroll_hor.scrollLeft){\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tthis._oldLeft = this.$scroll_hor.scrollLeft;\n\t\t} else {\n\t\t\tif(this._isHorizontal()){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif(res.y) return true;//no vertical scroll, must not block scrolling\n\t\t\tif(!this.$scroll_ver || !this.$scroll_ver.offsetHeight) return true;\n\n\t\t\tvar dir  = wy/-40;\n\t\t\tif (typeof wy == \"undefined\")\n\t\t\t\tdir = e.detail;\n\n\t\t\tvar oldTop = this._oldTop;\n\t\t\tvar top = this.$scroll_ver.scrollTop+dir*30;\n\n\t\t\t//if(!this.$gantt.config.prevent_default_scroll &&\n\t\t\t//\t(this.$gantt._cached_scroll_pos && ((this.$gantt._cached_scroll_pos.y == top) || (this.$gantt._cached_scroll_pos.y <= 0 && top <= 0)))) return true;\n\n\n\t\t\tthis.scrollVertically(top);\n\t\t\tthis.$scroll_ver.scrollTop = top;\n\n\t\t\t// not block scroll if position hasn't changed\n\t\t\tif(oldTop == this.$scroll_ver.scrollTop){\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tthis._oldTop = this.$scroll_ver.scrollTop;\n\t\t}\n\n\t\tif (e.preventDefault)\n\t\t\te.preventDefault();\n\t\te.cancelBubble=true;\n\t\treturn false;\n\t};\n\n\treturn ScrollbarCell;\n})(Cell);\n\nexport default ScrollbarCell;","import * as utils from \"../../../utils/utils\";\nimport env from \"../../../utils/env\";\n\nvar createStaticBgHelper = function(utils, env){\n\n\tvar canvasBgCache = {};\n\tvar staticBgStyleId = \"gantt-static-bg-styles-\" + utils.uid();\n\n\tfunction renderBgCanvas(targetNode, config, scale, totalHeight, itemHeight) {\n\t\tif (!config.static_background && !config.timeline_placeholder) return;\n\n\t\tvar canvas = document.createElement(\"canvas\");\n\t\tif (!canvas.getContext) return; // if canvas is not supported (for IE8)\n\n\t\t// clear previous bg data\n\t\ttargetNode.innerHTML = \"\";\n\n\t\tvar styleParams = getCellStyles(targetNode);\n\t\tvar png = createBackgroundTiles(styleParams, config, scale, itemHeight);\n\t\tvar bgDivs = createBgDivs(png, config, scale, totalHeight);\n\n\t\tvar fragment = document.createDocumentFragment();\n\n\t\tbgDivs.forEach(function (div) {\n\t\t\tfragment.appendChild(div);\n\t\t});\n\n\t\ttargetNode.appendChild(fragment);\n\t}\n\n\tfunction getColumnWidths(scale) {\n\t\tvar widths = scale.width;\n\t\tvar differentWidths = {};\n\t\tfor (var i = 0; i < widths.length; i++) {\n\t\t\tif (widths[i] * 1)\n\t\t\t\tdifferentWidths[widths[i]] = true;\n\t\t}\n\t\treturn differentWidths;\n\t}\n\n\tfunction parseRgb(rgbCss) {\n\t\tvar result = /^rgba?\\(([\\d]{1,3}), *([\\d]{1,3}), *([\\d]{1,3}) *(,( *[\\d.]+ *))?\\)$/i.exec(rgbCss);\n\t\treturn result ? {\n\t\t\tr: result[1] * 1,\n\t\t\tg: result[2] * 1,\n\t\t\tb: result[3] * 1,\n\t\t\ta: (result[5] * 255) || 255\n\t\t} : null;\n\t}\n\n\tfunction getUrlFromCache(key) {\n\t\treturn canvasBgCache[key] || null;\n\t}\n\n\tfunction getHashKey(width, height, cellStyles) {\n\t\treturn (width + '' + height + cellStyles.bottomBorderColor + cellStyles.rightBorderColor).replace(/[^\\w\\d]/g, '');\n\t}\n\n\tfunction getStyleElement() {\n\t\tvar style = document.getElementById(staticBgStyleId);\n\n\t\tif (!style) {\n\t\t\tstyle = document.createElement(\"style\");\n\t\t\tstyle.id = staticBgStyleId;\n\t\t\tdocument.body.appendChild(style);\n\t\t}\n\t\treturn style;\n\t}\n\n\tfunction cleanup() {\n\t\tvar style = document.getElementById(staticBgStyleId);\n\t\tif (style && style.parentNode) {\n\t\t\tstyle.parentNode.removeChild(style);\n\t\t}\n\t}\n\n\tfunction cacheUrl(key, url) {\n\t\tcanvasBgCache[key] = url;\n\t}\n\n\tfunction generateBgUrl(width, height, cellStyles) {\n\t\t// use relatively big bg image about 500*500px in order to reduce misalignments due browser zoom\n\t\tvar cols = Math.floor(500 / width) || 1;\n\t\tvar rows = Math.floor(500 / height) || 1;\n\n\t\tvar canvas = document.createElement(\"canvas\");\n\t\tcanvas.height = height * rows;\n\t\tcanvas.width = width * cols;\n\n\t\tvar context = canvas.getContext(\"2d\");\n\n\t\tdrawGrid(height, width, rows, cols, context, cellStyles);\n\n\t\treturn canvas.toDataURL();\n\n\t\tfunction drawGrid(rowHeight, colWidth, rows, cols, context, styles) {\n\t\t\t// paint pixels manually instead of using lineTo in order to prevent canvas aliasing\n\t\t\tvar image = context.createImageData(colWidth * cols, rowHeight * rows);\n\t\t\timage.imageSmoothingEnabled = false;\n\n\t\t\tvar verticalLineWidth = styles.rightBorderWidth * 1;\n\t\t\tvar verticalLineColor = parseRgb(styles.rightBorderColor);\n\n\t\t\tvar x = 0,\n\t\t\t\ty = 0,\n\t\t\t\tw = 0;\n\n\t\t\tfor (var col = 1; col <= cols; col++) {\n\t\t\t\tx = col * colWidth - 1;\n\t\t\t\tfor (w = 0; w < verticalLineWidth; w++) {\n\t\t\t\t\tfor (y = 0; y < rowHeight * rows; y++) {\n\t\t\t\t\t\tdrawDot(x - w, y, verticalLineColor, image);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar horizontalLineWidth = styles.bottomBorderWidth * 1;\n\t\t\tvar horizontalLineColor = parseRgb(styles.bottomBorderColor);\n\n\t\t\ty = 0;\n\t\t\tfor (var row = 1; row <= rows; row++) {\n\t\t\t\ty = row * rowHeight - 1;\n\t\t\t\tfor (w = 0; w < horizontalLineWidth; w++) {\n\t\t\t\t\tfor (x = 0; x < colWidth * cols; x++) {\n\t\t\t\t\t\tdrawDot(x, y - w, horizontalLineColor, image);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tcontext.putImageData(image, 0, 0);\n\t\t}\n\n\t\tfunction drawDot(x, y, color, matrix) {\n\t\t\tvar rowLength = width * cols;\n\n\t\t\tvar index = (y * rowLength + x) * 4;\n\n\t\t\tmatrix.data[index] = color.r;\n\t\t\tmatrix.data[index + 1] = color.g;\n\t\t\tmatrix.data[index + 2] = color.b;\n\t\t\tmatrix.data[index + 3] = color.a;\n\t\t}\n\t}\n\n\tfunction getCssClass(key) {\n\t\treturn \"gantt-static-bg-\" + key;\n\t}\n\n\tfunction createBackgroundTiles(cellStyles, config, scale, itemHeight) {\n\t\tvar data = {};\n\t\tvar widths = getColumnWidths(scale),\n\t\t\theight = itemHeight;\n\n\t\tvar styleHTML = \"\";\n\t\tfor (var i in widths) {\n\n\t\t\tvar width = i * 1;\n\t\t\tvar key = getHashKey(width, height, cellStyles);\n\t\t\tvar cachedUrl = getUrlFromCache(key);\n\n\t\t\tif (!cachedUrl) {\n\t\t\t\tvar bgImage = generateBgUrl(width, height, cellStyles);\n\t\t\t\tcacheUrl(key, bgImage);\n\t\t\t\tstyleHTML += \".\" + getCssClass(key) + \"{ background-image: url('\" + bgImage + \"');}\";\n\t\t\t}\n\n\t\t\tdata[i] = getCssClass(key);\n\t\t}\n\n\t\tif (styleHTML) {\n\t\t\tvar style = getStyleElement();\n\t\t\tstyle.innerHTML += styleHTML;\n\t\t}\n\n\t\treturn data;\n\t}\n\n\tfunction createBgDivs(bgTiles, config, scale, dataHeight) {\n\t\tvar divs = [];\n\t\tvar tile,\n\t\t\tprevWidth = 0,\n\t\t\tprevCell;\n\n\t\tvar widths = scale.width.filter(function (i) {\n\t\t\treturn !!i;\n\t\t});\n\n\t\tvar leftPos = 0;\n\n\t\t//TODO: fixme\n\t\t// bg image misalignments on horizontal scroll on very large time scales, especially in IE/Edge browsers\n\t\t// limiting max tile width seems to solve the issue, but can increase rendering time\n\t\tvar maxTileSize = 100000;\n\t\tif (env.isIE) {\n\t\t\t// special case for IE11 on win7x and probably 8x\n\t\t\tvar appVersion = navigator.appVersion || \"\";\n\t\t\tif (appVersion.indexOf(\"Windows NT 6.2\") != -1 ||\n\t\t\t\tappVersion.indexOf(\"Windows NT 6.1\") != -1 ||\n\t\t\t\tappVersion.indexOf(\"Windows NT 6.0\") != -1) {\n\n\t\t\t\tmaxTileSize = 20000;\n\t\t\t}\n\t\t}\n\n\t\tfor (var i = 0; i < widths.length; i++) {\n\t\t\t//var currentWidth = cells[i].clientWidth;\n\t\t\tvar cell = widths[i];\n\n\t\t\tif ((cell != prevCell && prevCell !== undefined) || (i == widths.length - 1) || (prevWidth > maxTileSize)) {\n\n\t\t\t\tvar totalHeight = dataHeight,\n\t\t\t\t\tcurrentTop = 0,\n\t\t\t\t\trowHeight = Math.floor(maxTileSize / config.row_height) * config.row_height;\n\n\t\t\t\tvar tileWidth = prevWidth;\n\n\t\t\t\twhile (totalHeight > 0) {\n\t\t\t\t\tvar currentHeight = Math.min(totalHeight, rowHeight);\n\t\t\t\t\ttotalHeight -= rowHeight;\n\n\t\t\t\t\ttile = document.createElement(\"div\");\n\n\t\t\t\t\ttile.style.height = currentHeight + \"px\";\n\t\t\t\t\ttile.style.position = \"absolute\";\n\t\t\t\t\ttile.style.top = currentTop + \"px\";\n\t\t\t\t\ttile.style.left = leftPos + \"px\";\n\t\t\t\t\ttile.style.pointerEvents = \"none\";\n\n\t\t\t\t\ttile.style.whiteSpace = \"no-wrap\";\n\t\t\t\t\ttile.className = bgTiles[prevCell || cell];\n\n\t\t\t\t\t// if last - short by 1 px (bug fix)\n\t\t\t\t\tif (i == widths.length - 1) {\n\t\t\t\t\t\ttileWidth = cell + tileWidth - 1;\n\t\t\t\t\t}\n\t\t\t\t\ttile.style.width = tileWidth + \"px\";\n\n\t\t\t\t\tdivs.push(tile);\n\t\t\t\t\tcurrentTop += currentHeight;\n\t\t\t\t}\n\t\t\t\tprevWidth = 0;\n\t\t\t\tleftPos += tileWidth;\n\n\t\t\t\t//cell = 0;\n\t\t\t}\n\t\t\tif (cell) {\n\t\t\t\tprevWidth += cell;\n\t\t\t\tprevCell = cell;\n\t\t\t}\n\n\t\t}\n\n\t\treturn divs;\n\t}\n\n\n\tfunction createProbeElement(){\n\t\tvar cell = document.createElement(\"div\");\n\t\tcell.className = \"gantt_task_cell\";\n\t\tvar row = document.createElement(\"div\");\n\t\trow.className = \"gantt_task_row\";\n\t\trow.appendChild(cell);\n\t\treturn row;\n\t}\n\tfunction getCellStyles(targetNode) {\n\t\t// creating temp DOM structure for resolving style parameters. Will be removed after calculating.\n\t\t// Add two rows and read styles from the first one. \n\t\t// Some skins (e.g. material) define special styles for the last row, so we add a couple and read styles from one which is not the :last-child;\n\t\tvar firstRow = createProbeElement();\n\t\tvar secondRow = createProbeElement();\n\n\t\ttargetNode.appendChild(firstRow);\n\t\ttargetNode.appendChild(secondRow);\n\n\t\tvar firstRowCell = firstRow.firstChild;\n\n\t\tvar rowStyles = getComputedStyle(firstRow),\n\t\t\tcellStyles = getComputedStyle(firstRowCell);\n\n\t\tvar params = {\n\t\t\tbottomBorderWidth: rowStyles.getPropertyValue(\"border-bottom-width\").replace(\"px\", \"\"),\n\t\t\trightBorderWidth: cellStyles.getPropertyValue(\"border-right-width\").replace(\"px\", \"\"),\n\t\t\tbottomBorderColor: rowStyles.getPropertyValue(\"border-bottom-color\"),\n\t\t\trightBorderColor: cellStyles.getPropertyValue(\"border-right-color\")\n\t\t};\n\n\t\ttargetNode.removeChild(firstRow);\n\t\ttargetNode.removeChild(secondRow);\n\n\t\treturn params;\n\t}\n\n\treturn {\n\t\trender: renderBgCanvas,\n\t\tdestroy: cleanup\n\t};\n};\n\nexport default {\n\tcreate: function(){\n\t\treturn createStaticBgHelper(utils, env);\n\t}\n};\n\n","import ScaleHelper from \"./scales_ignore\";\nimport eventable from \"../../../utils/eventable\";\nimport * as utils from \"../../../utils/utils\";\nimport * as helpers from \"../../../utils/helpers\";\nimport topPositionMixin from \"../row_position_mixin\";\nimport canvasRender from \"./tasks_canvas_render\";\nimport createLayerConfig from \"./timeline_layers\";\n\nvar Timeline = function(parent, config, factory, gantt){\n\tthis.$config = utils.mixin({}, config || {});\n\tthis.$scaleHelper = new ScaleHelper(gantt);\n\tthis.$gantt = gantt;\n\tthis._posFromDateCache = {};\n\tthis._posFromWorkTimeCache = {};\n\tthis._timelineDragScroll = null;\n\tutils.mixin(this, topPositionMixin(this));\n\teventable(this);\n};\n\nTimeline.prototype = {\n\tinit: function(container) {\n\t\tcontainer.innerHTML += \"<div class='gantt_task' style='width:inherit;height:inherit;'></div>\";\n\t\tthis.$task = container.childNodes[0];\n\n\t\tthis.$task.innerHTML = \"<div class='gantt_task_scale'></div><div class='gantt_data_area'></div>\";\n\t\tthis.$task_scale = this.$task.childNodes[0];\n\n\t\tthis.$task_data = this.$task.childNodes[1];\n\t\tconst taskBg = \"<div class='gantt_task_bg'></div>\";\n\t\tconst links = \"<div class='gantt_links_area'></div>\";\n\t\tconst taskBars = \"<div class='gantt_bars_area'></div>\";\n\n\t\tconst taskConstraints = \"<div class='gantt_task_constraints'></div>\";\n\t\tconst taskDeadlines = \"<div class='gantt_task_deadlines'></div>\";\n\t\tconst taskBaselines = \"<div class='gantt_task_baselines'></div>\";\n\n\t\tthis.$task_data.innerHTML = taskBg + taskBaselines + links + taskBars + taskConstraints + taskDeadlines;\n\n\t\tthis.$task_bg = this.$task_data.childNodes[0];\n\t\tthis.$task_baselines = this.$task_data.childNodes[1];\n\t\tthis.$task_links = this.$task_data.childNodes[2];\n\t\tthis.$task_bars = this.$task_data.childNodes[3];\n\t\tthis.$task_constraints = this.$task_data.childNodes[4];\n\t\tthis.$task_deadlines = this.$task_data.childNodes[5];\n\n\t\tthis._tasks = {\n\t\t\tcol_width: 0,\n\t\t\twidth: [], // width of each column\n\t\t\tfull_width: 0, // width of all columns\n\t\t\ttrace_x: [],\n\t\t\trendered: {}\n\t\t};\n\n\t\tvar config = this.$getConfig();\n\t\tvar attr = config[this.$config.bind + \"_attribute\"];\n\t\tvar linksAttr = config[this.$config.bindLinks + \"_attribute\"];\n\t\tif(!attr && this.$config.bind){\n\t\t\tattr = \"data-\" + this.$config.bind + \"-id\";\n\t\t}\n\t\tif(!linksAttr && this.$config.bindLinks){\n\t\t\tlinksAttr = \"data-\" + this.$config.bindLinks + \"-id\";\n\t\t}\n\t\tthis.$config.item_attribute = attr || null;\n\t\tthis.$config.link_attribute = linksAttr || null;\n\n\t\tvar layers = this._createLayerConfig();\n\t\tif(!this.$config.layers){\n\t\t\tthis.$config.layers = layers.tasks;\n\t\t}\n\t\tif(!this.$config.linkLayers){\n\t\t\tthis.$config.linkLayers = layers.links;\n\t\t}\n\n\t\tthis._attachLayers(this.$gantt);\n\n\t\tthis.callEvent(\"onReady\", []);\n\t\t//this.refresh();\n\t\tif (this.$gantt.ext.dragTimeline) {\n\t\t\tthis._timelineDragScroll = this.$gantt.ext.dragTimeline.create();\n\t\t\tthis._timelineDragScroll.attach(this);\n\t\t}\n\t},\n\n\tsetSize: function(width, height){\n\t\tvar config = this.$getConfig();\n\n\t\tif(width*1 === width){\n\t\t\tthis.$config.width = width;\n\t\t}\n\t\tif(height*1 === height){\n\n\t\t\tthis.$config.height = height;\n\t\t\tvar dataHeight = Math.max(this.$config.height - config.scale_height);\n\t\t\tthis.$task_data.style.height = dataHeight + 'px';\n\t\t}\n\n\t\tthis.refresh();\n\t\tthis.$task_bg.style.backgroundImage = \"\";\n\n\t\tif(config.smart_rendering && this.$config.rowStore){\n\t\t\tthis.$task_bg.style.height = this.getTotalHeight() +\"px\";\n\t\t}else{\n\t\t\tthis.$task_bg.style.height = \"\";\n\t\t}\n\n\t\tvar scale = this._tasks;\n\t\t//timeline area layers\n\t\tvar data_els = this.$task_data.childNodes;\n\t\tfor(var i= 0, len = data_els.length; i < len; i++){\n\t\t\tvar el = data_els[i];\n\t\t\tif(el.hasAttribute(\"data-layer\") && el.style)\n\t\t\t\tel.style.width = scale.full_width + \"px\";\n\t\t}\n\t},\n\n\tisVisible: function(){\n\t\tif(this.$parent && this.$parent.$config){\n\t\t\treturn !this.$parent.$config.hidden;\n\t\t}else{\n\t\t\treturn this.$task.offsetWidth;\n\t\t}\n\t},\n\n\tgetSize: function(){\n\t\tvar config = this.$getConfig();\n\t\tvar store = this.$config.rowStore;\n\n\t\tvar contentHeight = store ? this.getTotalHeight() : 0,\n\t\t\tcontentWidth = this.isVisible() ? this._tasks.full_width : 0;\n\n\t\treturn {\n\t\t\tx: this.isVisible() ? this.$config.width : 0,\n\t\t\ty: this.isVisible() ? this.$config.height : 0,\n\t\t\tcontentX: this.isVisible() ? contentWidth : 0,\n\t\t\tcontentY: this.isVisible() ? (config.scale_height + contentHeight) : 0,\n\t\t\tscrollHeight: this.isVisible() ? contentHeight : 0,\n\t\t\tscrollWidth: this.isVisible() ? contentWidth : 0\n\t\t};\n\t},\n\n\tscrollTo: function(left, top){\n\t\tif(!this.isVisible())\n\t\t\treturn;\n\n\t\tvar scrolled = false;\n\n\t\tthis.$config.scrollTop = this.$config.scrollTop || 0;\n\t\tthis.$config.scrollLeft = this.$config.scrollLeft || 0;\n\t\tif(top*1 === top){\n\t\t\tthis.$config.scrollTop = top;\n\t\t\tthis.$task_data.scrollTop = this.$config.scrollTop;\n\t\t\tscrolled = true;\n\t\t}\n\t\tif (left*1 === left){\n\t\t\tthis.$task.scrollLeft = left;\n\t\t\tthis.$config.scrollLeft = this.$task.scrollLeft;\n\t\t\tthis._refreshScales();\n\t\t\tscrolled = true;\n\t\t}\n\n\t\tif(scrolled){\n\t\t\tthis.callEvent(\"onScroll\", [this.$config.scrollLeft, this.$config.scrollTop]);\n\t\t}\n\t},\n\n\t_refreshScales: function _refreshScales() {\n\t\tif(!this.isVisible())\n\t\t\treturn;\n\n\t\tvar config = this.$getConfig();\n\t\tif (!config.smart_scales) return;\n\n\t\tvar viewPort = this.getViewPort();\n\n\t\tvar scales = this._scales;\n\t\tthis.$task_scale.innerHTML = this._getScaleChunkHtml(scales, viewPort.x, viewPort.x_end);\n\t},\n\n\tgetViewPort: function(){\n\t\tvar scrollLeft = this.$config.scrollLeft || 0;\n\t\tvar scrollTop = this.$config.scrollTop || 0;\n\t\tvar height = this.$config.height || 0;\n\t\tvar width = this.$config.width || 0;\n\t\treturn {\n\t\t\ty: scrollTop,\n\t\t\ty_end: scrollTop + height,\n\t\t\tx: scrollLeft,\n\t\t\tx_end: scrollLeft + width,\n\t\t\theight: height,\n\t\t\twidth: width\n\t\t};\n\t},\n\n\t_createLayerConfig: createLayerConfig,\n\n\t_attachLayers: function(gantt){\n\t\tthis._taskLayers = [];\n\t\tthis._linkLayers = [];\n\n\t\tvar self = this;\n\n\t\tvar layers = this.$gantt.$services.getService(\"layers\");\n\n\t\tif(this.$config.bind){\n\n\t\t\tthis._bindStore();\n\t\t\tvar taskRenderer = layers.getDataRender(this.$config.bind);\n\n\t\t\tif(!taskRenderer){\n\t\t\t\ttaskRenderer = layers.createDataRender({\n\t\t\t\t\tname: this.$config.bind,\n\t\t\t\t\tdefaultContainer: function(){ return self.$task_data;}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\ttaskRenderer.container = function(){ return self.$task_data;};\n\n\t\t\tvar taskLayers = this.$config.layers;\n\t\t\tfor(var i = 0; taskLayers && i < taskLayers.length; i++){\n\t\t\t\tvar layer = taskLayers[i];\n\n\t\t\t\tif(typeof layer == \"string\"){\n\t\t\t\t\tlayer = this.$gantt.$ui.layers[layer]();\n\t\t\t\t}\n\n\t\t\t\tif(typeof layer == \"function\" || (layer && layer.render && layer.update)){\n\t\t\t\t\tlayer = {renderer: layer};\n\t\t\t\t}\n\n\t\t\t\tlayer.view = this;\n\n\t\t\t\tvar bar_layer = taskRenderer.addLayer(layer);\n\t\t\t\tthis._taskLayers.push(bar_layer);\n\t\t\t\tif(layer.expose){\n\t\t\t\t\tthis._taskRenderer = taskRenderer.getLayer(bar_layer);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis._initStaticBackgroundRender();\n\t\t}\n\n\t\tif(this.$config.bindLinks){\n\t\t\tself.$config.linkStore = self.$gantt.getDatastore(self.$config.bindLinks);\n\n\t\t\tvar linkRenderer = layers.getDataRender(this.$config.bindLinks);\n\n\t\t\tif(!linkRenderer){\n\t\t\t\tlinkRenderer = layers.createDataRender({\n\t\t\t\t\tname: this.$config.bindLinks,\n\t\t\t\t\tdefaultContainer: function(){ return self.$task_data;}\n\t\t\t\t});\n\t\t\t}\n\t\t\tvar linkLayers = this.$config.linkLayers;\n\t\t\tfor(var i = 0; linkLayers && i < linkLayers.length; i++){\n\n\t\t\t\tif(typeof layer == \"string\"){\n\t\t\t\t\tlayer = this.$gantt.$ui.layers[layer]();\n\t\t\t\t}\n\n\t\t\t\tvar layer = linkLayers[i];\n\t\t\t\tlayer.view = this;\n\t\t\t//\tlayer.getViewPort = getViewPort;\n\t\t\t//\tsubscribeSmartRender(layer);\n\t\t\t\tvar linkLayer = linkRenderer.addLayer(layer);\n\t\t\t\tthis._taskLayers.push(linkLayer);\n\t\t\t\tif(linkLayers[i].expose){\n\t\t\t\t\tthis._linkRenderer = linkRenderer.getLayer(linkLayer);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\t_initStaticBackgroundRender: function(){\n\t\tvar self = this;\n\t\tvar staticRender = canvasRender.create();\n\t\tvar store = self.$config.rowStore;\n\t\tif(!store) return;\n\n\t\tthis._staticBgHandler = store.attachEvent(\"onStoreUpdated\", function(id, item, mode){\n\t\t\tif(id !== null) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif(!self.isVisible())\n\t\t\t\treturn;\n\t\t\tvar config = self.$getConfig();\n\t\t\tif(config.static_background || config.timeline_placeholder) {\n\t\t\t\tvar store = self.$gantt.getDatastore(self.$config.bind);\n\t\t\t\tvar staticBgContainer = self.$task_bg_static;\n\t\t\t\tif(!staticBgContainer){\n\t\t\t\t\tstaticBgContainer = document.createElement(\"div\");\n\t\t\t\t\tstaticBgContainer.className = \"gantt_task_bg\";\n\t\t\t\t\tself.$task_bg_static = staticBgContainer;\n\t\t\t\t\tif(self.$task_bg.nextSibling){\n\t\t\t\t\t\tself.$task_data.insertBefore(staticBgContainer, self.$task_bg.nextSibling);\n\t\t\t\t\t}else{\n\t\t\t\t\t\tself.$task_data.appendChild(staticBgContainer);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (store) {\n\t\t\t\t\tvar staticBackgroundHeight = self.getTotalHeight();\n\t\t\t\t\tif (config.timeline_placeholder){\n\t\t\t\t\t\tstaticBackgroundHeight = config.timeline_placeholder.height || self.$task_data.offsetHeight || 99999;\n\t\t\t\t\t}\n\t\t\t\t\tstaticRender.render(staticBgContainer, config, self.getScale(), staticBackgroundHeight, self.getItemHeight(item ? item.id : null));\n\t\t\t\t}\n\t\t\t}else if(config.static_background){\n\t\t\t\tif(self.$task_bg_static && self.$task_bg_static.parentNode){\n\t\t\t\t\tself.$task_bg_static.parentNode.removeChild(self.$task_bg_static);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tthis.attachEvent(\"onDestroy\", function () {\n\t\t\tstaticRender.destroy();\n\t\t});\n\t\tthis._initStaticBackgroundRender = function(){};//init once\n\t},\n\n\t_clearLayers: function(gantt){\n\t\tvar layers = this.$gantt.$services.getService(\"layers\");\n\t\tvar taskRenderer = layers.getDataRender(this.$config.bind);\n\t\tvar linkRenderer = layers.getDataRender(this.$config.bindLinks);\n\n\t\tif (this._taskLayers) {\n\t\t\tfor(var i = 0; i < this._taskLayers.length; i++){\n\t\t\t\ttaskRenderer.removeLayer(this._taskLayers[i]);\n\t\t\t}\n\t\t}\n\t\tif (this._linkLayers) {\n\t\t\tfor(var i = 0; i < this._linkLayers.length; i++){\n\t\t\t\tlinkRenderer.removeLayer(this._linkLayers[i]);\n\t\t\t}\n\t\t}\n\n\t\tthis._linkLayers = [];\n\t\tthis._taskLayers = [];\n\t},\n\n\t_render_tasks_scales: function _render_tasks_scales() {\n\t\tvar config = this.$getConfig();\n\n\t\tvar scales_html = \"\",\n\t\t\touter_width = 0,\n\t\t\tscale_height = 0;\n\n\t\tvar state = this.$gantt.getState();\n\n\t\tif (this.isVisible()) {\n\t\t\tvar helpers = this.$scaleHelper;\n\t\t\tvar scales = this._getScales();\n\t\t\tscale_height = config.scale_height;\n\n\t\t\tvar availWidth = this.$config.width;\n\t\t\tif(config.autosize == \"x\" || config.autosize == \"xy\"){\n\t\t\t\tavailWidth = Math.max(config.autosize_min_width, 0);\n\t\t\t}\n\n\t\t\tvar cfgs = helpers.prepareConfigs(scales, config.min_column_width, availWidth, scale_height - 1, state.min_date, state.max_date, config.rtl);\n\t\t\tvar cfg = this._tasks = cfgs[cfgs.length - 1];\n\t\t\tthis._scales = cfgs;\n\t\t\tthis._posFromDateCache = {};\n\t\t\tthis._posFromWorkTimeCache = {};\n\n\t\t\tif(this._tasks.projection && this._tasks.projection?.source === \"fixedHours\"){\n\t\t\t\tconst calendarId = \"timescale-projection-calendar\";\n\t\t\t\tif(gantt.getCalendar(calendarId)){\n\t\t\t\t\tgantt.deleteCalendar(calendarId);\n\t\t\t\t}\n\n\t\t\t\tlet {hours} = this._tasks.projection;\n\t\t\t\tgantt.addCalendar({\n\t\t\t\t\tid:calendarId, \n\t\t\t\t\tworktime: {\n\t\t\t\t\t\thours: hours || gantt.getCalendar(\"global\")._worktime.hours.slice(),\n\t\t\t\t\t\tdays: [ 1, 1, 1, 1, 1, 1 ,1]\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tscales_html = this._getScaleChunkHtml(cfgs, 0, this.$config.width);\n\n\t\t\touter_width = cfg.full_width + \"px\";//cfg.full_width + (this._scroll_sizes().y ? scrollSizes.scroll_size : 0) + \"px\";\n\t\t\tscale_height += \"px\";\n\t\t}\n\n\t\tthis.$task_scale.style.height = scale_height;\n\n\t\tthis.$task_data.style.width =\n\t\t\tthis.$task_scale.style.width = outer_width;\n\n\t\tthis.$task_scale.innerHTML = scales_html;\n\n\t},\n\n\t_getScaleChunkHtml: function _get_scale_chunk_html (scales, fromPos, toPos) {\n\t\tvar templates = this.$gantt.templates;\n\t\tvar html = [];\n\n\t\tvar css = templates.scale_row_class;\n\t\tfor (var i = 0; i < scales.length; i++) {\n\t\t\tvar cssClass = \"gantt_scale_line\";\n\t\t\tvar tplClass = css(scales[i]);\n\t\t\tif (tplClass) {\n\t\t\t\tcssClass += \" \" + tplClass;\n\t\t\t}\n\n\t\t\thtml.push(\"<div class=\\\"\" + cssClass + \"\\\" style=\\\"height:\" + (scales[i].height) +\n\t\t\t\t\"px;position:relative;line-height:\" + (scales[i].height) + \"px\\\">\" + this._prepareScaleHtml(scales[i], fromPos, toPos, i) + \"</div>\");\n\t\t}\n\n\t\treturn html.join(\"\");\n\t},\n\t_prepareScaleHtml: function _prepare_scale_html(config, fromPos, toPos, index) {\n\t\tvar globalConfig = this.$getConfig();\n\t\tvar globalTemplates = this.$gantt.templates;\n\n\t\tvar cells = [];\n\t\tvar date = null, css = null;\n\n\t\tvar content = config.format || config.template || config.date;\n\n\t\tif(typeof content === \"string\"){\n\t\t\tcontent = this.$gantt.date.date_to_str(content);\n\t\t}\n\n\t\tvar startIndex = 0,\n\t\t\tendIndex = config.count;\n\n\t\tif (globalConfig.smart_scales && (!isNaN(fromPos) && !isNaN(toPos))) {\n\t\t\tstartIndex = helpers.findBinary(config.left, fromPos);\n\t\t\tendIndex = helpers.findBinary(config.left, toPos) + 1;\n\t\t}\n\n\t\tcss = config.css || function () {\n\t\t\t};\n\t\tif (!config.css && globalConfig.inherit_scale_class) {\n\t\t\tcss = globalTemplates.scale_cell_class;\n\t\t}\n\n\t\tfor (var i = startIndex; i < endIndex; i++) {\n\t\t\tif (!config.trace_x[i]) break;\n\n\t\t\tdate = new Date(config.trace_x[i]);\n\t\t\tvar value = content.call(this, date),\n\t\t\t\twidth = config.width[i],\n\t\t\t\theight = config.height,\n\t\t\t\tleft = config.left[i],\n\t\t\t\tstyle = \"\",\n\t\t\t\ttemplate = \"\",\n\t\t\t\tcssclass = \"\";\n\n\t\t\tif (width) {\n\t\t\t\tvar position = globalConfig.smart_scales ? (\"position:absolute;left:\" + left + \"px\") : \"\";\n\n\t\t\t\tstyle = \"width:\" + (width) + \"px;\" + position;\n\t\t\t\t// GS-1188: Display the scale value in the viewport for long cells\n\t\t\t\tconst viewPort = this.getViewPort();\n\t\t\t\tconst floatConfig = (globalConfig.scales[index] || {}).sticky; // for old scale settings\n\n\t\t\t\tlet labelPosition = '';\n\t\t\t\tconst approxLabelWidth = 70;\n\t\t\t\t// if sticky config is not specified - sticky labels are enabled for long cells only\n\t\t\t\tif ((floatConfig !== false && width > approxLabelWidth) || floatConfig === true) {\n\t\t\t\t\t\n\t\t\t\t\tif (left < viewPort.x && left + width/2 - approxLabelWidth/2 < viewPort.x){\n\t\t\t\t\t\tlabelPosition = ` style='position:absolute;left: ${viewPort.x  - left + 10}px;' `;\n\t\t\t\t\t} else if(left + width/2 + approxLabelWidth/2 > viewPort.x_end && width > approxLabelWidth){\n\t\t\t\t\t\tlet labelPos = viewPort.x_end - left - 10;\n\t\t\t\t\t\tlet translateValue = \"-100%\";\n\t\t\t\t\t\tif(labelPos < approxLabelWidth) {\n\t\t\t\t\t\t\tlabelPos = approxLabelWidth;\n\t\t\t\t\t\t\ttranslateValue = `-${labelPos}px`;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tlabelPosition = ` style='position:absolute;left: ${labelPos}px;transform: translate(${translateValue},0);' `;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcssclass = \"gantt_scale_cell\" + (i == config.count - 1 ? \" gantt_last_cell\" : \"\");\n\n\t\t\t\ttemplate = css.call(this, date);\n\t\t\t\tif (template) cssclass += \" \" + template;\n\n\t\t\t\tvar ariaAttr = this.$gantt._waiAria.getTimelineCellAttr(value);\n\t\t\t\tvar cell = `<div class='${cssclass}' ${ariaAttr} style='${style}'><span ${labelPosition}>${value}</span></div>`;\n\t\t\t\tcells.push(cell);\n\t\t\t} else {\n\t\t\t\t//do not render ignored cells\n\t\t\t}\n\n\t\t}\n\t\treturn cells.join(\"\");\n\t},\n\t_getPositioningContext: function(task) {\n\t\tif(this._tasks.unit === this.$gantt.config.duration_unit){\n\t\t\treturn null;\n\t\t}\n\n\t\tif(this._tasks.unit !== \"day\" && this._tasks.unit !== \"week\"){\n\t\t\treturn null;\n\t\t}\n\n\t\tif(!this._tasks.projection){\n\t\t\treturn null;\n\t\t}\n\n\t\tconst {source} = this._tasks.projection || {};\n\t\tif(source === \"taskCalendar\"){\n\n\t\t\tif(!task){\n\t\t\t\treturn {\n\t\t\t\t\tcalendar: gantt.getCalendar(\"global\")\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn {\n\t\t\t\tcalendar: gantt.getTaskCalendar(task)\n\t\t\t};\n\t\t}\n\t\tif(source === \"fixedHours\"){\n\t\t\treturn {\n\t\t\t\tcalendar: gantt.getCalendar(\"timescale-projection-calendar\")\n\t\t\t};\n\t\t}\n\n\t\treturn null;\n\t},\n\n\tdateFromPos: function dateFromPos(x, context) {\n\t\tvar scale = this._tasks;\n\t\tif (x < 0 || x > scale.full_width || !scale.full_width) {\n\t\t\treturn null;\n\t\t}\n\n\t\tvar ind = helpers.findBinary(this._tasks.left, x);\n\t\tvar summ = this._tasks.left[ind];\n\n\t\tvar col_width = scale.width[ind] || scale.col_width;\n\t\tvar part = 0;\n\t\tif (col_width) {\n\t\t\tpart = (x - summ) / col_width;\n\t\t\tif(scale.rtl){\n\t\t\t\tpart = 1 - part;\n\t\t\t}\n\n\t\t}\n\n\t\tconst calendar = (context ? context.calendar : null) || null;\n\n\t\tvar unit = 0;\n\t\tif (part) {\n\t\t\tunit = this._getColumnDuration(scale, scale.trace_x[ind]);\n\t\t}\n\n\t\tconst cellStartDate = scale.trace_x[ind];\n\n\t\tconst absolutePositionDate = new Date(scale.trace_x[ind].valueOf() + Math.round(part * unit));\n\n\t\tif(!calendar){\n\n\t\t\treturn absolutePositionDate;\n\t\t}\n\n\t\tconst {start: trimStartSec, end: cellEnd, duration: cellDuration, intervals} = this._getWorkTrimForCell(cellStartDate, calendar);\n\n\t\tif(cellDuration <= 0){\n\t\t\treturn absolutePositionDate;\n\t\t}\n\n\t\tconst secondsInsideTrim = Math.round(part * cellDuration);\n\t\tconst mappedTimestampMs = cellStartDate.valueOf() + (trimStartSec + secondsInsideTrim) * 1000;\n\n\t\treturn new Date(mappedTimestampMs);\n\t},\n\n\tposFromDate: function posFromDate(date, context) {\n\t\tif (!this.isVisible())\n\t\t\treturn 0;\n\n\t\tif(!date){\n\t\t\treturn 0;\n\t\t}\n\n\t\tif(context && context.calendar){\n\t\t\treturn this.posFromWorkTime(date, context);\n\t\t}\n\n\t\tvar dateValue = String(date.valueOf());\n\n\t\tif(this._posFromDateCache[dateValue] !== undefined){\n\t\t\treturn this._posFromDateCache[dateValue];\n\t\t}\n\t\tvar ind = this.columnIndexByDate(date);\n\t\tthis.$gantt.assert(ind >= 0, \"Invalid day index\");\n\n\t\tvar wholeCells = Math.floor(ind);\n\t\tvar partCell = ind % 1;\n\n\t\tvar pos = this._tasks.left[Math.min(wholeCells, this._tasks.width.length - 1)];\n\t\tif (wholeCells == this._tasks.width.length)\n\t\t\tpos += this._tasks.width[this._tasks.width.length - 1];\n\t\t//for(var i=1; i <= wholeCells; i++)\n\t\t//\tpos += gantt._tasks.width[i-1];\n\n\t\tif (partCell) {\n\t\t\tif (wholeCells < this._tasks.width.length) {\n\t\t\t\tpos += this._tasks.width[wholeCells] * (partCell % 1);\n\t\t\t} else {\n\t\t\t\tpos += 1;\n\t\t\t}\n\n\t\t}\n\n\t\tvar roundPos = Math.round(pos);\n\t\tthis._posFromDateCache[dateValue] = roundPos;\n\t\treturn Math.round(roundPos);\n\t},\n\n\t_getWorkTrimForCell: function (cellStartDate, calendar) {\n\t\tconst cellDurationMs = this._getColumnDuration(this._tasks, cellStartDate);\n\t\tconst cellEndDate = new Date(cellStartDate.valueOf() + cellDurationMs);\n\n\t\tlet earliestWorkSecondInCell = null;\n\t\tlet latestWorkSecondInCell = null;\n\t\tconst intervalsSinceCellStart = [];\n\n\t\tfor (let dayDate = new Date(cellStartDate), dayIndex = 0;\n\t\t\tdayDate < cellEndDate;\n\t\t\tdayDate = this.$gantt.date.add(dayDate, 1, \"day\"), dayIndex++) {\n\n\t\t\tconst dayIntervals = calendar._getWorkHours(dayDate) || [];\n\n\t\t\tconst dayStartOffsetSeconds = Math.round((dayDate - cellStartDate) / 1000);\n\n\t\t\tfor (let i = 0; i < dayIntervals.length; i++) {\n\t\t\t\tconst absoluteStartSeconds = dayStartOffsetSeconds + dayIntervals[i].start;\n\t\t\t\tconst absoluteEndSeconds   = dayStartOffsetSeconds + dayIntervals[i].end;\n\n\t\t\t\tintervalsSinceCellStart.push({\n\t\t\t\t\tstart: absoluteStartSeconds,\n\t\t\t\t\tend: absoluteEndSeconds\n\t\t\t\t});\n\n\t\t\t\tif (earliestWorkSecondInCell === null || absoluteStartSeconds < earliestWorkSecondInCell) {\n\t\t\t\t\tearliestWorkSecondInCell = absoluteStartSeconds;\n\t\t\t\t}\n\t\t\t\tif (latestWorkSecondInCell === null || absoluteEndSeconds > latestWorkSecondInCell) {\n\t\t\t\t\tlatestWorkSecondInCell = absoluteEndSeconds;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (\n\t\t\tearliestWorkSecondInCell === null ||\n\t\t\tlatestWorkSecondInCell === null ||\n\t\t\tlatestWorkSecondInCell <= earliestWorkSecondInCell\n\t\t) {\n\t\t\treturn { start: 0, end: 0, duration: 0, intervals: [] };\n\t\t}\n\n\t\treturn {\n\t\t\tstart: earliestWorkSecondInCell,\n\t\t\tend: latestWorkSecondInCell,\n\t\t\tduration: latestWorkSecondInCell - earliestWorkSecondInCell,\n\t\t\tintervals: intervalsSinceCellStart\n\t\t};\n\t},\n\n\tposFromWorkTime: function (date, {calendar}) {\n\t\tif (!this.isVisible())\n\t\t\treturn 0;\n\t\tif (!date) {\n\t\t\treturn 0;\n\t\t}\n\n\t\tif(!calendar){\n\t\t\treturn this.posFromDate(date);\n\t\t}\n\n\t\tconst cacheKey = (calendar ? calendar.id : \"\") + String(date.valueOf());\n\t\tif (this._posFromWorkTimeCache[cacheKey] !== undefined) {\n\t\t\treturn this._posFromWorkTimeCache[cacheKey];\n\t\t}\n\n\t\tconst index = this.columnIndexByDate(date);\n\t\tthis.$gantt.assert(index >= 0, \"Invalid day index\");\n\n\t\tconst dayIndex = Math.floor(index);\t\n\t\tconst wholeCells = dayIndex;\n\n\t\tconst cellStartDate = this._tasks.trace_x[dayIndex];\n\t\tconst cellEndDate = new Date(cellStartDate.valueOf() + this._getColumnDuration(this._tasks, cellStartDate));\n\n\t\tconst {start: workintervalStart, end: workintervalEnd, duration: cellDuration} = this._getWorkTrimForCell(date, calendar);\n\n\t\tif(cellDuration === 0){\n\t\t\tconst result = this.posFromDate(date);\n\t\t//\tthis._posFromWorkTimeCache[cacheKey] = result;\n\t\t\treturn result;\n\t\t}\n\n\t\tconst cellStart = this._tasks.trace_x[dayIndex];\n\t\tconst dateOffset = (date - cellStart) / 1000; // in seconds\n\n\t\tlet fraction = 0;\n\t\tif(dateOffset <= workintervalStart){\n\t\t\tfraction = 0;\n\t\t} else if(dateOffset >= workintervalEnd){\n\t\t\tfraction = 1;\n\t\t} else {\n\t\t\tfraction = (dateOffset - workintervalStart) / cellDuration;\n\t\t}\n\n\t\tif(this._tasks.rtl){\n\t\t\tfraction = 1 - fraction;\n\t\t}\n\n\t\tconst posLeft = this._tasks.left[Math.min(wholeCells, this._tasks.width.length - 1)];\n\n\t\tconst cellWidth = (wholeCells < this._tasks.width.length)\n\t\t\t? this._tasks.width[wholeCells]\n\t\t\t: this._tasks.width[this._tasks.width.length - 1];\n\t\n\t\tconst pos = Math.round(posLeft + cellWidth * fraction);\n\t//\tthis._posFromWorkTimeCache[cacheKey] = pos;\n\n\t\treturn pos;\n\t},\n\n\n\t_getNextVisibleColumn: function (startIndex, columns, ignores) {\n\t\t// iterate columns to the right\n\t\tvar date = +columns[startIndex];\n\t\tvar visibleDateIndex = startIndex;\n\t\twhile (ignores[date]) {\n\t\t\tvisibleDateIndex++;\n\t\t\tdate = +columns[visibleDateIndex];\n\t\t}\n\n\t\treturn visibleDateIndex;\n\t},\n\t_getPrevVisibleColumn: function (startIndex, columns, ignores) {\n\t\t// iterate columns to the left\n\t\tvar date = +columns[startIndex];\n\t\tvar visibleDateIndex = startIndex;\n\t\twhile (ignores[date]) {\n\t\t\tvisibleDateIndex--;\n\t\t\tdate = +columns[visibleDateIndex];\n\t\t}\n\t\treturn visibleDateIndex;\n\t},\n\t_getClosestVisibleColumn: function (startIndex, columns, ignores) {\n\t\tvar visibleDateIndex = this._getNextVisibleColumn(startIndex, columns, ignores);\n\t\tif (!columns[visibleDateIndex]) {\n\t\t\tvisibleDateIndex =  this._getPrevVisibleColumn(startIndex, columns, ignores);\n\t\t}\n\t\treturn visibleDateIndex;\n\t},\n\tcolumnIndexByDate: function columnIndexByDate(date) {\n\t\tvar pos = new Date(date).valueOf();\n\t\tvar days = this._tasks.trace_x_ascending,\n\t\t\tignores = this._tasks.ignore_x;\n\n\t\tvar state = this.$gantt.getState();\n\n\t\tif (pos <= state.min_date) {\n\t\t\tif(this._tasks.rtl){\n\t\t\t\treturn days.length;\n\t\t\t}else{\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t}\n\n\t\tif (pos >= state.max_date) {\n\t\t\tif(this._tasks.rtl){\n\t\t\t\treturn 0;\n\t\t\t}else{\n\t\t\t\treturn days.length;\n\t\t\t}\n\t\t}\n\n\t\tvar dateIndex = helpers.findBinary(days, pos);\n\n\t\tvar visibleIndex = this._getClosestVisibleColumn(dateIndex, days, ignores);\n\t\tvar visibleDate = days[visibleIndex];\n\t\tvar transition = this._tasks.trace_index_transition;\n\n\t\tif(!visibleDate){\n\t\t\tif(transition){\n\t\t\t\treturn transition[0];\n\t\t\t}else{\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t}\n\n\t\tvar part = ((date - days[visibleIndex]) / this._getColumnDuration(this._tasks, days[visibleIndex]));\n\t\tif(transition){\n\t\t\treturn transition[visibleIndex] + (1 - part);\n\t\t}else{\n\t\t\treturn visibleIndex + part;\n\t\t}\n\t},\n\tgetItemPosition:function (task, start_date, end_date) {\n\t\tvar xLeft, xRight, width;\n\n\t\tlet displayStart = start_date || task.start_date || task.$auto_start_date;\n\t\tlet displayEnd = end_date || task.end_date || task.$auto_end_date;\n\n\t\tconst context = this._getPositioningContext(task);\n\t\tif(context && context.calendar) {\n\n\t\t\tif(this._tasks.rtl){\n\t\t\t\txRight = this.posFromWorkTime(displayStart, context);\n\t\t\t\txLeft = this.posFromWorkTime(displayEnd, context);\n\t\t\t}else{\n\t\t\t\txLeft = this.posFromWorkTime(displayStart, context);\n\t\t\t\txRight = this.posFromWorkTime(displayEnd, context);\n\t\t\t}\n\t\t}else{\n\t\t\tif(this._tasks.rtl){\n\t\t\t\txRight = this.posFromDate(displayStart);\n\t\t\t\txLeft = this.posFromDate(displayEnd);\n\t\t\t}else{\n\t\t\t\txLeft = this.posFromDate(displayStart);\n\t\t\t\txRight = this.posFromDate(displayEnd);\n\t\t\t}\n\t\t}\n\n\t\twidth =  Math.max((xRight - xLeft), 0);\n\n\t\tvar y = this.getItemTop(task.id);\n\n\t\tvar height = this.getBarHeight(task.id);\n\t\tvar rowHeight = this.getItemHeight(task.id);\n\t\treturn {\n\t\t\tleft: xLeft,\n\t\t\ttop: y,\n\t\t\theight: height,\n\t\t\twidth: width,\n\t\t\trowHeight: rowHeight\n\t\t};\n\t},\n\n\tgetBarHeight: function(taskId, isMilestoneRender){\n\t\tvar config = this.$getConfig();\n\n\t\tvar task = this.$config.rowStore.getItem(taskId);\n\t\t// height of the bar item\n\t\tvar height = task.task_height || task.bar_height || config.bar_height || config.task_height;\n\t\tvar rowHeight = this.getItemHeight(taskId);\n\n\t\tif (height == \"full\") {\n\t\t\tvar offset = config.bar_height_padding || 3;\n\t\t\theight = rowHeight - offset;\n\t\t}\n\t\t//item height cannot be bigger than row height\n\t\theight = Math.min(height, rowHeight);\n\t\tif (isMilestoneRender) { // to get correct height for addapting Milestone to the row\n\t\t\theight = Math.round(height / Math.sqrt(2));\n\t\t}\n\t\treturn Math.max(height, 0);\n\t},\n\n\tgetScale: function(){\n\t\treturn this._tasks;\n\t},\n\n\t_getScales: function _get_scales() {\n\t\tvar config = this.$getConfig();\n\t\tvar helpers = this.$scaleHelper;\n\t\tvar scales = [helpers.primaryScale(config)].concat(helpers.getAdditionalScales(config));\n\n\t\thelpers.sortScales(scales);\n\t\treturn scales;\n\t},\n\n\t_getColumnDuration: function _get_coll_duration(scale, date) {\n\t\treturn this.$gantt.date.add(date, scale.step, scale.unit) - date;\n\t},\n\t_bindStore: function () {\n\t\tif (this.$config.bind){\n\t\t\tvar rowStore = this.$gantt.getDatastore(this.$config.bind);\n\t\t\tthis.$config.rowStore = rowStore;\n\t\t\tif(rowStore && !rowStore._timelineCacheAttached){\n\t\t\t\tvar self = this;\n\t\t\t\trowStore._timelineCacheAttached = rowStore.attachEvent(\"onBeforeFilter\", function(){\n\t\t\t\t\tself._resetTopPositionHeight();\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t},\n\t_unbindStore: function(){\n\t\tif (this.$config.bind){\n\t\t\tvar rowStore = this.$gantt.getDatastore(this.$config.bind);\n\t\t\tif(rowStore && rowStore._timelineCacheAttached){\n\t\t\t\trowStore.detachEvent(rowStore._timelineCacheAttached);\n\t\t\t\trowStore._timelineCacheAttached = false;\n\t\t\t}\n\t\t}\n\t},\n\trefresh: function(){\n\t\tthis._bindStore();\n\n\t\tif(this.$config.bindLinks) {\n\t\t\tthis.$config.linkStore = this.$gantt.getDatastore(this.$config.bindLinks);\n\t\t}\n\n\t\tthis._resetTopPositionHeight();\n\t\tthis._resetHeight();\n\t\tthis._initStaticBackgroundRender();\n\t\tthis._render_tasks_scales();\n\t},\n\n\tdestructor: function(){\n\t\tvar gantt = this.$gantt;\n\t\tthis._clearLayers(gantt);\n\t\tthis._unbindStore();\n\t\tthis.$task = null;\n\t\tthis.$task_scale = null;\n\t\tthis.$task_data = null;\n\t\tthis.$task_bg = null;\n\t\tthis.$task_links = null;\n\t\tthis.$task_bars = null;\n\n\t\tthis.$gantt = null;\n\n\t\tif(this.$config.rowStore){\n\t\t\tthis.$config.rowStore.detachEvent(this._staticBgHandler);\n\t\t\tthis.$config.rowStore = null;\n\t\t}\n\t\tif(this.$config.linkStore){\n\t\t\tthis.$config.linkStore = null;\n\t\t}\n\n\t\tif(this._timelineDragScroll) {\n\t\t\tthis._timelineDragScroll.destructor();\n\t\t\tthis._timelineDragScroll = null;\n\t\t}\n\n\t\tthis.callEvent(\"onDestroy\", []);\n\t\tthis.detachAllEvents();\n\n\t}\n};\n\nexport default Timeline;","import * as helpers from \"../../utils/helpers\";\n\nfunction clearTaskStoreHandler(self) {\n\tif (self._delayRender) {\n\t\tself._delayRender.$cancelTimeout();\n\t}\n\n\tif (!self.$gantt) {\n\t\treturn;\n\t}\n\n\tvar tasks = self.$gantt.$data.tasksStore;\n\tvar ownStore = self.$config.rowStore;\n\n\tvar handlerIdProperty = \"_attached_\" + ownStore.$config.name;\n\tif (self[handlerIdProperty]) {\n\t\ttasks.detachEvent(self[handlerIdProperty]);\n\t\tself[handlerIdProperty] = null;\n\t}\n\n\tif (ownStore.$attachedResourceViewHandler) {\n\t\townStore.detachEvent(ownStore.$attachedResourceViewHandler);\n\t\townStore.$attachedResourceViewHandler = null;\n\n\t\ttasks.detachEvent(ownStore.$attachedTaskStoreHandler);\n\t\townStore.$attachedTaskStoreHandler = null;\n\t}\n}\n\nfunction createMixin(_super){\n\n\tvar initGrid = _super.prototype.init,\n\t\tdestroyGrid = _super.prototype.destructor;\n\n\treturn {\n\t\tinit: function() {\n\t\t\tinitGrid.apply(this, arguments);\n\t\t\tthis._linkToTaskStore();\n\t\t},\n\n\t\tdestructor: function() {\n\t\t\tclearTaskStoreHandler(this);\n\t\t\tdestroyGrid.apply(this, arguments);\n\t\t},\n\n\t\tpreviousDragId: null,\n\t\trelevantResources: null,\n\n\t\t_linkToTaskStore: function () {\n\t\t\tif (this.$config.rowStore && this.$gantt.$data.tasksStore) {\n\t\t\t\tvar tasks = this.$gantt.$data.tasksStore;\n\t\t\t\tvar ownStore = this.$config.rowStore;\n\t\t\t\tclearTaskStoreHandler(this);\n\n\t\t\t\tvar self = this;\n\t\t\t\tvar delayRender = helpers.delay(function() {\n\t\t\t\t\tif (self.$gantt.getState().lightbox) {\n\t\t\t\t\t\tdelayRender();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst linkedStore = self.$config.rowStore;\n\n\t\t\t\t\t\t// Repaint only relevant resources for task drag\n\t\t\t\t\t\tconst repaintStack = self._getRelevantResources();\n\t\t\t\t\t\t// GS-2822: extra check for resource store\n\t\t\t\t\t\tif (repaintStack && linkedStore.$config.name === self.$gantt.config.resource_store){\n\t\t\t\t\t\t\tif (repaintStack == \"nothing_to_repaint\"){\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tlinkedStore._quick_refresh = true;\n\t\t\t\t\t\t\tself.relevantResources.forEach(function(id){\n\t\t\t\t\t\t\t\tlinkedStore.refresh(id);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tlinkedStore._quick_refresh = false;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// because rowstore could be changed during timeout\n\t\t\t\t\t\t\tlinkedStore.refresh();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}, 300);\n\t\t\t\tthis._delayRender = delayRender;\n\t\t\t\tvar handlerIdProperty = \"_attached_\" + ownStore.$config.name;\n\n\t\t\t\tif (!self[handlerIdProperty]) {\n\t\t\t\t\tself[handlerIdProperty] = tasks.attachEvent(\"onStoreUpdated\", function(){\n\t\t\t\t\t\tif(!delayRender.$pending && !this._skipResourceRepaint){\n\t\t\t\t\t\t\t// don't repaint if we update progress\n\t\t\t\t\t\t\tconst state = self.$gantt.getState();\n\t\t\t\t\t\t\tif (state.drag_mode == \"progress\"){\n\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t} else if (state.drag_mode && state.drag_id){\n\t\t\t\t\t\t\t\t// we need it here because if you started dragging a task and quickly stopped the drag_id is removed \n\t\t\t\t\t\t\t\t// from the state before we record it, so we cannot repaint only the relevant resources\n\t\t\t\t\t\t\t\tself.previousDragId = state.drag_id;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdelayRender();\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tthis.$gantt.attachEvent(\"onDestroy\", function() {\n\t\t\t\t\t// detach events to don't call delayed tasks\n\t\t\t\t\tclearTaskStoreHandler(self);\n\t\t\t\t\treturn true;\n\t\t\t\t});\n\n\t\t\t\tif (!ownStore.$attachedResourceViewHandler) {\n\t\t\t\t\townStore.$attachedResourceViewHandler = ownStore.attachEvent(\"onBeforeFilter\", function() {\n\t\t\t\t\t\tif (self.$gantt.getState().lightbox) {\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (delayRender.$pending) {\n\t\t\t\t\t\t\tdelayRender.$cancelTimeout();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tself._updateNestedTasks();\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t});\n\n\t\t\t\t\townStore.$attachedTaskStoreHandler = tasks.attachEvent(\"onAfterDelete\", function(){\n\t\t\t\t\t\townStore._mark_recompute = true;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t_getRelevantResources: function (){\n\t\t\t// GS-2199. process_resource_assignments is disabled,\n\t\t\t// so we cannot get only the relevant assignment resources\n\t\t\tif (!this.$gantt.getTaskAssignments){\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tconst state = this.$gantt.getState();\n\t\t\tconst linkedStore = this.$config.rowStore;\n\n\t\t\tlet resourceIds = [];\n\t\t\tif (state.drag_mode && state.drag_id && linkedStore.$config.name === this.$gantt.config.resource_store){\n\t\t\t\tif (this.previousDragId == state.drag_id){ // we continue dragging the task\n\t\t\t\t\tif (this.relevantResources) {\n\t\t\t\t\t\treturn this.relevantResources;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresourceIds = this._getIdsFromAssignments(this.previousDragId);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse { // we started the task drag\n\t\t\t\t\tthis.previousDragId = state.drag_id;\n\t\t\t\t\tresourceIds = this._getIdsFromAssignments(this.previousDragId);\n\t\t\t\t}\n\t\t\t} else if (this.previousDragId){ // finished task drag, but the resources are still the same\n\t\t\t\tresourceIds = this._getIdsFromAssignments(this.previousDragId);\n\t\t\t\tthis.previousDragId = null;\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tif (!resourceIds.length){\n\t\t\t\treturn this.relevantResources = \"nothing_to_repaint\";\n\t\t\t}\n\t\t\t\n\t\t\tresourceIds.forEach(function(resourceId){\n\t\t\t\t//GS-2598: linkedstore could be a temp assignment store\n\t\t\t\tif(linkedStore.eachParent){\n\t\t\t\t\tlinkedStore.eachParent(function(parent){\n\t\t\t\t\t\tresourceIds.push(parent.id);\n\t\t\t\t\t}, resourceId);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn this.relevantResources = [...new Set(resourceIds)];\n\t\t},\n\n\t\t_getIdsFromAssignments: function(id){\n\t\t\tconst gantt = this.$gantt;\n\t\t\tconst resourceIds = [];\n\n\t\t\tconst task = gantt.getTask(id);\n\t\t\tlet assignments = gantt.getTaskAssignments(id);\n\t\t\tassignments.forEach(function(assignment){\n\t\t\t\tresourceIds.push(assignment.resource_id);\n\t\t\t});\n\n\t\t\t// get child assignments when dragging project task\n\t\t\tif (gantt.isSummaryTask(task) && gantt.config.drag_project) {\n\t\t\t\tgantt.eachTask(function(child){\n\t\t\t\t\tconst childAssignments = gantt.getTaskAssignments(child.id);\n\t\t\t\t\tchildAssignments.forEach(function(assignment){\n\t\t\t\t\t\tresourceIds.push(assignment.resource_id);\n\t\t\t\t\t});\n\t\t\t\t}, id);\n\t\t\t}\n\n\t\t\t// get assignments of other selected tasks\n\t\t\tif (gantt.config.drag_multiple && gantt.getSelectedTasks){\n\t\t\t\tconst selectedIds = gantt.getSelectedTasks();\n\t\t\t\tselectedIds.forEach(function(selectedId){\n\t\t\t\t\tconst selectedAssignments = gantt.getTaskAssignments(selectedId);\n\t\t\t\t\tselectedAssignments.forEach(function(assignment){\n\t\t\t\t\t\tresourceIds.push(assignment.resource_id);\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn resourceIds;\n\t\t},\n\n\t\t_updateNestedTasks: function(){\n\t\t\tvar gantt = this.$gantt;\n\t\t\tvar resourceStore = gantt.getDatastore(gantt.config.resource_store);\n\t\t\tif (!resourceStore.$config.fetchTasks) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tresourceStore.silent(function(){\n\t\t\t\tvar toAddArray = [];\n\t\t\t\tvar toAdd = {};\n\t\t\t\tvar toDelete = {};\n\n\t\t\t\tresourceStore.eachItem(function(resource){\n\t\t\t\t\tif (resource.$role == \"task\") {\n\t\t\t\t\t\ttoDelete[resource.id] = true;\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar assignments = gantt.getResourceAssignments(resource.id);\n\t\t\t\t\tvar addedTasks = {};\n\n\t\t\t\t\t// GS-1505. We need to sort assignments before updating tasks. \n\t\t\t\t\t// Iterating them without that will affect the order of featched tasks in the resource store\n\t\t\t\t\tassignments.sort(function (a, b) {\n\t\t\t\t\t\tconst resourceData = resourceStore.pull;\n\t\t\t\t\t\tconst resource1 = resourceData[`${a.task_id}_${a.resource_id}`];\n\t\t\t\t\t\tconst resource2 = resourceData[`${b.task_id}_${b.resource_id}`];\n\t\t\t\t\t\tif (resource1 && resource2) {\n\t\t\t\t\t\t\treturn resource1.$local_index - resource2.$local_index;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tassignments.forEach(function(a) {\n\t\t\t\t\t\tif(addedTasks[a.task_id] || !gantt.isTaskExists(a.task_id)){\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\taddedTasks[a.task_id] = true;\n\n\t\t\t\t\t\tvar task = gantt.getTask(a.task_id);\n\t\t\t\t\t\tvar copy;\n\t\t\t\t\t\t//GS-2711: deep copy from task\n\t\t\t\t\t\tif(resourceStore.$config.copyOnParse){\n\t\t\t\t\t\t\tcopy = gantt.copy(task);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tcopy = Object.create(task);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tcopy.id = task.id + '_' + resource.id;\n\n\t\t\t\t\t\tcopy.$task_id = task.id;\n\t\t\t\t\t\tcopy.$resource_id = resource.id;\n\t\t\t\t\t\tcopy[resourceStore.$parentProperty] = resource.id;\n\t\t\t\t\t\tcopy.$role = \"task\";\n\t\t\t\t\t\ttoAddArray.push(copy);\n\t\t\t\t\t\ttoAdd[copy.id] = true;\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t\tfor (var id in toDelete) {\n\t\t\t\t\tif (!toAdd[id]) {\n\t\t\t\t\t\tresourceStore.removeItem(id);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(toAddArray.length){\n\t\t\t\t\tresourceStore.parse(toAddArray);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t};\n}\n\nexport default createMixin;","\nexport default function(){\n\tvar self = this;\n\tvar taskFilter = function(){\n\t\treturn self.isVisible();\n\t};\n\n\tvar barVisible = function(id, task){\n\t\treturn !task.hide_bar;\n\t};\n\n\tconst gantt = this.$gantt;\n\n\tconst isTimedProject = function(id, task){\n\t\treturn task.type === gantt.config.types.project && task.auto_scheduling === false;\n\t};\n\tconst isNotTimedProject = function(id, task){\n\t\treturn !isTimedProject(id, task);\n\t};\n\n\tvar taskLayers = [\n\t\t{\n\t\t\texpose: true,\n\t\t\trenderer: this.$gantt.$ui.layers.taskBar(),\n\t\t\tcontainer: this.$task_bars,\n\t\t\tfilter: [taskFilter, barVisible, isNotTimedProject]\n\t\t},\n\t\t{\n\t\t\trenderer: this.$gantt.$ui.layers.timedProjectBar(),\n\t\t\tfilter: [taskFilter, isTimedProject],\n\t\t\tcontainer: this.$task_bars,\n\t\t\tappend: true\n\t\t},\n\t\t{\n\t\t\trenderer: this.$gantt.$ui.layers.taskSplitBar(),\n\t\t\tfilter: [taskFilter],\n\t\t\tcontainer: this.$task_bars,\n\t\t\tappend: true\n\t\t},\n\t\t{\n\t\t\trenderer: this.$gantt.$ui.layers.taskRollupBar(),\n\t\t\tfilter: [taskFilter],\n\t\t\tcontainer: this.$task_bars,\n\t\t\tappend: true\n\t\t},\n\t\t{\n\t\t\trenderer: this.$gantt.$ui.layers.taskConstraints(),\n\t\t\tfilter: [taskFilter],\n\t\t\tcontainer: this.$task_constraints,\n\t\t\tappend: false\n\t\t}\n\t];\n\n\tif(gantt.config.deadlines){\n\t\ttaskLayers.push({\n\t\t\trenderer: this.$gantt.$ui.layers.taskDeadline(),\n\t\t\tfilter: [taskFilter],\n\t\t\tcontainer: this.$task_deadlines,\n\t\t\tappend: false\n\t\t});\n\t}\n\n\tif(gantt.config.baselines){\n\t\ttaskLayers.push({\n\t\t\trenderer: this.$gantt.$ui.layers.taskBaselines(),\n\t\t\tfilter: [taskFilter],\n\t\t\tcontainer: this.$task_baselines,\n\t\t\tappend: false\n\t\t});\n\t}\n\n\ttaskLayers.push({\n\t\trenderer: this.$gantt.$ui.layers.taskBg(),\n\t\tcontainer: this.$task_bg,\n\t\tfilter: [\n\t\t\t//function(){\n\t\t\t//\treturn !self.$getConfig().static_background;\n\t\t\t//},\n\t\t\ttaskFilter\n\t\t]\n\t});\n\n\tvar linkLayers = [\n\t\t{\n\t\t\texpose: true,\n\t\t\trenderer: this.$gantt.$ui.layers.link(),\n\t\t\tcontainer: this.$task_links,\n\t\t\tfilter: [taskFilter]\n\t\t}\n\t];\n\n\treturn {\n\t\ttasks: taskLayers,\n\t\tlinks: linkLayers\n\t};\n\n};","import * as domHelpers from \"../utils/dom_helpers\";\nimport * as utils from \"../../../utils/utils\";\nimport resourceStoreMixin from \"../resource_store_mixin\";\nimport Grid from \"./grid\";\nimport __extends from \"../../../utils/extends\";\n\nvar ResourceGrid = (function (_super) {\n\n\tfunction ResourceGrid(parent, config, factory, gantt) {\n\t\treturn _super.apply(this, arguments) || this;\n\t}\n\n\t__extends(ResourceGrid, _super);\n\n\tutils.mixin(ResourceGrid.prototype, {\n\t\tinit: function(){\n\t\t\tif(this.$config.bind === undefined){\n\t\t\t\tthis.$config.bind = this.$getConfig().resource_store;\n\t\t\t}\n\t\t\t_super.prototype.init.apply(this, arguments);\n\t\t},\n\n\t\t_initEvents: function(){\n\t\t\tvar gantt = this.$gantt;\n\t\t\t_super.prototype._initEvents.apply(this, arguments);\n\t\t\tthis._mouseDelegates.delegate(\"click\", \"gantt_row\", gantt.bind(function (e, id, trg) {\n\t\t\t\tvar store = this.$config.rowStore;\n\t\t\t\tif(!store) return true;\n\n\t\t\t\tvar target = domHelpers.locateAttribute(e, this.$config.item_attribute);\n\t\t\t\tif(target){\n\t\t\t\t\tstore.select(target.getAttribute(this.$config.item_attribute));\n\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}, this), this.$grid);\n\n\t\t}\n\n\t}, true);\n\n\tutils.mixin(ResourceGrid.prototype, resourceStoreMixin(ResourceGrid), true);\n\n\treturn ResourceGrid;\n})(Grid);\n\nexport default ResourceGrid;","import domEventScope from \"../../ui/utils/dom_event_scope\";\nimport * as utils from \"../../../utils/utils\";\nimport resourceStoreMixin from \"../resource_store_mixin\";\nimport Grid from \"./grid\";\nimport __extends from \"../../../utils/extends\";\n\nconst GridRL = (function (_super) {\n\n\tfunction GridRL(parent, config, factory, gantt) {\n\t\treturn _super.apply(this, arguments) || this;\n\t}\n\n\t__extends(GridRL, _super);\n\n\tutils.mixin(GridRL.prototype, {\n\t\tinit: function(container) {\n\t\t\tconst gantt = this.$gantt;\n\t\t\tconst gridAriaAttr = gantt._waiAria.gridAttrString();\n\t\t\tconst gridDataAriaAttr = gantt._waiAria.gridDataAttrString();\n\t\t\tconst _ganttConfig = this.$getConfig();\n\t\t\t_ganttConfig.row_height = this._getResourceConfig().row_height ? this._getResourceConfig().row_height : gantt.resource_table.row_height ;\n\t\t\tlet reorderColumns = _ganttConfig.reorder_grid_columns || false;\n\t\t\tif (this.$config.reorder_grid_columns !== undefined) {\n\t\t\t\treorderColumns = this.$config.reorder_grid_columns;\n\t\t\t}\n\n\t\t\tif(this.$config.bind === undefined){\n\t\t\t\tthis.$config.bind = \"temp_resource_assignment_store\";\n\t\t\t\tthis.$config.name = \"resource_grid_lightbox\";\n\t\t\t\tthis.$config.$id = \"GridRL\";\n\t\t\t}\n\n\t\t\tcontainer.innerHTML = \"<div class='gantt_grid' style='width:100%;' \" + gridAriaAttr + \"></div>\";\n\t\t\tthis.$grid = container.childNodes[0];\n\n\t\t\tthis.$grid.innerHTML = \"<div class='gantt_grid_scale' \" +\n\t\t\t\tgantt._waiAria.gridScaleRowAttrString() + \"></div><div class='gantt_grid_data' \" + gridDataAriaAttr + \"></div>\";\n\n\t\t\tthis.$grid_scale = this.$grid.childNodes[0];\n\t\t\tthis.$grid_data = this.$grid.childNodes[1];\n\n\t\t\tlet attr = _ganttConfig[this.$config.bind + \"_attribute\"];\n\t\t\tif (!attr && this.$config.bind) {\n\t\t\t\tattr = \"data-\" + this.$config.bind + \"-id\";\n\t\t\t}\n\t\t\tthis.$config.item_attribute = attr || null;\n\n\t\t\tif (!this.$config.layers) {\n\t\t\t\tconst layers = this._createLayerConfig();\n\t\t\t\tthis.$config.layers = layers;\n\t\t\t}\n\n\t\t\tconst domEvents = domEventScope();\n\t\t\tthis.event = domEvents.attach;\n\t\t\tthis.eventRemove = domEvents.detach;\n\t\t\tthis._eventRemoveAll = domEvents.detachAll;\n\t\t\tthis._createDomEventScope = domEvents.extend;\n\n\t\t\tthis._addLayers(this.$gantt);\n\n\t\t\tthis._initEvents();\n\n\t\t\tthis.callEvent(\"onReady\", []);\n\n\t\t},\n\t\tgetColumn: function (name) {\n\t\t\tconst index = this.getColumnIndex(name);\n\t\t\tif (index === null) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tconst columns = this._getResourceColumns();\n\t\t\treturn columns[index] || null;\n\t\t},\n\t\tgetColumnIndex: function (name, excludeHidden) {\n\t\t\tconst columns = this._getResourceColumns();\n\t\t\tlet hiddenIndexShift = 0;\n\n\t\t\tfor (let i = 0; i < columns.length; i++) {\n\t\t\t\t// GS-1257. If the cell is hidden, the target column index should be correct\n\t\t\t\tif (excludeHidden && columns[i].hide){\n\t\t\t\t\thiddenIndexShift++;\n\t\t\t\t}\n\t\t\t\tif (columns[i].name == name) {\n\t\t\t\t\treturn i - hiddenIndexShift;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t},\n\t\tgetGridColumns: function(){\n\t\t\tconst columns = this._getResourceColumns();\n\t\t\tconst visibleColumns = [];\n\t\n\t\t\tfor (let i = 0; i < columns.length; i++) {\n\t\t\t\tif (!columns[i].hide)\n\t\t\t\t\tvisibleColumns.push(columns[i]);\n\t\t\t}\n\t\n\t\t\treturn visibleColumns;\n\t\t},\n\t\t_createLayerConfig: function () {\n\t\t\tconst gantt = this.$gantt;\n\t\t\tconst self = this;\n\t\t\tconst layers = [\n\t\t\t\t{\n\t\t\t\t\trenderer: gantt.$ui.layers.gridLine(),\n\t\t\t\t\tcontainer: this.$grid_data,\n\t\t\t\t\tfilter: [function () {\n\t\t\t\t\t\treturn self.isVisible();\n\t\t\t\t\t}]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\trenderer: gantt.$ui.layers.gridTaskRowResizer(),\n\t\t\t\t\tcontainer: this.$grid_data,\n\t\t\t\t\tappend: true,\n\t\t\t\t\tfilter: [function () {\n\t\t\t\t\t\treturn gantt.config.resize_rows;\n\t\t\t\t\t}]\n\t\t\t\t}\n\t\t\t];\n\t\t\treturn layers;\n\t\t},\n\t\t_renderGridHeader: function () {\n\t\t\tconst gantt = this.$gantt;\n\t\t\tconst config = this._getResourceConfig();\n\t\t\tconst locale = this.$gantt.locale;\n\t\t\tconst templates = this.$getTemplates();\n\t\n\t\t\tlet columns = this._getResourceColumns();\n\t\t\tif (config.rtl) {\n\t\t\t\tcolumns = columns.reverse();\n\t\t\t}\n\t\t\tif(!config.scale_height){\n\t\t\t\tconfig.scale_height = gantt.resource_table.scale_height;\n\t\t\t}\n\t\t\tlet cells = [];\n\t\t\tlet width = 0,\n\t\t\t\tlabels = locale.labels;\n\t\n\t\t\t\tlet lineHeigth = config.scale_height - 1;\n\t\n\t\t\tfor (let i = 0; i < columns.length; i++) {\n\t\t\t\tlet last = i == columns.length - 1;\n\t\t\t\tlet col = columns[i];\n\t\n\t\t\t\t// ensure columns have non-empty names\n\t\t\t\tif (!col.name) {\n\t\t\t\t\tcol.name = gantt.uid() + \"\";\n\t\t\t\t}\n\t\n\t\t\t\tlet colWidth = col.width * 1;\n\t\n\t\t\t\tlet gridWidth = this._getGridWidth();\n\t\t\t\tif (last && gridWidth > width + colWidth)\n\t\t\t\t\tcol.width = colWidth = gridWidth - width;\n\t\t\t\twidth += colWidth;\n\t\t\t\tlet sort = (gantt._sort && col.name == gantt._sort.name) ? (`<div data-column-id=\"${col.name}\" class=\"gantt_sort gantt_${gantt._sort.direction}\"></div>`) : \"\";\n\t\t\t\tlet cssClass = [\"gantt_grid_head_cell\",\n\t\t\t\t\t(\"gantt_grid_head_\" + col.name),\n\t\t\t\t\t(last ? \"gantt_last_cell\" : \"\"),\n\t\t\t\t\ttemplates.grid_header_class ? templates.grid_header_class(col.name, col) : \"\"].join(\" \");\n\t\n\t\t\t\tlet style = \"width:\" + (colWidth - (last ? 1 : 0)) + \"px;\";\n\t\t\t\tlet label = (col.label || labels[\"column_\" + col.name] || labels[col.name]);\n\t\t\t\tlabel = label || \"\";\n\t\n\t\t\t\tconst ariaAttrs = gantt._waiAria.gridScaleCellAttrString(col, label);\n\t\n\t\t\t\tconst cell = \"<div class='\" + cssClass + \"' style='\" + style + \"' \" + ariaAttrs + \n\t\t\t\t\t\" data-column-id='\" + col.name + \"' column_id='\" + col.name + \"'\" +\n\t\t\t\t\t\" data-column-name='\" + col.name + \"' data-column-index='\" + i + \"'\" +\n\t\t\t\t\t\">\" + label + sort + \"</div>\";\n\t\t\t\tcells.push(cell);\n\t\t\t}\n\t\t\tthis.$grid_scale.style.height = (config.scale_height) + \"px\";\n\t\t\tthis.$grid_scale.style.lineHeight = lineHeigth + \"px\";\n\t\t\tthis.$grid_scale.style.width = \"inherit\";\n\t\t\tthis.$grid_scale.innerHTML = cells.join(\"\");\n\t\t},\n\t\tisVisible: function () {\n\t\t\tif (this.$parent) {\n\t\t\t\treturn !this.$parent.hidden;\n\t\t\t} else {\n\t\t\t\treturn this.$grid.offsetWidth;\n\t\t\t}\n\t\t},\n\t\t_initEvents: function(){\n\t\t},\n\t\t_getResourceSection: function(){\n\t\t\treturn gantt.getLightboxSection(this.$config.sectionName).section;\n\t\t},\n\t\t$getTemplates: function() {\n\t\t\treturn this._getResourceSection().templates || {};\n\t\t},\n\t\t_getResourceConfig: function(){\n\t\t\treturn this._getResourceSection().config || gantt.resource_table;\n\t\t},\n\t\t_getResourceColumns: function() {\n\t\t\treturn this._getResourceSection().config?.columns || gantt.resource_table.columns;\n\t\t},\n\t\tdestructor: function () {\n\t\t\tif (this._mouseDelegates) {\n\t\t\t\tthis._mouseDelegates.destructor();\n\t\t\t\tthis._mouseDelegates = null;\n\t\t\t}\n\t\t\t\n\t\t\tthis._unbindStore();\n\t\t\tthis.$grid = null;\n\t\t\tthis.$grid_scale = null;\n\t\t\tthis.$grid_data = null;\n\t\t\tthis._eventRemoveAll();\n\t\t\tgantt.ext.inlineEditorsLightbox.destructor();\n\t\t\tthis.callEvent(\"onDestroy\", []);\n\t\t\tthis.detachAllEvents();\n\t\t}\n\t\t\n\t}, true);\n\n\tutils.mixin(GridRL.prototype, resourceStoreMixin(GridRL), true);\n\n\treturn GridRL;\n})(Grid);\n\nexport default GridRL;","import * as utils from \"../../../utils/utils\";\nimport Timeline from \"./timeline\";\nimport resourceStoreMixin from \"../resource_store_mixin\";\nimport __extends from \"../../../utils/extends\";\n\nvar ResourceTimeline = (function (_super) {\n\n\tfunction ResourceTimeline(parent, config, factory, gantt) {\n\t\tvar self = _super.apply(this, arguments) || this;\n\t\tself.$config.bindLinks = null;\n\t\treturn self;\n\t}\n\n\t__extends(ResourceTimeline, _super);\n\n\tutils.mixin(ResourceTimeline.prototype, {\n\t\tinit: function(){\n\t\t\t\n\t\t\tif(this.$config.bind === undefined){\n\t\t\t\tthis.$config.bind = this.$getConfig().resource_store;\n\t\t\t}\n\t\t\t_super.prototype.init.apply(this, arguments);\n\t\t},\n\t\t_createLayerConfig: function() {\n\t\t\tvar self = this;\n\t\t\tvar taskFilter = function() {\n\t\t\t\treturn self.isVisible();\n\t\t\t};\n\n\t\t\tvar taskLayers = [\n\t\t\t\t{\n\t\t\t\t\trenderer: this.$gantt.$ui.layers.resourceRow(),\n\t\t\t\t\tcontainer: this.$task_bars,\n\t\t\t\t\tfilter: [taskFilter]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\trenderer: this.$gantt.$ui.layers.taskBg(),\n\t\t\t\t\tcontainer: this.$task_bg,\n\t\t\t\t\tfilter: [taskFilter]\n\t\t\t\t}\n\t\t\t];\n\n\t\t\tvar linkLayers = [];\n\n\t\t\treturn {\n\t\t\t\ttasks: taskLayers,\n\t\t\t\tlinks: linkLayers\n\t\t\t};\n\t\t}\n\n\t}, true);\n\n\tutils.mixin(ResourceTimeline.prototype, resourceStoreMixin(ResourceTimeline), true);\n\n\treturn ResourceTimeline;\n})(Timeline);\n\n\nexport default ResourceTimeline;\n\n\n","import * as utils from \"../../../utils/utils\";\nimport ResourceTimeline from \"./resource_timeline\";\nimport resourceStoreMixin from \"../resource_store_mixin\";\nimport __extends from \"../../../utils/extends\";\n\nvar ResourceHistogram = (function (_super) {\n\n\tfunction ResourceHistogram(parent, config, factory, gantt) {\n\t\tvar self = _super.apply(this, arguments) || this;\n\t\tself.$config.bindLinks = null;\n\t\treturn self;\n\t}\n\n\t__extends(ResourceHistogram, _super);\n\n\tutils.mixin(ResourceHistogram.prototype, {\n\t\t_createLayerConfig: function(){\n\t\t\tvar self = this;\n\t\t\tvar taskFilter = function(){\n\t\t\t\treturn self.isVisible();\n\t\t\t};\n\n\t\t\tvar taskLayers = [\n\t\t\t\t{\n\t\t\t\t\trenderer: this.$gantt.$ui.layers.resourceHistogram(),\n\t\t\t\t\tcontainer: this.$task_bars,\n\t\t\t\t\tfilter: [taskFilter]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\trenderer: this.$gantt.$ui.layers.taskBg(),\n\t\t\t\t\tcontainer: this.$task_bg,\n\t\t\t\t\tfilter: [taskFilter]\n\t\t\t\t}\n\t\t\t];\n\n\t\t\tvar linkLayers = [];\n\n\t\t\treturn {\n\t\t\t\ttasks: taskLayers,\n\t\t\t\tlinks: linkLayers\n\t\t\t};\n\t\t}\n\n\t}, true);\n\n\tutils.mixin(ResourceHistogram.prototype, resourceStoreMixin(_super), true);\n\n\treturn ResourceHistogram;\n})(ResourceTimeline);\n\n\nexport default ResourceHistogram;\n\n\n","export default {\n\tinit: function (controller, grid) {\n\t\tvar gantt = grid.$gantt;\n\n\t\tgantt.attachEvent(\"onTaskClick\", function (id, e) {\n\t\t\tif (gantt._is_icon_open_click(e))\n\t\t\t\treturn true;\n\t\t\tvar state = controller.getState();\n\t\t\tvar cell = controller.locateCell(e.target);\n\n\t\t\tif (cell && controller.getEditorConfig(cell.columnName)) {\n\t\t\t\tif (controller.isVisible() && state.id == cell.id && state.columnName == cell.columnName) {\n\t\t\t\t\t// do nothing if editor is already active in this cell\n\t\t\t\t} else {\n\t\t\t\t\tcontroller.startEdit(cell.id, cell.columnName);\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\t\t//GS-2598: new resource control click handler\n\t\tif(grid.$config.id === \"GridRL\"){\n\t\t\tgantt.event(gantt.getLightbox(), \"click\", function (e) {\n\t\t\t\tconst domHelpers = gantt.utils.dom;\n\t\t\t\tconst state = controller.getState();\n\t\t\t\tconst cell = controller.locateCell(e.target);\n\t\t\t\t// click on the resource table\n\t\t\t\tif (cell && controller.getEditorConfig(cell.columnName)) {\n\t\t\t\t\t// validation for unassigned case\n\t\t\t\t\tif(cell.columnName == 'duration' || cell.columnName == 'end'){\n\t\t\t\t\t\tconst tempAssignmentStore = gantt.getDatastore(\"temp_resource_assignment_store\");\n\t\t\t\t\t\tconst assignment = tempAssignmentStore.getItem(cell.id);\n\t\t\t\t\t\tif(assignment){\n\t\t\t\t\t\t\tif(!assignment.start_date){\n\t\t\t\t\t\t\t\tgantt.message({\n\t\t\t\t\t\t\t\t\ttype:\"warning\",\n\t\t\t\t\t\t\t\t\ttext:\"Specify assignment start date\"\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tcontroller.hide();\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (controller.isVisible() && state.id == cell.id && state.columnName == cell.columnName) {\n\t\t\t\t\t// do nothing if editor is already active in this cell\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcontroller.startEdit(cell.id, cell.columnName);\n\t\t\t\t\t}\n\t\t\t\t\tif(controller.isChanged()){\n\t\t\t\t\t\tcontroller.save();\n\t\t\t\t\t}\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\t// do nothing if add resource button clicked\n\t\t\t\tif(domHelpers.closest(e.target, `.gantt_custom_button.gantt_add_resources`)){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t// handle assignment deleting\n\t\t\t\tif(domHelpers.closest(e.target, `[data-assignment-delete]`)){\n\t\t\t\t\tconst assignmentId = e.target.getAttribute(\"data-assignment-delete\");\n\t\t\t\t\tgantt.confirm({\n\t\t\t\t\t\ttext: \"Resource assignment will be deleted permanently, are you sure?\",\n\t\t\t\t\t\tcancel:\"No\",\n\t\t\t\t\t\tok:\"Delete\", \n\t\t\t\t\t\tcallback: function(result){\n\t\t\t\t\t\t\tif(result){\n\t\t\t\t\t\t\t\tconst tempAssignmentStore = gantt.getDatastore(\"temp_resource_assignment_store\");\n\t\t\t\t\t\t\t\ttempAssignmentStore.removeItem(assignmentId);\n\t\t\t\t\t\t\t\t// handle deleting last grid row, \n\t\t\t\t\t\t\t\tif (tempAssignmentStore.getItems().length == 0){\n\t\t\t\t\t\t\t\t\tconst resourceSection = gantt.getLightboxSection(grid.$config.sectionName);\n\t\t\t\t\t\t\t\t\tconst block = gantt.form_blocks[\"resource_selector\"];\n\t\t\t\t\t\t\t\t\tconst node = gantt._lightbox_root.querySelector(\"#\" + resourceSection.section.id).nextSibling;\n\t\t\t\t\t\t\t\t\tblock.set_value.call(gantt, node, [], {}, resourceSection.section, true);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tgantt.refreshData();\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\t//click outside the resource table\n\t\t\t\tif(controller.isVisible()) {\n\t\t\t\t\tcontroller.save();\n\t\t\t\t\tcontroller.hide();\n\t\t\t\t} else {\n\t\t\t\t\tcontroller.hide();\n\t\t\t\t}\n\t\t\t});\n\t\t\t// before saving lightbox need to save controller value if its modified\n\t\t\t// covering date type inputs\n\t\t\tgantt.lightbox_events.gantt_save_btn = function () {\n\t\t\t\tcontroller.save();\n\t\t\t\tgantt._save_lightbox();\n\t\t\t};\n\t\t};\n\n\t\tgantt.attachEvent(\"onEmptyClick\", function () {\n\t\t\tif (controller.isVisible() && controller.isChanged()) {\n\t\t\t\tcontroller.save();\n\t\t\t} else {\n\t\t\t\tcontroller.hide();\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\n\t\tgantt.attachEvent(\"onTaskDblClick\", function (id, e) {\n\t\t\tvar state = controller.getState();\n\t\t\tvar cell = controller.locateCell(e.target);\n\t\t\tif (cell && controller.isVisible() && cell.columnName == state.columnName) {\n\t\t\t\t//GS-933 probably, we don't need to hide the inline editor because the lightbox cannot be opened if you double-click on an inline editor\n\t\t\t\t//remove this code later if people don't complain\n\t\t\t\t//controller.hide();\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\t},\n\n\tonShow: function (controller, placeholder, grid) {\n\t\tvar gantt = grid.$gantt;\n\t\t\n\n\t\tif(gantt.ext && gantt.ext.keyboardNavigation){\n\t\t\tvar keyNav = gantt.ext.keyboardNavigation;\n\t\t\tkeyNav.attachEvent(\"onKeyDown\", function(command, e){\n\t\t\t\tvar keyboard = gantt.constants.KEY_CODES;\n\t\t\t\tvar keyCode = e.keyCode;\n\t\t\t\tvar preventKeyNav = false;\n\n\t\t\t\tswitch (keyCode){\n\t\t\t\t\tcase keyboard.SPACE:\n\t\t\t\t\t\tif(controller.isVisible()){\n\t\t\t\t\t\t\tpreventKeyNav = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif (preventKeyNav){\n\t\t\t\t\treturn false;\n\t\t\t\t} else{\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t\n\t\tplaceholder.onkeydown = function (e) {\n\t\t\te = e || window.event;\n\n\t\t\tvar keyboard = gantt.constants.KEY_CODES;\n\t\t\tif (e.defaultPrevented || (e.shiftKey && e.keyCode != keyboard.TAB)) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar shouldPrevent = true;\n\t\t\tswitch (e.keyCode) {\n\t\t\t\tcase gantt.keys.edit_save:\n\t\t\t\t\tcontroller.save();\n\t\t\t\t\tbreak;\n\t\t\t\tcase gantt.keys.edit_cancel:\n\t\t\t\t\tcontroller.hide();\n\t\t\t\t\tbreak;\n\t\t\t\tcase keyboard.UP:\n\t\t\t\tcase keyboard.DOWN:\n\t\t\t\t\tif (controller.isVisible()) {\n\t\t\t\t\t\tcontroller.hide();\n\t\t\t\t\t\tshouldPrevent = false;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase keyboard.TAB:\n\t\t\t\t\tif (e.shiftKey) {\n\t\t\t\t\t\tcontroller.editPrevCell(true);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcontroller.editNextCell(true);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tshouldPrevent = false;\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif (shouldPrevent) {\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t};\n\t\t// GS-2598: update inline editor in the lightbox\n\t\tif(grid.$config.id === \"GridRL\"){\n\t\t\tplaceholder.onkeyup = function (e) {\n\t\t\t\te = e || window.event;\n\n\t\t\t\tvar keyboard = gantt.constants.KEY_CODES;\n\t\t\t\tif (e.defaultPrevented || (e.shiftKey && e.keyCode != keyboard.TAB)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif(gantt._lightbox_id && controller.isChanged()){\n\t\t\t\t\tcontroller.save();\n\t\t\t\t}\n\t\t\t};\n\t\t\tlet timeout;\n\t\t\tplaceholder.onwheel = function (e) {\n\t\t\t\te = e || window.event;\n\t\t\t\tif(gantt._lightbox_id && controller.isChanged()){\n\t\t\t\t\tclearTimeout(timeout);\n\t\t\t\t\ttimeout=setTimeout(function(){\n\t\t\t\t\t\tcontroller.save();\n\t\t\t\t\t},100);\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t},\n\tonHide: function () {\n\n\t},\n\n\tdestroy: function () {\n\n\t}\n};\n\n","export default {\n\tinit: function(controller, grid){\n\t\tvar self = controller;\n\t\tvar gantt = grid.$gantt;\n\n\t\tvar onBlurDelay = null;\n\t\tvar keyNav = gantt.ext.keyboardNavigation;\n\t\tkeyNav.attachEvent(\"onBeforeFocus\", function (node) {\n\t\t\tvar activeCell = controller.locateCell(node);\n\t\t\tclearTimeout(onBlurDelay);\n\t\t\tif (activeCell) {\n\t\t\t\tvar columnName = activeCell.columnName;\n\t\t\t\tvar id = activeCell.id;\n\n\t\t\t\tvar editorState = self.getState();\n\t\t\t\tif(self.isVisible()){\n\t\t\t\t\tif(editorState.id == id && editorState.columnName === columnName) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\n\t\tkeyNav.attachEvent(\"onFocus\", function (node) {\n\t\t\tvar activeCell = controller.locateCell(node);\n\t\t\tvar state = controller.getState();\n\t\t\tclearTimeout(onBlurDelay);\n\t\t\tif (activeCell && !(activeCell.id == state.id && activeCell.columnName == state.columnName)) {\n\t\t\t\tif(self.isVisible()){\n\t\t\t\t\tself.save();\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\n\t\tcontroller.attachEvent(\"onHide\", function(){\n\t\t\tclearTimeout(onBlurDelay);\n\t\t});\n\n\t\tkeyNav.attachEvent(\"onBlur\", function () {\n\t\t\tonBlurDelay = setTimeout(function(){\n\t\t\t\tself.save();\n\t\t\t});\n\n\t\t\treturn true;\n\t\t});\n\n\t\tgantt.attachEvent(\"onTaskDblClick\", function(id,e){\n\t\t\t// block lightbox on double click inside editor\n\t\t\tvar state = controller.getState();\n\t\t\tvar cell = controller.locateCell(e.target);\n\t\t\tif(cell && controller.isVisible() && cell.columnName == state.columnName){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\n\t\tgantt.attachEvent(\"onTaskClick\", function (id, e) {\n\t\t\tif(gantt._is_icon_open_click(e))\n\t\t\t\treturn true;\n\n\t\t\tvar state = controller.getState();\n\t\t\tvar cell = controller.locateCell(e.target);\n\n\t\t\tif (cell && controller.getEditorConfig(cell.columnName)) {\n\t\t\t\tif(controller.isVisible() && state.id == cell.id && state.columnName == cell.columnName){\n\t\t\t\t\t// do nothing if editor is already active in this cell\n\t\t\t\t}else{\n\t\t\t\t\tcontroller.startEdit(cell.id, cell.columnName);\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\t\tgantt.attachEvent(\"onEmptyClick\", function () {\n\t\t\tself.save();\n\t\t\treturn true;\n\t\t});\n\n\t\tkeyNav.attachEvent(\"onKeyDown\", function(command, e){\n\t\t\tvar activeCell = controller.locateCell(e.target);\n\t\t\tvar hasEditor = activeCell ? controller.getEditorConfig(activeCell.columnName) : false;\n\n\t\t\tvar state = controller.getState();\n\t\t\tvar keyboard = gantt.constants.KEY_CODES;\n\t\t\tvar keyCode = e.keyCode;\n\t\t\tvar preventKeyNav = false;\n\n\t\t\tswitch (keyCode){\n\t\t\t\tcase keyboard.ENTER:\n\t\t\t\t\tif(controller.isVisible()){\n\t\t\t\t\t\tcontroller.save();\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tpreventKeyNav = true;\n\t\t\t\t\t}else if(hasEditor && !(e.ctrlKey || e.metaKey || e.shiftKey)){\n\t\t\t\t\t\tself.startEdit(activeCell.id, activeCell.columnName);\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tpreventKeyNav = true;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase keyboard.ESC:\n\t\t\t\t\tif(controller.isVisible()){\n\t\t\t\t\t\tcontroller.hide();\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tpreventKeyNav = true;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase keyboard.UP:\n\t\t\t\tcase keyboard.DOWN:\n\t\t\t\t\tbreak;\n\t\t\t\tcase keyboard.LEFT:\n\t\t\t\tcase keyboard.RIGHT:\n\t\t\t\t\tif((hasEditor && controller.isVisible()) || state.editorType === \"date\"){\n\t\t\t\t\t\tpreventKeyNav = true;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase keyboard.SPACE:\n\t\t\t\t\tif(controller.isVisible()){\n\t\t\t\t\t\tpreventKeyNav = true;\n\t\t\t\t\t}\n\n\t\t\t\t\tif(hasEditor && !controller.isVisible()){\n\t\t\t\t\t\tself.startEdit(activeCell.id, activeCell.columnName);\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tpreventKeyNav = true;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase keyboard.DELETE:\n\t\t\t\t\tif(hasEditor && !controller.isVisible()){\n\t\t\t\t\t\tself.startEdit(activeCell.id, activeCell.columnName);\n\t\t\t\t\t\tpreventKeyNav = true;\n\t\t\t\t\t} else if(hasEditor && controller.isVisible()){\n\t\t\t\t\t\tpreventKeyNav = true;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase keyboard.TAB:\n\t\t\t\t\tif(controller.isVisible()){\n\n\t\t\t\t\t\tif(e.shiftKey){\n\t\t\t\t\t\t\tcontroller.editPrevCell(true);\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tcontroller.editNextCell(true);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar newState = controller.getState();\n\t\t\t\t\t\tif(newState.id){\n\t\t\t\t\t\t\tkeyNav.focus({type:\"taskCell\", id: newState.id, column:newState.columnName});\n\t\t\t\t\t\t}\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tpreventKeyNav = true;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tif(controller.isVisible())\n\t\t\t\t\t\tpreventKeyNav = true;\n\t\t\t\t\telse{\n\n\t\t\t\t\t\t// start editing on character key\n\t\t\t\t\t\tif((keyCode >= 48 && keyCode <= 57) || // [0-9]\n\t\t\t\t\t\t\t(keyCode > 95 && keyCode < 112) || // numpad\n\t\t\t\t\t\t\t(keyCode >= 64 && keyCode <= 91) || // [a-z]\n\t\t\t\t\t\t\t(keyCode > 185 && keyCode < 193) || //;=-,etc\n\t\t\t\t\t\t\t(keyCode > 218  && keyCode < 223)\n\t\t\t\t\t\t){\n\t\t\t\t\t\t\tvar modifiers = command.modifiers;\n\n\t\t\t\t\t\t\tvar anyModifier = modifiers.alt || modifiers.ctrl || modifiers.meta || modifiers.shift;\n\t\t\t\t\t\t\tif(modifiers.alt){\n\t\t\t\t\t\t\t\t// don't start editing on alt+key\n\t\t\t\t\t\t\t}else if (anyModifier && keyNav.getCommandHandler(command, \"taskCell\")){\n\t\t\t\t\t\t\t\t// don't start editing if command already have a keyboard shortcut\n\t\t\t\t\t\t\t}else if(hasEditor && !controller.isVisible()){\n\t\t\t\t\t\t\t\tself.startEdit(activeCell.id, activeCell.columnName);\n\t\t\t\t\t\t\t\tpreventKeyNav = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif (preventKeyNav){\n\t\t\t\treturn false;\n\t\t\t} else{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t});\n\t},\n\tonShow: function(controller, placeholder, grid){},\n\tonHide: function(controller, placeholder, grid){\n\t\tconst gantt = grid.$gantt;\n\t\tif (gantt){\n\t\t\tgantt.focus();\n\t\t}\n\n\t},\n\tdestroy: function(){}\n};\n\n","export default function (gantt) {\n\n\tvar BaseEditor = function () {\n\t};\n\n\tBaseEditor.prototype = {\n\t\tshow: function (id, column, config, placeholder) {\n\t\t},\n\t\thide: function () {\n\t\t},\n\t\tset_value: function (value, id, column, node) {\n\t\t\tthis.get_input(node).value = value;\n\t\t},\n\t\tget_value: function (id, column, node) {\n\t\t\treturn this.get_input(node).value || \"\";\n\t\t},\n\t\tis_changed: function (value, id, column, node) {\n\t\t\tvar currentValue = this.get_value(id, column, node);\n\t\t\tif (currentValue && value && currentValue.valueOf && value.valueOf) {\n\t\t\t\treturn currentValue.valueOf() != value.valueOf();\n\t\t\t} else {\n\t\t\t\treturn currentValue != value;\n\t\t\t}\n\t\t},\n\t\tis_valid: function (value, id, column, node) {\n\t\t\treturn true;\n\t\t},\n\n\t\tsave: function (id, column, node) {\n\n\t\t},\n\t\tget_input: function (node) {\n\t\t\treturn node.querySelector(\"input\");\n\t\t},\n\t\tfocus: function (node) {\n\t\t\tvar input = this.get_input(node);\n\t\t\tif (!input) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (input.focus) {\n\t\t\t\tinput.focus();\n\t\t\t}\n\n\t\t\tif (input.select) {\n\t\t\t\tinput.select();\n\t\t\t}\n\t\t}\n\t};\n\treturn BaseEditor;\n};","import BaseFactory from \"./base\";\nimport * as utils from \"../../../../../utils/utils\";\nimport __extends from \"../../../../../utils/extends\";\n\n\nexport default function(gantt) {\n\n\tvar BaseEditor = BaseFactory(gantt);\n\n\tfunction TextEditor() {\n\t\tvar self = BaseEditor.apply(this, arguments) || this;\n\t\treturn self;\n\t}\n\n\t__extends(TextEditor, BaseEditor);\n\n\tutils.mixin(TextEditor.prototype, {\n\t\tshow: function (id, column, config, placeholder) {\n\t\t\tvar html = `<div role='cell'><input type='text' name='${column.name}' title='${column.name}'></div>`;\n\t\t\tplaceholder.innerHTML = html;\n\t\t}\n\t}, true);\n\n\treturn TextEditor;\n};","import BaseFactory from \"./base\";\nimport * as utils from \"../../../../../utils/utils\";\nimport __extends from \"../../../../../utils/extends\";\n\n\nexport default function(gantt) {\n\n\tvar BaseEditor = BaseFactory(gantt);\n\n\tfunction NumberEditor() {\n\t\tvar self = BaseEditor.apply(this, arguments) || this;\n\t\treturn self;\n\t}\n\n\t__extends(NumberEditor, BaseEditor);\n\n\tutils.mixin(NumberEditor.prototype, {\n\t\tshow: function (id, column, config, placeholder) {\n\t\t\tvar min = config.min || 0,\n\t\t\t\tmax = config.max || 100;\n\n\t\t\tvar html = `<div role='cell'><input type='number' min='${min}' max='${max}' name='${column.name}' title='${column.name}'></div>`;\n\t\t\tplaceholder.innerHTML = html;\n\n\t\t\t// GS-1914. Do not allow entering alues beyond min and max via keyboard\n\t\t\tplaceholder.oninput = function (e) {\n\t\t\t\tif (+e.target.value < min) {\n\t\t\t\t\te.target.value = min;\n\t\t\t\t}\n\t\t\t\tif (+e.target.value > max) {\n\t\t\t\t\te.target.value = max;\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\tget_value: function (id, column, node) {\n\t\t\treturn this.get_input(node).value || \"\";\n\t\t},\n\t\tis_valid: function (value, id, column, node) {\n\t\t\treturn !isNaN(parseInt(value, 10));\n\t\t}\n\t}, true);\n\n\treturn NumberEditor;\n};","import BaseFactory from \"./base\";\nimport * as utils from \"../../../../../utils/utils\";\nimport __extends from \"../../../../../utils/extends\";\n\n\nexport default function(gantt) {\n\n\tvar BaseEditor = BaseFactory(gantt);\n\n\tfunction SelectEditor() {\n\t\tvar self = BaseEditor.apply(this, arguments) || this;\n\t\treturn self;\n\t}\n\n\t__extends(SelectEditor, BaseEditor);\n\n\tutils.mixin(SelectEditor.prototype, {\n\t\tshow: function (id, column, config, placeholder) {\n\t\t\tvar html = `<div role='cell'><select name='${column.name}' title='${column.name}'>`;\n\t\t\tvar optionsHtml = [],\n\t\t\t\toptions = config.options || [];\n\n\t\t\tfor (var i = 0; i < options.length; i++) {\n\t\t\t\toptionsHtml.push(\"<option value='\" + config.options[i].key + \"'>\" + options[i].label + \"</option>\");\n\t\t\t}\n\n\t\t\thtml += optionsHtml.join(\"\") + \"</select></div>\";\n\t\t\tplaceholder.innerHTML = html;\n\t\t},\n\t\tget_input: function (node) {\n\t\t\treturn node.querySelector(\"select\");\n\t\t}\n\t}, true);\n\n\treturn SelectEditor;\n};","import * as utils from \"../../../../../utils/utils\";\nimport __extends from \"../../../../../utils/extends\";\nimport BaseFactory from \"./base\";\n\nexport default function (gantt) {\n\tvar BaseEditor = BaseFactory(gantt);\n\t\n\t\n\n\tvar html5DateFormat = \"%Y-%m-%d\";\n\n\tvar dateToStr = null;\n\tvar strToDate = null;\n\n\tfunction init() {\n\t\tif (!dateToStr) {\n\t\t\tdateToStr = gantt.date.date_to_str(html5DateFormat);\n\t\t}\n\t\tif (!strToDate) {\n\t\t\tstrToDate = gantt.date.str_to_date(html5DateFormat);\n\t\t}\n\t}\n\n\tfunction DateEditor() {\n\t\tvar self = BaseEditor.apply(this, arguments) || this;\n\n\t\treturn self;\n\t}\n\n\t__extends(DateEditor, BaseEditor);\n\n\tutils.mixin(DateEditor.prototype, {\n\t\tshow: function (id, column, config, placeholder) {\n\t\t\tinit();\n\t\t\tvar minValue = null;\n\t\t\tvar maxValue = null;\n\n\t\t\tif(typeof config.min === \"function\"){\n\t\t\t\tminValue = config.min(id, column);\n\t\t\t}else{\n\t\t\t\tminValue = config.min;\n\t\t\t}\n\n\t\t\tif(typeof config.max === \"function\"){\n\t\t\t\tmaxValue = config.max(id, column);\n\t\t\t}else{\n\t\t\t\tmaxValue = config.max;\n\t\t\t}\n\n\t\t\tvar minAttr = minValue ? \" min='\" + dateToStr(minValue)+\"' \"  : \"\";\n\t\t\tvar maxAttr = maxValue ? \" max='\" + dateToStr(maxValue)+\"' \"  : \"\";\n\t\t\tvar html = `<div style='width:140px' role='cell'><input type='date' ${minAttr} ${maxAttr} name='${column.name}' title='${column.name}'></div>`;\n\t\t\tplaceholder.innerHTML = html;\n\n\t\t\t// GS-1914. Do not allow entering alues beyond min and max via keyboard\n\t\t\tplaceholder.oninput = function (e) {\n\t\t\t\tif (e.target.value && (minValue || maxValue)){\n\t\t\t\t\tif (+gantt.date.str_to_date(\"%Y-%m-%d\")(e.target.value) < +minValue) {\n\t\t\t\t\t\te.target.value = gantt.date.date_to_str(\"%Y-%m-%d\")(minValue);\n\t\t\t\t\t}\n\t\t\t\t\tif (+gantt.date.str_to_date(\"%Y-%m-%d\")(e.target.value) > +maxValue) {\n\t\t\t\t\t\te.target.value = gantt.date.date_to_str(\"%Y-%m-%d\")(maxValue);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\tset_value: function (value, id, column, node) {\n\t\t\tif (value && value.getFullYear) {\n\t\t\t\tthis.get_input(node).value = dateToStr(value);\n\t\t\t} else {\n\t\t\t\tthis.get_input(node).value = value;\n\t\t\t}\n\t\t},\n\t\tis_valid: function (value, id, column, node) {\n\t\t\tif (!value || isNaN(value.getTime()))\n\t\t\t\treturn false;\n\t\t\treturn true;\n\t\t},\n\t\tget_value: function (id, column, node) {\n\t\t\tvar parsed;\n\t\t\ttry {\n\t\t\t\tparsed = strToDate(this.get_input(node).value || \"\");\n\t\t\t} catch (e) {\n\t\t\t\tparsed = null;// return null will cancel changes\n\t\t\t}\n\n\t\t\treturn parsed;\n\t\t}\n\t}, true);\n\n\treturn DateEditor;\n};\n","import BaseFactory from \"./base\";\nimport * as utils from \"../../../../../utils/utils\";\nimport __extends from \"../../../../../utils/extends\";\n\n\nexport default function(gantt) {\n\n\tvar BaseEditor = BaseFactory(gantt);\n\n\tfunction PredecessorEditor() {\n\t\tvar self = BaseEditor.apply(this, arguments) || this;\n\t\treturn self;\n\t}\n\n\t__extends(PredecessorEditor, BaseEditor);\n\n\tfunction getFormatter(config) {\n\t\treturn config.formatter || gantt.ext.formatters.linkFormatter();\n\t}\n\n\tfunction parseInputString(value, config) {\n\t\tvar predecessors = (value || \"\").split(config.delimiter || \",\");\n\t\tfor (var i = 0; i < predecessors.length; i++) {\n\t\t\tvar val = predecessors[i].trim();\n\t\t\tif (val) {\n\t\t\t\tpredecessors[i] = val;\n\t\t\t} else {\n\t\t\t\tpredecessors.splice(i, 1);\n\t\t\t\ti--;\n\t\t\t}\n\t\t}\n\t\tpredecessors.sort();\n\t\treturn predecessors;\n\t}\n\n\tfunction formatPredecessors(task, config, gantt) {\n\t\tvar links = task.$target;\n\t\tvar labels = [];\n\t\tfor (var i = 0; i < links.length; i++) {\n\t\t\tvar link = gantt.getLink(links[i]);\n\t\t\tlabels.push(getFormatter(config).format(link));\n\t\t}\n\t\treturn labels.join((config.delimiter || \",\") + \" \");\n\t}\n\n\tfunction getSelectedLinks(taskId, predecessorCodes, config) {\n\t\tvar links = [];\n\t\t// select only unique codes GS-1439\n\t\t[...new Set(predecessorCodes)].forEach(function (code) {\n\t\t\tvar link = getFormatter(config).parse(code);\n\t\t\tif(link){\n\t\t\t\tlink.target = taskId;\n\t\t\t\t// GS-1290 A way to preserve the link. Otherwise validation will return false\n\t\t\t\t// because the existing link ID is not passed there\n\t\t\t\tlink.id = \"predecessor_generated\";\n\t\t\t\tif (gantt.isLinkAllowed(link)) {\n\t\t\t\t\tlink.id = undefined;\n\t\t\t\t\tlinks.push(link);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\treturn links;\n\t}\n\n\tfunction formatLinkKey(link){\n\t\treturn link.source + \"_\" + link.target + \"_\" + link.type + \"_\" + (link.lag||0);\n\t}\n\n\tfunction getLinksDiff(task, predecessorCodes, config) {\n\t\tvar selectedLinks = getSelectedLinks(task.id, predecessorCodes, config);\n\t\tvar existingLinksSearch = {};\n\t\ttask.$target.forEach(function (linkId) {\n\t\t\tvar link = gantt.getLink(linkId);\n\t\t\texistingLinksSearch[formatLinkKey(link)] = link.id;\n\t\t});\n\n\t\tvar linksToAdd = [];\n\t\tselectedLinks.forEach(function (link) {\n\t\t\tvar linkKey = formatLinkKey(link);\n\t\t\tif (!existingLinksSearch[linkKey]) {\n\t\t\t\tlinksToAdd.push(link);\n\t\t\t} else {\n\t\t\t\tdelete existingLinksSearch[linkKey];\n\t\t\t}\n\t\t});\n\n\t\tvar linksToDelete = [];\n\t\tfor (var i in existingLinksSearch) {\n\t\t\tlinksToDelete.push(existingLinksSearch[i]);\n\t\t}\n\n\t\treturn {\n\t\t\tadd: linksToAdd,\n\t\t\tremove: linksToDelete\n\t\t};\n\t}\n\n\tutils.mixin(PredecessorEditor.prototype, {\n\t\tshow: function (id, column, config, placeholder) {\n\t\t\tvar html = `<div role='cell'><input type='text' name='${column.name}' title='${column.name}'></div>`;\n\t\t\tplaceholder.innerHTML = html;\n\t\t},\n\t\thide: function () {\n\t\t},\n\t\tset_value: function (value, id, column, node) {\n\t\t\tthis.get_input(node).value = formatPredecessors(value, column.editor, gantt);\n\t\t},\n\t\tget_value: function (id, column, node) {\n\t\t\treturn parseInputString((this.get_input(node).value || \"\"), column.editor);\n\t\t},\n\t\tsave: function (id, column, node) {\n\t\t\tvar task = gantt.getTask(id);\n\n\t\t\tvar linksDiff = getLinksDiff(task, this.get_value(id, column, node), column.editor);\n\n\t\t\tif (linksDiff.add.length || linksDiff.remove.length) {\n\t\t\t\tgantt.batchUpdate(function () {\n\t\t\t\t\tlinksDiff.add.forEach(function (link) {\n\t\t\t\t\t\tgantt.addLink(link);\n\t\t\t\t\t});\n\t\t\t\t\tlinksDiff.remove.forEach(function (linkId) {\n\t\t\t\t\t\tgantt.deleteLink(linkId);\n\t\t\t\t\t});\n\n\t\t\t\t\tif (gantt.autoSchedule)\n\t\t\t\t\t\tgantt.autoSchedule();\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tis_changed: function (value, id, column, node) {\n\t\t\tvar inputPredecessors = this.get_value(id, column, node);\n\t\t\tvar taskPredecessors = parseInputString(formatPredecessors(value, column.editor, gantt), column.editor);\n\n\t\t\treturn inputPredecessors.join() !== taskPredecessors.join();\n\t\t}\n\t}, true);\n\n\treturn PredecessorEditor;\n};","import BaseFactory from \"./base\";\nimport * as utils from \"../../../../../utils/utils\";\nimport __extends from \"../../../../../utils/extends\";\n\n\nexport default function(gantt) {\n\n\tvar BaseEditor = BaseFactory(gantt);\n\n\tfunction TextEditor() {\n\t\tvar self = BaseEditor.apply(this, arguments) || this;\n\t\treturn self;\n\t}\n\n\t__extends(TextEditor, BaseEditor);\n\n\tfunction getFormatter(config) {\n\t\treturn config.formatter || gantt.ext.formatters.durationFormatter();\n\t}\n\tutils.mixin(TextEditor.prototype, {\n\t\tshow: function (id, column, config, placeholder) {\n\t\t\tvar html = `<div role='cell'><input type='text' name='${column.name}' title='${column.name}'></div>`;\n\t\t\tplaceholder.innerHTML = html;\n\t\t},\n\t\tset_value: function (value, id, column, node) {\n\t\t\tthis.get_input(node).value = getFormatter(column.editor).format(value);\n\t\t},\n\t\tget_value: function (id, column, node) {\n\t\t\treturn getFormatter(column.editor).parse(this.get_input(node).value || \"\");\n\t\t}\n\t}, true);\n\n\treturn TextEditor;\n};","export default function (gantt) {\n\treturn function processTaskDateProperties(item, mapTo, mode) {\n\t\tif (mode == \"keepDates\") {\n\t\t\tkeepDatesOnEdit(item, mapTo);\n\t\t} else if (mode == \"keepDuration\") {\n\t\t\tkeepDurationOnEdit(item, mapTo);\n\t\t} else {\n\t\t\tdefaultActionOnEdit(item, mapTo);\n\t\t}\n\t};\n\n\t// resize task\n\t// resize task when start/end/duration changes\n\tfunction keepDatesOnEdit(item, mapTo) {\n\t\tif (mapTo == \"duration\") {\n\t\t\titem.end_date = gantt.calculateEndDate(item);\n\t\t} else if (mapTo == \"end_date\" || mapTo == \"start_date\") {\n\t\t\titem.duration = gantt.calculateDuration(item);\n\t\t}\n\t}\n\n\t// move task(before 6.2)\n\t// move task when start/end dates changes\n\t// resize task when duration changes\n\tfunction keepDurationOnEdit(item, mapTo) {\n\t\tif (mapTo == \"end_date\") {\n\t\t\titem.start_date = decreaseStartDate(item);\n\t\t} else if (mapTo == \"start_date\" || mapTo == \"duration\") {\n\t\t\titem.end_date = gantt.calculateEndDate(item);\n\t\t}\n\t}\n\n\t// default behavior\n\t// move task when start date changes\n\t// resize task when end date/duration changes\n\tfunction defaultActionOnEdit(item, mapTo) {\n\t\tif (gantt._getAutoSchedulingConfig().schedule_from_end){\n\t\t\tif (mapTo == \"end_date\" || mapTo == \"duration\") {\n\t\t\t\titem.start_date = decreaseStartDate(item);\n\t\t\t} else if (mapTo == \"start_date\") {\n\t\t\t\titem.duration = gantt.calculateDuration(item);\n\t\t\t}\n\t\t} else {\n\t\t\tif (mapTo == \"start_date\" || mapTo == \"duration\") {\n\t\t\t\titem.end_date = gantt.calculateEndDate(item);\n\t\t\t} else if (mapTo == \"end_date\") {\n\t\t\t\titem.duration = gantt.calculateDuration(item);\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction decreaseStartDate(item){\n\t\treturn gantt.calculateEndDate({\n\t\t\tstart_date: item.end_date,\n\t\t\tduration: -item.duration,\n\t\t\ttask: item\n\t\t});\n\t}\n};","import getKeyboardMapping from \"./keyboard_mappings\";\nimport textEditorFactory from \"./editors/text\";\nimport numberEditorFactory from \"./editors/number\";\nimport selectEditorFactory from \"./editors/select\";\nimport dateEditorFactory from \"./editors/date\";\nimport predecessorEditorFactory from \"./editors/predecessor\";\nimport durationEditorFactory from \"./editors/duration\";\nimport * as utils from \"../../../../utils/utils\";\nimport * as domHelpers from \"../../utils/dom_helpers\";\nimport eventable from \"../../../../utils/eventable\";\nimport linkedPropertiesProcessor from \"./linked_properties\";\n\nfunction initConfigs(gantt){\n\tgantt.config.editor_types = {\n\t\ttext: new (textEditorFactory(gantt))(),\n\t\tnumber: new (numberEditorFactory(gantt))(),\n\t\tselect: new (selectEditorFactory(gantt))(),\n\t\tdate: new (dateEditorFactory(gantt))(),\n\t\tpredecessor: new (predecessorEditorFactory(gantt))(),\n\t\tduration: new (durationEditorFactory(gantt))()\n\t};\n}\n\nfunction create(gantt){\n\tvar keyboardMapping = getKeyboardMapping(gantt);\n\n\tvar eventBus = {};\n\teventable(eventBus);\n\n\tfunction createGridEditors(grid) {\n\n\t\tfunction _getGridCellFromNode(node){\n\t\t\tif(!domHelpers.isChildOf(node, grid.$grid)){\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tvar row = domHelpers.locateAttribute(node, grid.$config.item_attribute);\n\t\t\tvar cell = domHelpers.locateAttribute(node, \"data-column-name\");\n\t\t\tif(row && cell){\n\t\t\t\tvar columnName = cell.getAttribute(\"data-column-name\");\n\t\t\t\tvar id = row.getAttribute(grid.$config.item_attribute);\n\t\t\t\treturn {\n\t\t\t\t\tid: id,\n\t\t\t\t\tcolumnName: columnName\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn null;\n\n\t\t}\n\n\t\tfunction _getEditorPosition(itemId, columnName) {\n\t\t\tvar config = grid.$getConfig();\n\t\t\tvar top = grid.getItemTop(itemId);\n\t\t\tvar height = grid.getItemHeight(itemId);\n\t\t\tvar cols = grid.getGridColumns();\n\t\t\tvar left = 0,\n\t\t\t\tright = 0,\n\t\t\t\twidth = 0;\n\n\t\t\tfor (var i = 0; i < cols.length; i++) {\n\t\t\t\tif (cols[i].name == columnName) {\n\t\t\t\t\twidth = cols[i].width;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif (config.rtl) {\n\t\t\t\t\tright += cols[i].width;\n\t\t\t\t}\telse {\n\t\t\t\t\tleft += cols[i].width;\n\t\t\t\t}\n\n\t\t\t}\n\t\t\tif (config.rtl) {\n\t\t\t\treturn {\n\t\t\t\t\ttop: top,\n\t\t\t\t\tright: right,\n\t\t\t\t\theight: height,\n\t\t\t\t\twidth: width\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\treturn {\n\t\t\t\t\ttop: top,\n\t\t\t\t\tleft: left,\n\t\t\t\t\theight: height,\n\t\t\t\t\twidth: width\n\t\t\t\t};\n\t\t\t}\n\n\t\t}\n\n\t\tfunction findVisibleIndex(grid, columnName) {\n\t\t\tvar columns = grid.getGridColumns();\n\t\t\tfor (var i = 0; i < columns.length; i++){\n\t\t\t\tif(columns[i].name == columnName){\n\t\t\t\t\treturn i;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn 0;\n\t\t}\n\n\t\tfunction _createPlaceholder(itemId, columnName) {\n\t\t\tvar config = grid.$getConfig();\n\t\t\tvar pos = _getEditorPosition(itemId, columnName);\n\t\t\tvar el = document.createElement(\"div\");\n\t\t\tel.className = \"gantt_grid_editor_placeholder\";\n\t\t\tel.setAttribute(grid.$config.item_attribute, itemId);\n\t\t\tel.setAttribute(grid.$config.bind + \"_id\", itemId);// for backward compatibility\n\n\t\t\tel.setAttribute(\"data-column-name\", columnName);\n\n\t\t\tvar visibleIndex = findVisibleIndex(grid, columnName);\n\t\t\tel.setAttribute(\"data-column-index\", visibleIndex);\n\n\t\t\tgantt._waiAria.inlineEditorAttr(el);\n\n\t\t\tif (config.rtl) {\n\t\t\t\tel.style.cssText = [\n\t\t\t\t\t\"top:\" + pos.top + \"px\",\n\t\t\t\t\t\"right:\" + pos.right + \"px\",\n\t\t\t\t\t\"width:\" + pos.width + \"px\",\n\t\t\t\t\t\"height:\" + pos.height + \"px\"\n\t\t\t\t].join(\";\");\n\t\t\t} else {\n\t\t\t\tel.style.cssText = [\n\t\t\t\t\t\"top:\" + pos.top + \"px\",\n\t\t\t\t\t\"left:\" + pos.left + \"px\",\n\t\t\t\t\t\"width:\" + pos.width + \"px\",\n\t\t\t\t\t\"height:\" + pos.height + \"px\"\n\t\t\t\t].join(\";\");\n\t\t\t}\n\n\t\t\treturn el;\n\t\t}\n\n\t\tvar updateTaskDateProperties = linkedPropertiesProcessor(gantt);\n\n\t\tvar handlers = [];\n\t\tvar ganttHandlers = [];\n\t\tvar store = null;\n\t\tvar controller = {\n\t\t\t_itemId: null,\n\t\t\t_columnName: null,\n\t\t\t_editor: null,\n\t\t\t_editorType: null,\n\t\t\t_placeholder: null,\n\n\t\t\tlocateCell: _getGridCellFromNode,\n\t\t\tgetEditorConfig: function (columnName) {\n\t\t\t\tvar column = grid.getColumn(columnName);\n\t\t\t\tif(column){\n\t\t\t\t\treturn column.editor;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tinit: function () {\n\t\t\t\tvar mapping = keyboardMapping.getMapping();\n\t\t\t\tif(mapping.init){\n\t\t\t\t\tmapping.init(this, grid);\n\t\t\t\t}\n\n\t\t\t\tstore = grid.$gantt.getDatastore(grid.$config.bind);\n\t\t\t\tif (!store && gantt.$data.tempAssignmentsStore){\n\t\t\t\t\tstore = gantt.$data.tempAssignmentsStore;\n\t\t\t\t}\n\n\t\t\t\tvar self = this;\n\n\t\t\t\thandlers.push(store.attachEvent(\"onIdChange\", function(oldId, newId){\n\t\t\t\t\tif(self._itemId == oldId){\n\t\t\t\t\t\tself._itemId = newId;\n\t\t\t\t\t}\n\t\t\t\t}));\n\t\t\t\thandlers.push(store.attachEvent(\"onStoreUpdated\", function(){\n\t\t\t\t\tif(grid.$gantt.getState(\"batchUpdate\").batch_update){\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif(self.isVisible() && !store.isVisible(self._itemId)){\n\t\t\t\t\t\tself.hide();\n\t\t\t\t\t}\n\t\t\t\t}));\n\n\t\t\t\tganttHandlers.push(gantt.attachEvent(\"onDataRender\", function(){\n\t\t\t\t\tif(self._editor && self._placeholder && !domHelpers.isChildOf(self._placeholder, gantt.$root)){\n\t\t\t\t\t\tgrid.$grid_data.appendChild(self._placeholder);\n\t\t\t\t\t}\n\t\t\t\t}));\n\n\t\t\t\tthis.init = function(){};\n\t\t\t},\n\n\t\t\tgetState: function(){\n\t\t\t\treturn {\n\t\t\t\t\teditor: this._editor,\n\t\t\t\t\teditorType: this._editorType,\n\t\t\t\t\tplaceholder: this._placeholder,\n\t\t\t\t\tid: this._itemId,\n\t\t\t\t\tcolumnName: this._columnName\n\t\t\t\t};\n\t\t\t},\n\n\t\t\tstartEdit: function(itemId, columnName) {\n\t\t\t\tif (this.isVisible()) {\n\t\t\t\t\tthis.save();\n\t\t\t\t}\n\n\t\t\t\tif(!store.exists(itemId)){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tvar editorState = {id: itemId, columnName: columnName};\n\t\t\t\tif (gantt.isReadonly(store.getItem(itemId))) {\n\t\t\t\t\tthis.callEvent(\"onEditPrevent\", [editorState]);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (this.callEvent(\"onBeforeEditStart\", [editorState]) === false) {\n\t\t\t\t\tthis.callEvent(\"onEditPrevent\", [editorState]);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst asyncShow = this.show(editorState.id, editorState.columnName);\n\t\t\t\tif(asyncShow && asyncShow.then){\n\t\t\t\t\tasyncShow.then(function(){\n\t\t\t\t\t\tthis.setValue();\n\n\t\t\t\t\t\tthis.callEvent(\"onEditStart\", [editorState]);\n\t\t\t\t\t}.bind(this));\n\t\t\t\t}else{\n\t\t\t\t\tthis.setValue();\n\t\t\t\t\tthis.callEvent(\"onEditStart\", [editorState]);\n\t\t\t\t}\n\t\t\t},\n\t\t\tisVisible: function(){\n\t\t\t\tif(gantt._lightbox_id){\n\t\t\t\t\treturn !!(this._editor && domHelpers.isChildOf(this._placeholder, gantt._lightbox));\n\t\t\t\t}\n\t\t\t\treturn !!(this._editor && domHelpers.isChildOf(this._placeholder, gantt.$root));\n\t\t\t},\n\t\t\tshow: function (itemId, columnName) {\n\t\t\t\tif (this.isVisible()) {\n\t\t\t\t\tthis.save();\n\t\t\t\t}\n\t\t\t\tvar editorState = {id: itemId, columnName: columnName};\n\n\t\t\t\tvar column = grid.getColumn(editorState.columnName);\n\t\t\t\tvar editorConfig = this.getEditorConfig(column.name);\n\t\t\t\tif(!editorConfig)\n\t\t\t\t\treturn;\n\n\t\t\t\tvar editor = grid.$getConfig().editor_types[editorConfig.type];\n\n\t\t\t\tvar placeholder = _createPlaceholder(editorState.id, editorState.columnName);\n\t\t\t\tgrid.$grid_data.appendChild(placeholder);\n\n\t\t\t\tconst onAfterShow = (function(){\n\t\t\t\t\tthis._editor = editor;\n\t\t\t\t\tthis._placeholder = placeholder;\n\t\t\t\t\tthis._itemId = editorState.id;\n\t\t\t\t\tthis._columnName = editorState.columnName;\n\t\t\t\t\tthis._editorType = editorConfig.type;\n\n\t\t\t\t\tvar mapping = keyboardMapping.getMapping();\n\t\t\t\t\tif(mapping.onShow){\n\t\t\t\t\t\tmapping.onShow(this, placeholder, grid);\n\t\t\t\t\t}\n\t\t\t\t\tplaceholder._onReMount = (function(){\n\t\t\t\t\t\tthis.setValue();\n\t\t\t\t\t}).bind(this);\n\t\t\t\t}).bind(this);\n\n\t\t\t\tconst editorResult = editor.show(editorState.id, column, editorConfig, placeholder);\n\t\t\t\tif(editorResult && editorResult.then){\n\t\t\t\t\treturn editorResult.then(() => {\n\t\t\t\t\t\tonAfterShow();\n\t\t\t\t\t});\n\t\t\t\t}else{\n\t\t\t\t\tonAfterShow();\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tsetValue: function () {\n\t\t\t\tvar state = this.getState();\n\t\t\t\tvar itemId = state.id,\n\t\t\t\t\tcolumnName = state.columnName;\n\n\t\t\t\tvar column = grid.getColumn(columnName);\n\t\t\t\tvar item = store.getItem(itemId);\n\t\t\t\tvar editorConfig = this.getEditorConfig(columnName);\n\t\t\t\tvar value;\n\t\t\t\tif(!editorConfig)\n\t\t\t\t\treturn;\n\t\t\t\t// GS-2598: case for the editors in the lightbox\n\t\t\t\tif (gantt._lightbox_id) {\n\t\t\t\t\tlet assignment = store.getItem(this._itemId);\n\n\t\t\t\t\tif (editorConfig.map_to === \"text\") {\n\t\t\t\t\t\tlet resource = gantt.getDatastore(gantt.config.resource_store).getItem(assignment.resource_id);\n\t\t\t\t\t\tvalue = resource.text;\n\t\t\t\t\t} else if (editorConfig.map_to === \"start_date\") {\n\t\t\t\t\t\tvalue = (item.start_date === \"\" || item.start_date === null)\n\t\t\t\t\t\t\t? gantt.getTask(gantt._lightbox_id).start_date\n\t\t\t\t\t\t\t: item.start_date;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvalue = item[editorConfig.map_to];\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tvalue = item[editorConfig.map_to];\n\t\t\t\t}\n\n\t\t\t\tif (editorConfig.map_to === \"auto\") {\n\t\t\t\t\tvalue = store.getItem(itemId);\n\t\t\t\t}\n\n\t\t\t\tthis._editor.set_value(value, itemId, column, this._placeholder);\n\t\t\t\tthis.focus();\n\t\t\t},\n\n\t\t\tfocus: function(){\n\t\t\t\tthis._editor.focus(this._placeholder);\n\t\t\t},\n\n\t\t\tgetValue: function () {\n\t\t\t\tvar column = grid.getColumn(this._columnName);\n\t\t\t\treturn this._editor.get_value(this._itemId, column, this._placeholder);\n\t\t\t},\n\n\t\t\t_getItemValue: function() {\n\t\t\t\tvar editorConfig = this.getEditorConfig(this._columnName);\n\n\t\t\t\tif(!editorConfig)\n\t\t\t\t\treturn;\n\t\t\t\tvar value;\n\t\t\t\t// GS-2598: case for the editors in the lightbox\n\t\t\t\tif(gantt._lightbox_id){\n\t\t\t\t\tlet assignment = store.getItem(this._itemId);\n\t\t\t\t\tif (editorConfig.type === \"select\" && editorConfig.map_to !== \"mode\") {\n\t\t\t\t\t\tlet resource = gantt.getDatastore(gantt.config.resource_store).getItem(assignment.resource_id);\n\t\t\t\t\t\tvalue = resource.id;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvalue = assignment[editorConfig.map_to];\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\t\t\t\t\tvar item = gantt.getTask(this._itemId);\n\t\t\t\t\tvalue = item[editorConfig.map_to];\n\t\t\t\t}\n\n\t\t\t\tif(editorConfig.map_to == \"auto\"){\n\t\t\t\t\tvalue = store.getItem(this._itemId);\n\t\t\t\t}\n\t\t\t\treturn value;\n\t\t\t},\n\n\t\t\tisChanged: function(){\n\n\t\t\t\tvar column = grid.getColumn(this._columnName);\n\n\t\t\t\tvar value = this._getItemValue();\n\n\t\t\t\treturn this._editor.is_changed(value, this._itemId, column, this._placeholder);\n\t\t\t},\n\n\t\t\thide: function () {\n\t\t\t\tif(!this._itemId)\n\t\t\t\t\treturn;\n\n\t\t\t\tvar itemId = this._itemId,\n\t\t\t\t\tcolumnName = this._columnName;\n\n\t\t\t\tvar mapping = keyboardMapping.getMapping();\n\t\t\t\tif(mapping.onHide){\n\t\t\t\t\tmapping.onHide(this, this._placeholder, grid);\n\t\t\t\t}\n\n\t\t\t\tthis._itemId = null;\n\t\t\t\tthis._columnName = null;\n\t\t\t\tthis._editorType = null;\n\t\t\t\tif (!this._placeholder) return;\n\n\t\t\t\tif (this._editor && this._editor.hide) {\n\t\t\t\t\tthis._editor.hide(this._placeholder);\n\t\t\t\t}\n\t\t\t\tthis._editor = null;\n\t\t\t\tif (this._placeholder.parentNode) {\n\t\t\t\t\tthis._placeholder.parentNode.removeChild(this._placeholder);\n\t\t\t\t}\n\t\t\t\tthis._placeholder = null;\n\n\t\t\t\tthis.callEvent(\"onEditEnd\", [{id: itemId, columnName: columnName}]);\n\t\t\t},\n\t\t\tsave: function () {\n\t\t\t\tif(!(this.isVisible() && store.exists(this._itemId) && this.isChanged())) {\n\t\t\t\t\tthis.hide();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tvar itemId = this._itemId,\n\t\t\t\t\tcolumnName = this._columnName;\n\n\t\t\t\tif(!store.exists(itemId)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tvar item = store.getItem(itemId);\n\t\t\t\tvar editorConfig = this.getEditorConfig(columnName);\n\t\t\t\tvar editorState = {\n\t\t\t\t\tid: itemId,\n\t\t\t\t\tcolumnName: columnName,\n\t\t\t\t\tnewValue: this.getValue(),\n\t\t\t\t\toldValue: this._getItemValue()\n\t\t\t\t};\n\t\t\t\tif (this.callEvent(\"onBeforeSave\", [editorState]) !== false) {\n\t\t\t\t\tif (!this._editor.is_valid || this._editor.is_valid(editorState.newValue, editorState.id, grid.getColumn(columnName), this._placeholder)) {\n\t\t\t\t\t\t// GS-2598: set the initial value to the editor\n\t\t\t\t\t\tif(gantt._lightbox_id){\n\t\t\t\t\t\t\tif (editorState.newValue == \"\"){\n\t\t\t\t\t\t\t\teditorState.newValue = editorState.oldValue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar mapTo = editorConfig.map_to;\n\t\t\t\t\t\tvar value = editorState.newValue;\n\t\t\t\t\t\tif (mapTo != \"auto\") {\n\t\t\t\t\t\t\titem[mapTo] = value;\n\t\t\t\t\t\t\tupdateTaskDateProperties(item, mapTo, gantt.config.inline_editors_date_processing);\n\n\t\t\t\t\t\t\tstore.updateItem(itemId);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis._editor.save(itemId, grid.getColumn(columnName), this._placeholder);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.callEvent(\"onSave\", [editorState]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// GS-2598: don't close editor when we working in the lightbox\n\t\t\t\tif(!gantt._lightbox_id){\n\t\t\t\t\tthis.hide();\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t_findEditableCell: function findEditableCell(start, direction){\n\t\t\t\tvar nextIndex = start;\n\t\t\t\tvar columns = grid.getGridColumns();\n\t\t\t\tvar nextColumn = columns[nextIndex];\n\n\t\t\t\tvar columnName = nextColumn ? nextColumn.name : null;\n\t\t\t\tif(columnName){\n\t\t\t\t\twhile(columnName && !this.getEditorConfig(columnName)){\n\t\t\t\t\t\tcolumnName = this._findEditableCell(start + direction, direction);\n\t\t\t\t\t}\n\t\t\t\t\treturn columnName;\n\t\t\t\t}\n\t\t\t\treturn null;\n\t\t\t},\n\n\t\t\tgetNextCell: function moveCell(dir){\n\t\t\t\t// GS-1257. true means to exclude hidden columns\n\t\t\t\treturn this._findEditableCell(grid.getColumnIndex(this._columnName, true) + dir, dir);\n\t\t\t},\n\n\t\t\tgetFirstCell: function getFirstCell(){\n\t\t\t\treturn this._findEditableCell(0, 1);\n\t\t\t},\n\n\t\t\tgetLastCell: function getLastCell(){\n\t\t\t\treturn this._findEditableCell(grid.getGridColumns().length - 1, -1);\n\t\t\t},\n\n\t\t\teditNextCell: function nextCell(canChangeRow){\n\t\t\t\tvar cell = this.getNextCell(1);\n\t\t\t\tif(cell){\n\t\t\t\t\tvar nextColumn = this.getNextCell(1);\n\t\t\t\t\tif(nextColumn && this.getEditorConfig(nextColumn)){\n\t\t\t\t\t\tthis.startEdit(this._itemId, nextColumn);\n\t\t\t\t\t}\n\t\t\t\t}else if(canChangeRow && this.moveRow(1)){\n\t\t\t\t\tvar task = this.moveRow(1);\n\t\t\t\t\tcell = this.getFirstCell();\n\t\t\t\t\tif(cell && this.getEditorConfig(cell)){\n\t\t\t\t\t\tthis.startEdit(task, cell);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\n\t\t\teditPrevCell: function prevCell(canChangeRow){\n\t\t\t\tvar cell = this.getNextCell(-1);\n\t\t\t\tif(cell){\n\t\t\t\t\tvar nextColumn = this.getNextCell(-1);\n\t\t\t\t\tif(nextColumn && this.getEditorConfig(nextColumn)){\n\t\t\t\t\t\tthis.startEdit(this._itemId, nextColumn);\n\t\t\t\t\t}\n\t\t\t\t}else if(canChangeRow && this.moveRow(-1)){\n\t\t\t\t\tvar task = this.moveRow(-1);\n\t\t\t\t\tcell = this.getLastCell();\n\t\t\t\t\tif(cell && this.getEditorConfig(cell)){\n\t\t\t\t\t\tthis.startEdit(task, cell);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tmoveRow: function moveRow(dir) {\n\t\t\t\tvar moveTask = dir > 0 ? gantt.getNext : gantt.getPrev;\n\t\t\t\tmoveTask = gantt.bind(moveTask, gantt);\n\n\t\t\t\tvar nextItem = moveTask(this._itemId);\n\t\t\t\t// skip readonly rows\n\t\t\t\twhile (gantt.isTaskExists(nextItem) && gantt.isReadonly(gantt.getTask(nextItem))) {\n\t\t\t\t\tnextItem = moveTask(nextItem);\n\t\t\t\t}\n\t\t\t\treturn nextItem;\n\t\t\t},\n\n\t\t\teditNextRow: function nextRow(skipReadonly){\n\t\t\t\tvar id = this.getState().id;\n\t\t\t\tif (!gantt.isTaskExists(id)) return;\n\n\t\t\t\tvar next = null;\n\t\t\t\tif (skipReadonly){\n\t\t\t\t\tnext = this.moveRow(1);\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tnext = gantt.getNext(id);\n\t\t\t\t}\n\n\t\t\t\tif (gantt.isTaskExists(next)){\n\t\t\t\t\tthis.startEdit(next, this._columnName);\n\t\t\t\t}\n\t\t\t},\n\n\t\t\teditPrevRow: function prevRow(skipReadonly){\n\t\t\t\tvar id = this.getState().id;\n\t\t\t\tif (!gantt.isTaskExists(id)) return;\n\n\t\t\t\tvar prev = null;\n\t\t\t\tif (skipReadonly){\n\t\t\t\t\tprev = this.moveRow(-1);\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tprev = gantt.getPrev(id);\n\t\t\t\t}\n\n\t\t\t\tif (gantt.isTaskExists(prev)){\n\t\t\t\t\tthis.startEdit(prev, this._columnName);\n\t\t\t\t}\n\t\t\t},\n\t\t\tdetachStore: function(){\n\t\t\t\thandlers.forEach(function(handlerId){\n\t\t\t\t\tstore.detachEvent(handlerId);\n\t\t\t\t});\n\n\t\t\t\tganttHandlers.forEach(function(handlerId){\n\t\t\t\t\tgantt.detachEvent(handlerId);\n\t\t\t\t});\n\t\t\t\thandlers = [];\n\t\t\t\tganttHandlers = [];\n\n\t\t\t\tstore = null;\n\t\t\t\tthis.hide();\n\t\t\t},\n\t\t\tdestructor: function(){\n\t\t\t\tthis.detachStore();\n\t\t\t\tthis.detachAllEvents();\n\t\t\t}\n\t\t};\n\n\t\tutils.mixin(controller, keyboardMapping);\n\t\tutils.mixin(controller, eventBus);\n\n\t\treturn controller;\n\t}\n\n\n\tvar inlineEditController = {\n\t\tinit: initConfigs,\n\t\tcreateEditors: createGridEditors\n\t};\n\n\tutils.mixin(inlineEditController, keyboardMapping);\n\tutils.mixin(inlineEditController, eventBus);\n\n\treturn inlineEditController;\n}\n\n\n\n\nexport default create;","import defaultMapping from \"./keyboard_mappings/default\";\nimport keyNavMappings from \"./keyboard_mappings/keyboard_navigation\";\n\nexport default function(gantt){\n\n\tvar mapping = null;\n\n\treturn {\n\t\tsetMapping: function(map){\n\t\t\tmapping = map;\n\t\t},\n\t\tgetMapping: function(){\n\n\t\t\tif(mapping){\n\t\t\t\treturn mapping;\n\t\t\t}else if(gantt.config.keyboard_navigation_cells && gantt.ext.keyboardNavigation){\n\t\t\t\treturn keyNavMappings;\n\t\t\t}else{\n\t\t\t\treturn defaultMapping;\n\t\t\t}\n\t\t}\n\t};\n};\n","// optimized checker for task bars smart rendering\n\n// first check the vertical position since it's easier to calculate\nexport default function isBarInViewport(item, viewport, view, config, gantt){\n\tif(!item.start_date || !item.end_date){\n\t\treturn null;\n\t}\n\n\tvar top = view.getItemTop(item.id);\n\tvar height = view.getItemHeight(item.id);\n\n\tif(top > viewport.y_end || top + height < viewport.y){\n\t\treturn false;\n\t}\n\n\tvar padding = 200;\n\tvar startCoord = view.posFromDate(item.start_date, view._getPositioningContext ? view._getPositioningContext(item) : null);\n\tvar endCoord = view.posFromDate(item.end_date, view._getPositioningContext ? view._getPositioningContext(item) : null);\n\tvar left = Math.min(startCoord, endCoord) - padding;\n\tvar right = Math.max(startCoord, endCoord) + padding;\n\n\tif(left > viewport.x_end || right < viewport.x){\n\t\treturn false;\n\t}\n\n\treturn true;\n};","function createTaskRenderer(gantt) {\n\n\tfunction _render_task_element(task, view, config) {\n\t\tvar config = view.$getConfig();\n\t\tvar painters = config.type_renderers;\n\t\tvar renderer = painters[gantt.getTaskType(task.type)],\n\t\t\tdefaultRenderer = _task_default_render;\n\n\t\tif (!renderer) {\n\t\t\treturn defaultRenderer.call(gantt, task, view, config);\n\t\t}else{\n\t\t\treturn renderer.call(gantt, task, function(task){ return defaultRenderer.call(gantt, task, view, config);}, view);\n\t\t}\n\t}\n\n\tfunction _task_default_render(task, view, config) {\n\t\tif (gantt._isAllowedUnscheduledTask(task))\n\t\t\treturn;\n\n\t\tif (!gantt._isTaskInTimelineLimits(task)) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar pos = view.getItemPosition(task);\n\n\t\tvar cfg = config,\n\t\t\ttemplates = view.$getTemplates();\n\n\t\tvar taskType = gantt.getTaskType(task.type);\n\t\tvar height = view.getBarHeight(task.id, taskType == cfg.types.milestone);\n\n\t\tvar controlsMargin = 0;\n\t\tif (taskType == cfg.types.milestone) {\n\t\t\tcontrolsMargin = (height - pos.height)/2;\n\t\t}\n\n\t\tvar padd = Math.floor((view.getItemHeight(task.id) - height) / 2);\n\t\tconst hasBaselines = gantt.config.baselines && task.baselines && task.baselines.length;\n\t\tconst baselinesOnDifferentRow = gantt.config.baselines && (gantt.config.baselines.render_mode == \"separateRow\" || gantt.config.baselines.render_mode == \"individualRow\");\n\t\tif (hasBaselines && baselinesOnDifferentRow){\n\t\t\tif (task.bar_height !== \"full\" && task.bar_height < task.row_height){\n\t\t\t\tif (taskType === cfg.types.milestone){\n\t\t\t\t\tlet milestoneHeight = view.getBarHeight(task.id, true);\n\t\t\t\t\tlet milestoneWidth = Math.sqrt(2 * milestoneHeight * milestoneHeight);\n\t\t\t\t\tpadd = Math.floor((milestoneWidth - height) / 2) + 2;\n\t\t\t\t} else {\n\t\t\t\t\tpadd = 2;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t//\tif(task.type == cfg.types.milestone){\n\t//\t\tpadd -= 1;\n\t//\t}\n\t//\tif (taskType == cfg.types.milestone && cfg.link_line_width > 1) {\n\t//\t\t//little adjust milestone position, so horisontal corners would match link arrow when thickness of link line is more than 1px\n\t//\t\tpadd += 1;\n\t//\t}\n\n\t\tif (taskType == cfg.types.milestone) {\n\t\t\tpos.left -= Math.round(height / 2);\n\t\t\tpos.width = height;\n\t\t}\n\n\t\tvar div = document.createElement(\"div\");\n\n\t\tvar width = Math.round(pos.width);\n\n\t\tif(view.$config.item_attribute) {\n\t\t\tdiv.setAttribute(view.$config.item_attribute, task.id);\n\t\t\tdiv.setAttribute(view.$config.bind + \"_id\", task.id); // 'task_id'/'resource_id' for backward compatibility\n\t\t}\n\n\t\tif (cfg.show_progress && taskType != cfg.types.milestone) {\n\t\t\t_render_task_progress(task, div, width, cfg, templates);\n\t\t}\n\n\t\t//use separate div to display content above progress bar\n\t\tvar content = _render_task_content(task, width, templates);\n\n\t\tdiv.appendChild(content);\n\n\t\tvar css = _combine_item_class(\"gantt_task_line\",\n\t\t\ttemplates.task_class(task.start_date, task.end_date, task),\n\t\t\ttask.id,\n\t\t\tview);\n\t\tif (task.color || task.progressColor || task.textColor) {\n\t\t\tcss += \" gantt_task_inline_color\";\n\t\t}\n\t\tif (pos.width < 20){\n\t\t\tcss += \" gantt_thin_task\";\n\t\t}\n\t\tdiv.className = css;\n\n\t\tvar styles = [\n\t\t\t\"left:\" + pos.left + \"px\",\n\t\t\t\"top:\" + (padd + pos.top) + 'px',\n\t\t\t\"height:\" + (height) + 'px',\n\t\t\t\"line-height:\" + (Math.max(height < 30 ? height - 2 : height, 0)) + 'px',\n\t\t\t\"width:\" + width + 'px'\n\t\t];\n\n\t\tdiv.style.cssText = styles.join(\";\");\n\t\tif (task.color) {\n\t\t\tdiv.style.setProperty(\"--dhx-gantt-task-background\", task.color);\n\t\t}\n\t\tif (task.textColor) {\n\t\t\tdiv.style.setProperty(\"--dhx-gantt-task-color\", task.textColor);\n\t\t}\n\n\t\tif (task.progressColor) {\n\t\t\tdiv.style.setProperty(\"--dhx-gantt-task-progress-color\", task.progressColor);\n\t\t}\n\n\t\t\n\t\tvar side = _render_leftside_content(task, cfg, templates, controlsMargin);\n\t\tif (side) div.appendChild(side);\n\n\t\tside = _render_rightside_content(task, cfg, templates, controlsMargin);\n\t\tif (side) div.appendChild(side);\n\n\t\tgantt._waiAria.setTaskBarAttr(task, div);\n\n\t\tvar state = gantt.getState();\n\t\tconst taskEditable = !gantt.isReadonly(task);\n\t\tconst timelineDrag = gantt.ext.dragTimeline && gantt.ext.dragTimeline._isDragInProgress();\n\n\t\tif (taskEditable || timelineDrag) {\n\t\t\tif (cfg.drag_resize && !gantt.isSummaryTask(task) && taskType != cfg.types.milestone) {\n\t\t\t\t_render_pair(div, \"gantt_task_drag\", task, function (css) {\n\t\t\t\t\tvar el = document.createElement(\"div\");\n\t\t\t\t\tel.className = css;\n\t\t\t\t\treturn el;\n\t\t\t\t}, cfg);\n\t\t\t}\n\t\t\tif (cfg.drag_links && cfg.show_links) {\n\t\t\t\t_render_pair(div, \"gantt_link_control\", task, function (css) {\n\t\t\t\t\tvar outer = document.createElement(\"div\");\n\t\t\t\t\touter.className = css;\n\t\t\t\t\touter.style.cssText = [\n\t\t\t\t\t\t\"height:\" + height + 'px',\n\t\t\t\t\t\t\"line-height:\" + height + 'px'\n\t\t\t\t\t].join(\";\");\n\t\t\t\t\tvar inner = document.createElement(\"div\");\n\t\t\t\t\tinner.className = \"gantt_link_point\";\n\n\t\t\t\t\tvar showLinkPoints = false;\n\t\t\t\t\tif(state.link_source_id && cfg.touch){\n\t\t\t\t\t\tshowLinkPoints = true;\n\t\t\t\t\t}\n\n\t\t\t\t\tinner.style.display = showLinkPoints ? \"block\" : \"\";\n\t\t\t\t\touter.appendChild(inner);\n\t\t\t\t\treturn outer;\n\t\t\t\t}, cfg, controlsMargin);\n\t\t\t}\n\t\t}\n\t\treturn div;\n\t}\n\n\tfunction _render_side_content(task, template, cssClass, marginStyle) {\n\t\tif (!template) return null;\n\n\t\tvar text = template(task.start_date, task.end_date, task);\n\t\tif (!text) return null;\n\t\tvar content = document.createElement(\"div\");\n\t\tcontent.className = \"gantt_side_content \" + cssClass;\n\t\tcontent.innerHTML = text;\n\t\tif(marginStyle){\n\t\t\tcontent.style[marginStyle.type] = Math.abs(marginStyle.value) + \"px\";\n\t\t}\n\t\treturn content;\n\t}\n\n\tfunction _render_leftside_content(task, cfg, templates, margin) {\n\t\tvar css = \"gantt_left \" + _get_link_crossing_css(!cfg.rtl ? true : false, task, cfg);\n\t\tvar marginStyle = null;\n\t\tif(margin){\n\t\t\tmarginStyle = { type: \"marginRight\", value: margin };\n\t\t}\n\t\treturn _render_side_content(task, templates.leftside_text, css, marginStyle);\n\t}\n\n\tfunction _render_rightside_content(task, cfg, templates, margin) {\n\t\tvar css = \"gantt_right \" + _get_link_crossing_css(!cfg.rtl ? false : true, task, cfg);\n\t\tvar marginStyle = null;\n\t\tif(margin){\n\t\t\tmarginStyle = { type: \"marginLeft\", value: margin };\n\t\t}\n\t\treturn _render_side_content(task, templates.rightside_text, css, marginStyle);\n\t}\n\n\tfunction _get_link_crossing_css(left, task) {\n\t\tvar cond = _get_conditions(left);\n\n\t\tfor (var i in cond) {\n\t\t\tvar links = task[i];\n\t\t\tfor (var ln = 0; ln < links.length; ln++) {\n\t\t\t\tvar link = gantt.getLink(links[ln]);\n\n\t\t\t\tfor (var tp = 0; tp < cond[i].length; tp++) {\n\t\t\t\t\tif (link.type == cond[i][tp]) {\n\t\t\t\t\t\treturn \"gantt_link_crossing\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn \"\";\n\t}\n\n\n\tfunction _render_task_content(task, width, templates) {\n\t\tvar content = document.createElement(\"div\");\n\t\tif (gantt.getTaskType(task.type) != gantt.config.types.milestone){\n\t\t\tcontent.innerHTML = templates.task_text(task.start_date, task.end_date, task);\n\t\t} else if(gantt.getTaskType(task.type) == gantt.config.types.milestone && width) {\n\t\t\tcontent.style.height = content.style.width = width + \"px\";\n\t\t}\n\t\tcontent.className = \"gantt_task_content\";\n\t\t//content.style.width = width + 'px';\n\t\treturn content;\n\t}\n\n\tfunction _render_task_progress(task, element, maxWidth, cfg, templates) {\n\t\tvar done = task.progress * 1 || 0;\n\t\t//GS-2776: borders were removed in v9.0\n\t\tmaxWidth = Math.max(maxWidth, 0);\n\t\tvar pr = document.createElement(\"div\");\n\t\tvar width = Math.round(maxWidth * done);\n\n\t\twidth = Math.min(maxWidth, width);\n\n\t\tpr.style.width = width + 'px';\n\t\tpr.className = \"gantt_task_progress\";\n\t\tpr.innerHTML = templates.progress_text(task.start_date, task.end_date, task);\n\n\t\tif(cfg.rtl){\n\t\t\tpr.style.position = \"absolute\";\n\t\t\tpr.style.right = \"0px\";\n\t\t}\n\n\t\tvar wrapper = document.createElement(\"div\");\n\t\twrapper.className = \"gantt_task_progress_wrapper\";\n\t\twrapper.appendChild(pr);\n\t\telement.appendChild(wrapper);\n\n\t\tconst taskEditable = !gantt.isReadonly(task);\n\t\tconst timelineDrag = gantt.ext.dragTimeline && gantt.ext.dragTimeline._isDragInProgress();\n\n\t\tif (gantt.config.drag_progress && (taskEditable || timelineDrag)) {\n\t\t\tvar drag = document.createElement(\"div\");\n\n\t\t\tvar markerPos = width;\n\t\t\tif(cfg.rtl){\n\t\t\t\tmarkerPos = maxWidth - width;\n\t\t\t}\n\n\t\t\tdrag.style.left = markerPos + 'px';\n\t\t\tdrag.className = \"gantt_task_progress_drag\";\n\t\t\tdrag.innerHTML = `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"12\" height=\"9\" viewBox=\"0 0 12 9\" fill=\"none\">\n<path d=\"M5.58397 1.52543C5.78189 1.22856 6.21811 1.22856 6.41602 1.52543L10.5475 7.72265C10.769 8.05493 10.5308 8.5 10.1315 8.5L1.86852 8.5C1.46917 8.5 1.23097 8.05493 1.45249 7.72265L5.58397 1.52543Z\" fill=\"var(--dhx-gantt-progress-handle-background)\" stroke=\"var(--dhx-gantt-progress-handle-border)\"/>\n</svg>`;\n\t\t\tpr.appendChild(drag);\n\t\t\telement.appendChild(drag);\n\t\t}\n\t}\n\n\tfunction _get_conditions(leftside) {\n\t\tif (leftside) {\n\t\t\treturn {\n\t\t\t\t$source: [\n\t\t\t\t\tgantt.config.links.start_to_start\n\t\t\t\t],\n\t\t\t\t$target: [\n\t\t\t\t\tgantt.config.links.start_to_start,\n\t\t\t\t\tgantt.config.links.finish_to_start\n\t\t\t\t]\n\t\t\t};\n\t\t} else {\n\t\t\treturn {\n\t\t\t\t$source: [\n\t\t\t\t\tgantt.config.links.finish_to_start,\n\t\t\t\t\tgantt.config.links.finish_to_finish\n\t\t\t\t],\n\t\t\t\t$target: [\n\t\t\t\t\tgantt.config.links.finish_to_finish\n\t\t\t\t]\n\t\t\t};\n\t\t}\n\t}\n\n\tfunction _combine_item_class(basic, template, itemId, view) {\n\t\tvar cfg = view.$getConfig();\n\t\tvar css = [basic];\n\t\tif (template)\n\t\t\tcss.push(template);\n\n\t\tvar state = gantt.getState();\n\n\t\tvar task = gantt.getTask(itemId);\n\n\t\tif (gantt.getTaskType(task.type) == cfg.types.milestone) {\n\t\t\tcss.push(\"gantt_milestone\");\n\t\t}else if (gantt.getTaskType(task.type) == cfg.types.project) {\n\t\t\tcss.push(\"gantt_project\");\n\t\t}\n\n\t\tcss.push(\"gantt_bar_\" + gantt.getTaskType(task.type));\n\n\n\t\tif (gantt.isSummaryTask(task))\n\t\t\tcss.push(\"gantt_dependent_task\");\n\n\t\tif (gantt.isSplitTask(task) && ((task.$inlineSplit && task.$inlineSplit.length) || ((cfg.open_split_tasks && !task.$open && (task.$inlineSplit && task.$inlineSplit.length)) || !cfg.open_split_tasks))) {\n\t\t\tcss.push(\"gantt_split_parent\");\n\t\t}\n\n\t\tif (cfg.select_task && gantt.isSelectedTask(itemId)) {\n\t\t\tcss.push(\"gantt_selected\");\n\t\t}\n\n\t\tif (itemId == state.drag_id) {\n\t\t\tcss.push(\"gantt_drag_\" + state.drag_mode);\n\t\t\tif (state.touch_drag) {\n\t\t\t\tcss.push(\"gantt_touch_\" + state.drag_mode);\n\t\t\t}\n\t\t}\n\n\t\tif (state.link_source_id == itemId){\n\t\t\tcss.push(\"gantt_link_source\");\n\t\t\tif(state.link_from_start) {\n\t\t\t\tcss.push(\"gantt_link_from_start\");\n\t\t\t}else{\n\t\t\t\tcss.push(\"gantt_link_from_end\");\n\t\t\t}\n\t\t}\n\n\t\tif (state.link_target_id == itemId)\n\t\t\tcss.push(\"gantt_link_target\");\n\n\n\t\tif (cfg.highlight_critical_path && gantt.isCriticalTask) {\n\t\t\tif (gantt.isCriticalTask(task))\n\t\t\t\tcss.push(\"gantt_critical_task\");\n\t\t}\n\n\t\tif (state.link_landing_area &&\n\t\t\t(state.link_target_id && state.link_source_id) &&\n\t\t\t(state.link_target_id != state.link_source_id) &&\n\t\t\t(state.link_target_id == itemId || state.link_source_id == itemId)) {\n\n\t\t\tvar from_id = state.link_source_id;\n\t\t\tvar from_start = state.link_from_start;\n\t\t\tvar to_start = state.link_to_start;\n\n\t\t\tvar allowDrag = gantt.isLinkAllowed(from_id, itemId, from_start, to_start);\n\n\t\t\tvar dragClass = \"\";\n\t\t\tif (allowDrag) {\n\t\t\t\tif (to_start)\n\t\t\t\t\tdragClass = \"link_start_allow\";\n\t\t\t\telse\n\t\t\t\t\tdragClass = \"link_finish_allow\";\n\t\t\t} else {\n\t\t\t\tif (to_start)\n\t\t\t\t\tdragClass = \"link_start_deny\";\n\t\t\t\telse\n\t\t\t\t\tdragClass = \"link_finish_deny\";\n\t\t\t}\n\t\t\tcss.push(dragClass);\n\t\t}\n\t\treturn css.join(\" \");\n\t}\n\n\tfunction _render_pair(parent, css, task, content, config, margin) {\n\t\tvar state = gantt.getState();\n\t\tvar className, element;\n\t\tif (+task.start_date >= +state.min_date) {\n\t\t\tclassName = [css, config.rtl ? \"task_right\" : \"task_left\", \"task_start_date\"];\n\t\t\telement = content(className.join(\" \"));\n\t\t\telement.setAttribute(\"data-bind-property\", \"start_date\");\n\t\t\tif(margin){\n\t\t\t\telement.style.marginLeft = margin + \"px\";\n\t\t\t}\n\t\t\tparent.appendChild(element);\n\t\t}\n\n\t\tif (+task.end_date <= +state.max_date){\n\t\t\tclassName = [css, config.rtl ? \"task_left\" : \"task_right\", \"task_end_date\"];\n\t\t\telement = content(className.join(\" \"));\n\t\t\telement.setAttribute(\"data-bind-property\", \"end_date\");\n\t\t\tif(margin){\n\t\t\t\telement.style.marginRight = margin + \"px\";\n\t\t\t}\n\t\t\tparent.appendChild(element);\n\t\t}\n\n\t}\n\n\treturn _render_task_element;\n}\n\nexport default createTaskRenderer;","// optimized checker for task bars smart rendering\n\n// first check the vertical position since it's easier to calculate\nexport default function isBarInViewport(item, viewport, view, config, gantt){\n\tif(!((item.start_date && item.end_date) || (item.$auto_start_date && item.$auto_end_date))){\n\t\treturn null;\n\t}\n\n\tvar top = view.getItemTop(item.id);\n\tvar height = view.getItemHeight(item.id);\n\n\tif(top > viewport.y_end || top + height < viewport.y){\n\t\treturn false;\n\t}\n\n\tvar padding = 200;\n\n\tconst coords = [];\n\tif(item.start_date){\n\t\tcoords.push(view.posFromDate(item.start_date, view._getPositioningContext ? view._getPositioningContext(item) : null));\n\t}\n\tif(item.end_date){\n\t\tcoords.push(view.posFromDate(item.end_date, view._getPositioningContext ? view._getPositioningContext(item) : null));\n\t}\n\tif(item.$auto_start_date){\n\t\tcoords.push(view.posFromDate(item.$auto_start_date, view._getPositioningContext ? view._getPositioningContext(item) : null));\n\t}\n\tif(item.$auto_end_date){\n\t\tcoords.push(view.posFromDate(item.$auto_end_date, view._getPositioningContext ? view._getPositioningContext(item) : null));\n\t}\n\t\n\tvar left = Math.min(...coords) - padding;\n\tvar right = Math.max(...coords) + padding;\n\n\tif(left > viewport.x_end || right < viewport.x){\n\t\treturn false;\n\t}\n\n\treturn true;\n};","function createTaskRenderer(gantt) {\n\n\tfunction _render_task_element(task, view, config) {\n\t\n\t\tvar config = view.$getConfig();\n\t\tvar painters = config.type_renderers;\n\t\tvar renderer = painters[gantt.getTaskType(task.type)],\n\t\t\tdefaultRenderer = _task_default_render;\n\n\t\tif (!renderer) {\n\t\t\treturn defaultRenderer.call(gantt, task, view, config);\n\t\t}else{\n\t\t\treturn renderer.call(gantt, task, function(task){ return defaultRenderer.call(gantt, task, view, config);}, view);\n\t\t}\n\t}\n\n\tfunction _task_default_render(task, view, config) {\n\t\tif (gantt._isAllowedUnscheduledTask(task))\n\t\t\treturn;\n\n\t\tif (!gantt._isTaskInTimelineLimits(task)) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar pos = view.getItemPosition(task);\n\n\t\tvar cfg = config,\n\t\t\ttemplates = view.$getTemplates();\n\n\t\tvar taskType = gantt.getTaskType(task.type);\n\t\tvar height = view.getBarHeight(task.id, taskType == cfg.types.milestone);\n\n\t\tvar controlsMargin = 0;\n\t\tif (taskType == cfg.types.milestone) {\n\t\t\tcontrolsMargin = (height - pos.height)/2;\n\t\t}\n\n\t\tvar padd = Math.floor((view.getItemHeight(task.id) - height) / 2);\n\n\t\tconst hasBaselines = gantt.config.baselines && task.baselines && task.baselines.length;\n\t\tconst baselinesOnDifferentRow = gantt.config.baselines && (gantt.config.baselines.render_mode == \"separateRow\" || gantt.config.baselines.render_mode == \"individualRow\");\n\t\tif (hasBaselines && baselinesOnDifferentRow){\n\t\t\tif (task.bar_height !== \"full\" && task.bar_height < task.row_height){\n\t\t\t\tif (taskType === cfg.types.milestone){\n\t\t\t\t\tlet milestoneHeight = view.getBarHeight(task.id, true);\n\t\t\t\t\tlet milestoneWidth = Math.sqrt(2 * milestoneHeight * milestoneHeight);\n\t\t\t\t\tpadd = Math.floor((milestoneWidth - height) / 2) + 2;\n\t\t\t\t} else {\n\t\t\t\t\tpadd = 2;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tvar div = document.createElement(\"div\");\n\n\t\tvar width = Math.round(pos.width);\n\n\t\tif(view.$config.item_attribute) {\n\t\t\tdiv.setAttribute(view.$config.item_attribute, task.id);\n\t\t\tdiv.setAttribute(view.$config.bind + \"_id\", task.id); // 'task_id'/'resource_id' for backward compatibility\n\t\t}\n\n\t\t// generate outline bracket with planned dates\n\n\t\tconst planned = document.createElement(\"div\");\n\t\t\n\t\tplanned.classList.add(\"gantt_task_line_planned\", \"gantt_task_line\" , \"gantt_project\");\n\t\tconst plannedCoords = view.getItemPosition(task, task.start_date, task.end_date);\n\t\tconst barHeight = 5;\n\t\tplanned.style.cssText = [\n\t\t\t\"position:absolute\",\n\t\t\t\"left:\" + plannedCoords.left + \"px\",\n\t\t\t\"top:\" + (padd/2 + 1) + 'px',\n\t\t\t\"height:\" + barHeight + 'px',\n\t\t\t\"width:\" + plannedCoords.width + 'px'\n\t\t].join(\";\");\n\t\tplanned.style.setProperty('--dhx-gantt-scheduled-summary-bracket-size', \"10px\");\n\n\t\tdiv.appendChild(planned);\n\t\t// generate element with actual dates & progress\n\n\t\tconst actual = document.createElement(\"div\");\n\t\tconst actualCoords = view.getItemPosition(task, task.$auto_start_date || task.start_date, task.$auto_end_date || task.end_date);\n\t\tactual.classList.add(\"gantt_task_line_actual\", \"gantt_task_line\" , \"gantt_project\");\n\t\tactual.style.cssText = [\n\t\t\t\"position:absolute\",\n\t\t\t\"left:\" + actualCoords.left + \"px\",\n\t\t\t\"top:\" + (barHeight*2 + 6) + 'px',\n\t\t\t\"height:\" + (barHeight + 3) + 'px',\n\t\t\t\"width:\" + actualCoords.width + 'px'\n\t\t].join(\";\");\n\n\t\tdiv.appendChild(actual);\n\n\t\tif (cfg.show_progress && taskType != cfg.types.milestone) {\n\t\t\t_render_task_progress(task, actual, width, cfg, templates);\n\t\t}\n\n\t\t//use separate div to display content above progress bar\n\t\t// var content = _render_task_content(task, width, templates);\n\n\t\t// actual.appendChild(content);\n\n\t\tvar css = _combine_item_class(\"gantt_task_line\",\n\t\t\ttemplates.task_class(task.$auto_start_date || task.start_date, task.$auto_end_date || task.end_date, task),\n\t\t\ttask.id,\n\t\t\tview);\n\t\tif (task.color || task.progressColor || task.textColor) {\n\t\t\tcss += \" gantt_task_inline_color\";\n\t\t}\n\t\tif (pos.width < 20){\n\t\t\tcss += \" gantt_thin_task\";\n\t\t}\n\n\n\t\tif(task.start_date > task.$auto_start_date || task.end_date < task.$auto_end_date){\n\t\t\tcss += \" gantt_project_scheduling_conflict\";\n\t\t}\n\n\t\tdiv.className = css;\n\n\t\tdiv.style.top = (padd + pos.top) + 'px';\n\t\tdiv.style.height = (taskType == cfg.types.milestone ? pos.height : height) + 'px';\n\t\tif (task.color) {\n\t\t\tdiv.style.setProperty(\"--dhx-gantt-task-background\", task.color);\n\t\t}\n\t\tif (task.textColor) {\n\t\t\tdiv.style.setProperty(\"--dhx-gantt-task-color\", task.textColor);\n\t\t}\n\n\t\tif (task.progressColor) {\n\t\t\tdiv.style.setProperty(\"--dhx-gantt-task-progress-color\", task.progressColor);\n\t\t}\n\n\n\t\tvar side = _render_leftside_content(task, cfg, templates, controlsMargin);\n\t\tif (side) planned.appendChild(side);\n\n\t\tside = _render_rightside_content(task, cfg, templates, controlsMargin);\n\t\tif (side) planned.appendChild(side);\n\n\t\tgantt._waiAria.setTaskBarAttr(task, div);\n\n\t\tvar state = gantt.getState();\n\n\t\tif (!gantt.isReadonly(task)) {\n\t\t\tif (cfg.drag_resize) {\n\t\t\t\t_render_pair(planned, \"gantt_task_drag\", task, function (css) {\n\t\t\t\t\tvar el = document.createElement(\"div\");\n\t\t\t\t\tel.className = css;\n\t\t\t\t\treturn el;\n\t\t\t\t}, cfg);\n\t\t\t}\n\t\t\tif (cfg.drag_links && cfg.show_links) {\n\t\t\t\t_render_pair(planned, \"gantt_link_control\", task, function (css) {\n\t\t\t\t\tvar outer = document.createElement(\"div\");\n\t\t\t\t\touter.className = css;\n\t\t\t\t\touter.style.cssText = [\n\t\t\t\t\t\t\"height:\" + height + 'px',\n\t\t\t\t\t\t\"line-height:\" + height + 'px'\n\t\t\t\t\t].join(\";\");\n\t\t\t\t\tvar inner = document.createElement(\"div\");\n\t\t\t\t\tinner.className = \"gantt_link_point\";\n\n\t\t\t\t\tvar showLinkPoints = false;\n\t\t\t\t\tif(state.link_source_id && cfg.touch){\n\t\t\t\t\t\tshowLinkPoints = true;\n\t\t\t\t\t}\n\n\t\t\t\t\tinner.style.display = showLinkPoints ? \"block\" : \"\";\n\t\t\t\t\touter.appendChild(inner);\n\t\t\t\t\treturn outer;\n\t\t\t\t}, cfg, controlsMargin);\n\t\t\t}\n\t\t}\n\t\treturn div;\n\t}\n\n\tfunction _render_side_content(task, template, cssClass, marginStyle) {\n\t\tif (!template) return null;\n\n\t\tvar text = template(task.start_date, task.end_date, task);\n\t\tif (!text) return null;\n\t\tvar content = document.createElement(\"div\");\n\t\tcontent.className = \"gantt_side_content \" + cssClass;\n\t\tcontent.innerHTML = text;\n\t\tif(marginStyle){\n\t\t\tcontent.style[marginStyle.type] = Math.abs(marginStyle.value) + \"px\";\n\t\t}\n\t\treturn content;\n\t}\n\n\tfunction _render_leftside_content(task, cfg, templates, margin) {\n\t\tvar css = \"gantt_left \" + _get_link_crossing_css(!cfg.rtl ? true : false, task, cfg);\n\t\tvar marginStyle = null;\n\t\tif(margin){\n\t\t\tmarginStyle = { type: \"marginRight\", value: margin };\n\t\t}\n\t\treturn _render_side_content(task, templates.leftside_text, css, marginStyle);\n\t}\n\n\tfunction _render_rightside_content(task, cfg, templates, margin) {\n\t\tvar css = \"gantt_right \" + _get_link_crossing_css(!cfg.rtl ? false : true, task, cfg);\n\t\tvar marginStyle = null;\n\t\tif(margin){\n\t\t\tmarginStyle = { type: \"marginLeft\", value: margin };\n\t\t}\n\t\treturn _render_side_content(task, templates.rightside_text, css, marginStyle);\n\t}\n\n\tfunction _get_link_crossing_css(left, task) {\n\t\tvar cond = _get_conditions(left);\n\n\t\tfor (var i in cond) {\n\t\t\tvar links = task[i];\n\t\t\tfor (var ln = 0; ln < links.length; ln++) {\n\t\t\t\tvar link = gantt.getLink(links[ln]);\n\n\t\t\t\tfor (var tp = 0; tp < cond[i].length; tp++) {\n\t\t\t\t\tif (link.type == cond[i][tp]) {\n\t\t\t\t\t\treturn \"gantt_link_crossing\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn \"\";\n\t}\n\n\n\t// function _render_task_content(task, width, templates) {\n\t// \tvar content = document.createElement(\"div\");\n\t// \tif (gantt.getTaskType(task.type) != gantt.config.types.milestone){\n\t// \t\tcontent.innerHTML = templates.task_text(task.start_date, task.end_date, task);\n\t// \t} else if(gantt.getTaskType(task.type) == gantt.config.types.milestone && width) {\n\t// \t\tcontent.style.height = content.style.width = width + \"px\";\n\t// \t}\n\t// \tcontent.className = \"gantt_task_content\";\n\t// \t//content.style.width = width + 'px';\n\t// \treturn content;\n\t// }\n\n\tfunction _render_task_progress(task, element, maxWidth, cfg, templates) {\n\t\tvar done = task.progress * 1 || 0;\n\n\t\tmaxWidth = Math.max(maxWidth - 2, 0);//2px for borders\n\t\tvar pr = document.createElement(\"div\");\n\t\tvar width = Math.round(maxWidth * done);\n\n\t\twidth = Math.min(maxWidth, width);\n\t\tif (task.progressColor) {\n\t\t\tpr.style.backgroundColor = task.progressColor;\n\t\t\tpr.style.opacity = 1;\n\t\t}\n\t\tpr.style.width = width + 'px';\n\t\tpr.className = \"gantt_task_progress\";\n\t\tpr.innerHTML = templates.progress_text(task.start_date, task.end_date, task);\n\n\t\tif(cfg.rtl){\n\t\t\tpr.style.position = \"absolute\";\n\t\t\tpr.style.right = \"0px\";\n\t\t}\n\n\t\tvar wrapper = document.createElement(\"div\");\n\t\twrapper.className = \"gantt_task_progress_wrapper\";\n\t\twrapper.appendChild(pr);\n\t\telement.appendChild(wrapper);\n\n\t\tif (gantt.config.drag_progress && !gantt.isReadonly(task)) {\n\t\t\tvar drag = document.createElement(\"div\");\n\n\t\t\tvar markerPos = width;\n\t\t\tif(cfg.rtl){\n\t\t\t\tmarkerPos = maxWidth - width;\n\t\t\t}\n\n\t\t\tdrag.style.left = markerPos + 'px';\n\t\t\tdrag.className = \"gantt_task_progress_drag\";\n\t\t\tpr.appendChild(drag);\n\t\t\telement.appendChild(drag);\n\t\t}\n\t}\n\n\tfunction _get_conditions(leftside) {\n\t\tif (leftside) {\n\t\t\treturn {\n\t\t\t\t$source: [\n\t\t\t\t\tgantt.config.links.start_to_start\n\t\t\t\t],\n\t\t\t\t$target: [\n\t\t\t\t\tgantt.config.links.start_to_start,\n\t\t\t\t\tgantt.config.links.finish_to_start\n\t\t\t\t]\n\t\t\t};\n\t\t} else {\n\t\t\treturn {\n\t\t\t\t$source: [\n\t\t\t\t\tgantt.config.links.finish_to_start,\n\t\t\t\t\tgantt.config.links.finish_to_finish\n\t\t\t\t],\n\t\t\t\t$target: [\n\t\t\t\t\tgantt.config.links.finish_to_finish\n\t\t\t\t]\n\t\t\t};\n\t\t}\n\t}\n\n\tfunction _combine_item_class(basic, template, itemId, view) {\n\t\tvar cfg = view.$getConfig();\n\t\tvar css = [basic];\n\t\tif (template)\n\t\t\tcss.push(template);\n\n\t\tvar state = gantt.getState();\n\n\t\tvar task = gantt.getTask(itemId);\n\n\t\tif (gantt.getTaskType(task.type) == cfg.types.milestone) {\n\t\t\tcss.push(\"gantt_milestone\");\n\t\t}else if (gantt.getTaskType(task.type) == cfg.types.project) {\n\t\t\tcss.push(\"gantt_project\");\n\t\t}\n\n\t\tcss.push(\"gantt_bar_\" + gantt.getTaskType(task.type));\n\n\n\t\tif (gantt.isSummaryTask(task))\n\t\t\tcss.push(\"gantt_dependent_task\");\n\n\t\tif (gantt.isSplitTask(task) && ((task.$inlineSplit && task.$inlineSplit.length) || ((cfg.open_split_tasks && !task.$open) || !cfg.open_split_tasks))) {\n\t\t\tcss.push(\"gantt_split_parent\");\n\t\t}\n\n\t\tif (cfg.select_task && gantt.isSelectedTask(itemId)) {\n\t\t\tcss.push(\"gantt_selected\");\n\t\t}\n\n\t\tif (itemId == state.drag_id) {\n\t\t\tcss.push(\"gantt_drag_\" + state.drag_mode);\n\t\t\tif (state.touch_drag) {\n\t\t\t\tcss.push(\"gantt_touch_\" + state.drag_mode);\n\t\t\t}\n\t\t}\n\n\t\tif (state.link_source_id == itemId)\n\t\t\tcss.push(\"gantt_link_source\");\n\n\t\tif (state.link_target_id == itemId)\n\t\t\tcss.push(\"gantt_link_target\");\n\n\n\t\tif (cfg.highlight_critical_path && gantt.isCriticalTask) {\n\t\t\tif (gantt.isCriticalTask(task))\n\t\t\t\tcss.push(\"gantt_critical_task\");\n\t\t}\n\n\t\tif (state.link_landing_area &&\n\t\t\t(state.link_target_id && state.link_source_id) &&\n\t\t\t(state.link_target_id != state.link_source_id) &&\n\t\t\t(state.link_target_id == itemId || state.link_source_id == itemId)) {\n\n\t\t\tvar from_id = state.link_source_id;\n\t\t\tvar from_start = state.link_from_start;\n\t\t\tvar to_start = state.link_to_start;\n\n\t\t\tvar allowDrag = gantt.isLinkAllowed(from_id, itemId, from_start, to_start);\n\n\t\t\tvar dragClass = \"\";\n\t\t\tif (allowDrag) {\n\t\t\t\tif (to_start)\n\t\t\t\t\tdragClass = \"link_start_allow\";\n\t\t\t\telse\n\t\t\t\t\tdragClass = \"link_finish_allow\";\n\t\t\t} else {\n\t\t\t\tif (to_start)\n\t\t\t\t\tdragClass = \"link_start_deny\";\n\t\t\t\telse\n\t\t\t\t\tdragClass = \"link_finish_deny\";\n\t\t\t}\n\t\t\tcss.push(dragClass);\n\t\t}\n\t\treturn css.join(\" \");\n\t}\n\n\tfunction _render_pair(parent, css, task, content, config, margin) {\n\t\tvar state = gantt.getState();\n\t\tvar className, element;\n\t\tif (+task.start_date >= +state.min_date) {\n\t\t\tclassName = [css, config.rtl ? \"task_right\" : \"task_left\", \"task_start_date\"];\n\t\t\telement = content(className.join(\" \"));\n\t\t\telement.setAttribute(\"data-bind-property\", \"start_date\");\n\t\t\tif(margin){\n\t\t\t\telement.style.marginLeft = margin + \"px\";\n\t\t\t}\n\t\t\tparent.appendChild(element);\n\t\t}\n\n\t\tif (+task.end_date <= +state.max_date){\n\t\t\tclassName = [css, config.rtl ? \"task_left\" : \"task_right\", \"task_end_date\"];\n\t\t\telement = content(className.join(\" \"));\n\t\t\telement.setAttribute(\"data-bind-property\", \"end_date\");\n\t\t\tif(margin){\n\t\t\t\telement.style.marginRight = margin + \"px\";\n\t\t\t}\n\t\t\tparent.appendChild(element);\n\t\t}\n\n\t}\n\n\treturn _render_task_element;\n}\n\nexport default createTaskRenderer;","import isBarInViewport from \"./is_bar_in_viewport\";\nexport default function isSplitTaskInViewport(item, viewport, view, config, gantt){\n\tif (!gantt.isSplitTask(item)) {\n\t\treturn false;\n\t}\n\n\tvar range = gantt.getSubtaskDates(item.id);\n\n\treturn isBarInViewport({\n\t\tid: item.id,\n\t\tstart_date: range.start_date,\n\t\tend_date: range.end_date,\n\t\tparent: item.parent\n\t}, viewport, view, gantt);\n};","export default function(item, view, config){\n\treturn {\n\t\ttop: view.getItemTop(item.id),\n\t\theight: view.getItemHeight(item.id),\n\t\tleft: 0,\n\t\tright: Infinity\n\t};\n};","export default function getVisibleCellsRange(scale, viewport){\n\tvar firstCellIndex = 0;\n\tvar lastCellIndex = scale.left.length - 1;\n\tif(viewport){\n\t\tfor(var i = 0; i < scale.left.length; i++){\n\t\t\tvar left = scale.left[i];\n\t\t\tif(left < viewport.x){\n\t\t\t\tfirstCellIndex = i;\n\t\t\t}\n\t\t\tif(left > viewport.x_end){\n\t\t\t\tlastCellIndex = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn {\n\t\tstart: firstCellIndex,\n\t\tend: lastCellIndex\n\t};\n};","import isLegacyRender from \"../is_legacy_smart_render\";\n\nexport default function isColumnVisible(columnIndex, scale, viewPort, gantt){\n\tvar width = scale.width[columnIndex];\n\tif(width <= 0){\n\t\treturn false;\n\t}\n\tif(!gantt.config.smart_rendering || isLegacyRender(gantt)){\n\t\treturn true;\n\t}\n\tvar cellLeftCoord = scale.left[columnIndex] - width;\n\tvar cellRightCoord = scale.left[columnIndex] + width;\n\treturn (cellLeftCoord <= viewPort.x_end && cellRightCoord >= viewPort.x);//do not render skipped columns\n};","export default function (items, gantt){\n\tvar placeholderConfig = gantt.config.timeline_placeholder;\n\titems = items || [];\n\tif (placeholderConfig && items.filter(e => e.id === 'timeline_placeholder_task').length === 0){\n\t\tvar state = gantt.getState();\n\t\tvar lastTaskId = null;\n\t\tvar start_date = state.min_date;\n\t\tvar end_date = state.max_date;\n\t\tif (items.length){\n\t\t\tlastTaskId = items[items.length -1].id;\n\t\t}\n\t\tvar placeholderTask = {\n\t\t\tstart_date: start_date, \n\t\t\tend_date: end_date, \n\t\t\trow_height: placeholderConfig.height || 0,\n\t\t\tid: \"timeline_placeholder_task\", \n\t\t\tunscheduled: true,\n\t\t\tlastTaskId: lastTaskId, \n\t\t\tcalendar_id: placeholderConfig.calendar || \"global\",\n\t\t\t$source:[], \n\t\t\t$target: []\n\t\t};\n\t\titems.push(placeholderTask);\n\t}\n};","import isInViewPort from \"./viewport/is_link_in_viewport\";\nimport getVisibleRange from \"./viewport/factory/get_visible_link_range\";\nimport { childrenHaveBaselines, getMaxParentHeight } from \"./baseline_helper\";\n\n\nfunction createLinkRender(gantt){\n\nfunction _render_link_element(link, view, config) {\n\tvar source = gantt.getTask(link.source);\n\tif(source.hide_bar){\n\t\treturn;\n\t}\n\n\tvar target = gantt.getTask(link.target);\n\tif(target.hide_bar){\n\t\treturn;\n\t}\n\n\tvar pt = path_builder.get_endpoint(link, view, source, target);\n\tvar dy = pt.e_y - pt.y;\n\tvar dx = pt.e_x - pt.x;\n\tif(!dx && !dy){\n\t\treturn null;\n\t}\n\n\n\tvar dots = path_builder.get_points(link, view, source, target);\n\tconst lines = drawer.get_lines(dots, view);\n\n\tconst shapes = transform_lines_to_shapes(lines.filter(l => l.size > 0), config);\n  \n\tconst div = render_shapes(shapes, view, link, config);\n\n\n\tvar css = \"gantt_task_link\";\n\n\tif (link.color) {\n\t\tcss += \" gantt_link_inline_color\";\n\t}\n\tvar cssTemplate = gantt.templates.link_class ? gantt.templates.link_class(link) : \"\";\n\tif (cssTemplate) {\n\t\tcss += \" \" + cssTemplate;\n\t}\n\n\tif (config.highlight_critical_path && gantt.isCriticalLink) {\n\t\tif (gantt.isCriticalLink(link))\n\t\t\tcss += \" gantt_critical_link\";\n\t}\n\n\tdiv.className = css;\n\n\tif(view.$config.link_attribute){\n\t\tdiv.setAttribute(view.$config.link_attribute, link.id);\n\t\tdiv.setAttribute(\"link_id\", link.id);\n\t}\n\tif (link.color) {\n\t\tdiv.style.setProperty(\"--dhx-gantt-link-background\", link.color);\n\t}\n\n\tgantt._waiAria.linkAttr(link, div);\n\n\treturn div;\n}\n\n\tfunction render_shapes(shapes, view, link, config) {\n\t\tconst container = document.createElement(\"div\");\n\n\t\tshapes.forEach(shape => {\n\t\t\tlet element;\n\t\t\tif (shape.type === 'line') {\n\t\t\t\telement = drawer.render_line(shape.data, null, view, link.source);\n\t\t\t} else if (shape.type === 'corner') {\n\t\t\t\telement = drawer.render_corner(shape.data, view);\n\t\t\t}else if (shape.type === 'arrow') {\n\t\t\t\telement = drawer.render_arrow(shape.data, config);\n\t\t\t}\n\n\t\t\tcontainer.appendChild(element);\n\t\t});\n\n\t\treturn container;\n\t}\n\n\tfunction transform_lines_to_shapes(lines, config) {\n\t\tconst radius = config.link_radius || 4;\n\t\tconst arrowSize = config.link_arrow_size || 6; // Arrow size from config\n\t\tconst shapes = [];\n\t\n\t\tfor (let i = 0; i < lines.length; i++) {\n\t\t\tconst line = lines[i];\n\t\t\tconst nextLine = lines[i + 1];\n\t\n\t\t\tif (!nextLine || config.link_radius <= 1) {\n\t\t\t\tshapes.push({ type: 'line', data: line });\n\t\t\t\tcontinue;\n\t\t\t}\n\t\n\t\t\tif (line.direction !== nextLine.direction) {\n\t\t\t\tif(line.size < radius || nextLine.size < radius){\n\t\t\t\t\tshapes.push({ type: 'line', data: line });\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tline.size -= radius;\n\t\t\t\tshapes.push({ type: 'line', data: line });\n\t\n\t\t\t\tlet cornerX = line.x;\n\t\t\t\tlet cornerY = line.y - config.link_line_width / 2;\n\t\n\t\t\t\tswitch (line.direction) {\n\t\t\t\t\tcase 'right':\n\t\t\t\t\t\tcornerX += line.size;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'left':\n\t\t\t\t\t\tcornerX -= line.size;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'down':\n\t\t\t\t\t\tcornerY += line.size;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'up':\n\t\t\t\t\t\tcornerY -= line.size;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\n\t\t\t\tconst corner = {\n\t\t\t\t\tx: cornerX,\n\t\t\t\t\ty: cornerY,\n\t\t\t\t\tdirection: { from: line.direction, to: nextLine.direction },\n\t\t\t\t\tradius\n\t\t\t\t};\n\t\t\t\tshapes.push({ type: 'corner', data: corner });\n\t\n\t\t\t\tswitch (nextLine.direction) {\n\t\t\t\t\tcase 'right':\n\t\t\t\t\t\tnextLine.x += radius;\n\t\t\t\t\t\tnextLine.size -= radius;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'left':\n\t\t\t\t\t\tnextLine.x -= radius;\n\t\t\t\t\t\tnextLine.size -= radius;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'down':\n\t\t\t\t\t\tnextLine.y += radius;\n\t\t\t\t\t\tnextLine.size -= radius;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'up':\n\t\t\t\t\t\tnextLine.y -= radius;\n\t\t\t\t\t\tnextLine.size -= radius;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tshapes.push({ type: 'line', data: line });\n\t\t\t}\n\t\t}\n\t\n\t\tconst lastLine = lines[lines.length - 1];\n\t\n\t\tif (lastLine.direction === 'right' || lastLine.direction === 'left') {\n\t\t\tlastLine.size -= arrowSize*3/4; \n\t\n\t\t\tlet arrowX = lastLine.direction === 'right' ? (lastLine.x + lastLine.size) : lastLine.x - lastLine.size - arrowSize/2;\n\t\t\tlet arrowY = lastLine.y - (config.link_line_width / 2) - (arrowSize / 2) + 1;\n\t\n\t\t\tif(lastLine.direction === 'left'){\n\t\t\t\tarrowY -= 1;// left pointing arrows for some reason need adjustments\n\t\t\t\tarrowX -= 2;\n\t\t\t}else{\n\t\t\t\tarrowX -= 1;\n\t\t\t}\n\t\t\tconst arrow = {\n\t\t\t\tx: arrowX,\n\t\t\t\ty: arrowY,\n\t\t\t\tsize: arrowSize,\n\t\t\t\tdirection: lastLine.direction\n\t\t\t};\n\t\n\t\t\tshapes.push({ type: 'line', data: lastLine });\n\t\t\tshapes.push({ type: 'arrow', data: arrow });\n\t\t} else {\n\t\t\tshapes.push({ type: 'line', data: lastLine });\n\t\t}\n\t\n\t\treturn shapes;\n\t}\n\t\n\n\nvar drawer = {\n\tcurrent_pos: null,\n\tdirs: {\"left\": 'left', \"right\": 'right', \"up\": 'up', \"down\": 'down'},\n\tpath: [],\n\tclear: function () {\n\t\tthis.current_pos = null;\n\t\tthis.path = [];\n\t},\n\tpoint: function (pos) {\n\t\tthis.current_pos = gantt.copy(pos);\n\t},\n\tget_lines: function (dots) {\n\t\tthis.clear();\n\t\tthis.point(dots[0]);\n\t\tfor (var i = 1; i < dots.length; i++) {\n\t\t\tthis.line_to(dots[i]);\n\t\t}\n\t\treturn this.get_path();\n\t},\n\tline_to: function (pos) {\n\t\tvar next = gantt.copy(pos);\n\t\tvar prev = this.current_pos;\n\n\t\tvar line = this._get_line(prev, next);\n\t\tthis.path.push(line);\n\t\tthis.current_pos = next;\n\t},\n\tget_path: function () {\n\t\treturn this.path;\n\t},\n\tget_wrapper_sizes: function (v, view, itemId) {\n\t\tvar config = view.$getConfig();\n\t\tvar res,\n\t\t\twrapper_size = config.link_wrapper_width,\n\t\t\ty = v.y - (wrapper_size) / 2;\n\t\tswitch (v.direction) {\n\t\t\tcase this.dirs.left:\n\t\t\t\tres = {\n\t\t\t\t\ttop: y,\n\t\t\t\t\theight: wrapper_size,\n\t\t\t\t\tlineHeight: wrapper_size,\n\t\t\t\t\tleft: v.x - v.size - wrapper_size / 2,\n\t\t\t\t\twidth: v.size + wrapper_size\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tcase this.dirs.right:\n\t\t\t\tres = {\n\t\t\t\t\ttop: y,\n\t\t\t\t\tlineHeight: wrapper_size,\n\t\t\t\t\theight: wrapper_size,\n\t\t\t\t\tleft: v.x - wrapper_size / 2,\n\t\t\t\t\twidth: v.size + wrapper_size\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tcase this.dirs.up:\n\t\t\t\tres = {\n\t\t\t\t\ttop: y - v.size,\n\t\t\t\t\tlineHeight: v.size + wrapper_size,\n\t\t\t\t\theight: v.size + wrapper_size,\n\t\t\t\t\tleft: v.x - wrapper_size / 2,\n\t\t\t\t\twidth: wrapper_size\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tcase this.dirs.down:\n\t\t\t\tres = {\n\t\t\t\t\ttop: y /*- wrapper_size/2*/,\n\t\t\t\t\tlineHeight: v.size + wrapper_size,\n\t\t\t\t\theight: v.size + wrapper_size,\n\t\t\t\t\tleft: v.x - wrapper_size / 2,\n\t\t\t\t\twidth: wrapper_size\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn res;\n\t},\n\tget_line_sizes: function (v, view) {\n\t\tvar config = view.$getConfig();\n\t\tvar res,\n\t\t\tline_size = config.link_line_width,\n\t\t\twrapper_size = config.link_wrapper_width,\n\t\t\tsize = v.size + line_size;\n\t\tswitch (v.direction) {\n\t\t\tcase this.dirs.left:\n\t\t\tcase this.dirs.right:\n\t\t\t\tres = {\n\t\t\t\t\theight: line_size,\n\t\t\t\t\twidth: size,\n\t\t\t\t\tmarginTop: (wrapper_size - line_size) / 2,\n\t\t\t\t\tmarginLeft: (wrapper_size - line_size) / 2\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tcase this.dirs.up:\n\t\t\tcase this.dirs.down:\n\t\t\t\tres = {\n\t\t\t\t\theight: size,\n\t\t\t\t\twidth: line_size,\n\t\t\t\t\tmarginTop: (wrapper_size - line_size) / 2,\n\t\t\t\t\tmarginLeft: (wrapper_size - line_size) / 2\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\n\n\t\treturn res;\n\t},\n\trender_line: function (v, end, view, itemId) {\n\t\tvar pos = this.get_wrapper_sizes(v, view, itemId);\n\t\tvar wrapper = document.createElement(\"div\");\n\t\twrapper.style.cssText = [\n\t\t\t\"top:\" + pos.top + \"px\",\n\t\t\t\"left:\" + pos.left + \"px\",\n\t\t\t\"height:\" + pos.height + \"px\",\n\t\t\t\"width:\" + pos.width + \"px\"\n\t\t].join(';');\n\t\twrapper.className = \"gantt_line_wrapper\";\n\n\t\tvar innerPos = this.get_line_sizes(v, view);\n\t\tvar inner = document.createElement(\"div\");\n\t\tinner.style.cssText = [\n\t\t\t\"height:\" + innerPos.height + \"px\",\n\t\t\t\"width:\" + innerPos.width + \"px\",\n\t\t\t\"margin-top:\" + innerPos.marginTop + \"px\",\n\t\t\t\"margin-left:\" + innerPos.marginLeft + \"px\"\n\t\t].join(\";\");\n\n\t\tinner.className = \"gantt_link_line_\" + v.direction;\n\t\twrapper.appendChild(inner);\n\n\t\treturn wrapper;\n\t},\n\n\trender_corner: function (corner, view) {\n\t\tconst radius = corner.radius;\n\t\tconst config = view.$getConfig();\n\t\tconst lineWidth = config.link_line_width || 2;\n\t\tconst cornerDiv = document.createElement(\"div\");\n\t\n\t\tcornerDiv.classList.add(\"gantt_link_corner\");\n\t\tcornerDiv.classList.add(`gantt_link_corner_${corner.direction.from}_${corner.direction.to}`);\n\t\n\t\tcornerDiv.style.width = `${radius}px`;\n\t\tcornerDiv.style.height = `${radius}px`;\n\t\n\t\tlet borderVertical;\n\t\tlet borderHorizontal;\n\n\t\tif (corner.direction.from === 'right' && corner.direction.to === 'down') {\n\t\t\tborderVertical = \"Right\";\n\t\t\tborderHorizontal = \"Top\";\n\t\t\tcornerDiv.style.left = `${corner.x - config.link_line_width/2}px`;\n\t\t\tcornerDiv.style.top = `${corner.y}px`;\n\t\t} else if (corner.direction.from === 'down' && corner.direction.to === 'right') {\n\t\t\tborderVertical = \"Left\";\n\t\t\tborderHorizontal = \"Bottom\";\n\t\t\tcornerDiv.style.left = `${corner.x - config.link_line_width/2}px`;\n\t\t\tcornerDiv.style.top = `${corner.y}px`;\n\t\t} else if (corner.direction.from === 'right' && corner.direction.to === 'up') {\n\t\t\tborderVertical = \"Right\";\n\t\t\tborderHorizontal = \"Bottom\";\n\t\t\tcornerDiv.style.left = `${corner.x - config.link_line_width/2}px`;\n\t\t\tcornerDiv.style.top = `${corner.y - radius}px`;\n\t\t} else if (corner.direction.from === 'up' && corner.direction.to === 'right') {\n\t\t\tborderVertical = \"Left\";\n\t\t\tborderHorizontal = \"Top\";\n\t\t\tcornerDiv.style.left = `${corner.x - config.link_line_width/2}px`;\n\t\t\tcornerDiv.style.top = `${corner.y - radius}px`;\n\t\t} else if (corner.direction.from === 'left' && corner.direction.to === 'down') {\n\t\t\tborderVertical = \"Left\";\n\t\t\tborderHorizontal = \"Top\";\n\t\t\tcornerDiv.style.left = `${corner.x - radius - config.link_line_width/2}px`;\n\t\t\tcornerDiv.style.top = `${corner.y}px`;\n\t\t} else if (corner.direction.from === 'down' && corner.direction.to === 'left') {\n\t\t\tborderVertical = \"Right\";\n\t\t\tborderHorizontal = \"Bottom\";\n\t\t\tcornerDiv.style.left = `${corner.x - radius - config.link_line_width/2}px`;\n\t\t\tcornerDiv.style.top = `${corner.y}px`;\n\t\t} else if (corner.direction.from === 'left' && corner.direction.to === 'up') {\n\t\t\tborderVertical = \"Left\";\n\t\t\tborderHorizontal = \"Bottom\";\n\t\t\tcornerDiv.style.left = `${corner.x - radius - config.link_line_width/2}px`;\n\t\t\tcornerDiv.style.top = `${corner.y - radius}px`;\n\t\t} else if (corner.direction.from === 'up' && corner.direction.to === 'left') {\n\t\t\tborderVertical = \"Right\";\n\t\t\tborderHorizontal = \"Top\";\n\t\t\tcornerDiv.style.left = `${corner.x - radius - config.link_line_width/2}px`;\n\t\t\tcornerDiv.style.top = `${corner.y - radius}px`;\n\t\t}\n\n\t\tcornerDiv.style[`border${borderHorizontal}Width`] = `${lineWidth}px`;\n\t\tcornerDiv.style[`border${borderVertical}Width`] = `${lineWidth}px`;\n\t\tcornerDiv.style[`border${borderVertical}Style`] = `solid`;\n\t\tcornerDiv.style[`border${borderHorizontal}Style`] = `solid`;\n\t\tcornerDiv.style[`border${borderHorizontal}${borderVertical}Radius`] = `${radius}px`;\n\n\t\n\t\treturn cornerDiv;\n\t},\n\n\trender_arrow(arrow, config) {\n\t\tvar div = document.createElement(\"div\");\n\t\tvar top = arrow.y;\n\t\tvar left = arrow.x;\n\t\n\t\tvar size = config.link_arrow_size;\n\t\tdiv.style.setProperty(\"--dhx-gantt-icon-size\", `${size}px`);\n\t\n\t\tvar className = \"gantt_link_arrow gantt_link_arrow_\" + arrow.direction;\n\n\t\tdiv.style.top = top + \"px\";\n\t\tdiv.style.left = left + 'px';\n\t\tdiv.className = className;\n\t\n\t\treturn div;\n\t},\n\t\n\t_get_line: function (from, to) {\n\t\tvar direction = this.get_direction(from, to);\n\t\tvar vect = {\n\t\t\tx: from.x,\n\t\t\ty: from.y,\n\t\t\tdirection: this.get_direction(from, to)\n\t\t};\n\t\tif (direction == this.dirs.left || direction == this.dirs.right) {\n\t\t\tvect.size = Math.abs(from.x - to.x);\n\t\t} else {\n\t\t\tvect.size = Math.abs(from.y - to.y);\n\t\t}\n\t\treturn vect;\n\t},\n\tget_direction: function (from, to) {\n\t\tvar direction = 0;\n\t\tif (to.x < from.x) {\n\t\t\tdirection = this.dirs.left;\n\t\t} else if (to.x > from.x) {\n\t\t\tdirection = this.dirs.right;\n\t\t} else if (to.y > from.y) {\n\t\t\tdirection = this.dirs.down;\n\t\t} else {\n\t\t\tdirection = this.dirs.up;\n\t\t}\n\t\treturn direction;\n\t}\n\n};\n\nvar path_builder = {\n\n\tpath: [],\n\tclear: function () {\n\t\tthis.path = [];\n\t},\n\tcurrent: function () {\n\t\treturn this.path[this.path.length - 1];\n\t},\n\tpoint: function (next) {\n\t\tif (!next)\n\t\t\treturn this.current();\n\n\t\tthis.path.push(gantt.copy(next));\n\t\treturn next;\n\t},\n\tpoint_to: function (direction, diff, point) {\n\t\tif (!point)\n\t\t\tpoint = gantt.copy(this.point());\n\t\telse\n\t\t\tpoint = {x: point.x, y: point.y};\n\t\tvar dir = drawer.dirs;\n\t\tswitch (direction) {\n\t\t\tcase (dir.left):\n\t\t\t\tpoint.x -= diff;\n\t\t\t\tbreak;\n\t\t\tcase (dir.right):\n\t\t\t\tpoint.x += diff;\n\t\t\t\tbreak;\n\t\t\tcase (dir.up):\n\t\t\t\tpoint.y -= diff;\n\t\t\t\tbreak;\n\t\t\tcase (dir.down):\n\t\t\t\tpoint.y += diff;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\t\treturn this.point(point);\n\t},\n\tget_points: function (link, view, source, target) {\n\t\tvar pt = this.get_endpoint(link, view, source, target);\n\t\tvar xy = gantt.config;\n\n\t\tvar dy = pt.e_y - pt.y;\n\t\tvar dx = pt.e_x - pt.x;\n\n\t\tvar dir = drawer.dirs;\n\n\t\tvar rowHeight = view.getItemHeight(link.source);\n\n\t\tthis.clear();\n\t\tthis.point({x: pt.x, y: pt.y});\n\n\t\tvar shiftX = 2 * xy.link_arrow_size;//just random size for first line\n\t\tvar lineType = this.get_line_type(link, view.$getConfig());\n\n\t\tvar forward = (pt.e_x > pt.x);\n\t\tif (lineType.from_start && lineType.to_start) {\n\t\t\tthis.point_to(dir.left, shiftX);\n\t\t\tif (forward) {\n\t\t\t\tthis.point_to(dir.down, dy);\n\t\t\t\tthis.point_to(dir.right, dx);\n\t\t\t} else {\n\t\t\t\tthis.point_to(dir.right, dx);\n\t\t\t\tthis.point_to(dir.down, dy);\n\t\t\t}\n\t\t\tthis.point_to(dir.right, shiftX);\n\n\t\t} else if (!lineType.from_start && lineType.to_start) {\n\t\t\t// GS-2619. No need to add loops for the split tasks (zero dy means the tasks are on the same line)\n\t\t\tif (dy !== 0){\n\t\t\t\tforward = (pt.e_x > (pt.x + 2 * shiftX));\n\t\t\t}\n\t\t\tthis.point_to(dir.right, shiftX);\n\t\t\tif (forward) {\n\t\t\t\tdx -= shiftX;\n\t\t\t\tthis.point_to(dir.down, dy);\n\t\t\t\tthis.point_to(dir.right, dx);\n\t\t\t} else {\n\t\t\t\tdx -= 2 * shiftX;\n\t\t\t\tvar sign = dy > 0 ? 1 : -1;\n\n\t\t\t\tthis.point_to(dir.down, sign * (rowHeight / 2));\n\t\t\t\tthis.point_to(dir.right, dx);\n\t\t\t\tthis.point_to(dir.down, sign * ( Math.abs(dy) - (rowHeight / 2)));\n\t\t\t\tthis.point_to(dir.right, shiftX);\n\t\t\t}\n\n\t\t} else if (!lineType.from_start && !lineType.to_start) {\n\t\t\tthis.point_to(dir.right, shiftX);\n\t\t\tif (forward) {\n\t\t\t\tthis.point_to(dir.right, dx);\n\t\t\t\tthis.point_to(dir.down, dy);\n\t\t\t} else {\n\t\t\t\tthis.point_to(dir.down, dy);\n\t\t\t\tthis.point_to(dir.right, dx);\n\t\t\t}\n\t\t\tthis.point_to(dir.left, shiftX);\n\t\t} else if (lineType.from_start && !lineType.to_start) {\n\t\t\t// GS-2619. No need to add loops for the split tasks (zero dy means the tasks are on the same line)\n\t\t\tif (dy !== 0){\n\t\t\t\tforward = (pt.e_x > (pt.x - 2 * shiftX));\n\t\t\t}\n\t\t\tthis.point_to(dir.left, shiftX);\n\n\t\t\tif (!forward) {\n\t\t\t\tdx += shiftX;\n\t\t\t\tthis.point_to(dir.down, dy);\n\t\t\t\tthis.point_to(dir.right, dx);\n\t\t\t} else {\n\t\t\t\tdx += 2 * shiftX;\n\t\t\t\tvar sign = dy > 0 ? 1 : -1;\n\t\t\t\tthis.point_to(dir.down, sign * (rowHeight / 2));\n\t\t\t\tthis.point_to(dir.right, dx);\n\t\t\t\tthis.point_to(dir.down, sign * ( Math.abs(dy) - (rowHeight / 2)));\n\t\t\t\tthis.point_to(dir.left, shiftX);\n\t\t\t}\n\n\t\t}\n\n\t\treturn this.path;\n\t},\n\tget_line_type: function(link, config){\n\t\tvar types = config.links;\n\t\tvar from_start = false, to_start = false;\n\t\tif (link.type == types.start_to_start) {\n\t\t\tfrom_start = to_start = true;\n\t\t} else if (link.type == types.finish_to_finish) {\n\t\t\tfrom_start = to_start = false;\n\t\t} else if (link.type == types.finish_to_start) {\n\t\t\tfrom_start = false;\n\t\t\tto_start = true;\n\t\t} else if (link.type == types.start_to_finish) {\n\t\t\tfrom_start = true;\n\t\t\tto_start = false;\n\t\t} else {\n\t\t\tgantt.assert(false, \"Invalid link type\");\n\t\t}\n\n\t\tif(config.rtl){\n\t\t\tfrom_start = !from_start;\n\t\t\tto_start = !to_start;\n\t\t}\n\n\t\treturn {from_start: from_start, to_start: to_start};\n\t},\n\n\tget_endpoint: function (link, view, source, target) {\n\t\tvar config = view.$getConfig();\n\n\t\tvar lineType = this.get_line_type(link, config);\n\t\tvar from_start = lineType.from_start,\n\t\t\tto_start = lineType.to_start;\n\n\t\tvar from = getMilestonePosition(source, view, config),\n\t\t\tto = getMilestonePosition(target, view, config);\n\n\t\treturn {\n\t\t\tx: from_start ? from.left : (from.left + from.width),\n\t\t\te_x: to_start ? to.left : (to.left + to.width),\n\t\t\ty: from.top + (from.rowHeight/2) - 1,\n\t\t\te_y: to.top + (to.rowHeight/2) - 1\n\t\t};\n\t}\n};\n\nfunction getMilestonePosition(task, view, config){\n\tvar pos = view.getItemPosition(task);\n\n\t// GS-2270: Link to the split children shouldn't exceed the parent row height\n\tlet splitParams = getMaxParentHeight(gantt, view, task);\n\tlet maxHeight = splitParams.maxHeight;\n\n\tlet splitChild = splitParams.splitChild;\n\tconst baselinesOnDifferentRow = gantt.config.baselines && (gantt.config.baselines.render_mode == \"separateRow\" || gantt.config.baselines.render_mode == \"individualRow\");\n\tconst baselines = baselinesOnDifferentRow && task.baselines && task.baselines.length;\n\n\tif (splitParams.shrinkHeight){\n\t\tpos.rowHeight = maxHeight;\n\t}\n\n\tlet milestoneWidth;\n\tlet milestoneTask = gantt.getTaskType(task.type) == config.types.milestone;\n\tif(milestoneTask){\n\t\tlet milestoneHeight = view.getBarHeight(task.id, true);\n\t\tmilestoneWidth = Math.sqrt(2*milestoneHeight*milestoneHeight);\n\t\tif (splitParams.shrinkHeight && maxHeight < milestoneHeight){\n\t\t\tmilestoneHeight = maxHeight;\n\t\t\tmilestoneWidth = maxHeight;\n\t\t}\n\t\tpos.left -= milestoneWidth / 2;\n\t\tpos.width = milestoneWidth;\n\t} \n\tif (splitChild){\n\t\tif (maxHeight >= pos.height) {\n\t\t\tconst siblingBaselines = childrenHaveBaselines(gantt, task.parent);\n\t\t\tif (baselines || siblingBaselines){\n\t\t\t\tif (milestoneTask){\n\t\t\t\t\tpos.rowHeight = pos.height + 4;\n\t\t\t\t\tpos.left += (pos.width - pos.rowHeight + 4) / 2;\n\t\t\t\t\tpos.width = pos.rowHeight - 3;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tpos.rowHeight = pos.height + 6;\n\t\t\t\t}\n\t\t\t} else if (milestoneTask) {\n\t\t\t\tpos.left += (milestoneWidth - pos.height) / 2;\n\t\t\t}\n\t\t} else {\n\t\t\tpos.rowHeight = maxHeight + 2;\n\t\t\tif (milestoneTask){\n\t\t\t\tpos.left += (pos.width - pos.rowHeight + 4) / 2;\n\t\t\t\tpos.width = pos.rowHeight - 3;\n\t\t\t}\n\t\t}\n\t} else if (baselines){\n\t\tpos.rowHeight = pos.height + 4;\n\t}\n\n\treturn pos;\n}\n\n\nreturn {\n\trender: _render_link_element,\n\tupdate: null,\n\t//getRectangle: getLinkRectangle\n\tisInViewPort: isInViewPort,\n\tgetVisibleRange: getVisibleRange()\n};\n}\n\nexport default createLinkRender;","export default function(item, viewport, view, config, gantt){\n    // GS-2481 and GS-1715, don't remove selected task when using keyboard shortcuts and when the inline editor is opened\n    if(gantt.$ui.getView(\"grid\") && ((gantt.config.keyboard_navigation && gantt.getSelectedId()) || (gantt.ext.inlineEditors && gantt.ext.inlineEditors.getState().id))) {\n\t\t//GS-2661: selected task might be collapsed\n\t\tif(!item.$expanded_branch) return false;\n\t\treturn true;\n\t}\n    var top = view.getItemTop(item.id);\n\tvar height = view.getItemHeight(item.id);\n\n\tif(top > viewport.y_end || top + height < viewport.y){\n\t\treturn false;\n\t}\n\n\treturn true;\n};","import * as helpers from \"../utils/helpers\";\n\nexport default function createResourceTimelineBuilder(gantt){\n\n\tlet resourceTaskCache = {};\n\n\tgantt.$data.tasksStore.attachEvent(\"onStoreUpdated\", function(){\n\t\tresourceTaskCache = {};\n\t});\n\n\tfunction getResourceLoad(resource, resourceProperty, scale, timeline){\n\t\tconst cacheKey = resource.id + \"_\" + resourceProperty  + \"_\" + scale.unit + \"_\" + scale.step;\n\t\tlet res;\n\t\tif (!resourceTaskCache[cacheKey]) {\n\t\t\tres = resourceTaskCache[cacheKey] = calculateResourceLoad(resource, resourceProperty, scale, timeline);\n\n\t\t} else {\n\t\t\tres = resourceTaskCache[cacheKey];\n\t\t}\n\t\treturn res;\n\t}\n\n\tfunction calculateResourceLoadFromAssignments(items, scale, assignmentsPassed){\n\t\tconst scaleUnit = scale.unit;\n\t\tconst scaleStep = scale.step;\n\t\tconst timegrid = {};\n\n\t\tconst precalculatedTimes = {};\n\t\tfor (let i = 0; i < items.length; i++) {\n\t\t\tconst item = items[i];\n\t\t\tlet task = item;\n\t\t\tif(assignmentsPassed){\n\t\t\t\ttask = gantt.getTask(item.task_id);\n\t\t\t}\n\t\t\tif (task.unscheduled){\n\t\t\t\tcontinue; // do not process assignments for unscheduled tasks\n\t\t\t}\n\t\t\tlet minDate = (item.start_date || task.start_date);\n\t\t\tlet maxDate = (item.end_date || task.end_date);\n\t\t\tif(assignmentsPassed){\n\t\t\t\tif(item.start_date){\n\t\t\t\t\tminDate = new Date(Math.max(item.start_date.valueOf(), task.start_date.valueOf()));\n\t\t\t\t}\n\t\t\t\tif(item.end_date){\n\t\t\t\t\tmaxDate = new Date(Math.min(item.end_date.valueOf(), task.end_date.valueOf()));\n\t\t\t\t}\n\t\t\t\t// GS-2063: handle case with fixedDates mode\n\t\t\t\tif(item.mode && item.mode == \"fixedDates\"){\n\t\t\t\t\tminDate = item.start_date;\n\t\t\t\t\tmaxDate = item.end_date;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlet firstColumn = helpers.findBinary(scale.trace_x, minDate.valueOf());\n\t\t\tlet minScaleDate = new Date(scale.trace_x[firstColumn] || gantt.date[scaleUnit + \"_start\"](new Date(minDate)));\n\t\t\t// GS-2307: need to take into account that task could start before the min scale date\n\t\t\t// so the task would be added to timegrid\n\t\t\tlet currDate = new Date(Math.min(minDate.valueOf(), minScaleDate.valueOf())); \n\n\t\t\tlet calendar = gantt.config.work_time ? gantt.getTaskCalendar(task) : gantt;\n\t\t\tprecalculatedTimes[calendar.id] = {};\n\t\t\twhile (currDate < maxDate) {\n\t\t\t\tconst cachedTimes = precalculatedTimes[calendar.id];\n\n\t\t\t\tlet date = currDate;\n\t\t\t\tconst timestamp = date.valueOf();\n\n\t\t\t\tcurrDate = gantt.date.add(currDate, scaleStep, scaleUnit);\n\n\t\t\t\tif(cachedTimes[timestamp] === false){\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (!timegrid[timestamp]){\n\t\t\t\t\ttimegrid[timestamp] = {tasks: [], assignments: []};\n\t\t\t\t}\n\n\t\t\t\ttimegrid[timestamp].tasks.push(task);\n\t\t\t\tif(assignmentsPassed){\n\t\t\t\t\ttimegrid[timestamp].assignments.push(item);\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\t\treturn timegrid;\n\t}\n\n\tfunction calculateResourceLoad(resource, resourceProperty, scale, timeline) {\n\n\t\tlet items;\n\t\tlet assignmentsPassed = false;\n\t\tlet timegrid = {};\n\n\t\tif(gantt.config.process_resource_assignments && resourceProperty === gantt.config.resource_property){\n\t\t\tif(resource.$role == \"task\"){\n\t\t\t\titems = gantt.getResourceAssignments(resource.$resource_id, resource.$task_id);\n\t\t\t}else{\n\t\t\t\titems = gantt.getResourceAssignments(resource.id);\n\t\t\t}\n\n\t\t\tassignmentsPassed = true;\n\t\t}else if(resource.$role == \"task\"){\n\t\t\titems = [];\n\t\t}else{\n\t\t\titems = gantt.getTaskBy(resourceProperty, resource.id);\n\t\t}\n\n\t\ttimegrid = calculateResourceLoadFromAssignments(items, scale, assignmentsPassed);\n\t\tconst scaleUnit = scale.unit;\n\t\tconst scaleStep = scale.step;\n\n\t\tconst timetable = [];\n\t\tlet start, end, tasks, assignments, cell;\n\t\tconst config = timeline.$getConfig();\n\n\t\tfor(let i = 0; i < scale.trace_x.length; i++){\n\t\t\tstart = new Date(scale.trace_x[i]);\n\t\t\tend = gantt.date.add(start, scaleStep, scaleUnit);\n\t\t\tcell = timegrid[start.valueOf()] || {};\n\t\t\ttasks = cell.tasks || [];\n\t\t\tassignments = cell.assignments || [];\n\t\t\tif(tasks.length || config.resource_render_empty_cells){\n\t\t\t\ttimetable.push({\n\t\t\t\t\tstart_date: start,\n\t\t\t\t\tend_date: end,\n\t\t\t\t\ttasks: tasks,\n\t\t\t\t\tassignments: assignments\n\t\t\t\t});\n\t\t\t}else{\n\t\t\t\ttimetable.push(null);\n\t\t\t}\n\t\t}\n\n\t\treturn timetable;\n\t}\n\n\n\n\treturn getResourceLoad;\n};","import getRectangle from \"./viewport/get_bg_row_rectangle\";\nimport getVisibleRange from \"./viewport/get_visible_bars_range\";\nimport getVisibleCellsRange from \"./viewport/get_visible_cells_range\";\nimport isColumnVisible from \"./viewport/is_column_visible\";\nimport resourceTimetable from \"../../resource_timetable_builder\";\n\nfunction renderBar(level, start, end, timeline){\n\tvar top = (1 - (level*1||0))*100;\n\tvar left = timeline.posFromDate(start);\n\tvar right = timeline.posFromDate(end);\n\tvar element = document.createElement(\"div\");\n\telement.className = \"gantt_histogram_hor_bar\";\n\telement.style.top = top + '%';\n\telement.style.left = left + \"px\";\n\telement.style.width = (right - left + 1) + \"px\";\n\treturn element;\n}\nfunction renderConnection(prevLevel, nextLevel, left){\n\tif(prevLevel === nextLevel){\n\t\treturn null;\n\t}\n\n\tvar top = 1 - Math.max(prevLevel, nextLevel);\n\tvar height = Math.abs(prevLevel - nextLevel);\n\tvar element = document.createElement(\"div\");\n\telement.className = \"gantt_histogram_vert_bar\";\n\telement.style.top = top*100 + \"%\";\n\telement.style.height = height*100 + \"%\";\n\telement.style.left = left + \"px\";\n\n\treturn element;\n}\n\nfunction generateRenderResourceHistogram(gantt){\n\tvar getResourceLoad = resourceTimetable(gantt);\n\tvar renderedHistogramCells = {};\n\tvar renderedHistogramRows = {};\n\tvar renderedHistogramCapacity = {};\n\n\tfunction detachRenderedHistogramCell(id, index){\n\n\t\tvar renderedRow = renderedHistogramCells[id];\n\t\tif(renderedRow && renderedRow[index] &&\n\t\t\trenderedRow[index].parentNode\n\t\t\t){\n\t\t\t\trenderedRow[index].parentNode.removeChild(renderedRow[index]);\n\t\t\t}\n\t}\n\n\tfunction renderHistogramLine(capacity, timeline, maxCapacity, viewport){\n\t\tvar scale = timeline.getScale();\n\n\t\tvar el = document.createElement(\"div\");\n\n\t\tvar range = getVisibleCellsRange(scale, viewport);\n\t\tfor (var i = range.start; i <= range.end; i++) {\n\t\t\tvar colStart = scale.trace_x[i];\n\t\t\tvar colEnd = scale.trace_x[i + 1] || gantt.date.add(colStart, scale.step, scale.unit);\n\t\t\tvar col = scale.trace_x[i].valueOf();\n\t\t\tvar level = Math.min(capacity[col]/maxCapacity, 1) || 0;\n\t\t\t// do not render histogram for lines with below zero capacity, as it's reserved for folders\n\t\t\tif(level < 0){\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tvar nextLevel = Math.min(capacity[colEnd.valueOf()]/maxCapacity, 1) || 0;\n\t\t\tvar bar = renderBar(level, colStart, colEnd, timeline);\n\t\t\tif(bar){\n\t\t\t\tel.appendChild(bar);\n\t\t\t}\n\t\t\tvar connection = renderConnection(level, nextLevel, timeline.posFromDate(colEnd));\n\t\t\tif(connection){\n\t\t\t\tel.appendChild(connection);\n\t\t\t}\n\n\t\t}\n\t\treturn el;\n\t}\n\n\tfunction renderCapacityElement(resource, sizes, capacityMatrix, config, timeline, maxCapacity, viewport){\n\n\t\tvar renderedElement = renderedHistogramCapacity[resource.id];\n\t\tif(renderedElement && renderedElement.parentNode){\n\t\t\trenderedElement.parentNode.removeChild(renderedElement);\n\t\t}\n\n\t\tvar capacityElement = renderHistogramLine(capacityMatrix, timeline, maxCapacity, viewport);\n\t\tif (capacityElement && sizes) {\n\t\t\tcapacityElement.setAttribute(\"data-resource-id\", resource.id);\n\t\t\tcapacityElement.setAttribute(timeline.$config.item_attribute, resource.id);\n\t\t\tcapacityElement.style.position = \"absolute\";\n\t\t\tcapacityElement.style.top = (sizes.top + 1) + \"px\";\n\t\t\tcapacityElement.style.height = (timeline.getItemHeight(resource.id) - 1) + \"px\";\n\t\t\tcapacityElement.style.left = 0;\n\t\t}\n\t\treturn capacityElement;\n\t}\n\n\tfunction renderHistogramCell(resource, sizes, maxCapacity, config, templates, day, timeline){\n\t\tvar css = templates.histogram_cell_class(day.start_date, day.end_date, resource, day.tasks, day.assignments);\n\t\tvar content = templates.histogram_cell_label(day.start_date, day.end_date, resource, day.tasks, day.assignments);\n\t\tvar fill = templates.histogram_cell_allocated(day.start_date, day.end_date, resource, day.tasks, day.assignments);\n\t\tvar height = timeline.getItemHeight(resource.id) - 1;\n\t\tif(css || content){\n\t\t\tvar el = document.createElement('div');\n\t\t\tel.className = [\"gantt_histogram_cell\", css].join(\" \");\n\t\t\tel.setAttribute(timeline.$config.item_attribute, resource.id);\n\t\t\tel.style.cssText = [\n\t\t\t\t'left:' + sizes.left + 'px',\n\t\t\t\t'width:' + sizes.width + 'px',\n\t\t\t\t'height:' + (height) + 'px',\n\t\t\t\t'line-height:' + (height) + 'px',\n\t\t\t\t'top:' + (sizes.top + 1) + 'px'\n\t\t\t].join(\";\");\n\n\n\t\t\tif (content) {\n\t\t\t\tcontent = \"<div class='gantt_histogram_label'>\" + content +\"</div>\";\n\t\t\t}\n\n\t\t\tif (fill) {\n\t\t\t\tcontent = \"<div class='gantt_histogram_fill' style='height:\"+(Math.min(fill/maxCapacity||0, 1)*100)+\"%;'></div>\" + content;\n\t\t\t}\n\n\t\t\tif (content) {\n\t\t\t\tel.innerHTML = content;\n\t\t\t}\n\n\t\t\treturn el;\n\t\t}\n\t\treturn null;\n\t}\n\n\tfunction renderResourceHistogram(resource, timeline, config, viewport) {\n\t\tvar templates = timeline.$getTemplates();\n\t\tvar scale = timeline.getScale();\n\t\tvar timetable = getResourceLoad(resource, config.resource_property, scale, timeline);\n\n\t\tvar cells = [];\n\t\tvar capacityMatrix = {};\n\t\tvar maxCapacity = resource.capacity || timeline.$config.capacity || 24;\n\t\trenderedHistogramCells[resource.id] = {};\n\t\trenderedHistogramRows[resource.id] = null;\n\t\trenderedHistogramCapacity[resource.id] = null;\n\n\t\tvar smartRendering = !!viewport;//no viewport means smart rendering is disabled\n\n\t\tvar range = getVisibleCellsRange(scale, viewport);\n\t\tfor (var columnIndex = range.start; columnIndex <= range.end; columnIndex++) {\n\n\t\t\tvar day = timetable[columnIndex];\n\t\t\tif(!day){\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif(smartRendering && !isColumnVisible(columnIndex, scale, viewport, gantt)){\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tvar capacity = templates.histogram_cell_capacity(day.start_date, day.end_date, resource, day.tasks, day.assignments);\n\t\t\tcapacityMatrix[day.start_date.valueOf()] = capacity || 0;\n\t\t\tvar sizes = timeline.getItemPosition(resource, day.start_date, day.end_date);\n\n\t\t\tvar el = renderHistogramCell(resource, sizes, maxCapacity, config, templates, day, timeline);\n\t\t\tif(el){\n\t\t\t\tcells.push(el);\n\t\t\t\trenderedHistogramCells[resource.id][columnIndex] = el;\n\t\t\t}\n\t\t}\n\n\t\tvar row = null;\n\t\tif (cells.length) {\n\t\t\trow = document.createElement(\"div\");\n\t\t\tfor (var i = 0; i < cells.length; i++) {\n\t\t\t\trow.appendChild(cells[i]);\n\t\t\t}\n\n\t\t\tvar capacityElement = renderCapacityElement(resource, sizes, capacityMatrix, config, timeline, maxCapacity, viewport);\n\t\t\tif(capacityElement){\n\t\t\t\trow.appendChild(capacityElement);\n\t\t\t\trenderedHistogramCapacity[resource.id] = capacityElement;\n\t\t\t}\n\t\t\trenderedHistogramRows[resource.id] = row;\n\t\t}\n\n\t\treturn row;\n\t}\n\n\tfunction updateResourceHistogram(resource, node, timeline, config, viewport) {\n\t\tvar templates = timeline.$getTemplates();\n\t\tvar scale = timeline.getScale();\n\t\tvar timetable = getResourceLoad(resource, config.resource_property, scale, timeline);\n\t\tvar maxCapacity = resource.capacity || timeline.$config.capacity || 24;\n\t\tvar capacityMatrix = {};\n\n\t\tvar smartRendering = !!viewport;//no viewport means smart rendering is disabled\n\n\t\tvar range = getVisibleCellsRange(scale, viewport);\n\n\t\tvar checkedColumns = {};\n\t\tif(renderedHistogramCells && renderedHistogramCells[resource.id]){\n\t\t\tfor(var i in renderedHistogramCells[resource.id]){\n\t\t\t\tcheckedColumns[i] = i;\n\t\t\t}\n\t\t}\n\n\t\tfor (var columnIndex = range.start; columnIndex <= range.end; columnIndex++) {\n\t\t\tvar day = timetable[columnIndex];\n\t\t\tcheckedColumns[columnIndex] = false;\n\t\t\tif(!day){\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tvar capacity = templates.histogram_cell_capacity(day.start_date, day.end_date, resource, day.tasks, day.assignments);\n\t\t\tcapacityMatrix[day.start_date.valueOf()] = capacity || 0;\n\t\t\tvar sizes = timeline.getItemPosition(resource, day.start_date, day.end_date);\n\n\t\t\tif(smartRendering && !isColumnVisible(columnIndex, scale, viewport, gantt)){\n\t\t\t\tdetachRenderedHistogramCell(resource.id, columnIndex);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tvar renderedCell = renderedHistogramCells[resource.id];\n\t\t\tif(!renderedCell || !renderedCell[columnIndex]){\n\t\t\t\tvar el = renderHistogramCell(resource, sizes, maxCapacity, config, templates, day, timeline);\n\t\t\t\tif(el){\n\t\t\t\t\tnode.appendChild(el);\n\t\t\t\t\trenderedHistogramCells[resource.id][columnIndex] = el;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if(renderedCell && renderedCell[columnIndex] && !renderedCell[columnIndex].parentNode){\n\t\t\t\tnode.appendChild(renderedCell[columnIndex]);\n\t\t\t}\n\t\t}\n\n\t\tfor(var i in checkedColumns){\n\t\t\tif(checkedColumns[i] !== false){\n\t\t\t\tdetachRenderedHistogramCell(resource.id, i);\n\t\t\t}\n\t\t}\n\n\t\tvar capacityElement = renderCapacityElement(resource, sizes, capacityMatrix, config, timeline, maxCapacity, viewport);\n\t\tif(capacityElement){\n\t\t\tnode.appendChild(capacityElement);\n\t\t\trenderedHistogramCapacity[resource.id] = capacityElement;\n\t\t}\n\t}\n\n\treturn {\n\t\trender: renderResourceHistogram,\n\t\tupdate: updateResourceHistogram,\n\t\tgetRectangle: getRectangle,\n\t\tgetVisibleRange: getVisibleRange\n\t};\n}\n\nexport default generateRenderResourceHistogram;","import isBarInViewport from \"./is_bar_in_viewport\";\nexport default function areDatesInViewPort(task, viewport, view, config, gantt, dateProperties ){\n\tconst bar = {\n\t\tid: task.id,\n\t\tparent: task.id\n\t};\n\n\tfunction checkTaskProperties(task){\n\t\tconst hasAllDates = task[dateProperties.start_date] && task[dateProperties.end_date];\n\t\tif (!hasAllDates) {\n\t\t\treturn false;\n\t\t}\n\t\n\t\tfor (let i = 0; i < dateProperties.length; i++) {\n\t\t\tif (!task[dateProperties[i]]){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n\n\tconst taskProperties = checkTaskProperties(task);\n\tlet childProperties = false;\n\n\tif (taskProperties){\n\t\tbar.start_date = task[dateProperties.start_date];\n\t\tbar.end_date = task[dateProperties.end_date];\t\n\t}\n\n\tif (task.render == \"split\"){\n\t\tgantt.eachTask(function(child){\n\t\t\tif (checkTaskProperties(child)){\n\t\t\t\tchildProperties = true;\n\t\t\t\tbar.start_date = bar.start_date || child[dateProperties.start_date];\n\t\t\t\tbar.end_date = bar.end_date || child[dateProperties.end_date];\n\n\t\t\t\tif (bar.start_date < child[dateProperties.start_date]){\n\t\t\t\t\tbar.start_date = child[dateProperties.start_date];\n\t\t\t\t}\n\t\t\t\tif (bar.end_date > child[dateProperties.end_date]){\n\t\t\t\t\tbar.end_date = child[dateProperties.end_date];\t\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tif (taskProperties || childProperties){\n\t\treturn isBarInViewport(bar, viewport, view, gantt);\n\t} else {\n\t\treturn false;\n\t}\n};","import getVisibleRange from \"./viewport/get_visible_bars_range\";\nimport areDatesInViewPort from \"./viewport/are_dates_in_viewport\";\nimport { childrenHaveBaselines, getAdjustedPosition, isSplitParent } from \"./baseline_helper\";\n\nfunction isConstraintInViewPort (item, viewport, view, config, gantt){\n  if (shouldRenderConstraints(gantt)){\n    const dateProperties = {\n      start_date: \"constraint_date\",\n      end_date: \"constraint_date\",\n      additional_properties: [\"constraint_type\"]\n    };\n    return areDatesInViewPort(item, viewport, view, config, gantt, dateProperties);\n  } else {\n    // don't process constraints when they shouldn't be displayed\n    return false;\n  }\n}\n\nfunction shouldRenderConstraints(gantt){\n  const autoSchedulingConfig = gantt._getAutoSchedulingConfig();\n\n  if(!autoSchedulingConfig.apply_constraints){\n    return false;\n  }\n  if (autoSchedulingConfig.enabled && autoSchedulingConfig.show_constraints !== false){\n    return true;\n  }\n}\n\nfunction createTaskRenderer(gantt) {\n  // we need that for the use case when the constraints have different names\n  const constraintNames = {};\n  for (let prop in gantt.config.constraint_types) {\n    constraintNames[gantt.config.constraint_types[prop]] = prop;\n  }\n\n  function getConstraintName(task) {\n    const constraintValue = gantt.getConstraintType(task);\n    const commonName = constraintNames[constraintValue].toLowerCase();\n    return commonName;\n  }\n\n  function generateConstraintNode(task, timeline, childBaselines){\n    const constraintType = getConstraintName(task);\n    if (constraintType == \"asap\" || constraintType == \"alap\"){\n      return false;\n    }\n    const el = document.createElement(\"div\");\n    const sizes = gantt.getTaskPosition(task, task.constraint_date, task.constraint_date);\n\n    const heightLimit = 30;\n    let { height, marginTop } = getAdjustedPosition(gantt, timeline, sizes, heightLimit, task, childBaselines);\n\n    let width = height;\n\n    let marginLeft = 0;\n    switch (constraintType) {\n      case \"snet\":\n      case \"fnet\":\n      case \"mso\":\n        if (gantt.config.rtl){\n          marginLeft = 1;\n        }\n        else {\n          marginLeft = -width - 1;\n        }\n\n        break;\n      case \"snlt\":\n      case \"fnlt\":\n      case \"mfo\":\n        if (gantt.config.rtl){\n          marginLeft = -width - 1;\n        }\n        else {\n          marginLeft = 1;\n        }\n        break;\n\n    }\n\n    if (task.type === gantt.config.types.milestone){\n      marginTop -= 1;\n    }\n\n    el.style.height = height + \"px\";\n    el.style.width = width + \"px\";\n\n    el.style.left = sizes.left + \"px\";\n    el.style.top = sizes.top + \"px\";\n    \n    el.style.marginLeft = marginLeft + \"px\";\n    el.style.marginTop = marginTop + \"px\";\n\n    el.className = \"gantt_constraint_marker gantt_constraint_marker_\" + constraintType;\n    \n    switch (constraintType) {\n      case \"snet\":\n      case \"snlt\":\n      case \"fnet\":\n      case \"fnlt\":\n        el.innerHTML = `<svg width=\"32\" height=\"32\" viewBox=\"0 0 32 32\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n<g id=\"Start No Later Than\">\n<line id=\"Line 3\" x1=\"30.5\" y1=\"6.92097e-08\" x2=\"30.5\" y2=\"32\" stroke=\"#555D63\" stroke-width=\"3\" stroke-dasharray=\"3 3\"/>\n<path id=\"Vector\" d=\"m 18.3979,23.5 v -6 H 3.05161 L 3,14.485 H 18.3979 V 8.5 L 27,16 Z\" fill=\"#555D63\"/>\n</g>\n</svg>\n`;\n      break;\n      case \"mfo\":\n      case \"mso\":\n        el.innerHTML = `<svg width=\"32\" height=\"32\" viewBox=\"0 0 32 32\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n<g id=\"Must Start On \">\n<path id=\"Vector\" d=\"m 18.3979,23.5 v -6 H 3.05161 L 3,14.485 H 18.3979 V 8.5 L 27,16 Z\" fill=\"#555D63\"/>\n<line id=\"line\" x1=\"30.5\" y1=\"-6.55671e-08\" x2=\"30.5\" y2=\"32\" stroke=\"black\" stroke-opacity=\"0.7\" stroke-width=\"3\"/>\n</g>\n</svg>\n`;\n        break;\n    }\n    \n    \n    el.setAttribute(\"data-task-id\", task.id);\n\n    return el;\n  }\n\n  function renderConstraints(task, timeline, config, viewPort) {\n    if (shouldRenderConstraints(gantt)){\n      const constraintNodes = document.createElement(\"div\");\n      constraintNodes.className = \"gantt_constraint_nodes\";\n      constraintNodes.setAttribute(\"data-task-row-id\", task.id);\n  \n      if (task.constraint_date && task.constraint_type) {\n        const taskConstraint = generateConstraintNode(task, timeline);\n        if (taskConstraint){\n          constraintNodes.appendChild(taskConstraint);  \n        }\n      }\n\n      if (isSplitParent(task)){\n        const childBaselines = childrenHaveBaselines(gantt, task.id);\n        gantt.eachTask(function(child){\n          if (child.constraint_date && child.constraint_type) {\n            const childConstraint = generateConstraintNode(child, timeline, childBaselines);\n            if (childConstraint){\n              constraintNodes.appendChild(childConstraint);\n            }\n          }\n        }, task.id);\n      }\n  \n      if (constraintNodes.childNodes.length){\n        return constraintNodes;\n      }\n  \n    }\n  }\n  return {\n    render: renderConstraints,\n    isInViewPort: isConstraintInViewPort,\n    getVisibleRange: getVisibleRange\n  };\n}\n\nexport default createTaskRenderer;\n","import getVisibleRange from \"./viewport/get_visible_bars_range\";\nimport areDatesInViewPort from \"./viewport/are_dates_in_viewport\";\nimport { childrenHaveBaselines, getAdjustedPosition, isSplitParent } from \"./baseline_helper\";\n\nfunction isDeadlineInViewPort (item, viewport, view, config, gantt){\n\tconst dateProperties = {\n\t\tstart_date: \"deadline\",\n\t\tend_date: \"deadline\"\n\t};\n\treturn areDatesInViewPort(item, viewport, view, config, gantt, dateProperties);\n}\n\nfunction createTaskRenderer(gantt) {\n\n  function generateDeadlineNode(task, timeline, childBaselines){\n    const el = document.createElement(\"div\");\n\n    const sizes = gantt.getTaskPosition(task, task.deadline, task.deadline);\n\n    const heightLimit = 20;\n    const { height, marginTop } = getAdjustedPosition(gantt, timeline, sizes, heightLimit, task, childBaselines);\n    \n    let width = height;\n\n    if (gantt.config.rtl){\n      sizes.left += width;\n    }\n\n    el.style.left = sizes.left - width + \"px\";\n    el.style.top = sizes.top + \"px\";\n    el.style.marginTop = marginTop + \"px\";\n\n    el.style.width = width + \"px\";\n    el.style.height = height + \"px\";\n\n    el.style.fontSize = height + \"px\";\n\n    el.className = \"gantt_task_deadline\";\n    el.setAttribute(\"data-task-id\", task.id);\n\n    return el;\n  }\n\n  function renderDeadline(task, timeline, config, viewPort) {\n    const deadlineNodes = document.createElement(\"div\");\n    deadlineNodes.className = \"gantt_deadline_nodes\";\n    deadlineNodes.setAttribute(\"data-task-row-id\", task.id);\n\n    if (task.deadline) {\n      const taskDeadline = generateDeadlineNode(task, timeline);\n      deadlineNodes.appendChild(taskDeadline);\n    }\n    if (isSplitParent(task)){\n      const childBaselines = childrenHaveBaselines(gantt, task.id);\n      gantt.eachTask(function(child){\n        if (child.deadline){\n          const childDeadline = generateDeadlineNode(child, timeline, childBaselines);\n          deadlineNodes.appendChild(childDeadline);\n        }\n      }, task.id);\n    }\n\n    if (deadlineNodes.childNodes.length){\n      return deadlineNodes;\n    }\n  }\n  return {\n    render: renderDeadline,\n    isInViewPort: isDeadlineInViewPort,\n    getVisibleRange: getVisibleRange\n  };\n}\n\nexport default createTaskRenderer;\n","import getVisibleRange from \"./viewport/get_visible_bars_range\";\nimport areDatesInViewPort from \"./viewport/are_dates_in_viewport\";\nimport { getMaxParentHeight, getMilestoneHeight, getInvertedMilestoneHeight, isSplitParent } from \"./baseline_helper\";\n\nfunction isBaselineInViewPort (task, viewport, view, config, gantt){\n  let inViewport = false;\n  const dateProperties = {\n    start_date: \"start_date\",\n    end_date: \"end_date\"\n  };\n  if (task.type == gantt.config.types.milestone){\n    dateProperties.end_date = dateProperties.start_date;\n  }\n\n  if (task.baselines){\n    inViewport = iterateBaselines(task, viewport, view, config, gantt, dateProperties);\n  }\n  if (isSplitParent(task)){\n    gantt.eachTask(function(child){\n      if (inViewport){\n        return;\n      }\n      if (child.baselines && child.baselines.length) {\n        if (child.type == gantt.config.types.milestone){\n          dateProperties.end_date = dateProperties.start_date;\n        }      \n        if (iterateBaselines(child, viewport, view, config, gantt, dateProperties)){\n          inViewport = true;\n        }\n      }\n    }, task.id);\n  }\n\n  return inViewport;\n}\n\nfunction iterateBaselines(task, viewport, view, config, gantt, dateProperties){\n  for (var i = 0; i < task.baselines.length; i++) {\n    const baseline = {\n      id: task.id,\n      parent: task.parent,\n      start_date: task.baselines[i].start_date,\n      end_date: task.baselines[i].end_date\n    };\n    if (areDatesInViewPort(baseline, viewport, view, config, gantt, dateProperties)){\n      return true;\n    }\n  }\n}\n\nfunction createBaselineRenderer(gantt) {\n\n  function generateBaselineNode(task, baseline, index, timeline, splitChild){\n    const el = document.createElement(\"div\");\n    let baselineEnd = baseline.end_date;\n    let milestoneTask = task.type === gantt.config.types.milestone;\n    if (milestoneTask){\n      baselineEnd = baseline.start_date;\n    }\n    const sizes = gantt.getTaskPosition(task, baseline.start_date, baselineEnd);\n\n    let milestoneMarginTop = 0;\n    let milestoneWidth;\n    if (milestoneTask){\n      let milestoneHeight = timeline.getBarHeight(task.id, true);\n      milestoneWidth = getMilestoneHeight(milestoneHeight);\n      milestoneMarginTop = Math.floor((milestoneWidth - milestoneHeight) / 4);\n    }\n\n    let parentHeight = getMaxParentHeight(gantt, timeline, task, sizes.rowHeight);\n    let maxHeight = parentHeight.maxHeight;\n\n\n    let top = sizes.top + 1 + milestoneMarginTop;\n    let height = timeline.getBarHeight(task.id, task.type);\n    const baselineSubrowHeight = gantt.config.baselines.row_height;\n    const baselineBarHeight = gantt.config.baselines.bar_height;\n\n    // between task and first baseline\n    let siblingBaselinesSize;\n    let marginTop;\n\n    switch (gantt.config.baselines.render_mode) {\n      case \"separateRow\":\n        top += sizes.height + (baselineSubrowHeight - baselineBarHeight) / 2;\n        height = baselineBarHeight;\n        break;\n\n      case \"individualRow\":\n       // betweenBaselines = 3 * (index + 1);\n        siblingBaselinesSize = (baselineSubrowHeight) * index;\n        top += sizes.height + siblingBaselinesSize + (baselineSubrowHeight - baselineBarHeight) / 2;\n    \n        height = baselineBarHeight;\n        break;\n    \n      case \"taskRow\":\n      default:\n        // TODO: simplify positioning\n        marginTop = 1;\n        if (splitChild){\n          maxHeight = getMaxParentHeight(gantt, timeline, task).maxHeight;\n          if (milestoneMarginTop){\n            if (maxHeight >= milestoneWidth){\n              marginTop = (maxHeight - height) / 2 - 1 - milestoneMarginTop;\n            } else {\n              height = getInvertedMilestoneHeight(maxHeight);\n              top = sizes.top;\n              marginTop = Math.abs(height - maxHeight) / 2;\n              milestoneMarginTop = 0; // for maxBottom\n            }\n          } else {\n            if (maxHeight > height){\n              marginTop = (maxHeight - height) / 2 - 1;\n            } \n            marginTop -= milestoneMarginTop;  \n          }\n          if(!task.bar_height){\n            marginTop -= 1;\n          }else{\n           // marginTop += 1;\n          }\n        } else {\n          if (task.bar_height && sizes.rowHeight >= task.bar_height){\n            marginTop = (sizes.rowHeight - task.bar_height) / 2 - 1;\n          }\n          marginTop += milestoneMarginTop;\n\n          if(!task.bar_height){\n            marginTop += 2;\n          }\n          if (milestoneTask){\n            marginTop += 1;\n          }\n \n        }\n        break;\n    }\n\n    let maxBottom = sizes.top + maxHeight + 1 - milestoneMarginTop;\n\n\n    // don't exceed maximal task row height\n    if (top + height > maxBottom){\n      height -= top + height - maxBottom;\n      if (height <= 0) {\n        return false;\n      }\n    }\n\n\n    el.style.left = sizes.left + \"px\";\n    el.style.width = sizes.width + \"px\";\n    el.style.top = top + \"px\";\n    el.style.height = Math.floor(height) + \"px\";\n    if(marginTop){\n      el.style.marginTop = marginTop + \"px\";\n    }\n    el.className = `gantt_task_baseline gantt_task_baseline_${index} ${baseline.className || \"\"}`;\n\n    if (milestoneTask){\n      el.className += \" gantt_milestone_baseline\";\n      el.style.width = el.style.height = height + \"px\";\n      el.style.marginLeft = Math.floor(-height / 2) + \"px\";\n    } else {\n      el.innerHTML = gantt.templates.baseline_text(task, baseline, index);\n    }\n\n\n    el.setAttribute(\"data-task-id\", task.id);\n    el.setAttribute(\"data-baseline-id\", baseline.id);\n\n    return el;\n  }\n\n  function renderBaseline(task, timeline, config, viewPort) {\n    if (!gantt.config.baselines.render_mode){\n      return;\n    }\n\n    const baselineNodes = document.createElement(\"div\");\n    baselineNodes.className = \"gantt_baseline_nodes\";\n    baselineNodes.setAttribute(\"data-task-row-id\", task.id);\n\n    if (task.baselines && task.baselines.length) {\n      task.baselines.forEach(function(baseline, index){\n        const taskBaseline = generateBaselineNode(task, baseline, index, timeline);\n        if (taskBaseline){\n          baselineNodes.appendChild(taskBaseline);  \n        }\n      });\n    }\n    if (isSplitParent(task)){\n      gantt.eachTask(function(child){\n        if (child.baselines && child.baselines.length) {\n          child.baselines.forEach(function(baseline, index){\n            const childBaseline = generateBaselineNode(child, baseline, index, timeline, true);\n            if (childBaseline){\n              baselineNodes.appendChild(childBaseline);  \n            }\n          });\n        }\n      }, task.id);\n    }\n\n    if (baselineNodes.childNodes.length){\n      return baselineNodes;\n    }\n  }\n  return {\n    render: renderBaseline,\n    isInViewPort: isBaselineInViewPort,\n    getVisibleRange: getVisibleRange\n  };\n}\n\nexport default createBaselineRenderer;\n","import * as domHelpers from \"../utils/dom_helpers\";\nimport isPlaceholderTask from \"../../../utils/placeholder_task\";\n\nfunction _init_dnd(gantt, grid) {\n\tvar DnD = gantt.$services.getService(\"dnd\");\n\n\tif(!grid.$config.bind || !gantt.getDatastore(grid.$config.bind)){\n\t\treturn;\n\t}\n\n\tfunction locate(e){\n\t\treturn domHelpers.locateAttribute(e, grid.$config.item_attribute);\n\t}\n\n\tfunction getStore(){\n\t\treturn gantt.getDatastore(grid.$config.bind);\n\t}\n\n\tfunction checkPlaceholderTask(id){\n\t\treturn isPlaceholderTask(id, gantt, getStore());\n\t}\n\n\tvar dnd = new DnD(grid.$grid_data, {updates_per_second: 60});\n\tif (gantt.defined(grid.$getConfig().dnd_sensitivity))\n\t\tdnd.config.sensitivity = grid.$getConfig().dnd_sensitivity;\n\n\tdnd.attachEvent(\"onBeforeDragStart\", gantt.bind(function (obj, e) {\n\t\tvar el = locate(e);\n\t\tif (!el) return false;\n\t\tif (gantt.hideQuickInfo) gantt.hideQuickInfo();\n\n\t\tif (domHelpers.closest(e.target, \".gantt_grid_editor_placeholder\")){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar id = el.getAttribute(grid.$config.item_attribute);\n\t\tif (checkPlaceholderTask(id)) return false;\n\n\t\tvar datastore = getStore();\n\n\t\tvar task = datastore.getItem(id);\n\n\t\tif (gantt.isReadonly(task))\n\t\t\treturn false;\n\n\t\tdnd.config.initial_open_state = task.$open;\n\t\tif (!gantt.callEvent(\"onRowDragStart\", [id, e.target || e.srcElement, e])) {\n\t\t\treturn false;\n\t\t}\n\n\t}, gantt));\n\n\tdnd.attachEvent(\"onAfterDragStart\", gantt.bind(function (obj, e) {\n\t\tvar el = locate(e);\n\t\tdnd.config.marker.innerHTML = el.outerHTML;\n\t\tvar element = dnd.config.marker.firstChild;\n\t\tif(element){\n\t\t\telement.style.position = \"static\";\n\t\t}\n\n\t\tdnd.config.id = el.getAttribute(grid.$config.item_attribute);\n\n\t\tvar store = getStore();\n\n\t\tvar task = store.getItem(dnd.config.id);\n\t\tdnd.config.index = store.getBranchIndex(dnd.config.id);\n\t\tdnd.config.parent = task.parent;\n\t\ttask.$open = false;\n\t\ttask.$transparent = true;\n\t\tthis.refreshData();\n\t}, gantt));\n\n\tdnd.lastTaskOfLevel = function (level) {\n\t\tvar last_item = null;\n\t\tvar store = getStore();\n\t\tvar tasks = store.getItems();\n\t\tfor (var i = 0, len = tasks.length; i < len; i++) {\n\t\t\tif (tasks[i].$level == level) {\n\t\t\t\tlast_item = tasks[i];\n\t\t\t}\n\t\t}\n\t\treturn last_item ? last_item.id : null;\n\t};\n\tdnd._getGridPos = gantt.bind(function (e) {\n\t\tvar pos = domHelpers.getNodePosition(grid.$grid_data);\n\t\t// row offset\n\t\tvar x = pos.x + grid.$grid.scrollLeft;\n\t\tvar y = e.pos.y - 10;\n\n\t\tvar rowHeight = grid.getItemHeight(dnd.config.id);\n\t\t// prevent moving row out of grid_data container\n\t\tif (y < pos.y) y = pos.y;\n\t\tvar gridHeight = grid.getTotalHeight();\n\t\tif (y > pos.y + gridHeight - rowHeight) y = pos.y + gridHeight - rowHeight;\n\t\tconst maxBottom = pos.y + pos.height;\n\t\tif (y > maxBottom - rowHeight) {\n\t\t\ty = maxBottom - rowHeight;\n\t\t}\n\n\t\tpos.x = x;\n\t\tpos.y = y;\n\t\treturn pos;\n\t}, gantt);\n\tdnd._getTargetY = gantt.bind(function (e) {\n\t\tvar pos = domHelpers.getNodePosition(grid.$grid_data);\n\t\tvar scrollPos = grid.$state.scrollTop || 0;\n\t\tvar maxBottom = gantt.$grid_data.getBoundingClientRect().height + scrollPos;\n\n\t\tvar y = e.pageY - pos.y + scrollPos;\n\t\tif (y > maxBottom) {\n\t\t\ty = maxBottom;\n\t\t} else if (y < scrollPos) {\n\t\t\ty = scrollPos;\n\t\t}\n\t\treturn y;\n\t}, gantt);\n\tdnd._getTaskByY = gantt.bind(function (y, dropIndex) {\n\n\t\tvar store = getStore();\n\n\t\ty = y || 0;\n\n\t\tvar index = grid.getItemIndexByTopPosition(y);\n\t\tindex = dropIndex < index ? index - 1 : index;\n\n\t\tif (index > store.countVisible() - 1)\n\t\t\treturn null;\n\n\t\treturn store.getIdByIndex(index);\n\t}, gantt);\n\tdnd.attachEvent(\"onDragMove\", gantt.bind(function (obj, e) {\n\t\tvar gridDataSizes = gantt.$grid_data.getBoundingClientRect();\n\t\tvar maxBottom = gridDataSizes.height + gridDataSizes.y + (grid.$state.scrollTop || 0) + window.scrollY;\n\t\tvar dd = dnd.config;\n\t\tvar pos = dnd._getGridPos(e);\n\n\t\tgantt._waiAria.reorderMarkerAttr(dd.marker);\n\n\t\tvar config = grid.$getConfig(),\n\t\t\tstore = getStore();\n\n\t\t// setting position of row\n\t\tif (pos.y < maxBottom) {\n\t\t\tdd.marker.style.top = pos.y + \"px\";\n\t\t} else {\n\t\t\tdd.marker.style.top = maxBottom + \"px\";\n\t\t}\n\t\tdd.marker.style.left = pos.x + 10 + \"px\";\n\t\tconst containerSize = domHelpers.getNodePosition(gantt.$root);\n\t\tif (pos.width > containerSize.width){\n\t\t\tdd.marker.style.width = containerSize.width - 10 - 2 + \"px\";\n\t\t\tdd.marker.style.overflow = \"hidden\";\t\n\t\t}\n\n\t\t// highlight row when mouseover\n\t\tvar item = store.getItem(dnd.config.id);\n\t\tvar targetY = dnd._getTargetY(e);\n\t\tvar el = dnd._getTaskByY(targetY, store.getIndexById(item.id));\n\n\t\tif (!store.exists(el)) {\n\t\t\tel = dnd.lastTaskOfLevel(config.order_branch_free ? item.$level : 0);\n\t\t\tif (el == dnd.config.id) {\n\t\t\t\tel = null;\n\t\t\t}\n\t\t}\n\n\t\tfunction allowedLevel(next, item) {\n\t\t\treturn (!(store.isChildOf(over.id, item.id)) && (next.$level == item.$level || config.order_branch_free));\n\t\t}\n\n\t\tif (store.exists(el)) {\n\t\t\tvar over = store.getItem(el);\n\n\t\t\tvar itemTop = grid.getItemTop(over.id);\n\t\t\tvar itemHeight = grid.getItemHeight(over.id);\n\t\t\tif (itemTop + itemHeight / 2 < targetY) {\n\t\t\t\t//hovering over bottom part of item, check can be drop to bottom\n\t\t\t\tvar index = store.getIndexById(over.id);\n\t\t\t\tvar nextId = store.getNext(over.id);//adds +1 when hovering over placeholder\n\t\t\t\tvar next = store.getItem(nextId);\n\t\t\t\tif (checkPlaceholderTask(nextId)){\n\t\t\t\t\tvar prevId = store.getPrev(next.id);\n\t\t\t\t\tnext = store.getItem(prevId);\n\t\t\t\t}\n\t\t\t\tif (next) {\n\t\t\t\t\tif (next.id != item.id) {\n\t\t\t\t\t\tover = next; //there is a valid target\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tif (config.order_branch_free) {\n\t\t\t\t\t\t\tif (!(store.isChildOf(item.id, over.id) && store.getChildren(over.id).length == 1))\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\tstore.move(item.id, store.getBranchIndex(over.id) + 1, store.getParent(over.id));\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t//we at end of the list, check and drop at the end of list\n\t\t\t\t\tnextId = store.getIdByIndex(index);\n\t\t\t\t\tnext = store.getItem(nextId);\n\n\t\t\t\t\tif (checkPlaceholderTask(nextId)){\n\t\t\t\t\t\tvar prevId = store.getPrev(next.id);\n\t\t\t\t\t\tnext = store.getItem(prevId);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (allowedLevel(next, item) && next.id != item.id) {\n\t\t\t\t\t\tstore.move(item.id, -1, store.getParent(next.id));\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (config.order_branch_free) {\n\t\t\t\tif (over.id != item.id && allowedLevel(over, item) && !checkPlaceholderTask(over.id)) {\n\t\t\t\t\tif (!store.hasChild(over.id)) {\n\t\t\t\t\t\tover.$open = true;\n\t\t\t\t\t\tstore.move(item.id, -1, over.id);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (store.getIndexById(over.id) || itemHeight / 3 < targetY) return;\n\t\t\t\t}\n\t\t\t}\n\t\t\t//if item is on different level, check the one before it\n\t\t\tvar index = store.getIndexById(over.id),\n\t\t\t\tprevId = store.getIdByIndex(index - 1);\n\n\t\t\tvar prev = store.getItem(prevId);\n\n\t\t\tvar shift = 1;\n\t\t\twhile ((!prev || prev.id == over.id) && index - shift >= 0) {\n\n\t\t\t\tprevId = store.getIdByIndex(index - shift);\n\t\t\t\tprev = store.getItem(prevId);\n\t\t\t\tshift++;\n\t\t\t}\n\n\t\t\tif (item.id == over.id || checkPlaceholderTask(over.id)) return;\n\t\t\t//replacing item under cursor\n\t\t\tif (allowedLevel(over, item) && item.id != over.id) {\n\t\t\t\tstore.move(item.id, 0, 0, over.id);\n\n\t\t\t} else if (over.$level == item.$level - 1 && !store.getChildren(over.id).length) {\n\t\t\t\tstore.move(item.id, 0, over.id);\n\n\t\t\t} else if (prev && (allowedLevel(prev, item)) && (item.id != prev.id)) {\n\t\t\t\tstore.move(item.id, -1, store.getParent(prev.id));\n\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}, gantt));\n\n\tdnd.attachEvent(\"onDragEnd\", gantt.bind(function () {\n\t\tvar store = getStore();\n\t\tvar task = store.getItem(dnd.config.id);\n\t\ttask.$transparent = false;\n\t\ttask.$open = dnd.config.initial_open_state;\n\n\t\tif (this.callEvent(\"onBeforeRowDragEnd\", [dnd.config.id, dnd.config.parent, dnd.config.index]) === false) {\n\t\t\tstore.move(dnd.config.id, dnd.config.index, dnd.config.parent);\n\t\t\ttask.$drop_target = null;\n\t\t} else {\n\t\t\tthis.callEvent(\"onRowDragEnd\", [dnd.config.id, task.$drop_target]);\n\t\t}\n\t\tgantt.render();\n\t\tthis.refreshData();\n\t}, gantt));\n}\n\nexport default {\n\tinit: _init_dnd\n};","/**\n * The state object for order branch drag and drop\n */\n\nimport * as utils from \"../../../../utils/utils\";\n\nexport default {\n\tcreateDropTargetObject: function createDropTargetObject(parent) {\n\t\tvar res = {\n\t\t\ttargetParent: null,\n\t\t\ttargetIndex: 0,\n\t\t\ttargetId: null,\n\t\t\tchild: false,\n\t\t\tnextSibling: false,\n\t\t\tprevSibling: false\n\t\t};\n\n\t\tif (parent) {\n\t\t\tutils.mixin(res, parent, true);\n\t\t}\n\t\treturn res;\n\t},\n\tnextSiblingTarget: function nextSiblingTarget(dndTaskId, targetTaskId, store) {\n\t\tvar result = this.createDropTargetObject();\n\t\tresult.targetId = targetTaskId;\n\t\tresult.nextSibling = true;\n\t\tresult.targetParent = store.getParent(result.targetId);\n\t\tresult.targetIndex = store.getBranchIndex(result.targetId);\n\t\tif(store.getParent(dndTaskId) != result.targetParent || result.targetIndex < store.getBranchIndex(dndTaskId)){\n\t\t\tresult.targetIndex += 1;\n\t\t}\n\t\treturn result;\n\t},\n\tprevSiblingTarget: function prevSiblingTarget(dndTaskId, targetTaskId, store) {\n\t\tvar result = this.createDropTargetObject();\n\t\tresult.targetId = targetTaskId;\n\t\tresult.prevSibling = true;\n\t\tresult.targetParent = store.getParent(result.targetId);\n\t\tresult.targetIndex = store.getBranchIndex(result.targetId);\n\t\tif(store.getParent(dndTaskId) == result.targetParent && result.targetIndex > store.getBranchIndex(dndTaskId)){\n\t\t\tresult.targetIndex -= 1;\n\t\t}\n\t\treturn result;\n\t},\n\tfirstChildTarget: function firstChildTarget(dndTaskId, targetTaskId, store) {\n\t\tvar result = this.createDropTargetObject();\n\t\tresult.targetId = targetTaskId;\n\t\tresult.targetParent = result.targetId;\n\t\tresult.targetIndex = 0;\n\t\tresult.child = true;\n\t\treturn result;\n\t},\n\tlastChildTarget: function lastChildTarget(dndTaskId, targetTaskId, store) {\n\t\tvar children = store.getChildren(targetTaskId);\n\t\tvar result = this.createDropTargetObject();\n\t\tresult.targetId = children[children.length - 1];\n\t\tresult.targetParent = targetTaskId;\n\t\tresult.targetIndex = children.length;\n\t\tresult.nextSibling = true;\n\t\treturn result;\n\t}\n};","/**\n * resolve dnd position of the task when gantt.config.order_branch_free = false\n */\n\nimport dropTarget from \"./drop_target\";\n\nfunction getLast(store){\n\tvar current = store.getNext();\n\twhile(store.exists(current)){\n\n\t\tvar next = store.getNext(current);\n\t\tif(!store.exists(next)){\n\t\t\treturn current;\n\t\t}else{\n\t\t\tcurrent = next;\n\t\t}\n\t}\n\treturn null;\n}\n\nfunction findClosesTarget(dndTaskId, taskId, allowedLevel, store, up){\n\tvar prev = taskId;\n\twhile(store.exists(prev)){\n\t\tvar targetLevel = store.calculateItemLevel(store.getItem(prev));\n\t\tif((targetLevel === allowedLevel || targetLevel === (allowedLevel - 1)) && store.getBranchIndex(prev) > -1){\n\t\t\tbreak;\n\t\t}else {\n\t\t\tprev = up ? store.getPrev(prev) : store.getNext(prev);\n\t\t}\n\t}\n\n\tif(store.exists(prev)){\n\t\tif(store.calculateItemLevel(store.getItem(prev)) === allowedLevel){\n\t\t\treturn up ? dropTarget.nextSiblingTarget(dndTaskId, prev, store) : dropTarget.prevSiblingTarget(dndTaskId, prev, store);\n\t\t}else{\n\t\t\treturn dropTarget.firstChildTarget(dndTaskId, prev, store);\n\t\t}\n\t}\n\treturn null;\n}\n\nfunction findTargetAbove(dndTaskId, taskId, allowedLevel, store){\n\treturn findClosesTarget(dndTaskId, taskId, allowedLevel, store, true);\n}\nfunction findTargetBelow(dndTaskId, taskId, allowedLevel, store){\n\treturn findClosesTarget(dndTaskId, taskId, allowedLevel, store, false);\n}\n\nexport default function getSameLevelDropPosition(dndTaskId, targetTaskId, relTargetPos, eventTop, store, level){\n\tvar result;\n\tif(targetTaskId !== store.$getRootId()){\n\t\tvar targetTask = store.getItem(targetTaskId);\n\t\tvar targetLevel = store.calculateItemLevel(targetTask);\n\t\tif(targetLevel === level){\n\t\t\tvar prevSibling = store.getPrevSibling(targetTaskId);\n\t\t\tif(relTargetPos < 0.5 && !prevSibling){\n\t\t\t\tresult = dropTarget.prevSiblingTarget(dndTaskId, targetTaskId, store);\n\t\t\t}else{\n\t\t\t\tif(relTargetPos < 0.5){\n\t\t\t\t\ttargetTaskId = prevSibling;\n\t\t\t\t}\n\t\t\t\tresult = dropTarget.nextSiblingTarget(dndTaskId, targetTaskId, store);\n\t\t\t}\n\t\t}else if(targetLevel > level){\n\t\t\tstore.eachParent(function(parent){\n\t\t\t\tif(store.calculateItemLevel(parent) === level){\n\t\t\t\t\ttargetTaskId = parent.id;\n\t\t\t\t}\n\t\t\t}, targetTask); \n\t\t\tresult = findTargetAbove(dndTaskId, targetTaskId, level, store);\n\t\t}else{\n\t\t\tvar targetAbove = findTargetAbove(dndTaskId, targetTaskId, level, store);\n\t\t\tvar targetBelow = findTargetBelow(dndTaskId, targetTaskId, level, store);\n\t\t\tresult = (relTargetPos < 0.5) ? targetAbove : targetBelow;\n\t\t}\n\t}else{\n\t\tvar rootId = store.$getRootId();\n\t\tvar rootLevel = store.getChildren(rootId);\n\t\tresult = dropTarget.createDropTargetObject();\n\t\tif(rootLevel.length && eventTop >= 0){\n\t\t\tresult = findTargetAbove(dndTaskId, getLast(store), level, store);\n\t\t}else{\n\t\t\tresult = findTargetBelow(dndTaskId, rootId, level, store);\n\t\t}\n\t}\n\n\treturn result;\n};\n","import * as domHelpers from \"../../utils/dom_helpers\";\n\n/**\n * methods for highlighting current drag and drop position\n */\n\nfunction highlightPosition(target, root, grid){\n\tvar markerPos = getTaskMarkerPosition(target, grid);\n\t// setting position of row\n\troot.marker.style.left = markerPos.x + 9 + \"px\";\n\troot.marker.style.width = markerPos.width + \"px\";\n\troot.marker.style.overflow = \"hidden\";\n\tvar markerLine = root.markerLine;\n\tif(!markerLine){\n\t\tmarkerLine = document.createElement(\"div\");\n\t\tmarkerLine.className = \"gantt_drag_marker gantt_grid_dnd_marker\";\n\t\tmarkerLine.innerHTML = \"<div class='gantt_grid_dnd_marker_line'></div>\";\n\t\tmarkerLine.style.pointerEvents = \"none\";\n\t}\n\n\tif(target.child){\n\t\thighlightFolder(target, markerLine, grid);\n\t}else{\n\t\thighlightRow(target, markerLine, grid);\n\t}\n\n\tif(!root.markerLine){\n\t\tdocument.body.appendChild(markerLine);\n\t\troot.markerLine = markerLine;\n\t}\n}\n\nfunction removeLineHighlight(root){\n\tif(root.markerLine && root.markerLine.parentNode){\n\t\troot.markerLine.parentNode.removeChild(root.markerLine);\n\t}\n\troot.markerLine = null;\n}\n\nfunction highlightRow(target, markerLine, grid){\n\tvar linePos = getLineMarkerPosition(target, grid);\n\tvar maxBottom = grid.$grid_data.getBoundingClientRect().bottom + window.scrollY;\n\n\tmarkerLine.innerHTML = \"<div class='gantt_grid_dnd_marker_line'></div>\";\n\tmarkerLine.style.left = linePos.x + \"px\";\n\tmarkerLine.style.height = \"4px\";\n\n\tvar markerLineTop = linePos.y - 2;\n\tmarkerLine.style.top = markerLineTop + \"px\";\n\tmarkerLine.style.width = linePos.width + \"px\";\n\n\tif (markerLineTop > maxBottom) {\n\t\tmarkerLine.style.top = maxBottom + 'px';\n\t}\n\n\treturn markerLine;\n}\nfunction highlightFolder(target, markerFolder, grid){\n\tvar id = target.targetParent;\n\tvar pos = gridToPageCoordinates({x: 0, y: grid.getItemTop(id)}, grid);\n\tvar maxBottom = grid.$grid_data.getBoundingClientRect().bottom + window.scrollY;\n\n\tlet folderHighlightWidth = setWidthWithinContainer(grid.$gantt, grid.$grid_data.offsetWidth);\t\n\n\tmarkerFolder.innerHTML = \"<div class='gantt_grid_dnd_marker_folder'></div>\";\n\tmarkerFolder.style.width = folderHighlightWidth + \"px\";\n\tmarkerFolder.style.top = pos.y + \"px\";\n\tmarkerFolder.style.left = pos.x  + \"px\";\n\tmarkerFolder.style.height = grid.getItemHeight(id) + \"px\";\n\tif (pos.y > maxBottom) {\n\t\tmarkerFolder.style.top = maxBottom + 'px';\n\t}\n\n\treturn markerFolder;\n}\n\nfunction getLineMarkerPosition(target, grid){\n\tvar store = grid.$config.rowStore;\n\tvar pos = {x:0, y:0};\n\tvar indentNode = grid.$grid_data.querySelector(\".gantt_tree_indent\");\n\tvar indent = 15;\n\tvar level = 0;\n\tif(indentNode){\n\t\tindent = indentNode.offsetWidth;\n\t}\n\tvar iconWidth = 40;\n\tif(target.targetId !== store.$getRootId()){\n\t\tvar itemTop = grid.getItemTop(target.targetId);\n\t\tvar itemHeight = grid.getItemHeight(target.targetId);\n\t\tlevel = store.exists(target.targetId) ? store.calculateItemLevel(store.getItem(target.targetId)) : 0;\n\n\t\tif(target.prevSibling){\n\t\t\tpos.y = itemTop;\n\t\t}else if(target.nextSibling){\n\t\t\tvar childCount = 0;\n\t\t\tstore.eachItem(function(child){\n\t\t\t\tif(store.getIndexById(child.id) !== -1)\n\t\t\t\t\tchildCount++;\n\t\t\t}, target.targetId);\n\n\t\t\tpos.y = itemTop + itemHeight + childCount*itemHeight;\n\t\t}else {\n\t\t\tpos.y = itemTop + itemHeight;\n\t\t\tlevel += 1;\n\t\t}\n\t}\n\tpos.x = iconWidth + level * indent;\n\tpos.width = setWidthWithinContainer(grid.$gantt, Math.max(grid.$grid_data.offsetWidth - pos.x, 0), pos.x);\n\treturn gridToPageCoordinates(pos, grid);\n}\n\nfunction gridToPageCoordinates(pos, grid){\n\tvar gridPos = domHelpers.getNodePosition(grid.$grid_data);\n\tpos.x += gridPos.x + grid.$grid.scrollLeft;\n\tpos.y += gridPos.y - grid.$grid_data.scrollTop;\n\treturn pos;\n}\n\nfunction getTaskMarkerPosition(e, grid) {\n\tvar pos = domHelpers.getNodePosition(grid.$grid_data);\n\tvar ePos = domHelpers.getRelativeEventPosition(e, grid.$grid_data);\n\t// row offset\n\tvar x = pos.x + grid.$grid.scrollLeft;\n\tvar y = ePos.y - 10;\n\n\tvar rowHeight = grid.getItemHeight(e.targetId);\n\t// prevent moving row out of grid_data container\n\tif (y < pos.y) y = pos.y;\n\tvar gridHeight = grid.getTotalHeight();\n\tif (y > pos.y + gridHeight - rowHeight) y = pos.y + gridHeight - rowHeight;\n\n\tpos.x = x;\n\tpos.y = y;\n\tpos.width = setWidthWithinContainer(grid.$gantt, pos.width, 9);\n\treturn pos;\n}\n\nfunction setWidthWithinContainer(gantt, width, offset = 0){\n\tconst containerSize = domHelpers.getNodePosition(gantt.$root);\n\tif (width > containerSize.width){\n\t\twidth = containerSize.width - offset - 2;\n\t}\n\treturn width;\n}\n\nexport default {\n\tremoveLineHighlight: removeLineHighlight,\n\thighlightPosition: highlightPosition\n};\n","import * as domHelpers from \"../utils/dom_helpers\";\nimport dropTarget from \"./tasks_grid_dnd_marker_helpers/drop_target\";\nimport getLockedLevelTarget from \"./tasks_grid_dnd_marker_helpers/locked_level\";\nimport getMultiLevelTarget from \"./tasks_grid_dnd_marker_helpers/multi_level\";\nimport higlighter from \"./tasks_grid_dnd_marker_helpers/highlight\";\nimport isPlaceholderTask from \"../../../utils/placeholder_task\";\n\nfunction _init_dnd(gantt, grid) {\n\tvar DnD = gantt.$services.getService(\"dnd\");\n\n\tif(!grid.$config.bind || !gantt.getDatastore(grid.$config.bind)){\n\t\treturn;\n\t}\n\n\tfunction locate(e){\n\t\treturn domHelpers.locateAttribute(e, grid.$config.item_attribute);\n\t}\n\n\tfunction getStore(){\n\t\treturn gantt.getDatastore(grid.$config.bind);\n\t}\n\n\tfunction checkPlaceholderTask(id){\n\t\treturn isPlaceholderTask(id, gantt, getStore());\n\t}\n\n\tvar dnd = new DnD(grid.$grid_data, {updates_per_second: 60});\n\tif (gantt.defined(grid.$getConfig().dnd_sensitivity))\n\t\tdnd.config.sensitivity = grid.$getConfig().dnd_sensitivity;\n\n\tdnd.attachEvent(\"onBeforeDragStart\", gantt.bind(function (obj, e) {\n\t\tvar el = locate(e);\n\t\tif (!el) return false;\n\t\tif (gantt.hideQuickInfo) gantt.hideQuickInfo();\n\t\tif (domHelpers.closest(e.target, \".gantt_grid_editor_placeholder\")){\n\t\t\treturn false;\n\t\t}\n\n\t\tvar id = el.getAttribute(grid.$config.item_attribute);\n\t\tvar datastore = grid.$config.rowStore;\n\t\tvar task = datastore.getItem(id);\n\n\t\tif (gantt.isReadonly(task) || checkPlaceholderTask(id))\n\t\t\treturn false;\n\n\t\tdnd.config.initial_open_state = task.$open;\n\t\tif (!gantt.callEvent(\"onRowDragStart\", [id, e.target || e.srcElement, e])) {\n\t\t\treturn false;\n\t\t}\n\n\t}, gantt));\n\n\tdnd.attachEvent(\"onAfterDragStart\", gantt.bind(function (obj, e) {\n\t\tvar el = locate(e);\n\n\t\tdnd.config.marker.innerHTML = el.outerHTML;\n\t\tvar element = dnd.config.marker.firstChild;\n\t\tif(element){\n\t\t\tdnd.config.marker.style.opacity = 0.4;\n\t\t\telement.style.position = \"static\";\n\t\t\telement.style.pointerEvents = \"none\";\n\t\t}\n\n\t\tdnd.config.id = el.getAttribute(grid.$config.item_attribute);\n\n\t\tvar store = grid.$config.rowStore;\n\n\t\tvar task = store.getItem(dnd.config.id);\n\t\tdnd.config.level = store.calculateItemLevel(task);\n\t\tdnd.config.drop_target = dropTarget.createDropTargetObject({\n\t\t\ttargetParent: store.getParent(task.id),\n\t\t\ttargetIndex: store.getBranchIndex(task.id),\n\t\t\ttargetId: task.id,\n\t\t\tnextSibling: true\n\t\t});\n\n\t\ttask.$open = false;\n\t\ttask.$transparent = true;\n\t\tthis.refreshData();\n\t}, gantt));\n\n\tfunction getTargetTaskId(e){\n\t\tvar y = domHelpers.getRelativeEventPosition(e, grid.$grid_data).y;\n\t\tvar store = grid.$config.rowStore;\n\n\t\tif (!document.doctype){\n\t\t\ty += window.scrollY;\n\t\t}\n\t\ty = y || 0;\n\n\t\t// limits for the marker according to the layout layer\n\t\tvar scrollPos = grid.$state.scrollTop || 0;\n\t\tvar maxBottom = gantt.$grid_data.getBoundingClientRect().height + scrollPos + window.scrollY;\n\t\tvar minTop = scrollPos;\n\n\t\tvar firstVisibleTaskIndex = grid.getItemIndexByTopPosition(grid.$state.scrollTop);\n\t\tif (!store.exists(firstVisibleTaskIndex)){\n\t\t\tfirstVisibleTaskIndex = store.countVisible() - 1;\n\t\t}\n\t\tif (firstVisibleTaskIndex < 0) {\n\t\t\treturn store.$getRootId();\n\t\t}\n\n\t\tvar firstVisibleTaskId = store.getIdByIndex(firstVisibleTaskIndex);\n\n\t\tvar firstVisibleTaskPos = grid.$state.scrollTop / grid.getItemHeight(firstVisibleTaskId);\n\t\tvar hiddenTaskPart = firstVisibleTaskPos - Math.floor(firstVisibleTaskPos);\n\t\tif (hiddenTaskPart > 0.1 && hiddenTaskPart < 0.9) {\n\t\t\tmaxBottom = maxBottom - grid.getItemHeight(firstVisibleTaskId) * hiddenTaskPart;\n\t\t\tminTop = minTop + grid.getItemHeight(firstVisibleTaskId) * (1 - hiddenTaskPart);\n\t\t}\n\n\t\t// GS-715. The placeholder task row shouldn't be draggable below the Gantt container\n\t\tconst gridPosition = domHelpers.getNodePosition(grid.$grid_data);\n\t\tconst gridBottom = gridPosition.y + gridPosition.height;\n\t\tconst placeholderRowHeight = dnd.config.marker.offsetHeight;\n\t\tif (y + placeholderRowHeight + window.scrollY >= maxBottom){\n\t\t\tdnd.config.marker.style.top = gridBottom - placeholderRowHeight\t+ \"px\";\n\t\t}\n\n\t\tif (y >= maxBottom) {\n\t\t\ty = maxBottom;\n\t\t} else if (y <= minTop) {\n\t\t\ty = minTop;\n\t\t\tdnd.config.marker.style.top = gridPosition.y + \"px\";\n\t\t}\n\n\t\tvar index = grid.getItemIndexByTopPosition(y);\n\n\t\tif (index > store.countVisible() - 1 || index < 0) {\n\t\t\treturn store.$getRootId();\n\t\t}\n\n\t\tvar targetId = store.getIdByIndex(index);\n\t\tif (checkPlaceholderTask(targetId)) {\n\t\t\treturn store.getPrevSibling(targetId);\n\t\t}\n\n\t\treturn store.getIdByIndex(index);\n\t}\n\n\tfunction getDropPosition(e){\n\t\tvar targetTaskId = getTargetTaskId(e);\n\t\tvar relTargetPos = null;\n\t\tvar store = grid.$config.rowStore;\n\t\tvar config = grid.$getConfig();\n\t\tvar lockLevel = !config.order_branch_free;\n\n\t\tvar eventTop = domHelpers.getRelativeEventPosition(e, grid.$grid_data).y;\n\t\tif (!document.doctype){\n\t\t\teventTop += window.scrollY;\n\t\t}\n\n\t\tif(targetTaskId !== store.$getRootId()) {\n\t\t\tvar rowTop = grid.getItemTop(targetTaskId);\n\t\t\tvar rowHeight = grid.getItemHeight(targetTaskId);\n\t\t\trelTargetPos = (eventTop - rowTop) / rowHeight;\n\t\t}\n\n\t\tvar result;\n\t\tif(!lockLevel){\n\t\t\tresult = getMultiLevelTarget(dnd.config.id, targetTaskId, relTargetPos, eventTop, store);\n\t\t}else{\n\t\t\tresult = getLockedLevelTarget(dnd.config.id, targetTaskId, relTargetPos, eventTop, store, dnd.config.level);\n\t\t\tif(result && result.targetParent && checkPlaceholderTask(result.targetParent)){\n\t\t\t\ttargetTaskId = store.getPrevSibling(result.targetParent);\n\t\t\t\tresult = getLockedLevelTarget(dnd.config.id, targetTaskId, relTargetPos, eventTop, store, dnd.config.level);\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tdnd.attachEvent(\"onDragMove\", gantt.bind(function (obj, e) {\n\t\tvar target = getDropPosition(e);\n\n\t\tif(!target ||\n\t\t\tgantt.callEvent(\"onBeforeRowDragMove\", [dnd.config.id, target.targetParent, target.targetIndex]) === false){\n\t\t\t\ttarget = dropTarget.createDropTargetObject(dnd.config.drop_target);\n\t\t\t}\n\n\t\thiglighter.highlightPosition(target, dnd.config, grid);\n\t\tdnd.config.drop_target = target;\n\t\tgantt._waiAria.reorderMarkerAttr(dnd.config.marker);\n\n\t\tthis.callEvent(\"onRowDragMove\", [dnd.config.id, target.targetParent, target.targetIndex]);\n\t\treturn true;\n\t}, gantt));\n\n\tdnd.attachEvent(\"onDragEnd\", gantt.bind(function () {\n\t\tvar store = grid.$config.rowStore;\n\t\tvar task = store.getItem(dnd.config.id);\n\n\t\thiglighter.removeLineHighlight(dnd.config);\n\n\t\ttask.$transparent = false;\n\t\ttask.$open = dnd.config.initial_open_state;\n\t\tvar target = dnd.config.drop_target;\n\n\t\tif (this.callEvent(\"onBeforeRowDragEnd\", [dnd.config.id, target.targetParent, target.targetIndex]) === false) {\n\t\t\ttask.$drop_target = null;\n\t\t} else {\n\t\t\tstore.move(dnd.config.id, target.targetIndex, target.targetParent);\n\t\t\tgantt.render();\n\t\t\tthis.callEvent(\"onRowDragEnd\", [dnd.config.id, target.targetParent, target.targetIndex]);\n\t\t}\n\t\tstore.refresh(task.id);\n\t}, gantt));\n}\n\nexport default {\n\tinit: _init_dnd\n};","/**\n * resolve dnd position of the task when gantt.config.order_branch_free = true\n */\n\nimport dropTarget from \"./drop_target\";\n\nexport default function getMultiLevelDropPosition(dndTaskId, targetTaskId, relTargetPos, eventTop, store){\n\tvar result;\n\n\tif(targetTaskId !== store.$getRootId()){\n\t\tif(relTargetPos < 0.25){\n\t\t\tresult = dropTarget.prevSiblingTarget(dndTaskId, targetTaskId, store);\n\t\t}else if(relTargetPos > 0.60 && !(store.hasChild(targetTaskId) && store.getItem(targetTaskId).$open)){\n\t\t\tresult = dropTarget.nextSiblingTarget(dndTaskId, targetTaskId, store);\n\t\t}else {\n\t\t\tresult = dropTarget.firstChildTarget(dndTaskId, targetTaskId, store);\n\t\t}\n\t}else{\n\t\tvar rootId = store.$getRootId();\n\t\tif(store.hasChild(rootId) && eventTop >= 0){\n\t\t\tresult = dropTarget.lastChildTarget(dndTaskId, rootId, store);\n\t\t}else{\n\t\t\tresult = dropTarget.firstChildTarget(dndTaskId, rootId, store);\n\t\t}\n\t}\n\n\treturn result;\n};","import * as utils from \"../../../utils/utils\";\nimport rowDnd from \"./tasks_grid_dnd\";\nimport rowDndMarker from \"./tasks_grid_dnd_marker\";\nimport mouseEventContainer from \"../mouse_event_container\";\n\nvar initializer = (function(){\n\treturn function(gantt){\n\t\treturn {\n\t\t\tonCreated: function (grid) {\n\t\t\t\tgrid.$config = utils.mixin(grid.$config, {\n\t\t\t\t\tbind: \"task\"\n\t\t\t\t});\n\t\t\t\tif(grid.$config.id == \"grid\") {\n\t\t\t\t\tthis.extendGantt(grid);\n\t\t\t\t\tgantt.ext.inlineEditors = gantt.ext._inlineEditors.createEditors(grid);\n\t\t\t\t\tgantt.ext.inlineEditors.init();\n\t\t\t\t}\n\n\t\t\t\tthis._mouseDelegates = mouseEventContainer(gantt);\n\t\t\t},\n\t\t\tonInitialized: function (grid) {\n\t\t\t\tvar config = grid.$getConfig();\n\t\t\t\tif (config.order_branch) {\n\t\t\t\t\tif(config.order_branch == \"marker\"){\n\t\t\t\t\t\trowDndMarker.init(grid.$gantt, grid);\n\t\t\t\t\t}else{\n\t\t\t\t\t\trowDnd.init(grid.$gantt, grid);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis.initEvents(grid, gantt);\n\t\t\t\tif(grid.$config.id == \"grid\") {\n\t\t\t\t\tthis.extendDom(grid);\n\t\t\t\t}\n\t\t\t},\n\t\t\tonDestroyed: function (grid) {\n\t\t\t\tif(grid.$config.id == \"grid\") {\n\t\t\t\t\t// GS-1288. We need to only detach the store and its events without detaching the\n\t\t\t\t\t// inline editor's events. Otherwise, we won't be able to access them\n\t\t\t\t\tgantt.ext.inlineEditors.detachStore();\n\t\t\t\t}\n\t\t\t\tthis.clearEvents(grid, gantt);\n\t\t\t},\n\n\t\t\tinitEvents: function (grid, gantt) {\n\t\t\t\tthis._mouseDelegates.delegate(\"click\", \"gantt_row\", gantt.bind(function (e, id, trg) {\n\t\t\t\t\tconst config = grid.$getConfig();\n\t\t\t\t\tif (id !== null) {\n\t\t\t\t\t\tconst task = this.getTask(id);\n\t\t\t\t\t\tif (config.scroll_on_click) {\n\t\t\t\t\t\t\tconst notOpenIcon = !gantt._is_icon_open_click(e);\n\t\t\t\t\t\t\tconst visibleTimeline = gantt.$ui.getView(\"timeline\");\n\t\t\t\t\t\t\t// don't need to scroll to the date when the timeline is not visible\n\t\t\t\t\t\t\t// or when we click on the open/close icon\n\t\t\t\t\t\t\tif (notOpenIcon && visibleTimeline){\n\t\t\t\t\t\t\t\tthis.showDate(task.start_date);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tgantt.callEvent(\"onTaskRowClick\", [id, trg]);\n\t\t\t\t\t}\n\t\t\t\t}, gantt), grid.$grid);\n\n\t\t\t\tthis._mouseDelegates.delegate(\"click\", \"gantt_grid_head_cell\", gantt.bind(function (e, id, trg) {\n\t\t\t\t\tvar column = trg.getAttribute(\"data-column-id\");\n\n\t\t\t\t\tif (!gantt.callEvent(\"onGridHeaderClick\", [column, e]))\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\tvar config = grid.$getConfig();\n\n\t\t\t\t\tif (column == \"add\") {\n\t\t\t\t\t\tvar mouseEvents = gantt.$services.getService(\"mouseEvents\");\n\t\t\t\t\t\tmouseEvents.callHandler(\"click\", \"gantt_add\", grid.$grid, [e, config.root_id]);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (config.sort && column) { // GS-929: if there is no column name, we cannot sort the column\n\t\t\t\t\t\tvar sorting_method = column,\n\t\t\t\t\t\t\tconf;\n\n\t\t\t\t\t\tfor (var i = 0; i < config.columns.length; i++) {\n\t\t\t\t\t\t\tif (config.columns[i].name == column) {\n\t\t\t\t\t\t\t\tconf = config.columns[i];\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (conf && conf.sort !== undefined && conf.sort !== true) {\n\t\t\t\t\t\t\tsorting_method = conf.sort;\n\n\t\t\t\t\t\t\tif (!sorting_method) { // column sort property 'false', no sorting\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvar sort = (this._sort && this._sort.direction && this._sort.name == column) ? this._sort.direction : \"desc\";\n\t\t\t\t\t\t// invert sort direction\n\t\t\t\t\t\tsort = (sort == \"desc\") ? \"asc\" : \"desc\";\n\t\t\t\t\t\tthis._sort = {\n\t\t\t\t\t\t\tname: column,\n\t\t\t\t\t\t\tdirection: sort\n\t\t\t\t\t\t};\n\t\t\t\t\t\tthis.sort(sorting_method, sort == \"desc\");\n\t\t\t\t\t}\n\t\t\t\t}, gantt), grid.$grid);\n\n\t\t\t\tthis._mouseDelegates.delegate(\"click\", \"gantt_add\", gantt.bind(function (e, id, trg) {\n\t\t\t\t\tvar config = grid.$getConfig();\n\t\t\t\t\tif (config.readonly) return;\n\n\t\t\t\t\tvar item = {};\n\t\t\t\t\tthis.createTask(item, id ? id : gantt.config.root_id);\n\n\t\t\t\t\treturn false;\n\t\t\t\t}, gantt), grid.$grid);\n\n\t\t\t},\n\n\t\t\tclearEvents: function(grid, gantt){\n\t\t\t\tthis._mouseDelegates.destructor();\n\t\t\t\tthis._mouseDelegates = null;\n\t\t\t},\n\n\t\t\textendDom: function(grid){\n\t\t\t\tgantt.$grid = grid.$grid;\n\t\t\t\tgantt.$grid_scale = grid.$grid_scale;\n\t\t\t\tgantt.$grid_data = grid.$grid_data;\n\t\t\t},\n\t\t\textendGantt: function(grid){\n\t\t\t\tgantt.getGridColumns = gantt.bind(grid.getGridColumns, grid);\n\n\t\t\t\tgrid.attachEvent(\"onColumnResizeStart\", function(){\n\t\t\t\t\treturn gantt.callEvent(\"onColumnResizeStart\", arguments);\n\t\t\t\t});\n\t\t\t\tgrid.attachEvent(\"onColumnResize\", function(){\n\t\t\t\t\treturn gantt.callEvent(\"onColumnResize\", arguments);\n\t\t\t\t});\n\t\t\t\tgrid.attachEvent(\"onColumnResizeEnd\", function(){\n\t\t\t\t\treturn gantt.callEvent(\"onColumnResizeEnd\", arguments);\n\t\t\t\t});\n\n\t\t\t\tgrid.attachEvent(\"onColumnResizeComplete\", function(columns, totalWidth){\n\t\t\t\t\tgantt.config.grid_width = totalWidth;\n\t\t\t\t});\n\n\t\t\t\tgrid.attachEvent(\"onBeforeRowResize\", function(){\n\t\t\t\t\treturn gantt.callEvent(\"onBeforeRowResize\", arguments);\n\t\t\t\t});\n\t\t\t\tgrid.attachEvent(\"onRowResize\", function(){\n\t\t\t\t\treturn gantt.callEvent(\"onRowResize\", arguments);\n\t\t\t\t});\n\t\t\t\tgrid.attachEvent(\"onBeforeRowResizeEnd\", function(){\n\t\t\t\t\treturn gantt.callEvent(\"onBeforeRowResizeEnd\", arguments);\n\t\t\t\t});\n\t\t\t\tgrid.attachEvent(\"onAfterRowResize\", function(){\n\t\t\t\t\treturn gantt.callEvent(\"onAfterRowResize\", arguments);\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t};\n})();\n\nexport default initializer;","import * as domHelpers from \"../utils/dom_helpers\";\nimport * as utils from \"../../../utils/utils\";\nimport timeout from \"../../../utils/timeout\";\nimport * as helpers from \"../../../utils/helpers\";\n\nfunction createTaskDND(timeline, gantt) {\n\tvar services = gantt.$services;\n\treturn {\n\t\tdrag: null,\n\t\tdragMultiple: {},\n\t\t_events: {\n\t\t\tbefore_start: {},\n\t\t\tbefore_finish: {},\n\t\t\tafter_finish: {}\n\t\t},\n\t\t_handlers: {},\n\t\tinit: function() {\n\t\t\tthis._domEvents = gantt._createDomEventScope();\n\t\t\tthis.clear_drag_state();\n\t\t\tvar drag = gantt.config.drag_mode;\n\t\t\tthis.set_actions();\n\n\t\t\tvar stateService = services.getService(\"state\");\n\t\t\tstateService.registerProvider(\"tasksDnd\", utils.bind(function() {\n\t\t\t\treturn {\n\t\t\t\t\tdrag_id : this.drag ? this.drag.id : undefined,\n\t\t\t\t\tdrag_mode : this.drag ? this.drag.mode : undefined,\n\t\t\t\t\tdrag_from_start : this.drag ? this.drag.left : undefined\n\t\t\t\t};\n\t\t\t}, this));\n\n\t\t\tvar evs = {\n\t\t\t\t\"before_start\": \"onBeforeTaskDrag\",\n\t\t\t\t\"before_finish\": \"onBeforeTaskChanged\",\n\t\t\t\t\"after_finish\": \"onAfterTaskDrag\"\n\t\t\t};\n\t\t\t//for now, all drag operations will trigger the same events\n\t\t\tfor (var stage in this._events) {\n\t\t\t\tfor (var mode in drag) {\n\t\t\t\t\tthis._events[stage][mode] = evs[stage];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis._handlers[drag.move] = this._move;\n\t\t\tthis._handlers[drag.resize] = this._resize;\n\t\t\tthis._handlers[drag.progress] = this._resize_progress;\n\t\t},\n\t\tset_actions: function() {\n\t\t\tvar data = timeline.$task_data;\n\t\t\tthis._domEvents.attach(data, \"mousemove\", gantt.bind(function(e) {\n\t\t\t\tthis.on_mouse_move(e);\n\t\t\t}, this));\n\t\t\tthis._domEvents.attach(data, \"mousedown\", gantt.bind(function(e) {\n\t\t\t\tthis.on_mouse_down(e);\n\t\t\t}, this));\n\t\t\tthis._domEvents.attach(document.body, \"mouseup\", gantt.bind(function(e) {\n\t\t\t\tthis.on_mouse_up(e);\n\t\t\t}, this));\n\t\t},\n\n\t\t_getPositioningContext: function(task) {\n\t\t\tif(timeline._getPositioningContext) {\n\t\t\t\treturn timeline._getPositioningContext(task);\n\t\t\t}\n\t\t\treturn null;\n\t\t},\n\n\t\tclear_drag_state: function() {\n\t\t\tthis.drag = {\n\t\t\t\tid: null,\n\t\t\t\tmode: null,\n\t\t\t\tpos: null,\n\t\t\t\tstart_x: null,\n\t\t\t\tstart_y: null,\n\t\t\t\tobj: null,\n\t\t\t\tleft: null\n\t\t\t};\n\t\t\tthis.dragMultiple = {};\n\t\t},\n\t\t_resize: function(task, shift, drag) {\n\t\t\tvar cfg = timeline.$getConfig();\n\t\t\tvar coords_x = this._drag_task_coords(task, drag);\n\t\t\tif (drag.left) {\n\t\t\t\ttask.start_date = gantt.dateFromPos(coords_x.start + shift, this._getPositioningContext(task));\n\t\t\t\tif (!task.start_date) {\n\t\t\t\t\ttask.start_date = new Date(gantt.getState().min_date);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\ttask.end_date = gantt.dateFromPos(coords_x.end + shift, this._getPositioningContext(task));\n\t\t\t\tif (!task.end_date) {\n\t\t\t\t\ttask.end_date = new Date(gantt.getState().max_date);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar minDurationInUnits = this._calculateMinDuration(cfg.min_duration, cfg.duration_unit);\n\t\t\tif (task.end_date - task.start_date < cfg.min_duration) {\n\t\t\t\tif (drag.left)\n\t\t\t\t\ttask.start_date = gantt.calculateEndDate(task.end_date, -minDurationInUnits, cfg.duration_unit, task);\n\t\t\t\telse\n\t\t\t\t\ttask.end_date = gantt.calculateEndDate(task.start_date, minDurationInUnits, cfg.duration_unit, task);\n\t\t\t}\n\t\t\tgantt._init_task_timing(task);\n\t\t},\n\t\t_calculateMinDuration: function(duration, unit) {\n\t\t\tvar inMs = {\n\t\t\t\t\"minute\": 60000,\n\t\t\t\t\"hour\": 3600000,\n\t\t\t\t\"day\": 86400000,\n\t\t\t\t\"week\": 604800000,\n\t\t\t\t\"month\": 2419200000,\n\t\t\t\t\"year\": 31356000000\n\t\t\t};\n\t\t\treturn Math.ceil(duration / inMs[unit]);\n\t\t},\n\t\t_resize_progress: function(task, shift, drag) {\n\t\t\tvar coords_x = this._drag_task_coords(task, drag);\n\n\t\t\tvar config = timeline.$getConfig();\n\t\t\tvar diffValue = !config.rtl ? (drag.pos.x - coords_x.start) : (coords_x.start - drag.pos.x);\n\n\t\t\tvar diff = Math.max(0, diffValue);\n\t\t\ttask.progress = Math.min(1, diff / Math.abs(coords_x.end - coords_x.start));\n\t\t},\n\t\t_find_max_shift: function(dragItems, shift) {\n\t\t\tvar correctShift;\n\t\t\tfor (var i in dragItems) {\n\t\t\t\tvar drag = dragItems[i];\n\t\t\t\tvar task = gantt.getTask(drag.id);\n\t\t\t\tif (task.unscheduled){\n\t\t\t\t\t// GS-1674. There is no need to check the tasks that are ignored by projects\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tvar coords_x = this._drag_task_coords(task, drag);\n\t\t\t\tvar minX = gantt.posFromDate(new Date(gantt.getState().min_date), this._getPositioningContext(task));\n\t\t\t\tvar maxX = gantt.posFromDate(new Date(gantt.getState().max_date), this._getPositioningContext(task));\n\n\t\t\t\tif (coords_x.end + shift > maxX) {\n\t\t\t\t\tvar maxShift = maxX - coords_x.end;\n\t\t\t\t\tif (maxShift < correctShift || correctShift === undefined) {\n\t\t\t\t\t\tcorrectShift = maxShift;\n\t\t\t\t\t}\n\t\t\t\t} else if (coords_x.start + shift < minX) {\n\t\t\t\t\tvar minShift = minX - coords_x.start;\n\t\t\t\t\tif (minShift > correctShift || correctShift === undefined) {\n\t\t\t\t\t\tcorrectShift = minShift;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn correctShift;\n\t\t},\n\t\t_move: function(task, shift, drag, multipleDragShift) {\n\t\t\tvar coords_x = this._drag_task_coords(task, drag);\n\t\t\tvar new_start = null,\n\t\t\tnew_end = null;\n\t\t\t// GS-454: If we drag multiple tasks, rely on the dates instead of timeline coordinates\n\t\t\tif (multipleDragShift){\n\t\t\t\tnew_start = new Date(+drag.obj.start_date + multipleDragShift),\n\t\t\t\tnew_end = new Date(+drag.obj.end_date + multipleDragShift);\n\t\t\t} else {\n\t\t\t\tnew_start = gantt.dateFromPos(coords_x.start + shift, this._getPositioningContext(task)),\n\t\t\t\tnew_end = gantt.dateFromPos(coords_x.end + shift, this._getPositioningContext(task));\n\t\t\t}\n\t\t\tif (!new_start) {\n\t\t\t\ttask.start_date = new Date(gantt.getState().min_date);\n\t\t\t\ttask.end_date = gantt.dateFromPos(gantt.posFromDate(task.start_date) + (coords_x.end - coords_x.start), this._getPositioningContext(task));\n\t\t\t} else if (!new_end) {\n\t\t\t\ttask.end_date = new Date(gantt.getState().max_date);\n\t\t\t\ttask.start_date = gantt.dateFromPos(gantt.posFromDate(task.end_date) - (coords_x.end - coords_x.start), this._getPositioningContext(task));\n\t\t\t} else {\n\t\t\t\ttask.start_date = new_start;\n\t\t\t\ttask.end_date = new_end;\n\t\t\t}\n\t\t},\n\t\t_drag_task_coords: function(t, drag) {\n\t\t\tvar start = drag.obj_s_x = drag.obj_s_x || gantt.posFromDate(t.start_date, this._getPositioningContext(t));\n\t\t\tvar end = drag.obj_e_x = drag.obj_e_x || gantt.posFromDate(t.end_date, this._getPositioningContext(t));\n\t\t\treturn {\n\t\t\t\tstart: start,\n\t\t\t\tend: end\n\t\t\t};\n\t\t},\n\t\t_mouse_position_change: function(oldPos, newPos) {\n\t\t\tvar dx = oldPos.x - newPos.x,\n\t\t\t\tdy = oldPos.y - newPos.y;\n\t\t\treturn Math.sqrt(dx * dx + dy * dy);\n\t\t},\n\t\t_is_number: function(n) {\n\t\t\treturn !isNaN(parseFloat(n)) && isFinite(n);\n\t\t},\n\n\t\ton_mouse_move: function(e) {\n\t\t\tif (this.drag.start_drag) {\n\t\t\t\tvar pos = domHelpers.getRelativeEventPosition(e, gantt.$task_data);\n\n\t\t\t\tvar sX = this.drag.start_drag.start_x,\n\t\t\t\t\tsY = this.drag.start_drag.start_y;\n\n\t\t\t\tif ((Date.now() - this.drag.timestamp > 50) ||\n\t\t\t\t\t(this._is_number(sX) && this._is_number(sY) && this._mouse_position_change({\n\t\t\t\t\t\tx: sX,\n\t\t\t\t\t\ty: sY\n\t\t\t\t\t}, pos) > 20)) {\n\t\t\t\t\tthis._start_dnd(e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar drag = this.drag;\n\n\t\t\tif (drag.mode) {\n\t\t\t\tif (!timeout(this, 40))//limit update frequency\n\t\t\t\t\treturn;\n\n\t\t\t\tthis._update_on_move(e);\n\n\t\t\t}\n\t\t},\n\n\t\t_update_item_on_move: function(shift, id, mode, drag, e, multipleDragShift) {\n\t\t\tvar task = gantt.getTask(id);\n\t\t\tvar original = gantt.mixin({}, task);\n\t\t\tvar copy = gantt.mixin({}, task);\n\t\t\tthis._handlers[mode].apply(this, [copy, shift, drag, multipleDragShift]);\n\t\t\tgantt.mixin(task, copy, true);\n\t\t\t//gantt._update_parents(drag.id, true);\n\t\t\tgantt.callEvent(\"onTaskDrag\", [task.id, mode, copy, original, e]);\n\t\t\tgantt.mixin(task, copy, true);\n\t\t\tgantt.refreshTask(id);\n\t\t},\n\n\t\t_update_on_move: function(e) {\n\t\t\tvar drag = this.drag;\n\t\t\tvar config = timeline.$getConfig();\n\t\t\tif (drag.mode) {\n\t\t\t\tvar pos = domHelpers.getRelativeEventPosition(e, timeline.$task_data);\n\t\t\t\tif (drag.pos && drag.pos.x == pos.x)\n\t\t\t\t\treturn;\n\n\t\t\t\tdrag.pos = pos;\n\n\t\t\t\tconst task = gantt.getTask(drag.id);\n\n\t\t\t\tvar curr_date = gantt.dateFromPos(pos.x, this._getPositioningContext(task));\n\t\t\t\tif (!curr_date || isNaN(curr_date.getTime()))\n\t\t\t\t\treturn;\n\n\n\t\t\t\tvar shift = pos.x - drag.start_x;\n\t\t\t\t\n\t\t\t\tif (this._handlers[drag.mode]) {\n\t\t\t\t\tif (drag.mode === config.drag_mode.move) {\n\t\t\t\t\t\tvar dragHash = {};\n\n\t\t\t\t\t\tif (this._isMultiselect()) {\n\t\t\t\t\t\t\tvar selectedTasksIds = gantt.getSelectedTasks();\n\t\t\t\t\t\t\tif (selectedTasksIds.indexOf(drag.id) >= 0) {\n\t\t\t\t\t\t\t\tdragHash = this.dragMultiple;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvar dragProject = false;\n\t\t\t\t\t\tif (gantt.isSummaryTask(task) && gantt.config.drag_project) {\n\t\t\t\t\t\t\tvar initialDrag = {};\n\t\t\t\t\t\t\tinitialDrag[drag.id] = utils.copy(drag);\n\t\t\t\t\t\t\tdragProject = true;\n\t\t\t\t\t\t\tdragHash = utils.mixin(initialDrag, this.dragMultiple);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvar maxShift = this._find_max_shift(dragHash, shift);\n\t\t\t\t\t\tif (maxShift !== undefined) {\n\t\t\t\t\t\t\tshift = maxShift;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis._update_item_on_move(shift, drag.id, drag.mode, drag, e);\n\n\t\t\t\t\t\tlet multipleDragShift;\n\t\t\t\t\t\tif (maxShift === undefined) {\n\t\t\t\t\t\t\t// GS-2593. If the timeline is repainted during the drag (infinite scale scenario)\n\t\t\t\t\t\t\t// we need to update the initial drag position to correctly update\n\t\t\t\t\t\t\t// the position of other dragged tasks\n\t\t\t\t\t\t\tconst newStartPos = gantt.posFromDate(drag.obj.start_date, this._getPositioningContext(drag.obj));\n\t\t\t\t\t\t\tconst newEndPos = gantt.posFromDate(drag.obj.end_date, this._getPositioningContext(drag.obj));\n\t\t\t\t\t\t\t// calculate the offset only when the drag started\n\t\t\t\t\t\t\tif (drag.handle_offset === undefined){\n\t\t\t\t\t\t\t\tconst width = newEndPos - newStartPos;\n\t\t\t\t\t\t\t\tconst dragPos = drag.start_x - newStartPos;\n\t\t\t\t\t\t\t\tdrag.handle_offset = dragPos / width;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tconst newWidth = Math.abs(newEndPos - newStartPos);\n\t\t\t\t\t\t\tlet dragX = newStartPos + newWidth * drag.handle_offset;\n\n\t\t\t\t\t\t\t// GS-454: Calculate the date shift in milliseconds instead of pixels\n\t\t\t\t\t\t\tconst shiftDate = gantt.dateFromPos(dragX, this._getPositioningContext(drag.obj));\n\t\t\t\t\t\t\tmultipleDragShift = curr_date - shiftDate;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tfor (var i in dragHash) {\n\t\t\t\t\t\t\tvar childDrag = dragHash[i];\n\t\t\t\t\t\t\tif(dragProject && childDrag.id != drag.id){\n\t\t\t\t\t\t\t\tgantt._bulk_dnd = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis._update_item_on_move(shift, childDrag.id, childDrag.mode, childDrag, e, multipleDragShift);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tgantt._bulk_dnd = false;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// for resize and progress\n\t\t\t\t\t\tthis._update_item_on_move(shift, drag.id, drag.mode, drag, e);\n\t\t\t\t\t}\n\t\t\t\t\tgantt._update_parents(drag.id);\n\t\t\t\t}\n\n\t\t\t}\n\t\t},\n\n\t\ton_mouse_down: function(e, src) {\n\t\t\t// on Mac we do not get onmouseup event when clicking right mouse button leaving us in dnd state\n\t\t\t// let's ignore right mouse button then\n\t\t\tif (e.button == 2 && e.button !== undefined)\n\t\t\t\treturn;\n\n\t\t\tvar config = timeline.$getConfig();\n\t\t\tvar id = gantt.locate(e);\n\t\t\tvar task = null;\n\t\t\tif (gantt.isTaskExists(id)) {\n\t\t\t\ttask = gantt.getTask(id);\n\t\t\t}\n\n\t\t\tif (gantt.isReadonly(task) || this.drag.mode) return;\n\n\t\t\tthis.clear_drag_state();\n\n\t\t\tsrc = src || (e.target || e.srcElement);\n\n\t\t\tvar className = domHelpers.getClassName(src);\n\t\t\tvar drag = this._get_drag_mode(className, src);\n\n\t\t\tif (!className || !drag) {\n\t\t\t\tif (src.parentNode)\n\t\t\t\t\treturn this.on_mouse_down(e, src.parentNode);\n\t\t\t\telse\n\t\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!drag) {\n\t\t\t\tif (gantt.checkEvent(\"onMouseDown\") && gantt.callEvent(\"onMouseDown\", [className.split(\" \")[0]])) {\n\t\t\t\t\tif (src.parentNode)\n\t\t\t\t\t\treturn this.on_mouse_down(e, src.parentNode);\n\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (drag.mode && drag.mode != config.drag_mode.ignore && config[\"drag_\" + drag.mode]) {\n\t\t\t\t\tid = gantt.locate(src);\n\t\t\t\t\ttask = gantt.copy(gantt.getTask(id) || {});\n\n\t\t\t\t\tif (gantt.isReadonly(task)) {\n\t\t\t\t\t\tthis.clear_drag_state();\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tif ((gantt.isSummaryTask(task) && !(task.auto_scheduling === false) && !config.drag_project) && drag.mode != config.drag_mode.progress) {//only progress drag is allowed for tasks with flexible duration\n\t\t\t\t\t\tthis.clear_drag_state();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tdrag.id = id;\n\t\t\t\t\tvar pos = domHelpers.getRelativeEventPosition(e, gantt.$task_data);\n\n\t\t\t\t\tdrag.start_x = pos.x;\n\t\t\t\t\tdrag.start_y = pos.y;\n\t\t\t\t\tdrag.obj = task;\n\t\t\t\t\tthis.drag.start_drag = drag;\n\t\t\t\t\tthis.drag.timestamp = Date.now();\n\n\t\t\t\t} else\n\t\t\t\t\tthis.clear_drag_state();\n\t\t\t}\n\t\t},\n\t\t_fix_dnd_scale_time: function(task, drag) {\n\t\t\tvar config = timeline.$getConfig();\n\t\t\tvar unit = gantt.getScale().unit,\n\t\t\t\tstep = gantt.getScale().step;\n\t\t\tif (!config.round_dnd_dates) {\n\t\t\t\tunit = 'minute';\n\t\t\t\tstep = config.time_step;\n\t\t\t}\n\n\t\t\tfunction fixStart(task) {\n\t\t\t\tif (!gantt.config.correct_work_time)\n\t\t\t\t\treturn;\n\t\t\t\tvar config = timeline.$getConfig();\n\t\t\t\tif (!gantt.isWorkTime(task.start_date, undefined, task))\n\t\t\t\t\ttask.start_date = gantt.calculateEndDate({\n\t\t\t\t\t\tstart_date: task.start_date,\n\t\t\t\t\t\tduration: -1,\n\t\t\t\t\t\tunit: config.duration_unit,\n\t\t\t\t\t\ttask: task\n\t\t\t\t\t});\n\t\t\t}\n\n\t\t\tfunction fixEnd(task) {\n\t\t\t\tif (!gantt.config.correct_work_time)\n\t\t\t\t\treturn;\n\t\t\t\tvar config = timeline.$getConfig();\n\t\t\t\tif (!gantt.isWorkTime(new Date(task.end_date - 1), undefined, task))\n\t\t\t\t\ttask.end_date = gantt.calculateEndDate({\n\t\t\t\t\t\tstart_date: task.end_date,\n\t\t\t\t\t\tduration: 1,\n\t\t\t\t\t\tunit: config.duration_unit,\n\t\t\t\t\t\ttask: task\n\t\t\t\t\t});\n\t\t\t}\n\n\t\t\tconst dndContext = timeline._getPositioningContext(task);\n\n\t\t\tif (drag.mode == config.drag_mode.resize) {\n\t\t\t\tif (drag.left) {\n\t\t\t\t\ttask.start_date = gantt.roundDate({date: task.start_date, unit: unit, step: step});\n\t\n\t\t\t\t\tif(dndContext && dndContext.calendar){\n\t\t\t\t\t\ttask.start_date = dndContext.calendar.getClosestWorkTime({date: task.start_date, dir:\"future\"});\n\t\t\t\t\t}\n\t\t\t\t\tfixStart(task);\n\t\t\t\t} else {\n\t\t\t\t\ttask.end_date = gantt.roundDate({date: task.end_date, unit: unit, step: step});\n\t\t\t\t\tif(dndContext && dndContext.calendar){\n\t\t\t\t\t\ttask.end_date = dndContext.calendar.getClosestWorkTime({date: task.end_date});\n\t\t\t\t\t}\n\t\t\t\t\tfixEnd(task);\n\t\t\t\t}\n\t\t\t} else if (drag.mode == config.drag_mode.move) {\n\t\t\t\ttask.start_date = gantt.roundDate({date: task.start_date, unit: unit, step: step});\n\t\t\t\t\n\t\t\t\tif(dndContext && dndContext.calendar){\n\t\t\t\t\ttask.start_date = dndContext.calendar.getClosestWorkTime({date: task.start_date, dir:\"future\"});\n\t\t\t\t}\n\n\t\t\t\tfixStart(task);\n\t\t\t\ttask.end_date = gantt.calculateEndDate(task);\n\t\t\t}\n\t\t},\n\t\t_fix_working_times: function(task, drag) {\n\t\t\tvar config = timeline.$getConfig();\n\t\t\tvar drag = drag || {mode: config.drag_mode.move};\n\n\t\t\tif (drag.mode == config.drag_mode.resize) {\n\t\t\t\tif (drag.left) {\n\t\t\t\t\ttask.start_date = gantt.getClosestWorkTime({date: task.start_date, dir: 'future', task: task});\n\t\t\t\t} else {\n\t\t\t\t\ttask.end_date = gantt.getClosestWorkTime({date: task.end_date, dir: 'past', task: task});\n\t\t\t\t}\n\t\t\t} else if (drag.mode == config.drag_mode.move) {\n\t\t\t\tgantt.correctTaskWorkTime(task);\n\t\t\t}\n\t\t},\n\n\t\t_finalize_mouse_up: function(taskId, config, drag, e) {\n\t\t\tvar task = gantt.getTask(taskId);\n\n\t\t\tif (config.work_time && config.correct_work_time) {\n\t\t\t\tthis._fix_working_times(task, drag);\n\t\t\t}\n\n\t\t\tthis._fix_dnd_scale_time(task, drag);\n\n\t\t\tif (!this._fireEvent(\"before_finish\", drag.mode, [taskId, drag.mode, gantt.copy(drag.obj), e])) {\n\t\t\t\t//drag.obj._dhx_changed = false;\n\t\t\t\tthis.clear_drag_state();\n\t\t\t\tif (taskId == drag.id) {\n\t\t\t\t\tdrag.obj._dhx_changed = false;\n\t\t\t\t\tgantt.mixin(task, drag.obj, true);\n\t\t\t\t}\n\n\n\t\t\t\tgantt.refreshTask(task.id);\n\t\t\t\t// GS-2013. Repaint parent projects when the drag is cancelled\n\t\t\t\tif (task.$level > 100){\n\t\t\t\t\t// When there are too many tasks to repaint, it is better to repaint Gantt\n\t\t\t\t\tlet shouldRepaint = false;\n\t\t\t\t\tgantt.eachParent(function(parent){\n\t\t\t\t\t\tif (!shouldRepaint && parent.type === gantt.config.types.project) {\n\t\t\t\t\t\t\tconst initialDates = {start_date: parent.start_date, end_date: parent.end_date};\n\t\t\t\t\t\t\tgantt.resetProjectDates(parent);\n\t\t\t\t\t\t\tif (+initialDates.start_date !== +parent.start_date || +initialDates.end_date !== +parent.end_date){\n\t\t\t\t\t\t\t\tshouldRepaint = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},task.id);\n\t\t\t\t\tif (shouldRepaint){\n\t\t\t\t\t\tgantt.refreshData();\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// If there are not so many parents especially if there are split tasks,\n\t\t\t\t\t// it is better to repaint individual tasks\n\t\t\t\t\tgantt.eachParent(function(parent){\n\t\t\t\t\t\tif (parent.type === gantt.config.types.project) {\n\t\t\t\t\t\t\tconst initialDates = {start_date: parent.start_date, end_date: parent.end_date};\n\t\t\t\t\t\t\tgantt.resetProjectDates(parent);\n\t\t\t\t\t\t\tif (+initialDates.start_date !== +parent.start_date || +initialDates.end_date !== +parent.end_date){\n\t\t\t\t\t\t\t\tgantt.refreshTask(parent.id);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},task.id);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tvar drag_id = taskId;\n\n\t\t\t\tgantt._init_task_timing(task);\n\n\t\t\t\tthis.clear_drag_state();\n\t\t\t\tgantt.updateTask(task.id);\n\t\t\t\tthis._fireEvent(\"after_finish\", drag.mode, [drag_id, drag.mode, e]);\n\t\t\t}\n\n\t\t},\n\n\t\ton_mouse_up: function(e) {\n\n\t\t\tvar drag = this.drag;\n\t\t\tif (drag.mode && drag.id) {\n\t\t\t\tvar config = timeline.$getConfig();\n\t\t\t\t//drop\n\t\t\t\tvar task = gantt.getTask(drag.id);\n\t\t\t\tvar dragMultiple = this.dragMultiple;\n\n\t\t\t\tvar finalizingBulkMove = false;\n\t\t\t\tvar moveCount = 0;\n\t\t\t\tif (drag.mode === config.drag_mode.move) {\n\t\t\t\t\tif ((gantt.isSummaryTask(task) && config.drag_project) || (this._isMultiselect())) {\n\t\t\t\t\t\tfinalizingBulkMove = true;\n\t\t\t\t\t\tmoveCount = Object.keys(dragMultiple).length;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tvar doFinalize = function doFinalize(){\n\t\t\t\t\tif(finalizingBulkMove){\n\t\t\t\t\t\tfor (var i in dragMultiple) {\n\t\t\t\t\t\t\t// GS-1057: Don't call drag events for the dragged task as they will be called later\n\t\t\t\t\t\t\tif (dragMultiple[i].id != drag.id){\n\t\t\t\t\t\t\t\tthis._finalize_mouse_up(dragMultiple[i].id, config, dragMultiple[i], e);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis._finalize_mouse_up(drag.id, config, drag, e);\n\n\t\t\t\t};\n\n\t\t\t\tif(finalizingBulkMove && moveCount > 10){// 10 - arbitrary threshold for bulk dnd at which we start doing complete repaint to refresh\n\t\t\t\t\tgantt.batchUpdate(function(){\n\t\t\t\t\t\tdoFinalize.call(this);\n\t\t\t\t\t}.bind(this));\n\t\t\t\t}else{\n\t\t\t\t\tdoFinalize.call(this);\n\t\t\t\t}\n\n\t\t\t}\n\t\t\tthis.clear_drag_state();\n\t\t},\n\t\t_get_drag_mode: function(className, el) {\n\t\t\tvar config = timeline.$getConfig();\n\t\t\tvar modes = config.drag_mode;\n\t\t\tvar classes = (className || \"\").split(\" \");\n\t\t\tvar classname = classes[0];\n\t\t\tvar drag = {mode: null, left: null};\n\t\t\tswitch (classname) {\n\t\t\t\tcase \"gantt_task_line\":\n\t\t\t\tcase \"gantt_task_content\":\n\t\t\t\t\tdrag.mode = modes.move;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"gantt_task_drag\":\n\t\t\t\t\tdrag.mode = modes.resize;\n\n\t\t\t\t\tvar dragProperty = el.getAttribute(\"data-bind-property\");\n\n\t\t\t\t\tif (dragProperty == \"start_date\") {\n\t\t\t\t\t\tdrag.left = true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdrag.left = false;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"gantt_task_progress_drag\":\n\t\t\t\t\tdrag.mode = modes.progress;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"gantt_link_control\":\n\t\t\t\tcase \"gantt_link_point\":\n\t\t\t\t\tdrag.mode = modes.ignore;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tdrag = null;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\treturn drag;\n\n\t\t},\n\n\t\t_start_dnd: function(e) {\n\t\t\tvar drag = this.drag = this.drag.start_drag;\n\t\t\tdelete drag.start_drag;\n\n\t\t\tvar cfg = timeline.$getConfig();\n\t\t\tvar id = drag.id;\n\n\t\t\tif (!cfg[\"drag_\" + drag.mode] || !gantt.callEvent(\"onBeforeDrag\", [id, drag.mode, e]) || !this._fireEvent(\"before_start\", drag.mode, [id, drag.mode, e])) {\n\t\t\t\tthis.clear_drag_state();\n\t\t\t} else {\n\t\t\t\tdelete drag.start_drag;\n\t\t\t\tvar task = gantt.getTask(id);\n\t\t\t\tif (gantt.isReadonly(task)){\n\t\t\t\t\tthis.clear_drag_state();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (this._isMultiselect()) {\n\t\t\t\t\t// for don't move selected tasks when drag unselected task\n\t\t\t\t\tvar selectedTasksIds = gantt.getSelectedTasks();\n\t\t\t\t\tif (selectedTasksIds.indexOf(drag.id) >= 0) {\n\t\t\t\t\t\thelpers.forEach(selectedTasksIds, gantt.bind(function(taskId) {\n\t\t\t\t\t\t\tvar selectedTask = gantt.getTask(taskId);\n\t\t\t\t\t\t\tif (gantt.isSummaryTask(selectedTask) && gantt.config.drag_project && drag.mode == cfg.drag_mode.move) {\n\t\t\t\t\t\t\t\tthis._addSubtasksToDragMultiple(selectedTask.id);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis.dragMultiple[taskId] = gantt.mixin({\n\t\t\t\t\t\t\t\tid: selectedTask.id,\n\t\t\t\t\t\t\t\tobj: gantt.copy(selectedTask)\n\t\t\t\t\t\t\t}, this.drag);\n\t\t\t\t\t\t}, this));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// for move unselected summary\n\t\t\t\tif (gantt.isSummaryTask(task) && gantt.config.drag_project && drag.mode == cfg.drag_mode.move) {\n\t\t\t\t\tthis._addSubtasksToDragMultiple(task.id);\n\t\t\t\t}\n\t\t\t\tgantt.callEvent(\"onTaskDragStart\", []);\n\t\t\t}\n\n\t\t},\n\t\t_fireEvent: function(stage, mode, params) {\n\t\t\tgantt.assert(this._events[stage], \"Invalid stage:{\" + stage + \"}\");\n\n\t\t\tvar trigger = this._events[stage][mode];\n\n\t\t\tgantt.assert(trigger, \"Unknown after drop mode:{\" + mode + \"}\");\n\t\t\tgantt.assert(params, \"Invalid event arguments\");\n\n\n\t\t\tif (!gantt.checkEvent(trigger))\n\t\t\t\treturn true;\n\n\t\t\treturn gantt.callEvent(trigger, params);\n\t\t},\n\n\t\tround_task_dates: function(task) {\n\t\t\tvar drag_state = this.drag;\n\t\t\tvar config = timeline.$getConfig();\n\t\t\tif (!drag_state) {\n\t\t\t\tdrag_state = {mode: config.drag_mode.move};\n\t\t\t}\n\t\t\tthis._fix_dnd_scale_time(task, drag_state);\n\t\t},\n\t\tdestructor: function() {\n\t\t\tthis._domEvents.detachAll();\n\t\t},\n\t\t_isMultiselect: function() {\n\t\t\treturn gantt.config.drag_multiple && !!(gantt.getSelectedTasks && gantt.getSelectedTasks().length > 0);\n\t\t},\n\t\t_addSubtasksToDragMultiple: function(summaryId) {\n\t\t\tgantt.eachTask(function(child) {\n\t\t\t\tthis.dragMultiple[child.id] = gantt.mixin({\n\t\t\t\t\tid: child.id,\n\t\t\t\t\tobj: gantt.copy(child)\n\t\t\t\t}, this.drag);\n\t\t\t}, summaryId, this);\n\t\t}\n\t};\n}\n\nfunction initTaskDND() {\n\tvar _tasks_dnd;\n\treturn {\n\t\textend: function(timeline) {\n\t\t\ttimeline.roundTaskDates = function(task) {\n\t\t\t\t_tasks_dnd.round_task_dates(task);\n\t\t\t};\n\n\t\t},\n\t\tinit: function(timeline, gantt) {\n\t\t\t_tasks_dnd = createTaskDND(timeline, gantt);\n\t\t\t// TODO: entry point for touch handlers, move touch to timeline\n\t\t\ttimeline._tasks_dnd = _tasks_dnd;\n\t\t\treturn _tasks_dnd.init(gantt);\n\t\t},\n\t\tdestructor: function() {\n\t\t\tif (_tasks_dnd) {\n\t\t\t\t_tasks_dnd.destructor();\n\t\t\t\t_tasks_dnd = null;\n\t\t\t}\n\t\t}\n\t};\n}\n\nexport default {\n\tcreateTaskDND: initTaskDND\n};","import * as domHelpers from \"../utils/dom_helpers\";\n\nvar initLinksDND = function(timeline, gantt) {\n\tvar _link_landing,\n\t\t_link_target_task,\n\t\t_link_target_task_start,\n\t\t_link_source_task,\n\t\t_link_source_task_start,\n\t\tmarkerDefaultOffset = 10,\n\t\tscrollDefaultSize = 18;\n\n\tfunction getDndState(){\n\t\treturn {\n\t\t\tlink_source_id : _link_source_task,\n\t\t\tlink_target_id : _link_target_task,\n\t\t\tlink_from_start : _link_source_task_start,\n\t\t\tlink_to_start : _link_target_task_start,\n\t\t\tlink_landing_area : _link_landing\n\t\t};\n\t}\n\n\tvar services = gantt.$services;\n\n\tvar state = services.getService(\"state\");\n\tvar DnD = services.getService(\"dnd\");\n\n\tstate.registerProvider(\"linksDnD\", getDndState);\n\n\tvar start_marker = \"task_start_date\",\n\t\tend_marker = \"task_end_date\",\n\t\tlink_edge_marker = \"gantt_link_point\",\n\t\tlink_landing_hover_area = \"gantt_link_control\";\n\n\tvar dnd = new DnD(timeline.$task_bars, {\n\t\tsensitivity : 0,\n\t\tupdates_per_second : 60,\n\t\tmousemoveContainer: gantt.$root,\n\t\tselector: \".\" + link_edge_marker,\n\t\tpreventDefault: true\n\t});\n\n\tdnd.attachEvent(\"onBeforeDragStart\", gantt.bind(function(obj,e) {\n\t\tvar target = (e.target||e.srcElement);\n\t\tresetDndState();\n\t\tif(gantt.getState(\"tasksDnd\").drag_id)\n\t\t\treturn false;\n\n\t\tif(domHelpers.locateClassName(target, link_edge_marker)){\n\t\t\tif(domHelpers.locateClassName(target, start_marker))\n\t\t\t\t_link_source_task_start = true;\n\n\t\t\tvar sid = gantt.locate(e);\n\t\t\t_link_source_task = sid;\n\n\t\t\tvar t = gantt.getTask(sid);\n\t\t\tif(gantt.isReadonly(t)){\n\t\t\t\tresetDndState();\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tthis._dir_start = {\n\t\t\t\tx: dnd.config.original_element_sizes.x + dnd.config.original_element_sizes.width/2,\n\t\t\t\ty: dnd.config.original_element_sizes.y + dnd.config.original_element_sizes.height/2\n\t\t\t};\n\n\t\t\treturn true;\n\t\t}else{\n\t\t\treturn false;\n\t\t}\n\n\t}, this));\n\n\tdnd.attachEvent(\"onAfterDragStart\", gantt.bind(function(obj,e) {\n\t\tif(gantt.config.touch) {\n\t\t\tgantt.refreshData();\n\t\t}\n\t\tupdateMarkedHtml(dnd.config.marker);\n\t}, this));\n\n\tfunction getVieportSize(){\n\t\tvar root = gantt.$root;\n\t\treturn { right: root.offsetWidth, bottom: root.offsetHeight };\n\t}\n\tfunction getMarkerSize (marker){\n\t\tvar width = 0, height = 0;\n\t\tif(marker){\n\t\t\twidth = marker.offsetWidth || 0;\n\t\t\theight = marker.offsetHeight || 0;\n\t\t}\n\t\treturn { width: width, height: height };\n\t}\n\n\tfunction getPosition(e, marker){\n\t\tvar oldPos = dnd.getPosition(e);\n\n\t\tvar markerSize = getMarkerSize(marker);\n\t\tvar viewportSize = getVieportSize();\n\n\t\tvar offsetX = gantt.config.tooltip_offset_x || markerDefaultOffset;\n\t\tvar offsetY = gantt.config.tooltip_offset_y || markerDefaultOffset;\n\n\t\tvar scrollSize = gantt.config.scroll_size || scrollDefaultSize;\n\n\t\t// GS-1315: Add offset if there are elements above Gantt\n\t\tvar ganttOffsetY = gantt.$container.getBoundingClientRect().y + window.scrollY;\n\n\t\tvar position = {\n\t\t\ty: oldPos.y + offsetY,\n\t\t\tx: oldPos.x + offsetX,\n\t\t\tbottom: oldPos.y + markerSize.height + offsetY + scrollSize,\n\t\t\tright: oldPos.x + markerSize.width + offsetX + scrollSize\n\t\t};\n\n\t\tif(position.bottom > viewportSize.bottom + ganttOffsetY){\n\t\t\tposition.y = viewportSize.bottom + ganttOffsetY - markerSize.height - offsetY;\n\t\t}\n\n\t\tif(position.right > viewportSize.right){\n\t\t\tposition.x = viewportSize.right - markerSize.width - offsetX;\n\t\t}\n\t\treturn position;\n\t}\n\n\tdnd.attachEvent(\"onDragMove\", gantt.bind(function(obj,e) {\n\t\tvar dd = dnd.config;\n\t\tvar pos = getPosition(e, dd.marker);\n\t\tadvanceMarker(dd.marker, pos);\n\t\tvar landing = !!domHelpers.locateClassName(e, link_landing_hover_area);\n\n\t\tvar prevTarget = _link_target_task;\n\t\tvar prevLanding = _link_landing;\n\t\tvar prevToStart = _link_target_task_start;\n\n\t\tvar targ = gantt.locate(e),\n\t\t\tto_start = true;\n\n\t\t// can drag and drop link to another gantt on the page, such links are not supported\n\t\tvar eventTarget = domHelpers.getTargetNode(e);\n\n\t\tvar sameGantt = domHelpers.isChildOf(eventTarget, gantt.$root);\n\t\tif(!sameGantt){\n\t\t\tlanding = false;\n\t\t\ttarg = null;\n\t\t}\n\n\t\tif(landing){\n\t\t\t//refreshTask\n\t\t\tto_start = !domHelpers.locateClassName(e, end_marker);\n\t\t\tlanding = !!targ;\n\t\t}\n\n\t\t_link_target_task = targ;\n\t\t_link_landing = landing;\n\t\t_link_target_task_start = to_start;\n\n\t\tif(landing){\n\n\t\t\tvar node = domHelpers.locateClassName(e, link_landing_hover_area);\n\t\t\n\t\t\tconst point = node.querySelector(`.${link_edge_marker}`);\n\t\t\tif(point){\n\t\t\t\tconst absCoords = domHelpers.getRelativeNodePosition(point, timeline.$task_bg);\n\t\t\t\tthis._dir_end = {\n\t\t\t\t\tx: absCoords.x + point.offsetWidth/2,\n\t\t\t\t\ty: absCoords.y + point.offsetHeight/2\n\t\t\t\t};\n\t\t\t}\n\n\t\t}else{\n\t\t\tthis._dir_end = domHelpers.getRelativeEventPosition(e, timeline.$task_data);\n\t\t\tif(gantt.env.isEdge){ // to fix margin collapsing\n\t\t\t\tthis._dir_end.y += window.scrollY;\n\t\t\t}\n\t\t}\n\n\t\tvar targetChanged = !(prevLanding == landing && prevTarget == targ && prevToStart == to_start);\n\t\tif(targetChanged){\n\t\t\tif(prevTarget)\n\t\t\t\tgantt.refreshTask(prevTarget, false);\n\t\t\tif(targ)\n\t\t\t\tgantt.refreshTask(targ, false);\n\t\t}\n\n\t\tif(targetChanged){\n\t\t\tupdateMarkedHtml(dd.marker);\n\t\t}\n\n\t\tshowDirectingLine(this._dir_start.x, this._dir_start.y, this._dir_end.x, this._dir_end.y);\n\n\t\treturn true;\n\t}, this));\n\n\n\tdnd.attachEvent(\"onDragEnd\", gantt.bind(function() {\n\t\tvar drag = getDndState();\n\n\t\tif(drag.link_source_id && drag.link_target_id && drag.link_source_id != drag.link_target_id){\n\t\t\tvar type = gantt._get_link_type(drag.link_from_start, drag.link_to_start);\n\n\t\t\tvar link = {source : drag.link_source_id, target: drag.link_target_id, type:type};\n\t\t\tif(link.type && gantt.isLinkAllowed(link)) {\n\t\t\t\tif(gantt.callEvent(\"onLinkCreated\", [link])){\n\t\t\t\t\tgantt.addLink(link);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tresetDndState();\n\n\t\tif(gantt.config.touch) {\n\t\t\tgantt.refreshData();\n\t\t}\n\t\telse {\n\t\t\tif (drag.link_source_id)\n\t\t\t\tgantt.refreshTask(drag.link_source_id, false);\n\t\t\tif (drag.link_target_id)\n\t\t\t\tgantt.refreshTask(drag.link_target_id, false);\n\t\t}\n\t\tremoveDirectionLine();\n\t}, this));\n\n\tfunction updateMarkedHtml(marker){\n\t\tvar link = getDndState();\n\n\t\tvar css = [\"gantt_link_tooltip\"];\n\t\tif(link.link_source_id && link.link_target_id){\n\t\t\tif(gantt.isLinkAllowed(link.link_source_id, link.link_target_id, link.link_from_start, link.link_to_start)){\n\t\t\t\tcss.push(\"gantt_allowed_link\");\n\t\t\t}else{\n\t\t\t\tcss.push(\"gantt_invalid_link\");\n\t\t\t}\n\t\t}\n\n\t\tvar className = gantt.templates.drag_link_class(link.link_source_id, link.link_from_start, link.link_target_id, link.link_to_start);\n\t\tif(className)\n\t\t\tcss.push(className);\n\n\t\tvar html = \"<div class='\"+className+ \"'>\" +\n\t\t\tgantt.templates.drag_link(link.link_source_id, link.link_from_start, link.link_target_id, link.link_to_start) +\n\t\t\t\"</div>\";\n\t\tmarker.innerHTML = html;\n\t}\n\n\tfunction advanceMarker(marker, pos){\n\t\tmarker.style.left = pos.x + \"px\";\n\t\tmarker.style.top = pos.y + \"px\";\n\t}\n\n\tfunction resetDndState(){\n\t\t_link_source_task =\n\t\t\t_link_source_task_start =\n\t\t\t\t_link_target_task = null;\n\t\t_link_target_task_start = true;\n\t}\n\tfunction showDirectingLine(s_x, s_y, e_x, e_y){\n\t\tvar div = getDirectionLine();\n\n\t\tvar link = getDndState();\n\n\t\tvar css = [\"gantt_link_direction\"];\n\t\tif(gantt.templates.link_direction_class){\n\t\t\tcss.push(gantt.templates.link_direction_class(link.link_source_id, link.link_from_start, link.link_target_id, link.link_to_start));\n\t\t}\n\n\t\tvar dist =Math.sqrt( (Math.pow(e_x - s_x, 2)) + (Math.pow(e_y - s_y, 2)) );\n\t\tdist = Math.max(0, dist - 3);\n\t\tif(!dist)\n\t\t\treturn;\n\n\t\tdiv.className = css.join(\" \");\n\t\tvar tan = (e_y - s_y)/(e_x - s_x),\n\t\t\tangle = Math.atan(tan);\n\n\t\tif(coordinateCircleQuarter(s_x, e_x, s_y, e_y) == 2){\n\t\t\tangle += Math.PI;\n\t\t}else if(coordinateCircleQuarter(s_x, e_x, s_y, e_y) == 3){\n\t\t\tangle -= Math.PI;\n\t\t}\n\n\n\n\t\tvar sin = Math.sin(angle),\n\t\t\tcos = Math.cos(angle),\n\t\t\ttop = Math.round(s_y),\n\t\t\tleft = Math.round(s_x);\n\n\n\t\tvar style = [\n\t\t\t\"-webkit-transform: rotate(\"+angle+\"rad)\",\n\t\t\t\"-moz-transform: rotate(\"+angle+\"rad)\",\n\t\t\t\"-ms-transform: rotate(\"+angle+\"rad)\",\n\t\t\t\"-o-transform: rotate(\"+angle+\"rad)\",\n\t\t\t\"transform: rotate(\"+angle+\"rad)\",\n\t\t\t\"width:\" + Math.round(dist) + \"px\"\n\t\t];\n\n\t\tif(window.navigator.userAgent.indexOf(\"MSIE 8.0\") != -1){\n\t\t\t//ms-filter breaks styles in ie9, so add it only for 8th\n\t\t\tstyle.push(\"-ms-filter: \\\"\" + ieTransform(sin, cos) + \"\\\"\");\n\n\t\t\tvar shiftLeft = Math.abs(Math.round(s_x - e_x)),\n\t\t\t\tshiftTop = Math.abs(Math.round(e_y - s_y));\n\t\t\t//fix rotation axis\n\t\t\tswitch(coordinateCircleQuarter(s_x, e_x, s_y, e_y)){\n\t\t\t\tcase 1:\n\t\t\t\t\ttop -= shiftTop;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 2:\n\t\t\t\t\tleft -= shiftLeft;\n\t\t\t\t\ttop -= shiftTop;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 3:\n\t\t\t\t\tleft -= shiftLeft;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t}\n\n\t\tstyle.push(\"top:\" +  top + \"px\");\n\t\tstyle.push(\"left:\" +  left + \"px\");\n\n\t\tdiv.style.cssText = style.join(\";\");\n\t}\n\n\tfunction ieTransform(sin, cos){\n\t\treturn \"progid:DXImageTransform.Microsoft.Matrix(\"+\n\t\t\t\"M11 = \"+cos+\",\"+\n\t\t\t\"M12 = -\"+sin+\",\"+\n\t\t\t\"M21 = \"+sin+\",\"+\n\t\t\t\"M22 = \"+cos+\",\"+\n\t\t\t\"SizingMethod = 'auto expand'\"+\n\t\t\")\";\n\t}\n\tfunction coordinateCircleQuarter(sX, eX, sY, eY){\n\t\tif(eX >= sX){\n\t\t\tif(eY <= sY){\n\t\t\t\treturn 1;\n\t\t\t}else{\n\t\t\t\treturn 4;\n\t\t\t}\n\t\t}else{\n\t\t\tif(eY <= sY){\n\t\t\t\treturn 2;\n\t\t\t}else{\n\t\t\t\treturn 3;\n\t\t\t}\n\t\t}\n\n\t}\n\tfunction getDirectionLine(){\n\t\tif(!dnd._direction || !dnd._direction.parentNode){\n\t\t\tdnd._direction = document.createElement(\"div\");\n\t\t\ttimeline.$task_links.appendChild(dnd._direction);\n\t\t}\n\t\treturn dnd._direction;\n\t}\n\tfunction removeDirectionLine(){\n\t\tif(dnd._direction){\n\t\t\tif (dnd._direction.parentNode)\t//the event line can be detached because of data refresh\n\t\t\t\tdnd._direction.parentNode.removeChild(dnd._direction);\n\n\t\t\tdnd._direction = null;\n\t\t}\n\t}\n\tgantt.attachEvent(\"onGanttRender\", gantt.bind(function() {\n\t\tif(dnd._direction){\n\t\t\tshowDirectingLine(this._dir_start.x, this._dir_start.y, this._dir_end.x, this._dir_end.y);\n\t\t}\n\t}, this));\n};\n\nexport default {\n\tcreateLinkDND: function(){\n\t\treturn {\n\t\t\tinit: initLinksDND\n\t\t};\n\t}\n};","import * as utils from \"../../../utils/utils\";\nimport taskDnD from \"./tasks_dnd\";\nimport linkDnD from \"./links_dnd\";\nimport * as domHelpers from \"../utils/dom_helpers\";\nimport MouseDelegates from \"../mouse_event_container\";\n\nvar initializer = (function(){\n\treturn function(gantt){\n\t\tvar services = gantt.$services;\n\t\treturn {\n\t\t\tonCreated: function (timeline) {\n\t\t\t\tvar config = timeline.$config;\n\t\t\t\tconfig.bind = utils.defined(config.bind) ? config.bind : \"task\";\n\t\t\t\tconfig.bindLinks = utils.defined(config.bindLinks) ? config.bindLinks : \"link\";\n\n\t\t\t\ttimeline._linksDnD = linkDnD.createLinkDND();\n\t\t\t\ttimeline._tasksDnD = taskDnD.createTaskDND();\n\t\t\t\ttimeline._tasksDnD.extend(timeline);\n\n\t\t\t\tthis._mouseDelegates = MouseDelegates(gantt);\n\t\t\t},\n\t\t\tonInitialized: function (timeline) {\n\t\t\t\tthis._attachDomEvents(gantt);\n\n\t\t\t\tthis._attachStateProvider(gantt, timeline);\n\n\t\t\t\ttimeline._tasksDnD.init(timeline, gantt);\n\t\t\t\ttimeline._linksDnD.init(timeline, gantt);\n\n\t\t\t\tif(timeline.$config.id == \"timeline\"){\n\t\t\t\t\tthis.extendDom(timeline);\n\t\t\t\t}\n\n\t\t\t},\n\t\t\tonDestroyed: function (timeline) {\n\t\t\t\tthis._clearDomEvents(gantt);\n\t\t\t\tthis._clearStateProvider(gantt);\n\t\t\t\tif (timeline._tasksDnD) {\n\t\t\t\t\ttimeline._tasksDnD.destructor();\n\t\t\t\t}\n\t\t\t},\n\t\t\textendDom: function(timeline){\n\t\t\t\tgantt.$task = timeline.$task;\n\t\t\t\tgantt.$task_scale = timeline.$task_scale;\n\t\t\t\tgantt.$task_data = timeline.$task_data;\n\t\t\t\tgantt.$task_bg = timeline.$task_bg;\n\t\t\t\tgantt.$task_links = timeline.$task_links;\n\t\t\t\tgantt.$task_bars = timeline.$task_bars;\n\t\t\t},\n\n\t\t\t_clearDomEvents: function(){\n\t\t\t\tthis._mouseDelegates.destructor();\n\t\t\t\tthis._mouseDelegates = null;\n\t\t\t},\n\n\t\t\t_attachDomEvents: function(gantt){\n\t\t\t\tfunction _delete_link_handler(id, e) {\n\t\t\t\t\tif (id && this.callEvent(\"onLinkDblClick\", [id, e])) {\n\n\t\t\t\t\t\tvar link = this.getLink(id);\n\t\t\t\t\t\tif (this.isReadonly(link)) return;\n\n\t\t\t\t\t\tvar title = \"\";\n\t\t\t\t\t\tvar question = this.locale.labels.link + \" \" + this.templates.link_description(this.getLink(id)) + \" \" + this.locale.labels.confirm_link_deleting;\n\n\t\t\t\t\t\twindow.setTimeout(function () {\n\t\t\t\t\t\t\tgantt._delete_link_confirm({\n\t\t\t\t\t\t\t\tlink: link,\n\t\t\t\t\t\t\t\tmessage: question,\n\t\t\t\t\t\t\t\ttitle: title,\n\t\t\t\t\t\t\t\tcallback: function () {\n\t\t\t\t\t\t\t\t\tgantt.deleteLink(id);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}, (this.config.touch ? 300 : 1));\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis._mouseDelegates.delegate(\"click\", \"gantt_task_link\", gantt.bind(function (e, trg) {\n\t\t\t\t\tvar id = this.locate(e, this.config.link_attribute);\n\t\t\t\t\tif (id) {\n\t\t\t\t\t\tthis.callEvent(\"onLinkClick\", [id, e]);\n\t\t\t\t\t}\n\t\t\t\t}, gantt), this.$task);\n\n\t\t\t\tthis._mouseDelegates.delegate(\"click\", \"gantt_scale_cell\", gantt.bind(function (e, trg) {\n\t\t\t\t\tvar pos = domHelpers.getRelativeEventPosition(e, gantt.$task_data);\n\t\t\t\t\tvar date = gantt.dateFromPos(pos.x);\n\t\t\t\t\tvar coll = Math.floor(gantt.columnIndexByDate(date));\n\n\t\t\t\t\tvar coll_date = gantt.getScale().trace_x[coll];\n\n\t\t\t\t\tgantt.callEvent(\"onScaleClick\", [e, coll_date]);\n\t\t\t\t}, gantt), this.$task);\n\n\t\t\t\tthis._mouseDelegates.delegate(\"doubleclick\", \"gantt_task_link\", gantt.bind(function (e, id, trg) {\n\t\t\t\t\tvar id = this.locate(e, gantt.config.link_attribute);\n\t\t\t\t\t_delete_link_handler.call(this, id, e);\n\t\t\t\t}, gantt), this.$task);\n\n\t\t\t\tthis._mouseDelegates.delegate(\"doubleclick\", \"gantt_link_point\", gantt.bind(function (e, id, trg) {\n\t\t\t\t\tvar id = this.locate(e),\n\t\t\t\t\t\ttask = this.getTask(id);\n\n\t\t\t\t\tvar link = null;\n\t\t\t\t\tif (trg.parentNode && domHelpers.getClassName(trg.parentNode)) {\n\t\t\t\t\t\tif (domHelpers.getClassName(trg.parentNode).indexOf(\"_left\") > -1) {\n\t\t\t\t\t\t\tlink = task.$target[0];\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tlink = task.$source[0];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (link)\n\t\t\t\t\t\t_delete_link_handler.call(this, link, e);\n\t\t\t\t\treturn false;\n\t\t\t\t}, gantt), this.$task);\n\t\t\t},\n\n\t\t\t_attachStateProvider: function(gantt, timeline){\n\t\t\t\tvar self = timeline;\n\t\t\t\tvar state = services.getService(\"state\");\n\t\t\t\tstate.registerProvider(\"tasksTimeline\", function(){\n\t\t\t\t\treturn {\n\t\t\t\t\t\tscale_unit: self._tasks ? self._tasks.unit : undefined,\n\t\t\t\t\t\tscale_step:  self._tasks ? self._tasks.step  : undefined\n\t\t\t\t\t};\n\t\t\t\t});\n\t\t\t},\n\n\t\t\t_clearStateProvider: function(){\n\t\t\t\tvar state = services.getService(\"state\");\n\t\t\t\tstate.unregisterProvider(\"tasksTimeline\");\n\t\t\t}\n\t\t};\n\t};\n\n})();\n\nexport default initializer;","import * as domHelpers from \"./utils/dom_helpers\";\n\nvar initializer = (function() {\n\treturn function (gantt) {\n\t\treturn {\n\n\t\t\tgetVerticalScrollbar: function(){\n\t\t\t\treturn gantt.$ui.getView(\"scrollVer\");\n\t\t\t},\n\t\t\tgetHorizontalScrollbar: function(){\n\t\t\t\treturn gantt.$ui.getView(\"scrollHor\");\n\t\t\t},\n\n\t\t\t_legacyGridResizerClass: function(layout){\n\t\t\t\tvar resizers = layout.getCellsByType(\"resizer\");\n\t\t\t\tfor(var i = 0; i < resizers.length; i++){\n\t\t\t\t\tvar r = resizers[i];\n\t\t\t\t\tvar gridResizer = false;\n\n\t\t\t\t\tvar prev = r.$parent.getPrevSibling(r.$id);\n\t\t\t\t\tif(prev && prev.$config && prev.$config.id === \"grid\"){\n\t\t\t\t\t\tgridResizer= true;\n\t\t\t\t\t}else{\n\t\t\t\t\t\tvar next = r.$parent.getNextSibling(r.$id);\n\t\t\t\t\t\tif(next && next.$config && next.$config.id === \"grid\"){\n\t\t\t\t\t\t\tgridResizer= true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif(gridResizer){\n\t\t\t\t\t\tr.$config.css = (r.$config.css ? r.$config.css + \" \" : \"\") + \"gantt_grid_resize_wrap\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tonCreated: function(layout) {\n\t\t\t\tvar first = true;\n\n\t\t\t\tthis._legacyGridResizerClass(layout);\n\n\t\t\t\tlayout.attachEvent(\"onBeforeResize\", function() {\n\t\t\t\t\tvar mainTimeline = gantt.$ui.getView(\"timeline\");\n\t\t\t\t\tif (mainTimeline)\n\t\t\t\t\t\tmainTimeline.$config.hidden = mainTimeline.$parent.$config.hidden = !gantt.config.show_chart;\n\n\t\t\t\t\tvar mainGrid = gantt.$ui.getView(\"grid\");\n\n\t\t\t\t\tif(!mainGrid)\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\tvar colsWidth = mainGrid._getColsTotalWidth();\n\t\t\t\t\tvar hideGrid = !gantt.config.show_grid || !gantt.config.grid_width || colsWidth === 0;\n\t\t\t\t\tif (first && !hideGrid && colsWidth !== false){\n\t\t\t\t\t\t\tgantt.config.grid_width = colsWidth;\n\t\t\t\t\t}\n\t\t\t\t\tmainGrid.$config.hidden = mainGrid.$parent.$config.hidden = hideGrid;\n\n\t\t\t\t\tif (!mainGrid.$config.hidden) {\n\t\t\t\t\t\t/* restrict grid width due to min_width, max_width, min_grid_column_width */\n\t\t\t\t\t\tvar grid_limits = mainGrid._getGridWidthLimits();\n\t\t\t\t\t\tif (grid_limits[0] && gantt.config.grid_width < grid_limits[0])\n\t\t\t\t\t\t\tgantt.config.grid_width = grid_limits[0];\n\t\t\t\t\t\tif (grid_limits[1] && gantt.config.grid_width > grid_limits[1])\n\t\t\t\t\t\t\tgantt.config.grid_width = grid_limits[1];\n\t\t\t\t\t\tif (mainTimeline && gantt.config.show_chart){\n\n\t\t\t\t\t\t\tmainGrid.$config.width = gantt.config.grid_width - 1;\n\n\t\t\t\t\t\t\t// GS-1314: Don't let the non-scrollable grid to be larger than the container with the correct width\n\t\t\t\t\t\t\tif (!mainGrid.$config.scrollable && mainGrid.$config.scrollY && gantt.$root.offsetWidth){\n\t\t\t\t\t\t\t\tvar ganttContainerWidth = mainGrid.$gantt.$layout.$container.offsetWidth;\n\t\t\t\t\t\t\t\tvar verticalScrollbar = gantt.$ui.getView(mainGrid.$config.scrollY);\n\t\t\t\t\t\t\t\tvar verticalScrollbarWidth = verticalScrollbar.$config.width;\n\n\t\t\t\t\t\t\t\t// GS-2488: to prevent grid from occupying the whole gantt container(timeline will be disabled) \n\t\t\t\t\t\t\t\t// need to leave min width for timeline\n\t\t\t\t\t\t\t\tvar gridOverflow = ganttContainerWidth - (mainGrid.$config.width + verticalScrollbarWidth) - 4;\n\t\t\t\t\t\t\t\tif (gridOverflow < 0){\n\t\t\t\t\t\t\t\t\tmainGrid.$config.width += gridOverflow;\n\t\t\t\t\t\t\t\t\tgantt.config.grid_width += gridOverflow;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (!first) {\n\t\t\t\t\t\t\t\tif (mainTimeline && !domHelpers.isChildOf(mainTimeline.$task, layout.$view)) {\n\t\t\t\t\t\t\t\t\t// timeline is being displayed after being not visible, reset grid with from full screen\n\t\t\t\t\t\t\t\t\tif (!mainGrid.$config.original_grid_width) {\n\t\t\t\t\t\t\t\t\t\tvar skinSettings = gantt.skins[gantt.skin];\n\t\t\t\t\t\t\t\t\t\tif(skinSettings && skinSettings.config && skinSettings.config.grid_width){\n\t\t\t\t\t\t\t\t\t\t\tmainGrid.$config.original_grid_width =  skinSettings.config.grid_width;\n\t\t\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\t\t\tmainGrid.$config.original_grid_width = 0;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tgantt.config.grid_width = mainGrid.$config.original_grid_width;\n\t\t\t\t\t\t\t\t\tmainGrid.$parent.$config.width = gantt.config.grid_width;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tmainGrid.$parent._setContentSize(mainGrid.$config.width, null);\n\t\t\t\t\t\t\t\t\tgantt.$layout._syncCellSizes(mainGrid.$parent.$config.group, {value: gantt.config.grid_width, isGravity: false});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tmainGrid.$parent.$config.width = gantt.config.grid_width;\n\t\t\t\t\t\t\t\tif (mainGrid.$parent.$config.group) {\n\t\t\t\t\t\t\t\t\tgantt.$layout._syncCellSizes(mainGrid.$parent.$config.group, {value: mainGrid.$parent.$config.width, isGravity: false});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (mainTimeline && domHelpers.isChildOf(mainTimeline.$task, layout.$view)) {\n\t\t\t\t\t\t\t\t// hiding timeline, remember grid with to restore it when timeline is displayed again\n\t\t\t\t\t\t\t\tmainGrid.$config.original_grid_width = gantt.config.grid_width;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (!first) {\n\t\t\t\t\t\t\t\tmainGrid.$parent.$config.width = 0;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tfirst = false;\n\t\t\t\t});\n\t\t\t\tthis._initScrollStateEvents(layout);\n\t\t\t},\n\n\t\t\t_initScrollStateEvents: function(layout) {\n\t\t\t\tgantt._getVerticalScrollbar = this.getVerticalScrollbar;\n\t\t\t\tgantt._getHorizontalScrollbar = this.getHorizontalScrollbar;\n\n\t\t\t\tvar vertical = this.getVerticalScrollbar();\n\t\t\t\tvar horizontal = this.getHorizontalScrollbar();\n\t\t\t\tif (vertical) {\n\t\t\t\t\tvertical.attachEvent(\"onScroll\", function(oldPos, newPos, dir){\n\t\t\t\t\t\tvar scrollState = gantt.getScrollState();\n\t\t\t\t\t\tgantt.callEvent(\"onGanttScroll\", [scrollState.x, oldPos, scrollState.x, newPos]);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tif (horizontal) {\n\t\t\t\t\thorizontal.attachEvent(\"onScroll\", function(oldPos, newPos, dir){\n\t\t\t\t\t\tvar scrollState = gantt.getScrollState();\n\t\t\t\t\t\tgantt.callEvent(\"onGanttScroll\", [oldPos, scrollState.y, newPos, scrollState.y]);\n\n\t\t\t\t\t\t// if the grid doesn't fit the width, scroll the row container\n\t\t\t\t\t\tvar grid = gantt.$ui.getView(\"grid\");\n\t\t\t\t\t\tif (grid && grid.$grid_data && !grid.$config.scrollable){\n\t\t\t\t\t\t\tgrid.$grid_data.style.left = grid.$grid.scrollLeft + \"px\";\n\t\t\t\t\t\t\tgrid.$grid_data.scrollLeft = grid.$grid.scrollLeft;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tlayout.attachEvent(\"onResize\", function(){\n\t\t\t\t\tif (vertical && !gantt.$scroll_ver){\n\t\t\t\t\t\tgantt.$scroll_ver = vertical.$scroll_ver;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (horizontal && !gantt.$scroll_hor){\n\t\t\t\t\t\tgantt.$scroll_hor = horizontal.$scroll_hor;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\n\t\t\t_findGridResizer: function(layout, grid){\n\t\t\t\tvar resizers = layout.getCellsByType(\"resizer\");\n\n\t\t\t\tvar gridFirst = true;\n\t\t\t\tvar gridResizer;\n\t\t\t\tfor(var i = 0; i < resizers.length; i++){\n\t\t\t\t\tvar res = resizers[i];\n\t\t\t\t\tres._getSiblings();\n\t\t\t\t\tvar prev = res._behind;\n\t\t\t\t\tvar next = res._front;\n\t\t\t\t\tif(prev && prev.$content === grid || (prev.isChild && prev.isChild(grid))){\n\t\t\t\t\t\tgridResizer = res;\n\t\t\t\t\t\tgridFirst = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}else if(next && next.$content === grid || (next.isChild && next.isChild(grid))){\n\t\t\t\t\t\tgridResizer = res;\n\t\t\t\t\t\tgridFirst = false;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn {\n\t\t\t\t\tresizer: gridResizer,\n\t\t\t\t\tgridFirst: gridFirst\n\t\t\t\t};\n\t\t\t},\n\n\t\t\tonInitialized: function (layout) {\n\t\t\t\tvar grid = gantt.$ui.getView(\"grid\");\n\n\t\t\t\tvar resizeInfo = this._findGridResizer(layout, grid);\n\n\t\t\t\t// expose grid resize events\n\t\t\t\tif(resizeInfo.resizer){\n\t\t\t\t\tvar gridFirst = resizeInfo.gridFirst,\n\t\t\t\t\t\tnext = resizeInfo.resizer;\n\t\t\t\t\t\t\n\t\t\t\t\tif(next.$config.mode !== \"x\"){\n\t\t\t\t\t\treturn;// track only horizontal resize\n\t\t\t\t\t}\n\n\t\t\t\t\tvar initialWidth;\n\t\t\t\t\tnext.attachEvent(\"onResizeStart\", function(prevCellWidth, nextCellWidth){\n\n\t\t\t\t\t\tvar grid = gantt.$ui.getView(\"grid\");\n\t\t\t\t\t\tvar viewCell = grid ? grid.$parent : null;\n\t\t\t\t\t\tif(viewCell){\n\t\t\t\t\t\t\tvar limits = grid._getGridWidthLimits();\n\n\t\t\t\t\t\t\t// min grid width is defined by min widths of its columns, unless grid has horizontal scroll\n\t\t\t\t\t\t\tif(!grid.$config.scrollable)\n\t\t\t\t\t\t\t\tviewCell.$config.minWidth = limits[0];\n\n\t\t\t\t\t\t\tviewCell.$config.maxWidth = limits[1];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tinitialWidth = gridFirst ? prevCellWidth : nextCellWidth;\n\t\t\t\t\t\treturn gantt.callEvent(\"onGridResizeStart\", [initialWidth]);\n\t\t\t\t\t});\n\t\t\t\t\tnext.attachEvent(\"onResize\", function(newBehindSize, newFrontSize){\n\t\t\t\t\t\tvar newSize = gridFirst ? newBehindSize : newFrontSize;\n\t\t\t\t\t\treturn gantt.callEvent(\"onGridResize\", [initialWidth, newSize]);\n\t\t\t\t\t});\n\t\t\t\t\tnext.attachEvent(\"onResizeEnd\", function(oldBackSize, oldFrontSize, newBackSize, newFrontSize){\n\n\t\t\t\t\t\tvar oldSize = gridFirst ? oldBackSize : oldFrontSize;\n\t\t\t\t\t\tvar newSize = gridFirst ? newBackSize : newFrontSize;\n\t\t\t\t\t\tvar grid = gantt.$ui.getView(\"grid\");\n\t\t\t\t\t\tvar viewCell = grid ? grid.$parent : null;\n\t\t\t\t\t\tif(viewCell){\n\t\t\t\t\t\t\tviewCell.$config.minWidth = undefined;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar res = gantt.callEvent(\"onGridResizeEnd\", [oldSize, newSize]);\n\t\t\t\t\t\tif(res && newSize !== 0){// new size may be numeric zero when cell size is defined by 'gravity', actual size will be calculated by layout later\n\t\t\t\t\t\t\tgantt.config.grid_width = newSize;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn res;\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t},\n\t\t\tonDestroyed: function (timeline) {\n\n\t\t\t}\n\t\t};\n\n\t};\n})();\n\nexport default initializer;","import uiFactory from \"./ui_factory\";\nimport mouseEvents from \"./mouse\";\nimport createLayers from \"./gantt_layers\";\nimport Cell from \"./layout/cell\";\nimport Layout from \"./layout/layout\";\nimport ViewLayout from \"./layout/view_layout\";\nimport ViewCell from \"./layout/view_cell\";\nimport Resizer from \"./layout/resizer_cell\";\nimport Scrollbar from \"./layout/scrollbar_cell\";\nimport Timeline from \"./timeline/timeline\";\nimport Grid from \"./grid/grid\";\nimport ResourceGrid from \"./grid/resource_grid\";\nimport ResourceGridLightbox from \"./grid/resource_grid_lightbox\";\nimport ResourceTimeline from \"./timeline/resource_timeline\";\nimport ResourceHistogram from \"./timeline/resource_histogram\";\n\n\nimport gridEditorsFactory from \"./grid/editors/controller\";\n\nimport renderTaskBar from \"./render/task_bar_smart_render\";\nimport renderTimedProjectBar from \"./render/task_project_smart_render\";\nimport renderSplitTaskBar from \"./render/task_split_render\";\nimport renderRollupTaskBar from \"./render/task_rollup_render\";\nimport renderTaskBg from \"./render/task_bg_render\";\nimport renderLink from \"./render/link_render\";\nimport gridRenderer from \"./render/task_grid_line_render\";\nimport resourceMatrixRenderer from \"./render/resource_matrix_render\";\nimport resourceHistogramRenderer from \"./render/resource_histogram_render\";\nimport gridTaskRowResizerRenderer from \"./render/task_grid_row_resize_render\";\nimport renderConstraints from \"./render/task_constraints_render\";\nimport renderDeadline from \"./render/task_deadline_render\";\nimport renderBaselines from \"./render/task_baselines_render\";\nimport mainGridInitializer from \"./grid/main_grid_initializer\";\nimport mainTimelineInitializer from \"./timeline/main_timeline_initializer\";\nimport mainLayoutInitializer from \"./main_layout_initializer\";\n\nfunction initUI(gantt){\n\tfunction attachInitializer(view, initializer){\n\t\tvar ext = initializer(gantt);\n\t\tif(ext.onCreated)\n\t\t\text.onCreated(view);\n\t\tview.attachEvent(\"onReady\", function(){\n\t\t\tif(ext.onInitialized)\n\t\t\t\text.onInitialized(view);\n\t\t});\n\t\tview.attachEvent(\"onDestroy\", function(){\n\t\t\tif(ext.onDestroyed)\n\t\t\t\text.onDestroyed(view);\n\t\t});\n\t}\n\n\tvar factory = uiFactory.createFactory(gantt);\n\tfactory.registerView(\"cell\", Cell);\n\tfactory.registerView(\"resizer\", Resizer);\n\tfactory.registerView(\"scrollbar\", Scrollbar);\n\tfactory.registerView(\"layout\", Layout, function(view){\n\t\tvar id = view.$config ? view.$config.id : null;\n\t\tif(id === \"main\"){\n\t\t\tattachInitializer(view, mainLayoutInitializer);\n\t\t}\n\t});\n\tfactory.registerView(\"viewcell\", ViewCell);\n\tfactory.registerView(\"multiview\", ViewLayout);\n\tfactory.registerView(\"timeline\", Timeline, function(view){\n\t\tvar id = view.$config ? view.$config.id : null;\n\t\tif(id === \"timeline\" || view.$config.bind == \"task\"){\n\t\t\tattachInitializer(view, mainTimelineInitializer);\n\t\t}\n\t});\n\tfactory.registerView(\"grid\", Grid, function(view){\n\t\tvar id = view.$config ? view.$config.id : null;\n\t\tif(id === \"grid\" || view.$config.bind == \"task\"){\n\t\t\tattachInitializer(view, mainGridInitializer);\n\t\t}\n\t});\n\n\tfactory.registerView(\"resourceGrid\", ResourceGrid);\n\tfactory.registerView(\"GridRL\", ResourceGridLightbox);\n\tfactory.registerView(\"resourceTimeline\", ResourceTimeline);\n\tfactory.registerView(\"resourceHistogram\", ResourceHistogram);\n\n\tvar layersEngine = createLayers(gantt);\n\n\tvar inlineEditors = gridEditorsFactory(gantt);\n\n\tgantt.ext.inlineEditors = inlineEditors;\n\tgantt.ext._inlineEditors = inlineEditors;\n\tinlineEditors.init(gantt);\n\n\treturn {\n\t\tfactory:factory,\n\t\tmouseEvents: mouseEvents.init(gantt),\n\t\tlayersApi: layersEngine.init(),\n\t\trender:{\n\t\t\tgridLine: function(){\n\t\t\t\treturn gridRenderer(gantt);\n\t\t\t},\n\t\t\ttaskBg: function(){\n\t\t\t\treturn renderTaskBg(gantt);\n\t\t\t},\n\t\t\ttaskBar: function(){\n\t\t\t\treturn renderTaskBar(gantt);\n\t\t\t},\n\t\t\ttimedProjectBar: function(){\n\t\t\t\treturn renderTimedProjectBar(gantt);\n\t\t\t},\n\t\t\ttaskRollupBar: function() {\n\t\t\t\treturn renderRollupTaskBar(gantt);\n\t\t\t},\n\t\t\ttaskSplitBar: function(){\n\t\t\t\treturn renderSplitTaskBar(gantt);\n\t\t\t},\n\t\t\ttaskConstraints: function(){\n\t\t\t\treturn renderConstraints(gantt);\n\t\t\t},\n\t\t\ttaskDeadline: function(){\n\t\t\t\treturn renderDeadline(gantt);\n\t\t\t},\n\t\t\ttaskBaselines: function(){\n\t\t\t\treturn renderBaselines(gantt);\n\t\t\t},\n\t\t\tlink: function(){\n\t\t\t\treturn renderLink(gantt);\n\t\t\t},\n\t\t\tresourceRow: function(){\n\t\t\t\treturn resourceMatrixRenderer(gantt);\n\t\t\t},\n\t\t\tresourceHistogram: function(){\n\t\t\t\treturn resourceHistogramRenderer(gantt);\n\t\t\t},\n\t\t\tgridTaskRowResizer: function(){\n\t\t\t\treturn gridTaskRowResizerRenderer(gantt);\n\t\t\t}\n\t\t},\n\t\tlayersService: {\n\t\t\tgetDataRender: function(name){\n\t\t\t\treturn layersEngine.getDataRender(name, gantt);\n\t\t\t},\n\t\t\tcreateDataRender: function(config){\n\t\t\t\treturn layersEngine.createDataRender(config, gantt);\n\t\t\t}\n\t\t}\n\t};\n}\n\nexport default {\n\tinit: initUI\n};","import * as helpers from \"../../../utils/helpers\";\nimport getRowRectangle from \"./viewport/get_grid_row_rectangle\";\nimport getVisibleRange from \"./viewport/get_visible_bars_range\";\nimport isInViewPort from \"./viewport/is_grid_row_in_viewport\";\n\nfunction createGridLineRender(gantt){\n\n\tfunction _render_grid_item(item, view, config, viewport) {\n\t\tvar columns = view.getGridColumns();\n\t\tvar templates = view.$getTemplates();\n\n\t\tvar store = view.$config.rowStore;\n\n\t\tvar cells = [];\n\t\tvar has_child;\n\t\tfor (var i = 0; i < columns.length; i++) {\n\t\t\tvar last = i == columns.length - 1;\n\t\t\tvar col = columns[i];\n\t\t\tvar cell;\n\n\t\t\tvar value;\n\t\t\tvar textValue;\n\t\t\tif (col.name == \"add\") {\n\t\t\t\tvar aria = gantt._waiAria.gridAddButtonAttrString(col);\n\n\t\t\t\tvalue = \"<div \" + aria + \" class='gantt_add'></div>\";\n\t\t\t\ttextValue = \"\";\n\t\t\t} else {\n\t\t\t\tif (col.template)\n\t\t\t\t\tvalue = col.template(item);\n\t\t\t\telse\n\t\t\t\t\tvalue = item[col.name];\n\n\t\t\t\tif (helpers.isDate(value)){\n\t\t\t\t\tvalue = templates.date_grid(value, item, col.name);\n\t\t\t\t}\n\n\t\t\t\tif (value === null || value === undefined) {\n\t\t\t\t\tvalue = \"\";\n\t\t\t\t}\n\n\t\t\t\ttextValue = value;\n\t\t\t\tvalue = \"<div class='gantt_tree_content'>\" + value + \"</div>\";\n\t\t\t}\n\t\t\tvar css = \"gantt_cell\" + (last ? \" gantt_last_cell\" : \"\");\n\n\t\t\tvar tree = [];\n\t\t\tif (col.tree) {\n\t\t\t\tcss += \" gantt_cell_tree\";\n\t\t\t\tfor (var j = 0; j < item.$level; j++)\n\t\t\t\t\ttree.push(templates.grid_indent(item));\n\n\t\t\t\thas_child = store.hasChild(item.id) && !(gantt.isSplitTask(item) && !gantt.config.open_split_tasks);\n\t\t\t\tif (has_child) {\n\t\t\t\t\ttree.push(templates.grid_open(item));\n\t\t\t\t\ttree.push(templates.grid_folder(item));\n\t\t\t\t} else {\n\t\t\t\t\ttree.push(templates.grid_blank(item));\n\t\t\t\t\ttree.push(templates.grid_file(item));\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar style = \"width:\" + (col.width - (last ? 1 : 0)) + \"px;\";\n\t\t\tif (this.defined(col.align)){\n\t\t\t\tvar flexAlign = {\n\t\t\t\t\tright: \"flex-end\",\n\t\t\t\t\tleft: \"flex-start\",\n\t\t\t\t\tcenter: \"center\"\n\t\t\t\t};\n\t\t\t\tvar justifyContent = flexAlign[col.align];\n\n\t\t\t\tstyle += \"text-align:\" + col.align + \";justify-content:\"  + justifyContent + \";\";\n\t\t\t}\n\n\t\t\tvar aria = gantt._waiAria.gridCellAttrString(col, textValue, item);\n\n\t\t\ttree.push(value);\n\t\t\tcell = \"<div class='\" + css + \"' data-column-index='\"+i+\"' data-column-name='\"+col.name+\"' style='\" + style + \"' \" + aria + \">\" + tree.join(\"\") + \"</div>\";\n\t\t\tcells.push(cell);\n\t\t}\n\t\t// GS-291. The odd class should be assigned correctly\n\t\tcss = \"\";\n\t\tconst storeName = store.$config.name;\n\t\tswitch (storeName) {\n\t\t\tcase \"task\":\n\t\t\t\tcss = gantt.getGlobalTaskIndex(item.id) % 2 === 0 ? \"\" : \" odd\";\n\t\t\t\tbreak;\n\t\t\tcase \"resource\":\n\t\t\t\tcss = store.visibleOrder.indexOf(item.id) % 2 === 0 ? \"\" : \" odd\";\n\t\t\t\tbreak;\n\t\t}\n\n\t\tcss += (item.$transparent) ? \" gantt_transparent\" : \"\";\n\n\t\tcss += (item.$dataprocessor_class ? \" \" + item.$dataprocessor_class : \"\");\n\n\t\tif (templates.grid_row_class) {\n\t\t\tvar css_template = templates.grid_row_class.call(gantt, item.start_date, item.end_date, item);\n\t\t\tif (css_template)\n\t\t\t\tcss += \" \" + css_template;\n\t\t}\n\n\t\tif(store.isSelected(item.id)) {\n\t\t\tcss += \" gantt_selected\";\n\t\t}\n\n\t\tvar el = document.createElement(\"div\");\n\t\tel.className = \"gantt_row\" + css + \" gantt_row_\" + gantt.getTaskType(item.type);\n\t\tvar height = view.getItemHeight(item.id);\n\t\tel.style.height = height + \"px\";\n\t\tel.style.lineHeight = height + \"px\";\n\n\t\tif(config.smart_rendering){\n\t\t\tel.style.position = \"absolute\";\n\t\t\tel.style.left = \"0px\";\n\t\t\tel.style.top = view.getItemTop(item.id) + \"px\";\n\t\t}\n\n\t\tif(view.$config.item_attribute){\n\t\t\tel.setAttribute(view.$config.item_attribute, item.id);\n\t\t\tel.setAttribute(view.$config.bind + \"_id\", item.id); // 'task_id'/'resource_id' for backward compatibility\n\t\t}\n\n\t\tgantt._waiAria.taskRowAttr(item, el);\n\n\t\tel.innerHTML = cells.join(\"\");\n\t\treturn el;\n\t}\n\n\tfunction onrender(item, rowNode, view){\n\t\tvar columns = view.getGridColumns();\n\t\tfor (var i = 0; i < columns.length; i++) {\n\t\t\tvar column = columns[i];\n\t\t\tif (column.onrender){\n\n\t\t\t\t// find cell node for current column\n\t\t\t\tvar cellNode = rowNode.querySelector(`[data-column-name=\"${column.name}\"]`);\n\t\t\t\tif (cellNode) {\n\t\t\t\t\tvar content = column.onrender(item, cellNode);\n\t\t\t\t\tif (content && typeof content === \"string\") {\n\t\t\t\t\t\tcellNode.innerHTML = content;\n\t\t\t\t\t} else if (content && typeof content === \"object\") {\n\t\t\t\t\t\t// render object to node using additional functionality\n\t\t\t\t\t\tif (gantt.config.external_render){\n\t\t\t\t\t\t\tvar adapter = gantt.config.external_render;\n\t\t\t\t\t\t\tif (adapter.isElement(content)){\n\t\t\t\t\t\t\t\tadapter.renderElement(content, cellNode);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn {\n\t\trender: _render_grid_item,\n\t\tupdate: null,\n\t\tgetRectangle: getRowRectangle,\n\t\tisInViewPort: isInViewPort,\n\t\tgetVisibleRange: getVisibleRange,\n\t\tonrender: onrender\n\t};\n}\n\nexport default createGridLineRender;","import getRowRectangle from \"./viewport/get_bg_row_rectangle\";\nimport isLegacyRender from \"./is_legacy_smart_render\";\nimport getVisibleRange from \"./viewport/get_visible_bars_range\";\nimport getVisibleCellsRange from \"./viewport/get_visible_cells_range\";\nimport isColumnVisible from \"./viewport/is_column_visible\";\nimport bgPlaceholder from \"./prerender/task_bg_placeholder\";\n\nfunction createTaskBgRender(gantt){\n\tvar renderedCells = {};\n\tvar visibleCells = {};\n\n\tfunction isRendered(item, columnIndex){\n\t\tif(renderedCells[item.id][columnIndex] && renderedCells[item.id][columnIndex].parentNode){\n\t\t\treturn true;\n\t\t}else{\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tfunction detachRenderedCell(itemId, columnIndex){\n\t\tif(renderedCells[itemId] && renderedCells[itemId][columnIndex] &&\n\t\t\trenderedCells[itemId][columnIndex].parentNode\n\t\t\t){\n\t\t\t\trenderedCells[itemId][columnIndex].parentNode.removeChild(renderedCells[itemId][columnIndex]);\n\t\t\t}\n\t}\n\n\tfunction getCellClassTemplate(view){\n\t\tvar templates = view.$getTemplates();\n\t\tvar cssTemplate;\n\t\tif (typeof templates.task_cell_class !== \"undefined\") {\n\t\t\tcssTemplate = templates.task_cell_class;\n\t\t\t// eslint-disable-next-line no-console\n\t\t\tvar log = console.warn || console.log;\n\t\t\tlog('gantt.templates.task_cell_class template is deprecated and will be removed soon. Please use gantt.templates.timeline_cell_class instead.');\n\t\t} else {\n\t\t\tcssTemplate = templates.timeline_cell_class;\n\t\t}\n\t\treturn cssTemplate;\n\t}\n\tfunction getCellContentTemplate(view){\n\t\tvar templates = view.$getTemplates();\n\t\tvar contentTemplate = templates.timeline_cell_content;\n\t\treturn contentTemplate;\n\t}\n\n\tfunction renderCells(item, node, view, config, viewPort){\n\t\tvar cfg = view.getScale();\n\t\tvar count = cfg.count;\n\t\tvar cssTemplate = getCellClassTemplate(view);\n\t\tvar contentTemplate = getCellContentTemplate(view);\n\n\t\tif (config.show_task_cells) {\n\t\t\tif(!renderedCells[item.id]){\n\t\t\t\trenderedCells[item.id] = {};\n\t\t\t}\n\t\t\tif(!visibleCells[item.id]){\n\t\t\t\tvisibleCells[item.id] = {};\n\t\t\t}\n\n\t\t\tvar range = getVisibleCellsRange(cfg, viewPort);\n\n\t\t\tfor(var i in visibleCells[item.id]){\n\t\t\t\tvar index = visibleCells[item.id][i];\n\n\t\t\t\tif(Number(index) < range.start || Number(index) > range.end){\n\t\t\t\t\tdetachRenderedCell(item.id, index);\n\t\t\t\t}\n\t\t\t}\n\t\t\tvisibleCells[item.id] = {};\n\t\t\t// TODO: do not iterate all cell, only ones in the viewport and once that are already rendered\n\t\t\tfor (var columnIndex = range.start; columnIndex <= range.end; columnIndex++) {\n\t\t\t\tvar cell = renderOneCell(cfg, columnIndex, item, viewPort, count, cssTemplate, contentTemplate, config);\n\t\t\t\tif(!cell && isRendered(item, columnIndex)){\n\t\t\t\t\tdetachRenderedCell(item.id, columnIndex);\n\t\t\t\t}else if (cell && !cell.parentNode){\n\t\t\t\t\tnode.appendChild(cell);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction renderOneCell(scale, columnIndex, item, viewPort, count, cssTemplate, contentTemplate, config){\n\t\tvar width = scale.width[columnIndex],\n\t\t\tcssclass = \"\";\n\n\t\tif (isColumnVisible(columnIndex, scale, viewPort, gantt)) {//do not render skipped columns\n\n\t\t\tvar cssTemplateContent = cssTemplate(item, scale.trace_x[columnIndex]);\n\t\t\tvar htmlTemplateContent = \"\";\n\t\t\tif (contentTemplate) {// for backward compatibility, contentTemplate was added in 7.2.0+, will be undefined if someone used copy of old config/template object\n\t\t\t\thtmlTemplateContent = contentTemplate(item, scale.trace_x[columnIndex]);\n\t\t\t}\n\n\t\t\tif(config.static_background){\n\t\t\t\t// if cell render in static background is not allowed, or if it's a blank cell\n\t\t\t\tvar customCell = !!(cssTemplateContent || htmlTemplateContent);\n\t\t\t\tif(!(config.static_background_cells && customCell)){\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(renderedCells[item.id][columnIndex]){\n\t\t\t\tvisibleCells[item.id][columnIndex] = columnIndex;\n\t\t\t\treturn renderedCells[item.id][columnIndex];\n\t\t\t}\n\t\t\tvar cell = document.createElement(\"div\");\n\t\t\tcell.style.width = (width) + \"px\";\n\n\t\t\tcssclass = \"gantt_task_cell\" + (columnIndex == count - 1 ? \" gantt_last_cell\" : \"\");\n\t\t\tif (cssTemplateContent) {\n\t\t\t\tcssclass += \" \" + cssTemplateContent;\n\t\t\t}\n\t\t\tcell.className = cssclass;\n\n\t\t\tif (htmlTemplateContent) {\n\t\t\t\tcell.innerHTML = htmlTemplateContent;\n\t\t\t}\n\n\t\t\tcell.style.position = \"absolute\";\n\t\t\tcell.style.left = scale.left[columnIndex] + \"px\";\n\t\t\trenderedCells[item.id][columnIndex] = cell;\n\t\t\tvisibleCells[item.id][columnIndex] = columnIndex;\n\n\t\t\treturn cell;\n\t\t}\n\t\treturn null;\n\t}\n\n\tfunction _render_bg_line(item, view, config, viewPort) {\n\t\tvar templates = view.$getTemplates();\n\t\tvar cfg = view.getScale();\n\t\tvar count = cfg.count;\n\n\t\tif(config.static_background && !config.static_background_cells){\n\t\t\treturn null;\n\t\t}\n\n\t\tvar row = document.createElement(\"div\");\n\n\t\tvar cellCssTemplate = getCellClassTemplate(view);\n\t\tvar cellHtmlTemplate = getCellContentTemplate(view);\n\n\t\tvar range;\n\n\t\tif(!viewPort || !config.smart_rendering || isLegacyRender(gantt)){\n\t\t\trange = {\n\t\t\t\tstart: 0,\n\t\t\t\tend: count - 1\n\t\t\t};\n\t\t} else {\n\t\t\trange = getVisibleCellsRange(cfg, viewPort.x);\n\t\t}\n\t\tif (config.show_task_cells) {\n\t\t\trenderedCells[item.id] = {};\n\t\t\tvisibleCells[item.id] = {};\n\t\t\tfor (var columnIndex = range.start; columnIndex <= range.end; columnIndex++) {\n\t\t\t\tvar cell = renderOneCell(cfg, columnIndex, item, viewPort, count, cellCssTemplate, cellHtmlTemplate, config);\n\t\t\t\tif(cell){\n\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t// GS-291. The odd class should be assigned correctly\n\t\tconst store = view.$config.rowStore;\n\t\tconst odd = store.getIndexById(item.id) % 2 !== 0;\n\n\t\tvar cssTemplate = templates.task_row_class(item.start_date, item.end_date, item);\n\t\tvar css = \"gantt_task_row\" + (odd ? \" odd\" : \"\") + (cssTemplate ? ' ' + cssTemplate : '');\n\n\t\tif(store.isSelected(item.id)) {\n\t\t\tcss += \" gantt_selected\";\n\t\t}\n\n\t\trow.className = css;\n\n\t\tif (config.smart_rendering) {\n\t\t\trow.style.position = \"absolute\";\n\t\t\trow.style.top = view.getItemTop(item.id) + \"px\";\n\t\t\trow.style.width = \"100%\";\n\t\t}else{\n\t\t\trow.style.position = \"relative\";\n\t\t}\n\t\trow.style.height = (view.getItemHeight(item.id)) + \"px\";\n\n\t\tif (item.id == \"timeline_placeholder_task\"){\n\t\t\tvar placeholderTop = 0;\n\t\t\tif (item.lastTaskId){\n\t\t\t\tvar lastTaskTop = view.getItemTop(item.lastTaskId);\n\t\t\t\tvar lastTaskHeight = view.getItemHeight(item.lastTaskId);\n\t\t\t\tplaceholderTop = lastTaskTop + lastTaskHeight;\t\n\t\t\t}\n\n\t\t\tvar maxHeight = item.row_height || view.$task_data.offsetHeight;\n\n\t\t\tvar placeholderHeight = maxHeight - placeholderTop;\n\t\t\t// So that it won't exceed the placeholder timeline height\n\t\t\tif (placeholderHeight < 0){\n\t\t\t\tplaceholderHeight = 0;\n\t\t\t}\n\n\t\t\tif (config.smart_rendering) {\n\t\t\t\trow.style.top = placeholderTop + \"px\";\t\n\t\t\t}\n\t\t\trow.style.height = placeholderHeight + \"px\";\n\t\t}\n\n\n\t\tif(view.$config.item_attribute){\n\t\t\trow.setAttribute(view.$config.item_attribute, item.id);\n\t\t\trow.setAttribute(view.$config.bind + \"_id\", item.id); // 'task_id'/'resource_id' for backward compatibility\n\t\t}\n\n\t\treturn row;\n\t}\n\n\treturn {\n\t\trender: _render_bg_line,\n\t\tupdate: renderCells,\n\t\tgetRectangle: getRowRectangle,\n\t\tgetVisibleRange: getVisibleRange,\n\t\tprepareData: bgPlaceholder\n\t};\n}\n\nexport default createTaskBgRender;\n","import isInViewPort from \"./viewport/is_bar_in_viewport\";\nimport getVisibleRange from \"./viewport/get_visible_bars_range\";\nimport createBaseBarRender from \"./task_bar_render\";\n\nexport default function createTaskRenderer(gantt){\n\tvar defaultRender = createBaseBarRender(gantt);\n\treturn {\n\t\trender: defaultRender,\n\t\tupdate: null,\n\t\t//getRectangle: getBarRectangle\n\t\tisInViewPort: isInViewPort,\n\t\tgetVisibleRange: getVisibleRange\n\t};\n};","import isInViewPort from \"./viewport/is_project_bar_in_viewport\";\nimport getVisibleRange from \"./viewport/get_visible_bars_range\";\nimport createBaseBarRender from \"./task_project_render\";\n\nexport default function createTaskRenderer(gantt){\n\tvar defaultRender = createBaseBarRender(gantt);\n\treturn {\n\t\trender: defaultRender,\n\t\tupdate: null,\n\t\t//getRectangle: getBarRectangle\n\t\tisInViewPort: isInViewPort,\n\t\tgetVisibleRange: getVisibleRange\n\t};\n};","import createBaseBarRender from \"./task_bar_render\";\nimport isInViewPort from \"./viewport/is_bar_in_viewport\";\nimport getVisibleRange from \"./viewport/get_visible_bars_range\";\n\nfunction createTaskRenderer(gantt){\n\tconst defaultRender = createBaseBarRender(gantt);\n\n\tconst renderedNodes = {};\n\n\tfunction checkVisibility(child, viewPort, timeline, config, gantt){\n\t\tlet isVisible = true;\n\t\t// GS-2123. Don't render rollup tasks that are outside the viewport\n\t\tif (config.smart_rendering){\n\t\t\tisVisible = isInViewPort(child, viewPort, timeline, config, gantt);\n\t\t}\n\t\treturn isVisible;\n\t}\n\n\tfunction generateChildElement(task, child, timeline, sizes){\n\t\tconst childCopy = gantt.copy(gantt.getTask(child.id));\n\t\tchildCopy.$rendered_at = task.id;\n\t\t// a way to filter rollup tasks:\n\t\tconst displayRollup = gantt.callEvent(\"onBeforeRollupTaskDisplay\", [childCopy.id, childCopy, task.id]);\n\t\tif (displayRollup === false){\n\t\t\treturn;\n\t\t}\n\n\t\tconst element = defaultRender(childCopy, timeline);\n\t\tif(!element){\n\t\t\treturn;\n\t\t}\n\n\t\tconst height = timeline.getBarHeight(task.id, child.type == gantt.config.types.milestone);\n\t\tconst padding = Math.floor((timeline.getItemHeight(task.id) - height) / 2);\n\n\t\telement.style.top = (sizes.top + padding) + \"px\";\n\t\telement.classList.add(\"gantt_rollup_child\");\n\t\telement.setAttribute(\"data-rollup-parent-id\", task.id);\n\n\t\treturn element;\n\t}\n\n\tfunction getKey(childId, renderParentId){\n\t\treturn childId + \"_\" + renderParentId;\n\t}\n\n\n\tfunction renderRollupTask(task, timeline, config, viewPort) {\n\t\tif (task.rollup !== false && task.$rollup && task.$rollup.length) {\n\t\t\tconst el = document.createElement('div'),\n\t\t\t\tsizes = gantt.getTaskPosition(task);\n\n\t\t\t// vertical position is not important for the rollup tasks as long as the parent is rendered\n\t\t\tif (viewPort){\n\t\t\t\tviewPort.y = 0;\n\t\t\t\tviewPort.y_end = gantt.$task_bg.scrollHeight;\n\t\t\t}\n\n\t\t\ttask.$rollup.forEach(function(itemId){\n\t\t\t\tif (!gantt.isTaskExists(itemId)){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst child = gantt.getTask(itemId);\n\t\t\t\tlet isVisible = checkVisibility(child, viewPort, timeline, config, gantt);\n\t\t\t\tif (!isVisible){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst element = generateChildElement(task, child, timeline, sizes);\n\t\t\t\tif (element) {\n\t\t\t\t\trenderedNodes[getKey(child.id, task.id)] = element;\n\t\t\t\t\tel.appendChild(element);\n\t\t\t\t} else{\n\t\t\t\t\trenderedNodes[getKey(child.id, task.id)] = false;\n\t\t\t\t}\n\n\t\t\t});\n\n\t\t\treturn el;\n\t\t}\n\t\treturn false;\n\t}\n\n\tfunction repaintRollupTask(task, itemNode, timeline, config, viewPort) {\n\t\tconst el = document.createElement(\"div\"),\n\t\tsizes = gantt.getTaskPosition(task);\n\n\t\t// vertical position is not important for the rollup tasks as long as the parent is rendered\n\t\tviewPort.y = 0;\n\t\tviewPort.y_end = gantt.$task_bg.scrollHeight;\n\n\t\ttask.$rollup.forEach(function(itemId){\n\t\t\tconst child = gantt.getTask(itemId);\n\t\t\tconst rollupKey = getKey(child.id, task.id);\n\t\t\tlet isVisible = checkVisibility(child, viewPort, timeline, config, gantt);\n\t\t\tif (isVisible !== !!renderedNodes[rollupKey]) {\n\n\t\t\t\tif (isVisible) {\n\t\t\t\t\tconst element = generateChildElement(task, child, timeline, sizes);\n\t\t\t\t\trenderedNodes[rollupKey] = element || false;\n\t\t\t\t} else {\n\t\t\t\t\trenderedNodes[rollupKey] = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!!renderedNodes[rollupKey]) {\n\t\t\t\tel.appendChild(renderedNodes[rollupKey]);\n\t\t\t}\n\t\t\titemNode.innerHTML = \"\";\n\t\t\titemNode.appendChild(el);\n\t\t});\n\t}\n\n\n\n\treturn {\n\t\trender: renderRollupTask,\n\t\tupdate: repaintRollupTask,\n\t\t//getRectangle: getBarRectangle\n\t\tisInViewPort: isInViewPort,\n\t\tgetVisibleRange: getVisibleRange\n\t};\n}\n\nexport default createTaskRenderer;","\nimport createBaseBarRender from \"./task_bar_render\";\n//import isInViewPort from \"./viewport/is_split_task_in_viewport\";\nimport getVisibleRange from \"./viewport/get_visible_bars_range\";\n\nimport isInViewPortParent from \"./viewport/is_split_task_in_viewport\";\nimport isInViewPortChild from \"./viewport/is_bar_in_viewport\";\nimport { childrenHaveBaselines, getMilestoneHeight, getInvertedMilestoneHeight } from \"./baseline_helper\";\nimport SplitTasksHelper from \"../../common/split_task_helpers\";\n\n\nfunction createTaskRenderer(gantt){\n\tconst defaultRender = createBaseBarRender(gantt);\n\tconst splitTasksHelper = new SplitTasksHelper(gantt.$data.tasksStore);\n\n\tconst renderedNodes = {};\n\n\tfunction checkVisibility(child, viewPort, timeline, config, gantt){\n\t\tlet isVisible = !child.hide_bar;\n\t\t// GS-1195. Don't render split tasks that are outside the viewport\n\t\tif (config.smart_rendering && isVisible){\n\t\t\tisVisible = isInViewPortChild(child, viewPort, timeline, config, gantt);\n\t\t}\n\t\treturn isVisible;\n\t}\n\n\tfunction generateChildElement(task, child, timeline, sizes, childBaselines){\n\t\tif(child.hide_bar){\n\t\t\treturn;\n\t\t}\n\n\t\tconst isProject = gantt.isSummaryTask(child);\n\t\tif(isProject){\n\t\t\tgantt.resetProjectDates(child);\n\t\t}\n\n\t\tconst childCopy = gantt.copy(gantt.getTask(child.id));\n\t\tchildCopy.$rendered_at = task.id;\n\t\t// a way to filter split tasks:\n\t\tconst showSplitTask = gantt.callEvent(\"onBeforeSplitTaskDisplay\", [childCopy.id, childCopy, task.id]);\n\t\tif (showSplitTask === false){\n\t\t\treturn;\n\t\t}\n\n\t\tconst element = defaultRender(childCopy, timeline);\n\t\tif(!element)\n\t\t\treturn;\n\n\t\tconst milestoneChild = child.type === gantt.config.types.milestone;\n\t\tlet milestoneWidth;\n\n\t\tconst parentHeight = sizes.rowHeight;\n\t\tconst childHeight = timeline.getBarHeight(childCopy.id, milestoneChild);\n\t\tlet padding = Math.floor((timeline.getItemHeight(task.id) - childHeight) / 2);\n\n\t\tif (milestoneChild){\n\t\t\tmilestoneWidth = getMilestoneHeight(childHeight);\n\t\t}\n\n\t\tif (childBaselines/*|| (child.bar_height !== \"full\" && child.bar_height < child.row_height)*/){\n\t\t\tif (milestoneChild){\n\t\t\t\tpadding = Math.floor((milestoneWidth - childHeight) / 2) + 2;\n\t\t\t} else {\n\t\t\t\tpadding = 2;\n\t\t\t}\t\n\t\t}\n\t\t// GS-2270: Split children shouldn't exceed the parent row height\n\t\tconst linkDragLeft = element.querySelector(\".gantt_link_control.task_start_date\");\n\t\tconst linkDragRight = element.querySelector(\".gantt_link_control.task_end_date\");\n\t\tif (milestoneChild){\n\t\t\tif (milestoneWidth > parentHeight){\n\t\t\t\tpadding = 2;\n\t\t\t\telement.style.height = parentHeight - padding + \"px\";\n\t\t\t\tconst offsetHeight = getInvertedMilestoneHeight(parentHeight);\n\t\t\t\tconst offsetMargin = (offsetHeight - parentHeight) / 2;\n\t\t\t\tconst taskContent = element.querySelector(\".gantt_task_content\");\n\t\t\t\tpadding = Math.abs(offsetMargin);\n\n\t\t\t\tlinkDragLeft.style.marginLeft = offsetMargin + \"px\";\n\t\t\t\tlinkDragRight.style.marginRight = offsetMargin + \"px\";\n\t\t\t\tlinkDragLeft.style.height = linkDragRight.style.height = offsetHeight + \"px\";\n\n\t\t\t\telement.style.width = \n\t\t\t\ttaskContent.style.height = \n\t\t\t\ttaskContent.style.width = offsetHeight + \"px\";\n\t\t\t\telement.style.left = timeline.getItemPosition(childCopy).left - offsetHeight / 2 + \"px\";\n\t\t\t}\n\t\t} else if (childHeight + padding > parentHeight){\n\t\t\tpadding = 0;\n\t\t\telement.style.height = \n\t\t\telement.style.lineHeight = \n\t\t\tlinkDragLeft.style.height = \n\t\t\tlinkDragRight.style.height = parentHeight + \"px\";\n\t\t}\n\n\t\telement.style.top = (sizes.top + padding) + \"px\";\n\t\telement.classList.add(\"gantt_split_child\");\n\t\tif(isProject){\n\t\t\telement.classList.add(\"gantt_split_subproject\");\n\t\t}\n\n\t\treturn element;\n\t}\n\n\tfunction getKey(childId, renderParentId){\n\t\treturn childId + \"_\" + renderParentId;\n\t}\n\n\tfunction shouldUseSplitRendering(task, config){\n\t\treturn (gantt.isSplitTask(task) && ((config.open_split_tasks && !task.$open) || !config.open_split_tasks) && gantt.hasChild(task.id));\n\t}\n\n\tfunction renderSplitTask(task, timeline, config, viewPort) {\n\t\tif (shouldUseSplitRendering(task, config)) {\n\t\t\tconst el = document.createElement('div'),\n\t\t\t\tsizes = gantt.getTaskPosition(task);\n\n\t\t\tconst childBaselines = childrenHaveBaselines(gantt, task.id);\n\n\t\t\tif(gantt.hasChild(task.id)){\n\n\t\t\t\tgantt.eachTask(function(child){\n\t\t\t\t\tlet isVisible = checkVisibility(child, viewPort, timeline, config, gantt);\n\t\t\t\t\tif (!isVisible){\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\t// GS-902: render only split-child tasks and inline-child tasks in parent\n\t\t\t\t\tif(splitTasksHelper.isDefaultSplitItem(child) || splitTasksHelper.isInlineSplitItem(child)){\n\t\t\t\t\t\tconst element = generateChildElement(task, child, timeline, sizes, childBaselines);\n\t\t\t\t\t\tif (element) {\n\t\t\t\t\t\t\trenderedNodes[getKey(child.id, task.id)] = element;\n\t\t\t\t\t\t\tel.appendChild(element);\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\trenderedNodes[getKey(child.id, task.id)] = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}, task.id);\n\n\t\t\t}\n\t\t\treturn el;\n\t\t\t\n\t\t}\n\t\t// GS-902: custom logic for inline-child tasks\n\t\tif(gantt.isSplitTask(task) && gantt.hasChild(task.id)){\n\t\t\tconst el = document.createElement('div'),\n\t\t\tsizes = gantt.getTaskPosition(task);\n\t\t\tconst childBaselines = childrenHaveBaselines(gantt, task.id);\n\t\t\tgantt.eachTask(function(child){\n\t\t\t\tlet isVisible = checkVisibility(child, viewPort, timeline, config, gantt);\n\t\t\t\tif (!isVisible){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif(splitTasksHelper.isInlineSplitItem(child)){\n\t\t\t\t\tconst element = generateChildElement(task, child, timeline, sizes, childBaselines);\n\t\t\t\t\tif (element) {\n\t\t\t\t\t\trenderedNodes[getKey(child.id, task.id)] = element;\n\t\t\t\t\t\tel.appendChild(element);\n\t\t\t\t\t}else{\n\t\t\t\t\t\trenderedNodes[getKey(child.id, task.id)] = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}, task.id);\n\t\t\treturn el;\n\t\t}\n\t\treturn false;\n\t}\n\tfunction repaintSplitTask(task, itemNode, timeline, config, viewPort) {\n\t\tif (shouldUseSplitRendering(task, config)) {\n\t\t\tconst el = document.createElement(\"div\"),\n\t\t\tsizes = gantt.getTaskPosition(task);\n\n\t\t\tconst childBaselines = childrenHaveBaselines(gantt, task.id);\n\t\t\tgantt.eachTask(function (child) {\n\t\t\t\tconst splitKey = getKey(child.id, task.id);\n\t\t\t\tlet isVisible = checkVisibility(child, viewPort, timeline, config, gantt);\n\t\t\t\t// GS-902: repaint split-child tasks and inline-child tasks in parent\n\t\t\t\tif(splitTasksHelper.isDefaultSplitItem(child) || splitTasksHelper.isInlineSplitItem(child)){\n\t\t\t\t\tif (isVisible !== !!renderedNodes[splitKey]) {\n\n\t\t\t\t\t\tif (isVisible) {\n\t\t\t\t\t\t\tconst element = generateChildElement(task, child, timeline, sizes, childBaselines);\n\t\t\t\t\t\t\trenderedNodes[splitKey] = element || false;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\trenderedNodes[splitKey] = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (!!renderedNodes[splitKey]) {\n\t\t\t\t\tel.appendChild(renderedNodes[splitKey]);\n\t\t\t\t}\n\t\t\t\titemNode.innerHTML = \"\";\n\t\t\t\titemNode.appendChild(el);\n\t\t\t}, task.id);\n\t\t}\n\t\t// GS-902: custom logic for inline-child tasks\n\t\tif(gantt.isSplitTask(task) && gantt.hasChild(task.id)){\n\t\t\tconst el = document.createElement('div'),\n\t\t\tsizes = gantt.getTaskPosition(task);\n\t\t\tconst childBaselines = childrenHaveBaselines(gantt, task.id);\n\t\t\tgantt.eachTask(function(child){\n\t\t\t\tlet isVisible = checkVisibility(child, viewPort, timeline, config, gantt);\n\t\t\t\tif (!isVisible){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif(splitTasksHelper.isInlineSplitItem(child)){\n\t\t\t\t\tconst element = generateChildElement(task, child, timeline, sizes, childBaselines);\n\t\t\t\t\tif (element) {\n\t\t\t\t\t\trenderedNodes[getKey(child.id, task.id)] = element;\n\t\t\t\t\t\tel.appendChild(element);\n\t\t\t\t\t}else{\n\t\t\t\t\t\trenderedNodes[getKey(child.id, task.id)] = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}, task.id);\n\n\t\t}\n\t}\n\treturn {\n\t\trender: renderSplitTask,\n\t\tupdate: repaintSplitTask,\n\t\tisInViewPort: isInViewPortParent,\n\t\tgetVisibleRange: getVisibleRange\n\t};\n}\n\nexport default createTaskRenderer;","import getRectangle from \"./viewport/get_bg_row_rectangle\";\nimport getVisibleRange from \"./viewport/get_visible_bars_range\";\nimport getVisibleCellsRange from \"./viewport/get_visible_cells_range\";\nimport isColumnVisible from \"./viewport/is_column_visible\";\nimport resourceTimetable from \"../../resource_timetable_builder\";\n\nfunction generateRenderResourceLine(gantt){\n\tvar getResourceLoad = resourceTimetable(gantt);\n\tvar renderedResourceLines = {};\n\n\tfunction renderResourceLineCell(resource, day, templates, config, timeline){\n\t\tvar css = templates.resource_cell_class(day.start_date, day.end_date, resource, day.tasks, day.assignments);\n\t\tvar content = templates.resource_cell_value(day.start_date, day.end_date, resource, day.tasks, day.assignments);\n\t\tvar height = timeline.getItemHeight(resource.id) - 1;\n\n\t\tif (css || content){\n\t\t\tvar sizes = timeline.getItemPosition(resource, day.start_date, day.end_date);\n\t\t\tvar el = document.createElement('div');\n\t\t\tel.setAttribute(timeline.$config.item_attribute, resource.id);\n\t\t\tel.className = [\"gantt_resource_marker\", css].join(\" \");\n\n\t\t\tel.style.cssText = [\n\t\t\t\t'left:' + sizes.left + 'px',\n\t\t\t\t'width:' + sizes.width + 'px',\n\t\t\t\t'height:' + (height) + 'px',\n\t\t\t\t'line-height:' + (height) + 'px',\n\t\t\t\t'top:' + sizes.top + 'px'\n\t\t\t].join(\";\");\n\n\t\t\tif(content)\n\t\t\t\tel.innerHTML = content;\n\n\t\t\treturn el;\n\t\t}\n\t\treturn null;\n\t}\n\n\tfunction detachRenderedResourceLine(id, index){\n\t\tif(renderedResourceLines[id] && renderedResourceLines[id][index] &&\n\t\t\trenderedResourceLines[id][index].parentNode\n\t\t\t){\n\t\t\t\trenderedResourceLines[id][index].parentNode.removeChild(renderedResourceLines[id][index]);\n\t\t\t}\n\t}\n\n\tfunction renderResourceLine(resource, timeline, config, viewport) {\n\t\tvar templates = timeline.$getTemplates();\n\t\tvar scale = timeline.getScale();\n\t\tvar timetable = getResourceLoad(resource, config.resource_property, timeline.getScale(), timeline);\n\t\tvar smartRendering = !!viewport;//no viewport means smart rendering is disabled\n\t\tvar cells = [];\n\t\trenderedResourceLines[resource.id] = {};\n\n\t\tvar range = getVisibleCellsRange(scale, viewport);\n\t\tfor (var columnIndex = range.start; columnIndex <= range.end; columnIndex++) {\n\n\t\t\tvar day = timetable[columnIndex];\n\t\t\tif(!day){\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif(smartRendering && !isColumnVisible(columnIndex, scale, viewport, gantt)){\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tvar cell = renderResourceLineCell(resource, day, templates, config, timeline);\n\t\t\tif(cell){\n\t\t\t\tcells.push(cell);\n\t\t\t\trenderedResourceLines[resource.id][columnIndex] = cell;\n\t\t\t}\n\t\t}\n\n\t\tvar row = null;\n\t\tif(cells.length){\n\t\t\trow = document.createElement(\"div\");\n\t\t\tfor(var i = 0; i < cells.length; i++){\n\t\t\t\trow.appendChild(cells[i]);\n\t\t\t}\n\t\t}\n\t\treturn row;\n\t}\n\n\tfunction updateResourceLine(resource, node, timeline, config, viewport) {\n\t\tvar templates = timeline.$getTemplates();\n\t\tvar scale = timeline.getScale();\n\t\tvar timetable = getResourceLoad(resource, config.resource_property, timeline.getScale(), timeline);\n\n\t\tvar range = getVisibleCellsRange(scale, viewport);\n\n\t\tvar checkedColumns = {};\n\t\tif(renderedResourceLines && renderedResourceLines[resource.id]){\n\t\t\tfor(var i in renderedResourceLines[resource.id]){\n\t\t\t\tcheckedColumns[i] = i;\n\t\t\t}\n\t\t}\n\n\t\tfor (var columnIndex = range.start; columnIndex <= range.end; columnIndex++) {\n\t\t\tvar day = timetable[columnIndex];\n\t\t\tcheckedColumns[columnIndex] = false;\n\t\t\tif(!day){\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif(!isColumnVisible(columnIndex, scale, viewport, gantt)){\n\t\t\t\tdetachRenderedResourceLine(resource.id, columnIndex);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif(!renderedResourceLines[resource.id] || !renderedResourceLines[resource.id][columnIndex]){\n\t\t\t\tvar cell = renderResourceLineCell(resource, day, templates, config, timeline);\n\t\t\t\tif(cell){\n\t\t\t\t\tnode.appendChild(cell);\n\t\t\t\t\trenderedResourceLines[resource.id][columnIndex] = cell;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if(renderedResourceLines[resource.id] && renderedResourceLines[resource.id][columnIndex] && !renderedResourceLines[resource.id][columnIndex].parentNode){\n\t\t\t\tnode.appendChild(renderedResourceLines[resource.id][columnIndex]);\n\t\t\t}\n\t\t}\n\n\t\tfor(var i in checkedColumns){\n\t\t\tif(checkedColumns[i] !== false){\n\t\t\t\tdetachRenderedResourceLine(resource.id, i);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn {\n\t\trender: renderResourceLine,\n\t\tupdate: updateResourceLine,\n\t\tgetRectangle: getRectangle,\n\t\tgetVisibleRange: getVisibleRange\n\t};\n}\n\nexport default generateRenderResourceLine;","import getRowRectangle from \"./viewport/get_grid_row_rectangle\";\nimport getVisibleRange from \"./viewport/get_visible_bars_range\";\n\nfunction createGridTaskRowResizerRender(gantt){\n\n\tfunction _render_grid_item(item, view, viewport) {\n\n\t\tvar config = view.$getConfig();\n\t\tvar resize_el = document.createElement(\"div\");\n\t\tresize_el.className = \"gantt_task_grid_row_resize_wrap\";\n\n\t\tresize_el.style.top = (view.getItemTop(item.id) + view.getItemHeight(item.id)) + \"px\";\n\n\t\tresize_el.innerHTML = \"<div class='gantt_task_grid_row_resize' role='cell'></div>\";\n\t\tresize_el.setAttribute(config.task_grid_row_resizer_attribute, item.id);\n\n\t\tgantt._waiAria.rowResizerAttr(resize_el);\n\t\treturn resize_el;\n\t}\n\n\treturn {\n\t\trender: _render_grid_item,\n\t\tupdate: null,\n\t\tgetRectangle: getRowRectangle,\n\t\tgetVisibleRange: getVisibleRange\n\t};\n}\n\nexport default createGridTaskRowResizerRender;","function _configure(col, data, force) {\n\tfor (var key in data)\n\t\tif (typeof col[key] == \"undefined\" || force)\n\t\t\tcol[key] = data[key];\n}\n\nfunction _get_skin(force, gantt) {\n\n\tconst styles = getComputedStyle(gantt.$root);\n\tconst themeVar = styles.getPropertyValue(\"--dhx-gantt-theme\");\n\tlet isCssVarTheme = !!themeVar;\n\tlet themeName;\n\n\t\n\tif(isCssVarTheme){\n\t\tthemeName = themeVar;\n\t}else{\n\t\tvar skin = gantt.skin;\n\t\tthemeName = skin;\n\t\tif (!skin || force) {\n\t\t\tvar links = document.getElementsByTagName(\"link\");\n\t\t\tfor (var i = 0; i < links.length; i++) {\n\t\t\t\tvar res = links[i].href.match(\"dhtmlxgantt_([a-z_]+).css\");\n\t\t\t\tif (res) {\n\t\t\t\t\tif (gantt.skins[res[1]] || !skin) {\n\t\t\t\t\t\tthemeName = res[1];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tgantt._theme_info = {\n\t\ttheme: themeName,\n\t\tcssVarTheme: isCssVarTheme\n\t};\n\n\n\n\tgantt.skin = themeName || \"terrace\";\n\tvar skinset = gantt.skins[gantt.skin] || gantt.skins[\"terrace\"];\n\n\t//apply skin related settings\n\t_configure(gantt.config, skinset.config, force);\n\n\tif(!isCssVarTheme){\n\t\tgantt.config.link_radius = 1;\n\t}\n\n\tvar config = gantt.getGridColumns();\n\tif (config[1] && !gantt.defined(config[1].width))\n\t\tconfig[1].width = skinset._second_column_width;\n\tif (config[2] && !gantt.defined(config[2].width))\n\t\tconfig[2].width = skinset._third_column_width;\n\t\n\tfor (var i=0; i<config.length; i++) {\n\t\tvar column = config[i];\n\t\tif (column.name == \"add\") {\n\t\t\tif(!column.width){\n\t\t\t\tcolumn.width = 44;\n\t\t\t}\n\t\t\tif (!(gantt.defined(column.min_width) && gantt.defined(column.max_width))) {\n\t\t\t\tcolumn.min_width = column.min_width || column.width;\n\t\t\t\tcolumn.max_width = column.max_width || column.width;\n\t\t\t}\n\t\t\tif (column.min_width)\n\t\t\t\tcolumn.min_width = +column.min_width;\n\t\t\tif (column.max_width)\n\t\t\t\tcolumn.max_width = +column.max_width;\n\t\t\tif (column.width) {\n\t\t\t\tcolumn.width = +column.width;\n\t\t\t\tcolumn.width = (column.min_width && column.min_width > column.width) ? column.min_width : column.width;\n\t\t\t\tcolumn.width = (column.max_width && column.max_width < column.width) ? column.max_width : column.width;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (skinset.config.task_height){\n\t\tgantt.config.task_height = skinset.config.task_height || \"full\";\n\t}\n\tif (skinset.config.bar_height){\n\t\tgantt.config.bar_height = skinset.config.bar_height || \"full\";\n\t}\n\n\tif (skinset._lightbox_template)\n\t\tgantt._lightbox_template = skinset._lightbox_template;\n\n\tif (skinset._redefine_lightbox_buttons) {\n\t\tgantt.config.buttons_right = skinset._redefine_lightbox_buttons[\"buttons_right\"];\n\t\tgantt.config.buttons_left = skinset._redefine_lightbox_buttons[\"buttons_left\"];\n\t}\n\n\n\tgantt.resetLightbox();\n}\n\n\n\nexport default function(gantt) {\n\t\n\tif(!gantt.resetSkin){\n\t\tgantt.resetSkin = function () {\n\t\t\tthis.skin = \"\";\n\t\t\t_get_skin(true, this);\n\t\t};\n\t\tgantt.skins = {};\n\n\t\tgantt.attachEvent(\"onGanttLayoutReady\", function(){\n\t\t\t_get_skin(false, this);\n\t\t\tmonitorThemeChange();\n\t\t});\n\t}\n\n\tgantt._addThemeClass = function(){\n\t\tdocument.documentElement.setAttribute(\"data-gantt-theme\", gantt.skin);\n\t};\n\n\tgantt.setSkin = function(value){\n\t\tconst skinChanged = this.skin !== value;\n\t\tthis.skin = value;\n\t\tgantt._addThemeClass();\n\t\tmonitorThemeChange();\n\t\tif(gantt.$root){\n\t\t\t_get_skin(skinChanged ? false : true, gantt);\n\t\t\tthis.render();\n\t\t}\n\t\t\n\t\t//\n\t};\n\n\n\tlet monitorIntervalId = null;\n\tfunction monitorThemeChange(){\n\t\tconst container = gantt.$root;\n\t\t\n\t\tif(monitorIntervalId){\n\t\t\tclearInterval(monitorIntervalId);\n\t\t}\n\t\t\n\t\tif(container){\n\t\t\tmonitorIntervalId = setInterval(() => {\n\t\t\t\tconst csstheme = getComputedStyle(container).getPropertyValue('--dhx-gantt-theme');\n\t\t\t\tif(csstheme && csstheme !== gantt.skin){\n\t\t\t\t\tgantt.setSkin(csstheme);\n\t\t\t\t}\n\n\t\t\t}, 100);\n\t\t}\n\t}\n\tgantt.attachEvent(\"onDestroy\", function(){\n\t\tclearInterval(monitorIntervalId);\n\t});\n};","import * as domHelpers from \"../utils/dom_helpers\";\nimport isHeadless from \"../../../utils/is_headless\";\n\nexport default function(gantt){\n\n\tvar scrollRange = 50,\n\t\tscrollStep = 30,\n\t\tscrollDelay = 10,\n\t\tscrollSpeed = 50;\n\n\tvar interval = null,\n\t\tisMove = false,\n\t\tdelayTimeout = null,\n\t\tstartPos = {\n\t\t\tstarted: false\n\t\t},\n\t\teventPos = {};\n\n\n\tfunction isDisplayed(element){\n\t\treturn element &&\n\t\t\tdomHelpers.isChildOf(element, gantt.$root) &&\n\t\t\telement.offsetHeight;\n\t}\n\n\tfunction getAutoscrollContainer(){\n\t\tvar element;\n\t\tif(isDisplayed(gantt.$task)){\n\t\t\telement = gantt.$task;\n\t\t}else if(isDisplayed(gantt.$grid)){\n\t\t\telement = gantt.$grid;\n\t\t}else{\n\t\t\telement = gantt.$root;\n\t\t}\n\n\t\treturn element;\n\t}\n\n\tfunction isScrollState() {\n\t\tvar dragMarker = !!document.querySelector(\".gantt_drag_marker\");\n\t\tvar isResize = !!document.querySelector(\".gantt_drag_marker.gantt_grid_resize_area\")\n\t\t\t|| !!document.querySelector(\".gantt_drag_marker.gantt_row_grid_resize_area\") ;\n\t\tvar isLink = !!document.querySelector(\".gantt_link_direction\");\n\t\tvar state = gantt.getState();\n\t\tvar isClickDrag = state.autoscroll;\n\t\tisMove = dragMarker && !isResize && !isLink;\n\n\t\treturn !((!state.drag_mode && !dragMarker) || isResize) || isClickDrag;\n\t}\n\n\tfunction defineDelayTimeout(state) {\n\t\tif (delayTimeout) {\n\t\t\tclearTimeout(delayTimeout);\n\t\t\tdelayTimeout = null;\n\t\t}\n\t\tif (state) {\n\t\t\tvar speed = gantt.config.autoscroll_speed;\n\t\t\tif (speed && speed < 10) // limit speed value to 10\n\t\t\t\tspeed = 10;\n\n\t\t\tdelayTimeout = setTimeout(function() {\n\t\t\t\tinterval = setInterval(tick, speed || scrollSpeed);\n\t\t\t}, gantt.config.autoscroll_delay || scrollDelay);\n\t\t}\n\t}\n\n\tfunction defineScrollInterval(state) {\n\t\tif (state) {\n\t\t\tdefineDelayTimeout(true);\n\t\t\tif (!startPos.started) {\n\t\t\t\tstartPos.x = eventPos.x;\n\t\t\t\tstartPos.y = eventPos.y;\n\t\t\t\tstartPos.started = true;\n\t\t\t}\n\t\t} else {\n\t\t\tif (interval) {\n\t\t\t\tclearInterval(interval);\n\t\t\t\tinterval = null;\n\t\t\t}\n\t\t\tdefineDelayTimeout(false);\n\t\t\tstartPos.started = false;\n\t\t}\n\t}\n\n\tfunction autoscrollInterval(event) {\n\t\tvar isScroll = isScrollState();\n\n\t\tif ((interval || delayTimeout) && !isScroll) {\n\t\t\tdefineScrollInterval(false);\n\t\t}\n\n\t\tif (!gantt.config.autoscroll || !isScroll) {\n\t\t\treturn false;\n\t\t}\n\n\t\teventPos = {\n\t\t\tx: event.clientX,\n\t\t\ty: event.clientY\n\t\t};\n\n\t\t// if it is a mobile device, we need to detect the touch event coords\n\t\tif (event.type == \"touchmove\"){\n\t\t\teventPos.x = event.targetTouches[0].clientX;\n\t\t\teventPos.y = event.targetTouches[0].clientY;\n\t\t}\n\n\t\tif (!interval && isScroll) {\n\t\t\tdefineScrollInterval(true);\n\t\t}\n\t}\n\n\tfunction tick() {\n\n\t\tif (!isScrollState()) {\n\t\t\tdefineScrollInterval(false);\n\t\t\treturn false;\n\t\t}\n\n\t\tvar container = getAutoscrollContainer();\n\t\tif(!container){\n\t\t\treturn;\n\t\t}\n\t\t// GS-1150: if we reorder or resize something in the grid, we should obtain the grid container\n\t\tvar gridDrag = false;\n\t\tvar gridMarkers = [\n\t\t\t\".gantt_drag_marker.gantt_grid_resize_area\",\n\t\t\t\".gantt_drag_marker .gantt_row.gantt_row_task\",\n\t\t\t\".gantt_drag_marker.gantt_grid_dnd_marker\"\n\t\t];\n\t\tgridMarkers.forEach(function (selector) {\n\t\t\tgridDrag = gridDrag || !!document.querySelector(selector);\n\t\t});\n\t\tif (gridDrag){\n\t\t\tcontainer = gantt.$grid;\n\t\t}\n\n\t\tvar box = domHelpers.getNodePosition(container);\n\n\t\tvar posX = eventPos.x - box.x;\n\t\tvar posY = eventPos.y - box.y + window.scrollY; // GS-1315: window.scrollY here and below for the elements above Gantt\n\n\t\tvar scrollLeft = isMove ? 0 : need_scroll(posX, box.width, startPos.x - box.x);\n\t\tvar scrollTop = need_scroll(posY, box.height, startPos.y - box.y + window.scrollY);\n\n\t\tvar scrollState = gantt.getScrollState();\n\n\t\tvar currentScrollTop = scrollState.y,\n\t\t\tscrollOuterHeight = scrollState.inner_height,\n\t\t\tscrollInnerHeight = scrollState.height,\n\t\t\tcurrentScrollLeft = scrollState.x,\n\t\t\tscrollOuterWidth = scrollState.inner_width,\n\t\t\tscrollInnerWidth = scrollState.width;\n\n\t\t// do scrolling only if we have scrollable area to do so\n\t\tif (scrollTop && !scrollOuterHeight) {\n\t\t\tscrollTop = 0;\n\t\t} else if (scrollTop < 0 && !currentScrollTop) {\n\t\t\tscrollTop = 0;\n\t\t} else if (scrollTop > 0 && currentScrollTop + scrollOuterHeight >= scrollInnerHeight + 2) {\n\t\t\tscrollTop = 0;\n\t\t}\n\n\t\tif (scrollLeft && !scrollOuterWidth) {\n\t\t\tscrollLeft = 0;\n\t\t} else if (scrollLeft < 0 && !currentScrollLeft) {\n\t\t\tscrollLeft = 0;\n\t\t} else if (scrollLeft > 0 && currentScrollLeft + scrollOuterWidth >= scrollInnerWidth) {\n\t\t\tscrollLeft = 0;\n\t\t}\n\n\t\tvar step = gantt.config.autoscroll_step;\n\n\t\tif (step && step < 2) // limit step value to 2\n\t\t\tstep = 2;\n\n\t\tscrollLeft = scrollLeft * (step || scrollStep);\n\t\tscrollTop = scrollTop * (step || scrollStep);\n\n\t\tif (scrollLeft || scrollTop) {\n\t\t\tscroll(scrollLeft, scrollTop);\n\t\t}\n\t}\n\n\tfunction need_scroll(pos, boxSize, startCoord) {\n\t\tif ((pos - scrollRange < 0) && (pos < startCoord))\n\t\t\treturn -1;\n\t\telse if ((pos > boxSize - scrollRange) && (pos > startCoord))\n\t\t\treturn 1;\n\t\treturn 0;\n\t}\n\n\tfunction scroll(left, top) {\n\t\tvar scrollState = gantt.getScrollState();\n\n\t\tvar scrollLeft = null,\n\t\t\tscrollTop = null;\n\n\t\tif (left) {\n\t\t\tscrollLeft = scrollState.x + left;\n\t\t\tscrollLeft = Math.min(scrollState.width, scrollLeft);\n\t\t\tscrollLeft = Math.max(0, scrollLeft);\n\t\t}\n\n\t\tif (top) {\n\t\t\tscrollTop = scrollState.y + top;\n\t\t\tscrollTop = Math.min(scrollState.height, scrollTop);\n\t\t\tscrollTop = Math.max(0, scrollTop);\n\t\t}\n\n\t\tgantt.scrollTo(scrollLeft, scrollTop);\n\t}\n\n\tgantt.attachEvent(\"onGanttReady\", function() {\n\t\tif(!isHeadless(gantt)){\n\t\t\tvar eventElement = domHelpers.getRootNode(gantt.$root) || document.body;\n\t\t\tgantt.eventRemove(eventElement, \"mousemove\", autoscrollInterval);\n\t\t\tgantt.event(eventElement, \"mousemove\", autoscrollInterval);\n\n\t\t\tgantt.eventRemove(eventElement, \"touchmove\", autoscrollInterval);\n\t\t\tgantt.event(eventElement, \"touchmove\", autoscrollInterval);\n\n\t\t\tgantt.eventRemove(eventElement, \"pointermove\", autoscrollInterval);\n\t\t\tgantt.event(eventElement, \"pointermove\", autoscrollInterval);\n\t\t}\n\t});\n\n\tgantt.attachEvent(\"onDestroy\", function(){\n\t\tdefineScrollInterval(false);\n\t});\n\n};","if (typeof window !== \"undefined\" && window.jQuery){\n\n\t(function( $ ){\n\n\t\tvar methods = [];\n\t\t$.fn.dhx_gantt = function(config){\n\t\t\tconfig = config || {};\n\t\t\tif (typeof(config) === 'string') {\n\t\t\t\tif (methods[config] ) {\n\t\t\t\t\treturn methods[config].apply(this, []);\n\t\t\t\t}else {\n\t\t\t\t\t$.error('Method ' +  config + ' does not exist on jQuery.dhx_gantt');\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tvar views = [];\n\t\t\t\tthis.each(function() {\n\t\t\t\t\tif (this && this.getAttribute){\n\t\t\t\t\t\tif (!this.gantt && !(window.gantt.$root == this)){\n\n\t\t\t\t\t\t\tvar newgantt = (window.gantt.$container && window.Gantt) ? window.Gantt.getGanttInstance():window.gantt;\n\t\t\t\t\t\t\tfor (var key in config)\n\t\t\t\t\t\t\t\tif (key!=\"data\")\n\t\t\t\t\t\t\t\t\tnewgantt.config[key] = config[key];\n\n\t\t\t\t\t\t\tnewgantt.init(this);\n\t\t\t\t\t\t\tif (config.data)\n\t\t\t\t\t\t\t\tnewgantt.parse(config.data);\n\n\t\t\t\t\t\t\tviews.push(newgantt);\n\t\t\t\t\t\t} else\n\t\t\t\t\t\t\tviews.push(typeof this.gantt == \"object\" ? this.gantt : window.gantt);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\n\t\t\t\tif (views.length === 1) return views[0];\n\t\t\t\treturn views;\n\t\t\t}\n\t\t};\n\n\t})(window.jQuery);\n\n}\n\n\nexport default null;","if (typeof window !== \"undefined\" && window.dhtmlx){\n\n\tif (!window.dhtmlx.attaches)\n\twindow.dhtmlx.attaches = {};\n\n\twindow.dhtmlx.attaches.attachGantt=function(start, end, gantt){\n\t\tvar obj = document.createElement(\"DIV\");\n\n\t\tgantt = gantt || window.gantt;\n\n\t\tobj.id = \"gantt_\"+ gantt.uid();\n\t\tobj.style.width = \"100%\";\n\t\tobj.style.height = \"100%\";\n\t\tobj.cmp = \"grid\";\n\n\t\tdocument.body.appendChild(obj);\n\t\tthis.attachObject(obj.id);\n\t\tthis.dataType = \"gantt\";\n\t\tthis.dataObj = gantt;\n\n\t\tvar that = this.vs[this.av];\n\t\tthat.grid = gantt;\n\n\t\tgantt.init(obj.id, start, end);\n\t\tobj.firstChild.style.border = \"none\";\n\n\t\tthat.gridId = obj.id;\n\t\tthat.gridObj = obj;\n\n\t\tvar method_name=\"_viewRestore\";\n\t\treturn this.vs[this[method_name]()].grid;\n\t};\n\n}\nif (typeof window !== \"undefined\" && typeof(window.dhtmlXCellObject) != \"undefined\") {\n\n\twindow.dhtmlXCellObject.prototype.attachGantt=function(start, end, gantt){\n\t\tgantt = gantt || window.gantt;\n\n\t\tvar obj = document.createElement(\"DIV\");\n\t\tobj.id = \"gantt_\"+gantt.uid();\n\t\tobj.style.width = \"100%\";\n\t\tobj.style.height = \"100%\";\n\t\tobj.cmp = \"grid\";\n\n\t\tdocument.body.appendChild(obj);\n\t\tthis.attachObject(obj.id);\n\n\t\tthis.dataType = \"gantt\";\n\t\tthis.dataObj = gantt;\n\n\t\tgantt.init(obj.id, start, end);\n\t\tobj.firstChild.style.border = \"none\";\n\n\t\tobj = null;\n\t\tthis.callEvent(\"_onContentAttach\",[]);\n\n\t\treturn this.dataObj;\n\t};\n}\n\nexport default null;","import env from \"../../../utils/env\";\nimport eventable from \"../../../utils/eventable\";\nimport { IScale, TModifierKeys } from \"../../common/config\";\n\ninterface ITimelineZoomConfig {\n\thandler?: (e: Event) => {};\n\tstartDate?: Date;\n\tendDate?: Date;\n\tlevels: IZoomLevel[];\n\tactiveLevelIndex?: number;\n\twidthStep?: number;\n\tminColumnWidth?: number;\n\tmaxColumnWidth?: number;\n\tuseKey?: \"ctrlKey\" | \"altKey\" | \"shiftKey\";\n\ttrigger?: \"wheel\" | null | undefined;\n\telement?: Element | (() => Element);\n}\n\nconst USE_KEY = [\"ctrlKey\", \"altKey\", \"shiftKey\", \"metaKey\"];\n\ninterface IZoomLevel {\n\tname?: string;\n\tscale_height?: number;\n\tmin_column_width: number;\n\tscales: IScale[];\n}\n\nconst _defaultScales = [\n\t[\n\t\t{\n\t\t\tunit: \"month\",\n\t\t\tdate: \"%M\",\n\t\t\tstep: 1\n\t\t},\n\t\t{\n\t\t\tunit: \"day\",\n\t\t\tdate: \"%d\",\n\t\t\tstep: 1\n\t\t}\n\t],\n\t[\n\t\t{\n\t\t\tunit: \"day\",\n\t\t\tdate: \"%d %M\",\n\t\t\tstep: 1\n\t\t}\n\t],\n\t[\n\t\t{\n\t\t\tunit: \"day\",\n\t\t\tdate: \"%d %M\",\n\t\t\tstep: 1\n\t\t},\n\t\t{\n\t\t\tunit: \"hour\",\n\t\t\tdate: \"%H:00\",\n\t\t\tstep: 8\n\t\t}\n\t],\n\t[\n\t\t{\n\t\t\tunit: \"day\",\n\t\t\tdate: \"%d %M\",\n\t\t\tstep: 1\n\t\t},\n\t\t{\n\t\t\tunit: \"hour\",\n\t\t\tdate: \"%H:00\",\n\t\t\tstep: 1\n\t\t}\n\t]\n];\n\nexport default class TimelineZoom {\n\tpublic attachEvent: (eventName: string, handler: () => void) => string;\n\tpublic callEvent: (eventName: string, args: any[]) => any;\n\tpublic detachEvent: (eventName: string) => any;\n\tprotected _initialStartDate: Date;\n\tprotected _initialEndDate: Date;\n\tprotected _activeLevelIndex: number;\n\tprotected _levels: IZoomLevel[];\n\tprotected _handler: (e: any) => void;\n\tprotected $gantt;\n\tprotected _widthStep: number;\n\tprotected _minColumnWidth: number;\n\tprotected _maxColumnWidth: number;\n\tprotected _useKey: TModifierKeys;\n\tprotected _visibleDate: Date;\n\tprotected _initialized: boolean;\n\tprotected _domEvents: any;\n\n\tconstructor(gantt) {\n\t\tthis.$gantt = gantt;\n\t\tthis._domEvents = this.$gantt._createDomEventScope();\n\t}\n\n\tpublic init(config: ITimelineZoomConfig) {\n\t\t// GS-1354 and GS-1318. If we check the headless mode using the function,\n\t\t// it will return false when Gantt is not initialized, but we may want to do it later\n\t\tif(this.$gantt.env.isNode){\n\t\t\treturn;\n\t\t}\n\t\tthis._initialStartDate = config.startDate;\n\t\tthis._initialEndDate = config.endDate;\n\t\tthis._activeLevelIndex = config.activeLevelIndex ? config.activeLevelIndex : 0;\n\t\tthis._levels = this._mapScales(config.levels || _defaultScales);\n\t\tthis._handler = config.handler || this._defaultHandler;\n\t\tthis._minColumnWidth = config.minColumnWidth || 60;\n\t\tthis._maxColumnWidth = config.maxColumnWidth || 240;\n\t\tthis._widthStep = config.widthStep || 3/8 * config.minColumnWidth;\n\t\tthis._useKey = config.useKey;\n\n\t\tif(!this._initialized){\n\t\t\teventable(this);\n\t\t\tthis.$gantt.attachEvent(\"onGanttScroll\", () => {\n\t\t\t\tthis._getVisibleDate();\n\t\t\t});\n\t\t}\n\n\t\tthis._domEvents.detachAll();\n\n\t\tif(config.trigger === \"wheel\"){\n\t\t\tif(this.$gantt.$root){\n\t\t\t\tthis._attachWheelEvent(config);\n\t\t\t}else{\n\t\t\t\t// GS-1322. This way the handler works for the init and resetLayout methods\n\t\t\t\tthis.$gantt.attachEvent(\"onGanttLayoutReady\", () => {\n\t\t\t\t\tthis.$gantt.attachEvent(\"onGanttRender\", () => {\n\t\t\t\t\t\tthis._attachWheelEvent(config);\n\t\t\t\t\t}, {once: true});\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tthis._initialized = true;\n\t\tthis.setLevel(this._activeLevelIndex);\n\t}\n\n\tpublic zoomIn = () => {\n\t\tconst index = this.getCurrentLevel() - 1;\n\t\tif(index < 0){\n\t\t\treturn;\n\t\t}\n\t\tthis.setLevel(index);\n\t};\n\n\tpublic zoomOut = () => {\n\t\tconst index = this.getCurrentLevel() + 1;\n\t\tif(index > this._levels.length - 1){\n\t\t\treturn;\n\t\t}\n\t\tthis.setLevel(index);\n\t};\n\n\tpublic getCurrentLevel = () => {\n\t\treturn this._activeLevelIndex;\n\t};\n\n\tpublic getLevels = () => {\n\t\treturn this._levels;\n\t};\n\n\tpublic setLevel = (level: number|string) => {\n\t\tconst zoomLevel = this._getZoomIndexByName(level);\n\n\t\tif(zoomLevel === -1){\n\t\t\tthis.$gantt.assert(zoomLevel !== -1, \"Invalid zoom level for gantt.ext.zoom.setLevel. \" + level + \" is not an expected value.\");\n\t\t}\n\t\tthis._setLevel(zoomLevel, 0);\n\t};\n\n\tprotected _getZoomIndexByName = (levelName: number|string) => {\n\t\tlet zoomLevel:number = -1;\n\t\tif(typeof levelName === \"string\"){\n\t\t\tif(!isNaN(Number(levelName)) &&  this._levels[Number(levelName)]){\n\t\t\t\tzoomLevel = Number(levelName);\n\t\t\t}else{\n\t\t\t\tfor(let i = 0; i < this._levels.length; i++){\n\t\t\t\t\tif(this._levels[i].name === levelName){\n\t\t\t\t\t\tzoomLevel = i;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}else{\n\t\t\tzoomLevel = levelName;\n\t\t}\n\t\treturn zoomLevel;\n\t};\n\n\tprotected _mapScales(levels: IScale[][] | any): IZoomLevel[]{\n\t\treturn levels.map((l) => {\n\t\t\tif(Array.isArray(l)){\n\t\t\t\treturn {\n\t\t\t\t\tscales: l\n\t\t\t\t};\n\t\t\t}else{\n\t\t\t\treturn l;\n\t\t\t}\n\t\t});\n\t}\n\n\tprotected _getVisibleDate = () => {\n\t\t// GS-1450. Don't try to get the visible date if there is no timeline\n\t\tif (!this.$gantt.$task){\n\t\t\treturn null;\n\t\t}\n\t\tconst scrollPos = this.$gantt.getScrollState().x;\n\t\tconst viewPort = this.$gantt.$task.offsetWidth;\n\t\tthis._visibleDate = this.$gantt.dateFromPos(scrollPos + viewPort/2);\n\t};\n\n\tprotected _setLevel = (level: number, cursorOffset: number) => {\n\t\tthis._activeLevelIndex = level;\n\n\t\tconst gantt = this.$gantt;\n\t\tconst nextConfig = gantt.copy(this._levels[this._activeLevelIndex]);\n\t\tconst chartConfig = gantt.copy(nextConfig);\n\t\tdelete chartConfig.name;\n\n\t\tgantt.mixin(gantt.config, chartConfig, true);\n\n\t\t// GS-1148: Change scales for the resource views\n\t\tconst resourceViews = [\n\t\t\t\"resourceTimeline\",\n\t\t\t\"resourceHistogram\"\n\t\t];\n\n\t\tresourceViews.forEach(function(name){\n\t\t\tconst resourceView = gantt.$ui.getView(name);\n\t\t\tif (resourceView){\n\t\t\t\tconst resourceConfig = resourceView.$getConfig();\n\t\t\t\tif (!resourceConfig.fixed_scales){\n\t\t\t\t\tgantt.mixin(resourceConfig, chartConfig, true);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tconst isRendered = !!gantt.$root && !!gantt.$task;\n\n\t\tif(isRendered){\n\t\t\tif(cursorOffset){\n\t\t\t\tconst cursorDate = this.$gantt.dateFromPos(cursorOffset + this.$gantt.getScrollState().x);\n\t\t\t\tthis.$gantt.render();\n\t\t\t\tconst newPosition = this.$gantt.posFromDate(cursorDate);\n\t\t\t\tthis.$gantt.scrollTo(newPosition - cursorOffset);\n\t\t\t}else{\n\t\t\t\tconst viewPort = this.$gantt.$task.offsetWidth;\n\t\t\t\tif(!this._visibleDate){\n\t\t\t\t\tthis._getVisibleDate();\n\t\t\t\t}\n\t\t\t\tconst middleDate = this._visibleDate;\n\t\t\t\tthis.$gantt.render();\n\t\t\t\tconst newPosition = this.$gantt.posFromDate(middleDate);\n\t\t\t\tthis.$gantt.scrollTo(newPosition - viewPort/2);\n\t\t\t}\n\n\t\t\tthis.callEvent(\"onAfterZoom\", [this._activeLevelIndex, nextConfig]);\n\t\t}\n\t};\n\n\tprivate _attachWheelEvent = (config) => {\n\t\tconst event = env.isFF ? \"wheel\" : \"mousewheel\";\n\t\tlet el: Element;\n\t\tif(typeof config.element === \"function\"){\n\t\t\tel = config.element();\n\t\t}else{\n\t\t\tel = config.element as Element;\n\t\t}\n\t\tif (!el){\n\t\t\treturn;\n\t\t}\n\n\t\tthis._domEvents.attach(el, event, this.$gantt.bind(function(e) {\n\t\t\tif (this._useKey) {\n\t\t\t\tif (USE_KEY.indexOf(this._useKey) < 0) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tif (!e[this._useKey]) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (typeof this._handler === \"function\") {\n\t\t\t\tthis._handler.apply(this, [e]);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}, this), {passive: false});\n\t};\n\n\tprivate _defaultHandler = (e: any):void => {\n\t\tconst timelineOffset = this.$gantt.$task.getBoundingClientRect().x;\n\t\tconst cursorOffset = e.clientX - timelineOffset;\n\t\tconst wheelY = this.$gantt.env.isFF ? (e.deltaY*-40) : e.wheelDelta;\n\t\tlet wheelUp = false;\n\t\tif (wheelY > 0) {\n\t\t\twheelUp = true;\n\t\t}\n\t\te.preventDefault();\n\t\te.stopPropagation();\n\t\tthis._setScaleSettings(wheelUp, cursorOffset);\n\t};\n\n\tprivate _setScaleSettings(wheelUp: boolean, cursorOffset: number) {\n\t\tif (wheelUp) {\n\t\t\tthis._stepUp(cursorOffset);\n\t\t} else {\n\t\t\tthis._stepDown(cursorOffset);\n\t\t}\n\t}\n\n\tprivate _setScaleDates = () => {\n\t\tif(this._initialStartDate && this._initialEndDate){\n\t\t\tthis.$gantt.config.start_date = this._initialStartDate;\n\t\t\tthis.$gantt.config.end_date = this._initialEndDate;\n\t\t}\n\t};\n\n\tprivate _stepUp(cursorOffset) {\n\t\tif (this._activeLevelIndex >= this._levels.length - 1) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet nextLevel = this._activeLevelIndex;\n\t\tthis._setScaleDates();\n\n\t\tif(this._widthStep){\n\t\t\tlet newColumnWidth = this.$gantt.config.min_column_width + this._widthStep;\n\t\t\tif (newColumnWidth > this._maxColumnWidth) {\n\t\t\t\tnewColumnWidth = this._minColumnWidth;\n\t\t\t\tnextLevel++;\n\t\t\t}\n\n\t\t\tthis.$gantt.config.min_column_width = newColumnWidth;\n\t\t}else{\n\t\t\tnextLevel++;\n\t\t}\n\t\tthis._setLevel(nextLevel, cursorOffset);\n\t}\n\tprivate _stepDown(cursorOffset) {\n\t\tif (this._activeLevelIndex < 1) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet nextLevel = this._activeLevelIndex;\n\t\tthis._setScaleDates();\n\n\t\tif(this._widthStep){\n\t\t\tlet newColumnWidth = this.$gantt.config.min_column_width - this._widthStep;\n\t\t\tif (newColumnWidth < this._minColumnWidth) {\n\t\t\t\tnewColumnWidth = this._maxColumnWidth;\n\t\t\t\tnextLevel--;\n\t\t\t}\n\t\t\tthis.$gantt.config.min_column_width = newColumnWidth;\n\t\t}else{\n\t\t\tnextLevel--;\n\t\t}\n\t\tthis._setLevel(nextLevel, cursorOffset);\n\t}\n}","export default function(gantt) {\n\n\tgantt.config.touch_drag = 75; //nearly immediate dnd\n\tgantt.config.touch = true;\n\tgantt.config.touch_feedback = true;\n\tgantt.config.touch_feedback_duration = 1;\n\tgantt._prevent_touch_scroll = false;\n\n\n\tgantt._touch_feedback = function () {\n\t\tif (gantt.config.touch_feedback) {\n\t\t\tif (navigator.vibrate)\n\t\t\t\tnavigator.vibrate(gantt.config.touch_feedback_duration);\n\t\t}\n\t};\n\n\tgantt.attachEvent(\"onGanttReady\", function(){\n\t\tif (gantt.$container)\t{\n\t\t\taddTouchEvents();\n\t\t}\n\t});\n\tgantt.attachEvent(\"onGanttLayoutReady\", function(){\n\t\tif (gantt.$container)\t{\n\t\t\t\tgantt.attachEvent(\"onGanttRender\", addTouchEvents, {once: true});\n\t\t}\n\t});\n\n\tfunction addTouchEvents(){\n\t\tif (gantt.config.touch != \"force\")\n\t\t\tgantt.config.touch = gantt.config.touch &&\n\t\t\t\t((navigator.userAgent.indexOf(\"Mobile\") != -1) ||\n\t\t\t\t\t(navigator.userAgent.indexOf(\"iPad\") != -1) ||\n\t\t\t\t\t(navigator.userAgent.indexOf(\"Android\") != -1) ||\n\t\t\t\t\t(navigator.userAgent.indexOf(\"Touch\") != -1)) ||\n\t\t\t\t\t((navigator.platform === 'MacIntel' && navigator.maxTouchPoints > 1));\n\n\t\tif (gantt.config.touch) {\n\t\t\t// IE doesn't support touch events. In other cases, a user may connect\n\t\t\t// a touch device at any time, so it should work in the forced touch mode\n\t\t\tconst touchEventsSupported = !gantt.env.isIE || !!window.navigator.maxTouchPoints;\n\n\t\t\tif (touchEventsSupported) {\n\t\t\t\tgantt._touch_events([\"touchmove\", \"touchstart\", \"touchend\"], function (ev) {\n\t\t\t\t\tif (ev.touches && ev.touches.length > 1) return null;\n\t\t\t\t\tif (ev.touches[0])\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\ttarget: ev.target,\n\t\t\t\t\t\t\tpageX: ev.touches[0].pageX,\n\t\t\t\t\t\t\tpageY: ev.touches[0].pageY,\n\t\t\t\t\t\t\tclientX: ev.touches[0].clientX,\n\t\t\t\t\t\t\tclientY: ev.touches[0].clientY\n\t\t\t\t\t\t};\n\t\t\t\t\telse\n\t\t\t\t\t\treturn ev;\n\t\t\t\t}, function (ev) {\n\t\t\t\t\treturn ev.defaultPrevented;\n\t\t\t\t});\n\t\t\t} else if (window.PointerEvent) {\n\t\t\t\tgantt._touch_events([\"pointermove\", \"pointerdown\", \"pointerup\"], function (ev) {\n\t\t\t\t\tif (ev.pointerType == \"mouse\") return null;\n\t\t\t\t\treturn ev;\n\t\t\t\t}, function (ev) {\n\t\t\t\t\treturn (!ev || (ev.pointerType == \"mouse\" ));\n\t\t\t\t});\n\t\t\t}\n\n\t\t}\n\t}\n\n\n\tfunction findTargetView(event){\n\t\tvar allViews = gantt.$layout.getCellsByType(\"viewCell\");\n\n\t\tfor(var i = 0; i < allViews.length; i++){\n\t\t\tvar box = allViews[i].$view.getBoundingClientRect();\n\t\t\tif(event.clientX >= box.left && event.clientX <= box.right &&\n\t\t\t\tevent.clientY <= box.bottom && event.clientY >= box.top){\n\t\t\t\t\treturn allViews[i];\n\t\t\t\t}\n\t\t}\n\t}\n\n\tfunction getScrollState(view){\n\t\tvar scrollX = view.$config.scrollX ? gantt.$ui.getView(view.$config.scrollX) : null;\n\t\tvar scrollY = view.$config.scrollY ? gantt.$ui.getView(view.$config.scrollY) : null;\n\n\t\tvar scrollState = {x: null, y: null};\n\t\tif(scrollX){\n\t\t\tvar state = scrollX.getScrollState();\n\t\t\tif(state.visible){\n\t\t\t\tscrollState.x = scrollX.$view.scrollLeft;\n\t\t\t}\n\t\t}\n\t\tif(scrollY){\n\t\t\tvar state = scrollY.getScrollState();\n\t\t\tif(state.visible){\n\t\t\t\tscrollState.y = scrollY.$view.scrollTop;\n\t\t\t}\n\t\t}\n\t\treturn scrollState;\n\t}\n\n\tfunction scrollView(view, left, top){\n\t\tvar scrollX = view.$config.scrollX ? gantt.$ui.getView(view.$config.scrollX) : null;\n\t\tvar scrollY = view.$config.scrollY ? gantt.$ui.getView(view.$config.scrollY) : null;\n\n\t\tif(scrollX){\n\t\t\tscrollX.scrollTo(left, null);\n\t\t}\n\t\tif(scrollY){\n\t\t\tscrollY.scrollTo(null, top);\n\t\t}\n\t}\n\n\tfunction getTaskDND(){\n\t\tvar tasksDnD;\n\t\tif(gantt.$ui.getView(\"timeline\")){\n\t\t\ttasksDnD = gantt.$ui.getView(\"timeline\")._tasks_dnd;\n\t\t}\n\t\treturn tasksDnD;\n\t}\n\n\tvar touchHandlers = [];\n\n//we can't use native scrolling, as we need to sync momentum between different parts\n//so we will block native scroll and use the custom one\n//in future we can add custom momentum\n\tgantt._touch_events = function (names, accessor, ignore) {\n\t\t//webkit on android need to be handled separately\n\t\tvar dblclicktime = 0;\n\t\tvar actionMode = false;\n\t\tvar scrollMode = false;\n\t\tvar actionStart = null;\n\t\tvar previousActionStart = null;\n\t\tvar scrollState;\n\t\tvar longTapTimer = null;\n\t\tvar currentDndId = null;\n\t\tvar dndNodes = [];\n\t\tvar targetView = null;\n\t\tlet multiTouchEvents = {};\n\n\t\tfor(var i = 0; i < touchHandlers.length; i++){\n\t\t\tgantt.eventRemove(touchHandlers[i][0], touchHandlers[i][1], touchHandlers[i][2]);\n\t\t}\n\t\ttouchHandlers = [];\n\n\t\t//touch move\n\t\ttouchHandlers.push([gantt.$container, names[0], function (e) {\n\t\t\tvar tasksDnD = getTaskDND();\n\n\t\t\t\tif (ignore(e)) return;\n\n\t\t\t\t//ignore common and scrolling moves\n\t\t\t\tif (!actionMode) return;\n\n\t\t\t\tif (longTapTimer) clearTimeout(longTapTimer);\n\n\t\t\t\tvar source = accessor(e);\n\t\t\t\tif (tasksDnD && (tasksDnD.drag.id || tasksDnD.drag.start_drag)) {\n\t\t\t\t\ttasksDnD.on_mouse_move(source);\n\t\t\t\t\tif (e.preventDefault)\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\te.cancelBubble = true;\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tif (!gantt._prevent_touch_scroll) {\n\t\t\t\t\tif (source && actionStart) {\n\t\t\t\t\t\tvar dx = actionStart.pageX - source.pageX;\n\t\t\t\t\t\tvar dy = actionStart.pageY - source.pageY;\n\t\t\t\t\t\tif (!scrollMode && (Math.abs(dx) > 5 || Math.abs(dy) > 5)) {\n\t\t\t\t\t\t\tscrollMode = true;\n\t\t\t\t\t\t\t//gantt._touch_scroll_active = scroll_mode = true;\n\t\t\t\t\t\t\tdblclicktime = 0;\n\n\t\t\t\t\t\t\tif(targetView){\n\t\t\t\t\t\t\t\tscrollState = getScrollState(targetView);\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\tscrollState = gantt.getScrollState();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (scrollMode) {\n\n\t\t\t\t\t\t\tvar newScrollState;\n\t\t\t\t\t\t\tvar scrollX = scrollState.x + dx;\n\t\t\t\t\t\t\tvar scrollY = scrollState.y + dy;\n\t\t\t\t\t\t\tif(targetView){\n\t\t\t\t\t\t\t\tscrollView(targetView, scrollX, scrollY);\n\t\t\t\t\t\t\t\tnewScrollState = getScrollState(targetView);\n\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\tgantt.scrollTo(scrollX, scrollY);\n\t\t\t\t\t\t\t\tnewScrollState = gantt.getScrollState();\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif ((scrollState.x != newScrollState.x && dy > 2 * dx) ||\n\t\t\t\t\t\t\t\t(scrollState.y != newScrollState.y && dx > 2 * dy )) {\n\t\t\t\t\t\t\t\treturn block_action(e);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn block_action(e);\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}]);\n\n\t\t// prevent page drag on touch move\n\t\ttry{\n\t\t\tdocument.addEventListener('touchmove', function(e) {\n\t\t\t\tif (gantt._touch_drag) {\n\t\t\t\t\tblock_action(e);\n\t\t\t\t}\n\t\t\t}, { passive: false });\n\t\t}\n\t\tcatch(e){\n\t\t\t// eslint-disable-next-line no-console\n\t\t\tconsole.warn(\"Cannot prevent touch event for the page drag\");\n\t\t}\n\n\t\t//block touch context menu in IE10\n\t\ttouchHandlers.push([this.$container, \"contextmenu\", function (e) {\n\t\t\tif (actionMode)\n\t\t\t\treturn block_action(e);\n\t\t}]);\n\n\t\t//touch start\n\t\ttouchHandlers.push([this.$container, names[1], function (e) {\n\t\t\tmultiTouchEvents = e.touches.length;\n\t\t\t// block pull-to-refresh\n\t\t\tif(document && document.body){\n\t\t\t\tdocument.body.classList.add(\"gantt_touch_active\");\n\t\t\t}\n\n\t\t\tif (ignore(e)) return;\n\t\t\tif (e.touches && e.touches.length > 1) {\n\t\t\t\tactionMode = false;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tactionStart = accessor(e);\n\t\t\ttargetView = findTargetView(actionStart);\n\t\t\tif (!gantt._locate_css(actionStart, \"gantt_hor_scroll\") && !gantt._locate_css(actionStart, \"gantt_ver_scroll\")) {\n\t\t\t\tactionMode = true;\n\t\t\t}\n\t\t\tvar tasksDnD = getTaskDND();\n\n\t\t\t//long tap\n\t\t\tlongTapTimer = setTimeout(function () {\n\t\t\t\tvar taskId = gantt.locate(actionStart);\n\t\t\t\tif (tasksDnD && (taskId && !gantt._locate_css(actionStart, \"gantt_link_control\") && !gantt._locate_css(actionStart, \"gantt_grid_data\"))) {\n\t\t\t\t\ttasksDnD.on_mouse_down(actionStart);\n\n\t\t\t\t\tif (tasksDnD.drag && tasksDnD.drag.start_drag) {\n\t\t\t\t\t\t// we need that as touch events break if the target node is removed from the DOM\n\t\t\t\t\t\tcloneTaskRendered(taskId);\n\t\t\t\t\t\ttasksDnD._start_dnd(actionStart);\n\t\t\t\t\t\tgantt._touch_drag = true;\n\n\t\t\t\t\t\tgantt.refreshTask(taskId);\n\n\t\t\t\t\t\tgantt._touch_feedback();\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tlongTapTimer = null;\n\t\t\t}, gantt.config.touch_drag);\n\t\t}]);\n\n\t\t//touch end\n\t\ttouchHandlers.push([this.$container, names[2], function (e) {\n\t\t\tif(document && document.body){\n\t\t\t\tdocument.body.classList.remove(\"gantt_touch_active\");\n\t\t\t}\n\t\t\tif (ignore(e)) return;\n\t\t\tif (longTapTimer) clearTimeout(longTapTimer);\n\t\t\tgantt._touch_drag = false;\n\t\t\tactionMode = false;\n\t\t\tvar source = accessor(e);\n\n\t\t\tvar tasksDnD = getTaskDND();\n\n\t\t\tif(tasksDnD)\n\t\t\t\ttasksDnD.on_mouse_up(source);\n\n\t\t\tif (currentDndId && gantt.isTaskExists(currentDndId)) {\n\t\t\t\tgantt.refreshTask(currentDndId);\n\t\t\t\tif(dndNodes.length){\n\t\t\t\t\tdndNodes.forEach(function(node){\n\t\t\t\t\t\tif(node.parentNode){\n\t\t\t\t\t\t\tnode.parentNode.removeChild(node);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tgantt._touch_feedback();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//gantt._touch_scroll_active = action_mode = scroll_mode = false;\n\t\t\tactionMode = scrollMode = false;\n\t\t\tdndNodes = [];\n\t\t\tcurrentDndId = null;\n\n\t\t\t//dbl-tap handling\n\t\t\tif (actionStart && dblclicktime) {\n\t\t\t\tvar now = new Date();\n\t\t\t\t// doubletap shouldn't happen with multitouch\n\t\t\t\tconst noMultitouch = multiTouchEvents <= 1;\n\t\t\t\t// double click events shouldn't fire when we quickly tap on different nodes\n\t\t\t\tconst sameTarget = previousActionStart && previousActionStart.target.innerHTML == actionStart.target.innerHTML;\n\t\t\t\tif ((now - dblclicktime) < 500 && noMultitouch && sameTarget) {\n\n\t\t\t\t\tvar mouseEvents = gantt.$services.getService(\"mouseEvents\");\n\t\t\t\t\tmouseEvents.onDoubleClick(actionStart);\n\t\t\t\t\tblock_action(e);\n\t\t\t\t} else {\n\t\t\t\t\tdblclicktime = now;\n\t\t\t\t\tpreviousActionStart = actionStart;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tdblclicktime = new Date();\n\t\t\t}\n\t\t}]);\n\n\t\tfor(var i = 0; i < touchHandlers.length; i++){\n\t\t\tgantt.event(touchHandlers[i][0], touchHandlers[i][1], touchHandlers[i][2]);\n\t\t}\n\n\t\t//common helper, prevents event\n\t\tfunction block_action(e) {\n\t\t\tif (e && e.preventDefault && e.cancelable){\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t\te.cancelBubble = true;\n\t\t\treturn false;\n\t\t}\n\n\t\tfunction cloneTaskRendered(taskId) {\n\t\t\tconst renders = gantt._getTaskLayers();\n\t\t\tlet task = gantt.getTask(taskId);\n\t\t\tif (task) {\n\t\t\t\tlet visible = gantt.isTaskVisible(taskId);\n\t\t\t\tif (visible){\n\t\t\t\t\tcurrentDndId = taskId;\n\t\t\t\t\tfor (let i = 0; i < renders.length; i++) {\n\t\t\t\t\t\ttask = renders[i].rendered[taskId];\n\t\t\t\t\t\tif (task && task.getAttribute(gantt.config.task_attribute) && task.getAttribute(gantt.config.task_attribute) == taskId) {\n\t\t\t\t\t\t\tconst copy = task.cloneNode(true);\n\t\t\t\t\t\t\tdndNodes.push(task);\n\t\t\t\t\t\t\trenders[i].rendered[taskId] = copy;\n\t\t\t\t\t\t\ttask.style.display = \"none\";\n\t\t\t\t\t\t\tcopy.className += \" gantt_drag_move \";\n\t\t\t\t\t\t\ttask.parentNode.appendChild(copy);\n\t\t\t\t\t\t\t//return copy;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else if (task.$split_subtask){\n\t\t\t\t\tlet renderedParent = task.$rendered_parent;\n\t\t\t\t\tvisible = gantt.isTaskVisible(renderedParent);\n\t\t\t\t\tif (!visible){\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tcurrentDndId = taskId;\n\t\t\t\t\tfor (let i = 0; i < renders.length; i++) {\n\t\t\t\t\t\tconst parent = renders[i].rendered[renderedParent];\n\t\t\t\t\t\tlet taskNode;\n\t\t\t\t\t\tif (parent && parent.childNodes){\n\t\t\t\t\t\t\ttaskNode = parent.querySelector(`[${gantt.config.task_attribute}=\"${task.id}\"]`);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (taskNode) {\n\t\t\t\t\t\t\t// move the child node to a different parent as the task bar will be repainted\n\t\t\t\t\t\t\t// and the initial node will be lost\n\t\t\t\t\t\t\tconst copy = taskNode.cloneNode(true);\n\t\t\t\t\t\t\ttaskNode.parentNode.appendChild(copy);\n\n\t\t\t\t\t\t\tgantt.$task_bars.appendChild(taskNode);\n\t\t\t\t\t\t\ttaskNode.style.display = \"none\";\n\n\t\t\t\t\t\t\t// don't add the node as rendered otherwise it will be lost:\n\t\t\t\t\t\t\t// renders[i].rendered[taskId] = taskNode;\n\t\t\t\t\t\t\t// instead, add it to dndNodes as its elements will be removed after drag\n\t\t\t\t\t\t\tdndNodes.push(taskNode);\n\n\t\t\t\t\t\t\ttaskNode = null;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n};","function dummy() {\n\t// eslint-disable-next-line\n\tconsole.log(\"Method is not implemented.\"); \n}\nfunction BaseControl() {\n}\n\n// base methods will be runned in gantt context\nBaseControl.prototype.render = dummy; // arguments: sns\nBaseControl.prototype.set_value = dummy; // arguments: node, value, ev, sns(config)\nBaseControl.prototype.get_value = dummy; // arguments node, ev, sns(config)\nBaseControl.prototype.focus = dummy; // arguments: node\n\nexport default function(gantt) { // we could send current instance of gantt to module\n\treturn BaseControl;\n};","import * as helpers from \"../../../utils/helpers\";\n\nvar htmlHelpers = {\n\tgetHtmlSelect: function(options, attributes, value) {\n\t\tvar innerHTML = \"\";\n\t\tvar _this = this;\n\n\t\toptions = options || [];\n\t\t\n\t\thelpers.forEach(options, function(entry) {\n\t\t\tvar _attributes = [{ key: \"value\", value: entry.key }];\n\n\t\t\tif (value == entry.key) {\n\t\t\t\t_attributes[_attributes.length] = { key: \"selected\", value: \"selected\" };\n\t\t\t}\n\t\t\tif (entry.attributes) {\n\t\t\t\t_attributes = _attributes.concat(entry.attributes);\n\t\t\t}\n\t\t\tinnerHTML += _this.getHtmlOption({ innerHTML: entry.label }, _attributes);\n\t\t});\n\n\t\treturn _getHtmlContainer(\"select\", { innerHTML: innerHTML }, attributes);\n\t},\n\tgetHtmlOption: function(options, attributes) { return _getHtmlContainer(\"option\", options, attributes); },\n\tgetHtmlButton: function(options, attributes) { return _getHtmlContainer(\"button\", options, attributes); },\n\tgetHtmlDiv: function(options, attributes) { return _getHtmlContainer(\"div\", options, attributes); },\n\tgetHtmlLabel: function(options, attributes) { return _getHtmlContainer(\"label\", options, attributes); },\n\tgetHtmlInput: function(attributes) {\n\t\treturn \"<input\" + _getHtmlAttributes(attributes || []) + \">\";\n\t}\n};\n\nfunction _getHtmlContainer(tag, options, attributes) {\n\tvar html;\n\n\toptions = options || [];\n\t\n\thtml = \"<\" + tag + _getHtmlAttributes(attributes || []) + \">\" + (options.innerHTML || \"\") + \"</\" + tag +\">\";\n\treturn html;\n\n}\n\nfunction _getHtmlAttributes(attributes) {\n\tvar html = \"\";\n\n\thelpers.forEach(attributes, function(entry) {\n\t\thtml += \" \" + entry.key + \"='\" + entry.value + \"'\";\n\t});\n\treturn html;\n}\n\nexport default htmlHelpers;","import __extends from \"../../../../utils/extends\";\nimport htmlHelpers from \"../../utils/html_helpers\";\n\nimport Super from \"./base_control\";\n\nexport default function(gantt) {\n\tconst _super = Super(gantt);\n\n\tfunction SelectControl() {\n\t\tvar self = _super.apply(this, arguments) || this;\n\t\n\t\treturn self; \n\t}\n\t\n\t__extends(SelectControl, _super);\n\t\n\tSelectControl.prototype.render = function(sns) {\n\t\tconst height = sns.height ? `height:${sns.height}px;` : '';\n\t\tlet html = `<div class='gantt_cal_ltext gantt_section_${sns.name}' ${height ? `style='${height}'` : ''}>`;\n\n\t\thtml += htmlHelpers.getHtmlSelect(sns.options, [{ key: \"style\", value: \"width:100%;\" }, { key: \"title\", value: sns.name }]);\n\t\thtml += \"</div>\";\n\t\treturn html;\n\t};\n\n\tSelectControl.prototype.set_value = function(node, value, ev, sns) {\n\t\tvar select = node.firstChild;\n\t\tif (!select._dhx_onchange && sns.onchange) {\n\t\t\tselect.onchange = sns.onchange;\n\t\t\tselect._dhx_onchange = true;\n\t\t}\n\t\tif (typeof value === \"undefined\")\n\t\t\tvalue = (select.options[0] || {}).value;\n\t\tselect.value = value || \"\";\n\t};\n\t\n\tSelectControl.prototype.get_value = function(node) {\n\t\treturn node.firstChild.value;\n\t};\n\t\n\tSelectControl.prototype.focus = function(node) {\n\t\tvar a = node.firstChild;\n\t\tgantt._focus(a, true);\n\t};\n\t\n\treturn SelectControl;\n};","export default class DurationFormatterNumeric implements IDurationFormatter {\n\tstatic create = (settings: IDurationFormatterConfig = null): IDurationFormatter => {\n\t\treturn new DurationFormatterNumeric();\n\t};\n\tcanParse = (value: string) : boolean => {\n\t\treturn !isNaN(this.parse(value));\n\t};\n\tformat = (value: number) : string => {\n\t\treturn String(value);\n\t};\n\tparse = (value: string) : number => {\n\t\treturn parseInt(value, 10);\n\t};\n}","import __extends from \"../../../../utils/extends\";\nimport SelectControl from \"./select_control\";\nexport default function(gantt) {\n\tvar _super = SelectControl(gantt);\n\n\tfunction ParentControl() {\n\t\tvar self = _super.apply(this, arguments) || this; \n\n\t\treturn self; \n\t}\n\n\t__extends(ParentControl, _super);\n\n\n\tParentControl.prototype.render = function(sns) {\n\t\treturn _display(sns, false);\n\t};\n\n\tParentControl.prototype.set_value = function(node, value, ev, config) {\n\t\t// GS-1051. If the value is `0`, the set_value function in the select control won't select \n\t\t// the first child because (0 || '') = '';\n\t\tif (value === 0) value = \"0\";\n\n\t\t// GS-1374. Usually, the ID is not specified,\n\t\t// we need to add it to keep the options and exclude the current task\n\t\tif (!ev.id && gantt.getState().lightbox) {\n\t\t\tev.id = gantt.getLightboxValues().id;\n\t\t}\n\n\t\tvar tmpDom = document.createElement(\"div\");\n\t\ttmpDom.innerHTML = _display(config, ev.id);\n\t\tvar newOptions = tmpDom.removeChild(tmpDom.firstChild);\n\t\tnode.onselect = null;\n\t\tnode.parentNode.replaceChild(newOptions, node);\n\n\t\treturn gantt.form_blocks.select.set_value.apply(gantt, [newOptions, value, ev, config]);\n\t};\n\n\tfunction _display(config, item_id) {\n\t\tvar tasks = [],\n\t\t\toptions = [];\n\t\tif (item_id) {\n\t\t\ttasks = gantt.getTaskByTime();\n\t\t\tif (config.allow_root) {\n\t\t\t\ttasks.unshift({id: gantt.config.root_id, text: config.root_label || \"\"});\n\t\t\t}\n\t\t\ttasks = _filter(tasks, config, item_id);\n\t\t\tif (config.sort) {\n\t\t\t\ttasks.sort(config.sort);\n\t\t\t}\n\t\t}\n\t\tvar text = config.template || gantt.templates.task_text;\n\t\tfor (var i = 0; i < tasks.length; i++) {\n\t\t\tvar label = text.apply(gantt, [tasks[i].start_date, tasks[i].end_date, tasks[i]]);\n\t\t\tif (label === undefined) {\n\t\t\t\tlabel = \"\";\n\t\t\t}\n\t\t\toptions.push({\n\t\t\t\tkey: tasks[i].id,\n\t\t\t\tlabel: label\n\t\t\t});\n\t\t}\n\t\tconfig.options = options;\n\t\tconfig.map_to = config.map_to || \"parent\";\n\t\treturn gantt.form_blocks.select.render.apply(this, arguments);\n\t}\n\n\tfunction _filter(options, config, item_id) {\n\t\tvar filter = config.filter || function() {\n\t\t\treturn true;\n\t\t};\n\n\t\toptions = options.slice(0);\n\n\t\tfor (var i = 0; i < options.length; i++) {\n\t\t\tvar task = options[i];\n\t\t\tif (task.id == item_id || gantt.isChildOf(task.id, item_id) || filter(task.id, task) === false) {\n\t\t\t\toptions.splice(i, 1);\n\t\t\t\ti--;\n\t\t\t}\n\t\t}\n\t\treturn options;\n\t}\n\treturn ParentControl;\n};","import * as helpers from \"../../../../utils/helpers\";\nimport * as domHelpers from \"../../utils/dom_helpers\";\nimport htmlHelpers from \"../../utils/html_helpers\";\nimport __extends from \"../../../../utils/extends\";\n\nimport Super from \"./base_control\";\n\nexport default function(gantt) {\n\tconst _super = Super(gantt);\n\tvar localCache = {\n\t\tresources: {},\n\t\tresourcesValues: {},\n\t\tfilter: {},\n\t\teventsInitialized: {}\n\t};\n\n\tgantt.attachEvent(\"onAfterLightbox\", _clearCached);\n\n\tfunction ResourcesControl() {\n\t\tvar self = _super.apply(this, arguments) || this;\n\n\t\treturn self;\n\t}\n\n\t__extends(ResourcesControl, _super);\n\n\tResourcesControl.prototype.render = function(sns) {\n\t\tif(!sns.options){\n\t\t\tsns.options = gantt.serverList(\"resourceOptions\");\n\t\t}\n\t\t\n\t\tif(!sns.map_to || sns.map_to == \"auto\"){\n\t\t\tsns.map_to = gantt.config.resource_property;\n\t\t}\n\t\tvar html;\n\t\tvar resourceFilterPlaceholder = gantt.locale.labels.resources_filter_placeholder || sns.filter_placeholder || \"type to filter\";\n\t\tvar resourceFilterLabel = gantt.locale.labels.resources_filter_label || \"hide empty\";\n\t\t// if set fixed height for this element, then resize of lightbox will be calculated improperly\n\t\thtml = \"<div\" + (!isNaN(sns.height) ? \" style='height: \" + sns.height + \"px;'\" : \"\") + \" class='gantt_section_\" + sns.name + \"'>\";\n\t\thtml += \"<div class='gantt_cal_ltext gantt_resources_filter'><input type='text' class='gantt_resources_filter_input' placeholder='\" + resourceFilterPlaceholder + \"'> <label><input class='switch_unsetted' type='checkbox'><span class='matherial_checkbox_icon'></span>\" + resourceFilterLabel + \"</label></div>\";\n\t\thtml += \"<div class='gantt_cal_ltext gantt_resources' data-name='\" + sns.name + \"'></div>\";\n\t\thtml += \"</div>\";\n\t\treturn html;\n\t};\n\n\tResourcesControl.prototype.set_value = function(node, value, ev, sns) {\n\t\tvar resourcesElement = _setResourcesElement(node, sns);\n\t\tvar htmlResourceRow = \"\";\n\t\tvar data;\n\n\t\t_setFilterCache(node, sns);\n\t\t_initEvents(node, ev, sns, this);\n\t\thelpers.forEach(sns.options, function(entry, index) {\n\t\t\tif (sns.unassigned_value == entry.key) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tdata = _getDisplayValues(sns, value, entry);\n\n\t\t\thtmlResourceRow += [\n\t\t\t\t\"<label class='gantt_resource_row' data-item-id='\" + entry.key + \"' data-checked=\"+(data.value ? 'true' : 'false')+\">\",\n\t\t\t\t\"<input class='gantt_resource_toggle' type='checkbox'\", data.value ? \" checked='checked'\" : \"\", \"><div class='gantt_resource_cell gantt_resource_cell_checkbox'><span class='matherial_checkbox_icon'></span></div>\",\n\t\t\t\t\"<div class='gantt_resource_cell gantt_resource_cell_label'>\", entry.label, \"</div>\",\n\t\t\t\t\"<div class='gantt_resource_cell gantt_resource_cell_value'>\", _getAmountInput(entry, data.value, !data.value, data.id),\"</div>\",\n\t\t\t\t\"<div class='gantt_resource_cell gantt_resource_cell_unit'>\", entry.unit,\"</div>\",\n\t\t\t\t\"</label>\"\n\t\t\t].join(\"\");\n\t\t});\n\t\tresourcesElement.innerHTML = htmlResourceRow;\n\t\t// weird element sizes in ie11 when display empty resource list, use zoom to force repaint\n\t\tresourcesElement.style.zoom = \"1\";\n\t\tresourcesElement._offsetSizes = resourcesElement.offsetHeight;\n\t\tresourcesElement.style.zoom = \"\";\n\n\t\tgantt._center_lightbox(gantt.getLightbox());\n\t};\n\n\tResourcesControl.prototype.get_value = function(node, ev, sns) {\n\n\t\tvar amountElement = _getResourcesElement(sns);\n\t\tvar result = [];\n\t\tvar selectorAdd = _getInputElementSelector(true);\n\t\tvar selectorSub = _getInputElementSelector(false);\n\t\tvar filterCache = _getFilterCache(sns);\n\t\tvar settedValuesHash = gantt.copy(localCache.resourcesValues[sns.id]) || {};\n\n\t\tvar itemsAdd = amountElement.querySelectorAll(selectorAdd);\n\t\tvar itemsSub = amountElement.querySelectorAll(selectorSub);\n\n\t\tfor (var i = 0; i < itemsSub.length; i++) {\n\t\t\tdelete settedValuesHash[itemsSub[i].getAttribute(\"data-item-id\")];\n\t\t}\n\n\t\tfor (var i = 0; i < itemsAdd.length; i++) {\n\t\t\tvar originalId = itemsAdd[i].getAttribute(\"data-assignment-id\");\n\t\t\tvar resourceId = itemsAdd[i].getAttribute(\"data-item-id\");\n\t\t\tvar amount = itemsAdd[i].value.trim();\n\n\t\t\tif (amount !== \"\" && amount !== \"0\") {\n\t\t\t\tdelete settedValuesHash[resourceId];\n\t\t\t\tresult[result.length] = { resource_id: resourceId, value: amount };\n\t\t\t\tif (originalId){\n\t\t\t\t\tresult[result.length - 1] = { ...result[result.length - 1], id: originalId };\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (filterCache.filterApplied) {\n\t\t\tfor (var item in settedValuesHash) {\n\t\t\t\tresult[result.length] = { resource_id: item, value: settedValuesHash[item].value, id: settedValuesHash[item].id };\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t};\n\n\tResourcesControl.prototype.focus = function(node) {\n\t\tgantt._focus(node.querySelector(\".gantt_resources\"));\n\t};\n\n\tfunction _getAmountInput(item, value, disabled, assignmentId) {\n\t\tvar _attributes;\n\t\tvar innerHTML = \"\";\n\n\t\tif (!item) return;\n\n\t\t_attributes = [{ key: \"data-item-id\", value: item.key }, { key: \"data-assignment-id\", value: assignmentId || \"\"}, { key: \"class\", value: \"gantt_resource_amount_input\"}];\n\t\tif (disabled) {\n\t\t\t_attributes.push({ key: \"disabled\", value: \"disabled\" });\n\t\t}\n\n\t\tif (item.options) {\n\t\t\tinnerHTML += htmlHelpers.getHtmlSelect(item.options, _attributes, value);\n\t\t} else {\n\t\t\t_attributes[_attributes.length] = { key: \"value\", value: value || \"\" };\n\t\t\tinnerHTML += htmlHelpers.getHtmlInput(_attributes);\n\t\t}\n\t\treturn innerHTML;\n\t}\n\n\tfunction _getValue(el) {\n\t\treturn el.value.trim();\n\t}\n\n\tfunction _initEvents(node, ev, sns, context) {\n\t\tif (localCache.eventsInitialized[sns.id]) return;\n\n\t\tvar _applyFilter = function(e) {\n\t\t\t_saveValues(sns, node);\n\t\t\tvar resultSns;\n\t\t\tvar query;\n\t\t\tvar hideUnsetted;\n\t\t\tvar input;\n\t\t\tvar checkbox;\n\t\t\tvar filterCache = _getFilterCache(sns);\n\n\t\t\tcheckbox = filterCache.checkbox;\n\t\t\tinput = filterCache.input;\n\n\t\t\thideUnsetted = checkbox.checked;\n\t\t\tquery = _getValue(input);\n\t\t\tfilterCache.filterApplied = !!query;\n\t\t\tif (gantt.getState().lightbox) {\n\t\t\t\tev = gantt.getLightboxValues();\n\t\t\t}\n\t\t\tresultSns = _getSnsToHideUnsetted(sns, ev, query, hideUnsetted);\n\t\t\tvar value = ev[sns.map_to];\n\t\t\tcontext.form_blocks.resources.set_value(node, value, ev, resultSns);\n\t\t};\n\n\t\tfunction _resourceChangeListener(e) {\n\t\t\tvar target = e.target;\n\t\t\tvar parent;\n\t\t\tvar input;\n\n\t\t\tif (e.target.type === \"checkbox\") {\n\t\t\t\tparent = target.parentNode;\n\t\t\t\tinput = parent.querySelector(_getInputElementSelector());\n\t\t\t\tinput.disabled = !target.checked;\n\t\t\t\tvar itemId = input.getAttribute(\"data-item-id\");\n\t\t\t\tvar row = domHelpers.locateClassName(e, \"gantt_resource_row\");\n\t\t\t\tvar valueInput = row.querySelector(\".gantt_resource_amount_input\");\n\t\t\t\trow.setAttribute(\"data-checked\", target.checked);\n\t\t\t\tif (target.checked) {\n\t\t\t\t\tif (input.nodeName.toLowerCase() === \"select\") {\n\t\t\t\t\t\tgantt.callEvent(\"onResourcesSelectActivated\", [{ target: input }]);\n\t\t\t\t\t}\n\n\t\t\t\t\tvar resId = itemId;\n\t\t\t\t\tvar defaultValue = sns.default_value;\n\t\t\t\t\tsns.options.forEach(function(option){\n\t\t\t\t\t\tif(option.key == resId && option.default_value){\n\t\t\t\t\t\t\tdefaultValue = option.default_value;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tif(valueInput && !valueInput.value && defaultValue !== undefined){\n\t\t\t\t\t\tvalueInput.value = defaultValue;\n\t\t\t\t\t\t_saveValues(sns, this);\n\t\t\t\t\t}\n\n\t\t\t\t\tif(valueInput.select) {\n\t\t\t\t\t\tvalueInput.select();\n\t\t\t\t\t}else if(valueInput.focus){\n\t\t\t\t\t\tvalueInput.focus();\n\t\t\t\t\t}\n\t\t\t\t} else {\n\n\t\t\t\t\tif (localCache.resourcesValues[sns.id]) {\n\t\t\t\t\t\tdelete localCache.resourcesValues[sns.id][itemId];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if (e.target.type === \"text\" || e.target.nodeName.toLowerCase() === \"select\") {\n\t\t\t\tparent = target.parentNode.parentNode;\n\n\t\t\t\tinput = e.target;\n\t\t\t\t_saveValues(sns, this);\n\t\t\t}\n\t\t}\n\t\t\n\n\t\tfunction _saveValues(sns, domElement) {\n\t\t\tvar selector = _getInputElementSelector();\n\t\t\tvar inputs = domElement.querySelectorAll(selector);\n\n\t\t\tlocalCache.resourcesValues[sns.id] = localCache.resourcesValues[sns.id] || {};\n\n\t\t\tfor (var i = 0; i < inputs.length; i++) {\n\t\t\t\tvar key = inputs[i].getAttribute(\"data-item-id\");\n\t\t\t\tvar originalAssignmentId = inputs[i].getAttribute(\"data-assignment-id\");\n\t\t\t\tif (!inputs[i].disabled) {\n\t\t\t\t\tlocalCache.resourcesValues[sns.id][key] = {value: inputs[i].value, id: originalAssignmentId};\n\t\t\t\t} else {\n\t\t\t\t\tdelete localCache.resourcesValues[sns.id][key];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t_applyFilter = helpers.throttle(_applyFilter, 100);\n\n\t\t_getFilterCache(sns).container.addEventListener(\"keyup\", _applyFilter);\n\t\t_getFilterCache(sns).container.addEventListener(\"input\", _applyFilter, true);\n\t\t_getFilterCache(sns).container.addEventListener(\"change\", _applyFilter, true);\n\t\t_getResourcesElement(sns).addEventListener(\"input\", _resourceChangeListener);\n\t\t_getResourcesElement(sns).addEventListener(\"change\", _resourceChangeListener);\n\t\tgantt.attachEvent(\"onResourcesSelectActivated\", gantt.bind(_resourceChangeListener, _getResourcesElement(sns)));\n\t\tlocalCache.eventsInitialized[sns.id] = true;\n\t}\n\n\tfunction _getSnsToHideUnsetted(controlConfig, task, query, hideUnsetted) {\n\t\tvar comparison;\n\t\tvar resultConfig;\n\n\t\tif (!hideUnsetted) {\n\t\t\tif (query === \"\") {// show all\n\t\t\t\treturn controlConfig;\n\t\t\t}\n\n\t\t\tcomparison = function(entry) {// show matching labels only\n\t\t\t\tif (entry.label.toLowerCase().indexOf(query.toLowerCase()) >= 0) {\n\t\t\t\t\treturn entry;\n\t\t\t\t}\n\t\t\t};\n\t\t} else {\n\t\t\tvar collection = task[controlConfig.map_to] || [];\n\n\t\t\tif (!helpers.isArray(collection)) {\n\t\t\t\tcollection = [collection];\n\t\t\t}\n\n\t\t\t// copy section array in order not to modify ev[sns.map_to]\n\t\t\tcollection = collection.slice();\n\n\t\t\tif (collection.length === 0) {//nothing setted\n\t\t\t\tcollection = [];\n\t\t\t\tresultConfig = gantt.copy(controlConfig);\n\t\t\t\tresultConfig.options = [];\n\t\t\t\tfor (var key in localCache.resourcesValues[controlConfig.id]) {\n\t\t\t\t\tvar cachedValue = localCache.resourcesValues[controlConfig.id][key];\n\t\t\t\t\tif (cachedValue.value !== \"\") {\n\t\t\t\t\t\tcollection.push({resource_id: key, value: cachedValue.value, id: cachedValue.id});\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (collection.length === 0) {\n\t\t\t\t\treturn resultConfig;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor (var key in localCache.resourcesValues[controlConfig.id]) {\n\t\t\t\t\tvar cachedValue = localCache.resourcesValues[controlConfig.id][key];\n\t\t\t\t\tif (cachedValue.value !== \"\") {\n\t\t\t\t\t\tvar searchResult = helpers.arrayFind(collection, function(entry) {\n\t\t\t\t\t\t\treturn entry.id == key;\n\t\t\t\t\t\t});\n\t\n\t\t\t\t\t\tif (!searchResult) {\n\t\t\t\t\t\t\tcollection.push({resource_id: key, value: cachedValue.value, id: cachedValue.id});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar itemIds = {};\n\n\t\t\tfor (var i=0; i < collection.length; i++) {\n\t\t\t\titemIds[collection[i].resource_id] = true;\n\t\t\t}\n\t\t\tcomparison = function(entry) {//show setted and filtered if field is filled\n\t\t\t\tif (itemIds[String(entry.key)] && (query === \"\" || entry.label.toLowerCase().indexOf(query.toLowerCase()) >= 0)) {\n\t\t\t\t\treturn entry;\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t\tresultConfig = gantt.copy(controlConfig);\n\t\tresultConfig.options = helpers.arrayFilter(resultConfig.options, comparison);\n\t\treturn resultConfig;\n\t}\n\n\tfunction _getInputElementSelector(isChecked) {\n\t\tif(isChecked === undefined){\n\t\t\treturn \".gantt_resource_amount_input\";\n\t\t}else{\n\t\t\treturn \"[data-checked='\"+(isChecked ? \"true\" : \"false\") + \"'] .gantt_resource_amount_input\";\n\t\t}\n\t}\n\n\tfunction _setResourcesElement(node, sns) {\n\t\tif (!localCache.resources[sns.id]) {\n\t\t\tlocalCache.resources[sns.id] = node.querySelector(\".gantt_resources\");\n\t\t}\n\t\treturn localCache.resources[sns.id];\n\t}\n\n\tfunction _getResourcesElement(sns) {\n\t\treturn localCache.resources[sns.id];\n\t}\n\n\tfunction _setFilterCache(node, sns) {\n\t\tif (!localCache.filter[sns.id]) {\n\t\t\tvar container = node.querySelector(\".gantt_resources_filter\");\n\t\t\tvar input = container.querySelector(\".gantt_resources_filter_input\");\n\t\t\tvar checkbox = container.querySelector(\".switch_unsetted\");\n\n\t\t\tlocalCache.filter[sns.id] = {\n\t\t\t\tcontainer: container,\n\t\t\t\tinput: input,\n\t\t\t\tcheckbox: checkbox,\n\t\t\t\tfilterApplied: false\n\t\t\t};\n\t\t}\n\t\treturn localCache.filter[sns.id];\n\t}\n\n\tfunction _getFilterCache(sns) {\n\t\treturn localCache.filter[sns.id];\n\t}\n\n\tfunction _clearCached() {\n\t\tfor (var key in localCache.filter) {\n\t\t\tlocalCache.filter[key].checkbox.checked = false;\n\t\t\tlocalCache.filter[key].input.value = \"\";\n\t\t\tlocalCache.filter[key].filterApplied = false;\n\t\t}\n\t\tlocalCache.resourcesValues = {};\n\t}\n\n\tfunction _getDisplayValues(sns, value, option) {\n\t\tvar data = {};\n\n\t\tif (value) {\n\t\t\tvar searchResult;\n\n\t\t\tif (helpers.isArray(value)) {\n\t\t\t\tsearchResult = helpers.arrayFind(value, function(val) {\n\t\t\t\t\treturn (val.resource_id == option.key);\n\t\t\t\t});\n\t\t\t} else if (value.resource_id == option.key) {\n\t\t\t\tsearchResult = value;\n\t\t\t}\n\n\t\t\tif (searchResult) {\n\t\t\t\tdata.value = searchResult.value;\n\t\t\t\tdata.id = searchResult.id;\n\t\t\t}\n\t\t}\n\t\tif (localCache.resourcesValues[sns.id] && localCache.resourcesValues[sns.id][option.key]) {\n\t\t\tdata.value = localCache.resourcesValues[sns.id][option.key].value;\n\t\t\tdata.id = localCache.resourcesValues[sns.id][option.key].id;\n\t\t}\n\t\treturn data;\n\t}\n\n\treturn ResourcesControl;\n};","\nimport * as helpers from \"../../../../utils/helpers\";\nimport __extends from \"../../../../utils/extends\";\nimport Super from \"./base_control\";\n\nexport default function(gantt) {\n\tconst _super = Super(gantt);\n\n\tconst localCache = {\n\t\tresources: {},\n\t\tresourcesValues: {},\n\t\tfilter: {},\n\t\teventsInitialized: {},\n\t\tgridID: null,\n\t\tresource_filter_value: null,\n\t\tinitialValues: [],\n\t\tnewValues: []\n\t};\n\n\tconst selectResEditor = { type: \"select\", map_to: \"resource_id\" , options: gantt.serverList(\"resourceOptions\")};\n\tconst numberEditor = { type: \"number\", map_to: \"value\", min: 0, max: 100 };\n\n\tconst dateToStr = gantt.date.date_to_str(\"%d-%m-%Y\");\n\n\tgantt.resource_table = {\n\t\tscale_height: 35,\n\t\trow_height: 35,\n\t\tcolumns: [\n\t\t\t{\n\t\t\t\tname: \"resource\", label: \"Resource\", align: \"center\", width: 80, editor: selectResEditor, template: function (assignment) {\n\t\t\t\t\tlet defaultValue = \"Unassigned\";\n\t\t\t\t\tconst resource = gantt.getDatastore(gantt.config.resource_store).getItem(assignment.resource_id);\n\t\t\t\t\treturn resource ? resource.text : defaultValue;\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"hours/Day\", label: \"Hours/Day\", align: \"center\", width: 70, editor: numberEditor, template: function (assignment) {\n\t\t\t\t\treturn assignment.value ? +assignment.value : ``;\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"start\", label: \"Start\", align: \"center\", width: 100, template: function (assignment) {\n\t\t\t\t\treturn assignment.start_date ? dateToStr(assignment.start_date) : ``;\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"end\", label: \"End\", align: \"center\", width: 100, template: function (assignment) {\n\t\t\t\t\treturn assignment.end_date ? dateToStr(assignment.end_date) : ``;\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"duration\", label: \"Duration\", align: \"center\", width: 80, template: function (assignment) {\n\t\t\t\t\tif (assignment.duration) {\n\t\t\t\t\t\treturn `${assignment.duration} day${assignment.duration == 1 ? '' : 's'}`;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn ``;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: \"delete\", label: \"Delete\", align: \"center\", width: 80, template: function (assignment) {\n\t\t\t\t\treturn `<div data-assignment-id='${assignment.id}' data-assignment-delete='${assignment.id}' class='dhx_gantt_icon dhx_gantt_icon_delete'></div>`;\n\t\t\t\t}\n\t\t\t}\n\t\t],\n\t\tresource_default_assignment: {\n\t\t\tduration: null,\n\t\t\tvalue: 8,\n\t\t\tstart_date: null,\n\t\t\tend_date: null,\n\t\t\tmode: \"default\"\n\t\t}\n\t};\n\n\tgantt.attachEvent(\"onAfterLightbox\", _clearCached);\n\n\tfunction newResourcesControl() {\n\t\tvar self = _super.apply(this, arguments) || this;\n\n\t\treturn self;\n\t}\n\n\t__extends(newResourcesControl, _super);\n\n\tfunction _generateResourceInputSection(index, name) {\n\t\tconst resourceFilterPlaceholder = gantt.locale.labels.resources_filter_placeholder || \"Search...\";\n\t\tconst html = `<div class='gantt_resource_selector_filter_wrapper gantt_cal_lsection' data-section-name='${name}'>\n\t\t\t\t\t\t<div class='gantt_cal_ltext gantt_resources_filter'>\n\t\t\t\t\t\t\t<label class=\"dhx_gantt_icon dhx_gantt_icon_search\">\n\t\t\t\t\t\t\t\t<input type='text' class='gantt_resources_filter_input' placeholder='${resourceFilterPlaceholder}' tab-index=\"-1\"> \n\t\t\t\t\t\t\t<label>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div role='button' aria-label='Add Assignment' class='gantt_custom_button gantt_add_resources' data-index='${index}'><div class='gantt_custom_button_add_resources gantt_add'></div><div class='gantt_custom_button_label'>${gantt.locale.labels.resources_add_button}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>`;\n\t\treturn html;\n\t}\n\n\n\tfunction _generateResourceTable(node, assignments, task, sns) {\n\t\t// destroy grid if it exists\n\t\tif(gantt.$ui.getView(\"GridRL\") && !localCache.gridID){\n\t\t\tgantt.$ui.getView(\"GridRL\").destructor();\n\t\t}\n\n\t\tif (!localCache.gridID) {\n\t\t\t// temp store for assignments in the lightbox\n\t\t\tconst resourceTable = document.createElement(\"div\");\n\t\t\tresourceTable.classList.add(\"gantt_resource_selector_grid\");\n\t\t\tconst tempAssignmentStore = gantt.createDatastore({\n\t\t\t\tname: \"temp_resource_assignment_store\",\n\t\t\t\tinitItem: function (item) {\n\t\t\t\t\tif (!item.id) {\n\t\t\t\t\t\titem.id = gantt.uid();\n\t\t\t\t\t}\n\t\t\t\t\treturn item;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tgantt.$data.tempAssignmentsStore = tempAssignmentStore; // link to gantt\n\t\t\tconst gridConfig = {...gantt.config.layout, id: \"GridRL\", sectionName: sns.name };\n\t\t\tconst grid = gantt.$ui.createView(\"GridRL\", gantt.$root, gridConfig);  // creating grid\n\t\t\tgrid.init(resourceTable); // init grid\n\t\t\tconst width = gantt._lightbox.offsetWidth - (gantt.config.wide_form ? 150 : 0); \n\t\t\tgrid.setSize(width, \"auto\"); // set width and height of the grid\n\t\t\tgantt.ext.inlineEditorsLightbox = gantt.ext._inlineEditors.createEditors(grid); //attach inline editors\n\t\t\tgantt.ext.inlineEditorsLightbox.init();\n\t\t\tlocalCache.gridID = grid.$id;\n\t\t\tnode.appendChild(resourceTable);\n\t\t\tconst resourceAssignmentsStore = gantt.getDatastore(gantt.config.resource_assignment_store);  // main store\n\t\t\tconst searchItems = [];\n\t\t\tresourceAssignmentsStore.eachItem(function(item){\n\t\t\t\tif(item.task_id && item.task_id == task.id){\n\t\t\t\t\tsearchItems.push(item);\n\t\t\t\t}\n\t\t\t});\n\t\t\tconst clonedAssignments = structuredClone(searchItems); // clone\n\t\t\ttempAssignmentStore.parse(clonedAssignments); // add all assignments from main to temp\n\t\t}\n\n\t\tgantt.$data.tempAssignmentsStore.attachEvent(\"onFilterItem\", function(id, assignment) {\n\t\t\tif (assignment.task_id == task.id){\n\t\t\t\tif (!localCache.resource_filter_value) {\n\t\t\t\t\treturn true;\n\t\t\t\t} else {\n\t\t\t\t\tlet resource = gantt.getDatastore(gantt.config.resource_store).getItem(assignment.resource_id);\n\t\t\t\t\tif (resource.text.toLowerCase().indexOf(localCache.resource_filter_value) > -1) return true;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false;\n\t\t});\n\t\tgantt.refreshData();\n\t}\n\n\tfunction _generateAssignmentDefaultRow(sectionName) {\n\t\tlet resource_id;\n\t\tconst task = gantt.getTask(gantt._lightbox_id);\n\t\tconst assignments = gantt.getTaskAssignments(task.id);\n\t\tif(assignments.length){\n\t\t\tresource_id = assignments[0].resource_id;\n\t\t} else {\n\t\t\tconst resources = gantt.serverList(\"resourceOptions\");\n\t\t\tif(resources.length){\n\t\t\t\tresource_id = resources[0].id;\n\t\t\t} else {\n\t\t\t\tthrow new Error(`There is no any resources in resource store, please check your data:\n\t\t\t\t\thttps://docs.dhtmlx.com/gantt/desktop__resource_management.html#assigningresources`);\n\t\t\t}\n\t\t}\n\n\t\tconst tempAssignmentStore = gantt.getDatastore(\"temp_resource_assignment_store\");\n\t\tconst lightboxSection = gantt.getLightboxSection(sectionName).section;\n\t\tconst resourceConfig = lightboxSection.config ?? gantt.resource_table;\n\t\tconst config = resourceConfig.resource_default_assignment ?? gantt.resource_table.resource_default_assignment;\n\n\t\ttempAssignmentStore.addItem({\n\t\t\tresource_id,\n\t\t\ttask_id: task.id,\n\t\t\tduration: config.duration ?? gantt.calculateDuration(task),\n\t\t\tvalue: config.value,\n\t\t\tstart_date: config.start_date ?? task.start_date,\n\t\t\tend_date: config.end_date ?? task.end_date,\n\t\t\tmode: config.mode\n\t\t});\n\t\tgantt.refreshData();\n\t}\n\n\tfunction _setFocus(container){\n\t\tconst resourceRows = container.querySelectorAll(\".gantt_row.gantt_row_task\");\n\t\tif(resourceRows){\n\t\t\tconst lastRow = resourceRows[resourceRows.length -1];\n\t\t\tconst resourceCell = lastRow.querySelector(\".gantt_cell\");\n\t\t\tif(resourceCell){\n\t\t\t\tconst {id, columnName} = gantt.ext.inlineEditorsLightbox.locateCell(resourceCell);\n\t\t\t\tif(id && columnName){\n\t\t\t\t\tgantt.ext.inlineEditorsLightbox.startEdit(id, columnName);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tnewResourcesControl.prototype.render = function(sns) {\n\t\tif(!sns.options){\n\t\t\tsns.options = gantt.serverList(\"resourceOptions\");\n\t\t}\n\n\t\tif(!sns.map_to || sns.map_to == \"resource_selector\" || sns.map_to == \"auto\"){\n\t\t\tsns.map_to = gantt.config.resource_property;\n\t\t}\n\n\t\tlet html;\n\t\t// if set fixed height for this element, then resize of lightbox will be calculated improperly\n\t\thtml = `<div${!isNaN(sns.height) ? \" style='height:auto;'\" : \"\"} class='gantt_section_${sns.name}' data-section-name='${sns.name}'>`;\n\t\thtml += _generateResourceInputSection(sns.index, sns.name);\n\t\thtml += `</div>`;\n\t\thtml += `<div class=\"resources_section_placeholder\" style='display:none;'>${gantt.locale.labels.resources_section_placeholder}</div>`;\n\t\treturn html;\n\t};\n\n\tnewResourcesControl.prototype.button_click = function (index, el, section, container) {\n\t\tconst sectionName = section.getAttribute(\"data-section-name\") || container.getAttribute(\"data-section-name\");\n\t\tconst firstAddBtn = document.querySelector(\"[data-resource-selector-section]\");\n\t\tconst placeholder = document.querySelector(\".resources_section_placeholder\");\n\t\tconst resourceSection = document.querySelector(`.gantt_section_${sectionName} .gantt_resource_selector_filter_wrapper`);\n\t\tconst resourceGrid = document.querySelector(`.gantt_section_${sectionName} .gantt_grid`);\n\t\tfirstAddBtn.style.display = \"none\";\n\n\t\tif (gantt.callEvent(\"onSectionButton\", [gantt._lightbox_id, section]) === false) {\n\t\t\treturn;\n\t\t}\n\t\tif (el.closest(\".gantt_custom_button.gantt_add_resources\")){\n\t\t\tplaceholder.style.display = \"none\";\n\t\t\tconst tempAssignmentStore = gantt.getDatastore(\"temp_resource_assignment_store\");\n\n\t\t\tif(tempAssignmentStore && tempAssignmentStore.getItems().length == 0){\n\t\t\t\tresourceSection.style.display = \"flex\";\n\t\t\t\tresourceGrid.style.display = \"block\";\n\t\t\t}\n\n\t\t\t_generateAssignmentDefaultRow(sectionName);\n\t\t\t_setFocus(container);\n\t\t}\n\t};\n\n\tfunction setInitialValues(task){\n\t\tlocalCache.initialValues = [];\n\t\tlocalCache.newValues = [];\n\t\tconst assignmentStore = gantt.$data.assignmentsStore;\n\t\tconst storeAssignments = assignmentStore.find(function (a) {\n\t\t\treturn a.task_id == task.id;\n\t\t});\n\t\tfor (let i = 0; i < storeAssignments.length; i++) {\n\t\t\tlocalCache.initialValues[i] = { resource_id: storeAssignments[i].resource_id, value: storeAssignments[i].value, id: storeAssignments[i].id };\n\t\t}\n\t}\n\n\tnewResourcesControl.prototype.set_value = function(node, assignments, task, sns, initialized) {\n\t\tlet firstAddBtn = document.querySelector(\"[data-resource-selector-section]\");\n\t\tlet placeholder = document.querySelector(\".resources_section_placeholder\");\n\t\tsetInitialValues(task);\n\t\tif(!initialized){\n\t\t\t\t_generateResourceTable(node, assignments, task, sns);\n\t\t\t\t_setFilterCache(node, sns);\n\t\t\t\t_initEvents(node, assignments, sns, this);\n\t\t\t\tfirstAddBtn.style.display = \"none\";\n\t\t\t\tlet resourceGrid = document.querySelector(`.gantt_section_${sns.name} .gantt_grid`);\n\t\t\t\tlet resourceSection = document.querySelector(`.gantt_section_${sns.name} .gantt_resource_selector_filter_wrapper`);\n\t\t\t\tresourceGrid.style.display = \"none\";\n\t\t\t\tresourceSection.style.display = \"none\";\n\t\t}\n\t\tconst tempAssignmentStore = gantt.getDatastore(\"temp_resource_assignment_store\");\n\t\tif(tempAssignmentStore) {\n\t\t\tlet resourceSection = document.querySelector(`.gantt_section_${sns.name} .gantt_resource_selector_filter_wrapper`);\n\t\t\tlet resourceGrid = document.querySelector(`.gantt_section_${sns.name} .gantt_grid`);\n\n\t\t\tif(tempAssignmentStore.getItems().length == 0){\n\t\t\t\tif(firstAddBtn.style.display == \"none\"){\n\t\t\t\t\tfirstAddBtn.style.display = \"flex\";\n\t\t\t\t}\n\n\t\t\t\tresourceSection.style.display = \"none\";\n\t\t\t\tresourceGrid.style.display = \"none\";\n\t\t\t\tplaceholder.style.display = \"block\";\n\t\t\t} else {\n\t\t\t\tresourceSection.style.display = \"flex\";\n\t\t\t\tresourceGrid.style.display = \"block\";\n\t\t\t\tplaceholder.style.display = \"none\";\n\t\t\t}\n\t\t}\n\n\t\tgantt._center_lightbox(gantt.getLightbox());\n\t};\n\n\tnewResourcesControl.prototype.get_value = function(node, task, sns, type) {\n\t\tconst tempAssignmentStore = gantt.getDatastore(\"temp_resource_assignment_store\");\n\t\tconst storeAssignments = tempAssignmentStore.find(function (a) {\n\t\t\treturn a.task_id == task.id;\n\t\t});\n\t\tfor (let i = 0; i < storeAssignments.length; i++) {\n\t\t\tlocalCache.newValues[i] = { \n\t\t\t\tresource_id: storeAssignments[i].resource_id.toString(), \n\t\t\t\tvalue: storeAssignments[i].value, \n\t\t\t\tid: storeAssignments[i].id, \n\t\t\t\tstart_date: storeAssignments[i].start_date,\n\t\t\t\tend_date: storeAssignments[i].end_date,\n\t\t\t\tduration: storeAssignments[i].duration,\n\t\t\t\tmode: storeAssignments[i].mode,\n\t\t\t\tdelay: storeAssignments[i].delay\n\t\t\t};\n\t\t}\n\n\t\tif (type == \"save\"){\n\t\t\treturn localCache.newValues;\n\t\t} else {\n\t\t\treturn localCache.initialValues;\n\t\t}\n\t};\n\n\tfunction getVisibleResources(task, options){\n\t\tlet visibleResources = [];\n\t\tconst tempAssignmentStore = gantt.getDatastore(\"temp_resource_assignment_store\");\n\t\tconst currentAssignments = tempAssignmentStore.find(function (a) {\n\t\t\treturn a.task_id == task.id;\n\t\t});\n\t\tfor (let i = 0; i < currentAssignments.length; i++) {\n\t\t\tlet resource = gantt.getDatastore(gantt.config.resource_store).getItem(currentAssignments[i].resource_id);\n\t\t\tif(resource){\n\t\t\t\tvisibleResources.push(resource);\n\t\t\t}\n\t\t}\n\t\treturn visibleResources;\n\t}\n\n\tfunction _getValue(el) {\n\t\treturn el.value.trim();\n\t}\n\n\tfunction _initEvents(node, ev, sns, context) {\n\t\tif (localCache.eventsInitialized[sns.id]) return;\n\n\t\tvar _applyFilter = function(e) {\n\t\t\t_saveValues(sns, node);\n\t\t\tvar resultSns;\n\t\t\tvar query;\n\t\t\tvar input;\n\t\t\tvar filterCache = _getFilterCache(sns);\n\t\t\tinput = filterCache.input;\n\n\t\t\tquery = _getValue(input);\n\t\t\tlocalCache.resource_filter_value = query.toLowerCase();\n\t\t\tfilterCache.filterApplied = !!query;\n\t\t\tif (gantt.getState().lightbox) {\n\t\t\t\tev = gantt.getLightboxValues();\n\t\t\t}\n\t\t\tresultSns = _getSnsToHideUnsetted(sns, ev, query);\n\t\t\tvar value = ev[sns.map_to];\n\t\t\tcontext.form_blocks.resource_selector.set_value(node, value, ev, resultSns);\n\t\t};\n\n\t\tfunction _saveValues(sns, domElement) {\n\t\t\tvar selector = _getInputElementSelector();\n\t\t\tvar inputs = domElement.querySelectorAll(selector);\n\n\t\t\tlocalCache.resourcesValues[sns.id] = localCache.resourcesValues[sns.id] || {};\n\n\t\t\tfor (var i = 0; i < inputs.length; i++) {\n\t\t\t\tvar key = inputs[i].getAttribute(\"data-item-id\");\n\t\t\t\tvar originalAssignmentId = inputs[i].getAttribute(\"data-assignment-id\");\n\t\t\t\tif (!inputs[i].disabled) {\n\t\t\t\t\tlocalCache.resourcesValues[sns.id][key] = {value: inputs[i].value, id: originalAssignmentId};\n\t\t\t\t} else {\n\t\t\t\t\tdelete localCache.resourcesValues[sns.id][key];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t_applyFilter = helpers.throttle(_applyFilter, 100);\n\n\t\t_getFilterCache(sns).container.addEventListener(\"keyup\", _applyFilter);\n\t\t_getFilterCache(sns).container.addEventListener(\"input\", _applyFilter, true);\n\t\t_getFilterCache(sns).container.addEventListener(\"change\", _applyFilter, true);\n\t\tlocalCache.eventsInitialized[sns.id] = true;\n\t}\n\n\tfunction _getSnsToHideUnsetted(controlConfig, task, query, hideUnsetted) {\n\t\tvar comparison;\n\t\tvar resultConfig = gantt.copy(controlConfig);\n\n\t\tif (query === \"\") {// show all\n\t\t\tresultConfig.resources = [];\n\t\t\tlet resourceIds = localCache.newValues.map(obj => {\n\t\t\t\treturn obj.resource_id;\n\t\t\t});\n\t\t\tif(resourceIds && resourceIds.length > 0){\n\t\t\t\tfor (let i = 0; i < resourceIds.length; i++) {\n\t\t\t\t\tlet resource = gantt.getDatastore(gantt.config.resource_store).getItem(resourceIds[i]);\n\t\t\t\t\tif(resource){\n\t\t\t\t\t\tresultConfig.resources.push(resource);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn resultConfig;\n\t\t}\n\n\t\tcomparison = function(entry) {// show matching labels only\n\t\t\tif (entry.text.toLowerCase().indexOf(query.toLowerCase()) >= 0) {\n\t\t\t\treturn entry;\n\t\t\t}\n\t\t};\n\n\t\tresultConfig.resources = getVisibleResources(task, controlConfig.options);\n\t\tresultConfig.resources = helpers.arrayFilter(resultConfig.resources, comparison);\n\t\treturn resultConfig;\n\t}\n\n\tfunction _getInputElementSelector(isChecked) {\n\t\tif(isChecked === undefined){\n\t\t\treturn \".gantt_resource_amount_input\";\n\t\t}else{\n\t\t\treturn \"[data-checked='\"+(isChecked ? \"true\" : \"false\") + \"'] .gantt_resource_amount_input\";\n\t\t}\n\t}\n\n\tfunction _setFilterCache(node, sns) {\n\t\tif (!localCache.filter[sns.id]) {\n\t\t\tvar container = node.querySelector(\".gantt_resources_filter\");\n\t\t\tvar input = container.querySelector(\".gantt_resources_filter_input\");\n\n\t\t\tlocalCache.filter[sns.id] = {\n\t\t\t\tcontainer: container,\n\t\t\t\tinput: input,\n\t\t\t\tfilterApplied: false\n\t\t\t};\n\t\t}\n\t\treturn localCache.filter[sns.id];\n\t}\n\n\tfunction _getFilterCache(sns) {\n\t\treturn localCache.filter[sns.id];\n\t}\n\n\tfunction _clearCached() {\n\t\tfor (var key in localCache.filter) {\n\t\t\tlocalCache.filter[key].input.value = \"\";\n\t\t\tlocalCache.filter[key].filterApplied = false;\n\t\t}\n\t\tlocalCache.resourcesValues = {};\n\t\tlocalCache.eventsInitialized = {};\n\t\tlocalCache.resource_filter_value = null;\n\t\tlocalCache.gridID = null;\n\t\tlocalCache.initialValues = [];\n\t\tlocalCache.newValues = [];\n\t}\n\n\treturn newResourcesControl;\n};","import TemplateControlConstructor from \"./controls/template_control\";\nimport TextareaControlConstructor from \"./controls/textarea_control\";\nimport TimeControlConstructor from \"./controls/time_control\";\nimport SelectControlConstructor from \"./controls/select_control\";\nimport CheckboxControlConstructor from \"./controls/checkbox_control\";\nimport RadioControlConstructor from \"./controls/radio_control\";\nimport DurationControlConstructor from \"./controls/duration_control\";\nimport ParentControlConstructor from \"./controls/parent_control\";\nimport ResourcesControlConstructor from \"./controls/resources_control\";\nimport ConstraintControlConstructor from \"./controls/constraint_control\";\nimport TypeselectControlConstructor from \"./controls/typeselect_control\";\nimport BaselineControlConstructor from \"./controls/baseline_control\";\nimport NewResourcesControlConstructor from \"./controls/resource_selector_control\";\n\nimport * as domHelpers from \"../utils/dom_helpers\";\nimport * as helpers from \"../../../utils/helpers\";\n\t\n\nexport default function (gantt) {\n\n\n\tvar TemplateControl = TemplateControlConstructor(gantt);\n\tvar TextareaControl = TextareaControlConstructor(gantt);\n\tvar TimeControl = TimeControlConstructor(gantt);\n\tvar SelectControl = SelectControlConstructor(gantt);\n\tvar CheckboxControl = CheckboxControlConstructor(gantt);\n\tvar RadioControl = RadioControlConstructor(gantt);\n\tvar DurationControl = DurationControlConstructor(gantt);\n\tvar ParentControl = ParentControlConstructor(gantt);\n\tvar ResourcesControl = ResourcesControlConstructor(gantt);\n\tvar ConstraintControl = ConstraintControlConstructor(gantt);\n\tvar TypeselectControl = TypeselectControlConstructor(gantt);\n\tvar BaselineControl = BaselineControlConstructor(gantt);\n\tvar NewResourcesControl = NewResourcesControlConstructor(gantt);\n\n\tgantt._lightbox_methods = {};\n\tgantt._lightbox_template = \"<div class='gantt_cal_ltitle'><span class='gantt_mark'>&nbsp;</span><span class='gantt_time'></span><span class='gantt_title'></span></div><div class='gantt_cal_larea'></div>\";\n\tgantt._lightbox_template = `<div class='gantt_cal_ltitle'><div class=\"dhx_cal_ltitle_descr\"><span class='gantt_mark'>&nbsp;</span><span class='gantt_time'></span><span class='dhx_title'></span>\n</div>\n<div class=\"gantt_cal_ltitle_controls\">\n\t<a class=\"gantt_cal_ltitle_close_btn dhx_gantt_icon dhx_gantt_icon_close\"></a>\n\n</div></div><div class='gantt_cal_larea'></div>`;\n\n\t// GS-1952. Attaching the lightbox to the BODY element is not considered secure.\n\t// Attach it to Gantt container for Salesforce and other secure environments\n\tgantt._lightbox_root = gantt.$root;\n\tfunction setParentNode() {\n\t\tconst cspEnvironment = gantt.config.csp === true;\n\t\tif (cspEnvironment || gantt.env.isSalesforce) {\n\t\t\tgantt._lightbox_root = gantt.$root;\n\t\t} else {\n\t\t\tgantt._lightbox_root = document.body;\n\t\t}\n\t}\n\n\t//TODO: gantt._lightbox_id is changed from data.js and accessed from autoscheduling, check if it can be removed from gantt object\n\tvar state = gantt.$services.getService(\"state\");\n\tstate.registerProvider(\"lightbox\", function () {\n\t\treturn {\n\t\t\tlightbox: gantt._lightbox_id\n\t\t};\n\t});\n\n\tgantt.showLightbox = function (id) {\n\t\tvar task = this.getTask(id);\n\t\tif (!this.callEvent(\"onBeforeLightbox\", [id])) {\n\t\t\tif(gantt.isTaskExists(id) && gantt.getTask(id).$new){\n\t\t\t\t//GS-2340 if 'onBeforeLightbox' returns 'false' need update the order in datastore\n\t\t\t\tthis.$data.tasksStore._updateOrder();\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tvar box = this.getLightbox(this.getTaskType(task.type));\n\n\t\tthis.showCover(box);\n\t\tthis._fill_lightbox(id, box);\n\t\tthis._setLbPosition(box);\n\t\tthis._waiAria.lightboxVisibleAttr(box);\n\n\t\tthis.callEvent(\"onLightbox\", [id]);\n\t};\n\n\tfunction _is_chart_visible(gantt) {\n\t\tvar timeline = gantt.$ui.getView(\"timeline\");\n\t\tif (timeline && timeline.isVisible()) {\n\t\t\treturn true;\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tgantt._get_timepicker_step = function () {\n\t\tif (this.config.round_dnd_dates) {\n\t\t\tvar step;\n\t\t\tif (_is_chart_visible(this)) {\n\t\t\t\tvar scale = gantt.getScale();\n\t\t\t\tstep = (helpers.getSecondsInUnit(scale.unit) * scale.step) / 60;//timepicker step is measured in minutes\n\t\t\t}\n\n\t\t\tif (!step || step >= 60 * 24) {\n\t\t\t\tstep = this.config.time_step;\n\t\t\t}\n\t\t\treturn step;\n\t\t}\n\t\treturn this.config.time_step;\n\t};\n\tgantt.getLabel = function (property, key) {\n\t\tvar sections = this._get_typed_lightbox_config();\n\t\tfor (var i = 0; i < sections.length; i++) {\n\t\t\tif (sections[i].map_to == property) {\n\t\t\t\tvar options = sections[i].options;\n\t\t\t\tfor (var j = 0; j < options.length; j++) {\n\t\t\t\t\tif (options[j].key == key) {\n\t\t\t\t\t\treturn options[j].label;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn \"\";\n\t};\n\n\tgantt.updateCollection = function (list_name, collection) {\n\t\tcollection = collection.slice(0);\n\t\tvar list = gantt.serverList(list_name);\n\t\tif (!list) return false;\n\t\tlist.splice(0, list.length);\n\t\tlist.push.apply(list, collection || []);\n\t\tgantt.resetLightbox();\n\t};\n\tgantt.getLightboxType = function () {\n\t\treturn this.getTaskType(this._lightbox_type);\n\t};\n\tgantt.getLightbox = function (type) {\n\t\tvar lightboxDiv;\n\t\tvar fullWidth;\n\t\tvar html;\n\t\tvar sns;\n\t\tvar ds;\n\t\tvar classNames = \"\";\n\t\tsetParentNode();\n\n\t\tif (type === undefined)\n\t\t\ttype = this.getLightboxType();\n\n\t\tif (!this._lightbox || this.getLightboxType() != this.getTaskType(type)) {\n\t\t\tthis._lightbox_type = this.getTaskType(type);\n\t\t\tlightboxDiv = document.createElement(\"div\");\n\t\t\tclassNames = \"gantt_cal_light\";\n\t\t\tfullWidth = this._is_lightbox_timepicker();\n\n\t\t\tif (gantt.config.wide_form)\n\t\t\t\tclassNames += \" gantt_cal_light_wide\";\n\n\t\t\tif (fullWidth) {\n\t\t\t\tclassNames += \" gantt_cal_light_full\";\n\t\t\t}\n\n\t\t\tlightboxDiv.className = classNames;\n\n\t\t\tlightboxDiv.style.visibility = \"hidden\";\n\t\t\thtml = this._lightbox_template;\n\t\t\thtml += \"<div class='gantt_cal_lcontrols'>\";\n\t\t\thtml += getHtmlButtons(this.config.buttons_left);\n\t\t\thtml += \"<div class='gantt_cal_lcontrols_push_right'></div>\";\n\t\t\thtml += getHtmlButtons(this.config.buttons_right, true);\n\t\t\thtml += \"</div>\";\n\n\t\t\tlightboxDiv.innerHTML = html;\n\n\t\t\tgantt._waiAria.lightboxAttr(lightboxDiv);\n\n\t\t\tif (gantt.config.drag_lightbox) {\n\t\t\t\tlightboxDiv.firstChild.onmousedown = gantt._ready_to_dnd;\n\t\t\t\tlightboxDiv.firstChild.addEventListener('touchstart', function(e){\n\t\t\t\t\tgantt._ready_to_dnd(e.touches[0]);\n\t\t\t\t});\n\t\t\t\tlightboxDiv.firstChild.onselectstart = function () {\n\t\t\t\t\treturn false;\n\t\t\t\t};\n\t\t\t\tlightboxDiv.firstChild.style.cursor = \"pointer\";\n\t\t\t\tgantt._init_dnd_events();\n\t\t\t}\n\n\t\t\t// GS-1428: If there is lightbox node, we need to remove it from the DOM\n\t\t\tif (this._lightbox){\n\t\t\t\tthis.resetLightbox();\n\t\t\t}\n\t\t\tshow_cover();\n\t\t\tthis._cover.insertBefore(lightboxDiv, this._cover.firstChild);\n\t\t\tthis._lightbox = lightboxDiv;\n\n\t\t\tsns = this._get_typed_lightbox_config(type);\n\t\t\thtml = this._render_sections(sns);\n\n\t\t\tds = lightboxDiv.querySelector(\"div.gantt_cal_larea\");\n\t\t\t\n\t\t\t//GS-1131. If gantt_cal_larea is displayed, Firefox renders buttons incorrectly;\n\t\t\tvar backup_overflow = ds.style.overflow;\n\t\t\tds.style.overflow = 'hidden';\n\n\t\t\tds.innerHTML = html;\n\n\t\t\t\n\n\t\t\tbindLabelsToInputs(sns);\n\n\t\t\tds.style.overflow = backup_overflow;\n\n\t\t\tthis._init_lightbox_events(this);\n\t\t\tlightboxDiv.style.display = \"none\";\n\t\t\tlightboxDiv.style.visibility = \"visible\";\n\t\t}\n\t\treturn this._lightbox;\n\t};\n\n\tgantt._render_sections = function (sns) {\n\t\tvar html = \"\";\n\t\tfor (var i = 0; i < sns.length; i++) {\n\t\t\tvar block = this.form_blocks[sns[i].type];\n\t\t\tif (!block) continue; //ignore incorrect blocks\n\t\t\tsns[i].id = \"area_\" + this.uid();\n\n\t\t\tvar display = sns[i].hidden ? \" style='display:none'\" : \"\";\n\t\t\tvar button = \"\";\n\t\t\tif (sns[i].button) {\n\t\t\t\tbutton = \"<div class='gantt_custom_button' data-index='\" + i + \"'><div class='gantt_custom_button_\" + sns[i].button + \"'></div><div class='gantt_custom_button_label'>\" + this.locale.labels[\"button_\" + sns[i].button] + \"</div></div>\";\n\t\t\t}\n\t\t\tif (sns[i].type == \"baselines\") {\n\t\t\t\tbutton = \"<div class='gantt_custom_button gantt_remove_baselines' data-index='\" + i + \"'><div class='gantt_custom_button_delete_baselines'></div><div class='gantt_custom_button_label'>\" + this.locale.labels.baselines_remove_all_button + \"</div></div>\" +\n\t\t\t\t\"<div class='gantt_custom_button gantt_add_baselines' data-index='\" + i + \"'><div class='gantt_custom_button_add_baseline'></div><div class='gantt_custom_button_label'>\" + this.locale.labels.baselines_add_button + \"</div></div>\";\n\t\t\t}\n\t\t\tif (sns[i].type == \"resource_selector\") {\n\t\t\t\tsns[i].index = i;\n\t\t\t\tbutton = `<div class='gantt_custom_button gantt_add_resources' data-index='${i}' data-resource-selector-section='${i}' data-section-name='${sns.name}'><div class='gantt_custom_button_add_resources gantt_add'></div><div class='gantt_custom_button_label'>${this.locale.labels.resources_add_button}</div></div>`;\n\t\t\t}\n\t\t\tif (this.config.wide_form) {\n\t\t\t\thtml += \"<div class='gantt_wrap_section' \" + display + \">\";\n\t\t\t}\n\t\t\thtml += \"<div id='\" + sns[i].id + \"' class='gantt_cal_lsection'><label>\" + button + (sns[i].label || this.locale.labels[\"section_\" + sns[i].name]||sns[i].name) + \"</label></div>\" + block.render.call(this, sns[i]);\n\t\t\thtml += \"</div>\";\n\t\t}\n\t\treturn html;\n\t};\n\n\tgantt._center_lightbox = function(box){\n\t\tgantt._setLbPosition(box);\n\t};\n\tgantt._setLbPosition = function(box) {\n\t\tif(!box){\n\t\t\treturn;\n\t\t}\n\t\tconst rootElement = gantt._lightbox_root || gantt.$root;\n\t\tbox.style.top = Math.max(rootElement.offsetHeight / 2 - box.offsetHeight/2, 0) + \"px\";\n\t\tbox.style.left = Math.max(rootElement.offsetWidth / 2 - box.offsetWidth/2, 0) + \"px\";\n\t};\n\n\tgantt.showCover = function (box) {\n\t\tif (box){\n\t\t\tbox.style.display=\"block\";\n\t\n\t\t\tthis._setLbPosition(box);\n\t\t}\n\t\tshow_cover();\n\t\tthis._cover.style.display = \"\";\n\t};\n\tconst show_cover=function(){\n\t\tif(gantt._cover) {\n\t\t\treturn;\n\t\t}\n\t\n\t\tgantt._cover=document.createElement(\"div\");\n\t\tgantt._cover.className=\"gantt_cal_cover\";\n\t\tgantt._cover.style.display = \"none\";\n\t\n\t\tgantt.event(gantt._cover, \"mousemove\", gantt._move_while_dnd);\n\t\tgantt.event(gantt._cover, \"mouseup\", gantt._finish_dnd);\n\t\n\t\tconst rootElement = gantt._lightbox_root || gantt.$root;\n\t\trootElement.appendChild(gantt._cover);\n\t};\n\n\tgantt._init_lightbox_events = function () {\n\t\tgantt.lightbox_events = {};\n\n\n\t\tgantt.lightbox_events.gantt_save_btn = function () {\n\t\t\tgantt._save_lightbox();\n\t\t};\n\n\n\t\tgantt.lightbox_events.gantt_delete_btn = function () {\n\t\t\tgantt._lightbox_current_type = null;\n\t\t\tif (!gantt.callEvent(\"onLightboxDelete\", [gantt._lightbox_id]))\n\t\t\t\treturn;\n\n\t\t\tif (gantt.isTaskExists(gantt._lightbox_id)) {\n\t\t\t\tgantt.$click.buttons[\"delete\"](gantt._lightbox_id);\n\t\t\t} else {\n\t\t\t\tgantt.hideLightbox();\n\t\t\t}\n\n\t\t};\n\n\n\t\tgantt.lightbox_events.gantt_cancel_btn = function () {\n\t\t\tgantt._cancel_lightbox();\n\t\t};\n\n\n\t\tgantt.lightbox_events[\"default\"] = function (e, src) {\n\t\t\tif (src.getAttribute(\"data-dhx-button\")) {\n\t\t\t\tgantt.callEvent(\"onLightboxButton\", [src.className, src, e]);\n\t\t\t} else {\n\t\t\t\tvar index, block, sec;\n\n\t\t\t\tvar className = domHelpers.getClassName(src);\n\t\t\t\tif (className.indexOf(\"gantt_custom_button\") != -1) {\n\t\t\t\t\tif (className.indexOf(\"gantt_custom_button_\") != -1) {\n\t\t\t\t\t\tindex = src.parentNode.getAttribute(\"data-index\");\n\t\t\t\t\t\tsec = src;\n\t\t\t\t\t\twhile (sec && domHelpers.getClassName(sec).indexOf(\"gantt_cal_lsection\") == -1) {\n\t\t\t\t\t\t\tsec = sec.parentNode;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tindex = src.getAttribute(\"data-index\");\n\t\t\t\t\t\tsec = src.closest(\".gantt_cal_lsection\");\n\t\t\t\t\t\tsrc = src.firstChild;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tvar sections = gantt._get_typed_lightbox_config();\n\n\t\t\t\tif (index) {\n\t\t\t\t\tindex = index * 1;\n\t\t\t\t\tblock = gantt.form_blocks[sections[index * 1].type];\n\t\t\t\t\tblock.button_click(index, src, sec, sec.nextSibling);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tthis.event(gantt.getLightbox(), \"click\", function (e) {\n\t\t\tif(e.target.closest(\".gantt_cal_ltitle_close_btn\")){\n\t\t\t\tgantt._cancel_lightbox();\n\t\t\t}\n\t\t\tvar src = domHelpers.getTargetNode(e);\n\n\t\t\tvar className = domHelpers.getClassName(src);\n\t\t\tif (!className) {\n\t\t\t\tsrc = src.previousSibling;\n\t\t\t\tclassName = domHelpers.getClassName(src);\n\t\t\t}\n\t\t\tif (src && className && className.indexOf(\"gantt_btn_set\") === 0) {\n\t\t\t\tsrc = src.firstChild;\n\t\t\t\tclassName = domHelpers.getClassName(src);\n\t\t\t}\n\t\t\tif (src && className) {\n\t\t\t\tvar func = gantt.defined(gantt.lightbox_events[src.className]) ? gantt.lightbox_events[src.className] : gantt.lightbox_events[\"default\"];\n\t\t\t\treturn func(e, src);\n\t\t\t}\n\t\t\treturn false;\n\t\t});\n\n\t\tgantt.getLightbox().onkeydown = function (e) {\n\t\t\tvar event = e || window.event;\n\t\t\tvar target = e.target || e.srcElement;\n\t\t\tvar buttonTarget = domHelpers.getClassName(target).indexOf(\"gantt_btn_set\") > -1;\n\n\t\t\tswitch ((e || event).keyCode) {\n\t\t\t\tcase gantt.constants.KEY_CODES.SPACE: {\n\t\t\t\t\tif ((e || event).shiftKey) return;\n\t\t\t\t\tif (buttonTarget && target.click) {\n\t\t\t\t\t\ttarget.click();\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcase gantt.keys.edit_save:\n\t\t\t\t\tif ((e || event).shiftKey) return;\n\t\t\t\t\tif (buttonTarget && target.click) {\n\t\t\t\t\t\ttarget.click();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tgantt._save_lightbox();\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase gantt.keys.edit_cancel:\n\t\t\t\t\tgantt._cancel_lightbox();\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t};\n\t};\n\n\tgantt._cancel_lightbox = function () {\n\t\tvar task = this.getLightboxValues(\"cancel\");\n\t\tgantt._lightbox_current_type = null;\n\t\tthis.callEvent(\"onLightboxCancel\", [this._lightbox_id, task.$new]);\n\t\tif (gantt.isTaskExists(task.id) && task.$new) {\n\t\t\tthis.silent(function () {\n\t\t\t\tgantt.$data.tasksStore.removeItem(task.id);\n\t\t\t\tgantt._update_flags(task.id, null);\n\t\t\t});\n\t\t\tthis.refreshData();\n\t\t}\n\n\t\tthis.hideLightbox();\n\t};\n\n\tgantt._save_lightbox = function () {\n\t\tvar task = this.getLightboxValues(\"save\");\n\t\tgantt._lightbox_current_type = null;\n\t\tif (!this.callEvent(\"onLightboxSave\", [this._lightbox_id, task, !!task.$new]))\n\t\t\treturn;\n\n\t\t// GS-2170. Do not recalculate the indexes and dates of other tasks\n\t\t// as they will be recalculated in the `refreshData`\n\t\tgantt.$data.tasksStore._skipTaskRecalculation = \"lightbox\";\n\t\tif (task.$new) {\n\t\t\tdelete task.$new;\n\t\t\tthis.addTask(task, task.parent, this.getTaskIndex(task.id));\n\t\t} else if (this.isTaskExists(task.id)) {\n\t\t\tthis.mixin(this.getTask(task.id), task, true);\n\t\t\tthis.refreshTask(task.id);\n\t\t\tthis.updateTask(task.id);\n\t\t}\n\t\tgantt.$data.tasksStore._skipTaskRecalculation = false;\n\t\tthis.refreshData();\n\n\t\t// TODO: do we need any blockable events here to prevent closing lightbox?\n\t\tthis.hideLightbox();\n\t};\n\n\tgantt._resolve_default_mapping = function (section) {\n\t\tvar mapping = section.map_to;\n\t\tvar time_controls = { \"time\": true, \"time_optional\": true, \"duration\": true, \"duration_optional\": true };\n\t\tif (time_controls[section.type]) {\n\t\t\tif (section.map_to == \"auto\") {\n\t\t\t\tmapping = { start_date: \"start_date\", end_date: \"end_date\", duration: \"duration\" };\n\t\t\t} else if (typeof (section.map_to) === \"string\") {\n\t\t\t\tmapping = { start_date: section.map_to };\n\t\t\t}\n\t\t} else if (section.type === \"constraint\") {\n\t\t\tif (!section.map_to || typeof (section.map_to) === \"string\") {\n\t\t\t\tmapping = { constraint_type: \"constraint_type\", constraint_date: \"constraint_date\" };\n\t\t\t}\n\t\t}\n\n\t\treturn mapping;\n\t};\n\n\tgantt.getLightboxValues = function (type) {\n\t\tlet task = {};\n\n\t\tif (gantt.isTaskExists(this._lightbox_id)) {\n\t\t\ttask = this.mixin({}, this.getTask(this._lightbox_id));\n\t\t}\n\n\t\tconst sns = this._get_typed_lightbox_config();\n\t\t// GS-2370: if there is a resource with its calendar\n\t\t// need to place time section at the end\n\t\tconst sortedSns = [...sns].sort((a, b) => {\n\t\t\tif (a.name === \"time\") return 1;\n\t\t\tif (b.name === \"time\") return -1;\n\t\t\treturn 0;\n\t\t});\n\t\tfor (let i = 0; i < sortedSns.length; i++) {\n\t\t\tlet node = gantt._lightbox_root.querySelector(\"#\" + sortedSns[i].id);\n\t\t\tnode = (node ? node.nextSibling : node);\n\t\t\tlet block = this.form_blocks[sortedSns[i].type];\n\t\t\tif (!block) continue;\n\t\t\tlet res = block.get_value.call(this, node, task, sortedSns[i], type);\n\t\t\tlet map_to = gantt._resolve_default_mapping(sortedSns[i]);\n\t\t\tif (typeof map_to == \"string\" && map_to != \"auto\") {\n\t\t\t\ttask[map_to] = res;\n\t\t\t} else if (typeof map_to == \"object\") {\n\t\t\t\tfor (let property in map_to) {\n\t\t\t\t\tif (map_to[property])\n\t\t\t\t\t\ttask[map_to[property]] = res[property];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t// GS-1282 We need to preserve the task type even if the lightbox doesn't have the typeselect section\n\t\t// GS-2460 set the current type from selector\n\t\tif (gantt._lightbox_current_type) {\n\t\t\ttask.type = gantt._lightbox_current_type;\n\t\t}\n\n\t\treturn task;\n\t};\n\n\n\tgantt.hideLightbox = function () {\n\t\tvar box = this.getLightbox();\n\t\tif (box) box.style.display = \"none\";\n\n\t\tthis._waiAria.lightboxHiddenAttr(box);\n\t\tthis._lightbox_id = null;\n\n\t\tthis.hideCover(box);\n\t\tthis.resetLightbox();\n\t\tthis.callEvent(\"onAfterLightbox\", []);\n\t};\n\tgantt.hideCover = function (box) {\n\t\tif(box){\n\t\t\tbox.style.display = \"none\";\n\t\t}\n\t\tif (this._cover)\n\t\t\tthis._cover.parentNode.removeChild(this._cover);\n\t\tthis._cover = null;\n\t};\n\n\tgantt.resetLightbox = function () {\n\t\tif (gantt._lightbox && !gantt._custom_lightbox)\n\t\t\tgantt._lightbox.remove();\n\t\tgantt._lightbox = null;\n\t};\n\tgantt._set_lightbox_values = function (data, box) {\n\t\tvar task = data;\n\t\tvar s = box.getElementsByTagName(\"span\");\n\t\tvar lightboxHeader = [];\n\t\tif (gantt.templates.lightbox_header) {\n\t\t\tlightboxHeader.push(\"\");\n\t\t\tlightboxHeader.push(gantt.templates.lightbox_header(task.start_date, task.end_date, task));\n\t\t\ts[1].innerHTML = \"\";\n\t\t\ts[2].innerHTML = gantt.templates.lightbox_header(task.start_date, task.end_date, task);\n\t\t} else {\n\t\t\tlightboxHeader.push(this.templates.task_time(task.start_date, task.end_date, task));\n\t\t\tlightboxHeader.push(String(this.templates.task_text(task.start_date, task.end_date, task) || \"\").substr(0, 70)); //IE6 fix\n\t\t\ts[1].innerHTML = this.templates.task_time(task.start_date, task.end_date, task);\n\t\t\ts[2].innerHTML = String(this.templates.task_text(task.start_date, task.end_date, task) || \"\").substr(0, 70); //IE6 fix\n\t\t}\n\t\ts[1].innerHTML = lightboxHeader[0];\n\t\ts[2].innerHTML = lightboxHeader[1];\n\n\t\tgantt._waiAria.lightboxHeader(box, lightboxHeader.join(\" \"));\n\n\t\tvar sns = this._get_typed_lightbox_config(this.getLightboxType());\n\t\tfor (var i = 0; i < sns.length; i++) {\n\t\t\tvar section = sns[i];\n\n\t\t\tif (!this.form_blocks[section.type]) {\n\t\t\t\tcontinue;//skip incorrect sections, same check is done during rendering\n\t\t\t}\n\n\n\t\t\tvar node = gantt._lightbox_root.querySelector(\"#\" + section.id).nextSibling;\n\t\t\tvar block = this.form_blocks[section.type];\n\t\t\tvar map_to = gantt._resolve_default_mapping(sns[i]);\n\t\t\tvar value = this.defined(task[map_to]) ? task[map_to] : section.default_value;\n\t\t\tblock.set_value.call(gantt, node, value, task, section);\n\n\t\t\tif (section.focus)\n\t\t\t\tblock.focus.call(gantt, node);\n\t\t}\n\t\tif (gantt.isTaskExists(data.id)){\n\t\t\tgantt._lightbox_id = data.id;\n\t\t}\n\t};\n\tgantt._fill_lightbox = function (id, box) {\n\t\tvar task = this.getTask(id);\n\t\tthis._set_lightbox_values(task, box);\n\t};\n\n\n\tgantt.getLightboxSection = function (name) {\n\t\tvar config = this._get_typed_lightbox_config();\n\t\tvar i = 0;\n\t\tfor (i; i < config.length; i++)\n\t\t\tif (config[i].name == name)\n\t\t\t\tbreak;\n\t\tvar section = config[i];\n\t\tif (!section)\n\t\t\treturn null;\n\n\t\tif (!this._lightbox)\n\t\t\tthis.getLightbox();\n\t\tvar header = gantt._lightbox_root.querySelector(\"#\" + section.id);\n\t\tvar node = header.nextSibling;\n\n\t\tvar result = {\n\t\t\tsection: section,\n\t\t\theader: header,\n\t\t\tnode: node,\n\t\t\tgetValue: function (ev) {\n\t\t\t\treturn gantt.form_blocks[section.type].get_value.call(gantt, node, (ev || {}), section);\n\t\t\t},\n\t\t\tsetValue: function (value, ev) {\n\t\t\t\treturn gantt.form_blocks[section.type].set_value.call(gantt, node, value, (ev || {}), section);\n\t\t\t}\n\t\t};\n\n\t\tvar handler = this._lightbox_methods[\"get_\" + section.type + \"_control\"];\n\t\treturn handler ? handler(result) : result;\n\t};\n\n\tgantt._lightbox_methods.get_template_control = function (result) {\n\t\tresult.control = result.node;\n\t\treturn result;\n\t};\n\tgantt._lightbox_methods.get_select_control = function (result) {\n\t\tresult.control = result.node.getElementsByTagName(\"select\")[0];\n\t\treturn result;\n\t};\n\tgantt._lightbox_methods.get_textarea_control = function (result) {\n\t\tresult.control = result.node.getElementsByTagName(\"textarea\")[0];\n\t\treturn result;\n\t};\n\tgantt._lightbox_methods.get_time_control = function (result) {\n\t\tresult.control = result.node.getElementsByTagName(\"select\"); // array\n\t\treturn result;\n\t};\n\n\n\tgantt._init_dnd_events = function () {\n\t\tvar eventElement = gantt._lightbox_root;\n\t\tthis.event(eventElement, \"mousemove\", gantt._move_while_dnd);\n\t\tthis.event(eventElement, \"mouseup\", gantt._finish_dnd);\n\t\tthis.event(eventElement, \"touchmove\", function (e){\n\t\t\tgantt._move_while_dnd(e.touches[0]);\n\t\t});\n\t\tthis.event(eventElement, \"touchend\", function (e){\n\t\t\tgantt._finish_dnd(e.touches[0]);\n\t\t});\n\t\t// GS-1952: In Salesforce environment, the lightbox is attached to the Gantt container. \n\t\t// So when Gantt is reinitialized, the events are no longer attached to the Gantt container.\n\t\t// gantt._init_dnd_events = function () {\n\t\t// };\n\t};\n\tgantt._move_while_dnd = function (event) {\n\t\tif (gantt._dnd_start_lb) {\n\t\t\tif (!document.gantt_unselectable) {\n\t\t\t\tgantt._lightbox_root.className += \" gantt_unselectable\";\n\t\t\t\tdocument.gantt_unselectable = true;\n\t\t\t}\n\t\t\tvar lb = gantt.getLightbox();\n\t\t\tvar now = [event.pageX, event.pageY];\n\t\t\tlb.style.top = gantt._lb_start[1] + now[1] - gantt._dnd_start_lb[1] + \"px\";\n\t\t\tlb.style.left = gantt._lb_start[0] + now[0] - gantt._dnd_start_lb[0] + \"px\";\n\t\t}\n\t};\n\tgantt._ready_to_dnd = function (event) {\n\t\tvar lb = gantt.getLightbox();\n\t\tgantt._lb_start = [lb.offsetLeft, lb.offsetTop];\n\t\tgantt._dnd_start_lb = [event.pageX, event.pageY];\n\t};\n\tgantt._finish_dnd = function () {\n\t\tif (gantt._lb_start) {\n\t\t\tgantt._lb_start = gantt._dnd_start_lb = false;\n\t\t\tgantt._lightbox_root.className = gantt._lightbox_root.className.replace(\" gantt_unselectable\", \"\");\n\t\t\tdocument.gantt_unselectable = false;\n\t\t}\n\t};\n\n\n\tgantt._focus = function (node, select) {\n\t\tif (node && node.focus) {\n\t\t\tif (gantt.config.touch) {\n\t\t\t\t//do not focus editor, to prevent auto-zoom\n\t\t\t} else {\n\t\t\t\ttry {\n\t\t\t\t\tif (select && node.select) node.select();\n\t\t\t\t\tnode.focus();\n\t\t\t\t} catch (e) {\n\t\t\t\t\t// silent errors\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\n\tgantt.form_blocks = {\n\t\tgetTimePicker: function (sns, hidden) {\n\t\t\tvar html = \"\";\n\t\t\tvar cfg = this.config;\n\t\t\tvar i;\n\t\t\tvar options;\n\t\t\tvar ariaAttrs;\n\t\t\tvar readonly;\n\t\t\tvar display;\n\t\t\tvar settings = {\n\t\t\t\tfirst: 0,\n\t\t\t\tlast: 24 * 60,\n\t\t\t\tdate: this.date.date_part(new Date(gantt._min_date.valueOf())),\n\t\t\t\ttimeFormat: getTimeFormat(sns)\n\t\t\t};\n\n\t\t\t// map: default order => real one\n\t\t\tsns._time_format_order = { size: 0 };\n\n\t\t\tif (gantt.config.limit_time_select) {\n\t\t\t\tsettings.first = 60 * cfg.first_hour;\n\t\t\t\tsettings.last = 60 * cfg.last_hour + 1;\n\t\t\t\tsettings.date.setHours(cfg.first_hour);\n\t\t\t}\n\n\t\t\tfor (i = 0; i < settings.timeFormat.length; i++) {\n\t\t\t\t// adding spaces between selects\n\t\t\t\tif (i > 0) {\n\t\t\t\t\thtml += \" \";\n\t\t\t\t}\n\n\t\t\t\toptions = getHtmlTimePickerOptions(sns, i, settings);\n\n\t\t\t\tif (options) {\n\t\t\t\t\tariaAttrs = gantt._waiAria.lightboxSelectAttrString(settings.timeFormat[i]);\n\t\t\t\t\treadonly = sns.readonly ? \"disabled='disabled'\" : \"\";\n\t\t\t\t\tdisplay = hidden ? \" style='display:none' \" : \"\";\n\t\t\t\t\thtml += \"<select \" + readonly + display + ariaAttrs + \">\" + options + \"</select>\";\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn html;\n\t\t},\n\t\tgetTimePickerValue: function (selects, config, offset) {\n\t\t\tvar map = config._time_format_order;\n\t\t\tvar needSetTime = gantt.defined(map[3]);\n\n\t\t\tvar time;\n\t\t\tvar hours = 0;\n\t\t\tvar minutes = 0;\n\n\t\t\tvar mapOffset = offset || 0;\n\n\t\t\tif (needSetTime) {\n\t\t\t\ttime = parseInt(selects[map[3] + mapOffset].value, 10);\n\t\t\t\thours = Math.floor(time / 60);\n\t\t\t\tminutes = time % 60;\n\t\t\t}\n\t\t\treturn new Date(selects[map[2] + mapOffset].value, selects[map[1] + mapOffset].value, selects[map[0] + mapOffset].value, hours, minutes);\n\t\t},\n\n\t\t_fill_lightbox_select: function (s, i, d, map) {\n\t\t\ts[i + map[0]].value = d.getDate();\n\t\t\ts[i + map[1]].value = d.getMonth();\n\t\t\ts[i + map[2]].value = d.getFullYear();\n\t\t\tif (gantt.defined(map[3])) {\n\t\t\t\tvar v = d.getHours() * 60 + d.getMinutes();\n\t\t\t\tv = Math.round(v / gantt._get_timepicker_step()) * gantt._get_timepicker_step();\n\t\t\t\tvar input = s[i + map[3]];\n\t\t\t\tinput.value = v;\n\t\t\t\t//in case option not shown\n\t\t\t\tinput.setAttribute(\"data-value\", v);\n\t\t\t}\n\t\t},\n\t\ttemplate: new TemplateControl(),\n\t\ttextarea: new TextareaControl(),\n\t\tselect: new SelectControl(),\n\t\ttime: new TimeControl(),\n\t\tduration: new DurationControl(),\n\t\tparent: new ParentControl(),\n\t\tradio: new RadioControl(),\n\t\tcheckbox: new CheckboxControl(),\n\t\tresources: new ResourcesControl(),\n\t\tconstraint: new ConstraintControl(),\n\t\tbaselines: new BaselineControl(),\n\t\ttypeselect: new TypeselectControl(),\n\t\tresource_selector: new NewResourcesControl()\n\t};\n\n\tgantt._is_lightbox_timepicker = function () {\n\t\tvar s = this._get_typed_lightbox_config();\n\t\tfor (var i = 0; i < s.length; i++)\n\t\t\tif (s[i].name == \"time\" && s[i].type == \"time\")\n\t\t\t\treturn true;\n\t\treturn false;\n\t};\n\n\tgantt._delete_task_confirm = function ({task, message, title, callback, ok}){\n\t\tgantt._simple_confirm(message, title, callback, ok);\n\t};\n\tgantt._delete_link_confirm = function({link, message, title, callback, ok}){\n\t\tgantt._simple_confirm(message, title, callback, ok);\n\t};\n\n\tgantt._simple_confirm = function (message, title, callback, ok) {\n\t\tif (!message)\n\t\t\treturn callback();\n\t\tvar opts = { text: message };\n\t\tif (title)\n\t\t\topts.title = title;\n\t\tif (ok) {\n\t\t\topts.ok = ok;\n\t\t}\n\t\tif (callback) {\n\t\t\topts.callback = function (result) {\n\t\t\t\tif (result)\n\t\t\t\t\tcallback();\n\t\t\t};\n\t\t}\n\t\tgantt.confirm(opts);\n\t};\n\n\tfunction _get_type_name(type_value) {\n\t\tfor (var i in this.config.types) {\n\t\t\tif (this.config.types[i] == type_value) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\t\treturn \"task\";\n\t}\n\n\tgantt._get_typed_lightbox_config = function (type) {\n\t\tif (type === undefined) {\n\t\t\ttype = this.getLightboxType();\n\t\t}\n\n\t\tvar field = _get_type_name.call(this, type);\n\n\t\tif (gantt.config.lightbox[field + \"_sections\"]) {\n\t\t\treturn gantt.config.lightbox[field + \"_sections\"];\n\t\t} else {\n\t\t\treturn gantt.config.lightbox.sections;\n\t\t}\n\t};\n\n\tgantt._silent_redraw_lightbox = function (type) {\n\t\tvar oldType = this.getLightboxType();\n\n\t\tif (this.getState().lightbox) {\n\t\t\tvar taskId = this.getState().lightbox;\n\t\t\tvar formData = this.getLightboxValues(),\n\t\t\t\ttask = this.copy(this.getTask(taskId));\n\n\t\t\tthis.resetLightbox();\n\n\t\t\tvar updTask = this.mixin(task, formData, true);\n\t\t\tvar box = this.getLightbox(type ? type : undefined);\n\t\t\tthis._set_lightbox_values(updTask, box);\n\t\t\tthis.showCover(box);\n\t\t} else {\n\t\t\tthis.resetLightbox();\n\t\t\tthis.getLightbox(type ? type : undefined);\n\t\t}\n\t\tthis.callEvent(\"onLightboxChange\", [oldType, this.getLightboxType()]);\n\t};\n\n\tfunction bindLabelsToInputs(sns) {\n\t\tvar section;\n\t\tvar label;\n\t\tvar labelBlock;\n\t\tvar inputBlock;\n\t\tvar input;\n\t\tvar i;\n\n\t\tfor (i = 0; i < sns.length; i++) {\n\t\t\tsection = sns[i];\n\t\t\tlabelBlock = gantt._lightbox_root.querySelector(\"#\" + section.id);\n\n\t\t\tif (!section.id || !labelBlock) continue;\n\n\t\t\tlabel = labelBlock.querySelector(\"label\");\n\t\t\tinputBlock = labelBlock.nextSibling;\n\n\t\t\tif (!inputBlock) continue;\n\n\t\t\tinput = inputBlock.querySelector(\"input, select, textarea\");\n\t\t\tif (input) {\n\t\t\t\tinput.id = input.id || \"input_\" + gantt.uid();\n\t\t\t\tsection.inputId = input.id;\n\t\t\t\tlabel.setAttribute(\"for\", section.inputId);\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction getHtmlButtons(buttons, floatRight) {\n\t\tvar button;\n\t\tvar ariaAttr;\n\t\tvar html = \"\";\n\t\tvar i;\n\n\t\tfor (i = 0; i < buttons.length; i++) {\n\t\t\t// needed to migrate from 'dhx_something' to 'gantt_something' naming in a lightbox\n\t\t\tbutton = gantt.config._migrate_buttons[buttons[i]] ? gantt.config._migrate_buttons[buttons[i]] : buttons[i];\n\n\t\t\tariaAttr = gantt._waiAria.lightboxButtonAttrString(button);\n\t\t\thtml += \"<div \" + ariaAttr + \" class='gantt_btn_set gantt_left_btn_set \" + button + \"_set'\" + \"><div dhx_button='1' data-dhx-button='1' class='\" + button + \"'></div><div>\" + gantt.locale.labels[button] + \"</div></div>\";\n\t\t}\n\t\treturn html;\n\t}\n\n\tfunction getTimeFormat(sns) {\n\t\tvar scale;\n\t\tvar unit;\n\t\tvar result;\n\n\t\tif (sns.time_format) return sns.time_format;\n\n\t\t// default order\n\t\tresult = [\"%d\", \"%m\", \"%Y\"];\n\t\tscale = gantt.getScale();\n\t\tunit = scale ? scale.unit : gantt.config.duration_unit;\n\t\tif (helpers.getSecondsInUnit(unit) < helpers.getSecondsInUnit(\"day\")) {\n\t\t\tresult.push(\"%H:%i\");\n\t\t}\n\t\treturn result;\n\t}\n\n\tfunction getHtmlTimePickerOptions(sns, index, settings) {\n\t\tvar range;\n\t\tvar offset;\n\t\tvar start_year;\n\t\tvar end_year;\n\t\tvar i;\n\t\tvar time;\n\t\tvar diff;\n\t\tvar tdate;\n\t\tvar html = \"\";\n\n\t\tswitch (settings.timeFormat[index]) {\n\t\t\tcase \"%Y\":\n\t\t\t\tsns._time_format_order[2] = index;\n\t\t\t\tsns._time_format_order.size++;\n\t\t\t\t//year\n\n\t\t\t\tif (sns.year_range) {\n\t\t\t\t\tif (!isNaN(sns.year_range)) {\n\t\t\t\t\t\trange = sns.year_range;\n\t\t\t\t\t} else if (sns.year_range.push) {\n\t\t\t\t\t\t// if\n\t\t\t\t\t\tstart_year = sns.year_range[0];\n\t\t\t\t\t\tend_year = sns.year_range[1];\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\trange = range || 10;\n\t\t\t\toffset = offset || Math.floor(range / 2);\n\t\t\t\tstart_year = start_year || settings.date.getFullYear() - offset;\n\t\t\t\tend_year = end_year || gantt.getState().max_date.getFullYear() + offset;\n\n\t\t\t\tfor (i = start_year; i <= end_year; i++)\n\t\t\t\t\thtml += \"<option value='\" + (i) + \"'>\" + (i) + \"</option>\";\n\t\t\t\tbreak;\n\t\t\tcase \"%m\":\n\t\t\t\tsns._time_format_order[1] = index;\n\t\t\t\tsns._time_format_order.size++;\n\t\t\t\t//month\n\t\t\t\tfor (i = 0; i < 12; i++)\n\t\t\t\t\thtml += \"<option value='\" + i + \"'>\" + gantt.locale.date.month_full[i] + \"</option>\";\n\t\t\t\tbreak;\n\t\t\tcase \"%d\":\n\t\t\t\tsns._time_format_order[0] = index;\n\t\t\t\tsns._time_format_order.size++;\n\t\t\t\t//days\n\t\t\t\tfor (i = 1; i < 32; i++)\n\t\t\t\t\thtml += \"<option value='\" + i + \"'>\" + i + \"</option>\";\n\t\t\t\tbreak;\n\t\t\tcase \"%H:%i\":\n\t\t\t\t//  var last = 24*60, first = 0;\n\t\t\t\tsns._time_format_order[3] = index;\n\t\t\t\tsns._time_format_order.size++;\n\t\t\t\t//hours\n\t\t\t\ti = settings.first;\n\t\t\t\ttdate = settings.date.getDate();\n\t\t\t\tsns._time_values = [];\n\n\t\t\t\twhile (i < settings.last) {\n\t\t\t\t\ttime = gantt.templates.time_picker(settings.date);\n\t\t\t\t\thtml += \"<option value='\" + i + \"'>\" + time + \"</option>\";\n\t\t\t\t\tsns._time_values.push(i);\n\t\t\t\t\tsettings.date.setTime(settings.date.valueOf() + gantt._get_timepicker_step() * 60 * 1000);\n\t\t\t\t\tdiff = (settings.date.getDate() != tdate) ? 1 : 0; // moved or not to the next day\n\t\t\t\t\ti = diff * 24 * 60 + settings.date.getHours() * 60 + settings.date.getMinutes();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\t\treturn html;\n\t}\n};","import __extends from \"../../../../utils/extends\";\n\nimport Super from \"./base_control\";\n\nexport default function(gantt) {\n\tconst _super = Super(gantt);\n\n\tfunction TemplateControl() {\n\t\tvar self = _super.apply(this, arguments) || this; \n\t\treturn self; \n\t}\n\n\t__extends(TemplateControl, _super);\n\n\n\tTemplateControl.prototype.render = function(sns) {\n\t\tlet height = sns.height ? `${sns.height}px` : '';\n\t\treturn `<div class='gantt_cal_ltext gantt_cal_template gantt_section_${sns.name}' ${height ? `style='height:${height};'` : ''}></div>`;\n\t};\n\n\tTemplateControl.prototype.set_value = function(node, value) {\n\t\tnode.innerHTML = value || \"\";\n\t};\n\n\tTemplateControl.prototype.get_value = function(node) {\n\t\treturn node.innerHTML || \"\";\n\t};\n\n\tTemplateControl.prototype.focus = function() {};\n\n\treturn TemplateControl;\n};","import __extends from \"../../../../utils/extends\";\n\nimport Super from \"./base_control\";\n\nexport default function(gantt) {\n\tconst _super = Super(gantt);\n\n\tfunction TextareaControl() {\n\t\tvar self = _super.apply(this, arguments) || this;\n\n\t\treturn self; \n\t}\n\n\t__extends(TextareaControl, _super);\n\n\tTextareaControl.prototype.render = function(sns) {\n\t\tconst height = (sns.height || \"130\") + \"px\";\n\t\tconst placeholder = sns.placeholder ? `placeholder='${sns.placeholder}'` : \"\";\n\t\treturn `<div class='gantt_cal_ltext gantt_section_${sns.name}' style='height:${height};' ${placeholder}><textarea></textarea></div>`;\n\t};\n\n\tTextareaControl.prototype.set_value = function(node, value) {\n\t\tgantt.form_blocks.textarea._get_input(node).value = value || \"\";\n\t};\n\n\tTextareaControl.prototype.get_value = function(node) {\n\t\treturn gantt.form_blocks.textarea._get_input(node).value;\n\t};\n\n\tTextareaControl.prototype.focus = function(node) {\n\t\tvar a = gantt.form_blocks.textarea._get_input(node);\n\t\tgantt._focus(a, true);\n\t};\n\n\tTextareaControl.prototype._get_input = function(node) {\n\t\treturn node.querySelector(\"textarea\");\n\t};\n\n\treturn TextareaControl;\n};","import __extends from \"../../../../utils/extends\";\n\nimport Super from \"./base_control\";\n\nexport default function(gantt) {\n\tconst _super = Super(gantt);\n\n\tfunction TimeControl() {\n\t\tvar self = _super.apply(this, arguments) || this;\n\n\t\treturn self;\n\t}\n\n\t__extends(TimeControl, _super);\n\n\tTimeControl.prototype.render = function (sns) {\n\t\tvar time = gantt.form_blocks.getTimePicker.call(this, sns);\n\t\tlet sectionClassName = \"gantt_section_time\";\n\t\tif (sns.name !== \"time\"){\n\t\t\tsectionClassName += \" gantt_section_\" + sns.name;\n\t\t}\n\t\tvar html = \"<div style='padding-top:0px;font-size:inherit;text-align:center;' class='\" + sectionClassName + \"'>\";\n\t\thtml += time;\n\n\t\tif (sns.single_date) {\n\t\t\ttime = gantt.form_blocks.getTimePicker.call(this, sns, true);\n\t\t\thtml += \"<span></span>\";\n\t\t} else {\n\t\t\thtml += \"<span class='gantt_section_time_spacer'> &nbsp;&ndash;&nbsp; </span>\";\n\t\t}\n\n\t\thtml += time;\n\t\thtml += \"</div>\";\n\t\treturn html;\n\t};\n\n\tTimeControl.prototype.set_value = function (node, value, ev, config) {\n\t\tvar cfg = config;\n\t\tvar s = node.getElementsByTagName(\"select\");\n\t\tvar map = config._time_format_order;\n\n\t\tif (cfg.auto_end_date) {\n\t\t\tvar _update_lightbox_select = function () {\n\t\t\t\tstart_date = new Date(s[map[2]].value, s[map[1]].value, s[map[0]].value, 0, 0);\n\t\t\t\tend_date = gantt.calculateEndDate({ start_date: start_date, duration: 1, task: ev });\n\t\t\t\tgantt.form_blocks._fill_lightbox_select(s, map.size, end_date, map, cfg);\n\t\t\t};\n\t\t\tfor (var i = 0; i < 4; i++) {\n\t\t\t\ts[i].onchange = _update_lightbox_select;\n\t\t\t}\n\t\t}\n\n\t\tvar mapping = gantt._resolve_default_mapping(config);\n\n\t\tif (typeof (mapping) === \"string\") mapping = { start_date: mapping };\n\n\t\tvar start_date = ev[mapping.start_date] || new Date();\n\t\tvar end_date = ev[mapping.end_date] || gantt.calculateEndDate({\n\t\t\tstart_date: start_date,\n\t\t\tduration: 1,\n\t\t\ttask: ev\n\t\t});\n\n\t\tgantt.form_blocks._fill_lightbox_select(s, 0, start_date, map, cfg);\n\t\tgantt.form_blocks._fill_lightbox_select(s, map.size, end_date, map, cfg);\n\t};\n\n\tTimeControl.prototype.get_value = function (node, ev, config) {\n\t\tvar selects = node.getElementsByTagName(\"select\");\n\t\tvar startDate;\n\t\tvar map = config._time_format_order;\n\t\tfunction _getEndDate(selects, map, startDate) {\n\t\t\tvar endDate = gantt.form_blocks.getTimePickerValue(selects, config, map.size);\n\t\t\t// GS-1010: We need to add a way to obtain exact end_date for validation\n\t\t\tif (endDate <= startDate) {  // when end date seems wrong\n\t\t\t\tif (config.autofix_end !== false || config.single_date) { // auto correct it in two cases - when the auto correction is not disabled, or when we have 'single date' control and the user don't have the UI to specify the end date\n\t\t\t\t\treturn gantt.date.add(startDate, gantt._get_timepicker_step(), \"minute\");\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn endDate;\n\t\t}\n\n\t\tstartDate = gantt.form_blocks.getTimePickerValue(selects, config);\n\n\t\tif (typeof gantt._resolve_default_mapping(config) === \"string\") {\n\t\t\treturn startDate;\n\t\t}\n\n\t\treturn {\n\t\t\tstart_date: startDate,\n\t\t\tend_date: _getEndDate(selects, map, startDate)\n\t\t};\n\t};\n\n\tTimeControl.prototype.focus = function (node) {\n\t\tgantt._focus(node.getElementsByTagName(\"select\")[0]);\n\t};\n\n\treturn TimeControl;\n};","import * as helpers from \"../../../../utils/helpers\";\nimport __extends from \"../../../../utils/extends\";\nimport BaseConstrutor from \"./base_control\";\n\nexport default function(gantt) {\n\tvar _super = BaseConstrutor(gantt);\n\n\tfunction CheckboxControl() {\n\t\tvar self = _super.apply(this, arguments) || this;\n\n\t\treturn self; \n\t}\n\n\t__extends(CheckboxControl, _super);\n\n\tCheckboxControl.prototype.render = function(sns) {\n\t\tconst height = sns.height ? `height:${sns.height}px;` : '';\n\t\tlet html = `<div class='gantt_cal_ltext gantt_cal_lcheckbox gantt_section_${sns.name}' ${height ? `style='${height}'` : ''}>`;\n\n\t\tif (sns.options && sns.options.length) {\n\t\t\tfor (var i = 0; i < sns.options.length; i++) {\n\t\t\t\thtml += \"<label><input type='checkbox' value='\" + sns.options[i].key + \"' name='\" + sns.name + \"'>\" + sns.options[i].label + \"</label>\";\n\t\t\t}\n\t\t}else{\n\t\t\tsns.single_value = true;\n\t\t\thtml += \"<label><input type='checkbox' name='\" + sns.name + \"'></label>\";\n\t\t}\n\t\thtml += \"</div>\";\n\t\treturn html;\n\t};\n\n\tCheckboxControl.prototype.set_value = function(node, value, ev, sns) {\n\t\tvar checkboxes = Array.prototype.slice.call(node.querySelectorAll(\"input[type=checkbox]\"));\n\n\t\tif (!node._dhx_onchange && sns.onchange) {\n\t\t\tnode.onchange = sns.onchange;\n\t\t\tnode._dhx_onchange = true;\n\t\t}\n\n\t\tif(sns.single_value){\n\t\t\tvar box = checkboxes[0];\n\t\t\tbox.checked = !!value;\n\t\t}else{\n\t\t\thelpers.forEach(checkboxes, function(entry) {\n\t\t\t\tentry.checked = value ? value.indexOf(entry.value) >= 0 : false;\n\t\t\t});\n\t\t}\n\t};\n\n\tCheckboxControl.prototype.get_value = function(node, task, sns) {\n\t\tif(sns.single_value){\n\t\t\tvar box = node.querySelector(\"input[type=checkbox]\");\n\t\t\treturn box.checked;\n\t\t}else{\n\t\t\treturn helpers.arrayMap(Array.prototype.slice.call(node.querySelectorAll(\"input[type=checkbox]:checked\")), function(entry) {\n\t\t\t\treturn entry.value;\n\t\t\t});\n\t\t}\n\t};\n\n\tCheckboxControl.prototype.focus = function(node) {\n\t\tgantt._focus(node.querySelector(\"input[type=checkbox]\"));\n\t};\n\n\treturn CheckboxControl;\n};","import __extends from \"../../../../utils/extends\";\nimport Super from \"./base_control\";\n\nexport default function(gantt) {\n\tconst _super = Super(gantt);\n\n\tfunction RadioControl() {\n\t\tvar self = _super.apply(this, arguments) || this;\n\n\t\treturn self; \n\t}\n\n\t__extends(RadioControl, _super);\n\n\tRadioControl.prototype.render = function(sns) {\n\t\tconst height = sns.height ? `${sns.height}px` : '';\n\t\tlet html = `<div class='gantt_cal_ltext gantt_cal_lradio gantt_section_${sns.name}' ${height ? `style='height:${height};'` : ''}>`;\n\n\t\tif (sns.options && sns.options.length) {\n\t\t\tfor (var i = 0; i < sns.options.length; i++) {\n\t\t\t\thtml += \"<label><input type='radio' value='\" + sns.options[i].key + \"' name='\" + sns.name + \"'>\" + sns.options[i].label + \"</label>\";\n\t\t\t}\n\t\t}\n\n\t\thtml += \"</div>\";\n\t\treturn html;\n\t};\n\n\tRadioControl.prototype.set_value = function(node, value, ev, sns) {\n\t\tvar radio;\n\n\t\tif (!sns.options || !sns.options.length) return;\n\n\t\tradio = node.querySelector(\"input[type=radio][value='\" + value + \"']\") ||\n\t\t\t\tnode.querySelector(\"input[type=radio][value='\" + sns.default_value + \"']\");\n\n\t\tif (!radio) return;\n\n\t\tif (!node._dhx_onchange && sns.onchange) {\n\t\t\tnode.onchange = sns.onchange;\n\t\t\tnode._dhx_onchange = true;\n\t\t}\n\n\t\tradio.checked = true;\n\t};\n\n\tRadioControl.prototype.get_value = function(node, ev) {\n\t\tvar result = node.querySelector(\"input[type=radio]:checked\");\n\n\t\treturn result ? result.value : \"\";\n\t};\n\n\tRadioControl.prototype.focus = function(node) {\n\t\tgantt._focus(node.querySelector(\"input[type=radio]\"));\n\t};\n\n\treturn RadioControl;\n};","import __extends from \"../../../../utils/extends\";\n\nimport DurationFormatterNumeric from  \"../../../common/duration_formatter_numeric\";\nimport BaseConstrutor from \"./base_control\";\n\nexport default function(gantt) {\n\tvar _super = BaseConstrutor(gantt);\n\n\tfunction DurationControl() {\n\t\tvar self = _super.apply(this, arguments) || this; \n\n\t\treturn self; \n\t}\n\n\tfunction getFormatter(config) {\n\t\treturn config.formatter || new DurationFormatterNumeric();\n\t}\n\n\t__extends(DurationControl, _super);\n\n\tDurationControl.prototype.render = function(sns) {\n\t\tvar time = \"<div class='gantt_time_selects'>\" + gantt.form_blocks.getTimePicker.call(this, sns) + \"</div>\";\n\t\tvar label = \" \"+ gantt.locale.labels[gantt.config.duration_unit + \"s\"] +\" \";\n\t\tvar singleDate = sns.single_date ? \" style='display:none'\" : \"\";\n\t\tvar readonly = sns.readonly ? \" disabled='disabled'\" : \"\";\n\t\tvar ariaAttr = gantt._waiAria.lightboxDurationInputAttrString(sns);\n\n\t\tvar durationInputClass = \"gantt_duration_value\";\n\t\tif(sns.formatter) {\n\t\t\tlabel = \"\";\n\t\t\tdurationInputClass += \" gantt_duration_value_formatted\" ;\n\t\t}\n\n\t\tvar duration = \"<div class='gantt_duration' \" + singleDate + \">\" +\n\t\t\"<div class='gantt_duration_inputs'>\" +\n\t\t\t\"<input type='button' class='gantt_duration_dec' value=''\" + readonly + \">\" +\n\t\t\t\"<input type='text' value='5days' class='\"+durationInputClass+\"'\" + readonly + \" \" + ariaAttr + \">\" +\n\t\t\t\"<input type='button' class='gantt_duration_inc' value='+'\" + readonly + \">\"+\n\t\t\t\"</div>\" +\n\t\t\t\"<div class='gantt_duration_end_date'>\"+label+\"<span></span></div>\" +\n\t\t\t\"</div>\" +\n\t\t\t\"</div>\";\n\t\tlet sectionClassName = \"gantt_section_time gantt_section_duration\";\n\t\tif (sns.name !== \"time\"){\n\t\t\tsectionClassName += \" gantt_section_\" + sns.name;\n\t\t}\t\n\t\tvar html = \"<div style='padding-top:0px;font-size:inherit;' class='\" + sectionClassName + \"'>\" + time + \" \" + duration + \"</div>\";\n\t\treturn html;\n\t};\n\n\tDurationControl.prototype.set_value = function(node, value, ev, config) {\n\t\tvar s = node.getElementsByTagName(\"select\");\n\t\tvar inps = node.getElementsByTagName(\"input\");\n\t\tvar duration = inps[1];\n\t\tvar btns = [inps[0], inps[2]];\n\t\tvar endspan = node.getElementsByTagName(\"span\")[0];\n\t\tvar map = config._time_format_order;\n\t\tvar mapping;\n\t\tvar start_date;\n\t\tvar end_date;\n\t\tvar duration_val;\n\n\t\tfunction _calc_date() {\n\t\t\tvar start_date = _getStartDate.call(gantt, node, config);\n\t\t\tvar duration = _getDuration.call(gantt, node, config);\n\t\t\tvar end_date = gantt.calculateEndDate({start_date: start_date, duration: duration, task: ev});\n\n\t\t\tvar template = gantt.templates.task_end_date || gantt.templates.task_date;\n\t\t\tendspan.innerHTML = template(end_date);\n\t\t}\n\n\t\tfunction _change_duration(step) {\n\t\t\tvar value = duration.value;\n\n\t\t\tvalue = getFormatter(config).parse(value);\n\t\t\tif (window.isNaN(value))\n\t\t\t\tvalue = 0;\n\t\t\tvalue += step;\n\t\t\tif (value < 1) value = 1;\n\t\t\tduration.value = getFormatter(config).format(value);\n\t\t\t_calc_date();\n\t\t}\n\n\t\tbtns[0].onclick = gantt.bind(function() {\n\t\t\t_change_duration(-1 * gantt.config.duration_step);\n\t\t}, this);\n\t\tbtns[1].onclick = gantt.bind(function() {\n\t\t\t_change_duration(1 * gantt.config.duration_step);\n\t\t}, this);\n\t\ts[0].onchange = _calc_date;\n\t\ts[1].onchange = _calc_date;\n\t\ts[2].onchange = _calc_date;\n\t\tif (s[3]) s[3].onchange = _calc_date;\n\n\t\tduration.onkeydown = gantt.bind(function(e) {\n\t\t\tvar code; \n\n\t\t\te = e || window.event;\n\t\t\tcode = (e.charCode || e.keyCode || e.which);\n\t\t\t\n\t\t\tif (code == gantt.constants.KEY_CODES.DOWN) {\n\t\t\t\t_change_duration(-1 * gantt.config.duration_step);\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (code == gantt.constants.KEY_CODES.UP) {\n\t\t\t\t_change_duration(1 * gantt.config.duration_step);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\twindow.setTimeout(_calc_date, 1);\n\t\t}, this);\n\n\t\tduration.onchange = gantt.bind(_calc_date, this);\n\n\t\tmapping = gantt._resolve_default_mapping(config);\n\t\tif (typeof(mapping) === \"string\") mapping = {start_date: mapping};\n\n\t\tstart_date = ev[mapping.start_date] || new Date();\n\t\tend_date = ev[mapping.end_date] || gantt.calculateEndDate({\n\t\t\tstart_date: start_date,\n\t\t\tduration: 1,\n\t\t\ttask: ev\n\t\t});\n\t\tduration_val = Math.round(ev[mapping.duration]) || gantt.calculateDuration({\n\t\t\tstart_date: start_date,\n\t\t\tend_date: end_date,\n\t\t\ttask: ev\n\t\t});\n\t\tduration_val = getFormatter(config).format(duration_val);\n\n\t\tgantt.form_blocks._fill_lightbox_select(s, 0, start_date, map, config);\n\t\tduration.value = duration_val;\n\t\t_calc_date();\n\t};\n\n\tDurationControl.prototype.get_value = function(node, ev, config) {\n\t\tvar startDate = _getStartDate(node, config);\n\t\tvar duration = _getDuration(node, config);\n\t\tvar endDate = gantt.calculateEndDate({start_date: startDate, duration: duration, task: ev});\n\n\t\tif (typeof gantt._resolve_default_mapping(config) == \"string\") {\n\t\t\treturn startDate;\n\t\t}\n\n\t\treturn {\n\t\t\tstart_date: startDate,\n\t\t\tend_date: endDate,\n\t\t\tduration: duration\n\t\t};\n\t};\n\n\tDurationControl.prototype.focus = function(node) {\n\t\tgantt._focus(node.getElementsByTagName(\"select\")[0]);\n\t};\n\n\n\tfunction _getStartDate(node, config) {\n\t\tvar s = node.getElementsByTagName(\"select\");\n\t\tvar map = config._time_format_order;\n\t\tvar hours = 0;\n\t\tvar minutes = 0;\n\n\t\tif (gantt.defined(map[3])) {\n\t\t\tvar input = s[map[3]];\n\t\t\tvar time = parseInt(input.value, 10);\n\t\t\tif (isNaN(time) && input.hasAttribute(\"data-value\")) {\n\t\t\t\ttime = parseInt(input.getAttribute(\"data-value\"), 10);\n\t\t\t}\n\n\t\t\thours = Math.floor(time / 60);\n\t\t\tminutes = time % 60;\n\t\t}\n\t\treturn new Date(s[map[2]].value, s[map[1]].value, s[map[0]].value, hours, minutes);\n\t}\n\n\tfunction _getDuration(node, config) {\n\t\tvar duration = node.getElementsByTagName(\"input\")[1];\n\n\t\tduration = getFormatter(config).parse(duration.value);\n\t\tif (!duration || window.isNaN(duration)) duration = 1;\n\t\tif (duration < 0) duration *= -1;\n\t\treturn duration;\n\t}\n\n\treturn DurationControl; \n};","import __extends from \"../../../../utils/extends\";\nimport htmlHelpers from \"../../utils/html_helpers\";\nimport BaseConstrutor from \"./base_control\";\n\nexport default function(gantt) {\n\tvar _super = BaseConstrutor(gantt);\n\n\tfunction ConstraintControl() {\n\t\tvar self = _super.apply(this, arguments) || this;\n\t\treturn self;\n\t}\n\n\t__extends(ConstraintControl, _super);\n\n\tfunction isNonTimedConstraint(value) {\n\t\tif (!value || value === gantt.config.constraint_types.ASAP || value === gantt.config.constraint_types.ALAP) {\n\t\t\treturn true;\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tfunction toggleTimeSelect(timeSelects, typeValue) {\n\t\tvar isNonTimed = isNonTimedConstraint(typeValue);\n\t\tfor (var i = 0; i < timeSelects.length; i++) {\n\t\t\ttimeSelects[i].disabled = isNonTimed;\n\t\t}\n\t}\n\n\tConstraintControl.prototype.render = function (sns) {\n\t\tconst height = sns.height ? `height:${sns.height}px;` : '';\n\t\tlet html = `<div class='gantt_cal_ltext gantt_section_${sns.name}' ${height ? `style='${height}'` : ''}>`;\n\n\t\tvar options = [];\n\t\tfor (var i in gantt.config.constraint_types) {\n\t\t\toptions.push({ key: gantt.config.constraint_types[i], label: gantt.locale.labels[gantt.config.constraint_types[i]] });\n\t\t}\n\n\t\tsns.options = sns.options || options;\n\n\t\thtml += \"<span data-constraint-type-select>\" + htmlHelpers.getHtmlSelect(sns.options, [{ key: \"data-type\", value: \"constraint-type\" }]) + \"</span>\";\n\n\t\tvar timeLabel = gantt.locale.labels[\"constraint_date\"] || \"Constraint date\";\n\t\thtml += \"<label data-constraint-time-select>\" + timeLabel + \": \" + gantt.form_blocks.getTimePicker.call(this, sns) + \"</label>\";\n\n\t\thtml += \"</div>\";\n\t\treturn html;\n\t};\n\n\tConstraintControl.prototype.set_value = function (node, value, task, config) {\n\t\tvar typeSelect = node.querySelector(\"[data-constraint-type-select] select\");\n\t\tvar timeSelects = node.querySelectorAll(\"[data-constraint-time-select] select\");\n\t\tvar map = config._time_format_order;\n\n\t\tvar mapping = gantt._resolve_default_mapping(config);\n\n\t\tif (!typeSelect._eventsInitialized) {\n\t\t\ttypeSelect.addEventListener(\"change\", function (e) {\n\t\t\t\ttoggleTimeSelect(timeSelects, e.target.value);\n\t\t\t});\n\t\t\ttypeSelect._eventsInitialized = true;\n\t\t}\n\n\t\tvar constraintDate = task[mapping.constraint_date] || new Date();\n\t\tgantt.form_blocks._fill_lightbox_select(timeSelects, 0, constraintDate, map, config);\n\n\t\tvar constraintType = task[mapping.constraint_type] || gantt.getConstraintType(task);\n\t\ttypeSelect.value = constraintType;\n\t\ttoggleTimeSelect(timeSelects, constraintType);\n\t};\n\n\tConstraintControl.prototype.get_value = function (node, task, config) {\n\t\tvar typeSelect = node.querySelector(\"[data-constraint-type-select] select\");\n\t\tvar timeSelects = node.querySelectorAll(\"[data-constraint-time-select] select\");\n\n\t\tvar constraintType = typeSelect.value;\n\t\tvar constraintDate = null;\n\t\tif (!isNonTimedConstraint(constraintType)) {\n\t\t\tconstraintDate = gantt.form_blocks.getTimePickerValue(timeSelects, config);\n\t\t}\n\n\t\treturn {\n\t\t\tconstraint_type: constraintType,\n\t\t\tconstraint_date: constraintDate\n\t\t};\n\t};\n\n\tConstraintControl.prototype.focus = function (node) {\n\t\tgantt._focus(node.querySelector(\"select\"));\n\t};\n\n\treturn ConstraintControl;\n};","import __extends from \"../../../../utils/extends\";\n\nimport Super from \"./select_control\";\n\nexport default function(gantt) {\n\tconst _super = Super(gantt);\n\n\tfunction TypeselectControl() {\n\t\tvar self = _super.apply(this, arguments) || this;\n\n\t\treturn self;\n\t}\n\n\t__extends(TypeselectControl, _super);\n\n\tTypeselectControl.prototype.render = function(sns) {\n\t\tvar types = gantt.config.types,\n\t\t\tlocale = gantt.locale.labels,\n\t\t\toptions = [];\n\n\t\tvar filter = sns.filter || function (typeKey, typeValue) {\n\t\t\tif (!types.placeholder || typeValue !== types.placeholder) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn false;\n\t\t};\n\t\tfor (var i in types) {\n\t\t\tif (!filter(i, types[i]) === false) {\n\t\t\t\toptions.push({ key: types[i], label: locale[\"type_\" + i] });\n\t\t\t}\n\t\t}\n\t\tsns.options = options;\n\n\t\tvar oldOnChange = sns.onchange;\n\t\tsns.onchange = function () {\n\t\t\tgantt._lightbox_current_type = this.value;\n\t\t\tgantt.changeLightboxType(this.value);\n\t\t\tif (typeof oldOnChange == 'function') {\n\t\t\t\toldOnChange.apply(this, arguments);\n\t\t\t}\n\t\t};\n\n\t\treturn _super.prototype.render.apply(this, arguments);\n\t};\n\n\treturn TypeselectControl;\n};\n","\nimport __extends from \"../../../../utils/extends\";\nimport DurationFormatterNumeric from \"../../../common/duration_formatter_numeric\";\nimport BaseConstrutor from \"./base_control\";\n\nexport default function(gantt) {\n\tvar _super = BaseConstrutor(gantt);\n\n\tfunction DurationControl() {\n\t\tvar self = _super.apply(this, arguments) || this; \n\n\t\treturn self; \n\t}\n\n\tfunction getFormatter(config) {\n\t\treturn config.formatter || new DurationFormatterNumeric();\n\t}\n\n\tfunction _generateBaselineRow (node, baseline, task, config){\n\t\tconst time = \"<div class='gantt_time_selects'>\" + gantt.form_blocks.getTimePicker.call(gantt, config) + \"</div>\";\n\t\tlet durationLabel = \" \"+ gantt.locale.labels[gantt.config.duration_unit + \"s\"] +\" \";\n\t\tconst singleDate = config.single_date ? \" style='display:none'\" : \"\";\n\t\tconst readonly = config.readonly ? \" disabled='disabled'\" : \"\";\n\t\tconst ariaAttr = gantt._waiAria.lightboxDurationInputAttrString(config);\n\t\tconst deleteLabel = gantt.locale.labels.baselines_remove_button;\n\n\t\tlet durationInputClass = \"gantt_duration_value\";\n\t\tif(config.formatter) {\n\t\t\tdurationLabel = \"\";\n\t\t\tdurationInputClass += \" gantt_duration_value_formatted\";\n\t\t}\n\n\t\tconst durationEl = \"<div class='gantt_duration' \" + singleDate + \">\" +\n\t\t\"<div class='gantt_duration_inputs'>\" +\n\t\t\t\"<input type='button' class='gantt_duration_dec' value='-'\" + readonly + \">\" +\n\t\t\t\"<input type='text' value='5days' class='\"+durationInputClass+\"'\" + readonly + \" \" + ariaAttr + \">\" +\n\t\t\t\"<input type='button' class='gantt_duration_inc' value='+'\" + readonly + \">\"+\n\t\t\t\"</div>\" +\n\t\t\t\"<div class='gantt_duration_end_date'>\"+durationLabel+\"<span></span></div>\" +\n\t\t\t\"</div>\" +\n\t\t\t\"</div>\";\n\n\t\tconst deleteButton = `<div><div class='baseline_delete_button gantt_custom_button dhx_gantt_icon dhx_gantt_icon_delete' aria-label='${deleteLabel}'></div></div>`;\n\n\t\tconst baselineRow = document.createElement(\"div\");\n\t\tbaselineRow.className = \"gantt_section_time gantt_section_duration\";\n\t\tbaselineRow.setAttribute(\"data-baseline-id\", baseline.id);\n\t\tbaselineRow.innerHTML = time + durationEl + deleteButton + \"<br>\";\n\t\tnode.appendChild(baselineRow);\n\n\t\tvar s = baselineRow.getElementsByTagName(\"select\");\n\t\tvar inps = baselineRow.getElementsByTagName(\"input\");\n\t\tvar duration = inps[1];\n\t\tvar btns = [inps[0], inps[2]];\n\t\tvar endspan = baselineRow.getElementsByTagName(\"span\")[0];\n\t\tvar map = config._time_format_order;\n\t\tvar mapping;\n\t\tvar start_date;\n\t\tvar end_date;\n\t\tvar duration_val;\n\n\t\tconst deleteEl = baselineRow.querySelector(\".baseline_delete_button\");\n\t\tdeleteEl.onclick = function(e){\n\t\t\tconst section = baselineRow.parentNode;\n\t\t\tbaselineRow.innerHTML = \"\";\n\t\t\tbaselineRow.remove();\n\t\t\tif (section.innerHTML === \"\"){\n\t\t\t\tsection.innerHTML = gantt.locale.labels.baselines_section_placeholder;\n\t\t\t}\n\t\t};\n\t\t\n\n\t\tfunction _calc_date() {\n\t\t\tvar start_date = _getStartDate.call(gantt, baselineRow, config);\n\t\t\tvar duration = _getDuration.call(gantt, baselineRow, config);\n\t\t\tvar end_date = gantt.calculateEndDate({start_date: start_date, duration: duration, task: task});\n\n\t\t\tvar template = gantt.templates.task_end_date || gantt.templates.task_date;\n\t\t\tendspan.innerHTML = template(end_date);\n\t\t}\n\n\t\tfunction _change_duration(step) {\n\t\t\tvar value = duration.value;\n\n\t\t\tvalue = getFormatter(config).parse(value);\n\t\t\tif (window.isNaN(value))\n\t\t\t\tvalue = 0;\n\t\t\tvalue += step;\n\t\t\tif (value < 1) value = 1;\n\t\t\tduration.value = getFormatter(config).format(value);\n\t\t\t_calc_date();\n\t\t}\n\n\t\tbtns[0].onclick = gantt.bind(function() {\n\t\t\t_change_duration(-1 * gantt.config.duration_step);\n\t\t}, gantt);\n\t\tbtns[1].onclick = gantt.bind(function() {\n\t\t\t_change_duration(1 * gantt.config.duration_step);\n\t\t}, gantt);\n\t\ts[0].onchange = _calc_date;\n\t\ts[1].onchange = _calc_date;\n\t\ts[2].onchange = _calc_date;\n\t\tif (s[3]) s[3].onchange = _calc_date;\n\n\t\tduration.onkeydown = gantt.bind(function(e) {\n\t\t\tvar code; \n\n\t\t\te = e || window.event;\n\t\t\tcode = (e.charCode || e.keyCode || e.which);\n\t\t\t\n\t\t\tif (code == gantt.constants.KEY_CODES.DOWN) {\n\t\t\t\t_change_duration(-1 * gantt.config.duration_step);\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (code == gantt.constants.KEY_CODES.UP) {\n\t\t\t\t_change_duration(1 * gantt.config.duration_step);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\twindow.setTimeout(_calc_date, 1);\n\t\t}, gantt);\n\n\t\tduration.onchange = gantt.bind(_calc_date, gantt);\n\n\t\tmapping = gantt._resolve_default_mapping(config);\n\t\tif (typeof(mapping) === \"string\") mapping = {start_date: mapping};\n\n\t\tstart_date = baseline.start_date || new Date();\n\t\tend_date = baseline.end_date || gantt.calculateEndDate({\n\t\t\tstart_date: start_date,\n\t\t\tduration: 1,\n\t\t\ttask\n\t\t});\n\t\tduration_val = gantt.calculateDuration({\n\t\t\tstart_date: start_date,\n\t\t\tend_date: end_date,\n\t\t\ttask\n\t\t});\n\t\tduration_val = getFormatter(config).format(duration_val);\n\n\t\tgantt.form_blocks._fill_lightbox_select(s, 0, start_date, map, config);\n\t\tduration.value = duration_val;\n\t\t_calc_date();\n\t}\n\n\t__extends(DurationControl, _super);\n\n\tDurationControl.prototype.render = function(sns) {\n\t\tconst baselineSection = `<div style='height: ${sns.height || 110}px; font-size:inherit;' class='gantt_section_baselines'></div>`;\n\t\treturn baselineSection;\n\t};\n\n\tDurationControl.prototype.set_value = function(node, value, task, config) {\n\t\tif (task.baselines){\n\t\t\tnode.innerHTML = \"\";\n\n\t\t\ttask.baselines.forEach((baseline)=>{\n\t\t\t\t_generateBaselineRow(node, baseline, task, config);\n\t\t\t});\n\t\t} else {\n\t\t\tnode.innerHTML = gantt.locale.labels.baselines_section_placeholder;\n\t\t}\t\t\n\n\t};\n\n\tDurationControl.prototype.get_value = function(node, task, config) {\n\t\tconst baselines = [];\n\t\tconst baselineRows = node.querySelectorAll(`[data-baseline-id]`);\n\t\tbaselineRows.forEach((baselineNode)=>{\n\t\t\tconst baselineId = baselineNode.dataset.baselineId;\n\t\t\tconst baselineStore = gantt.getDatastore(\"baselines\");\n\t\t\tlet baseline = baselineStore.getItem(baselineId);\n\t\t\tlet updatedBaseline;\n\t\t\tif (baseline){\n\t\t\t\tupdatedBaseline = gantt.copy(baseline);\n\t\t\t} else {\n\t\t\t\tupdatedBaseline = {\n\t\t\t\t\tid: gantt.uid(),\n\t\t\t\t\ttask_id: task.id,\n\t\t\t\t\ttext: \"Baseline 1\"\n\t\t\t\t};\n\t\t\t}\n\t\t\tupdatedBaseline.start_date = _getStartDate(baselineNode, config);\n\t\t\tupdatedBaseline.duration = _getDuration(baselineNode, config);\n\t\t\tupdatedBaseline.end_date = gantt.calculateEndDate({start_date: updatedBaseline.start_date, duration: updatedBaseline.duration, task});\n\n\t\t\tbaselines.push(updatedBaseline);\n\t\t});\n\n\t\treturn baselines;\n\t};\n\n\tDurationControl.prototype.button_click = function (index, el, section, container) {\n\t\tif (gantt.callEvent(\"onSectionButton\", [gantt._lightbox_id, section]) === false) {\n\t\t\treturn;\n\t\t}\n\t\tif (el.closest(\".gantt_custom_button.gantt_remove_baselines\")){\n\t\t\tcontainer.innerHTML = gantt.locale.labels.baselines_section_placeholder;\n\t\t}\n\t\tif (el.closest(\".gantt_custom_button.gantt_add_baselines\")){\n\t\t\tif (container.innerHTML == gantt.locale.labels.baselines_section_placeholder){\n\t\t\t\tcontainer.innerHTML = \"\";\n\t\t\t}\n\t\t\tconst task = gantt.getTask(gantt._lightbox_id);\n\t\t\tconst baseline = {\n\t\t\t\tid: gantt.uid(),\n\t\t\t\ttask_id: task.id,\n\t\t\t\ttext: \"Baseline 1\",\n\t\t\t\tstart_date: task.start_date,\n\t\t\t\tend_date: task.end_date\n\t\t\t};\n\t\t\tconst config = gantt._get_typed_lightbox_config()[index];\n\t\t\t_generateBaselineRow(container, baseline, task, config);\n\t\t}\n\t};\n\n\tDurationControl.prototype.focus = function(node) {\n\t\tgantt._focus(node.getElementsByTagName(\"select\")[0]);\n\t};\n\n\n\tfunction _getStartDate(node, config) {\n\t\tvar s = node.getElementsByTagName(\"select\");\n\t\tvar map = config._time_format_order;\n\t\tvar hours = 0;\n\t\tvar minutes = 0;\n\n\t\tif (gantt.defined(map[3])) {\n\t\t\tvar input = s[map[3]];\n\t\t\tvar time = parseInt(input.value, 10);\n\t\t\tif (isNaN(time) && input.hasAttribute(\"data-value\")) {\n\t\t\t\ttime = parseInt(input.getAttribute(\"data-value\"), 10);\n\t\t\t}\n\n\t\t\thours = Math.floor(time / 60);\n\t\t\tminutes = time % 60;\n\t\t}\n\t\treturn new Date(s[map[2]].value, s[map[1]].value, s[map[0]].value, hours, minutes);\n\t}\n\n\tfunction _getDuration(node, config) {\n\t\tvar duration = node.getElementsByTagName(\"input\")[1];\n\n\t\tduration = getFormatter(config).parse(duration.value);\n\t\tif (!duration || window.isNaN(duration)) duration = 1;\n\t\tif (duration < 0) duration *= -1;\n\t\treturn duration;\n\t}\n\n\treturn DurationControl; \n};","import * as utils from \"../utils/utils\";\nimport env from \"../utils/env\";\nimport isHeadless from \"../utils/is_headless\";\nimport * as domHelpers from \"./ui/utils/dom_helpers\";\nimport * as codeHelpers from \"../utils/helpers\";\nimport domEventScope from \"./ui/utils/dom_event_scope\";\nimport messages from \"./ui/message\";\nimport ui from \"./ui/index\";\nimport createLayoutFacade from \"./facades/layout\";\nimport taskLayers from \"./data_task_layers\";\n\nimport skin from \"./ui/skin\";\nimport skyblue from \"../css/skins/skyblue\";\nimport meadow from \"../css/skins/meadow\";\nimport terrace from \"../css/skins/terrace\";\nimport broadway from \"../css/skins/broadway\";\nimport material from \"../css/skins/material\";\nimport dark from \"../css/skins/dark\";\nimport contrast_black from \"../css/skins/contrast_black\";\nimport contrast_white from \"../css/skins/contrast_white\";\nimport plugins from \"./ui/plugins\";\nimport touch from \"./ui/touch\";\nimport lightbox from \"./ui/lightbox\";\nimport lightbox_optional_time from \"./ui/lightbox/lightbox_optional_time\";\nimport wai_aria from \"./ui/wai_aria\";\n\n\nexport default function(gantt) {\n\n\tif(!env.isNode){\n\n\t\tgantt.utils = {\n\t\t\tarrayFind: codeHelpers.arrayFind,\n\t\t\tdom: domHelpers\n\t\t};\n\n\t\tvar domEvents = domEventScope();\n\t\tgantt.event = domEvents.attach;\n\t\tgantt.eventRemove = domEvents.detach;\n\t\tgantt._eventRemoveAll = domEvents.detachAll;\n\t\tgantt._createDomEventScope = domEvents.extend;\n\n\t\tutils.mixin(gantt, messages(gantt));\n\t\tvar uiApi = ui.init(gantt);\n\t\tgantt.$ui = uiApi.factory;\n\t\tgantt.$ui.layers = uiApi.render;\n\t\tgantt.$mouseEvents = uiApi.mouseEvents;\n\t\tgantt.$services.setService(\"mouseEvents\", function () {\n\t\t\treturn gantt.$mouseEvents;\n\t\t});\n\t\tgantt.mixin(gantt, uiApi.layersApi);\n\n\t\ttaskLayers(gantt);\n\n\t\tgantt.$services.setService(\"layers\", function () {\n\t\t\treturn uiApi.layersService;\n\t\t});\n\n\t\tgantt.mixin(gantt, createLayoutFacade());\n\t\tskin(gantt);\n\t\tskyblue(gantt);\n\t\tdark(gantt);\n\t\tmeadow(gantt);\n\t\tterrace(gantt);\n\t\tbroadway(gantt);\n\t\tmaterial(gantt);\n\t\tcontrast_black(gantt);\n\t\tcontrast_white(gantt);\n\t\tplugins(gantt);\n\t\ttouch(gantt);\n\t\tlightbox(gantt);\n\t\tlightbox_optional_time(gantt);\n\t\twai_aria(gantt);\n\n\t\tgantt.locate = function(e) {\n\t\t\tvar trg = domHelpers.getTargetNode(e);\n\n\t\t\t// ignore empty rows/cells of the timeline\n\t\t\tif(domHelpers.closest(trg, \".gantt_task_row\")){\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tvar targetAttribute = arguments[1] || this.config.task_attribute;\n\n\t\t\tvar node = domHelpers.locateAttribute(trg, targetAttribute);\n\t\t\tif(node){\n\t\t\t\treturn node.getAttribute(targetAttribute);\n\t\t\t}else{\n\t\t\t\treturn null;\n\t\t\t}\n\t\t};\n\n\t\tgantt._locate_css = function(e, classname, strict){\n\t\t\treturn domHelpers.locateClassName(e, classname, strict);\n\t\t};\n\n\t\tgantt._locateHTML = function(e, attribute) {\n\t\t\treturn domHelpers.locateAttribute(e, attribute || this.config.task_attribute);\n\t\t};\n\t}\n\n\tgantt.attachEvent(\"onParse\", function(){\n\t\tif(!isHeadless(gantt)){\n\t\t\tgantt.attachEvent(\"onGanttRender\", function(){\n\t\t\t\tif(gantt.config.initial_scroll){\n\t\t\t\t\tvar firstTask = gantt.getTaskByIndex(0);\n\t\t\t\t\tvar id = firstTask ? firstTask.id : gantt.config.root_id;\n\t\t\t\t\t// GS-1450. Don't scroll to the task if there is no timeline\n\t\t\t\t\tif(gantt.isTaskExists(id) && gantt.$task && gantt.utils.dom.isChildOf(gantt.$task, gantt.$container)){\n\t\t\t\t\t\tgantt.showTask(id);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}, {once: true});\n\t\t}\n\n\t});\n\n\tgantt.attachEvent(\"onBeforeGanttReady\", function(){\n\t\tif (!this.config.scroll_size)\n\t\t\tthis.config.scroll_size = domHelpers.getScrollSize() || 15;\n\n\t\tif(!isHeadless(gantt)){\n\t\t\t// detach listeners before clearing old DOM, possible IE errors when accessing detached nodes\n\t\t\tthis._eventRemoveAll();\n\t\t\tthis.$mouseEvents.reset();\n\n\t\t\tthis.resetLightbox();\n\t\t}\n\n\t});\n\n\t// GS-1261: scroll the views to the right side when RTL is enabled\n\tgantt.attachEvent(\"onGanttReady\", function(){\n\t\tif(!isHeadless(gantt) && gantt.config.rtl){\n\t\t\tgantt.$layout.getCellsByType(\"viewCell\").forEach(function(cell){ \n\t\t\t\tvar attachedScrollbar = cell.$config.scrollX;\n\t\t\t\tif (!attachedScrollbar) return;\n\n\t\t\t\tvar scrollbar = gantt.$ui.getView(attachedScrollbar);\n\t\t\t\tif (scrollbar) scrollbar.scrollTo(scrollbar.$config.scrollSize,0);\n\n\t\t\t});\n\t\t}\n\t});\n\n\t// GS-1649: check if extensions are connected via files\n\tgantt.attachEvent(\"onGanttReady\", function(){\n\t\tif(!isHeadless(gantt)){\n\n\t\t\tvar activePlugins = gantt.plugins();\n\n\t\t\tvar availablePlugins = {\n\t\t\t\tauto_scheduling: gantt.autoSchedule,\n\t\t\t\tclick_drag: gantt.ext.clickDrag,\n\t\t\t\tcritical_path: gantt.isCriticalTask,\n\t\t\t\tdrag_timeline: gantt.ext.dragTimeline,\n\t\t\t\texport_api: gantt.exportToPDF,\n\t\t\t\tfullscreen: gantt.ext.fullscreen,\n\t\t\t\tgrouping: gantt.groupBy,\n\t\t\t\tkeyboard_navigation: gantt.ext.keyboardNavigation,\n\t\t\t\tmarker: gantt.addMarker,\n\t\t\t\tmultiselect: gantt.eachSelectedTask,\n\t\t\t\toverlay: gantt.ext.overlay,\n\t\t\t\tquick_info: gantt.templates.quick_info_content,\n\t\t\t\ttooltip: gantt.ext.tooltips,\n\t\t\t\tundo: gantt.undo\n\t\t\t};\n\n\t\t\tfor (let plugin in availablePlugins){\n\t\t\t\tif (availablePlugins[plugin] && !activePlugins[plugin]){\n\t\t\t\t\t// eslint-disable-next-line no-console\n\t\t\t\t\tconsole.warn(`You connected the '${plugin}' extension via an obsolete file. \nTo fix it, you need to remove the obsolete file and connect the extension via the plugins method: https://docs.dhtmlx.com/gantt/api__gantt_plugins.html`);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n};","function createLayoutFacade(){\n\n\tfunction getTimeline(gantt){\n\t\treturn gantt.$ui.getView(\"timeline\");\n\t}\n\n\tfunction getGrid(gantt){\n\t\treturn gantt.$ui.getView(\"grid\");\n\t}\n\n\tfunction getBaseCell(gantt){\n\t\tvar timeline = getTimeline(gantt);\n\t\tif (timeline && !timeline.$config.hidden){\n\t\t\treturn timeline;\n\t\t} else{\n\t\t\tvar grid = getGrid(gantt);\n\t\t\tif (grid && !grid.$config.hidden){\n\t\t\t\treturn grid;\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction getVerticalScrollbar(gantt){\n\t\tvar baseCell = null;\n\t\t// GS-1150: if we reorder or resize something in the grid, we should obtain the grid container\n\t\tvar gridDrag = false;\n\t\tvar gridMarkers = [\n\t\t\t\".gantt_drag_marker.gantt_grid_resize_area\",\n\t\t\t\".gantt_drag_marker .gantt_row.gantt_row_task\",\n\t\t\t\".gantt_drag_marker.gantt_grid_dnd_marker\"\n\t\t];\n\t\tgridMarkers.forEach(function (selector) {\n\t\t\tgridDrag = gridDrag || !!document.querySelector(selector);\n\t\t});\n\t\tif (gridDrag){\n\t\t\tbaseCell = getGrid(gantt);\n\t\t} else{\n\t\t\tbaseCell = getBaseCell(gantt);\n\t\t}\n\n\t\t// GS-1827. If there is no grid and timeline, there is no scrollbar for them\n\t\tif (!baseCell){\n\t\t\treturn null;\n\t\t}\n\n\t\tvar verticalScrollbar = getAttachedScrollbar(gantt, baseCell, \"scrollY\");\n\t\treturn verticalScrollbar;\n\t}\n\n\tfunction getHorizontalScrollbar(gantt){\n\t\tvar baseCell = getBaseCell(gantt);\n\t\tif (!baseCell || baseCell.id == \"grid\"){\n\t\t\treturn null; // if the timeline is not displayed, do not return the scrollbar\n\t\t}\n\t\tvar horizontalScrollbar = getAttachedScrollbar(gantt, baseCell, \"scrollX\");\n\t\treturn horizontalScrollbar;\n\t}\n\n\tfunction getAttachedScrollbar(gantt, cell, type){\n\t\tvar attachedScrollbar = cell.$config[type];\n\t\tvar scrollbarView = gantt.$ui.getView(attachedScrollbar);\n\t\treturn scrollbarView;\n\t}\n\n\tvar DEFAULT_VALUE = \"DEFAULT_VALUE\";\n\n\tfunction tryCall(getView, method, args, fallback){\n\t\tvar view = getView(this);\n\t\tif (!(view && view.isVisible())) {\n\t\t\tif(fallback){\n\t\t\t\treturn fallback();\n\t\t\t}else{\n\t\t\t\treturn DEFAULT_VALUE;\n\t\t\t}\n\t\t} else {\n\t\t\treturn view[method].apply(view, args);\n\t\t}\n\t}\n\n\treturn {\n\n\t\tgetColumnIndex: function(name) {\n\t\t\tvar res = tryCall.call(this, getGrid, \"getColumnIndex\", [name]);\n\t\t\tif(res === DEFAULT_VALUE){\n\t\t\t\treturn 0;\n\t\t\t}else{\n\t\t\t\treturn res;\n\t\t\t}\n\t\t},\n\n\t\tdateFromPos: function(x) {\n\t\t\tvar res = tryCall.call(this, getTimeline, \"dateFromPos\", Array.prototype.slice.call(arguments));\n\t\t\tif(res === DEFAULT_VALUE){\n\t\t\t\treturn this.getState().min_date;\n\t\t\t}else{\n\t\t\t\treturn res;\n\t\t\t}\n\t\t},\n\n\t\tposFromDate: function(date) {\n\t\t\tvar res = tryCall.call(this, getTimeline, \"posFromDate\", Array.prototype.slice.call(arguments));\n\t\t\tif(res === DEFAULT_VALUE){\n\t\t\t\treturn 0;\n\t\t\t}else{\n\t\t\t\treturn res;\n\t\t\t}\n\t\t},\n\n\t\tgetRowTop: function(index) {\n\t\t\tvar self = this;\n\t\t\tvar res = tryCall.call(self, getTimeline, \"getRowTop\", [index],\n\t\t\t\tfunction(){ return tryCall.call(self, getGrid, \"getRowTop\", [index]);}\n\t\t\t\t);\n\n\t\t\tif(res === DEFAULT_VALUE){\n\t\t\t\treturn 0;\n\t\t\t}else{\n\t\t\t\treturn res;\n\t\t\t}\n\t\t},\n\n\t\tgetTaskTop: function(id) {\n\t\t\tvar self = this;\n\t\t\tvar res = tryCall.call(self, getTimeline, \"getItemTop\", [id],\n\t\t\t\tfunction(){ return tryCall.call(self, getGrid, \"getItemTop\", [id]);}\n\t\t\t);\n\n\t\t\tif(res === DEFAULT_VALUE){\n\t\t\t\treturn 0;\n\t\t\t}else{\n\t\t\t\treturn res;\n\t\t\t}\n\t\t},\n\n\n\t\tgetTaskPosition: function(task, start_date, end_date) {\n\t\t\tvar res = tryCall.call(this, getTimeline, \"getItemPosition\", [task, start_date, end_date]);\n\n\t\t\tif(res === DEFAULT_VALUE){\n\t\t\t\tvar top = this.getTaskTop(task.id);\n\t\t\t\tvar height = this.getTaskBarHeight(task.id);\n\n\t\t\t\treturn {\n\t\t\t\t\tleft: 0,\n\t\t\t\t\ttop: top,\n\t\t\t\t\theight: height,\n\t\t\t\t\twidth: 0\n\t\t\t\t};\n\t\t\t}else{\n\t\t\t\treturn res;\n\t\t\t}\n\t\t},\n\n\t\tgetTaskBarHeight: function(taskId, isMilestoneRender) {\n\t\t\tvar self = this;\n\t\t\tvar res = tryCall.call(self, getTimeline, \"getBarHeight\", [taskId, isMilestoneRender],\n\t\t\t\tfunction(){ return tryCall.call(self, getGrid, \"getItemHeight\", [taskId]);}\n\t\t\t);\n\n\t\t\tif(res === DEFAULT_VALUE){\n\t\t\t\treturn 0;\n\t\t\t}else{\n\t\t\t\treturn res;\n\t\t\t}\n\t\t},\n\n\t\tgetTaskHeight: function(taskId) {\n\t\t\tvar self = this;\n\t\t\tvar res = tryCall.call(self, getTimeline, \"getItemHeight\", [taskId],\n\t\t\t\tfunction(){ return tryCall.call(self, getGrid, \"getItemHeight\", [taskId]);}\n\t\t\t);\n\n\t\t\tif(res === DEFAULT_VALUE){\n\t\t\t\treturn 0;\n\t\t\t}else{\n\t\t\t\treturn res;\n\t\t\t}\n\t\t},\n\n\n\t\tcolumnIndexByDate: function(date) {\n\t\t\tvar res = tryCall.call(this, getTimeline, \"columnIndexByDate\", [date]);\n\t\t\tif(res === DEFAULT_VALUE){\n\t\t\t\treturn 0;\n\t\t\t}else{\n\t\t\t\treturn res;\n\t\t\t}\n\t\t},\n\n\t\troundTaskDates: function() {\n\t\t\ttryCall.call(this, getTimeline, \"roundTaskDates\", []);\n\t\t},\n\n\t\tgetScale: function() {\n\t\t\tvar res = tryCall.call(this, getTimeline, \"getScale\", []);\n\t\t\tif(res === DEFAULT_VALUE){\n\t\t\t\treturn null;\n\t\t\t}else{\n\t\t\t\treturn res;\n\t\t\t}\n\t\t},\n\n\t\tgetTaskNode: function(id) {\n\t\t\tvar timeline = getTimeline(this);\n\t\t\tif (!timeline || !timeline.isVisible()) {\n\t\t\t\treturn null;\n\t\t\t} else {\n\t\t\t\tvar node = timeline._taskRenderer.rendered[id];\n\t\t\t\tif(!node){\n\t\t\t\t\tvar domAttr = timeline.$config.item_attribute;\n\t\t\t\t\tnode = timeline.$task_bars.querySelector(\"[\" +domAttr+ \"='\"+id+\"']\");\n\t\t\t\t}\n\n\t\t\t\treturn node || null;\n\t\t\t}\n\t\t},\n\n\n\t\tgetLinkNode: function(id) {\n\t\t\tvar timeline = getTimeline(this);\n\t\t\tif (!timeline.isVisible()) {\n\t\t\t\treturn null;\n\t\t\t} else {\n\t\t\t\treturn timeline._linkRenderer.rendered[id];\n\t\t\t}\n\t\t},\n\n\t\tscrollTo: function(left, top){\n\t\t\tvar vertical = getVerticalScrollbar(this);\n\t\t\tvar horizontal = getHorizontalScrollbar(this);\n\n\t\t\tvar oldH = {position: 0},\n\t\t\t\toldV = {position: 0};\n\n\t\t\tif(vertical){\n\t\t\t\toldV = vertical.getScrollState();\n\t\t\t}\n\t\t\tif(horizontal){\n\t\t\t\toldH = horizontal.getScrollState();\n\t\t\t}\n\n\t\t\tvar scrollHorizontal = (horizontal && left*1 == left);\n\t\t\tvar scrollVertical = (vertical && top*1 == top);\n\t\t\tvar scrollBoth = scrollHorizontal && scrollVertical;\n\n\t\t\tif(scrollBoth){\n\t\t\t\t// some views will be scrolled both horizontally and vertically and smart rendering can be called twice\n\t\t\t\t// set flag in order not to invoke smart rendering at the horizontal scroll stage\n\t\t\t\t// so it will repaint only once when the scroll is completed\n\t\t\t\tvar verticalViews = vertical._getLinkedViews();\n\t\t\t\tvar horizontalViews = horizontal._getLinkedViews();\n\n\t\t\t\tvar commonViews = [];\n\t\t\t\tfor(var i = 0; i < verticalViews.length; i++){\n\t\t\t\t\tfor(var j = 0; j < horizontalViews.length; j++){\n\n\t\t\t\t\t\tif(verticalViews[i].$config.id && horizontalViews[j].$config.id && verticalViews[i].$config.id === horizontalViews[j].$config.id){\n\t\t\t\t\t\t\tcommonViews.push(verticalViews[i].$config.id);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (scrollHorizontal){\n\t\t\t\tif(commonViews){\n\t\t\t\t\tcommonViews.forEach((function(viewId){\n\t\t\t\t\t\tthis.$ui.getView(viewId).$config.$skipSmartRenderOnScroll = true;\n\t\t\t\t\t}).bind(this));\n\t\t\t\t}\n\n\t\t\t\thorizontal.scroll(left);\n\t\t\t\tif(commonViews){\n\t\t\t\t\tcommonViews.forEach((function(viewId){\n\t\t\t\t\t\tthis.$ui.getView(viewId).$config.$skipSmartRenderOnScroll = false;\n\t\t\t\t\t}).bind(this));\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(scrollVertical){\n\t\t\t\tvertical.scroll(top);\n\t\t\t}\n\n\t\t\tvar newV = {position: 0},\n\t\t\t\tnewH = {position: 0};\n\t\t\tif(vertical){\n\t\t\t\tnewV = vertical.getScrollState();\n\t\t\t}\n\t\t\tif(horizontal){\n\t\t\t\tnewH = horizontal.getScrollState();\n\t\t\t}\n\n\t\t\tthis.callEvent(\"onGanttScroll\", [oldH.position, oldV.position, newH.position, newV.position]);\n\t\t},\n\n\t\tshowDate: function(date){\n\t\t\tvar date_x = this.posFromDate(date);\n\t\t\tvar scroll_to = Math.max(date_x - this.config.task_scroll_offset, 0);\n\t\t\tthis.scrollTo(scroll_to);\n\t\t},\n\t\tshowTask: function(id) {\n\t\t\tvar pos = this.getTaskPosition(this.getTask(id));\n\n\t\t\t// GS-1261: we need to show the start_date even in the RTL mode\n\t\t\tvar leftPos = pos.left;\n\t\t\tif (this.config.rtl) leftPos = pos.left + pos.width;\n\n\t\t\tvar left = Math.max(leftPos - this.config.task_scroll_offset, 0);\n\n\t\t\tvar dataHeight = this._scroll_state().y;\n\t\t\tvar top;\n\t\t\tif(!dataHeight){\n\t\t\t\ttop = pos.top;\n\t\t\t}else{\n\t\t\t\ttop = pos.top - (dataHeight - this.getTaskBarHeight(id))/2;\n\t\t\t}\n\n\t\t\tthis.scrollTo(left, top);\n\t\t\t// GS-1150: if the grid and timeline have different scrollbars, we need to scroll thegrid to show the task\n\t\t\tvar gridCell = getGrid(this);\n\t\t\tvar timelineCell = getTimeline(this);\n\t\t\tif (gridCell && timelineCell && gridCell.$config.scrollY != timelineCell.$config.scrollY){\n\t\t\t\tvar gridScrollbar = getAttachedScrollbar(this, gridCell, \"scrollY\");\n\t\t\t\tgridScrollbar.scrollTo(null, top);\n\t\t\t}\n\t\t},\n\t\t_scroll_state: function(){\n\t\t\tvar result = {\n\t\t\t\tx: false,\n\t\t\t\ty: false,\n\t\t\t\tx_pos: 0,\n\t\t\t\ty_pos: 0,\n\t\t\t\tscroll_size: this.config.scroll_size + 1,//1px for inner content\n\t\t\t\tx_inner: 0,\n\t\t\t\ty_inner: 0\n\t\t\t};\n\n\t\t\tvar scrollVer = getVerticalScrollbar(this),\n\t\t\t\tscrollHor = getHorizontalScrollbar(this);\n\t\t\tif(scrollHor){\n\t\t\t\tvar horState = scrollHor.getScrollState();\n\t\t\t\tif(horState.visible){\n\t\t\t\t\tresult.x = horState.size;\n\t\t\t\t\tresult.x_inner = horState.scrollSize;\n\t\t\t\t}\n\t\t\t\tresult.x_pos = horState.position || 0;\n\t\t\t}\n\n\t\t\tif(scrollVer){\n\t\t\t\tvar verState = scrollVer.getScrollState();\n\t\t\t\tif(verState.visible){\n\t\t\t\t\tresult.y = verState.size;\n\n\t\t\t\t\tresult.y_inner = verState.scrollSize;\n\t\t\t\t}\n\t\t\t\tresult.y_pos = verState.position || 0;\n\t\t\t}\n\n\t\t\treturn result;\n\t\t},\n\t\tgetScrollState: function(){\n\t\t\tvar state = this._scroll_state();\n\t\t\treturn { x:state.x_pos, y:state.y_pos, inner_width:state.x, inner_height:state.y, width: state.x_inner, height: state.y_inner };\n\t\t},\n\n\t\tgetLayoutView: function(cellName){\n\t\t\treturn this.$ui.getView(cellName);\n\t\t},\n\n\t\tscrollLayoutCell: function(cellName, left, top){\n\t\t\tconst cell = this.$ui.getView(cellName);\n\t\t\tif (!cell){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif (left !== null){\n\t\t\t\tconst horizontalScroll = this.$ui.getView(cell.$config.scrollX);\n\t\t\t\tif (horizontalScroll){\n\t\t\t\t\thorizontalScroll.scrollTo(left, null);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (top !== null){\n\t\t\t\tconst verticalScroll = this.$ui.getView(cell.$config.scrollY);\n\t\t\t\tif (verticalScroll){\n\t\t\t\t\tverticalScroll.scrollTo(null, top);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t};\n\n}\n\nexport default createLayoutFacade;","export default function(gantt) {\ngantt.skins.skyblue = {\n\tconfig:{\n\t\tgrid_width:370,\n\t\trow_height: 27,\n\t\tbar_height_padding:4,\n\t\tscale_height: 27,\n\t\tlink_line_width:1,\n\t\tlink_arrow_size:8,\n\t\tlink_radius:2,\n\t\tlightbox_additional_height:75\n\t},\n\t_second_column_width:95,\n\t_third_column_width:80\n};\n\n};","export default function(gantt) {\ngantt.skins.dark = {\n\tconfig:{\n\t\tgrid_width:390,\n\t\trow_height: 36,\n\t\tscale_height: 36,\n\t\tlink_line_width:2,\n\t\tlink_arrow_size:12,\n\t\tbar_height_padding:9,\n\t\tlightbox_additional_height:75\n\t},\n\t_second_column_width:100,\n\t_third_column_width:70\t\t\n};\n\n};","export default function(gantt) {\ngantt.skins.meadow = {\n\tconfig:{\n\t\tgrid_width:380,\n\t\trow_height: 27,\n\t\tscale_height: 30,\n\t\tlink_line_width:2,\n\t\tlink_arrow_size:10,\n\t\tbar_height_padding:4,\n\t\tlightbox_additional_height:72\n\t},\n\t_second_column_width:95,\n\t_third_column_width:80\n};\n\n};","export default function(gantt) {\ngantt.skins.terrace = {\n\tconfig:{\n\t\tgrid_width:390,\n\t\trow_height: 36,\n\t\tscale_height: 36,\n\t\tlink_line_width:2,\n\t\tlink_arrow_size:12,\n\t\tbar_height_padding:9,\n\t\tlightbox_additional_height:75\n\t},\n\t_second_column_width:100,\n\t_third_column_width:70\t\t\n};\n\n};","export default function(gantt) {\n\tgantt.skins.broadway = {\n\t\tconfig: {\n\t\t\tgrid_width: 390,\n\t\t\trow_height: 35,\n\t\t\tscale_height: 35,\n\t\t\tlink_line_width: 1,\n\t\t\tlink_arrow_size: 9,\n\t\t\tbar_height_padding:4,\n\t\t\tlightbox_additional_height: 86\n\t\t},\n\t\t_second_column_width: 100,\n\t\t_third_column_width: 80,\n\n\t\t_lightbox_template: \"<div class='gantt_cal_ltitle'><span class='gantt_mark'>&nbsp;</span><span class='gantt_time'></span><span class='gantt_title'></span><div class='gantt_cancel_btn'></div></div><div class='gantt_cal_larea'></div>\",\n\t\t_config_buttons_left: {},\n\t\t_config_buttons_right: {\n\t\t\t\"gantt_delete_btn\": \"icon_delete\",\n\t\t\t\"gantt_save_btn\": \"icon_save\"\n\t\t}\n\t};\n};","export default function(gantt) {\n\tgantt.skins.material = {\n\t\tconfig: {\n\t\t\tgrid_width: 411,\n\t\t\trow_height: 34,\n\t\t\tscale_height: 36,\n\t\t\tlink_line_width: 2,\n\t\t\tlink_arrow_size: 12,\n\t\t\tbar_height_padding:9,\n\t\t\tlightbox_additional_height: 80\n\t\t},\n\t\t_second_column_width: 110,\n\t\t_third_column_width: 75,\n\t\t_redefine_lightbox_buttons: {\n\t\t\t\"buttons_left\": [\"dhx_delete_btn\"],\n\t\t\t\"buttons_right\": [\"dhx_cancel_btn\", \"dhx_save_btn\"]\n\t\t}\n\t};\n\n\tgantt.attachEvent(\"onAfterTaskDrag\", function (id) {\n\t\tvar t = gantt.getTaskNode(id);\n\t\tif (t) {\n\t\t\tt.className += \" gantt_drag_animation\";\n\t\t\tsetTimeout(function () {\n\t\t\t\tvar indx = t.className.indexOf(\" gantt_drag_animation\");\n\t\t\t\tif (indx > -1) {\n\t\t\t\t\tt.className = t.className.slice(0, indx);\n\t\t\t\t}\n\t\t\t}, 200);\n\t\t}\n\t});\n\n};","export default function(gantt) {\ngantt.skins[\"contrast_black\"] = {\n\tconfig:{\n\t\tgrid_width:390,\n\t\trow_height: 35,\n\t\tscale_height: 35,\n\t\tlink_line_width:2,\n\t\tlink_arrow_size:12,\n\t\tlightbox_additional_height:75\n\t},\n\t_second_column_width:100,\n\t_third_column_width:80\n};\n\n};","export default function(gantt) {\ngantt.skins[\"contrast_white\"] = {\n\tconfig:{\n\t\tgrid_width:390,\n\t\trow_height: 35,\n\t\tscale_height: 35,\n\t\tlink_line_width:2,\n\t\tlink_arrow_size:12,\n\t\tlightbox_additional_height:75\n\t},\n\t_second_column_width:100,\n\t_third_column_width:80\n};\n\n};","import autoscroll from \"./autoscroll\";\nimport jquery_hooks from \"./jquery_hooks\";\nimport dhtmlx_hooks from \"./dhtmlx_hooks\";\nimport TimelineZoom from \"./timeline_zoom\";\n\n\nexport default function(gantt){\n\tif(!gantt.ext){\n\t\tgantt.ext = {};\n\t}\n\n\tvar modules = [\n\t\tautoscroll,\n\t\tjquery_hooks,\n\t\tdhtmlx_hooks\n\t];\n\n\tfor(var i = 0; i < modules.length; i++){\n\t\tif(modules[i])\n\t\t\tmodules[i](gantt);\n\t}\n\n\tgantt.ext.zoom = new TimelineZoom(gantt);\n};","export default function(gantt) {\n\n\tgantt._extend_to_optional = function (lightbox_block) {\n\n\t\tvar duration = lightbox_block;\n\t\tvar optional_time = {\n\t\t\trender: duration.render,\n\t\t\tfocus: duration.focus,\n\t\t\tset_value: function (node, value, task, section) {\n\t\t\t\tvar mapping = gantt._resolve_default_mapping(section);\n\t\t\t\tif (!task[mapping.start_date] || (mapping.start_date == \"start_date\" && this._isAllowedUnscheduledTask(task))) {\n\t\t\t\t\toptional_time.disable(node, section);\n\t\t\t\t\tvar val = {};\n\n\t\t\t\t\tfor (var i in mapping) {\n\t\t\t\t\t\t//take default values from the time control from task start/end dates\n\t\t\t\t\t\tval[mapping[i]] = task[i];\n\t\t\t\t\t}\n\n\t\t\t\t\treturn duration.set_value.call(gantt, node, value, val, section);//set default value\n\t\t\t\t} else {\n\t\t\t\t\toptional_time.enable(node, section);\n\t\t\t\t\treturn duration.set_value.call(gantt, node, value, task, section);\n\t\t\t\t}\n\t\t\t},\n\t\t\tget_value: function (node, task, section) {\n\t\t\t\tif (section.disabled) {\n\t\t\t\t\treturn {start_date: null};\n\t\t\t\t} else {\n\t\t\t\t\treturn duration.get_value.call(gantt, node, task, section);\n\t\t\t\t}\n\t\t\t},\n\t\t\tupdate_block: function (node, section) {\n\t\t\t\tgantt.callEvent(\"onSectionToggle\", [gantt._lightbox_id, section]);\n\t\t\t\tnode.style.display = section.disabled ? \"none\" : \"\";\n\n\t\t\t\tif (section.button) {\n\t\t\t\t\tvar button = node.previousSibling.querySelector(\".gantt_custom_button_label\"),\n\t\t\t\t\t\tlabels = gantt.locale.labels;\n\n\t\t\t\t\tvar button_text = section.disabled ? labels[section.name + \"_enable_button\"] : labels[section.name + \"_disable_button\"];\n\n\t\t\t\t\tbutton.innerHTML = button_text;\n\t\t\t\t}\n\t\t\t},\n\t\t\tdisable: function (node, section) {\n\t\t\t\tsection.disabled = true;\n\t\t\t\toptional_time.update_block(node, section);\n\n\t\t\t},\n\t\t\tenable: function (node, section) {\n\t\t\t\tsection.disabled = false;\n\t\t\t\toptional_time.update_block(node, section);\n\t\t\t},\n\t\t\tbutton_click: function (index, el, section, container) {\n\t\t\t\tif (gantt.callEvent(\"onSectionButton\", [gantt._lightbox_id, section]) === false) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar config = gantt._get_typed_lightbox_config()[index];\n\t\t\t\tif (config.disabled) {\n\t\t\t\t\toptional_time.enable(container, config);\n\t\t\t\t} else {\n\t\t\t\t\toptional_time.disable(container, config);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\treturn optional_time;\n\t};\n\n\tgantt.form_blocks.duration_optional = gantt._extend_to_optional(gantt.form_blocks.duration);\n\tgantt.form_blocks.time_optional = gantt._extend_to_optional(gantt.form_blocks.time);\n\n};","export default function(gantt){\n\tvar htmlTags = new RegExp(\"<(?:.|\\n)*?>\", \"gm\");\n\tvar extraSpaces = new RegExp(\" +\", \"gm\");\n\n\tfunction stripHTMLLite(htmlText){\n\t\treturn (htmlText + \"\")\n\t\t\t.replace(htmlTags, \" \").\n\t\t\treplace(extraSpaces, \" \");\n\t}\n\n\tvar singleQuotes = new RegExp(\"'\", \"gm\");\n\tfunction escapeQuotes(text){\n\t\treturn (text + \"\").replace(singleQuotes, \"&#39;\");\n\t}\n\n\tgantt._waiAria = {\n\t\tgetAttributeString: function(attr){\n\t\t\tvar attributes = [\" \"];\n\t\t\tfor(var i in attr){\n\t\t\t\tvar text = escapeQuotes(stripHTMLLite(attr[i]));\n\t\t\t\tattributes.push(i + \"='\" + text + \"'\");\n\t\t\t}\n\t\t\tattributes.push(\" \");\n\t\t\treturn attributes.join(\" \");\n\n\t\t},\n\n\t\tgetTimelineCellAttr:function(dateString){\n\n\t\t\treturn gantt._waiAria.getAttributeString({\"aria-label\": dateString});\n\t\t},\n\n\t\t_taskCommonAttr: function(task, div){\n\n\t\t\tif(!(task.start_date && task.end_date))\n\t\t\t\treturn;\n\n\t\t\tdiv.setAttribute(\"aria-label\", stripHTMLLite(gantt.templates.tooltip_text(task.start_date, task.end_date, task)));\n\n\t\t\tif(task.$dataprocessor_class){\n\t\t\t\tdiv.setAttribute(\"aria-busy\", true);\n\t\t\t}\n\n\t\t},\n\n\t\tsetTaskBarAttr: function(task, div){\n\t\t\tthis._taskCommonAttr(task, div);\n\n\t\t\t// task bars are complex elements that should be treated as a single element\n\t\t\tdiv.setAttribute(\"role\", \"img\");\n\n\t\t\tif(!gantt.isReadonly(task) && gantt.config.drag_move){\n\t\t\t\tif(task.id != gantt.getState(\"tasksDnd\").drag_id){\n\t\t\t\t\tdiv.setAttribute(\"aria-grabbed\", false);\n\t\t\t\t}else{\n\t\t\t\t\tdiv.setAttribute(\"aria-grabbed\", true);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\ttaskRowAttr: function(task, div){\n\n\t\t\tthis._taskCommonAttr(task, div);\n\n\t\t\tif(!gantt.isReadonly(task) && gantt.config.order_branch){\n\t\t\t\tdiv.setAttribute(\"aria-grabbed\", false);\n\t\t\t}\n\n\t\t\tdiv.setAttribute(\"role\", \"row\");\n\t\t\t// selected attribute should be added only to the grid  because\n\t\t\t// other parts don't have the keyboard navigation\n\t\t\tdiv.setAttribute(\"aria-selected\", gantt.isSelectedTask(task.id) ? \"true\" : \"false\");\n\n\t\t\t// allowed values start from 1, set 1 for non-tree datastores\n\t\t\tdiv.setAttribute(\"aria-level\", task.$level + 1 || 1);\n\n\t\t\tif(gantt.hasChild(task.id)){\n\t\t\t\tdiv.setAttribute(\"aria-expanded\", task.$open ? \"true\" : \"false\");\n\t\t\t}\n\t\t},\n\n\t\tlinkAttr: function(link, div){\n\n\t\t\tvar linkTypes = gantt.config.links;\n\n\t\t\tvar toStart = link.type == linkTypes.finish_to_start || link.type == linkTypes.start_to_start;\n\t\t\tvar fromStart = link.type == linkTypes.start_to_start || link.type == linkTypes.start_to_finish;\n\n\t\t\tvar content = gantt.locale.labels.link + \" \" +  gantt.templates.drag_link(link.source, fromStart, link.target, toStart);\n\n\t\t\t// links are complex elements that should be treated as a single element\n\t\t\tdiv.setAttribute(\"role\", \"img\");\n\n\t\t\tdiv.setAttribute(\"aria-label\", stripHTMLLite(content));\n\t\t},\n\n\t\tgridSeparatorAttr: function(div){\n\t\t\t// the only valid role for the grid header\n\t\t\tdiv.setAttribute(\"role\", \"columnheader\");\n\t\t},\n\t\trowResizerAttr: function(div){\n\t\t\t// the only valid role for the grid header\n\t\t\tdiv.setAttribute(\"role\", \"row\");\n\t\t},\n\n\t\tlightboxHiddenAttr: function(div){\n\t\t\tdiv.setAttribute(\"aria-hidden\", \"true\");\n\t\t},\n\n\t\tlightboxVisibleAttr: function(div){\n\t\t\tdiv.setAttribute(\"aria-hidden\", \"false\");\n\t\t},\n\n\t\tlightboxAttr: function(div){\n\t\t\tdiv.setAttribute(\"role\", \"dialog\");\n\t\t\tdiv.setAttribute(\"aria-hidden\", \"true\");\n\t\t\tdiv.firstChild.setAttribute(\"role\", \"heading\");\n\t\t\tdiv.firstChild.setAttribute(\"aria-level\", \"1\");\n\t\t},\n\n\t\tlightboxButtonAttrString:function(buttonName){\n\t\t\treturn this.getAttributeString({\"role\":\"button\", \"aria-label\":gantt.locale.labels[buttonName], \"tabindex\":\"0\"});\n\t\t},\n\n\t\tlightboxHeader: function(div, headerText){\n\t\t\tdiv.setAttribute(\"aria-label\", headerText);\n\t\t},\n\n\t\tlightboxSelectAttrString: function(time_option){\n\t\t\tvar label = \"\";\n\n\t\t\tswitch (time_option) {\n\t\t\t\tcase \"%Y\":\n\t\t\t\t\tlabel = gantt.locale.labels.years;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%m\":\n\t\t\t\t\tlabel = gantt.locale.labels.months;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%d\":\n\t\t\t\t\tlabel = gantt.locale.labels.days;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%H:%i\":\n\t\t\t\t\tlabel = gantt.locale.labels.hours + gantt.locale.labels.minutes;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\treturn gantt._waiAria.getAttributeString({\"aria-label\": label});\n\t\t},\n\n\t\tlightboxDurationInputAttrString: function(section){\n\t\t\treturn this.getAttributeString({\n\t\t\t\t\"aria-label\": gantt.locale.labels.column_duration,\n\t\t\t\t\"aria-valuemin\": \"0\",\n\t\t\t\t\"role\": \"spinbutton\"\n\t\t\t});\n\t\t},\n\n\t\tinlineEditorAttr: function(div){\n\t\t\tdiv.setAttribute(\"role\", \"row\");\n\t\t},\n\n\t\tgridAttrString: function(){\n\t\t\treturn [\" role='treegrid'\", gantt.config.multiselect ? \"aria-multiselectable='true'\" : \"aria-multiselectable='false'\", \" \"].join(\" \");\n\t\t},\n\n\n\t\tgridScaleRowAttrString: function(){\n\t\t\treturn \"role='row'\";\n\t\t},\n\n\t\tgridScaleCellAttrString: function(column, label){\n\t\t\tvar attrs = \"\";\n\t\t\tif(column.name == \"add\"){\n\t\t\t\t// a more precise role is button, but it is not valid for the grid header\n\t\t\t\tattrs = this.getAttributeString({\"role\":\"columnheader\", \"aria-label\": gantt.locale.labels.new_task});\n\t\t\t}else{\n\n\t\t\t\tvar attributes = {\n\t\t\t\t\t\"role\":\"columnheader\",\n\t\t\t\t\t\"aria-label\": gantt.config.external_render && gantt.config.external_render.isElement(label) ? \"\" : label\n\t\t\t\t};\n\n\t\t\t\tif(gantt._sort && gantt._sort.name == column.name){\n\t\t\t\t\tif(gantt._sort.direction == \"asc\"){\n\t\t\t\t\t\tattributes[\"aria-sort\"] = \"ascending\";\n\t\t\t\t\t}else{\n\t\t\t\t\t\tattributes[\"aria-sort\"] = \"descending\";\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tattrs = this.getAttributeString(attributes);\n\t\t\t}\n\t\t\treturn attrs;\n\t\t},\n\n\t\tgridDataAttrString: function(){\n\t\t\treturn \"role='rowgroup'\";\n\t\t},\n\n\t\treorderMarkerAttr: function(div){\n\t\t\tdiv.setAttribute(\"role\", \"grid\");\n\t\t\tdiv.firstChild.removeAttribute(\"aria-level\");\n\t\t\tdiv.firstChild.setAttribute(\"aria-grabbed\", \"true\");\n\t\t},\n\n\t\tgridCellAttrString: function(column, textValue, task){\n\t\t\tvar attributes = {\"role\":\"gridcell\", \"aria-label\": textValue};\n\t\t\tif(!column.editor || gantt.isReadonly(task)){\n\t\t\t\tattributes[\"aria-readonly\"] = true;\n\t\t\t}\n\n\t\t\treturn this.getAttributeString(attributes);\n\t\t},\n\n\t\tgridAddButtonAttrString: function(column){\n\t\t\treturn this.getAttributeString({\"role\":\"button\", \"aria-label\": gantt.locale.labels.new_task});\n\t\t},\n\n\t\tmessageButtonAttrString: function(buttonLabel){\n\t\t\treturn \"tabindex='0' role='button' aria-label='\"+buttonLabel+\"'\";\n\t\t},\n\n\t\tmessageInfoAttr: function(div){\n\t\t\tdiv.setAttribute(\"role\", \"alert\");\n\t\t\t//div.setAttribute(\"tabindex\", \"-1\");\n\t\t},\n\n\t\tmessageModalAttr: function(div, uid){\n\t\t\tdiv.setAttribute(\"role\", \"dialog\");\n\t\t\tif(uid){\n\t\t\t\tdiv.setAttribute(\"aria-labelledby\", uid);\n\t\t\t}\n\n\t\t//\tdiv.setAttribute(\"tabindex\", \"-1\");\n\t\t},\n\n\t\tquickInfoAttr: function(div){\n\t\t\tdiv.setAttribute(\"role\", \"dialog\");\n\t\t},\n\n\t\tquickInfoHeaderAttrString: function(){\n\t\t\treturn \" role='heading' aria-level='1' \";\n\t\t},\n\n\t\tquickInfoHeader: function(div, header){\n\t\t\tdiv.setAttribute(\"aria-label\", header);\n\t\t},\n\n\t\tquickInfoButtonAttrString: function(label){\n\t\t\treturn gantt._waiAria.getAttributeString({\"role\":\"button\", \"aria-label\":label, \"tabindex\":\"0\"});\n\t\t},\n\n\t\ttooltipAttr: function(div){\n\t\t\tdiv.setAttribute(\"role\", \"tooltip\");\n\t\t},\n\n\t\ttooltipVisibleAttr: function(div){\n\t\t\tdiv.setAttribute(\"aria-hidden\", \"false\");\n\t\t},\n\n\t\ttooltipHiddenAttr: function(div){\n\t\t\tdiv.setAttribute(\"aria-hidden\", \"true\");\n\t\t}\n\t};\n\n\tfunction isDisabled(){\n\t\treturn !gantt.config.wai_aria_attributes;\n\t}\n\n\tfor(var i in gantt._waiAria){\n\t\tgantt._waiAria[i] = (function(payload){\n\t\t\treturn function(){\n\t\t\t\tif(isDisabled()){\n\t\t\t\t\treturn \"\";\n\t\t\t\t}\n\t\t\t\treturn payload.apply(this, arguments);\n\t\t\t};\n\t\t})(gantt._waiAria[i]);\n\t}\n\n\n};","import TreeDataStore from \"../datastore/treedatastore\";\n\nexport default function(gantt) {\n\n\tvar loadedBranches = {};\n\tgantt.$data.tasksStore.attachEvent(\"onClearAll\", function(){\n\t\tloadedBranches = {};\n\t});\n\n\tvar oldHasChildren = TreeDataStore.prototype.hasChild;\n\tgantt.$data.tasksStore.hasChild = function (id) {\n\t\tif(!gantt.config.branch_loading){\n\t\t\treturn oldHasChildren.call(this, id);\n\t\t}else{\n\t\t\tif (oldHasChildren.call(this, id))\n\t\t\t\treturn true;\n\t\t\tif (this.exists(id)) {\n\t\t\t\treturn this.getItem(id)[gantt.config.branch_loading_property];\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t};\n\n\tfunction needLoading(id) {\n\t\tif (gantt.config.branch_loading && gantt._load_url) {\n\t\t\tvar alreadyLoaded = !!loadedBranches[id];\n\t\t\t// call ajax only if branch has children\n\t\t\tif (!alreadyLoaded && (!gantt.getChildren(id).length && gantt.hasChild(id))) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tgantt.attachEvent(\"onTaskOpened\", function (id) {\n\t\tif (gantt.config.branch_loading && gantt._load_url) {\n\t\t\t// call ajax only if branch has children\n\t\t\tif (needLoading(id)) {\n\t\t\t\tvar url = gantt._load_url;\n\t\t\t\turl = url.replace(/(\\?|&)?parent_id=.+&?/, \"\");\n\t\t\t\tvar param = url.indexOf(\"?\") >= 0 ? \"&\" : \"?\";\n\t\t\t\tvar y = gantt.getScrollState().y || 0;\n\n\t\t\t\tvar requestData = {\n\t\t\t\t\ttaskId: id,\n\t\t\t\t\turl: url + param + \"parent_id=\" + encodeURIComponent(id)\n\t\t\t\t};\n\n\t\t\t\tif(gantt.callEvent(\"onBeforeBranchLoading\", [requestData]) === false){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tgantt.load(requestData.url, this._load_type, function () {\n\t\t\t\t\tif (y) {\n\t\t\t\t\t\tgantt.scrollTo(null, y);\n\t\t\t\t\t}\n\t\t\t\t\tgantt.callEvent(\"onAfterBranchLoading\", [requestData]);\n\t\t\t\t});\n\t\t\t\tloadedBranches[id] = true;\n\t\t\t}\n\t\t}\n\t});\n\n};","import extensions from \"./ext/extensions_all\";\nimport factoryMethod from \"./factory/make_instance_web\";\nimport scope from \"./utils/global\";\n\nconst gantt = (scope as any).gantt = factoryMethod(extensions);\n\nexport { gantt };","import \"../css/dhtmlxgantt.less\";\n\nimport factory from \"./make_instance_common\";\nimport ui from \"../core/ui_core\";\nimport ajaxLoading from \"../core/loading/ajax_loading\";\nimport dynamicLoading from \"../core/loading/dynamic_loading\";\n\nexport default function(supportedExtensions) {\n\tvar gantt = factory(supportedExtensions);\n\n\tif(!gantt.env.isNode){\n\t\tui(gantt);\n\t\tajaxLoading(gantt);\n\t\tdynamicLoading(gantt);\n\t}\n\n\treturn gantt;\n};","export default function(gantt) {\n\tgantt.load = function (url, type, callback) {\n\t\tthis._load_url = url;\n\t\tthis.assert(arguments.length, \"Invalid load arguments\");\n\n\t\tvar tp = 'json', cl = null;\n\t\tif (arguments.length >= 3) {\n\t\t\ttp = type;\n\t\t\tcl = callback;\n\t\t} else {\n\t\t\tif (typeof arguments[1] == \"string\")\n\t\t\t\ttp = arguments[1];\n\t\t\telse if (typeof arguments[1] == \"function\")\n\t\t\t\tcl = arguments[1];\n\t\t}\n\n\t\tthis._load_type = tp;\n\n\t\tthis.callEvent(\"onLoadStart\", [url, tp]);\n\n\t\treturn this.ajax.get(url, gantt.bind(function (l) {\n\t\t\tthis.on_load(l, tp);\n\t\t\tthis.callEvent(\"onLoadEnd\", [url, tp]);\n\t\t\tif (typeof cl == \"function\")\n\t\t\t\tcl.call(this);\n\t\t}, this));\n\t};\n};","import {gantt} from \"./dhtmlxgantt.web.single\";\n\nimport scope from \"./utils/global\";\n\n(scope as any).gantt = gantt;\n\nexport default gantt;\n\nexport { gantt };"],"names":["links_common","gantt","_get_linked_task","link","getTarget","task","taskId","target","source","isTaskExists","getTask","_get_link_target","_get_link_source","caching","formattedLinksStash","inheritedSuccessorsStash","inheritedPredecessorsStash","getPredecessorsCache","isManuallyScheduledSummary","isSummaryTask","auto_scheduling","_isLinksCacheEnabled","_startLinksCache","_endLinksCache","_formatLink","sourceDates","targetDates","id","relations","this","isChildOf","autoSchedulingConfig","_getAutoSchedulingConfig","backwardsScheduling","schedule_from_end","config","project_end","respectTargetOffset","move_projects","apply_constraints","gap_behavior","getSubtaskDates","start_date","end_date","from","_getImplicitLinks","c","$source","length","getState","drag_id","calculateDuration","eachTask","child","type","types","project","$target","to","actualTarget","i","fromLength","fromTask","j","toLength","toTask","lag","subtaskLink","_linkedTasks","push","_convertToFinishToStartLink","taskParent","_isAutoSchedulable","unscheduled","unscheduledChildren","parent","selectOffset","selectSourceLinks","skipChild","children","linksCollection","l","links","start_to_start","start_to_finish","siblingLink","getLink","siblingId","siblingTask","linkLag","Math","abs","finish_to_start","additionalLag","insignificantTargetLag","duration","insignificantSourceLag","calculateLag","predecessorId","offsetLag","_getDirectDependencies","selectSuccessors","successors","linksIds","use_progress","progress","concat","_getInheritedDependencies","cacheCollection","stop","inheritedRelations","eachParent","parentDependencies","_getDirectSuccessors","_getInheritedSuccessors","_getDirectPredecessors","_getInheritedPredecessors","_getSuccessors","skipInherited","_getPredecessors","result","key","String","predecessors","sourceTask","targetTask","sourceParent","targetParent","res","sourceLag","targetLag","trueLag","preferredStart","hashSum","finish_to_finish","units","second","minute","hour","day","week","month","quarter","year","getSecondsInUnit","unit","forEach","arr","callback","workArray","slice","arrayFind","find","arrayIncludes","item","includes","isArray","obj","Array","undefined","pop","isDate","getFullYear","getMonth","getDate","isValidDate","isNaN","getTime","arrayFilter","filter","throttle","timeout","wait","apply","arguments","setTimeout","delay","timer","$cancelTimeout","$pending","args","prototype","call","clearTimeout","$execute","replaceValidZeroId","rootId","checkZeroId","findBinary","array","prev","low","high","floor","GraphHelper","getVertices","rel","ids","len","vertices","topologicalSort","edges","hash","$incoming","successor","S","v","L","n","node","m","groupAdjacentEdges","edge","tarjanStronglyConnectedComponents","verticesHash","stack","edgesFromTasks","recurse","connectedComponents","root","getVertex","visited","workStack","index","lowLink","onStack","e","w","min","com","tasks","linkKeys","findLoops","cycles","helpers.forEach","component","LinksBuilder","getVirtualRoot","mixin","root_id","$virtual","getLinkedTasks","includePredecessors","startIds","clearCache","_getLinkedTasks","_collectRelations","rootObj","isChild","visitedLinks","linkKey","rootTask","visitedTasks","output","tasksStack","current","includeRelation","isSameParent","hasChild","getChildren","_slave","ConstraintTypes","TaskPlan","plan","constructor","latestStart","earliestStart","earliestEnd","latestEnd","latestSchedulingStart","earliestSchedulingStart","latestSchedulingEnd","earliestSchedulingEnd","kind","conflict","ConstraintsHelper","isAsapTask","constraintType","getConstraintType","_gantt","ASAP","ALAP","isAlapTask","constraint","_getTaskConstraint","constraint_type","_getOwnConstraint","project_constraint","group_mode","defaultConstraintType","_getParentConstraint","constraint_date","hasConstraint","processConstraint","helpers.isValidDate","constraintDate","newPlan","Create","SNET","Date","calculateEndDate","SNLT","FNET","FNLT","MSO","MFO","getConstraints","store","placeholder","DateComparator","dateA","dateB","_hasDuration","small","big","valueOf","isEqual","smallDate","bigDate","isFirstSmaller","AlapStrategy","instance","_comparator","adjacentLinks","plansHash","maxEnd","linkId","maxStart","defaultStart","maxRelationDate","masterPlan","relation","getLatestEndDate","constraintStartDate","isGreaterOrDefault","callEvent","getClosestWorkTime","date","dir","currentPlan","successorStart","getSuccessorStartDate","predecessor","predecessorEnd","AsapStrategy","minStart","autoScheduledDates","minRelationDate","getEarliestStartDate","isSmallerOrDefault","project_start","milestoneWorktimeDirection","linkProps","onlyFFLink","noRelevantLinks","linkType","r","getPredecessorEndDate","taskCalendar","ffLink","AutoSchedulingPlanner","graphHelper","constraintsHelper","_secondIteration","_constraintsHelper","_graphHelper","_asapStrategy","_alapStrategy","_secondIterationRequired","constraints","alapStrategy","asapStrategy","orderedIds","reversedIds","relationsMap","buildWorkCollections","processConstraints","iterateTasks","projectPlan","reason","updateTasks","newDate","mainSequence","secondarySequence","isMainSequence","mainSequenceStrategy","secondarySequenceStrategy","currentId","resolveRelationDate","limitPlanDates","processResolvedDate","summaryLagChanged","projectUpdates","linksToUpdate","getProjectUpdates","shouldReschedule","projectId","updatedProject","max","initialDuration","newDuration","updatedSource","updatedTarget","updatedRelation","idMatch","targetMatch","sourceMatch","relationProp","projectForUpdate","childTask","isLinkExists","effectiveStart","reverse","unshift","breadthFirstSearch","queue","groupTasks","groupLinksInternal","groupLinksPublic","currentVertex","shift","splice","linksArray","linksObjects","processedLinks","ConnectedGroupsHelper","linksBuilder","getConnectedGroupRelations","_linksBuilder","getConnectedGroup","group","groups","map","LoopsFinder","isCircularLink","getLoopContainingLink","allRelations","findCycles","auto_scheduling_config","getDefaultAutoSchedulingConfig","enabled","descendant_links","schedule_on_parse","show_constraints","getAutoSchedulingConfig","schedulingConfig","mode","strict","move_asap_tasks","auto_scheduling_compatibility","auto_scheduling_strict","auto_scheduling_descendant_links","auto_scheduling_initial","auto_scheduling_move_projects","auto_scheduling_use_progress","auto_scheduling_project_constraint","attachUIHandlers","loopsFinder","connectedGroupsHelper","_attachAutoSchedulingHandlers","movedTask","_scheduleAfterBatchUpdate","_autoScheduleAfterLinkChange","_autoscheduling_in_progress","batch_update","autoSchedule","_preventCircularLink","slackConfigValue","deprecatedConfig","_preventDescendantLink","_datesNotEqual","taskA","taskB","_notEqualTaskDates","task1","task2","milestone","getRelations","resetToStartLinksLags","relationsArray","skipped","originalLink","presentLinks","updatedLinks","shouldKeepConstraints","oldTask","updateTaskConstraints","constraintTypes","constraint_types","backwardConstraints","forwardConstraints","indexOf","finalizeTaskConstraints","attachEvent","drag_mode","_processConstraints","newTask","changedConstraint","modifiedTaskId","ext","inlineEditors","autoscheduleColumns","state","columnName","durationColumn","startDateColumn","endDateColumn","linkedColumnEdit","inline_editors_date_processing","constraintDateColumn","$keep_constraints","draggedTask","progressScheduling","shouldResetSSandSFLinkLags","_autoSchedule","editorConfig","getEditorConfig","map_to","once","getNodePosition","elem","top","left","right","bottom","getBoundingClientRect","box","body","document","docElem","documentElement","parentNode","scrollTop","window","pageYOffset","scrollLeft","pageXOffset","clientTop","clientLeft","offsetWidth","offsetHeight","parseInt","offsetTop","offsetLeft","offsetParent","y","round","x","width","height","isVisible","display","visibility","getComputedStyle","style","currentStyle","hasNonNegativeTabIndex","getAttribute","hasHref","a","area","nodeName","loLowerCase","isEnabled","input","select","textarea","button","object","toLowerCase","hasAttribute","getFocusableNodes","nodes","querySelectorAll","join","nodesArray","$position","sort","b","tabIndex","getScrollSize","div","createElement","cssText","appendChild","clientWidth","removeChild","getClassName","className","baseVal","_trimString","addClassName","removeClassName","name","split","regEx","RegExp","replace","toNode","getElementById","querySelector","insertNode","newone","innerHTML","firstChild","removeNode","getChildNodes","css","ch","childNodes","out","getTargetNode","trg","tagName","event","srcElement","shadowRoot","composedPath","locateAttribute","attribute","host","str","trim","locateClassName","classname","ind","charAt","getRelativeEventPosition","ev","d","clientX","clientY","touches","getRelativeNodePosition","childPos","parentPos","closest","element","selector","matches","msMatchesSelector","webkitMatchesSelector","el","contains","parentElement","nodeType","console","error","getClosestSizedElement","isShadowDomSupported","head","createShadowRoot","attachShadow","getActiveElement","activeElement","getSelection","focusNode","getRootNode","ShadowRoot","classList","test","scope","global","EventsManager$1","_mouseDown","_touchStarts","_touchActive","_longTapTimer","_domEvents","_createDomEventScope","selectedRegion","useKey","ignore","_target","getViewPort","_originPosition","_restoreOriginPosition","position","$services","getService","registerProvider","autoscroll","scheduledDndCoordinates","startDragAndDrop","setStart","copy","setPosition","setEnd","attach","startDrag","eventElement","domHelpers.getRootNode","$root","getTouchEvent","changedTouches","stopDrag","dragMove","touch_drag","filterTargets","getFilterTargets","utils","dom","preventDefault","_getCoordinates","coordinates","dragEnd","dragTimeline","clickDrag","dragTimelineUseKey","drag_timeline","relative","render","detachAll","unregisterProvider","detach","viewPort","viewPortBounds","absolute","EventHost","_silent_mode","listeners","_silentStart","_silentEnd","makeEventable","eventHost","eventName","handler","settings","handlers","eventStorage","combinedResult","handlerResult","addEvent","t","handlerId","originalHandler","removeEvent","clear","thisObject","bind","attachAll","eventArguments","handlerName","checkEvent","detachEvent","list","eventId","detachAllEvents","SelectedRegion","view","_el","defaultRender","start","end","_singleRow","pos","_getTaskPositionByTop","_startPoint","_view","_viewPort","add","_callback","_endPoint","draw","eventable","singleRow","_useRequestAnimationFrame","useRequestAnimationFrame","requestAnimationFrame","getElement","startPoint","_startDate","dateFromPos","endPoint","_endDate","_positionPoint","positionPoint","max_date","tasksByTime","getTaskByTime","tasksByIndex","_getTasksByTop","startValue","endValue","startIndex","endIndex","getTaskByIndex","getItemIndexByTopPosition","getItemHeight","getItemTop","dataHeight","getTotalHeight","row_height","getTaskCount","_dragInProgress","EventsManager","_calculateDirectionVector","_trace","dots","vectors","resultVector","vector","magnitude","sqrt","angleDegrees","atan2","PI","_applyDndReadyStyles","_timeline","$task","_clearDndReadyStyles","remove","_getScrollPosition","timeline","$ui","getView","$config","scrollX","getScrollState","scrollY","_countNewScrollPosition","coords","shiftX","shiftY","_scrollState","_setScrollPosition","scrollLayoutCell","$id","_stopDrag","_originalReadonly","readonly","_originAutoscroll","_startDrag","create","destructor","clickDragUseKey","click_drag","scrollPosition","seed","plainObjectConstructor","toString","helpers.isDate","helpers.isArray","Object","$$typeof","hasOwnProperty","force","f","defined","uid","functor","capture","addEventListener","eventRemove","removeEventListener","ScaleHelper","dateHelper","getSum","sizes","summ","setSumWidth","sum_width","scale","parts","diff","adjustSize","full_width","splitSize","count","full","share","sortScales","scales","cellSize","step","_prepareScaleObject","format","template","date_to_str","projection","column_width","primaryScale","templates","scale_cell_class","getAdditionalScales","prepareConfigs","min_coll_width","container_width","scale_height","minDate","maxDate","rtl","heights","configs","main_scale","cfg","initScaleConfig","processIgnores","display_count","initColSizes","limitVisibleRange","alineScaleColumns","reverseScale","setPosSettings","trace_x","indexes","trace_indexes","trace_index_transition","_ignore_time_config","skip_off_time","skip","probe","isWorkTime","ignore_x","min_col_width","line_height","cont_width","column_count","fixedMode","baseCellWidth","col_width","ignores","min_date","utils.mixin","eachColumn","trace_x_ascending","iterateScales","lower_scale","upper_scale","upper_dates","lower_dates","prevUpper","up","target_index","upper_start","upper_end","lower_start","lower_end","targetWidth","curr","tzOffset","getTimezoneOffset","_correct_dst_change","dates","last","lastDate","outDate","shared","ScaleIgnoreHelper","helper","ignore_time","ignored_colls","modals","modalsStack","isModal","afterPopup","$destroyed","focus","startModal","trapFocus","endModal","currentTarget","$keyboardNavigation","traceLightbox","getLightbox","focusElement","QuickInfo","show","_showForTask","_showAtCoordinates","hide","forced","qi","_quickInfoBox","_quickInfoBoxId","_quickInfoTask","quick_info_detached","getNode","setContainer","container","_container","setContent","content","defaultContent","header","title","buttons","quickinfo_buttons","_createQuickInfoElement","titleBox","titleContent","titleDate","main","controls","_waiAria","quickInfoHeader","html","ariaAttr","quickInfoButtonAttrString","locale","labels","_qiButtonClickHandler","_qiKeyPressHandler","_qi_button_click","code","which","_appendAtCoordinates","show_quick_info","_getContainer","_get_event_counter_part","xViewport","yViewport","_init_quick_info","_prepare_quick_info_classname","_fill_quick_data","_show_quick_info","offset","domEv","getTaskNode","getTaskRowNode","scroll","dx","dy","quickInfoAttr","quickInfoHeaderAttrString","_quickInfoReadonly","isReadonly","getTaskType","quick_info_class","allowedButtons","isEditor","icon_delete","icon_edit","quick_info_title","quick_info_date","quick_info_content","popupHeight","scrolls","screenWidth","relativePopupBottom","mask","$click","$task_data","$grid_data","$grid","$layout","createScope","utils.event","utils.eventRemove","eventScope","staticArray","extend","Tooltip","_tooltipNode","tooltipAttr","_root","domHelpers.isChildOf","_isLikeMouseEvent","_calculateTooltipPosition","tooltipVisibleAttr","tooltipHiddenAttr","_getViewPort","viewport","_getViewPortSize","tooltipNode","tooltip","offsetX","tooltip_offset_x","offsetY","tooltip_offset_y","mouse","domHelpers.getRelativeEventPosition","containerPos","domHelpers.getNodePosition","TooltipManager","_listeners","domEventsScope","_initDelayedFunctions","delayHide","watchableTarget","eventTarget","domHelpers.getTargetNode","targetNode","domHelpers.closest","doOnMouseEnter","onmouseenter","onmousemove","onmouseleave","listener","cloneDomEvent","clone","createEvent","delayShow","helpers.delay","tooltip_timeout","tooltip_hide_timeout","noTrack","onBeforeUndo","onBeforeRedo","batchActions","Monitor","undo","_batchAction","_batchMode","_ignore","_ignoreMoveEvents","_initialTasks","_initialLinks","_nestedTasks","_nestedLinks","_undo","_attachEvents","overwrite","undo_types","_storeTask","_storeLink","isMoveEventsIgnored","newValue","startIgnore","stopIgnore","_timeout","stopBatchAction","action","logAction","_storeTaskCommand","command","update","$local_index","getTaskIndex","_storeEntityCommand","getInitialTask","move","entity","childrenLinks","_storeLinkCommand","taskIds","linkIds","_getLinks","setInitialTask","uniqueLinks","setInitialLink","$index","getGlobalTaskIndex","setInitialTaskObject","clearInitialTasks","clearInitialLinks","deleteCacheCooldown","saveInitialAll","getLinks","getMoveObjectByTaskId","startBatchAction","clearUndoStack","clearRedoStack","onTaskAdded","onTaskUpdated","onTaskDeleted","onLinkAdded","onLinkUpdated","onLinkDeleted","onTaskMoved","toggleIgnoreMoveEvents","nested","setNestedTasks","datastore","getDatastore","tindex","dragId","projectDrag","drag_project","plugins","multiselect","selectedIds","getSelectedTasks","onBeforeEditStartId","onEditStart","$data","tempAssignmentsStore","_lightbox_id","updateConfigs","undoEnabled","commands","old","actionType","entityType","_storeCommand","getInitialLink","Undo","maxSteps","redoEnabled","invert","revert","value","oldValue","inverseCommands","assert","_undoStack","_redoStack","undo_steps","undo_actions","redo","_pop","_reorderCommands","_applyAction","_push","weights","any","actionWeights","weightA","entities","actions","methods","get","isExists","batchUpdate","method","getMethod","check","prop","copyProperty","startsWith","extensions","ConfigBuilder","graph_helper","planner","connectedGroups","getConstraintLimitations","afterRenderBeforeFirstRepaint","updatedTasks","startTask","generatePlan","updateTask","applyProjectPlan","inclusive","parseDate","defaultConfig","setClickDrag","$container","critical_path","_private","_freeSlack","_totalSlack","_slackNeedCalculate","_linkedTasksById","_successorsByTaskId","_projectEnd","_calculateSlacks","linkedTasks","loops","loopLinks","loop","reversedOrder","successorsByTaskId","entry","linked","distCalculator","_cache","getDist","dist","_calculateFreeSlack","_calculateTotalSlack","_isCompletedTask","orderedFromEnd","successorsMap","freeSlack","tasksToDo","processedTasks","ownSlack","totalSlackByTaskId","successorLinks","totalSlack","successorLink","successorSlack","getFreeSlack","_resetTotalSlackCache","_shouldCalculateTotalSlack","getTotalSlack","minSlack","childSlack","dropCachedFreeSlack","init","slackHandler","tasksStore","linksStore","criticalPath","_isProjectEnd","_getProjectEnd","_slackHelper","reset","_calculateCriticalPath","isCriticalTask","hasCritical","slackHelper","resetCache","handleTaskIdChange","oldId","newId","criticalPathHandler","highlight_critical_path","refreshTask","isCriticalLink","getSlack","common","newSlack","_getSlack","next_task","_isDragInProgress","fullscreen","isExpanded","fullscreenElement","mozFullScreenElement","webkitFullscreenElement","msFullscreenElement","isFullscreenAvailable","fullscreenEnabled","webkitFullscreenEnabled","mozFullScreenEnabled","msFullscreenEnabled","backupBodyPadding","overflow","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","backupElementSizes","zIndex","modified","backupPositioning","updateSizes","expandGantt","onFullScreenChange","getFullscreenElement","positions","originalPositioning","setFullScreenSizes","record","cantFullscreen","warning","log","requestArguments","webkitRequestFullscreen","Element","ALLOW_KEYBOARD_INPUT","requestFullscreen","msRequestFullscreen","mozRequestFullScreen","requestExitFullscreen","msExitFullscreen","mozCancelFullScreen","webkitExitFullscreen","exitFullscreen","toggle","collapse","expand","keyboard_navigation","keyboard_navigation_cells","_compose","p","shortcuts","createCommand","modifiers","alt","ctrl","meta","keyCode","parse","shortcut","expr","getExpressions","words","getWords","commandKeys","specialKeys","charCodeAt","getCommandFromEvent","domEvent","shiftKey","altKey","ctrlKey","metaKey","printableKey","fromCharCode","getHashFromEvent","getHash","junctionChar","term","combinationChar","backspace","tab","enter","esc","space","down","home","pageup","pagedown","delete","insert","plus","f1","f2","f3","f4","f5","f6","f7","f8","f9","f10","f11","f12","EventHandler","_handlers","findHandler","doAction","facade","returnValue","unbind","bindAll","initKeys","keys","domHelpers.getFocusableNodes","focusable","currentFocus","domHelpers.getActiveElement","currentIndex","lastItem","firstItem","GanttNode","blur","scrollHorizontal","getScale","scrollTo","posFromDate","scrollVertical","KeyNavNode","isValid","fallback","moveTo","dispatcher","setActiveNode","compareTo","canStringifyThis","canStringifyThat","eventFacade","setAttribute","$eventAttached","HeaderCell","show_grid","getVisibleTaskCount","getGridColumns","TaskRow","visibleColumns","fromDomElement","cellElement","domHelpers.locateClassName","previousSibling","$grid_scale","columns","taskRow","rootLevel","TaskCell","click","createTask","globalIndex","splitItem","$split_subtask","parentId","getParent","nextIndex","locate","isTaskVisible","task_attribute","replaceAll","keptFocus","getTaskPosition","getTaskHeight","viewWidth","viewHeight","inner_width","inner_height","visibleTimeline","show_chart","scroll_on_click","task_scroll_offset","grid","scrollPositionX","scrollPositionY","attachedScrollbarHorizontal","scrollable","scrollbarHorizontal","attachedScrollbarVertical","scrollbarVertical","scrollGrid","nextElement","prevTask","getPrev","nextTask","getNext","$open","open","close","prevId","getPrevSibling","moveTask","isSelectedTask","unselectTask","selectTask","showLightbox","columnIndex","domHelpers.locateAttribute","show_tasks_outside_timescale","row","isActive","activeNode","globalNode","enable","getActiveNode","disable","getDefaultNode","setDefaultNode","inputs","focusGlobalNode","blurNode","focusChanged","keyDownHandler","defaultPrevented","ganttNode","awaitsFocus","clearDelay","isTaskFocused","isInlineEditorCell","isNoKeyboardNavigationElement","focusHandler","$preventDefault","reFocusActiveNode","outsideGantt","localName","domElement","mousedownHandler","locateTask","taskBar","gridLeft","gridRight","nodePosition","rightPosition","positionX","column","removeAttribute","onReady","currentNode","gridDataTopScroll","gridDataBottomScroll","_smart_render","updateRender","_redrawTasks","renderers","items","focusedItemVisible","createdTaskId","keepFocusOnNewTask","nodeConstructor","placeholder_task","focusOnCreate","interval","setInterval","getScope","scopes","headerCell","taskCell","findVisibleColumnIndex","clearInterval","keyNavFacade","addShortcut","scopeObject","getShortcutHandler","getCommandHandler","removeShortcut","keyboardNavigation","quick_info","quickInfo","text","substr","details","task_time","addButton","collapseButton","expandButton","events","hidingFunction","clearQuickInfo","hideQuickInfo","showQuickInfo","tooltipManager","tooltips","tooltipFor","touch","touch_tooltip","targetTaskId","tooltip_text","hideTooltip","link_source_id","monitor","isEqualIds","first","updTask","changeTaskCommandId","updLink","oldTaskId","newTaskId","changeLinkCommandId","updateTasksIds","updateLinksIds","getUndoStack","setUndoStack","getRedoStack","setRedoStack","saveState","getInitialState","grouping","setRelationValueForAssignmentsArray","newGroupValues","oldRelationProperty","resources","resource_id","newRelationProperty","Set","new_value","reduce","resourceAssignmentIndexes","resourceId","assignmentIndex","setRelationValueForPrimitivesArray","inspectRelationProperty","relationProperty","resourceAssignments","arrays","haveArrays","haveResourceAssignments","_getResourcesIds","_getEntryId","_getGroupId","_initBeforeDataRender","_this","_listenerToDrop","delayedFunction","_groups","dynamicGroups","regroup","scrollState","is_active","relation_property","relation_id_property","group_id","group_text","loading","loaded","set_relation_value","_searchCache","self","originalGetParent","invalidParent","noRelationValueFunction","Function","save_tree_structure","oldParentTask","newParentTask","cyclicTree","parentTask","order_branch","$initial_parent","renderedParent","$rendered_parent","initialParent","restoreParent","get_parent","originalSetParent","setParent","new_pid","groupIds","groupId","_buildCache","virtualParentId","_setParentInner","_clearCache","getItems","parent_group_id","_groups_pull","parent_id","generate_sections","groups_type","clear_temp_tasks","generate_data","$calculate_duration","categories","data","update_settings","group_tasks","groups_array","selectedTasks","_clear_data","schedulingOnParse","groupBy","relationInfo","default_group_label","default_group","groupOpenCloseState","restoreOpenCloseState","resultObj","itemsByKey","property","delimiter","hasDefaultGroup","defaultGroupId","default","label","taskGroupValue","marker","render_marker","show_markers","marker_class","markerHeight","getRowTop","timeline_placeholder","scrollHeight","external_render","isElement","renderElement","initMarkerArea","$marker_area","markerArea","_markers","createDatastore","initItem","renderMarkers","createDataRender","defaultContainer","addLayer","getMarker","getItem","addMarker","addItem","deleteMarker","exists","removeItem","updateMarker","refresh","_getMarkers","multiselect_one_level","_multiselect","_selected","_one_level","_active","_first_selected_when_shift","getDefaultSelected","selected","getSelected","setFirstSelected","getFirstSelected","updateState","active","select_task","setLastSelected","silent","unselect","getLastSelected","getSelectedId","afterSelect","isSelected","forSelected","isSameLevel","calculateTaskLevel","_quickRefresh","doSelection","_is_icon_open_click","target_ev","defaultLast","isLast","multiSelect","singleSelection","controller","cell","locateCell","inline_editors_multiselect_open","startEdit","blockSelection","first_indx","target_indx","last_indx","tmp","old_selectTask","old_unselectTask","toggleTaskSelection","eachSelectedTask","getLastSelectedTask","old_isSelected","new_id","task_id","oldSelectedId","oldSelectedTask","newSelectedTask","differentTreeLevel","$level","overlay","overlays","initOverlayArea","$overlay_area","overlayArea","attachUnnattached","isAttached","attachOverlay","showOverlayArea","hideIfNoVisibleLayers","isConnected","addOverlay","deleteOverlay","getOverlaysIds","refreshOverlay","showOverlay","hideOverlay","isOverlayVisible","export_api","_apiUrl","previousDateRage","str_to_date","date_format","_serializeHtml","_prepareConfigPDF","_serializeAll","_fixColumns","raw","_preparePDFConfigRaw","version","_sendToExport","_pdfExportRouter","_serializePlain","smartRendering","smart_rendering","visual","convert","_eachTaskTimed","_serializeTimeline","_serializeGrid","rawDates","_serializeScales","worktime","_getWorktimeSettings","formData","File","FormData","append","_sendImportAjaxExcel","_sendImportAjaxMSP","importFromPrimaveraP6","importFromMSProject","skip_circular_links","oldXmlFormat","xml_format","oldFormatDate","format_date","oldXmlDate","xml_date","oldDateFormat","exportServiceDateFormat","_customProjectProperties","_customTaskProperties","_clearRecLinks","_exportConfig","$custom_data","custom","exportToPrimaveraP6","exportToMSProject","url","pack","cb","ajax","post","base","$template","server","JSON","stringify","sheet","xhr","XMLHttpRequest","onreadystatechange","readyState","status","onload","info","responseText","setRequestHeader","send","encodeURIComponent","_xdr","loader","xdoc","xmlDoc","col","editor","editor_types","skin","_serializableGanttConfig","_markColumns","_ajaxToExport","form","_createHiddenForm","submit","_hidden_export_form","deadline","formatDate","_color_box","_color_hash","color","_getColor","backgroundColor","parsedRanges","minutes","range","startMinute","endMinute","defaultWorkTimes","hours","time","work_time","wTime","_working_time_helper","get_calendar","worktimes","parsed","_getMinutesWorktimeSettings","master","branch","_pull","_originalCopyObject","json","_copyObject","task_text","_copyObjectBase","serializeTask","rgb","match","toISOstring","_copyObjectColumns","_copyObjectPlainExcel","original_start_date","original_end_date","_generatedScales","_generateScales","scaleHelper","getSubScales","scalesConfig","min_column_width","days","helpers.findBinary","_copyObjectTable","startDate","endDate","getDayIndex","columnIndexByDate","allScales","$start","_getDayIndex","$end","hiddenCells","scaleCellsWidth","$type","$rendered_type","tmps","$text","$left","leftside_text","$right","rightside_text","$color","cellCss","task_class","styles","_getStyles","ct","val","date_grid","smartScales","smart_scales","_copyObjectAll","_exportSerialize","_copyObjectPlainICal","availWidth","autosize","autosize_min_width","_getScales","minWidth","$scaleHelper","_getRaw","custom_dataset","serialize","childBar","_copyObjectColors","split_bars","skippedTasks","sibling","overlap","cover","filteredIds","visibleOrder","filteredDataset","cellColors","timeline_cell_class","task_cell_class","steps","Infinity","scaleCell","scaleCell_class","scaleCss","exportMode","cols","ccount","tree","xmlFormat","_lvl","_setLevel","_makeLinksSameLevel","skippedLinks","_clearCircDependencies","_clearLinksSameLevel","_clearLevel","usedTasks","prevLink","sources","$_source","_onCircDependencyFind","targets","curLink","_source","targetLvl","linkT","$_target","projectName","projectDates","start_end","manual","durationUnit","projectProperties","taskProperties","exportToPDF","exportToPNG","exportToICal","exportToExcel","exportToJSON","importFromExcel","constants","KEY_CODES","UP","DOWN","LEFT","RIGHT","SPACE","ENTER","DELETE","ESC","TAB","ExtensionsManager","addExtension","_extensions","getExtension","isWindowAwailable","nav","navigator","userAgent","env","isIE","isOpera","isChrome","isSafari","isFF","isIPad","search","isEdge","isNode","isSalesforce","serialized","createConfig","Error","async","headers","fastVersion","utc","dateToStrFn","to_fixed","getISOWeek","getWeek","splt","strToDateFn","dateString","cspVersion","getUTCDate","getUTCMonth","getUTCFullYear","day_short","getUTCDay","getDay","day_full","month_short","month_full","getUTCHours","getHours","getUTCMinutes","getMinutes","getUTCSeconds","getSeconds","getUTCISOWeek","set","temp","month_short_hash","month_full_hash","UTC","canUseCsp","useCsp","csp","cspAutoCheck","s","date_part","setHours","hour_start","setTime","time_part","week_start","start_on_monday","month_start","setDate","quarter_start","res_month","setMonth","year_start","day_start","setMinutes","minute_start","setSeconds","getMilliseconds","setMilliseconds","_add_days","modifiedDate","inc","originalDate","incCondition","getHoursCondition","getDateCondition","ndate","setYear","add_quarter","num","cspCompliantVersion","_getWeekNumber","isoWeek","nday","first_thursday","year_number","ordinal_date","convert_to_utc","parse_date","token","_url","_token","_mode","_seed","_queue","api","_events","Accept","credentials","fetch","then","websocket","_wrapper","connect","_socket","onclose","location","protocol","o","WebSocket","onmessage","fire","onError","_send","_resubscribe","Promise","_uid","resolve","reject","onCall","catch","onResponse","remoteEvents","remote","remote_client.Client","req","_ready","load","back","_remote","ready","on","checkTimeout","updPerSecond","_on_timeout","ceil","StateService","stateProviders","internal","provider","Promise$1","$powerArray","$create","$removeAt","$remove","$find","$insertAt","$each","$map","$filter","isPlaceholderTask","DataStore","pull","$initItem","powerArray","fullOrder","_skip_refresh","_filterRule","_searchVisibleOrder","_indexRangeCache","_getItemsCache","_attachDataChange","_parseInner","copyOnParse","utils.copy","isSilent","_updateOrder","updateItem","utils.defined","_removeItemInner","_addItemInner","order","data_size","getVisibleItems","getIndexRange","utils.uid","sync_link","_changeIdInner","changeId","_moveInner","sindex","getIdByIndex","clearAll","alreadySilent","arraysEqual","arr1","arr2","quick","skipFilter","_quick_refresh","_mark_recompute","oldOrder","countVisible","eachItem","rule","filteredOrder","placeholderIds","_ganttConfig","cacheKey","ret","getIndexById","_getNullIfUndefined","getFirst","getLast","SplitTasksHelper","_datastore","isSplitItem","isSubrowSplitItem","split_placement","isDefaultSplitItem","isInlineSplitItem","TreeDataStore","_branches","_splitTaskHelper","loadedItem","existingItem","$parentProperty","parentProperty","$getRootId","$openInitially","openInitially","_eachItemMainRangeCache","getConfig","splitParents","splitItems","taskOpenState","taskVisibility","haveSplitItems","_isSplitItem","_isDefaultItem","_isInlineChildItem","canOpenSplitTasks","open_split_tasks","_isSplitChildItem","$expanded_branch","isHeadless","_buildTree","_add_branch","calculateItemLevel","getBranchIndex","targetIndex","_move_branch","_replace_branch_child","_traverseBranches","itemId","sid","source_pid","tbranch","tid","childId","pid","getSiblings","getNextSibling","siblings","nextSibling","level","_eachItemCached","cache","_eachItemIterate","startId","itemsStack","useCache","buildCache","startItem","parentsHash","old_parent","new_parent","old_id","newbranch","field","desc","criteria","original_criteria","els","actualParent","_skipTaskRecalculation","datastoreRender","itemRepainter","renderer","renders","getLayers","render_item","allData","loadedRanges","layer","layerData","get_visible_range","prepare_data","render_items","update_items","extraDataArr","skipRepaint","getDataRender","onUpdateRequest","change_id","getDatastores","storeNames","facadeFactory","$StoreType","open_tree_initially","deepcopy_on_parse","selectedId","deleteItem","subItem","storeAccessName","dropService","storeList","setService","_getDatastores","refreshData","stores","preserve_scroll","getScrollbarsInfo","scroll_info","scrollbarNodeVisible","$view","boundViews","viewName","refresh_links","refreshLinks","refreshLink","_bulk_dnd","hasSplitParent","isSplitTask","_update_flags","userdata","oldSelectId","_skipResourceRepaint","addTask","lightbox","parentObj","deleteTask","utils.bind","changeTaskId","oldid","newid","getLinkCount","addLink","updateLink","deleteLink","changeLinkId","_init_tasks_range","PrimaryScaleHelper","scale_offset_minimal","start_interval","onlyProjectTasks","duration_unit","deadlines","extendRangeForDates","baselines","baseline","_min_date","_max_date","updateTasksRange","fit_tasks","old_min","old_max","copyLinkIdsArray","targetHash","copyLinkIds","treeHelper","getSubtreeLinks","getSubtreeTasks","DataProcessorEvents","dp","$gantt","$dp","_dataProcessorHandlers","cascadeDelete","clientSideDelete","setGanttMode","setUpdated","_sendTaskOrder","cascade_delete","deleteAfterConfirmation","needDbDelete","needCascadeDelete","dpMode","updateMode","setUpdateMode","cascade","storeItem","sendAllData","_tSend","_waitMode","itemLinks","_links","_dp","_tMode","_serverProcessor","_ganttMode","substring","serverProcessor","pluralizedMode","urlSeparator","upd","xml","_xmlNodeToJSON","isExist","objData","assignmentsStore","handleResourceCRUD","handleResourceAssignmentCRUD","handleBaselineCRUD","updated","updatedRows","clientOnly","getUserData","_in_progress","dataprocessor_assignments","resource_assignment_store","insertedTasks","pendingAssignments","insertResourceAssignment","assignment","dataprocessor_resources","resourcesStore","resource_store","resource","dataprocessor_baselines","baselineStore","SimpleStorage","_storage","getStoredItem","_ue","DataProcessor$1","serverProcessorURL","action_param","autoUpdate","_headers","_payload","_postDelim","_routerParametersFormat","_invalid","messages","inserted","deleted","invalid","invalid_cell","enableUTFencoding","total","payload","_serializeAsJson","_router","router","_utf","escape","dnd","rowId","findRow","existing","set_invalid","setUserData","is_invalid","markRow","sendData","_methods","editStop","pendingUpdateModes","modes","checkBeforeUpdate","_beforeSendData","_getRowData","_serializeAsJSON","serialize_one","security_key","pref","valid","_forEachUpdatedRow","_sendData","_getAllData","pattern","_uActions","btag","ganttMode","correct","originalSid","that","_xml","getGanttMode","reqUrl","filePath","tag","processCallback","afterUpdateCallback","finalizeUpdate","xmltop","cleanUpdate","atag","xpath","_initialized","_dp_init","_setDefaultTransactionMode","delete_confirmation","_change_id","_row_style","$dataprocessor_class","_delete_task","$drop_target","setDp","dataProcessorEvents","user","_user","_needUpdate","_updateBusy","afterAutoUpdate","fullSync","loadUpdate","xml_node","getUpdates","vers","_getXmlNodeValue","updates","newState","dataToSend","processedData","_cleanupArgumentsBeforeSend","_cleanupItemBeforeSend","updatedItem","taskState","taskAction","getActionByState","_onResolvedCreateUpdate","actionPromise","errorMsgStart","errorMsgEnd","queryParams","afterUpdate","dhxVersion","urlParams","_applyPayload","preprocessedData","query","setTransactionMode","nodeValue","hasOne","traversedObjects","_prepareDate","helpers.arrayIncludes","_prepareArray","_prepareObject","rawItem","processedItem","dataItem","_prepareDataItem","DataProcessor","he","tMode","createMethod","disableMethod","methodName","dummyMethod","restoreMethod","disableMethods","methodsHash","restoreMethods","batchUpdatePayload","noRedraw","dp_mode","call_dp","resetProjects","resetProjectDates","wbs","_needRecalc","_isRecalcNeeded","_isGroupSort","_getWBSCode","_calcWBS","$wbs","_setWBSCode","getWBSCode","getByWBSCode","_isFirst","_prevSibling","_getPrevNonPlaceholderSibling","_increaseWBS","_parent","siblingiId","_wbs","prevSibling","getTaskByWBSCode","createResourceMethods","resourceTaskCache","singleResourceCacheBuilt","falsyValuePrefix","random","resourceHashFunction","getCacheKey","resourceIds","typeFilter","getResourceTasks","matchingResources","resourceValue","selectAssignments","resource_property","owners","getTaskBy","propertyName","propertyValue","getResourceAssignments","assignments","createHelper","resourcePlugin","renderEditableLabel","editable","$task_id","$resource_id","renderSummaryLabel","sum","Number","editableResourceCellTemplate","$role","editableResourceCellClass","capacity","getSummaryResourceAssignments","childResource","initEditableDiagram","resource_render_empty_cells","timeoutId","makeEditable","cancelAnimationFrame","contentEditable","getCellsByType","$content","currentFocusIndex","handleAssignmentEdit","strValue","innerText","assignmentId","assignmentStore","nextChunk","updateTaskAssignments","editedElem","dom_helpers.getFocusableNodes","focusableElementsAfterRender","focusableElements","focusableElementsAfterUpdate","targetAfterUpdate","editable_resource_diagram","fetchTasks","lightbox_resources","lightboxOptions","resourceStoreConfig","initItems","storeType","$resourcesStore","options","lightboxOptionsFnc","updateCollection","histogram_cell_class","histogram_cell_label","histogram_cell_allocated","histogram_cell_capacity","defaultResourceCellClass","defaultResourceCellTemplate","resource_cell_value","resource_cell_class","resource_assignments","resourceAssignmentsProperty","process_resource_assignments","resourceAssignmentFormats","resourceAssignmentFormat","assignmentModes","initAssignmentFields","initDelay","timing","_assignmentTimeFromTask","resourceAssignmentsStore","_makeAssignmentsFromTask","detectFormat","usedIds","defaultMode","_updateTaskBack","_assignAssignments","getTaskAssignments","_loadAssignmentsFromTask","_syncAssignments","storeAssignments","taskValues","assignmentsStoreValues","inBoth","inTaskNotInStore","inStoreNotInTask","taskOwner","ownerId","foundOwnerAssignment","taskSearch","storeSearch","processedIds","inTask","inStore","ignoreFields","_syncOnTaskUpdate","totalAssignments","needUpdate","needUpdateFor","undoBatchCancel","assignmentsHash","taskAssignmentsCache","idsSearch","deleteIds","resourceAssignmentsCache","resourceTaskAssignmentsCache","searchTaskId","resourceTaskCacheKey","getTaskResources","uniqueResources","addPlaceholder","callIfEnabled","insertPlaceholder","placeholders","new_task","afterEdit","dataProcessor","_silencedPlaceholder","isPlaceholderLink","auto_task_types","auto_types","checkTaskType","changedTypes","targetType","getTaskTypeToUpdate","$needsUpdate","updateParentTypes","delTaskParent","allTypes","hasChildren","taskType","originalRowDndParent","originalMoveTaskParent","isParsingDone","updateAfterRemoveChild","DurationFormatter","canParse","_config","labelName","plural","short","formatUnits","useShortLabels","totalMinutes","transferUnits","toMinutes","_selectFormatForValue","countedValue","_getValueFromMinutes","_getValueInMinutes","_getLabelForConvert","part","isPartReady","needToParse","isNumber","symbol","_getNumericValue","fromMinutes","parseFloat","toFixed","_isUnitName","_getUnitName","isUnit","_defaultSettings","minutesPerHour","hoursPerDay","hoursPerWeek","daysPerMonth","daysPerYear","preparedSettings","values","numericValue","lettersValue","unitName","_we","LinkFormatterSimple","_linkReg","linkPart","exec","_findSource","pred","reqTemplate","_Se","LinkFormatter","super","formattedType","_getFormattedLinkType","_getLinkTypeName","_getLagString","lagPart","typeFormat","_findTypeFormat","typeNumber","_getLinkTypeNumber","_parseLag","linkName","formatted","durationFormatter","formatters","_Te","linkFormatter","empty_state_screen","show_empty_state","emptyStateElement","isGanttEmpty","placeholderContainer","empty_state_text_link","empty_state_text_description","clickEvents","getContainer","domHelpers","wrapper","marginTop","oldNodes","detachAddTaskEvents","attachAddTaskEvent","renderContent","emptyStateElementNode","hasBaselinesBelow","baselinesOnDifferentRow","render_mode","childrenHaveBaselines","hasBaselines","isSplitParent","getMaxParentHeight","heightLimit","maxHeight","shrinkHeight","splitChild","parentHeight","getItemPosition","rowHeight","getMilestoneHeight","getInvertedMilestoneHeight","getAdjustedPosition","childBaselines","splitParams","largerHeight","noNeedToShrink","heightDiff","additionalMargin","exceedBarHeight","bar_height","exceedParentHeight","_adjustSplitParentHeight","maxParentHeight","adjustTaskHeightForBaselines","childHeight","_increaseSplitParentHeight","getLayoutView","getBarHeight","subtaskId","subtask","subtaskHeight","baselineSize","baselineAmount","subrowHeight","timelineView","newBaseline","existingBaseline","shouldRepaint","iteratedBaselines","taskBaselines","exisingBaselines","getTaskBaselines","exisingBaseline","repaint","RemoteEvents","Client","createHandlers","updateQueue","updateTimeout","remoteUpdates","message","processUpdate","processQueue","taskData","warn","initTask","existingTask","remoteTask","lightbox_id","linkData","existingLink","assign","liveUpdates","createMixin","getItemTopCache","getRowTopCache","getItemHeightCache","totalHeightCache","getItemHeightCacheState","quickPosition","cachedRowHeight","canUseSimpleCalc","_getRowHeight","$getConfig","_refreshState","rowStore","globalRowHeight","canUseSimpleCalculation","_resetTopPositionHeight","_resetHeight","getCacheStateTotalHeight","shouldClearHeightCache","all","itemIndex","_fillHeightCache","defaultHeight","globalHeight","itemHeightCache","sumHeight","oldState","getHeight","visibleItems","totalHeight","next","ScrollableGrid","params","_scrollOrder","getCurrentX","_dnd","_scrollView","attachEvents","isScrollable","gridBoundingRect","maxLeft","minLeft","currentX","autoscrollRight","autoscrollStart","autoscrollLeft","autoscrollStop","scrollStep","COLUMN_ID_ATTR_NAME","ColumnsGridDnd","_targetMarker","calculateCurrentPosition","eventX","DND","updates_per_second","_scrollableGrid","_draggedCell","draggedColumn","draggedIndex","_gridConfig","outerHTML","lineHeight","_dragX","columnIndexes","findColumnsIndexes","setMarkerPosition","drawTargetMarker","targetColumn","cleanTargetMarker","reorderColumns","draggedId","xBefore","xAfter","currentColumn","startX","endX","columnRelativePos","compare","relativeX","getCorrection","gridOffset","_obj","nextPosition","domHelpers.addClassName","delegate","mouseEvents","h","Grid","factory","$parent","$state","topPositionMixin","parsing","jsonParseError","on_load","resp","responseURL","_process_loading","collections","_load_collections","assignmentsByTasks","collections_loaded","collection","serverList","option","option_key","$ignore","dhx_security","serializeLink","_copyLink","rawLinks","baselineCopy","attrs_only","attributes","_getCollections","opts","itms","attrs","k","attr","_getXML","toptag","getXMLTopNode","skey","evs","oldxml","startdate","est","enddate","predecessortasks","IsWorkTimeArgument","calendar","ClosestWorkTimeArgument","CalculateEndDateArgument","GetDurationArgument","gridAriaAttr","gridAttrString","gridDataAriaAttr","gridDataAttrString","reorder_grid_columns","gridScaleRowAttrString","item_attribute","layers","_createLayerConfig","resizer","_grid_resize","column_before_start","grid_resizer_column_attribute","column_index","column_after_start","drag_index","column_drag_move","dd","target_column","pointerPosition","minPointerPosition","min_width","min_grid_column_width","maxPointerPosition","markerStartPosition","marker_width","keep_grid_width","limit_max","max_width","maxWidth","rightColumnsWidth","parentLayout","parentWidth","$lastSize","$cells","column_drag_end","columns_width","final_width","grid_width","_setColumnsWidth","_syncCellSizes","isGravity","DnD","dnd_sensitivity","sensitivity","doOnRender","totalWidth","lineHeigth","resize","resize_el","gridSeparatorAttr","_renderHeaderResizers","_mouseDelegates","mouseEventContainer","resizerrow","_task_grid_row_resize","row_before_start","task_grid_row_resizer_attribute","row_id","row_after_start","row_drag_move","itemHeight","itemTop","marker_height","min_task_grid_row_height","row_drag_end","oldItemHeight","finalHeight","_addLayers","_initEvents","_columnDND","ColumnDnd","_validateColumnWidth","numericWidth","setSize","outerWidth","innerWidth","elasticColumns","grid_elastic_columns","columnProperty","newColumnWidth","columnsWidth","getSize","contentHeight","contentWidth","_getGridWidth","contentX","contentY","scrollWidth","_bindStore","_gridCacheAttached","_unbindStore","_initSmartRenderingPlaceholder","_calculateGridWidth","_renderGridHeader","y_end","x_end","scrolled","getColumnIndex","excludeHidden","hiddenIndexShift","getColumn","hidden","gridLine","gridTaskRowResizer","resize_rows","_taskLayers","taskRenderer","taskLayers","bar_layer","_refreshPlaceholderOnStoreUpdate","scrollSize","$rowsPlaceholder","_staticBgHandler","_clearLayers","removeLayer","_getColumnWidth","new_width","_checkGridColumnMinWidthLimits","_getGridWidthLimits","min_limit","max_limit","newWidth","start_index","extra_width","start_width","iterator","curExtra","_getColsTotalWidth","cols_width","unknown","gridWidth","autofit","delta","changed","_setContentSize","cells","renderableComponents","colWidth","_sort","direction","cssClass","grid_header_class","componentLabel","gridScaleCellAttrString","calendarArgumentsHelper","getWorkHoursArguments","setWorkTimeArguments","unsetWorkTimeArguments","isWorkTimeArguments","processedConfig","getClosestWorkTimeArguments","arg","_getStartEndConfig","param","argumentType","duration_step","getDurationArguments","hasDurationArguments","calculateEndDateArguments","WorkTimeCalendarMerger","_getIntervals","hoursArray","_toHoursArray","intervalsArray","formatHHMM","secondsValue","minutePart","_intersectHourRanges","baseArray","overridesArray","_mergeAdjacentIntervals","_mergeHoursConfig","firstHours","secondHours","merge","firstCalendar","secondCalendar","firstConfig","secondConfig","customWeeks","mergedSettings","processCalendar","config1","config2","date1","date2","hours2","WorkUnitsMapCache","timestamp","has","subCache","rawValue","unitCache","yearCache","Map","WorkUnitsObjectCache","LargerUnitsCache","getMinutesPerWeek","weekStart","_weekCache","_calendar","minutesPerWeek","getHoursPerDay","getMinutesPerMonth","monthStart","_monthCache","minutesPerMonth","nextMonth","DateDurationCache","stepCache","durations","endDates","compute","_getCacheObject","startDateTimestamp","_endDateCacheKey","resultTimestamp","_durationCacheKey","endDateTimestamp","CalendarWorkTimeStrategy","argumentsHelper","_workingUnitsCache","_largeUnitsCache","_dateDurationCache","_worktime","_cached_timestamps","_cached_timestamps_count","_clearCaches","_getUnitOrder","_resetTimestampCache","_timestamp","_checkIfWorkingUnit","hasDuration","_is_work_day","_getWorkHours","_is_work_hour","startHour","endHour","_getTimeOfDayStamp","dayEnd","_is_work_minute","checkTime","_nextDate","_getWorkUnitsBetweenGeneric","stepStart","stepEnd","checkFirst","checkLast","isLastStep","_isWorkTime","unitOrder","biggerTimeUnit","_getClosestWorkTimeFuture","_getMinutesPerHour","hourStart","hourEnd","_getMinutesPerDay","durationMinutes","durationHours","_getWorkUnitsForRange","getUnitsPerDay","_getMinutesBetweenSingleDay","_getIntervalTimestamp","minuteFrom","minuteTo","_getMinutesBetween","firstDayStart","firstDayEnd","lastDayStart","lastDayEnd","startPart","endPart","_getHoursBetween","_setConfig","_parseSettings","haveCustomWeeks","customWeeksRangeStart","customWeeksRangeEnd","customWeeksBoundaries","_parseHours","minCustomRangeStart","maxCustomRangeEnd","customTime","rangeStart","rangeEnd","fromReadable","toReadable","currentWeek","_tryChangeCalendarSettings","backup","hasWorkTime","_arraysEqual","_compareSettings","mySettings","thatSettings","myDays","otherDates","myHours","otherHours","equals","myWeek","thatWeek","getWorkHours","dayStartDate","dateValue","endHours","timestampRanges","timerangeConfig","durationSeconds","setWorkTime","calendarConfig","unsetWorkTime","reset_calendar","dateKey","isWorkUnit","setItem","getDuration","_calculateDuration","sign","mult","getEndDate","_calculateEndDate","_calculateMinuteEndDate","_subtractMinuteDate","_calculateHourEndDate","_addInterval","stopAction","added","dstShift","_addHoursUntilDayEnd","rangeHours","addHours","intervalEnd","durationLeft","_addMinutesUntilHourEnd","rangeMinutes","addMinutes","_subtractMinutesUntilHourStart","hourStartTimestamp","initialDateTimestamp","minutePrecision","_isMinutePrecision","addedInterval","calculatedDay","daySchedule","minutesInDay","dayStart","iterateFromDayEnd","isWorkHour","workInterval","prevInterval","minutesInHour","_getClosestWorkTimePast","times","lastInterval","_getClosestWorkTime","inputDate","closestFuture","closestPast","_getClosestWorkTimeGeneric","_findClosestTimeInDay","resultDate","fromDayEnd","_getClosestWorkMinute","increment","hasRegularHours","_checkWorkHours","dayConfig","legacyResourceCalendarConfig","isLegacyResourceCalendarFormat","resourceCalendarsProperty","getResourceProperty","resourceCalendarsConfig","resource_calendars","getCalendarIdFromLegacyConfig","calendarId","dynamicResourceCalendars","dynamicCalendars","getCalendarIdFromMultipleResources","manager","getResourceCalendar","tempCalendar","mergeCalendars","addCalendar","CalendarManager","_calendars","_legacyConfig","_isLegacyConfig","createDefaultCalendars","CalendarDisabledTimeStrategy","TimeCalculator","calendarManager","createArgumentsHelper","$disabledCalendar","NoWorkTimeCalendar","_convertWorkTimeSettings","datesConfig","weekdays","entries","setting","calendars","mergeHelper","CalendarMergeHelper","_createCalendarFromConfig","createCalendar","apiCore","preparedConfig","parentCalendar","defaults","fulltime","getCalendar","getCalendars","_getOwnCalendar","calendar_property","resourceProperty","dynamic_resource_calendars","calendarsConfig","getTaskCalendar","taskObject","groupMode","inherit_calendar","currentTask","$effective_calendar","isCalendar","deleteCalendar","restoreConfigCalendars","possibleCalendar","every","fixedUnits","_getCalendar","worktimeFacadeFactory","timeCalculator","isUnscheduledTask","_isAllowedUnscheduledTask","show_unscheduled","_isTaskInTimelineLimits","taskStart","taskEnd","_getProjectStart","getDefaultTaskDate","_set_default_task_timing","details_on_create","$new","showTask","_tasks_dnd","drag","getTaskTimingMode","task_type","$no_start","$no_end","scheduled_summary","updateTaskTiming","assignProjectDates","taskTiming","summaryDateFields","manuallyScheduledSummaryDateFields","dateFields","_init_task_timing","getSubtaskInfo","rollup","inlineSplit","isScheduledSummary","task_mode","dirty","min_duration","effectiveCalendar","taskMode","$rollup","$inlineSplit","getSubtaskDuration","_update_parents","updateAll","has_changed","startDateField","$auto_start_date","endDateField","$auto_end_date","oldStart","oldEnd","roundDate","upper","lower","colIndex","correctTaskWorkTime","correct_work_time","listenWindowResize","resizeDelay","resizeTimeout","container_resize_timeout","previousSize","getContainerSize","container_resize_method","lowlevelResizeWatcher","$scrollbarRepaint","currentSize","repaintGantt","previousHeight","previousWidth","gantt_core","show_errors","expire","invalidContainerMessage","validateNode","cloneNode","_reinit","dropLayout","_clearTaskLayers","_clearLinkLayers","rebuildLayout","calculateScaleRange","layout","createView","getPropertyValue","resizeWatcher","wai_aria_attributes","contentWindow","resetLayout","initTemplates","domHelpers.toNode","$mouseEvents","edit","question","confirm_deleting","confirm_deleting_title","_delete_task_confirm","hideLightbox","visibleDate","posX","_getHorizontalScrollbar","codeScrollLeft","preserveScroll","zoom","new_pos","posY","x_pos","setSizes","changeLightboxType","getLightboxType","_silent_redraw_lightbox","_get_link_type","from_start","to_start","isLinkAllowed","prevOffset","time_unit","helpers.getSecondsInUnit","offsetChanged","domHelpers.getClassName","icon_save","icon_cancel","icon_details","confirm_closing","section_description","section_time","section_type","section_deadline","section_baselines","section_new_resources","column_wbs","column_text","column_start_date","column_duration","column_add","confirm_link_deleting","link_start","link_end","type_task","type_project","type_milestone","weeks","months","years","message_ok","message_cancel","section_constraint","asap","alap","snet","snlt","fnet","fnlt","mso","mfo","resources_add_button","resources_filter_placeholder","resources_filter_label","resources_section_placeholder","baselines_section_placeholder","baselines_add_button","baselines_remove_button","baselines_remove_all_button","deadline_enable_button","deadline_disable_button","LocaleManager","addLocale","_locales","getLocale","DHXGantt","license","edit_save","edit_cancel","supportedExtensions","extensionManager","ExtensionManager","activePlugins","plugin","services","getter","service","rows","autoscroll_speed","show_links","show_task_cells","static_background","static_background_cells","branch_loading","branch_loading_property","show_loading","server_utc","show_progress","drag_links","drag_progress","drag_resize","drag_move","round_dnd_dates","link_wrapper_width","link_arrow_size","align","inherit_scale_class","time_step","task_date","time_picker","link_attribute","layer_attribute","buttons_left","_migrate_buttons","dhx_save_btn","dhx_cancel_btn","dhx_delete_btn","buttons_right","sections","project_sections","milestone_sections","single_date","drag_lightbox","details_on_dblclick","initial_scroll","order_branch_free","task_height","bar_height_padding","grid_resize","readonly_property","editable_property","type_renderers","optimize_render","prevent_default_scroll","horizontal_scroll_key","drag_multiple","DOMParser","ActiveXObject","loadXML","parseFromString","tagname","responseXML","getElementsByTagName","xpathExp","docObj","selectNodes","ownerDocument","evaluate","XPathResult","ANY_TYPE","iterateNext","_call","onLoad","getSync","put","postData","del","postSync","isQt","noCache","toUpperCase","copyDomEvent","pageX","pageY","_settings","inputMethods","getInputMethods","_drag_start_timer","clearDragTimer","eventParams","passive","accessor","timeStamp","original_target","original_element_sizes","domHelpers.getClosestSizedElement","dragStart","traceDragEvents","inputMethod","mousemove","dragScroll","limited_mousemove","started","dndActive","cancelable","mousemoveContainer","mouseup","checkPositionChange","diff_x","diff_y","pow","initDnDMarker","backupEventTarget","getEvent","backup_element","maxTouchPoints","elementFromPoint","PointerEvent","pointerType","getPosition","_prevent_touch_scroll","_touch_drag","_touch_feedback","targetTouches","templatesLoader","regTemplates","initTemplate","initial","template_name","progress_text","task_end_date","grid_row_class","task_row_class","timeline_cell_content","scale_row_class","grid_indent","grid_folder","grid_file","grid_open","grid_blank","task_unscheduled_time","grid_date_format","link_class","link_description","drag_link","drag_link_class","tooltip_date_format","baseline_text","stateService","selected_task","deletedLinks","originalTask","checkLinkedTaskVisibility","noDuplicateIds","sync_link_delete","sync_links","mapEvents","conf","mapFrom","mapTo","sourceEvent","targetEvent","taskLinks","typeMatch","changedTask","sourceVisible","targetVisible","onItemLoading","onBeforeAdd","onAfterAdd","onBeforeUpdate","onAfterUpdate","onBeforeDelete","onAfterDelete","onIdChange","onBeforeItemMove","onAfterItemMove","onFilterItem","onItemOpen","onItemClose","onBeforeSelect","onAfterSelect","onAfterUnselect","createDataProcessor","modules","new_task_placeholder","remote_events","getGridColumn","checkType","activate","_cached_functions","update_if_changed","critical_path_mode","wrap_methods","_prefetch_originals","prefetch","methodname","original","optimizer","argumentsArray","get_arguments_hash","cached_values","has_cached_value","get_cached_value","cache_value","arguments_hash","is_date","stringify_argument","deactivate","setup","override_gantt","gantt_methods","deactivTimeout","_eventRemoveAll","resetLightbox","i18n","en","ar","be","ca","cn","cs","da","de","es","fa","fi","fr","hr","hu","it","jp","kr","nb","nl","no","pl","pt","ro","ru","si","sk","sv","tr","ua","setLocale","localeObject","gantt_save_btn","gantt_cancel_btn","gantt_delete_btn","boxAttribute","_dhx_msg_cfg","usercall","modalBox","modal_key","messageBox","keyboard","cancelBubble","modality","onkeydown","messageButtonAttrString","getFirstDefined","_createBox","ok","cancel","contentId","messageModalAttr","inner","btn","onclick","innerHeight","alertPopup","confirmPopup","boxPopup","box_params","messageInfoAttr","insertBefore","timers","hideAll","popups","alert","confirm","modalbox","extendSettings","parentSettings","own","$extendedConfig","setPrototypeOf","configurable$1","parentView","parentConfig","parentTemplates","$getTemplates","uiFactory$1","views","createdViews","creator","configure","configurable","initUI","registerView","viewConstructor","createMouseHandler","eventHandlers","doubleclick","contextMenu","addEventTarget","onClick","findEventHandlers","callEventHandlers","onContextMenu","src","delegateHandlers","onDoubleClick","onMouseMove","_last_move_event","domEvents","elementHandlers","callHandler","genericViewPortChecker","isLegacyRender","getRowRectangle","getVisibleTasksRange","indexStart","indexEnd","extraTasksIds","inlineEditorId","layerFactory","renderFactory","task_area_pulls","task_area_renderers","getRenderer","renderMethod","updateMethod","getRectangle","renderCallbackMethod","specializedViewPortChecker","basicGetRectangle","onrender","isInViewPort","layerView","viewConfig","rendererViewPort","useBuffer","remove_item","rendered","clear_container","basicGetRange","getVisibleRange","prepareData","buffer","createDocumentFragment","vis","itemsSearch","renderedItems","newElements","nodesToRemove","renderCalledFor","itemNode","restore","replace_item","item_id","newNode","replaceChild","clearRenderers","createGroup","relativeRoot","defaultFilters","initLayer","renderGroup","tempCollection","filters","_add","getLayer","pending","topmost","mergeFilters","requestUpdate","eachLayer","filter_methods","filter_method","barRectangle","startCoord","_getPositioningContext","endCoord","calculated","rec","sourceBox","targetBox","initialized","visibleBoxes","isLinkInViewPort","sourceTop","sourceHeight","targetTop","targetHeight","sourceLeft","sourceRight","targetLeft","targetRight","$skipSmartRenderOnScroll","Cell","headerHeight","$domEvents","$name","$factory","$externalComponent","_headerClickHandler","final","$preResize","topCont","topSize","minHeight","_hide","cellIndex","moveView","$toHTML","renderedElement","canCollapse","$fill","collapsed","size","gravity","getContentSize","_getBorderSizes","borders","horizontal","vertical","_currentBorders","_borders","_sizeHeader","_sizeContent","_setBorders","domHelpers.removeClassName","cssHash","xLayout","transform","__extends","__","Layout","_super","_parseConfig","domHelpers.removeNode","_resizeScrollbars","scrollbars","scrollChanged","visibleScrollbars","hiddenScrollbars","scrollbarsToHide","showScrollbar","scrollbar","hideScrollbar","shouldHide","shouldShow","visibleGroups","scrollbarsInfo","visible","_getLinkedViews","x_inner","y_inner","y_pos","groupName","newSize","_eachChild","_syncGroupSize","_xLayout","newSizeValue","ownSize","resizeSibling","siblingSize","totalGravity","totalSize","mainGrid","startStage","mainCall","_resizeInProgress","contentViews","setContentSize","_getAutosizeMode","$originalWidthStored","$originalWidth","$originalHeightStored","$originalHeight","cellId","sub","getCells","domHelpers.insertNode","domHelpers.getChildNodes","_cleanElSize","_getBoxStyles","computed","properties","boxSizing","clientHeight","MozBoxSizing","horPaddings","borderLeftWidth","borderRightWidth","vertPaddings","borderTopWidth","borderBottomWidth","borderBox","outerHeight","boxSizes","contentSizes","_sizes","margin","_calcFreeSpace","side","_free","_gravity","_calcSize","_configureBorders","borderClass","lastVisibleIndex","lastCell","borderColorClass","_updateCellVisibility","oldVisibleCells","_visibleCells","firstCall","visibleCells","parentVisibility","hide_empty","hideCell","cellView","marginSide","ViewLayout","$cell","byMaxSize","otherCell","ViewCell","childConfig","$initialized","unload","outerX","outerY","childSize","ResizerCell","startBackSize","startFrontSize","getPageCoordinates","_moveHandler","_moveResizer","_resizer","_upHandler","newSizes","_getNewSizes","front","_setSizes","_setBackground","_clearResizer","_clearListeneres","_startOnMove","_cancelDND","_downHandler","_callStartDNDEvent","_xMode","_behind","_front","_startDND","_eachGroupItem","_getSiblings","_isPosChanged","_setResizer","_positions","now","classes","_getDirection","_getResizePosition","behindSide","behindMin","frontSide","frontMin","newBehindSide","newFrontSide","_getGroupName","resizers","_getGroupResizePosition","minMax","av","nextX","nextY","_setGravity","frontSize","behindSize","newFrontG","newBehindG","_assignNewSizes","resizeValue","ScrollbarCell","SCROLL_MODIFIER_KEYS","_scrollHorizontalHandler","_scrollVerticalHandler","_outerScrollVerticalHandler","_outerScrollHorizontalHandler","_mouseWheelHandler","scroll_size","_isHorizontal","eachCell","_isVertical","_initVertical","_initHorizontal","_initMouseWheel","_initLinkedViews","_getRootParent","_eachView","$scroll_hor","$scroll_ver","_updateLinkedViews","scrollHorizontally","_scrolling","oldSize","scrollVertically","_wheel_time","_oldLeft","_getScrollSize","outerSize","isHorizontal","scrollProperty","innerSizeProperty","outerProperty","_getScrollOffset","cellScrollSize","nonScrollableSize","outerScroll","innerScroll","scrollSizes","_setScrollSize","toggleVisibility","_getScaleOffset","_oldTop","_checkWheelTarget","connectedViews","wheelSpeed","wheelSpeedConfig","wheel_scroll_sensitivity","ff","deltaX","wheelDeltaX","deltaY","wheelDelta","multiplier","deltaMode","wx","wy","horizontalScrollModifier","oldLeft","detail","oldTop","createStaticBgHelper","canvasBgCache","staticBgStyleId","parseRgb","rgbCss","g","getUrlFromCache","getHashKey","cellStyles","bottomBorderColor","rightBorderColor","cacheUrl","generateBgUrl","canvas","context","getContext","image","createImageData","imageSmoothingEnabled","verticalLineWidth","rightBorderWidth","verticalLineColor","drawDot","horizontalLineWidth","bottomBorderWidth","horizontalLineColor","putImageData","toDataURL","matrix","getCssClass","createProbeElement","styleParams","firstRow","secondRow","firstRowCell","rowStyles","png","widths","differentWidths","styleHTML","bgImage","bgDivs","bgTiles","tile","prevCell","divs","prevWidth","leftPos","maxTileSize","appVersion","currentTop","tileWidth","currentHeight","pointerEvents","whiteSpace","fragment","destroy","canvasRender","Timeline","_posFromDateCache","_posFromWorkTimeCache","_timelineDragScroll","clearTaskStoreHandler","_delayRender","ownStore","handlerIdProperty","$attachedResourceViewHandler","$attachedTaskStoreHandler","initGrid","destroyGrid","_linkToTaskStore","previousDragId","relevantResources","delayRender","linkedStore","repaintStack","_getRelevantResources","_updateNestedTasks","_getIdsFromAssignments","resourceStore","toAddArray","toAdd","toDelete","addedTasks","resourceData","resource1","resource2","$task_scale","taskBg","$task_bg","$task_baselines","$task_links","$task_bars","$task_constraints","$task_deadlines","_tasks","linksAttr","bindLinks","linkLayers","_attachLayers","backgroundImage","data_els","_refreshScales","_scales","_getScaleChunkHtml","taskFilter","isTimedProject","expose","hide_bar","timedProjectBar","taskSplitBar","taskRollupBar","taskConstraints","taskDeadline","_linkLayers","_taskRenderer","_initStaticBackgroundRender","linkStore","linkRenderer","linkLayer","_linkRenderer","staticRender","staticBgContainer","$task_bg_static","staticBackgroundHeight","_render_tasks_scales","scales_html","outer_width","helpers","cfgs","fromPos","toPos","tplClass","_prepareScaleHtml","globalConfig","globalTemplates","cssclass","floatConfig","sticky","labelPosition","approxLabelWidth","labelPos","translateValue","getTimelineCellAttr","_getColumnDuration","cellStartDate","absolutePositionDate","trimStartSec","cellEnd","cellDuration","intervals","_getWorkTrimForCell","secondsInsideTrim","mappedTimestampMs","posFromWorkTime","wholeCells","partCell","roundPos","cellDurationMs","cellEndDate","earliestWorkSecondInCell","latestWorkSecondInCell","intervalsSinceCellStart","dayDate","dayIndex","dayIntervals","dayStartOffsetSeconds","absoluteStartSeconds","absoluteEndSeconds","workintervalStart","workintervalEnd","dateOffset","fraction","posLeft","cellWidth","_getNextVisibleColumn","visibleDateIndex","_getPrevVisibleColumn","_getClosestVisibleColumn","dateIndex","visibleIndex","transition","xLeft","xRight","displayStart","displayEnd","isMilestoneRender","_timelineCacheAttached","ResourceGrid","resourceStoreMixin","GridRL","_getResourceConfig","resource_table","domEventScope","_getResourceColumns","_getResourceSection","getLightboxSection","sectionName","section","inlineEditorsLightbox","ResourceTimeline","resourceRow","ResourceHistogram","resourceHistogram","defaultMapping","isChanged","save","tempAssignmentStore","resourceSection","block","form_blocks","_lightbox_root","set_value","lightbox_events","_save_lightbox","onShow","preventKeyNav","shouldPrevent","editPrevCell","editNextCell","onkeyup","onwheel","onHide","keyNavMappings","onBlurDelay","keyNav","activeCell","editorState","hasEditor","editorType","anyModifier","BaseFactory","BaseEditor","get_input","get_value","is_changed","currentValue","is_valid","textEditorFactory","TextEditor","numberEditorFactory","NumberEditor","oninput","selectEditorFactory","SelectEditor","optionsHtml","dateEditorFactory","html5DateFormat","dateToStr","strToDate","DateEditor","minValue","maxValue","predecessorEditorFactory","PredecessorEditor","getFormatter","formatter","parseInputString","formatPredecessors","formatLinkKey","getLinksDiff","predecessorCodes","selectedLinks","existingLinksSearch","linksToAdd","linksToDelete","linksDiff","inputPredecessors","taskPredecessors","durationEditorFactory","linkedPropertiesProcessor","decreaseStartDate","initConfigs","number","keyboardMapping","mapping","setMapping","getMapping","eventBus","inlineEditController","createEditors","_createPlaceholder","inlineEditorAttr","updateTaskDateProperties","ganttHandlers","_itemId","_columnName","_editor","_editorType","_placeholder","asyncShow","setValue","_lightbox","onAfterShow","_onReMount","editorResult","getValue","_getItemValue","_findEditableCell","nextColumn","getNextCell","getFirstCell","getLastCell","canChangeRow","moveRow","nextItem","editNextRow","skipReadonly","editPrevRow","detachStore","isBarInViewport","createTaskRenderer","_task_default_render","controlsMargin","padd","milestoneHeight","milestoneWidth","done","pr","taskEditable","timelineDrag","markerPos","basic","link_from_start","link_target_id","link_landing_area","from_id","link_to_start","dragClass","progressColor","textColor","u","setProperty","_get_link_crossing_css","marginStyle","_render_side_content","setTaskBarAttr","_render_pair","outer","showLinkPoints","cond","ln","tp","marginLeft","marginRight","defaultRenderer","planned","plannedCoords","actual","actualCoords","opacity","isSplitTaskInViewport","getVisibleCellsRange","firstCellIndex","lastCellIndex","isColumnVisible","cellLeftCoord","cellRightCoord","bgPlaceholder","placeholderConfig","lastTaskId","placeholderTask","calendar_id","createLinkRender","drawer","current_pos","dirs","path","point","get_lines","line_to","get_path","line","_get_line","get_wrapper_sizes","wrapper_size","get_line_sizes","line_size","link_line_width","render_line","innerPos","render_corner","corner","radius","lineWidth","cornerDiv","borderVertical","borderHorizontal","arrow","get_direction","vect","path_builder","point_to","get_points","get_endpoint","xy","e_y","e_x","lineType","get_line_type","forward","getMilestonePosition","milestoneTask","siblingBaselines","shapes","lines","link_radius","arrowSize","nextLine","cornerX","cornerY","lastLine","arrowX","arrowY","shape","render_arrow","cssTemplate","linkAttr","createResourceTimelineBuilder","assignmentsPassed","timegrid","scaleUnit","scaleStep","precalculatedTimes","firstColumn","minScaleDate","currDate","cachedTimes","timetable","renderBar","renderConnection","prevLevel","nextLevel","generateRenderResourceHistogram","getResourceLoad","resourceTimetable","renderedHistogramCells","renderedHistogramRows","renderedHistogramCapacity","detachRenderedHistogramCell","renderedRow","renderCapacityElement","capacityMatrix","maxCapacity","capacityElement","colStart","colEnd","bar","connection","renderHistogramCell","fill","checkedColumns","renderedCell","areDatesInViewPort","dateProperties","checkTaskProperties","childProperties","isConstraintInViewPort","shouldRenderConstraints","additional_properties","constraintNames","generateConstraintNode","constraintValue","constraintNodes","taskConstraint","childConstraint","isDeadlineInViewPort","isBaselineInViewPort","inViewport","iterateBaselines","rowDnd","checkPlaceholderTask","getStore","initial_open_state","$transparent","lastTaskOfLevel","last_item","_getGridPos","gridHeight","maxBottom","_getTargetY","scrollPos","_getTaskByY","dropIndex","gridDataSizes","reorderMarkerAttr","containerSize","targetY","allowedLevel","over","nextId","dropTarget","createDropTargetObject","targetId","nextSiblingTarget","dndTaskId","prevSiblingTarget","firstChildTarget","lastChildTarget","findClosesTarget","targetLevel","findTargetAbove","findTargetBelow","getSameLevelDropPosition","relTargetPos","eventTop","targetAbove","targetBelow","gridToPageCoordinates","gridPos","setWidthWithinContainer","higlighter","removeLineHighlight","markerLine","highlightPosition","ePos","markerFolder","folderHighlightWidth","linePos","indentNode","indent","iconWidth","childCount","markerLineTop","rowDndMarker","drop_target","getDropPosition","doctype","minTop","firstVisibleTaskIndex","firstVisibleTaskId","firstVisibleTaskPos","hiddenTaskPart","gridPosition","gridBottom","placeholderRowHeight","lockLevel","getLockedLevelTarget","initializer","onCreated","extendGantt","_inlineEditors","onInitialized","initEvents","extendDom","onDestroyed","clearEvents","notOpenIcon","showDate","sorting_method","taskDnD","createTaskDND","roundTaskDates","round_task_dates","dragMultiple","before_start","before_finish","after_finish","clear_drag_state","set_actions","drag_from_start","stage","_move","_resize","_resize_progress","on_mouse_move","on_mouse_down","on_mouse_up","start_x","start_y","coords_x","_drag_task_coords","minDurationInUnits","_calculateMinDuration","diffValue","_find_max_shift","dragItems","correctShift","minX","maxX","maxShift","minShift","multipleDragShift","new_start","new_end","obj_s_x","obj_e_x","_mouse_position_change","oldPos","newPos","_is_number","isFinite","start_drag","sX","sY","_start_dnd","_update_on_move","_update_item_on_move","curr_date","dragHash","_isMultiselect","dragProject","initialDrag","newStartPos","newEndPos","handle_offset","dragPos","dragX","childDrag","_get_drag_mode","_fix_dnd_scale_time","fixStart","dndContext","_fix_working_times","_finalize_mouse_up","_fireEvent","_dhx_changed","initialDates","finalizingBulkMove","moveCount","doFinalize","dragProperty","selectedTasksIds","selectedTask","_addSubtasksToDragMultiple","trigger","drag_state","summaryId","initLinksDND","_link_landing","_link_target_task","_link_target_task_start","_link_source_task","_link_source_task_start","getDndState","link_edge_marker","link_landing_hover_area","markerSize","viewportSize","ganttOffsetY","updateMarkedHtml","resetDndState","showDirectingLine","s_x","s_y","_direction","getDirectionLine","link_direction_class","tan","angle","atan","coordinateCircleQuarter","sin","cos","shiftLeft","shiftTop","eX","eY","_dir_start","landing","prevTarget","prevLanding","prevToStart","targ","absCoords","domHelpers.getRelativeNodePosition","_dir_end","targetChanged","linkDnD","_linksDnD","_tasksDnD","MouseDelegates","_attachDomEvents","_attachStateProvider","_clearDomEvents","_clearStateProvider","_delete_link_handler","_delete_link_confirm","coll","coll_date","scale_unit","scale_step","getVerticalScrollbar","getHorizontalScrollbar","_legacyGridResizerClass","gridResizer","mainTimeline","colsWidth","hideGrid","grid_limits","ganttContainerWidth","verticalScrollbarWidth","gridOverflow","original_grid_width","skinSettings","skins","_initScrollStateEvents","_getVerticalScrollbar","_findGridResizer","gridFirst","resizeInfo","initialWidth","prevCellWidth","nextCellWidth","viewCell","limits","newBehindSize","newFrontSize","oldBackSize","oldFrontSize","newBackSize","ui$1","attachInitializer","uiFactory","Resizer","Scrollbar","mainLayoutInitializer","mainTimelineInitializer","mainGridInitializer","ResourceGridLightbox","layersEngine","createLayerFactory","previusSiblingContainer","defaultContainerSibling","addTaskLayer","rangeFunction","getVisibleTaskRange","_getTaskLayers","removeTaskLayer","addLinkLayer","getVisibleLinksRangeFactory","isLinkInViewport","_getLinkLayers","removeLinkLayer","gridEditorsFactory","layersApi","textValue","aria","gridAddButtonAttrString","justifyContent","center","gridCellAttrString","css_template","taskRowAttr","rowNode","cellNode","adapter","renderedCells","isRendered","detachRenderedCell","getCellClassTemplate","getCellContentTemplate","renderOneCell","contentTemplate","cssTemplateContent","htmlTemplateContent","customCell","cellCssTemplate","cellHtmlTemplate","odd","placeholderTop","placeholderHeight","createBaseBarRender","renderedNodes","checkVisibility","generateChildElement","childCopy","$rendered_at","getKey","renderParentId","rollupKey","splitTasksHelper","isInViewPortChild","isProject","milestoneChild","linkDragLeft","linkDragRight","offsetMargin","taskContent","shouldUseSplitRendering","splitKey","isInViewPortParent","renderConstraints","generateDeadlineNode","fontSize","deadlineNodes","childDeadline","generateBaselineNode","baselineEnd","milestoneMarginTop","baselineSubrowHeight","baselineBarHeight","siblingBaselinesSize","baselineNodes","taskBaseline","childBaseline","renderLink","renderedResourceLines","renderResourceLineCell","detachRenderedResourceLine","resourceHistogramRenderer","rowResizerAttr","layersService","_get_skin","themeVar","themeName","isCssVarTheme","href","_theme_info","theme","cssVarTheme","skinset","_second_column_width","_third_column_width","_lightbox_template","_redefine_lightbox_buttons","isMove","delayTimeout","startPos","eventPos","isDisplayed","isScrollState","dragMarker","isResize","isLink","isClickDrag","defineDelayTimeout","speed","tick","autoscroll_delay","defineScrollInterval","autoscrollInterval","isScroll","gridDrag","need_scroll","currentScrollTop","scrollOuterHeight","scrollInnerHeight","currentScrollLeft","scrollOuterWidth","scrollInnerWidth","autoscroll_step","boxSize","$","jQuery","fn","dhx_gantt","each","newgantt","Gantt","getGanttInstance","dhtmlx","attaches","attachGantt","cmp","attachObject","dataType","dataObj","vs","border","gridId","gridObj","dhtmlXCellObject","USE_KEY","_defaultScales","TimelineZoom","zoomIn","getCurrentLevel","setLevel","zoomOut","_levels","_activeLevelIndex","getLevels","zoomLevel","_getZoomIndexByName","levelName","_getVisibleDate","_visibleDate","cursorOffset","nextConfig","chartConfig","resourceView","resourceConfig","fixed_scales","cursorDate","newPosition","middleDate","_attachWheelEvent","_useKey","_handler","_defaultHandler","timelineOffset","wheelUp","stopPropagation","_setScaleSettings","_setScaleDates","_initialStartDate","_initialEndDate","activeLevelIndex","_mapScales","levels","_minColumnWidth","minColumnWidth","_maxColumnWidth","maxColumnWidth","_widthStep","widthStep","_stepUp","_stepDown","addTouchEvents","platform","_touch_events","getTaskDND","tasksDnD","touch_feedback","touch_feedback_duration","vibrate","touchHandlers","names","dblclicktime","actionMode","scrollMode","actionStart","previousActionStart","longTapTimer","currentDndId","dndNodes","targetView","multiTouchEvents","newScrollState","block_action","allViews","_locate_css","taskNode","noMultitouch","sameTarget","dummy","BaseControl","Super","htmlHelpers","getHtmlSelect","_attributes","getHtmlOption","_getHtmlContainer","getHtmlButton","getHtmlDiv","getHtmlLabel","getHtmlInput","_getHtmlAttributes","SelectControlConstructor","SelectControl","sns","_dhx_onchange","onchange","_focus","DurationFormatterNumeric","_ja","ParentControlConstructor","ParentControl","_display","allow_root","root_label","getLightboxValues","tmpDom","newOptions","onselect","ResourcesControlConstructor","localCache","resourcesValues","eventsInitialized","ResourcesControl","_getAmountInput","disabled","_getInputElementSelector","isChecked","_getResourcesElement","_getFilterCache","checkbox","checked","filterApplied","resourceFilterPlaceholder","filter_placeholder","resourceFilterLabel","resourcesElement","htmlResourceRow","_applyFilter","resultSns","hideUnsetted","_saveValues","filterCache","controlConfig","comparison","resultConfig","cachedValue","helpers.arrayFind","itemIds","helpers.arrayFilter","_resourceChangeListener","valueInput","resId","defaultValue","default_value","originalAssignmentId","helpers.throttle","unassigned_value","searchResult","_offsetSizes","_center_lightbox","amountElement","selectorAdd","selectorSub","settedValuesHash","itemsAdd","itemsSub","originalId","amount","NewResourcesControlConstructor","gridID","resource_filter_value","initialValues","newValues","selectResEditor","newResourcesControl","resource_default_assignment","button_click","firstAddBtn","resourceGrid","resourceRows","resourceCell","resourceTable","gridConfig","wide_form","searchItems","clonedAssignments","structuredClone","visibleResources","currentAssignments","resource_selector","TemplateControl","TemplateControlConstructor","TextareaControl","_get_input","TimeControl","getTimePicker","sectionClassName","_time_format_order","auto_end_date","_update_lightbox_select","_fill_lightbox_select","_resolve_default_mapping","selects","getTimePickerValue","autofix_end","_get_timepicker_step","CheckboxControl","BaseConstrutor","single_value","checkboxes","resArray","RadioControl","radio","DurationControl","_getStartDate","_getDuration","singleDate","lightboxDurationInputAttrString","durationInputClass","duration_val","inps","btns","endspan","_calc_date","_change_duration","charCode","ConstraintControl","isNonTimedConstraint","toggleTimeSelect","timeSelects","typeValue","isNonTimed","typeSelect","_eventsInitialized","TypeselectControl","typeKey","oldOnChange","_lightbox_current_type","BaselineControl","_generateBaselineRow","durationLabel","deleteLabel","durationEl","deleteButton","baselineRow","baselineNode","baselineId","dataset","updatedBaseline","_get_typed_lightbox_config","NewResourcesControl","_lightbox_methods","showCover","_fill_lightbox","_setLbPosition","lightboxVisibleAttr","getLabel","list_name","_lightbox_type","lightboxDiv","fullWidth","ds","classNames","_is_lightbox_timepicker","getHtmlButtons","lightboxAttr","onmousedown","_ready_to_dnd","onselectstart","cursor","_init_dnd_events","show_cover","_cover","_render_sections","backup_overflow","labelBlock","inputBlock","inputId","_init_lightbox_events","rootElement","_move_while_dnd","_finish_dnd","_get_type_name","type_value","floatRight","lightboxButtonAttrString","getTimeFormat","time_format","getHtmlTimePickerOptions","start_year","end_year","tdate","timeFormat","year_range","_time_values","_cancel_lightbox","sec","buttonTarget","time_optional","duration_optional","sortedSns","lightboxHiddenAttr","hideCover","_custom_lightbox","_set_lightbox_values","lightboxHeader","lightbox_header","get_template_control","control","get_select_control","get_textarea_control","get_time_control","_dnd_start_lb","gantt_unselectable","lb","_lb_start","ariaAttrs","limit_time_select","first_hour","last_hour","lightboxSelectAttrString","mapOffset","typeselect","_simple_confirm","oldType","ui","codeHelpers.arrayFind","uiApi","getTimeline","getGrid","getBaseCell","baseCell","getAttachedScrollbar","attachedScrollbar","DEFAULT_VALUE","tryCall","getTaskTop","getTaskBarHeight","domAttr","getLinkNode","oldH","oldV","verticalViews","horizontalViews","commonViews","viewId","newV","newH","date_x","scroll_to","_scroll_state","gridCell","timelineCell","scrollVer","scrollHor","horState","verState","cellName","horizontalScroll","verticalScroll","resetSkin","monitorThemeChange","_addThemeClass","setSkin","skinChanged","monitorIntervalId","csstheme","skyblue","lightbox_additional_height","dark","meadow","terrace","broadway","_config_buttons_left","_config_buttons_right","material","indx","_extend_to_optional","lightbox_block","optional_time","update_block","button_text","htmlTags","extraSpaces","stripHTMLLite","htmlText","singleQuotes","escapeQuotes","getAttributeString","_taskCommonAttr","linkTypes","toStart","fromStart","buttonName","role","tabindex","headerText","time_option","buttonLabel","targetAttribute","_locateHTML","firstTask","domHelpers.getScrollSize","availablePlugins","dynamicLoading","loadedBranches","oldHasChildren","_load_url","requestData","_load_type","cl"],"mappings":"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","x_google_ignoreList":[65]}